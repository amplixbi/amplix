!function(){var R={version:"3.5.10"},u=[].slice,h=function(n){return u.call(n)},M=this.document;function a(n){return n&&(n.ownerDocument||n.document||n).documentElement}function D(n){return n&&(n.ownerDocument&&n.ownerDocument.defaultView||n.document&&n||n.defaultView)}if(M)try{h(M.documentElement.childNodes)[0].nodeType}catch(n){h=function(n){for(var t=n.length,e=new Array(t);t--;)e[t]=n[t];return e}}if(Date.now||(Date.now=function(){return+new Date}),M)try{M.createElement("DIV").style.setProperty("opacity",0,"")}catch(n){var t=this.Element.prototype,e=t.setAttribute,r=t.setAttributeNS,i=this.CSSStyleDeclaration.prototype,o=i.setProperty;t.setAttribute=function(n,t){e.call(this,n,t+"")},t.setAttributeNS=function(n,t,e){r.call(this,n,t,e+"")},i.setProperty=function(n,t,e){o.call(this,n,t+"",e)}}function l(n,t){return n<t?-1:t<n?1:t<=n?0:NaN}function c(n){return null===n?NaN:+n}function f(n){return!isNaN(n)}function n(u){return{left:function(n,t,e,r){for(arguments.length<3&&(e=0),arguments.length<4&&(r=n.length);e<r;){var i=e+r>>>1;u(n[i],t)<0?e=1+i:r=i}return e},right:function(n,t,e,r){for(arguments.length<3&&(e=0),arguments.length<4&&(r=n.length);e<r;){var i=e+r>>>1;0<u(n[i],t)?r=i:e=1+i}return e}}}R.ascending=l,R.descending=function(n,t){return t<n?-1:n<t?1:n<=t?0:NaN},R.min=function(n,t){var e,r,i=-1,u=n.length;if(1===arguments.length){for(;++i<u;)if(null!=(r=n[i])&&r<=r){e=r;break}for(;++i<u;)null!=(r=n[i])&&r<e&&(e=r)}else{for(;++i<u;)if(null!=(r=t.call(n,n[i],i))&&r<=r){e=r;break}for(;++i<u;)null!=(r=t.call(n,n[i],i))&&r<e&&(e=r)}return e},R.max=function(n,t){var e,r,i=-1,u=n.length;if(1===arguments.length){for(;++i<u;)if(null!=(r=n[i])&&r<=r){e=r;break}for(;++i<u;)null!=(r=n[i])&&e<r&&(e=r)}else{for(;++i<u;)if(null!=(r=t.call(n,n[i],i))&&r<=r){e=r;break}for(;++i<u;)null!=(r=t.call(n,n[i],i))&&e<r&&(e=r)}return e},R.extent=function(n,t){var e,r,i,u=-1,o=n.length;if(1===arguments.length){for(;++u<o;)if(null!=(r=n[u])&&r<=r){e=i=r;break}for(;++u<o;)null!=(r=n[u])&&(r<e&&(e=r),i<r&&(i=r))}else{for(;++u<o;)if(null!=(r=t.call(n,n[u],u))&&r<=r){e=i=r;break}for(;++u<o;)null!=(r=t.call(n,n[u],u))&&(r<e&&(e=r),i<r&&(i=r))}return[e,i]},R.sum=function(n,t){var e,r=0,i=n.length,u=-1;if(1===arguments.length)for(;++u<i;)f(e=+n[u])&&(r+=e);else for(;++u<i;)f(e=+t.call(n,n[u],u))&&(r+=e);return r},R.mean=function(n,t){var e,r=0,i=n.length,u=-1,o=i;if(1===arguments.length)for(;++u<i;)f(e=c(n[u]))?r+=e:--o;else for(;++u<i;)f(e=c(t.call(n,n[u],u)))?r+=e:--o;if(o)return r/o},R.quantile=function(n,t){var e=(n.length-1)*t+1,r=Math.floor(e),i=+n[r-1],u=e-r;return u?i+u*(n[r]-i):i},R.median=function(n,t){var e,r=[],i=n.length,u=-1;if(1===arguments.length)for(;++u<i;)f(e=c(n[u]))&&r.push(e);else for(;++u<i;)f(e=c(t.call(n,n[u],u)))&&r.push(e);if(r.length)return R.quantile(r.sort(l),.5)},R.variance=function(n,t){var e,r,i=n.length,u=0,o=0,a=-1,l=0;if(1===arguments.length)for(;++a<i;)f(e=c(n[a]))&&(o+=(r=e-u)*(e-(u+=r/++l)));else for(;++a<i;)f(e=c(t.call(n,n[a],a)))&&(o+=(r=e-u)*(e-(u+=r/++l)));if(1<l)return o/(l-1)},R.deviation=function(){var n=R.variance.apply(this,arguments);return n?Math.sqrt(n):n};var s=n(l);function p(n){return n.length}R.bisectLeft=s.left,R.bisect=R.bisectRight=s.right,R.bisector=function(e){return n(1===e.length?function(n,t){return l(e(n),t)}:e)},R.shuffle=function(n,t,e){(u=arguments.length)<3&&(e=n.length,u<2&&(t=0));for(var r,i,u=e-t;u;)i=Math.random()*u--|0,r=n[u+t],n[u+t]=n[i+t],n[i+t]=r;return n},R.permute=function(n,t){for(var e=t.length,r=new Array(e);e--;)r[e]=n[t[e]];return r},R.pairs=function(n){for(var t=0,e=n.length-1,r=n[0],i=new Array(e<0?0:e);t<e;)i[t]=[r,r=n[++t]];return i},R.zip=function(){if(!(r=arguments.length))return[];for(var n=-1,t=R.min(arguments,p),e=new Array(t);++n<t;)for(var r,i=-1,u=e[n]=new Array(r);++i<r;)u[i]=arguments[i][n];return e},R.transpose=function(n){return R.zip.apply(R,n)},R.keys=function(n){var t=[];for(var e in n)t.push(e);return t},R.values=function(n){var t=[];for(var e in n)t.push(n[e]);return t},R.entries=function(n){var t=[];for(var e in n)t.push({key:e,value:n[e]});return t},R.merge=function(n){for(var t,e,r,i=n.length,u=-1,o=0;++u<i;)o+=n[u].length;for(e=new Array(o);0<=--i;)for(t=(r=n[i]).length;0<=--t;)e[--o]=r[t];return e};var T=Math.abs;function g(n,t){for(var e in t)Object.defineProperty(n.prototype,e,{value:t[e],enumerable:!1})}function m(){this._=Object.create(null)}R.range=function(n,t,e){if(arguments.length<3&&(e=1,arguments.length<2&&(t=n,n=0)),(t-n)/e==1/0)throw new Error("infinite range");var r,i=[],u=function(n){var t=1;for(;n*t%1;)t*=10;return t}(T(e)),o=-1;if(n*=u,t*=u,(e*=u)<0)for(;(r=n+e*++o)>t;)i.push(r/u);else for(;(r=n+e*++o)<t;)i.push(r/u);return i},R.map=function(n,t){var e=new m;if(n instanceof m)n.forEach(function(n,t){e.set(n,t)});else if(Array.isArray(n)){var r,i=-1,u=n.length;if(1===arguments.length)for(;++i<u;)e.set(i,n[i]);else for(;++i<u;)e.set(t.call(n,r=n[i],i),r)}else for(var o in n)e.set(o,n[o]);return e};var v="__proto__",d="\0";function y(n){return(n+="")===v||n[0]===d?d+n:n}function x(n){return(n+="")[0]===d?n.slice(1):n}function b(n){return y(n)in this._}function _(n){return(n=y(n))in this._&&delete this._[n]}function w(){var n=[];for(var t in this._)n.push(x(t));return n}function S(){var n=0;for(var t in this._)++n;return n}function k(){for(var n in this._)return!1;return!0}function N(){this._=Object.create(null)}function P(n){return n}function E(t,e,r){return function(){var n=r.apply(e,arguments);return n===e?t:n}}function A(n,t){if(t in n)return t;t=t.charAt(0).toUpperCase()+t.slice(1);for(var e=0,r=C.length;e<r;++e){var i=C[e]+t;if(i in n)return i}}g(m,{has:b,get:function(n){return this._[y(n)]},set:function(n,t){return this._[y(n)]=t},remove:_,keys:w,values:function(){var n=[];for(var t in this._)n.push(this._[t]);return n},entries:function(){var n=[];for(var t in this._)n.push({key:x(t),value:this._[t]});return n},size:S,empty:k,forEach:function(n){for(var t in this._)n.call(this,x(t),this._[t])}}),R.nest=function(){var s,h,p={},g=[],t=[];function v(e,n,r){if(r>=g.length)return h?h.call(p,n):s?n.sort(s):n;for(var t,i,u,o,a=-1,l=n.length,c=g[r++],f=new m;++a<l;)(o=f.get(t=c(i=n[a])))?o.push(i):f.set(t,[i]);return u=e?(i=e(),function(n,t){i.set(n,v(e,t,r))}):(i={},function(n,t){i[n]=v(e,t,r)}),f.forEach(u),i}return p.map=function(n,t){return v(t,n,0)},p.entries=function(n){return function e(n,r){if(r>=g.length)return n;var i=[],u=t[r++];return n.forEach(function(n,t){i.push({key:n,values:e(t,r)})}),u?i.sort(function(n,t){return u(n.key,t.key)}):i}(v(R.map,n,0),0)},p.key=function(n){return g.push(n),p},p.sortKeys=function(n){return t[g.length-1]=n,p},p.sortValues=function(n){return s=n,p},p.rollup=function(n){return h=n,p},p},R.set=function(n){var t=new N;if(n)for(var e=0,r=n.length;e<r;++e)t.add(n[e]);return t},g(N,{has:b,add:function(n){return this._[y(n+="")]=!0,n},remove:_,values:w,size:S,empty:k,forEach:function(n){for(var t in this._)n.call(this,x(t))}}),R.behavior={},R.rebind=function(n,t){for(var e,r=1,i=arguments.length;++r<i;)n[e=arguments[r]]=E(n,t,t[e]);return n};var C=["webkit","ms","moz","Moz","o","O"];function z(){}function L(){}function q(i){var u=[],o=new m;function n(){for(var n,t=u,e=-1,r=t.length;++e<r;)(n=t[e].on)&&n.apply(this,arguments);return i}return n.on=function(n,t){var e,r=o.get(n);return arguments.length<2?r&&r.on:(r&&(r.on=null,u=u.slice(0,e=u.indexOf(r)).concat(u.slice(e+1)),o.remove(n)),t&&u.push(o.set(n,{on:t})),i)},n}function j(){R.event.preventDefault()}function U(){for(var n,t=R.event;n=t.sourceEvent;)t=n;return t}function F(i){for(var u=new L,n=0,t=arguments.length;++n<t;)u[arguments[n]]=q(u);return u.of=function(e,r){return function(n){try{var t=n.sourceEvent=R.event;n.target=i,R.event=n,u[n.type].apply(e,r)}finally{R.event=t}}},u}R.dispatch=function(){for(var n=new L,t=-1,e=arguments.length;++t<e;)n[arguments[t]]=q(n);return n},L.prototype.on=function(n,t){var e=n.indexOf("."),r="";if(0<=e&&(r=n.slice(e+1),n=n.slice(0,e)),n)return arguments.length<2?this[n].on(r):this[n].on(r,t);if(2===arguments.length){if(null==t)for(n in this)this.hasOwnProperty(n)&&this[n].on(r,null);return this}},R.event=null,R.requote=function(n){return n.replace(H,"\\$&")};var H=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,O={}.__proto__?function(n,t){n.__proto__=t}:function(n,t){for(var e in t)n[e]=t[e]};function I(n){return O(n,X),n}var Y=function(n,t){return t.querySelector(n)},Z=function(n,t){return t.querySelectorAll(n)},V=function(n,t){var e=n.matches||n[A(n,"matchesSelector")];return(V=function(n,t){return e.call(n,t)})(n,t)};"function"==typeof Sizzle&&(Y=function(n,t){return Sizzle(n,t)[0]||null},V=(Z=Sizzle).matchesSelector),R.selection=function(){return R.select(M.documentElement)};var X=R.selection.prototype=[];function $(n){return"function"==typeof n?n:function(){return Y(n,this)}}function B(n){return"function"==typeof n?n:function(){return Z(n,this)}}X.select=function(n){var t,e,r,i,u=[];n=$(n);for(var o=-1,a=this.length;++o<a;){u.push(t=[]),t.parentNode=(r=this[o]).parentNode;for(var l=-1,c=r.length;++l<c;)(i=r[l])?(t.push(e=n.call(i,i.__data__,l,o)),e&&"__data__"in i&&(e.__data__=i.__data__)):t.push(null)}return I(u)},X.selectAll=function(n){var t,e,r=[];n=B(n);for(var i=-1,u=this.length;++i<u;)for(var o=this[i],a=-1,l=o.length;++a<l;)(e=o[a])&&(r.push(t=h(n.call(e,e.__data__,a,i))),t.parentNode=e);return I(r)};var W={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function J(t,e){return t=R.ns.qualify(t),null==e?t.local?function(){this.removeAttributeNS(t.space,t.local)}:function(){this.removeAttribute(t)}:"function"==typeof e?t.local?function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}:function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}:t.local?function(){this.setAttributeNS(t.space,t.local,e)}:function(){this.setAttribute(t,e)}}function G(n){return n.trim().replace(/\s+/g," ")}function K(n){return new RegExp("(?:^|\\s+)"+R.requote(n)+"(?:\\s+|$)","g")}function Q(n){return(n+"").trim().split(/^|\s+/)}function nn(e,r){var i=(e=Q(e).map(tn)).length;return"function"==typeof r?function(){for(var n=-1,t=r.apply(this,arguments);++n<i;)e[n](this,t)}:function(){for(var n=-1;++n<i;)e[n](this,r)}}function tn(r){var i=K(r);return function(n,t){if(e=n.classList)return t?e.add(r):e.remove(r);var e=n.getAttribute("class")||"";t?(i.lastIndex=0,i.test(e)||n.setAttribute("class",G(e+" "+r))):n.setAttribute("class",G(e.replace(i," ")))}}function en(t,e,r){return null==e?function(){this.style.removeProperty(t)}:"function"==typeof e?function(){var n=e.apply(this,arguments);null==n?this.style.removeProperty(t):this.style.setProperty(t,n,r)}:function(){this.style.setProperty(t,e,r)}}function rn(t,e){return null==e?function(){delete this[t]}:"function"==typeof e?function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}:function(){this[t]=e}}function un(e){return"function"==typeof e?e:(e=R.ns.qualify(e)).local?function(){return this.ownerDocument.createElementNS(e.space,e.local)}:function(){var n=this.ownerDocument,t=this.namespaceURI;return t?n.createElementNS(t,e):n.createElement(e)}}function on(){var n=this.parentNode;n&&n.removeChild(this)}function an(n){return{__data__:n}}function ln(n){return function(){return V(this,n)}}function cn(n,t){for(var e=0,r=n.length;e<r;e++)for(var i,u=n[e],o=0,a=u.length;o<a;o++)(i=u[o])&&t(i,o,e);return n}function fn(n){return O(n,sn),n}R.ns={prefix:W,qualify:function(n){var t=n.indexOf(":"),e=n;return 0<=t&&"xmlns"!==(e=n.slice(0,t))&&(n=n.slice(t+1)),W.hasOwnProperty(e)?{space:W[e],local:n}:n}},X.attr=function(n,t){if(arguments.length<2){if("string"==typeof n){var e=this.node();return(n=R.ns.qualify(n)).local?e.getAttributeNS(n.space,n.local):e.getAttribute(n)}for(t in n)this.each(J(t,n[t]));return this}return this.each(J(n,t))},X.classed=function(n,t){if(arguments.length<2){if("string"==typeof n){var e=this.node(),r=(n=Q(n)).length,i=-1;if(t=e.classList){for(;++i<r;)if(!t.contains(n[i]))return!1}else for(t=e.getAttribute("class");++i<r;)if(!K(n[i]).test(t))return!1;return!0}for(t in n)this.each(nn(t,n[t]));return this}return this.each(nn(n,t))},X.style=function(n,t,e){var r=arguments.length;if(r<3){if("string"!=typeof n){for(e in r<2&&(t=""),n)this.each(en(e,n[e],t));return this}if(r<2){var i=this.node();return D(i).getComputedStyle(i,null).getPropertyValue(n)}e=""}return this.each(en(n,t,e))},X.property=function(n,t){if(arguments.length<2){if("string"==typeof n)return this.node()[n];for(t in n)this.each(rn(t,n[t]));return this}return this.each(rn(n,t))},X.text=function(t){return arguments.length?this.each("function"==typeof t?function(){var n=t.apply(this,arguments);this.textContent=null==n?"":n}:null==t?function(){this.textContent=""}:function(){this.textContent=t}):this.node().textContent},X.html=function(t){return arguments.length?this.each("function"==typeof t?function(){var n=t.apply(this,arguments);this.innerHTML=null==n?"":n}:null==t?function(){this.innerHTML=""}:function(){this.innerHTML=t}):this.node().innerHTML},X.append=function(n){return n=un(n),this.select(function(){return this.appendChild(n.apply(this,arguments))})},X.insert=function(n,t){return n=un(n),t=$(t),this.select(function(){return this.insertBefore(n.apply(this,arguments),t.apply(this,arguments)||null)})},X.remove=function(){return this.each(on)},X.data=function(n,g){var t,e,r=-1,i=this.length;if(!arguments.length){for(n=new Array(i=(t=this[0]).length);++r<i;)(e=t[r])&&(n[r]=e.__data__);return n}function u(n,t){var e,r,i=n.length,u=t.length,o=Math.min(i,u),a=new Array(u),l=new Array(u),c=new Array(i);if(g){for(var f,s=new m,h=new Array(i),p=-1;++p<i;)(e=n[p])&&(s.has(f=g.call(e,e.__data__,p))?c[p]=e:s.set(f,e),h[p]=f);for(p=-1;++p<u;)(e=s.get(f=g.call(t,r=t[p],p)))?!0!==e&&((a[p]=e).__data__=r):l[p]=an(r),s.set(f,!0);for(p=-1;++p<i;)p in h&&!0!==s.get(h[p])&&(c[p]=n[p])}else{for(p=-1;++p<o;)e=n[p],r=t[p],e?(e.__data__=r,a[p]=e):l[p]=an(r);for(;p<u;++p)l[p]=an(t[p]);for(;p<i;++p)c[p]=n[p]}l.update=a,l.parentNode=a.parentNode=c.parentNode=n.parentNode,v.push(l),d.push(a),y.push(c)}var v=fn([]),d=I([]),y=I([]);if("function"==typeof n)for(;++r<i;)u(t=this[r],n.call(t,t.parentNode.__data__,r));else for(;++r<i;)u(t=this[r],n);return d.enter=function(){return v},d.exit=function(){return y},d},X.datum=function(n){return arguments.length?this.property("__data__",n):this.property("__data__")},X.filter=function(n){var t,e,r,i=[];"function"!=typeof n&&(n=ln(n));for(var u=0,o=this.length;u<o;u++){i.push(t=[]),t.parentNode=(e=this[u]).parentNode;for(var a=0,l=e.length;a<l;a++)(r=e[a])&&n.call(r,r.__data__,a,u)&&t.push(r)}return I(i)},X.order=function(){for(var n=-1,t=this.length;++n<t;)for(var e,r=this[n],i=r.length-1,u=r[i];0<=--i;)(e=r[i])&&(u&&u!==e.nextSibling&&u.parentNode.insertBefore(e,u),u=e);return this},X.sort=function(n){n=function(e){arguments.length||(e=l);return function(n,t){return n&&t?e(n.__data__,t.__data__):!n-!t}}.apply(this,arguments);for(var t=-1,e=this.length;++t<e;)this[t].sort(n);return this.order()},X.each=function(r){return cn(this,function(n,t,e){r.call(n,n.__data__,t,e)})},X.call=function(n){var t=h(arguments);return n.apply(t[0]=this,t),this},X.empty=function(){return!this.node()},X.node=function(){for(var n=0,t=this.length;n<t;n++)for(var e=this[n],r=0,i=e.length;r<i;r++){var u=e[r];if(u)return u}return null},X.size=function(){var n=0;return cn(this,function(){++n}),n};var sn=[];function hn(i,t,e){var r="__on"+i,n=i.indexOf("."),u=gn;0<n&&(i=i.slice(0,n));var o=pn.get(i);function a(){var n=this[r];n&&(this.removeEventListener(i,n,n.$),delete this[r])}return o&&(i=o,u=vn),n?t?function(){var n=u(t,h(arguments));a.call(this),this.addEventListener(i,this[r]=n,n.$=e),n._=t}:a:t?z:function(){var n,t,e=new RegExp("^__on([^.]+)"+R.requote(i)+"$");for(var r in this){(n=r.match(e))&&(t=this[r],this.removeEventListener(n[1],t,t.$),delete this[r])}}}R.selection.enter=fn,(R.selection.enter.prototype=sn).append=X.append,sn.empty=X.empty,sn.node=X.node,sn.call=X.call,sn.size=X.size,sn.select=function(n){for(var t,e,r,i,u,o=[],a=-1,l=this.length;++a<l;){r=(i=this[a]).update,o.push(t=[]),t.parentNode=i.parentNode;for(var c=-1,f=i.length;++c<f;)(u=i[c])?(t.push(r[c]=e=n.call(i.parentNode,u.__data__,c,a)),e.__data__=u.__data__):t.push(null)}return I(o)},sn.insert=function(n,t){var o,a,l;return arguments.length<2&&(o=this,t=function(n,t,e){var r,i=o[e].update,u=i.length;for(e!=l&&(l=e,a=0),a<=t&&(a=t+1);!(r=i[a])&&++a<u;);return r}),X.insert.call(this,n,t)},R.select=function(n){var t;return"string"==typeof n?(t=[Y(n,M)]).parentNode=M.documentElement:(t=[n]).parentNode=a(n),I([t])},R.selectAll=function(n){var t;return"string"==typeof n?(t=h(Z(n,M))).parentNode=M.documentElement:(t=h(n)).parentNode=null,I([t])},X.on=function(n,t,e){var r=arguments.length;if(r<3){if("string"!=typeof n){for(e in r<2&&(t=!1),n)this.each(hn(e,n[e],t));return this}if(r<2)return(r=this.node()["__on"+n])&&r._;e=!1}return this.each(hn(n,t,e))};var pn=R.map({mouseenter:"mouseover",mouseleave:"mouseout"});function gn(e,r){return function(n){var t=R.event;R.event=n,r[0]=this.__data__;try{e.apply(this,r)}finally{R.event=t}}}function vn(n,t){var e=gn(n,t);return function(n){var t=n.relatedTarget;t&&(t===this||8&t.compareDocumentPosition(this))||e.call(this,n)}}M&&pn.forEach(function(n){"on"+n in M&&pn.remove(n)});var dn,yn=0;function mn(n){var e,r,i=".dragsuppress-"+ ++yn,u="click"+i,o=R.select(D(n)).on("touchmove"+i,j).on("dragstart"+i,j).on("selectstart"+i,j);return null==dn&&(dn=!("onselectstart"in n)&&A(n.style,"userSelect")),dn&&(e=a(n).style,r=e[dn],e[dn]="none"),function(n){var t;o.on(i,null),dn&&(e[dn]=r),n&&(t=function(){o.on(u,null)},o.on(u,function(){j(),t()},!0),setTimeout(t,0))}}R.mouse=function(n){return xn(n,U())};var Mn=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function xn(n,t){t.changedTouches&&(t=t.changedTouches[0]);var e=n.ownerSVGElement||n;if(e.createSVGPoint){var r,i,u=e.createSVGPoint();return Mn<0&&(((r=D(n)).scrollX||r.scrollY)&&(i=(e=R.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"))[0][0].getScreenCTM(),Mn=!(i.f||i.e),e.remove())),Mn?(u.x=t.pageX,u.y=t.pageY):(u.x=t.clientX,u.y=t.clientY),[(u=u.matrixTransform(n.getScreenCTM().inverse())).x,u.y]}var o=n.getBoundingClientRect();return[t.clientX-o.left-n.clientLeft,t.clientY-o.top-n.clientTop]}function bn(){return R.event.changedTouches[0].identifier}R.touch=function(n,t,e){if(arguments.length<3&&(e=t,t=U().changedTouches),t)for(var r,i=0,u=t.length;i<u;++i)if((r=t[i]).identifier===e)return xn(n,r)},R.behavior.drag=function(){var v=F(e,"drag","dragstart","dragend"),d=null,n=r(z,R.mouse,D,"mousemove","mouseup"),t=r(bn,R.touch,P,"touchmove","touchend");function e(){this.on("mousedown.drag",n).on("touchstart.drag",t)}function r(f,s,h,p,g){return function(){var r,n=R.event.target,i=this.parentNode,u=v.of(this,arguments),o=0,a=f(),t=".drag"+(null==a?"":"-"+a),e=R.select(h(n)).on(p+t,function(){var n,t,e=s(i,a);if(!e)return;n=e[0]-c[0],t=e[1]-c[1],o|=n|t,u({type:"drag",x:(c=e)[0]+r[0],y:e[1]+r[1],dx:n,dy:t})}).on(g+t,function(){if(!s(i,a))return;e.on(p+t,null).on(g+t,null),l(o),u({type:"dragend"})}),l=mn(n),c=s(i,a);r=d?[(r=d.apply(this,arguments)).x-c[0],r.y-c[1]]:[0,0],u({type:"dragstart"})}}return e.origin=function(n){return arguments.length?(d=n,e):d},R.rebind(e,v,"on")},R.touches=function(e,n){return arguments.length<2&&(n=U().touches),n?h(n).map(function(n){var t=xn(e,n);return t.identifier=n.identifier,t}):[]};var _n=1e-6,wn=_n*_n,Sn=Math.PI,kn=2*Sn,Nn=kn-_n,En=Sn/2,An=Sn/180,Cn=180/Sn;function zn(n){return 0<n?1:n<0?-1:0}function Ln(n,t,e){return(t[0]-n[0])*(e[1]-n[1])-(t[1]-n[1])*(e[0]-n[0])}function qn(n){return 1<n?0:n<-1?Sn:Math.acos(n)}function Tn(n){return 1<n?En:n<-1?-En:Math.asin(n)}function Rn(n){return((n=Math.exp(n))+1/n)/2}function Dn(n){return(n=Math.sin(n/2))*n}var Pn=Math.SQRT2;R.interpolateZoom=function(n,t){var o,e,r,a,l,i,c=n[0],f=n[1],s=n[2],u=t[0],h=t[1],p=t[2],g=u-c,v=h-f,d=g*g+v*v;return(i=d<wn?(l=Math.log(p/s)/Pn,function(n){return[c+n*g,f+n*v,s*Math.exp(Pn*n*l)]}):(o=Math.sqrt(d),e=(p*p-s*s+4*d)/(2*s*2*o),r=(p*p-s*s-4*d)/(2*p*2*o),a=Math.log(Math.sqrt(e*e+1)-e),l=(Math.log(Math.sqrt(r*r+1)-r)-a)/Pn,function(n){var t,e,r=n*l,i=Rn(a),u=s/(2*o)*(i*(e=Pn*r+a,((e=Math.exp(2*e))-1)/(e+1))-(t=a,((t=Math.exp(t))-1/t)/2));return[c+u*g,f+u*v,s*i/Rn(Pn*r+a)]})).duration=1e3*l,i},R.behavior.zoom=function(){var t,l,e,r,x,i,u,o,a,b={x:0,y:0,k:1},c=[960,500],f=Fn,s=250,h=0,_="mousedown.zoom",p="mousemove.zoom",g="mouseup.zoom",w="touchstart.zoom",S=F(v,"zoomstart","zoom","zoomend");function v(n){n.on(_,q).on(Un+".zoom",y).on("dblclick.zoom",m).on(w,T)}function k(n){return[(n[0]-b.x)/b.k,(n[1]-b.y)/b.k]}function N(n){b.k=Math.max(f[0],Math.min(f[1],n))}function E(n,t){var e;t=[(e=t)[0]*b.k+b.x,e[1]*b.k+b.y],b.x+=n[0]-t[0],b.y+=n[1]-t[1]}function A(n,t,e,r){n.__chart__={x:b.x,y:b.y,k:b.k},N(Math.pow(2,r)),E(l=t,e),n=R.select(n),0<s&&(n=n.transition().duration(s)),n.call(v.event)}function d(){u&&u.domain(i.range().map(function(n){return(n-b.x)/b.k}).map(i.invert)),a&&a.domain(o.range().map(function(n){return(n-b.y)/b.k}).map(o.invert))}function C(n){h++||n({type:"zoomstart"})}function z(n){d(),n({type:"zoom",scale:b.k,translate:[b.x,b.y]})}function L(n){--h||(n({type:"zoomend"}),l=null)}function q(){var n=this,t=S.of(n,arguments),e=0,r=R.select(D(n)).on(p,function(){e=1,E(R.mouse(n),i),z(t)}).on(g,function(){r.on(p,null).on(g,null),u(e),L(t)}),i=k(R.mouse(n)),u=mn(n);Ta.call(n),C(t)}function T(){var c,f=this,s=S.of(f,arguments),h={},p=0,i=".zoom-"+R.event.changedTouches[0].identifier,g="touchmove"+i,v="touchend"+i,d=[],u=R.select(f),o=mn(f);function y(){var n=R.touches(f);return c=b.k,n.forEach(function(n){n.identifier in h&&(h[n.identifier]=k(n))}),n}function n(){var n=R.event.target;R.select(n).on(g,m).on(v,M),d.push(n);for(var t=R.event.changedTouches,e=0,r=t.length;e<r;++e)h[t[e].identifier]=null;var i,u,o,a,l=y(),c=Date.now();1===l.length?(c-x<500&&(i=l[0],A(f,i,h[i.identifier],Math.floor(Math.log(b.k)/Math.LN2)+1),j()),x=c):1<l.length&&(i=l[0],u=l[1],o=i[0]-u[0],a=i[1]-u[1],p=o*o+a*a)}function m(){var n,t,e=R.touches(f);Ta.call(f);for(var r,i,u,o,a=0,l=e.length;a<l;++a,t=null)if(n=e[a],t=h[n.identifier]){if(o)break;u=n,o=t}t&&(r=(r=n[0]-u[0])*r+(r=n[1]-u[1])*r,i=p&&Math.sqrt(r/p),u=[(u[0]+n[0])/2,(u[1]+n[1])/2],o=[(o[0]+t[0])/2,(o[1]+t[1])/2],N(i*c)),x=null,E(u,o),z(s)}function M(){if(R.event.touches.length){for(var n=R.event.changedTouches,t=0,e=n.length;t<e;++t)delete h[n[t].identifier];for(var r in h)return void y()}R.selectAll(d).on(i,null),u.on(_,q).on(w,T),o(),L(s)}n(),C(s),u.on(_,null).on(w,n)}function y(){var n=S.of(this,arguments);r?clearTimeout(r):(Ta.call(this),t=k(l=e||R.mouse(this)),C(n)),r=setTimeout(function(){r=null,L(n)},50),j(),N(Math.pow(2,.002*jn())*b.k),E(l,t),z(n)}function m(){var n=R.mouse(this),t=Math.log(b.k)/Math.LN2;A(this,n,k(n),R.event.shiftKey?Math.ceil(t)-1:Math.floor(t)+1)}return Un=Un||("onwheel"in M?(jn=function(){return-R.event.deltaY*(R.event.deltaMode?120:1)},"wheel"):"onmousewheel"in M?(jn=function(){return R.event.wheelDelta},"mousewheel"):(jn=function(){return-R.event.detail},"MozMousePixelScroll")),v.event=function(n){n.each(function(){var a=S.of(this,arguments),t=b;Pa?R.select(this).transition().each("start.zoom",function(){b=this.__chart__||{x:0,y:0,k:1},C(a)}).tween("zoom:zoom",function(){var r=c[0],n=c[1],i=l?l[0]:r/2,u=l?l[1]:n/2,o=R.interpolateZoom([(i-b.x)/b.k,(u-b.y)/b.k,r/b.k],[(i-t.x)/t.k,(u-t.y)/t.k,r/t.k]);return function(n){var t=o(n),e=r/t[2];this.__chart__=b={x:i-t[0]*e,y:u-t[1]*e,k:e},z(a)}}).each("interrupt.zoom",function(){L(a)}).each("end.zoom",function(){L(a)}):(this.__chart__=b,C(a),z(a),L(a))})},v.translate=function(n){return arguments.length?(b={x:+n[0],y:+n[1],k:b.k},d(),v):[b.x,b.y]},v.scale=function(n){return arguments.length?(b={x:b.x,y:b.y,k:null},N(+n),d(),v):b.k},v.scaleExtent=function(n){return arguments.length?(f=null==n?Fn:[+n[0],+n[1]],v):f},v.center=function(n){return arguments.length?(e=n&&[+n[0],+n[1]],v):e},v.size=function(n){return arguments.length?(c=n&&[+n[0],+n[1]],v):c},v.duration=function(n){return arguments.length?(s=+n,v):s},v.x=function(n){return arguments.length?(i=(u=n).copy(),b={x:0,y:0,k:1},v):u},v.y=function(n){return arguments.length?(o=(a=n).copy(),b={x:0,y:0,k:1},v):a},R.rebind(v,S,"on")};var jn,Un,Fn=[0,1/0];function Hn(){}function On(n,t,e){return this instanceof On?(this.h=+n,this.s=+t,void(this.l=+e)):arguments.length<2?n instanceof On?new On(n.h,n.s,n.l):ct(""+n,ft,On):new On(n,t,e)}(R.color=Hn).prototype.toString=function(){return this.rgb()+""};var In=(R.hsl=On).prototype=new Hn;function Yn(n,t,e){var r,i;function u(n){return Math.round(255*(360<(t=n)?t-=360:t<0&&(t+=360),t<60?r+(i-r)*t/60:t<180?i:t<240?r+(i-r)*(240-t)/60:r));var t}return n=isNaN(n)?0:(n%=360)<0?n+360:n,t=isNaN(t)||t<0?0:1<t?1:t,r=2*(e=e<0?0:1<e?1:e)-(i=e<=.5?e*(1+t):e+t-e*t),new it(u(n+120),u(n),u(n-120))}function Zn(n,t,e){return this instanceof Zn?(this.h=+n,this.c=+t,void(this.l=+e)):arguments.length<2?n instanceof Zn?new Zn(n.h,n.c,n.l):nt(n instanceof $n?n.l:(n=st((n=R.rgb(n)).r,n.g,n.b)).l,n.a,n.b):new Zn(n,t,e)}In.brighter=function(n){return n=Math.pow(.7,arguments.length?n:1),new On(this.h,this.s,this.l/n)},In.darker=function(n){return n=Math.pow(.7,arguments.length?n:1),new On(this.h,this.s,n*this.l)},In.rgb=function(){return Yn(this.h,this.s,this.l)};var Vn=(R.hcl=Zn).prototype=new Hn;function Xn(n,t,e){return isNaN(n)&&(n=0),isNaN(t)&&(t=0),new $n(e,Math.cos(n*=An)*t,Math.sin(n)*t)}function $n(n,t,e){return this instanceof $n?(this.l=+n,this.a=+t,void(this.b=+e)):arguments.length<2?n instanceof $n?new $n(n.l,n.a,n.b):n instanceof Zn?Xn(n.h,n.c,n.l):st((n=it(n)).r,n.g,n.b):new $n(n,t,e)}Vn.brighter=function(n){return new Zn(this.h,this.c,Math.min(100,this.l+Bn*(arguments.length?n:1)))},Vn.darker=function(n){return new Zn(this.h,this.c,Math.max(0,this.l-Bn*(arguments.length?n:1)))},Vn.rgb=function(){return Xn(this.h,this.c,this.l).rgb()},R.lab=$n;var Bn=18,Wn=.95047,Jn=1,Gn=1.08883,Kn=$n.prototype=new Hn;function Qn(n,t,e){var r=(n+16)/116,i=r+t/500,u=r-e/200;return new it(rt(3.2404542*(i=tt(i)*Wn)-1.5371385*(r=tt(r)*Jn)-.4985314*(u=tt(u)*Gn)),rt(-.969266*i+1.8760108*r+.041556*u),rt(.0556434*i-.2040259*r+1.0572252*u))}function nt(n,t,e){return 0<n?new Zn(Math.atan2(e,t)*Cn,Math.sqrt(t*t+e*e),n):new Zn(NaN,NaN,n)}function tt(n){return.206893034<n?n*n*n:(n-4/29)/7.787037}function et(n){return.008856<n?Math.pow(n,1/3):7.787037*n+4/29}function rt(n){return Math.round(255*(n<=.00304?12.92*n:1.055*Math.pow(n,1/2.4)-.055))}function it(n,t,e){return this instanceof it?(this.r=~~n,this.g=~~t,void(this.b=~~e)):arguments.length<2?n instanceof it?new it(n.r,n.g,n.b):ct(""+n,it,Yn):new it(n,t,e)}function ut(n){return new it(n>>16,n>>8&255,255&n)}function ot(n){return ut(n)+""}Kn.brighter=function(n){return new $n(Math.min(100,this.l+Bn*(arguments.length?n:1)),this.a,this.b)},Kn.darker=function(n){return new $n(Math.max(0,this.l-Bn*(arguments.length?n:1)),this.a,this.b)},Kn.rgb=function(){return Qn(this.l,this.a,this.b)};var at=(R.rgb=it).prototype=new Hn;function lt(n){return n<16?"0"+Math.max(0,n).toString(16):Math.min(255,n).toString(16)}function ct(n,t,e){var r,i,u=0,o=0,a=0,l=/([a-z]+)\((.*)\)/.exec(n=n.toLowerCase());if(l)switch(r=l[2].split(","),l[1]){case"hsl":return e(parseFloat(r[0]),parseFloat(r[1])/100,parseFloat(r[2])/100);case"rgb":return t(pt(r[0]),pt(r[1]),pt(r[2]))}return(i=gt.get(n))?t(i.r,i.g,i.b):(null==n||"#"!==n.charAt(0)||isNaN(i=parseInt(n.slice(1),16))||(4===n.length?(u=(3840&i)>>4,u|=u>>4,o=240&i,o|=o>>4,a=15&i,a|=a<<4):7===n.length&&(u=(16711680&i)>>16,o=(65280&i)>>8,a=255&i)),t(u,o,a))}function ft(n,t,e){var r,i,u=Math.min(n/=255,t/=255,e/=255),o=Math.max(n,t,e),a=o-u,l=(o+u)/2;return a?(i=l<.5?a/(o+u):a/(2-o-u),r=n==o?(t-e)/a+(t<e?6:0):t==o?(e-n)/a+2:(n-t)/a+4,r*=60):(r=NaN,i=0<l&&l<1?0:r),new On(r,i,l)}function st(n,t,e){var r=et((.4124564*(n=ht(n))+.3575761*(t=ht(t))+.1804375*(e=ht(e)))/Wn),i=et((.2126729*n+.7151522*t+.072175*e)/Jn);return $n(116*i-16,500*(r-i),200*(i-et((.0193339*n+.119192*t+.9503041*e)/Gn)))}function ht(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function pt(n){var t=parseFloat(n);return"%"===n.charAt(n.length-1)?Math.round(2.55*t):t}at.brighter=function(n){n=Math.pow(.7,arguments.length?n:1);var t=this.r,e=this.g,r=this.b;return t||e||r?(t&&t<30&&(t=30),e&&e<30&&(e=30),r&&r<30&&(r=30),new it(Math.min(255,t/n),Math.min(255,e/n),Math.min(255,r/n))):new it(30,30,30)},at.darker=function(n){return new it((n=Math.pow(.7,arguments.length?n:1))*this.r,n*this.g,n*this.b)},at.hsl=function(){return ft(this.r,this.g,this.b)},at.toString=function(){return"#"+lt(this.r)+lt(this.g)+lt(this.b)};var gt=R.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});function vt(n){return"function"==typeof n?n:function(){return n}}function dt(r){return function(n,t,e){return 2===arguments.length&&"function"==typeof t&&(e=t,t=null),yt(n,t,r,e)}}function yt(i,u,o,n){var e,a={},l=R.dispatch("beforesend","progress","load","error"),c={},f=new XMLHttpRequest,s=null;function t(){var n,t,e,r=f.status;if(!r&&((e=(t=f).responseType)&&"text"!==e?t.response:t.responseText)||200<=r&&r<300||304===r){try{n=o.call(a,f)}catch(n){return void l.error.call(a,n)}l.load.call(a,n)}else l.error.call(a,f)}return!this.XDomainRequest||"withCredentials"in f||!/^(http(s)?:)?\/\//.test(i)||(f=new XDomainRequest),"onload"in f?f.onload=f.onerror=t:f.onreadystatechange=function(){3<f.readyState&&t()},f.onprogress=function(n){var t=R.event;R.event=n;try{l.progress.call(a,f)}finally{R.event=t}},a.header=function(n,t){return n=(n+"").toLowerCase(),arguments.length<2?c[n]:(null==t?delete c[n]:c[n]=t+"",a)},a.mimeType=function(n){return arguments.length?(u=null==n?null:n+"",a):u},a.responseType=function(n){return arguments.length?(s=n,a):s},a.response=function(n){return o=n,a},["get","post"].forEach(function(n){a[n]=function(){return a.send.apply(a,[n].concat(h(arguments)))}}),a.send=function(n,t,e){if(2===arguments.length&&"function"==typeof t&&(e=t,t=null),f.open(n,i,!0),null==u||"accept"in c||(c.accept=u+",*/*"),f.setRequestHeader)for(var r in c)f.setRequestHeader(r,c[r]);return null!=u&&f.overrideMimeType&&f.overrideMimeType(u),null!=s&&(f.responseType=s),null!=e&&a.on("error",e).on("load",function(n){e(null,n)}),l.beforesend.call(a,f),f.send(null==t?null:t),a},a.abort=function(){return f.abort(),a},R.rebind(a,l,"on"),null==n?a:a.get(1===(e=n).length?function(n,t){e(null==n?t:null)}:e)}gt.forEach(function(n,t){gt.set(n,ut(t))}),R.functor=vt,R.xhr=dt(P),R.dsv=function(i,u){var t=new RegExp('["'+i+"\n]"),h=i.charCodeAt(0);function o(n,t,e){arguments.length<3&&(e=t,t=null);var r=yt(n,u,null==t?a:l(t),e);return r.row=function(n){return arguments.length?r.response(null==(t=n)?a:l(n)):t},r}function a(n){return o.parse(n.responseText)}function l(t){return function(n){return o.parse(n.responseText,t)}}function e(n){return n.map(c).join(i)}function c(n){return t.test(n)?'"'+n.replace(/\"/g,'""')+'"':n}return o.parse=function(n,r){var i;return o.parseRows(n,function(n,t){if(i)return i(n,t-1);var e=new Function("d","return {"+n.map(function(n,t){return JSON.stringify(n)+": d["+t+"]"}).join(",")+"}");i=r?function(n,t){return r(e(n),t)}:e})},o.parseRows=function(i,n){var t,u,o={},a={},e=[],l=i.length,c=0,r=0;function f(){if(l<=c)return a;if(u)return u=!1,o;var n=c;if(34===i.charCodeAt(n)){for(var t=n;t++<l;)if(34===i.charCodeAt(t)){if(34!==i.charCodeAt(t+1))break;++t}return c=t+2,13===(e=i.charCodeAt(t+1))?(u=!0,10===i.charCodeAt(t+2)&&++c):10===e&&(u=!0),i.slice(n+1,t).replace(/""/g,'"')}for(;c<l;){var e,r=1;if(10===(e=i.charCodeAt(c++)))u=!0;else if(13===e)u=!0,10===i.charCodeAt(c)&&(++c,++r);else if(e!==h)continue;return i.slice(n,c-r)}return i.slice(n)}for(;(t=f())!==a;){for(var s=[];t!==o&&t!==a;)s.push(t),t=f();n&&null==(s=n(s,r++))||e.push(s)}return e},o.format=function(n){if(Array.isArray(n[0]))return o.formatRows(n);var e=new N,r=[];return n.forEach(function(n){for(var t in n)e.has(t)||r.push(e.add(t))}),[r.map(c).join(i)].concat(n.map(function(t){return r.map(function(n){return c(t[n])}).join(i)})).join("\n")},o.formatRows=function(n){return n.map(e).join("\n")},o},R.csv=R.dsv(",","text/csv"),R.tsv=R.dsv("\t","text/tab-separated-values");var mt,Mt,xt,bt,_t=this[A(this,"requestAnimationFrame")]||function(n){setTimeout(n,17)};function wt(n,t,e){var r=arguments.length;r<2&&(t=0),r<3&&(e=Date.now());var i={c:n,t:e+t,n:null};return Mt?Mt.n=i:mt=i,Mt=i,xt||(bt=clearTimeout(bt),xt=1,_t(St)),i}function St(){var n=kt(),t=Nt()-n;24<t?(isFinite(t)&&(clearTimeout(bt),bt=setTimeout(St,t)),xt=0):(xt=1,_t(St))}function kt(){for(var n=Date.now(),t=mt;t;)n>=t.t&&t.c(n-t.t)&&(t.c=null),t=t.n;return n}function Nt(){for(var n,t=mt,e=1/0;t;)t=t.c?(t.t<e&&(e=t.t),(n=t).n):n?n.n=t.n:mt=t.n;return Mt=n,e}function Et(n,t){return t-(n?Math.ceil(Math.log(n)/Math.LN10):1)}R.timer=function(){wt.apply(this,arguments)},R.timer.flush=function(){kt(),Nt()},R.round=function(n,t){return t?Math.round(n*(t=Math.pow(10,t)))/t:Math.round(n)};var At=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(function(n,t){var e=Math.pow(10,3*T(8-t));return{scale:8<t?function(n){return n/e}:function(n){return n*e},symbol:n}});R.formatPrefix=function(n,t){var e=0;return(n=+n)&&(n<0&&(n*=-1),t&&(n=R.round(n,Et(n,t))),e=1+Math.floor(1e-12+Math.log(n)/Math.LN10),e=Math.max(-24,Math.min(24,3*Math.floor((e-1)/3)))),At[8+e/3]};var Ct=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,zt=R.map({b:function(n){return n.toString(2)},c:function(n){return String.fromCharCode(n)},o:function(n){return n.toString(8)},x:function(n){return n.toString(16)},X:function(n){return n.toString(16).toUpperCase()},g:function(n,t){return n.toPrecision(t)},e:function(n,t){return n.toExponential(t)},f:function(n,t){return n.toFixed(t)},r:function(n,t){return(n=R.round(n,Et(n,t))).toFixed(Math.max(0,Math.min(20,Et(n*(1+1e-15),t))))}});function Lt(n){return n+""}var qt=R.time={},Tt=Date;function Rt(){this._=new Date(1<arguments.length?Date.UTC.apply(this,arguments):arguments[0])}Rt.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){Dt.setUTCDate.apply(this._,arguments)},setDay:function(){Dt.setUTCDay.apply(this._,arguments)},setFullYear:function(){Dt.setUTCFullYear.apply(this._,arguments)},setHours:function(){Dt.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){Dt.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){Dt.setUTCMinutes.apply(this._,arguments)},setMonth:function(){Dt.setUTCMonth.apply(this._,arguments)},setSeconds:function(){Dt.setUTCSeconds.apply(this._,arguments)},setTime:function(){Dt.setTime.apply(this._,arguments)}};var Dt=Date.prototype;function Pt(r,u,o){function n(n){var t=r(n),e=i(t,1);return n-t<e-n?t:e}function a(n){return u(n=r(new Tt(n-1)),1),n}function i(n,t){return u(n=new Tt(+n),t),n}function l(n,t,e){var r=a(n),i=[];if(1<e)for(;r<t;)o(r)%e||i.push(new Date(+r)),u(r,1);else for(;r<t;)i.push(new Date(+r)),u(r,1);return i}(r.floor=r).round=n,r.ceil=a,r.offset=i,r.range=l;var t=r.utc=jt(r);return(t.floor=t).round=jt(n),t.ceil=jt(a),t.offset=jt(i),t.range=function(n,t,e){try{var r=new(Tt=Rt);return r._=n,l(r,t,e)}finally{Tt=Date}},r}function jt(r){return function(n,t){try{var e=new(Tt=Rt);return e._=n,r(e,t)._}finally{Tt=Date}}}function Ut(n){var t=n.dateTime,e=n.date,r=n.time,i=n.periods,u=n.days,o=n.shortDays,a=n.months,l=n.shortMonths;function c(a){var l=a.length;function n(n){for(var t,e,r,i=[],u=-1,o=0;++u<l;)37===a.charCodeAt(u)&&(i.push(a.slice(o,u)),null!=(e=Ft[t=a.charAt(++u)])&&(t=a.charAt(++u)),(r=x[t])&&(t=r(n,null==e?"e"===t?" ":"0":e)),i.push(t),o=u+1);return i.push(a.slice(o,u)),i.join("")}return n.parse=function(n){var t={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null};if(f(t,a,n,0)!=n.length)return null;"p"in t&&(t.H=t.H%12+12*t.p);var e=null!=t.Z&&Tt!==Rt,r=new(e?Rt:Tt);return"j"in t?r.setFullYear(t.y,0,t.j):"W"in t||"U"in t?("w"in t||(t.w="W"in t?1:0),r.setFullYear(t.y,0,1),r.setFullYear(t.y,0,"W"in t?(t.w+6)%7+7*t.W-(r.getDay()+5)%7:t.w+7*t.U-(r.getDay()+6)%7)):r.setFullYear(t.y,t.m,t.d),r.setHours(t.H+(t.Z/100|0),t.M+t.Z%100,t.S,t.L),e?r._:r},n.toString=function(){return a},n}function f(n,t,e,r){for(var i,u,o,a=0,l=t.length,c=e.length;a<l;){if(c<=r)return-1;if(37===(i=t.charCodeAt(a++))){if(o=t.charAt(a++),!(u=b[o in Ft?t.charAt(a++):o])||(r=u(n,e,r))<0)return-1}else if(i!=e.charCodeAt(r++))return-1}return r}c.multi=(c.utc=function(n){var e=c(n);function t(n){try{var t=new(Tt=Rt);return t._=n,e(t)}finally{Tt=Date}}return t.parse=function(n){try{Tt=Rt;var t=e.parse(n);return t&&t._}finally{Tt=Date}},t.toString=e.toString,t}).multi=oe;var s=R.map(),h=Yt(u),p=Zt(u),g=Yt(o),v=Zt(o),d=Yt(a),y=Zt(a),m=Yt(l),M=Zt(l);i.forEach(function(n,t){s.set(n.toLowerCase(),t)});var x={a:function(n){return o[n.getDay()]},A:function(n){return u[n.getDay()]},b:function(n){return l[n.getMonth()]},B:function(n){return a[n.getMonth()]},c:c(t),d:function(n,t){return It(n.getDate(),t,2)},e:function(n,t){return It(n.getDate(),t,2)},H:function(n,t){return It(n.getHours(),t,2)},I:function(n,t){return It(n.getHours()%12||12,t,2)},j:function(n,t){return It(1+qt.dayOfYear(n),t,3)},L:function(n,t){return It(n.getMilliseconds(),t,3)},m:function(n,t){return It(n.getMonth()+1,t,2)},M:function(n,t){return It(n.getMinutes(),t,2)},p:function(n){return i[+(12<=n.getHours())]},S:function(n,t){return It(n.getSeconds(),t,2)},U:function(n,t){return It(qt.sundayOfYear(n),t,2)},w:function(n){return n.getDay()},W:function(n,t){return It(qt.mondayOfYear(n),t,2)},x:c(e),X:c(r),y:function(n,t){return It(n.getFullYear()%100,t,2)},Y:function(n,t){return It(n.getFullYear()%1e4,t,4)},Z:ie,"%":function(){return"%"}},b={a:function(n,t,e){g.lastIndex=0;var r=g.exec(t.slice(e));return r?(n.w=v.get(r[0].toLowerCase()),e+r[0].length):-1},A:function(n,t,e){h.lastIndex=0;var r=h.exec(t.slice(e));return r?(n.w=p.get(r[0].toLowerCase()),e+r[0].length):-1},b:function(n,t,e){m.lastIndex=0;var r=m.exec(t.slice(e));return r?(n.m=M.get(r[0].toLowerCase()),e+r[0].length):-1},B:function(n,t,e){d.lastIndex=0;var r=d.exec(t.slice(e));return r?(n.m=y.get(r[0].toLowerCase()),e+r[0].length):-1},c:function(n,t,e){return f(n,x.c.toString(),t,e)},d:Kt,e:Kt,H:ne,I:ne,j:Qt,L:re,m:Gt,M:te,p:function(n,t,e){var r=s.get(t.slice(e,e+=2).toLowerCase());return null==r?-1:(n.p=r,e)},S:ee,U:Xt,w:Vt,W:$t,x:function(n,t,e){return f(n,x.x.toString(),t,e)},X:function(n,t,e){return f(n,x.X.toString(),t,e)},y:Wt,Y:Bt,Z:Jt,"%":ue};return c}qt.year=Pt(function(n){return(n=qt.day(n)).setMonth(0,1),n},function(n,t){n.setFullYear(n.getFullYear()+t)},function(n){return n.getFullYear()}),qt.years=qt.year.range,qt.years.utc=qt.year.utc.range,qt.day=Pt(function(n){var t=new Tt(2e3,0);return t.setFullYear(n.getFullYear(),n.getMonth(),n.getDate()),t},function(n,t){n.setDate(n.getDate()+t)},function(n){return n.getDate()-1}),qt.days=qt.day.range,qt.days.utc=qt.day.utc.range,qt.dayOfYear=function(n){var t=qt.year(n);return Math.floor((n-t-6e4*(n.getTimezoneOffset()-t.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(n,e){e=7-e;var t=qt[n]=Pt(function(n){return(n=qt.day(n)).setDate(n.getDate()-(n.getDay()+e)%7),n},function(n,t){n.setDate(n.getDate()+7*Math.floor(t))},function(n){var t=qt.year(n).getDay();return Math.floor((qt.dayOfYear(n)+(t+e)%7)/7)-(t!==e)});qt[n+"s"]=t.range,qt[n+"s"].utc=t.utc.range,qt[n+"OfYear"]=function(n){var t=qt.year(n).getDay();return Math.floor((qt.dayOfYear(n)+(t+e)%7)/7)}}),qt.week=qt.sunday,qt.weeks=qt.sunday.range,qt.weeks.utc=qt.sunday.utc.range,qt.weekOfYear=qt.sundayOfYear;var Ft={"-":"",_:" ",0:"0"},Ht=/^\s*\d+/,Ot=/^%/;function It(n,t,e){var r=n<0?"-":"",i=(r?-n:n)+"",u=i.length;return r+(u<e?new Array(e-u+1).join(t)+i:i)}function Yt(n){return new RegExp("^(?:"+n.map(R.requote).join("|")+")","i")}function Zt(n){for(var t=new m,e=-1,r=n.length;++e<r;)t.set(n[e].toLowerCase(),e);return t}function Vt(n,t,e){Ht.lastIndex=0;var r=Ht.exec(t.slice(e,e+1));return r?(n.w=+r[0],e+r[0].length):-1}function Xt(n,t,e){Ht.lastIndex=0;var r=Ht.exec(t.slice(e));return r?(n.U=+r[0],e+r[0].length):-1}function $t(n,t,e){Ht.lastIndex=0;var r=Ht.exec(t.slice(e));return r?(n.W=+r[0],e+r[0].length):-1}function Bt(n,t,e){Ht.lastIndex=0;var r=Ht.exec(t.slice(e,e+4));return r?(n.y=+r[0],e+r[0].length):-1}function Wt(n,t,e){Ht.lastIndex=0;var r,i=Ht.exec(t.slice(e,e+2));return i?(n.y=(r=+i[0])+(68<r?1900:2e3),e+i[0].length):-1}function Jt(n,t,e){return/^[+-]\d{4}$/.test(t=t.slice(e,e+5))?(n.Z=-t,e+5):-1}function Gt(n,t,e){Ht.lastIndex=0;var r=Ht.exec(t.slice(e,e+2));return r?(n.m=r[0]-1,e+r[0].length):-1}function Kt(n,t,e){Ht.lastIndex=0;var r=Ht.exec(t.slice(e,e+2));return r?(n.d=+r[0],e+r[0].length):-1}function Qt(n,t,e){Ht.lastIndex=0;var r=Ht.exec(t.slice(e,e+3));return r?(n.j=+r[0],e+r[0].length):-1}function ne(n,t,e){Ht.lastIndex=0;var r=Ht.exec(t.slice(e,e+2));return r?(n.H=+r[0],e+r[0].length):-1}function te(n,t,e){Ht.lastIndex=0;var r=Ht.exec(t.slice(e,e+2));return r?(n.M=+r[0],e+r[0].length):-1}function ee(n,t,e){Ht.lastIndex=0;var r=Ht.exec(t.slice(e,e+2));return r?(n.S=+r[0],e+r[0].length):-1}function re(n,t,e){Ht.lastIndex=0;var r=Ht.exec(t.slice(e,e+3));return r?(n.L=+r[0],e+r[0].length):-1}function ie(n){var t=n.getTimezoneOffset(),e=0<t?"-":"+",r=T(t)/60|0,i=T(t)%60;return e+It(r,"0",2)+It(i,"0",2)}function ue(n,t,e){Ot.lastIndex=0;var r=Ot.exec(t.slice(e,e+1));return r?e+r[0].length:-1}function oe(r){for(var n=r.length,t=-1;++t<n;)r[t][0]=this(r[t][0]);return function(n){for(var t=0,e=r[t];!e[1](n);)e=r[++t];return e[0](n)}}R.locale=function(n){return{numberFormat:(S=(t=n).decimal,a=t.thousands,l=t.grouping,r=t.currency,k=l&&a?function(n,t){for(var e=n.length,r=[],i=0,u=l[0],o=0;0<e&&0<u&&(t<o+u+1&&(u=Math.max(1,t-o)),r.push(n.substring(e-=u,e+u)),!((o+=u+1)>t));)u=l[i=(i+1)%l.length];return r.reverse().join(a)}:P,function(n){var t=Ct.exec(n),f=t[1]||" ",s=t[2]||">",h=t[3]||"-",e=t[4]||"",p=t[5],g=+t[6],v=t[7],d=t[8],y=t[9],m=1,M="",x="",b=!1,_=!0,d=d&&+d.substring(1);switch((p||"0"===f&&"="===s)&&(p=f="0",s="="),y){case"n":v=!0,y="g";break;case"%":m=100,x="%",y="f";break;case"p":m=100,x="%",y="r";break;case"b":case"o":case"x":case"X":"#"===e&&(M="0"+y.toLowerCase());case"c":_=!1;case"d":b=!0,d=0;break;case"s":m=-1,y="r"}"$"===e&&(M=r[0],x=r[1]),"r"!=y||d||(y="g"),null!=d&&("g"==y?d=Math.max(1,Math.min(21,d)):"e"!=y&&"f"!=y||(d=Math.max(0,Math.min(20,d)))),y=zt.get(y)||Lt;var w=p&&v;return function(n){var t=x;if(b&&n%1)return"";var e,r=n<0||0===n&&1/n<0?(n=-n,"-"):"-"===h?"":h;m<0?(n=(e=R.formatPrefix(n,d)).scale(n),t=e.symbol+x):n*=m;var i,u,o,a=(n=y(n,d)).lastIndexOf(".");o=a<0?(u=_?n.lastIndexOf("e"):-1)<0?(i=n,""):(i=n.substring(0,u),n.substring(u)):(i=n.substring(0,a),S+n.substring(a+1)),!p&&v&&(i=k(i,1/0));var l=M.length+i.length+o.length+(w?0:r.length),c=l<g?new Array(l=g-l+1).join(f):"";return w&&(i=k(c+i,c.length?g-o.length:1/0)),r+=M,n=i+o,("<"===s?r+n+c:">"===s?c+r+n:"^"===s?c.substring(0,l>>=1)+r+n+c.substring(l):r+(w?n:c+n))+t}}),timeFormat:Ut(n)};var t,S,a,l,r,k};var ae=R.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function le(){}R.format=ae.numberFormat,R.geo={},le.prototype={s:0,t:0,add:function(n){fe(n,this.t,ce),fe(ce.s,this.s,this),this.s?this.t+=ce.t:this.s=ce.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var ce=new le;function fe(n,t,e){var r=e.s=n+t,i=r-n,u=r-i;e.t=n-u+(t-i)}function se(n,t){n&&pe.hasOwnProperty(n.type)&&pe[n.type](n,t)}R.geo.stream=function(n,t){n&&he.hasOwnProperty(n.type)?he[n.type](n,t):se(n,t)};var he={Feature:function(n,t){se(n.geometry,t)},FeatureCollection:function(n,t){for(var e=n.features,r=-1,i=e.length;++r<i;)se(e[r].geometry,t)}},pe={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var e=n.coordinates,r=-1,i=e.length;++r<i;)n=e[r],t.point(n[0],n[1],n[2])},LineString:function(n,t){ge(n.coordinates,t,0)},MultiLineString:function(n,t){for(var e=n.coordinates,r=-1,i=e.length;++r<i;)ge(e[r],t,0)},Polygon:function(n,t){ve(n.coordinates,t)},MultiPolygon:function(n,t){for(var e=n.coordinates,r=-1,i=e.length;++r<i;)ve(e[r],t)},GeometryCollection:function(n,t){for(var e=n.geometries,r=-1,i=e.length;++r<i;)se(e[r],t)}};function ge(n,t,e){var r,i=-1,u=n.length-e;for(t.lineStart();++i<u;)r=n[i],t.point(r[0],r[1],r[2]);t.lineEnd()}function ve(n,t){var e=-1,r=n.length;for(t.polygonStart();++e<r;)ge(n[e],t,1);t.polygonEnd()}R.geo.area=function(n){return de=0,R.geo.stream(n,Oe),de};var de,ye,me,Me,xe,be,_e,we,Se,ke,Ne,Ee,Ae,Ce,ze,Le,qe,Te,Re,De,Pe,je,Ue,Fe,He=new le,Oe={sphere:function(){de+=4*Sn},point:z,lineStart:z,lineEnd:z,polygonStart:function(){He.reset(),Oe.lineStart=Ie},polygonEnd:function(){var n=2*He;de+=n<0?4*Sn+n:n,Oe.lineStart=Oe.lineEnd=Oe.point=z}};function Ie(){var e,r,f,s,h;function i(n,t){t=t*An/2+Sn/4;var e=(n*=An)-f,r=0<=e?1:-1,i=r*e,u=Math.cos(t),o=Math.sin(t),a=h*o,l=s*u+a*Math.cos(i),c=a*r*Math.sin(i);He.add(Math.atan2(c,l)),f=n,s=u,h=o}Oe.point=function(n,t){Oe.point=i,f=(e=n)*An,s=Math.cos(t=(r=t)*An/2+Sn/4),h=Math.sin(t)},Oe.lineEnd=function(){i(e,r)}}function Ye(n){var t=n[0],e=n[1],r=Math.cos(e);return[r*Math.cos(t),r*Math.sin(t),Math.sin(e)]}function Ze(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function Ve(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function Xe(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function $e(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function Be(n){var t=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function We(n){return[Math.atan2(n[1],n[0]),Tn(n[2])]}function Je(n,t){return T(n[0]-t[0])<_n&&T(n[1]-t[1])<_n}function Ge(n,t){Ne.push(Ee=[ye=n,Me=n]),t<me&&(me=t),xe<t&&(xe=t)}function Ke(n,t){var e,r,i,u,o,a,l,c=Ye([n*An,t*An]);Se?(e=Ve(Se,c),Be(r=Ve([e[1],-e[0],0],e)),r=We(r),u=0<(i=n-be)?1:-1,o=r[0]*Cn*u,(a=180<T(i))^(u*be<o&&o<u*n)?(l=r[1]*Cn,xe<l&&(xe=l)):a^(u*be<(o=(o+360)%360-180)&&o<u*n)?(l=-r[1]*Cn)<me&&(me=l):(t<me&&(me=t),xe<t&&(xe=t)),a?n<be?ir(ye,n)>ir(ye,Me)&&(Me=n):ir(n,Me)>ir(ye,Me)&&(ye=n):ye<=Me?(n<ye&&(ye=n),Me<n&&(Me=n)):be<n?ir(ye,n)>ir(ye,Me)&&(Me=n):ir(n,Me)>ir(ye,Me)&&(ye=n)):Ge(n,t),Se=c,be=n}function Qe(){Ae.point=Ke}function nr(){Ee[0]=ye,Ee[1]=Me,Ae.point=Ge,Se=null}function tr(n,t){var e;Se?ke+=180<T(e=n-be)?e+(0<e?360:-360):e:(_e=n,we=t),Oe.point(n,t),Ke(n,t)}function er(){Oe.lineStart()}function rr(){tr(_e,we),Oe.lineEnd(),T(ke)>_n&&(ye=-(Me=180)),Ee[0]=ye,Ee[1]=Me,Se=null}function ir(n,t){return(t-=n)<0?t+360:t}function ur(n,t){return n[0]-t[0]}function or(n,t){return t[0]<=t[1]?t[0]<=n&&n<=t[1]:n<t[0]||t[1]<n}R.geo.bounds=(Ae={point:Ge,lineStart:Qe,lineEnd:nr,polygonStart:function(){Ae.point=tr,Ae.lineStart=er,Ae.lineEnd=rr,ke=0,Oe.polygonStart()},polygonEnd:function(){Oe.polygonEnd(),Ae.point=Ge,Ae.lineStart=Qe,Ae.lineEnd=nr,He<0?(ye=-(Me=180),me=-(xe=90)):_n<ke?xe=90:ke<-_n&&(me=-90),Ee[0]=ye,Ee[1]=Me}},function(n){if(xe=Me=-(ye=me=1/0),Ne=[],R.geo.stream(n,Ae),i=Ne.length){Ne.sort(ur);for(var t=1,e=[a=Ne[0]];t<i;++t)or((u=Ne[t])[0],a)||or(u[1],a)?(ir(a[0],u[1])>ir(a[0],a[1])&&(a[1]=u[1]),ir(u[0],a[1])>ir(a[0],a[1])&&(a[0]=u[0])):e.push(a=u);for(var r,i,u,o=-1/0,t=0,a=e[i=e.length-1];t<=i;a=u,++t)u=e[t],(r=ir(a[1],u[0]))>o&&(o=r,ye=u[0],Me=a[1])}return Ne=Ee=null,ye===1/0||me===1/0?[[NaN,NaN],[NaN,NaN]]:[[ye,me],[Me,xe]]}),R.geo.centroid=function(n){Ce=ze=Le=qe=Te=Re=De=Pe=je=Ue=Fe=0,R.geo.stream(n,ar);var t=je,e=Ue,r=Fe,i=t*t+e*e+r*r;return i<wn&&(t=Re,e=De,r=Pe,ze<_n&&(t=Le,e=qe,r=Te),(i=t*t+e*e+r*r)<wn)?[NaN,NaN]:[Math.atan2(e,t)*Cn,Tn(r/Math.sqrt(i))*Cn]};var ar={sphere:z,point:lr,lineStart:fr,lineEnd:sr,polygonStart:function(){ar.lineStart=hr},polygonEnd:function(){ar.lineStart=fr}};function lr(n,t){n*=An;var e=Math.cos(t*=An);cr(e*Math.cos(n),e*Math.sin(n),Math.sin(t))}function cr(n,t,e){Le+=(n-Le)/++Ce,qe+=(t-qe)/Ce,Te+=(e-Te)/Ce}function fr(){var a,l,c;function r(n,t){n*=An;var e=Math.cos(t*=An),r=e*Math.cos(n),i=e*Math.sin(n),u=Math.sin(t),o=Math.atan2(Math.sqrt((o=l*u-c*i)*o+(o=c*r-a*u)*o+(o=a*i-l*r)*o),a*r+l*i+c*u);ze+=o,Re+=o*(a+(a=r)),De+=o*(l+(l=i)),Pe+=o*(c+(c=u)),cr(a,l,c)}ar.point=function(n,t){n*=An;var e=Math.cos(t*=An);a=e*Math.cos(n),l=e*Math.sin(n),c=Math.sin(t),ar.point=r,cr(a,l,c)}}function sr(){ar.point=lr}function hr(){var r,i,p,g,v;function u(n,t){n*=An;var e=Math.cos(t*=An),r=e*Math.cos(n),i=e*Math.sin(n),u=Math.sin(t),o=g*u-v*i,a=v*r-p*u,l=p*i-g*r,c=Math.sqrt(o*o+a*a+l*l),f=p*r+g*i+v*u,s=c&&-qn(f)/c,h=Math.atan2(c,f);je+=s*o,Ue+=s*a,Fe+=s*l,ze+=h,Re+=h*(p+(p=r)),De+=h*(g+(g=i)),Pe+=h*(v+(v=u)),cr(p,g,v)}ar.point=function(n,t){r=n,i=t,ar.point=u,n*=An;var e=Math.cos(t*=An);p=e*Math.cos(n),g=e*Math.sin(n),v=Math.sin(t),cr(p,g,v)},ar.lineEnd=function(){u(r,i),ar.lineEnd=sr,ar.point=lr}}function pr(e,r){function n(n,t){return n=e(n,t),r(n[0],n[1])}return e.invert&&r.invert&&(n.invert=function(n,t){return(n=r.invert(n,t))&&e.invert(n[0],n[1])}),n}function gr(){return!0}function vr(n,t,e,r,a){var l=[],c=[];if(n.forEach(function(n){if(!((t=n.length-1)<=0)){var t,e=n[0],r=n[t];if(Je(e,r)){a.lineStart();for(var i=0;i<t;++i)a.point((e=n[i])[0],e[1]);a.lineEnd()}else{var u=new yr(e,n,null,!0),o=new yr(e,null,u,!1);u.o=o,l.push(u),c.push(o),u=new yr(r,n,null,!1),o=new yr(r,null,u,!0),u.o=o,l.push(u),c.push(o)}}}),c.sort(t),dr(l),dr(c),l.length){for(var i=0,u=e,o=c.length;i<o;++i)c[i].e=u=!u;for(var f,s,h=l[0];;){for(var p=h,g=!0;p.v;)if((p=p.n)===h)return;f=p.z,a.lineStart();do{if(p.v=p.o.v=!0,p.e){if(g)for(i=0,o=f.length;i<o;++i)a.point((s=f[i])[0],s[1]);else r(p.x,p.n.x,1,a);p=p.n}else{if(g)for(i=(f=p.p.z).length-1;0<=i;--i)a.point((s=f[i])[0],s[1]);else r(p.x,p.p.x,-1,a);p=p.p}f=(p=p.o).z,g=!g}while(!p.v);a.lineEnd()}}}function dr(n){if(t=n.length){for(var t,e,r=0,i=n[0];++r<t;)i.n=e=n[r],e.p=i,i=e;i.n=e=n[0],e.p=i}}function yr(n,t,e,r){this.x=n,this.z=t,this.o=e,this.e=r,this.v=!1,this.n=this.p=null}function mr(m,M,x,b){return function(r,o){var a,i=M(o),t=r.invert(b[0],b[1]),e={point:u,lineStart:l,lineEnd:c,polygonStart:function(){e.point=v,e.lineStart=d,e.lineEnd=y,a=[],f=[]},polygonEnd:function(){e.point=u,e.lineStart=l,e.lineEnd=c,a=R.merge(a);var n=function(n,t){var e=n[0],r=n[1],i=[Math.sin(e),-Math.cos(e),0],u=0,o=0;He.reset();for(var a=0,l=t.length;a<l;++a){var c=t[a],f=c.length;if(f)for(var s=c[0],h=s[0],p=s[1]/2+Sn/4,g=Math.sin(p),v=Math.cos(p),d=1;;){d===f&&(d=0);var y,m,M,x=(n=c[d])[0],b=n[1]/2+Sn/4,_=Math.sin(b),w=Math.cos(b),S=x-h,k=0<=S?1:-1,N=k*S,E=Sn<N,A=g*_;if(He.add(Math.atan2(A*k*Math.sin(N),v*w+A*Math.cos(N))),u+=E?S+k*kn:S,E^e<=h^e<=x&&(Be(y=Ve(Ye(s),Ye(n))),Be(m=Ve(i,y)),((M=(E^0<=S?-1:1)*Tn(m[2]))<r||r===M&&(y[0]||y[1]))&&(o+=E^0<=S?1:-1)),!d++)break;h=x,g=_,v=w,s=n}}return(u<-_n||u<_n&&He<0)^1&o}(t,f);a.length?(g||(o.polygonStart(),g=!0),vr(a,br,n,x,o)):n&&(g||(o.polygonStart(),g=!0),o.lineStart(),x(null,null,1,o),o.lineEnd()),g&&(o.polygonEnd(),g=!1),a=f=null},sphere:function(){o.polygonStart(),o.lineStart(),x(null,null,1,o),o.lineEnd(),o.polygonEnd()}};function u(n,t){var e=r(n,t);m(n=e[0],t=e[1])&&o.point(n,t)}function n(n,t){var e=r(n,t);i.point(e[0],e[1])}function l(){e.point=n,i.lineStart()}function c(){e.point=u,i.lineEnd()}var f,s,h=xr(),p=M(h),g=!1;function v(n,t){s.push([n,t]);var e=r(n,t);p.point(e[0],e[1])}function d(){p.lineStart(),s=[]}function y(){v(s[0][0],s[0][1]),p.lineEnd();var n,t=p.clean(),e=h.buffer(),r=e.length;if(s.pop(),f.push(s),s=null,r)if(1&t){var i,u=-1;if(0<(r=(n=e[0]).length-1)){for(g||(o.polygonStart(),g=!0),o.lineStart();++u<r;)o.point((i=n[u])[0],i[1]);o.lineEnd()}}else 1<r&&2&t&&e.push(e.pop().concat(e.shift())),a.push(e.filter(Mr))}return e}}function Mr(n){return 1<n.length}function xr(){var e,t=[];return{lineStart:function(){t.push(e=[])},point:function(n,t){e.push([n,t])},lineEnd:z,buffer:function(){var n=t;return t=[],e=null,n},rejoin:function(){1<t.length&&t.push(t.pop().concat(t.shift()))}}}function br(n,t){return((n=n.x)[0]<0?n[1]-En-_n:En-n[1])-((t=t.x)[0]<0?t[1]-En-_n:En-t[1])}var _r=mr(gr,function(s){var h,p=NaN,g=NaN,v=NaN;return{lineStart:function(){s.lineStart(),h=1},point:function(n,t){var e,r,i,u,o,a,l,c=0<n?Sn:-Sn,f=T(n-p);T(f-Sn)<_n?(s.point(p,g=0<(g+t)/2?En:-En),s.point(v,g),s.lineEnd(),s.lineStart(),s.point(c,g),s.point(n,g),h=0):v!==c&&Sn<=f&&(T(p-v)<_n&&(p-=v*_n),T(n-c)<_n&&(n-=c*_n),e=p,r=g,i=n,u=t,l=Math.sin(e-i),g=T(l)>_n?Math.atan((Math.sin(r)*(a=Math.cos(u))*Math.sin(i)-Math.sin(u)*(o=Math.cos(r))*Math.sin(e))/(o*a*l)):(r+u)/2,s.point(v,g),s.lineEnd(),s.lineStart(),s.point(c,g),h=0),s.point(p=n,g=t),v=c},lineEnd:function(){s.lineEnd(),p=g=NaN},clean:function(){return 2-h}}},function(n,t,e,r){var i;{var u;null==n?(i=e*En,r.point(-Sn,i),r.point(0,i),r.point(Sn,i),r.point(Sn,0),r.point(Sn,-i),r.point(0,-i),r.point(-Sn,-i),r.point(-Sn,0),r.point(-Sn,i)):T(n[0]-t[0])>_n?(u=n[0]<t[0]?Sn:-Sn,i=e*u/2,r.point(-u,i),r.point(0,i),r.point(u,i)):r.point(t[0],t[1])}},[-Sn,-Sn/2]);function wr(i){var N=Math.cos(i),p=0<N,g=T(N)>_n;return mr(v,function(a){var l,c,f,s,h;return{lineStart:function(){s=f=!1,h=1},point:function(n,t){var e,r,i=[n,t],u=v(n,t),o=p?u?0:y(n,t):u?y(n+(n<0?Sn:-Sn),t):0;!l&&(s=f=u)&&a.lineStart(),u!==f&&(e=d(l,i),(Je(l,e)||Je(i,e))&&(i[0]+=_n,i[1]+=_n,u=v(i[0],i[1]))),u!==f?(h=0,u?(a.lineStart(),e=d(i,l),a.point(e[0],e[1])):(e=d(l,i),a.point(e[0],e[1]),a.lineEnd()),l=e):g&&l&&p^u&&(o&c||!(r=d(i,l,!0))||(h=0,p?(a.lineStart(),a.point(r[0][0],r[0][1]),a.point(r[1][0],r[1][1]),a.lineEnd()):(a.point(r[1][0],r[1][1]),a.lineEnd(),a.lineStart(),a.point(r[0][0],r[0][1])))),!u||l&&Je(l,i)||a.point(i[0],i[1]),l=i,f=u,c=o},lineEnd:function(){f&&a.lineEnd(),l=null},clean:function(){return h|(s&&f)<<1}}},ui(i,6*An),p?[0,-i]:[-Sn,i-Sn]);function v(n,t){return Math.cos(n)*Math.cos(t)>N}function d(n,t,e){var r=[1,0,0],i=Ve(Ye(n),Ye(t)),u=Ze(i,i),o=i[0],a=u-o*o;if(!a)return!e&&n;var l=N*u/a,c=-N*o/a,f=Ve(r,i),s=$e(r,l);Xe(s,$e(i,c));var h=f,p=Ze(s,h),g=Ze(h,h),v=p*p-g*(Ze(s,s)-1);if(!(v<0)){var d=Math.sqrt(v),y=$e(h,(-p-d)/g);if(Xe(y,s),y=We(y),!e)return y;var m,M=n[0],x=t[0],b=n[1],_=t[1];x<M&&(m=M,M=x,x=m);var w=x-M,S=T(w-Sn)<_n;if(!S&&_<b&&(m=b,b=_,_=m),S||w<_n?S?0<b+_^y[1]<(T(y[0]-M)<_n?b:_):b<=y[1]&&y[1]<=_:Sn<w^(M<=y[0]&&y[0]<=x)){var k=$e(h,(-p+d)/g);return Xe(k,s),[y,We(k)]}}}function y(n,t){var e=p?i:Sn-i,r=0;return n<-e?r|=1:e<n&&(r|=2),t<-e?r|=4:e<t&&(r|=8),r}}function Sr(f,s,h,p){return function(n){var t=n.a,e=n.b,r=t.x,i=t.y,u=0,o=1,a=e.x-r,l=e.y-i,c=f-r;if(a||!(0<c)){if(c/=a,a<0){if(c<u)return;c<o&&(o=c)}else if(0<a){if(o<c)return;u<c&&(u=c)}if(c=h-r,a||!(c<0)){if(c/=a,a<0){if(o<c)return;u<c&&(u=c)}else if(0<a){if(c<u)return;c<o&&(o=c)}if(c=s-i,l||!(0<c)){if(c/=l,l<0){if(c<u)return;c<o&&(o=c)}else if(0<l){if(o<c)return;u<c&&(u=c)}if(c=p-i,l||!(c<0)){if(c/=l,l<0){if(o<c)return;u<c&&(u=c)}else if(0<l){if(c<u)return;c<o&&(o=c)}return 0<u&&(n.a={x:r+u*a,y:i+u*l}),o<1&&(n.b={x:r+o*a,y:i+o*l}),n}}}}}}var kr=1e9;function Nr(x,b,_,w){return function(i){var r,f,u,o,a,l,c,s,h,p,g,v=i,n=xr(),d=Sr(x,b,_,w),t={point:e,lineStart:function(){t.point=M,f&&f.push(u=[]);p=!0,h=!1,c=s=NaN},lineEnd:function(){r&&(M(o,a),l&&h&&n.rejoin(),r.push(n.buffer()));t.point=e,h&&i.lineEnd()},polygonStart:function(){i=n,r=[],f=[],g=!0},polygonEnd:function(){i=v,r=R.merge(r);var n=function(n){for(var t=0,e=f.length,r=n[1],i=0;i<e;++i)for(var u,o=1,a=f[i],l=a.length,c=a[0];o<l;++o)u=a[o],c[1]<=r?u[1]>r&&0<Ln(c,u,n)&&++t:u[1]<=r&&Ln(c,u,n)<0&&--t,c=u;return 0!==t}([x,w]),t=g&&n,e=r.length;(t||e)&&(i.polygonStart(),t&&(i.lineStart(),y(null,null,1,i),i.lineEnd()),e&&vr(r,k,n,y,i),i.polygonEnd()),r=f=u=null}};function y(n,t,e,r){var i=0,u=0;if(null==n||(i=S(n,e))!==(u=S(t,e))||N(n,t)<0^0<e)for(;r.point(0===i||3===i?x:_,1<i?w:b),(i=(i+e+4)%4)!==u;);else r.point(t[0],t[1])}function m(n,t){return x<=n&&n<=_&&b<=t&&t<=w}function e(n,t){m(n,t)&&i.point(n,t)}function M(n,t){var e,r=m(n=Math.max(-kr,Math.min(kr,n)),t=Math.max(-kr,Math.min(kr,t)));f&&u.push([n,t]),p?(o=n,a=t,p=!1,(l=r)&&(i.lineStart(),i.point(n,t))):r&&h?i.point(n,t):d(e={a:{x:c,y:s},b:{x:n,y:t}})?(h||(i.lineStart(),i.point(e.a.x,e.a.y)),i.point(e.b.x,e.b.y),r||i.lineEnd(),g=!1):r&&(i.lineStart(),i.point(n,t),g=!1),c=n,s=t,h=r}return t};function S(n,t){return T(n[0]-x)<_n?0<t?0:3:T(n[0]-_)<_n?0<t?2:1:T(n[1]-b)<_n?0<t?1:0:0<t?3:2}function k(n,t){return N(n.x,t.x)}function N(n,t){var e=S(n,1),r=S(t,1);return e!==r?e-r:0===e?t[1]-n[1]:1===e?n[0]-t[0]:2===e?n[1]-t[1]:t[0]-n[0]}}function Er(n){var t=0,e=Sn/3,r=Gr(n),i=r(t,e);return i.parallels=function(n){return arguments.length?r(t=n[0]*Sn/180,e=n[1]*Sn/180):[t/Sn*180,e/Sn*180]},i}function Ar(n,t){var e=Math.sin(n),r=(e+Math.sin(t))/2,i=1+e*(2*r-e),u=Math.sqrt(i)/r;function o(n,t){var e=Math.sqrt(i-2*r*Math.sin(t))/r;return[e*Math.sin(n*=r),u-e*Math.cos(n)]}return o.invert=function(n,t){var e=u-t;return[Math.atan2(n,e)/r,Tn((i-(n*n+e*e)*r*r)/(2*r))]},o}R.geo.clipExtent=function(){var t,e,r,i,u,o,a={stream:function(n){return u&&(u.valid=!1),(u=o(n)).valid=!0,u},extent:function(n){return arguments.length?(o=Nr(t=+n[0][0],e=+n[0][1],r=+n[1][0],i=+n[1][1]),u&&(u.valid=!1,u=null),a):[[t,e],[r,i]]}};return a.extent([[0,0],[960,500]])},(R.geo.conicEqualArea=function(){return Er(Ar)}).raw=Ar,R.geo.albers=function(){return R.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},R.geo.albersUsa=function(){var r,i,u,o,a=R.geo.albers(),l=R.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),c=R.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),f={point:function(n,t){r=[n,t]}};function s(n){var t=n[0],e=n[1];return r=null,i(t,e),r||(u(t,e),r)||o(t,e),r}return s.invert=function(n){var t=a.scale(),e=a.translate(),r=(n[0]-e[0])/t,i=(n[1]-e[1])/t;return(.12<=i&&i<.234&&-.425<=r&&r<-.214?l:.166<=i&&i<.234&&-.214<=r&&r<-.115?c:a).invert(n)},s.stream=function(n){var e=a.stream(n),r=l.stream(n),i=c.stream(n);return{point:function(n,t){e.point(n,t),r.point(n,t),i.point(n,t)},sphere:function(){e.sphere(),r.sphere(),i.sphere()},lineStart:function(){e.lineStart(),r.lineStart(),i.lineStart()},lineEnd:function(){e.lineEnd(),r.lineEnd(),i.lineEnd()},polygonStart:function(){e.polygonStart(),r.polygonStart(),i.polygonStart()},polygonEnd:function(){e.polygonEnd(),r.polygonEnd(),i.polygonEnd()}}},s.precision=function(n){return arguments.length?(a.precision(n),l.precision(n),c.precision(n),s):a.precision()},s.scale=function(n){return arguments.length?(a.scale(n),l.scale(.35*n),c.scale(n),s.translate(a.translate())):a.scale()},s.translate=function(n){if(!arguments.length)return a.translate();var t=a.scale(),e=+n[0],r=+n[1];return i=a.translate(n).clipExtent([[e-.455*t,r-.238*t],[e+.455*t,r+.238*t]]).stream(f).point,u=l.translate([e-.307*t,r+.201*t]).clipExtent([[e-.425*t+_n,r+.12*t+_n],[e-.214*t-_n,r+.234*t-_n]]).stream(f).point,o=c.translate([e-.205*t,r+.212*t]).clipExtent([[e-.214*t+_n,r+.166*t+_n],[e-.115*t-_n,r+.234*t-_n]]).stream(f).point,s},s.scale(1070)};var Cr,zr,Lr,qr,Tr,Rr,Dr={point:z,lineStart:z,lineEnd:z,polygonStart:function(){zr=0,Dr.lineStart=Pr},polygonEnd:function(){Dr.lineStart=Dr.lineEnd=Dr.point=z,Cr+=T(zr/2)}};function Pr(){var e,r,i,u;function o(n,t){zr+=u*n-i*t,i=n,u=t}Dr.point=function(n,t){Dr.point=o,e=i=n,r=u=t},Dr.lineEnd=function(){o(e,r)}}var jr={point:function(n,t){n<Lr&&(Lr=n);Tr<n&&(Tr=n);t<qr&&(qr=t);Rr<t&&(Rr=t)},lineStart:z,lineEnd:z,polygonStart:z,polygonEnd:z};function Ur(){var e=Fr(4.5),r=[],i={point:n,lineStart:function(){i.point=t},lineEnd:o,polygonStart:function(){i.lineEnd=a},polygonEnd:function(){i.lineEnd=o,i.point=n},pointRadius:function(n){return e=Fr(n),i},result:function(){if(r.length){var n=r.join("");return r=[],n}}};function n(n,t){r.push("M",n,",",t,e)}function t(n,t){r.push("M",n,",",t),i.point=u}function u(n,t){r.push("L",n,",",t)}function o(){i.point=n}function a(){r.push("Z")}return i}function Fr(n){return"m0,"+n+"a"+n+","+n+" 0 1,1 0,"+-2*n+"a"+n+","+n+" 0 1,1 0,"+2*n+"z"}var Hr,Or={point:Ir,lineStart:Yr,lineEnd:Zr,polygonStart:function(){Or.lineStart=Vr},polygonEnd:function(){Or.point=Ir,Or.lineStart=Yr,Or.lineEnd=Zr}};function Ir(n,t){Le+=n,qe+=t,++Te}function Yr(){var u,o;function e(n,t){var e=n-u,r=t-o,i=Math.sqrt(e*e+r*r);Re+=i*(u+n)/2,De+=i*(o+t)/2,Pe+=i,Ir(u=n,o=t)}Or.point=function(n,t){Or.point=e,Ir(u=n,o=t)}}function Zr(){Or.point=Ir}function Vr(){var e,r,u,o;function i(n,t){var e=n-u,r=t-o,i=Math.sqrt(e*e+r*r);Re+=i*(u+n)/2,De+=i*(o+t)/2,Pe+=i,je+=(i=o*n-u*t)*(u+n),Ue+=i*(o+t),Fe+=3*i,Ir(u=n,o=t)}Or.point=function(n,t){Or.point=i,Ir(e=u=n,r=o=t)},Or.lineEnd=function(){i(e,r)}}function Xr(e){var r=4.5,i={point:n,lineStart:function(){i.point=t},lineEnd:o,polygonStart:function(){i.lineEnd=a},polygonEnd:function(){i.lineEnd=o,i.point=n},pointRadius:function(n){return r=n,i},result:z};function n(n,t){e.moveTo(n+r,t),e.arc(n,t,r,0,kn)}function t(n,t){e.moveTo(n,t),i.point=u}function u(n,t){e.lineTo(n,t)}function o(){i.point=n}function a(){e.closePath()}return i}function $r(C){var z=.5,L=Math.cos(30*An),b=16;function t(n){return(b?function(i){var e,r,u,o,a,l,c,f,s,h,p,g,v={point:n,lineStart:t,lineEnd:y,polygonStart:function(){i.polygonStart(),v.lineStart=m},polygonEnd:function(){i.polygonEnd(),v.lineStart=t}};function n(n,t){n=C(n,t),i.point(n[0],n[1])}function t(){f=NaN,v.point=d,i.lineStart()}function d(n,t){var e=Ye([n,t]),r=C(n,t);q(f,s,c,h,p,g,f=r[0],s=r[1],c=n,h=e[0],p=e[1],g=e[2],b,i),i.point(f,s)}function y(){v.point=n,i.lineEnd()}function m(){t(),v.point=M,v.lineEnd=x}function M(n,t){d(e=n,t),r=f,u=s,o=h,a=p,l=g,v.point=d}function x(){q(f,s,c,h,p,g,r,u,e,o,a,l,b,i),(v.lineEnd=y)()}return v}:function(e){return Wr(e,function(n,t){n=C(n,t),e.point(n[0],n[1])})})(n)}function q(n,t,e,r,i,u,o,a,l,c,f,s,h,p){var g,v,d,y,m,M,x,b,_,w,S,k,N=o-n,E=a-t,A=N*N+E*E;4*z<A&&h--&&(g=r+c,v=i+f,d=u+s,y=Math.sqrt(g*g+v*v+d*d),m=Math.asin(d/=y),M=T(T(d)-1)<_n||T(e-l)<_n?(e+l)/2:Math.atan2(v,g),b=(x=C(M,m))[0],_=x[1],(z<(k=E*(w=b-n)-N*(S=_-t))*k/A||.3<T((N*w+E*S)/A-.5)||r*c+i*f+u*s<L)&&(q(n,t,e,r,i,u,b,_,M,g/=y,v/=y,d,h,p),p.point(b,_),q(b,_,M,g,v,d,o,a,l,c,f,s,h,p)))}return t.precision=function(n){return arguments.length?(b=0<(z=n*n)&&16,t):Math.sqrt(z)},t}function Br(n){this.stream=n}function Wr(n,t){return{point:t,sphere:function(){n.sphere()},lineStart:function(){n.lineStart()},lineEnd:function(){n.lineEnd()},polygonStart:function(){n.polygonStart()},polygonEnd:function(){n.polygonEnd()}}}function Jr(n){return Gr(function(){return n})()}function Gr(n){var e,t,r,i,u,o,a=$r(function(n,t){return[(n=e(n,t))[0]*l+i,u-n[1]*l]}),l=150,c=480,f=250,s=0,h=0,p=0,g=0,v=0,d=_r,y=P,m=null,M=null;function x(n){return[(n=r(n[0]*An,n[1]*An))[0]*l+i,u-n[1]*l]}function b(n){return(n=r.invert((n[0]-i)/l,(u-n[1])/l))&&[n[0]*Cn,n[1]*Cn]}function _(){r=pr(t=ti(p,g,v),e);var n=e(s,h);return i=c-n[0]*l,u=f+n[1]*l,w()}function w(){return o&&(o.valid=!1,o=null),x}return x.stream=function(n){return o&&(o.valid=!1),(o=Kr(d(t,a(y(n))))).valid=!0,o},x.clipAngle=function(n){return arguments.length?(d=null==n?(m=n,_r):wr((m=+n)*An),w()):m},x.clipExtent=function(n){return arguments.length?(y=(M=n)?Nr(n[0][0],n[0][1],n[1][0],n[1][1]):P,w()):M},x.scale=function(n){return arguments.length?(l=+n,_()):l},x.translate=function(n){return arguments.length?(c=+n[0],f=+n[1],_()):[c,f]},x.center=function(n){return arguments.length?(s=n[0]%360*An,h=n[1]%360*An,_()):[s*Cn,h*Cn]},x.rotate=function(n){return arguments.length?(p=n[0]%360*An,g=n[1]%360*An,v=2<n.length?n[2]%360*An:0,_()):[p*Cn,g*Cn,v*Cn]},R.rebind(x,a,"precision"),function(){return e=n.apply(this,arguments),x.invert=e.invert&&b,_()}}function Kr(e){return Wr(e,function(n,t){e.point(n*An,t*An)})}function Qr(n,t){return[n,t]}function ni(n,t){return[Sn<n?n-kn:n<-Sn?n+kn:n,t]}function ti(n,t,e){return n?t||e?pr(ri(n),ii(t,e)):ri(n):t||e?ii(t,e):ni}function ei(e){return function(n,t){return[Sn<(n+=e)?n-kn:n<-Sn?n+kn:n,t]}}function ri(n){var t=ei(n);return t.invert=ei(-n),t}function ii(n,t){var a=Math.cos(n),l=Math.sin(n),c=Math.cos(t),f=Math.sin(t);function e(n,t){var e=Math.cos(t),r=Math.cos(n)*e,i=Math.sin(n)*e,u=Math.sin(t),o=u*a+r*l;return[Math.atan2(i*c-o*f,r*a-u*l),Tn(o*c+i*f)]}return e.invert=function(n,t){var e=Math.cos(t),r=Math.cos(n)*e,i=Math.sin(n)*e,u=Math.sin(t),o=u*c-i*f;return[Math.atan2(i*c+u*f,r*a+o*l),Tn(o*a-r*l)]},e}function ui(a,l){var c=Math.cos(a),f=Math.sin(a);return function(n,t,e,r){var i=e*l;null!=n?(n=oi(c,n),t=oi(c,t),(0<e?n<t:t<n)&&(n+=e*kn)):(n=a+e*kn,t=a-.5*i);for(var u,o=n;0<e?t<o:o<t;o-=i)r.point((u=We([c,-f*Math.cos(o),-f*Math.sin(o)]))[0],u[1])}}function oi(n,t){var e=Ye(t);e[0]-=n,Be(e);var r=qn(-e[1]);return((-e[2]<0?-r:r)+2*Math.PI-_n)%(2*Math.PI)}function ai(n,t,e){var r=R.range(n,t-_n,e).concat(t);return function(t){return r.map(function(n){return[t,n]})}}function li(n,t,e){var r=R.range(n,t-_n,e).concat(t);return function(t){return r.map(function(n){return[n,t]})}}function ci(n){return n.source}function fi(n){return n.target}R.geo.path=function(){var r,t,i,e,u,o=4.5;function a(n){return n&&("function"==typeof o&&e.pointRadius(+o.apply(this,arguments)),u&&u.valid||(u=i(e)),R.geo.stream(n,u)),e.result()}function l(){return u=null,a}return a.area=function(n){return Cr=0,R.geo.stream(n,i(Dr)),Cr},a.centroid=function(n){return Le=qe=Te=Re=De=Pe=je=Ue=Fe=0,R.geo.stream(n,i(Or)),Fe?[je/Fe,Ue/Fe]:Pe?[Re/Pe,De/Pe]:Te?[Le/Te,qe/Te]:[NaN,NaN]},a.bounds=function(n){return Tr=Rr=-(Lr=qr=1/0),R.geo.stream(n,i(jr)),[[Lr,qr],[Tr,Rr]]},a.projection=function(n){return arguments.length?(i=(r=n)?n.stream||(e=n,t=$r(function(n,t){return e([n*Cn,t*Cn])}),function(n){return Kr(t(n))}):P,l()):r;var e,t},a.context=function(n){return arguments.length?(e=null==(t=n)?new Ur:new Xr(n),"function"!=typeof o&&e.pointRadius(o),l()):t},a.pointRadius=function(n){return arguments.length?(o="function"==typeof n?n:(e.pointRadius(+n),+n),a):o},a.projection(R.geo.albersUsa()).context(null)},R.geo.transform=function(r){return{stream:function(n){var t=new Br(n);for(var e in r)t[e]=r[e];return t}}},Br.prototype={point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},R.geo.projection=Jr,R.geo.projectionMutator=Gr,(R.geo.equirectangular=function(){return Jr(Qr)}).raw=Qr.invert=Qr,R.geo.rotation=function(t){function n(n){return(n=t(n[0]*An,n[1]*An))[0]*=Cn,n[1]*=Cn,n}return t=ti(t[0]%360*An,t[1]*An,2<t.length?t[2]*An:0),n.invert=function(n){return(n=t.invert(n[0]*An,n[1]*An))[0]*=Cn,n[1]*=Cn,n},n},ni.invert=Qr,R.geo.circle=function(){var t,i,u=[0,0],e=6;function r(){var n="function"==typeof u?u.apply(this,arguments):u,e=ti(-n[0]*An,-n[1]*An,0).invert,r=[];return i(null,null,1,{point:function(n,t){r.push(n=e(n,t)),n[0]*=Cn,n[1]*=Cn}}),{type:"Polygon",coordinates:[r]}}return r.origin=function(n){return arguments.length?(u=n,r):u},r.angle=function(n){return arguments.length?(i=ui((t=+n)*An,e*An),r):t},r.precision=function(n){return arguments.length?(i=ui(t*An,(e=+n)*An),r):e},r.angle(90)},R.geo.distance=function(n,t){var e,r=(t[0]-n[0])*An,i=n[1]*An,u=t[1]*An,o=Math.sin(r),a=Math.cos(r),l=Math.sin(i),c=Math.cos(i),f=Math.sin(u),s=Math.cos(u);return Math.atan2(Math.sqrt((e=s*o)*e+(e=c*f-l*s*a)*e),l*f+c*s*a)},R.geo.graticule=function(){var t,e,r,i,u,o,a,l,c,f,s,h,p=10,g=p,v=90,d=360,y=2.5;function m(){return{type:"MultiLineString",coordinates:n()}}function n(){return R.range(Math.ceil(i/v)*v,r,v).map(s).concat(R.range(Math.ceil(l/d)*d,a,d).map(h)).concat(R.range(Math.ceil(e/p)*p,t,p).filter(function(n){return T(n%v)>_n}).map(c)).concat(R.range(Math.ceil(o/g)*g,u,g).filter(function(n){return T(n%d)>_n}).map(f))}return m.lines=function(){return n().map(function(n){return{type:"LineString",coordinates:n}})},m.outline=function(){return{type:"Polygon",coordinates:[s(i).concat(h(a).slice(1),s(r).reverse().slice(1),h(l).reverse().slice(1))]}},m.extent=function(n){return arguments.length?m.majorExtent(n).minorExtent(n):m.minorExtent()},m.majorExtent=function(n){return arguments.length?(i=+n[0][0],r=+n[1][0],l=+n[0][1],a=+n[1][1],r<i&&(n=i,i=r,r=n),a<l&&(n=l,l=a,a=n),m.precision(y)):[[i,l],[r,a]]},m.minorExtent=function(n){return arguments.length?(e=+n[0][0],t=+n[1][0],o=+n[0][1],u=+n[1][1],t<e&&(n=e,e=t,t=n),u<o&&(n=o,o=u,u=n),m.precision(y)):[[e,o],[t,u]]},m.step=function(n){return arguments.length?m.majorStep(n).minorStep(n):m.minorStep()},m.majorStep=function(n){return arguments.length?(v=+n[0],d=+n[1],m):[v,d]},m.minorStep=function(n){return arguments.length?(p=+n[0],g=+n[1],m):[p,g]},m.precision=function(n){return arguments.length?(y=+n,c=ai(o,u,90),f=li(e,t,y),s=ai(l,a,90),h=li(i,r,y),m):y},m.majorExtent([[-180,-90+_n],[180,90-_n]]).minorExtent([[-180,-80-_n],[180,80+_n]])},R.geo.greatArc=function(){var t,e,r=ci,i=fi;function u(){return{type:"LineString",coordinates:[t||r.apply(this,arguments),e||i.apply(this,arguments)]}}return u.distance=function(){return R.geo.distance(t||r.apply(this,arguments),e||i.apply(this,arguments))},u.source=function(n){return arguments.length?(t="function"==typeof(r=n)?null:n,u):r},u.target=function(n){return arguments.length?(e="function"==typeof(i=n)?null:n,u):i},u.precision=function(){return arguments.length?u:0},u},R.geo.interpolate=function(n,t){return e=n[0]*An,r=n[1]*An,i=t[0]*An,u=t[1]*An,o=Math.cos(r),a=Math.sin(r),l=Math.cos(u),c=Math.sin(u),f=o*Math.cos(e),s=o*Math.sin(e),h=l*Math.cos(i),p=l*Math.sin(i),g=2*Math.asin(Math.sqrt(Dn(u-r)+o*l*Dn(i-e))),v=1/Math.sin(g),(d=g?function(n){var t=Math.sin(n*=g)*v,e=Math.sin(g-n)*v,r=e*f+t*h,i=e*s+t*p,u=e*a+t*c;return[Math.atan2(i,r)*Cn,Math.atan2(u,Math.sqrt(r*r+i*i))*Cn]}:function(){return[e*Cn,r*Cn]}).distance=g,d;var e,r,i,u,o,a,l,c,f,s,h,p,g,v,d},R.geo.length=function(n){return Hr=0,R.geo.stream(n,si),Hr};var si={sphere:z,point:z,lineStart:function(){var o,a,l;function e(n,t){var e=Math.sin(t*=An),r=Math.cos(t),i=T((n*=An)-o),u=Math.cos(i);Hr+=Math.atan2(Math.sqrt((i=r*Math.sin(i))*i+(i=l*e-a*r*u)*i),a*e+l*r*u),o=n,a=e,l=r}si.point=function(n,t){o=n*An,a=Math.sin(t*=An),l=Math.cos(t),si.point=e},si.lineEnd=function(){si.point=si.lineEnd=z}},lineEnd:z,polygonStart:z,polygonEnd:z};function hi(u,o){function n(n,t){var e=Math.cos(n),r=Math.cos(t),i=u(e*r);return[i*r*Math.sin(n),i*Math.sin(t)]}return n.invert=function(n,t){var e=Math.sqrt(n*n+t*t),r=o(e),i=Math.sin(r),u=Math.cos(r);return[Math.atan2(n*i,e*u),Math.asin(e&&t*i/e)]},n}var pi=hi(function(n){return Math.sqrt(2/(1+n))},function(n){return 2*Math.asin(n/2)});(R.geo.azimuthalEqualArea=function(){return Jr(pi)}).raw=pi;var gi=hi(function(n){var t=Math.acos(n);return t&&t/Math.sin(t)},P);function vi(n,t){function r(n){return Math.tan(Sn/4+n/2)}var e=Math.cos(n),i=n===t?Math.sin(n):Math.log(e/Math.cos(t))/Math.log(r(t)/r(n)),u=e*Math.pow(r(n),i)/i;if(!i)return mi;function o(n,t){0<u?t<-En+_n&&(t=-En+_n):En-_n<t&&(t=En-_n);var e=u/Math.pow(r(t),i);return[e*Math.sin(i*n),u-e*Math.cos(i*n)]}return o.invert=function(n,t){var e=u-t,r=zn(i)*Math.sqrt(n*n+e*e);return[Math.atan2(n,e)/i,2*Math.atan(Math.pow(u/r,1/i))-En]},o}function di(n,t){var e=Math.cos(n),r=n===t?Math.sin(n):(e-Math.cos(t))/(t-n),i=e/r+n;if(T(r)<_n)return Qr;function u(n,t){var e=i-t;return[e*Math.sin(r*n),i-e*Math.cos(r*n)]}return u.invert=function(n,t){var e=i-t;return[Math.atan2(n,e)/r,i-zn(r)*Math.sqrt(n*n+e*e)]},u}(R.geo.azimuthalEquidistant=function(){return Jr(gi)}).raw=gi,(R.geo.conicConformal=function(){return Er(vi)}).raw=vi,(R.geo.conicEquidistant=function(){return Er(di)}).raw=di;var yi=hi(function(n){return 1/n},Math.atan);function mi(n,t){return[n,Math.log(Math.tan(Sn/4+t/2))]}function Mi(n){var i,u=Jr(n),o=u.scale,a=u.translate,l=u.clipExtent;return u.scale=function(){var n=o.apply(u,arguments);return n===u?i?u.clipExtent(null):u:n},u.translate=function(){var n=a.apply(u,arguments);return n===u?i?u.clipExtent(null):u:n},u.clipExtent=function(n){var t,e,r=l.apply(u,arguments);return r===u?(i=null==n)&&(t=Sn*o(),e=a(),l([[e[0]-t,e[1]-t],[e[0]+t,e[1]+t]])):i&&(r=null),r},u.clipExtent(null)}(R.geo.gnomonic=function(){return Jr(yi)}).raw=yi,mi.invert=function(n,t){return[n,2*Math.atan(Math.exp(t))-En]},(R.geo.mercator=function(){return Mi(mi)}).raw=mi;var xi=hi(function(){return 1},Math.asin);(R.geo.orthographic=function(){return Jr(xi)}).raw=xi;var bi=hi(function(n){return 1/(1+n)},function(n){return 2*Math.atan(n)});function _i(n,t){return[Math.log(Math.tan(Sn/4+t/2)),-n]}function wi(n){return n[0]}function Si(n){return n[1]}function ki(n){for(var t=n.length,e=[0,1],r=2,i=2;i<t;i++){for(;1<r&&Ln(n[e[r-2]],n[e[r-1]],n[i])<=0;)--r;e[r++]=i}return e.slice(0,r)}function Ni(n,t){return n[0]-t[0]||n[1]-t[1]}(R.geo.stereographic=function(){return Jr(bi)}).raw=bi,_i.invert=function(n,t){return[-t,2*Math.atan(Math.exp(n))-En]},(R.geo.transverseMercator=function(){var n=Mi(_i),t=n.center,e=n.rotate;return n.center=function(n){return n?t([-n[1],n[0]]):[(n=t())[1],-n[0]]},n.rotate=function(n){return n?e([n[0],n[1],2<n.length?n[2]+90:90]):[(n=e())[0],n[1],n[2]-90]},e([0,0,90])}).raw=_i,R.geom={},R.geom.hull=function(n){var h=wi,p=Si;if(arguments.length)return t(n);function t(n){if(n.length<3)return[];for(var t=vt(h),e=vt(p),r=n.length,i=[],u=[],o=0;o<r;o++)i.push([+t.call(this,n[o],o),+e.call(this,n[o],o),o]);for(i.sort(Ni),o=0;o<r;o++)u.push([i[o][0],-i[o][1]]);var a=ki(i),l=ki(u),c=l[0]===a[0],f=l[l.length-1]===a[a.length-1],s=[];for(o=a.length-1;0<=o;--o)s.push(n[i[a[o]][2]]);for(o=+c;o<l.length-f;++o)s.push(n[i[l[o]][2]]);return s}return t.x=function(n){return arguments.length?(h=n,t):h},t.y=function(n){return arguments.length?(p=n,t):p},t},R.geom.polygon=function(n){return O(n,Ei),n};var Ei=R.geom.polygon.prototype=[];function Ai(n,t,e){return(e[0]-t[0])*(n[1]-t[1])<(e[1]-t[1])*(n[0]-t[0])}function Ci(n,t,e,r){var i=n[0],u=e[0],o=t[0]-i,a=r[0]-u,l=n[1],c=e[1],f=t[1]-l,s=r[1]-c,h=(a*(l-c)-s*(i-u))/(s*o-a*f);return[i+h*o,l+h*f]}function zi(n){var t=n[0],e=n[n.length-1];return!(t[0]-e[0]||t[1]-e[1])}Ei.area=function(){for(var n,t=-1,e=this.length,r=this[e-1],i=0;++t<e;)n=r,r=this[t],i+=n[1]*r[0]-n[0]*r[1];return.5*i},Ei.centroid=function(n){var t,e,r=-1,i=this.length,u=0,o=0,a=this[i-1];for(arguments.length||(n=-1/(6*this.area()));++r<i;)t=a,a=this[r],e=t[0]*a[1]-a[0]*t[1],u+=(t[0]+a[0])*e,o+=(t[1]+a[1])*e;return[u*n,o*n]},Ei.clip=function(n){for(var t,e,r,i,u,o,a=zi(n),l=-1,c=this.length-zi(this),f=this[c-1];++l<c;){for(t=n.slice(),n.length=0,i=this[l],u=t[(r=t.length-a)-1],e=-1;++e<r;)Ai(o=t[e],f,i)?(Ai(u,f,i)||n.push(Ci(u,o,f,i)),n.push(o)):Ai(u,f,i)&&n.push(Ci(u,o,f,i)),u=o;a&&n.push(n[0]),f=i}return n};var Li,qi,Ti,Ri,Di,Pi=[],ji=[];function Ui(){ru(this),this.edge=this.site=this.circle=null}function Fi(n){var t=Pi.pop()||new Ui;return t.site=n,t}function Hi(n){Wi(n),Ti.remove(n),Pi.push(n),ru(n)}function Oi(n){var t=n.circle,e=t.x,r=t.cy,i={x:e,y:r},u=n.P,o=n.N,a=[n];Hi(n);for(var l=u;l.circle&&T(e-l.circle.x)<_n&&T(r-l.circle.cy)<_n;)u=l.P,a.unshift(l),Hi(l),l=u;a.unshift(l),Wi(l);for(var c=o;c.circle&&T(e-c.circle.x)<_n&&T(r-c.circle.cy)<_n;)o=c.N,a.push(c),Hi(c),c=o;a.push(c),Wi(c);for(var f=a.length,s=1;s<f;++s)c=a[s],l=a[s-1],nu(c.edge,l.site,c.site,i);l=a[0],(c=a[f-1]).edge=Ki(l.site,c.site,null,i),Bi(l),Bi(c)}function Ii(n){for(var t,e,r,i,u=n.x,o=n.y,a=Ti._;a;)if(r=Yi(a,o)-u,_n<r)a=a.L;else{if(i=u-Zi(a,o),!(_n<i)){-_n<r?(t=a.P,e=a):-_n<i?e=(t=a).N:t=e=a;break}if(!a.R){t=a;break}a=a.R}var l,c,f,s,h,p,g,v,d,y,m,M,x=Fi(n);if(Ti.insert(t,x),t||e){if(t===e)return Wi(t),e=Fi(t.site),Ti.insert(x,e),x.edge=e.edge=Ki(t.site,x.site),Bi(t),void Bi(e);e?(Wi(t),Wi(e),c=(l=t.site).x,f=l.y,s=n.x-c,h=n.y-f,g=(p=e.site).x-c,M={x:((v=p.y-f)*(y=s*s+h*h)-h*(m=g*g+v*v))/(d=2*(s*v-h*g))+c,y:(s*m-g*y)/d+f},nu(e.edge,l,p,M),x.edge=Ki(l,n,null,M),e.edge=Ki(n,p,null,M),Bi(t),Bi(e)):x.edge=Ki(t.site,x.site)}}function Yi(n,t){var e=n.site,r=e.x,i=e.y,u=i-t;if(!u)return r;var o=n.P;if(!o)return-1/0;var a=(e=o.site).x,l=e.y,c=l-t;if(!c)return a;var f=a-r,s=1/u-1/c,h=f/c;return s?(-h+Math.sqrt(h*h-2*s*(f*f/(-2*c)-l+c/2+i-u/2)))/s+r:(r+a)/2}function Zi(n,t){var e=n.N;if(e)return Yi(e,t);var r=n.site;return r.y===t?r.x:1/0}function Vi(n){this.site=n,this.edges=[]}function Xi(n,t){return t.angle-n.angle}function $i(){ru(this),this.x=this.y=this.arc=this.site=this.cy=null}function Bi(n){var t=n.P,e=n.N;if(t&&e){var r=t.site,i=n.site,u=e.site;if(r!==u){var o=i.x,a=i.y,l=r.x-o,c=r.y-a,f=u.x-o,s=2*(l*(d=u.y-a)-c*f);if(!(-wn<=s)){var h=l*l+c*c,p=f*f+d*d,g=(d*h-c*p)/s,v=(l*p-f*h)/s,d=v+a,y=ji.pop()||new $i;y.arc=n,y.site=i,y.x=g+o,y.y=d+Math.sqrt(g*g+v*v),y.cy=d,n.circle=y;for(var m=null,M=Di._;M;)if(y.y<M.y||y.y===M.y&&y.x<=M.x){if(!M.L){m=M.P;break}M=M.L}else{if(!M.R){m=M;break}M=M.R}Di.insert(m,y),m||(Ri=y)}}}}function Wi(n){var t=n.circle;t&&(t.P||(Ri=t.N),Di.remove(t),ji.push(t),ru(t),n.circle=null)}function Ji(n,t){var e=n.b;if(e)return 1;var r,i,u=n.a,o=t[0][0],a=t[1][0],l=t[0][1],c=t[1][1],f=n.l,s=n.r,h=f.x,p=f.y,g=s.x,v=s.y,d=(h+g)/2,y=(p+v)/2;if(v===p){if(d<o||a<=d)return;if(g<h){if(u){if(u.y>=c)return}else u={x:d,y:l};e={x:d,y:c}}else{if(u){if(u.y<l)return}else u={x:d,y:c};e={x:d,y:l}}}else if(i=y-(r=(h-g)/(v-p))*d,r<-1||1<r)if(g<h){if(u){if(u.y>=c)return}else u={x:(l-i)/r,y:l};e={x:(c-i)/r,y:c}}else{if(u){if(u.y<l)return}else u={x:(c-i)/r,y:c};e={x:(l-i)/r,y:l}}else if(p<v){if(u){if(u.x>=a)return}else u={x:o,y:r*o+i};e={x:a,y:r*a+i}}else{if(u){if(u.x<o)return}else u={x:a,y:r*a+i};e={x:o,y:r*o+i}}return n.a=u,n.b=e,1}function Gi(n,t){this.l=n,this.r=t,this.a=this.b=null}function Ki(n,t,e,r){var i=new Gi(n,t);return Li.push(i),e&&nu(i,n,t,e),r&&nu(i,t,n,r),qi[n.i].edges.push(new tu(i,n,t)),qi[t.i].edges.push(new tu(i,t,n)),i}function Qi(n,t,e){var r=new Gi(n,null);return r.a=t,r.b=e,Li.push(r),r}function nu(n,t,e,r){n.a||n.b?n.l===e?n.b=r:n.a=r:(n.a=r,n.l=t,n.r=e)}function tu(n,t,e){var r=n.a,i=n.b;this.edge=n,this.site=t,this.angle=e?Math.atan2(e.y-t.y,e.x-t.x):n.l===t?Math.atan2(i.x-r.x,r.y-i.y):Math.atan2(r.x-i.x,i.y-r.y)}function eu(){this._=null}function ru(n){n.U=n.C=n.L=n.R=n.P=n.N=null}function iu(n,t){var e=t,r=t.R,i=e.U;i?i.L===e?i.L=r:i.R=r:n._=r,r.U=i,e.U=r,e.R=r.L,e.R&&(e.R.U=e),r.L=e}function uu(n,t){var e=t,r=t.L,i=e.U;i?i.L===e?i.L=r:i.R=r:n._=r,r.U=i,e.U=r,e.L=r.R,e.L&&(e.L.U=e),r.R=e}function ou(n){for(;n.L;)n=n.L;return n}function au(n,t){var e,r,i,u=n.sort(lu).pop();for(Li=[],qi=new Array(n.length),Ti=new eu,Di=new eu;;)if(i=Ri,u&&(!i||u.y<i.y||u.y===i.y&&u.x<i.x))u.x===e&&u.y===r||(qi[u.i]=new Vi(u),Ii(u),e=u.x,r=u.y),u=n.pop();else{if(!i)break;Oi(i.arc)}t&&(function(n){for(var t,e=Li,r=Sr(n[0][0],n[0][1],n[1][0],n[1][1]),i=e.length;i--;)Ji(t=e[i],n)&&r(t)&&!(T(t.a.x-t.b.x)<_n&&T(t.a.y-t.b.y)<_n)||(t.a=t.b=null,e.splice(i,1))}(t),function(n){for(var t,e,r,i,u,o,a,l,c,f,s=n[0][0],h=n[1][0],p=n[0][1],g=n[1][1],v=qi,d=v.length;d--;)if((u=v[d])&&u.prepare())for(l=(a=u.edges).length,o=0;o<l;)r=(f=a[o].end()).x,i=f.y,t=(c=a[++o%l].start()).x,e=c.y,(T(r-t)>_n||T(i-e)>_n)&&(a.splice(o,0,new tu(Qi(u.site,f,T(r-s)<_n&&_n<g-i?{x:s,y:T(t-s)<_n?e:g}:T(i-g)<_n&&_n<h-r?{x:T(e-g)<_n?t:h,y:g}:T(r-h)<_n&&_n<i-p?{x:h,y:T(t-h)<_n?e:p}:T(i-p)<_n&&_n<r-s?{x:T(e-p)<_n?t:s,y:p}:null),u.site,null)),++l)}(t));var o={cells:qi,edges:Li};return Ti=Di=Li=qi=null,o}function lu(n,t){return t.y-n.y||t.x-n.x}Vi.prototype.prepare=function(){for(var n,t=this.edges,e=t.length;e--;)(n=t[e].edge).b&&n.a||t.splice(e,1);return t.sort(Xi),t.length},tu.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},eu.prototype={insert:function(n,t){var e,r,i;if(n){if(t.P=n,t.N=n.N,n.N&&(n.N.P=t),n.N=t,n.R){for(n=n.R;n.L;)n=n.L;n.L=t}else n.R=t;e=n}else e=this._?(n=ou(this._),t.P=null,(t.N=n).P=n.L=t,n):(t.P=t.N=null,this._=t,null);for(t.L=t.R=null,t.U=e,t.C=!0,n=t;e&&e.C;)e===(r=e.U).L?(i=r.R)&&i.C?(e.C=i.C=!1,r.C=!0,n=r):(n===e.R&&(iu(this,e),e=(n=e).U),e.C=!1,r.C=!0,uu(this,r)):(i=r.L)&&i.C?(e.C=i.C=!1,r.C=!0,n=r):(n===e.L&&(uu(this,e),e=(n=e).U),e.C=!1,r.C=!0,iu(this,r)),e=n.U;this._.C=!1},remove:function(n){n.N&&(n.N.P=n.P),n.P&&(n.P.N=n.N),n.N=n.P=null;var t,e,r=n.U,i=n.L,u=n.R,o=i?u?ou(u):i:u;if(r?r.L===n?r.L=o:r.R=o:this._=o,i&&u?(e=o.C,o.C=n.C,((o.L=i).U=o)!==u?(r=o.U,o.U=n.U,n=o.R,r.L=n,(o.R=u).U=o):(o.U=r,n=(r=o).R)):(e=n.C,n=o),n&&(n.U=r),!e)if(n&&n.C)n.C=!1;else{do{if(n===this._)break;if(n===r.L){if((t=r.R).C&&(t.C=!1,r.C=!0,iu(this,r),t=r.R),t.L&&t.L.C||t.R&&t.R.C){t.R&&t.R.C||(t.L.C=!1,t.C=!0,uu(this,t),t=r.R),t.C=r.C,r.C=t.R.C=!1,iu(this,r),n=this._;break}}else if((t=r.L).C&&(t.C=!1,r.C=!0,uu(this,r),t=r.L),t.L&&t.L.C||t.R&&t.R.C){t.L&&t.L.C||(t.R.C=!1,t.C=!0,iu(this,t),t=r.L),t.C=r.C,r.C=t.L.C=!1,uu(this,r),n=this._;break}t.C=!0,r=(n=r).U}while(!n.C);n&&(n.C=!1)}}},R.geom.voronoi=function(n){var t=wi,e=Si,r=t,i=e,f=cu;if(n)return u(n);function u(i){var u=new Array(i.length),o=f[0][0],a=f[0][1],l=f[1][0],c=f[1][1];return au(s(i),f).cells.forEach(function(n,t){var e=n.edges,r=n.site;(u[t]=e.length?e.map(function(n){var t=n.start();return[t.x,t.y]}):r.x>=o&&r.x<=l&&r.y>=a&&r.y<=c?[[o,c],[l,c],[l,a],[o,a]]:[]).point=i[t]}),u}function s(n){return n.map(function(n,t){return{x:Math.round(r(n,t)/_n)*_n,y:Math.round(i(n,t)/_n)*_n,i:t}})}return u.links=function(t){return au(s(t)).edges.filter(function(n){return n.l&&n.r}).map(function(n){return{source:t[n.l.i],target:t[n.r.i]}})},u.triangles=function(h){var p=[];return au(s(h)).cells.forEach(function(n,t){for(var e,r,i,u,o=n.site,a=n.edges.sort(Xi),l=-1,c=a.length,f=a[c-1].edge,s=f.l===o?f.r:f.l;++l<c;)e=s,s=(f=a[l].edge).l===o?f.r:f.l,t<e.i&&t<s.i&&(i=e,u=s,((r=o).x-u.x)*(i.y-r.y)-(r.x-i.x)*(u.y-r.y)<0)&&p.push([h[t],h[e.i],h[s.i]])}),p},u.x=function(n){return arguments.length?(r=vt(t=n),u):t},u.y=function(n){return arguments.length?(i=vt(e=n),u):e},u.clipExtent=function(n){return arguments.length?(f=null==n?cu:n,u):f===cu?null:f},u.size=function(n){return arguments.length?u.clipExtent(n&&[[0,0],n]):f===cu?null:f&&f[1]},u};var cu=[[-1e6,-1e6],[1e6,1e6]];function fu(n){return n.x}function su(n){return n.y}function hu(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function pu(n,t){n=R.rgb(n),t=R.rgb(t);var e=n.r,r=n.g,i=n.b,u=t.r-e,o=t.g-r,a=t.b-i;return function(n){return"#"+lt(Math.round(e+u*n))+lt(Math.round(r+o*n))+lt(Math.round(i+a*n))}}function gu(n,t){var e,r={},i={};for(e in n)e in t?r[e]=Mu(n[e],t[e]):i[e]=n[e];for(e in t)e in n||(i[e]=t[e]);return function(n){for(e in r)i[e]=r[e](n);return i}}function vu(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function du(n,r){var t,e,i,u=yu.lastIndex=mu.lastIndex=0,o=-1,a=[],l=[];for(n+="",r+="";(t=yu.exec(n))&&(e=mu.exec(r));)(i=e.index)>u&&(i=r.slice(u,i),a[o]?a[o]+=i:a[++o]=i),(t=t[0])===(e=e[0])?a[o]?a[o]+=e:a[++o]=e:(a[++o]=null,l.push({i:o,x:vu(t,e)})),u=mu.lastIndex;return u<r.length&&(i=r.slice(u),a[o]?a[o]+=i:a[++o]=i),a.length<2?l[0]?(r=l[0].x,function(n){return r(n)+""}):function(){return r}:(r=l.length,function(n){for(var t,e=0;e<r;++e)a[(t=l[e]).i]=t.x(n);return a.join("")})}R.geom.delaunay=function(n){return R.geom.voronoi().triangles(n)},R.geom.quadtree=function(n,m,M,x,b){var _,w=wi,k=Si;if(_=arguments.length)return w=fu,k=su,3===_&&(b=M,x=m,M=m=0),t(n);function t(n){var t,e,r,i,u,o,a,l,c,f=vt(w),s=vt(k);if(null!=m)o=m,a=M,l=x,c=b;else if(l=c=-(o=a=1/0),e=[],r=[],u=n.length,_)for(i=0;i<u;++i)(t=n[i]).x<o&&(o=t.x),t.y<a&&(a=t.y),t.x>l&&(l=t.x),t.y>c&&(c=t.y),e.push(t.x),r.push(t.y);else for(i=0;i<u;++i){var h=+f(t=n[i],i),p=+s(t,i);h<o&&(o=h),p<a&&(a=p),l<h&&(l=h),c<p&&(c=p),e.push(h),r.push(p)}var g=l-o,v=c-a;function d(n,t,e,r,i,u,o,a){var l,c,f;isNaN(e)||isNaN(r)||(n.leaf?(l=n.x,c=n.y,null!=l?(T(l-e)+T(c-r)<.01||(f=n.point,n.x=n.y=n.point=null,y(n,f,l,c,i,u,o,a)),y(n,t,e,r,i,u,o,a)):(n.x=e,n.y=r,n.point=t)):y(n,t,e,r,i,u,o,a))}function y(n,t,e,r,i,u,o,a){var l=.5*(i+o),c=.5*(u+a),f=l<=e,s=c<=r,h=s<<1|f;n.leaf=!1,f?i=l:o=l,s?u=c:a=c,d(n=n.nodes[h]||(n.nodes[h]=hu()),t,e,r,i,u,o,a)}v<g?c=a+g:l=o+v;var S=hu();if(S.add=function(n){d(S,n,+f(n,++i),+s(n,i),o,a,l,c)},S.visit=function(n){!function n(t,e,r,i,u,o){{var a,l,c;t(e,r,i,u,o)||(a=.5*(r+u),l=.5*(i+o),(c=e.nodes)[0]&&n(t,c[0],r,i,a,l),c[1]&&n(t,c[1],a,i,u,l),c[2]&&n(t,c[2],r,l,a,o),c[3]&&n(t,c[3],a,l,u,o))}}(n,S,o,a,l,c)},S.find=function(n){return t=S,d=n[0],y=n[1],w=1/0,function n(t,e,r,i,u){if(!(x<e||b<r||i<m||u<M)){var o,a,l,c,f;!(o=t.point)||(c=(a=d-t.x)*a+(l=y-t.y)*l)<w&&(f=Math.sqrt(w=c),m=d-f,M=y-f,x=d+f,b=y+f,_=o);for(var s=t.nodes,h=.5*(e+i),p=.5*(r+u),g=(p<=y)<<1|h<=d,v=g+4;g<v;++g)if(t=s[3&g])switch(3&g){case 0:n(t,e,r,h,p);break;case 1:n(t,h,r,i,p);break;case 2:n(t,e,p,h,u);break;case 3:n(t,h,p,i,u)}}}(t,m=o,M=a,x=l,b=c),_;var t,d,y,m,M,x,b,_,w},i=-1,null==m){for(;++i<u;)d(S,n[i],e[i],r[i],o,a,l,c);--i}else n.forEach(S.add);return e=r=n=t=null,S}return t.x=function(n){return arguments.length?(w=n,t):w},t.y=function(n){return arguments.length?(k=n,t):k},t.extent=function(n){return arguments.length?(null==n?m=M=x=b=null:(m=+n[0][0],M=+n[0][1],x=+n[1][0],b=+n[1][1]),t):null==m?null:[[m,M],[x,b]]},t.size=function(n){return arguments.length?(null==n?m=M=x=b=null:(m=M=0,x=+n[0],b=+n[1]),t):null==m?null:[x-m,b-M]},t},R.interpolateRgb=pu,R.interpolateObject=gu,R.interpolateNumber=vu,R.interpolateString=du;var yu=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,mu=new RegExp(yu.source,"g");function Mu(n,t){for(var e,r=R.interpolators.length;0<=--r&&!(e=R.interpolators[r](n,t)););return e}function xu(n,t){for(var e=[],r=[],i=n.length,u=t.length,o=Math.min(n.length,t.length),a=0;a<o;++a)e.push(Mu(n[a],t[a]));for(;a<i;++a)r[a]=n[a];for(;a<u;++a)r[a]=t[a];return function(n){for(a=0;a<o;++a)r[a]=e[a](n);return r}}R.interpolate=Mu,R.interpolators=[function(n,t){var e=typeof t;return("string"==e?gt.has(t.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(t)?pu:du:t instanceof Hn?pu:Array.isArray(t)?xu:"object"==e&&isNaN(t)?gu:vu)(n,t)}],R.interpolateArray=xu;function bu(){return P}var _u=R.map({linear:bu,poly:function(t){return function(n){return Math.pow(n,t)}},quad:function(){return Nu},cubic:function(){return Eu},sin:function(){return Cu},exp:function(){return zu},circle:function(){return Lu},elastic:function(t,e){var r;arguments.length<2&&(e=.45);r=arguments.length?e/kn*Math.asin(1/t):(t=1,e/4);return function(n){return 1+t*Math.pow(2,-10*n)*Math.sin((n-r)*kn/e)}},back:function(t){t=t||1.70158;return function(n){return n*n*((t+1)*n-t)}},bounce:function(){return qu}}),wu=R.map({in:P,out:Su,"in-out":ku,"out-in":function(n){return ku(Su(n))}});function Su(t){return function(n){return 1-t(1-n)}}function ku(t){return function(n){return.5*(n<.5?t(2*n):2-t(2-2*n))}}function Nu(n){return n*n}function Eu(n){return n*n*n}function Au(n){if(n<=0)return 0;if(1<=n)return 1;var t=n*n,e=t*n;return 4*(n<.5?e:3*(n-t)+e-.75)}function Cu(n){return 1-Math.cos(n*En)}function zu(n){return Math.pow(2,10*(n-1))}function Lu(n){return 1-Math.sqrt(1-n*n)}function qu(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375}function Tu(t,e){return e-=t,function(n){return Math.round(t+e*n)}}function Ru(n){var t,e,r,i=[n.a,n.b],u=[n.c,n.d],o=Pu(i),a=Du(i,u),l=Pu(((t=u)[0]+=(r=-a)*(e=i)[0],t[1]+=r*e[1],t))||0;i[0]*u[1]<u[0]*i[1]&&(i[0]*=-1,i[1]*=-1,o*=-1,a*=-1),this.rotate=(o?Math.atan2(i[1],i[0]):Math.atan2(-u[0],u[1]))*Cn,this.translate=[n.e,n.f],this.scale=[o,l],this.skew=l?Math.atan2(a,l)*Cn:0}function Du(n,t){return n[0]*t[0]+n[1]*t[1]}function Pu(n){var t=Math.sqrt(Du(n,n));return t&&(n[0]/=t,n[1]/=t),t}R.ease=function(n){var t,e=n.indexOf("-"),r=0<=e?n.slice(0,e):n,i=0<=e?n.slice(e+1):"in",r=_u.get(r)||bu,i=wu.get(i)||P;return t=i(r.apply(null,u.call(arguments,1))),function(n){return n<=0?0:1<=n?1:t(n)}},R.interpolateHcl=function(n,t){n=R.hcl(n),t=R.hcl(t);var e=n.h,r=n.c,i=n.l,u=t.h-e,o=t.c-r,a=t.l-i;isNaN(o)&&(o=0,r=isNaN(r)?t.c:r);isNaN(u)?(u=0,e=isNaN(e)?t.h:e):180<u?u-=360:u<-180&&(u+=360);return function(n){return Xn(e+u*n,r+o*n,i+a*n)+""}},R.interpolateHsl=function(n,t){n=R.hsl(n),t=R.hsl(t);var e=n.h,r=n.s,i=n.l,u=t.h-e,o=t.s-r,a=t.l-i;isNaN(o)&&(o=0,r=isNaN(r)?t.s:r);isNaN(u)?(u=0,e=isNaN(e)?t.h:e):180<u?u-=360:u<-180&&(u+=360);return function(n){return Yn(e+u*n,r+o*n,i+a*n)+""}},R.interpolateLab=function(n,t){n=R.lab(n),t=R.lab(t);var e=n.l,r=n.a,i=n.b,u=t.l-e,o=t.a-r,a=t.b-i;return function(n){return Qn(e+u*n,r+o*n,i+a*n)+""}},R.interpolateRound=Tu,R.transform=function(n){var e=M.createElementNS(R.ns.prefix.svg,"g");return(R.transform=function(n){var t;return null!=n&&(e.setAttribute("transform",n),t=e.transform.baseVal.consolidate()),new Ru(t?t.matrix:ju)})(n)},Ru.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var ju={a:1,b:0,c:0,d:1,e:0,f:0};function Uu(n){return n.length?n.pop()+",":""}function Fu(n,t){var e,r,i,u,o,a,l,c,f,s,h,p,g,v,d,y,m,M,x=[],b=[];return n=R.transform(n),t=R.transform(t),e=n.translate,r=t.translate,i=x,u=b,e[0]!==r[0]||e[1]!==r[1]?(o=i.push("translate(",null,",",null,")"),u.push({i:o-4,x:vu(e[0],r[0])},{i:o-2,x:vu(e[1],r[1])})):(r[0]||r[1])&&i.push("translate("+r+")"),a=n.rotate,l=t.rotate,c=x,f=b,a!==l?(180<a-l?l+=360:180<l-a&&(a+=360),f.push({i:c.push(Uu(c)+"rotate(",null,")")-2,x:vu(a,l)})):l&&c.push(Uu(c)+"rotate("+l+")"),s=n.skew,h=t.skew,p=x,g=b,s!==h?g.push({i:p.push(Uu(p)+"skewX(",null,")")-2,x:vu(s,h)}):h&&p.push(Uu(p)+"skewX("+h+")"),v=n.scale,d=t.scale,y=x,m=b,v[0]!==d[0]||v[1]!==d[1]?(M=y.push(Uu(y)+"scale(",null,",",null,")"),m.push({i:M-4,x:vu(v[0],d[0])},{i:M-2,x:vu(v[1],d[1])})):1===d[0]&&1===d[1]||y.push(Uu(y)+"scale("+d+")"),n=t=null,function(n){for(var t,e=-1,r=b.length;++e<r;)x[(t=b[e]).i]=t.x(n);return x.join("")}}function Hu(t,e){return e=(e-=t=+t)||1/e,function(n){return(n-t)/e}}function Ou(t,e){return e=(e-=t=+t)||1/e,function(n){return Math.max(0,Math.min(1,(n-t)/e))}}function Iu(n){for(var t=n.source,e=n.target,r=function(n,t){if(n===t)return n;var e=Yu(n),r=Yu(t),i=e.pop(),u=r.pop(),o=null;for(;i===u;)o=i,i=e.pop(),u=r.pop();return o}(t,e),i=[t];t!==r;)t=t.parent,i.push(t);for(var u=i.length;e!==r;)i.splice(u,0,e),e=e.parent;return i}function Yu(n){for(var t=[],e=n.parent;null!=e;)t.push(n),e=(n=e).parent;return t.push(n),t}function Zu(n){n.fixed|=2}function Vu(n){n.fixed&=-7}function Xu(n){n.fixed|=4,n.px=n.x,n.py=n.y}function $u(n){n.fixed&=-5}R.interpolateTransform=Fu,R.layout={},R.layout.bundle=function(){return function(n){for(var t=[],e=-1,r=n.length;++e<r;)t.push(Iu(n[e]));return t}},R.layout.chord=function(){var d,y,m,M,x,b,_,t={},w=0;function n(){var n,t,e,r,i,u={},o=[],a=R.range(M),l=[];for(d=[],y=[],n=0,r=-1;++r<M;){for(t=0,i=-1;++i<M;)t+=m[r][i];o.push(t),l.push(R.range(M)),n+=t}for(x&&a.sort(function(n,t){return x(o[n],o[t])}),b&&l.forEach(function(n,e){n.sort(function(n,t){return b(m[e][n],m[e][t])})}),n=(kn-w*M)/n,t=0,r=-1;++r<M;){for(e=t,i=-1;++i<M;){var c=a[r],f=l[c][i],s=m[c][f],h=t,p=t+=s*n;u[c+"-"+f]={index:c,subindex:f,startAngle:h,endAngle:p,value:s}}y[c]={index:c,startAngle:e,endAngle:t,value:(t-e)/n},t+=w}for(r=-1;++r<M;)for(i=r-1;++i<M;){var g=u[r+"-"+i],v=u[i+"-"+r];(g.value||v.value)&&d.push(g.value<v.value?{source:v,target:g}:{source:g,target:v})}_&&S()}function S(){d.sort(function(n,t){return _((n.source.value+n.target.value)/2,(t.source.value+t.target.value)/2)})}return t.matrix=function(n){return arguments.length?(M=(m=n)&&m.length,d=y=null,t):m},t.padding=function(n){return arguments.length?(w=n,d=y=null,t):w},t.sortGroups=function(n){return arguments.length?(x=n,d=y=null,t):x},t.sortSubgroups=function(n){return arguments.length?(b=n,d=null,t):b},t.sortChords=function(n){return arguments.length?(_=n,d&&S(),t):_},t.chords=function(){return d||n(),d},t.groups=function(){return y||n(),y},t},R.layout.force=function(){var s,n,h,p,g,v,i={},d=R.dispatch("start","tick","end"),y=[1,1],m=.9,u=Bu,o=Wu,M=-30,f=Ju,x=.1,b=.64,_=[],w=[];function S(c){return function(n,t,e,r){if(n.point!==c){var i,u=n.cx-c.x,o=n.cy-c.y,a=r-t,l=u*u+o*o;if(a*a/b<l)return l<f&&(i=n.charge/l,c.px-=u*i,c.py-=o*i),!0;n.point&&l&&l<f&&(i=n.pointCharge/l,c.px-=u*i,c.py-=o*i)}return!n.charge}}function t(n){n.px=R.event.x,n.py=R.event.y,i.resume()}return i.tick=function(){if((h*=.99)<.005)return s=null,d.end({type:"end",alpha:h=0}),!0;for(var n,t,e,r,i,u,o,a,l=_.length,c=w.length,f=0;f<c;++f)e=(t=w[f]).source,(i=(o=(r=t.target).x-e.x)*o+(a=r.y-e.y)*a)&&(o*=i=h*g[f]*((i=Math.sqrt(i))-p[f])/i,a*=i,r.x-=o*(u=e.weight+r.weight?e.weight/(e.weight+r.weight):.5),r.y-=a*u,e.x+=o*(u=1-u),e.y+=a*u);if((u=h*x)&&(o=y[0]/2,a=y[1]/2,f=-1,u))for(;++f<l;)(t=_[f]).x+=(o-t.x)*u,t.y+=(a-t.y)*u;if(M)for(!function n(t,e,r){var i=0,u=0;t.charge=0;if(!t.leaf)for(var o,a=t.nodes,l=a.length,c=-1;++c<l;)null!=(o=a[c])&&(n(o,e,r),t.charge+=o.charge,i+=o.charge*o.cx,u+=o.charge*o.cy);{var f;t.point&&(t.leaf||(t.point.x+=Math.random()-.5,t.point.y+=Math.random()-.5),f=e*r[t.point.index],t.charge+=t.pointCharge=f,i+=f*t.point.x,u+=f*t.point.y)}t.cx=i/t.charge;t.cy=u/t.charge}(n=R.geom.quadtree(_),h,v),f=-1;++f<l;)(t=_[f]).fixed||n.visit(S(t));for(f=-1;++f<l;)(t=_[f]).fixed?(t.x=t.px,t.y=t.py):(t.x-=(t.px-(t.px=t.x))*m,t.y-=(t.py-(t.py=t.y))*m);d.tick({type:"tick",alpha:h})},i.nodes=function(n){return arguments.length?(_=n,i):_},i.links=function(n){return arguments.length?(w=n,i):w},i.size=function(n){return arguments.length?(y=n,i):y},i.linkDistance=function(n){return arguments.length?(u="function"==typeof n?n:+n,i):u},i.distance=i.linkDistance,i.linkStrength=function(n){return arguments.length?(o="function"==typeof n?n:+n,i):o},i.friction=function(n){return arguments.length?(m=+n,i):m},i.charge=function(n){return arguments.length?(M="function"==typeof n?n:+n,i):M},i.chargeDistance=function(n){return arguments.length?(f=n*n,i):Math.sqrt(f)},i.gravity=function(n){return arguments.length?(x=+n,i):x},i.theta=function(n){return arguments.length?(b=n*n,i):Math.sqrt(b)},i.alpha=function(n){return arguments.length?(n=+n,h?0<n?h=n:(s.c=null,s.t=NaN,s=null,d.end({type:"end",alpha:h=0})):0<n&&(d.start({type:"start",alpha:h=n}),s=wt(i.tick)),i):h},i.start=function(){for(var a,n,l=_.length,c=w.length,t=y[0],e=y[1],f=0;f<l;++f)(n=_[f]).index=f,n.weight=0;for(f=0;f<c;++f)"number"==typeof(n=w[f]).source&&(n.source=_[n.source]),"number"==typeof n.target&&(n.target=_[n.target]),++n.source.weight,++n.target.weight;for(f=0;f<l;++f)n=_[f],isNaN(n.x)&&(n.x=r("x",t)),isNaN(n.y)&&(n.y=r("y",e)),isNaN(n.px)&&(n.px=n.x),isNaN(n.py)&&(n.py=n.y);if(p=[],"function"==typeof u)for(f=0;f<c;++f)p[f]=+u.call(this,w[f],f);else for(f=0;f<c;++f)p[f]=u;if(g=[],"function"==typeof o)for(f=0;f<c;++f)g[f]=+o.call(this,w[f],f);else for(f=0;f<c;++f)g[f]=o;if(v=[],"function"==typeof M)for(f=0;f<l;++f)v[f]=+M.call(this,_[f],f);else for(f=0;f<l;++f)v[f]=M;function r(n,t){if(!a){for(a=new Array(l),u=0;u<l;++u)a[u]=[];for(u=0;u<c;++u){var e=w[u];a[e.source.index].push(e.target),a[e.target.index].push(e.source)}}for(var r,i=a[f],u=-1,o=i.length;++u<o;)if(!isNaN(r=i[u][n]))return r;return Math.random()*t}return i.resume()},i.resume=function(){return i.alpha(.1)},i.stop=function(){return i.alpha(0)},i.drag=function(){if(n=n||R.behavior.drag().origin(P).on("dragstart.force",Zu).on("drag.force",t).on("dragend.force",Vu),!arguments.length)return n;this.on("mouseover.force",Xu).on("mouseout.force",$u).call(n)},R.rebind(i,d,"on")};var Bu=20,Wu=1,Ju=1/0;function Gu(n,t){return R.rebind(n,t,"sort","children","value"),(n.nodes=n).links=ro,n}function Ku(n,t){for(var e,r,i=[n];null!=(n=i.pop());)if(t(n),(r=n.children)&&(e=r.length))for(;0<=--e;)i.push(r[e])}function Qu(n,t){for(var e=[n],r=[];null!=(n=e.pop());)if(r.push(n),(u=n.children)&&(i=u.length))for(var i,u,o=-1;++o<i;)e.push(u[o]);for(;null!=(n=r.pop());)t(n)}function no(n){return n.children}function to(n){return n.value}function eo(n,t){return t.value-n.value}function ro(n){return R.merge(n.map(function(t){return(t.children||[]).map(function(n){return{source:t,target:n}})}))}R.layout.hierarchy=function(){var a=eo,l=no,c=to;function f(n){var t,e,r,i,u=[n],o=[];for(n.depth=0;null!=(t=u.pop());)if(o.push(t),(r=l.call(f,t,t.depth))&&(e=r.length)){for(;0<=--e;)u.push(i=r[e]),i.parent=t,i.depth=t.depth+1;c&&(t.value=0),t.children=r}else c&&(t.value=+c.call(f,t,t.depth)||0),delete t.children;return Qu(n,function(n){var t,e;a&&(t=n.children)&&t.sort(a),c&&(e=n.parent)&&(e.value+=n.value)}),o}return f.sort=function(n){return arguments.length?(a=n,f):a},f.children=function(n){return arguments.length?(l=n,f):l},f.value=function(n){return arguments.length?(c=n,f):c},f.revalue=function(n){return c&&(Ku(n,function(n){n.children&&(n.value=0)}),Qu(n,function(n){var t;n.children||(n.value=+c.call(f,n,n.depth)||0),(t=n.parent)&&(t.value+=n.value)})),n},f},R.layout.partition=function(){var r=R.layout.hierarchy(),i=[1,1];function t(n,t){var e=r.call(this,n,t);return function n(t,e,r,i){var u=t.children;if(t.x=e,t.y=t.depth*i,t.dx=r,t.dy=i,u&&(o=u.length)){var o,a,l,c=-1;for(r=t.value?r/t.value:0;++c<o;)n(a=u[c],e,l=a.value*r,i),e+=l}}(e[0],0,i[0],i[1]/function n(t){var e=t.children,r=0;if(e&&(i=e.length))for(var i,u=-1;++u<i;)r=Math.max(r,n(e[u]));return 1+r}(e[0])),e}return t.size=function(n){return arguments.length?(i=n,t):i},Gu(t,r)},R.layout.pie=function(){var h=Number,p=io,g=0,v=kn,d=0;function y(e){var t,n=e.length,r=e.map(function(n,t){return+h.call(y,n,t)}),i=+("function"==typeof g?g.apply(this,arguments):g),u=("function"==typeof v?v.apply(this,arguments):v)-i,o=Math.min(Math.abs(u)/n,+("function"==typeof d?d.apply(this,arguments):d)),a=o*(u<0?-1:1),l=R.sum(r),c=l?(u-n*a)/l:0,f=R.range(n),s=[];return null!=p&&f.sort(p===io?function(n,t){return r[t]-r[n]}:function(n,t){return p(e[n],e[t])}),f.forEach(function(n){s[n]={data:e[n],value:t=r[n],startAngle:i,endAngle:i+=t*c+a,padAngle:o}}),s}return y.value=function(n){return arguments.length?(h=n,y):h},y.sort=function(n){return arguments.length?(p=n,y):p},y.startAngle=function(n){return arguments.length?(g=n,y):g},y.endAngle=function(n){return arguments.length?(v=n,y):v},y.padAngle=function(n){return arguments.length?(d=n,y):d},y};var io={};function uo(n){return n.x}function oo(n){return n.y}function ao(n,t,e){n.y0=t,n.y=e}R.layout.stack=function(){var s=P,h=fo,p=so,g=ao,v=uo,d=oo;function y(n,t){if(!(e=n.length))return n;for(var e,r,i,u=(a=n.map(function(n,t){return s.call(y,n,t)})).map(function(n){return n.map(function(n,t){return[v.call(y,n,t),d.call(y,n,t)]})}),o=h.call(y,u,t),a=R.permute(a,o),u=R.permute(u,o),l=p.call(y,u,t),c=a[0].length,f=0;f<c;++f)for(g.call(y,a[0][f],i=l[f],u[0][f][1]),r=1;r<e;++r)g.call(y,a[r][f],i+=u[r-1][f][1],u[r][f][1]);return n}return y.values=function(n){return arguments.length?(s=n,y):s},y.order=function(n){return arguments.length?(h="function"==typeof n?n:lo.get(n)||fo,y):h},y.offset=function(n){return arguments.length?(p="function"==typeof n?n:co.get(n)||so,y):p},y.x=function(n){return arguments.length?(v=n,y):v},y.y=function(n){return arguments.length?(d=n,y):d},y.out=function(n){return arguments.length?(g=n,y):g},y};var lo=R.map({"inside-out":function(n){for(var t,e=n.length,r=n.map(ho),i=n.map(po),u=R.range(e).sort(function(n,t){return r[n]-r[t]}),o=0,a=0,l=[],c=[],f=0;f<e;++f)t=u[f],o<a?(o+=i[t],l.push(t)):(a+=i[t],c.push(t));return c.reverse().concat(l)},reverse:function(n){return R.range(n.length).reverse()},default:fo}),co=R.map({silhouette:function(n){for(var t,e,r=n.length,i=n[0].length,u=[],o=0,a=[],l=0;l<i;++l){for(e=t=0;t<r;t++)e+=n[t][l][1];o<e&&(o=e),u.push(e)}for(l=0;l<i;++l)a[l]=(o-u[l])/2;return a},wiggle:function(n){var t,e,r,i,u,o,a,l,c,f=n.length,s=n[0],h=s.length,p=[];for(p[0]=l=c=0,e=1;e<h;++e){for(i=t=0;t<f;++t)i+=n[t][e][1];for(u=t=0,a=s[e][0]-s[e-1][0];t<f;++t){for(r=0,o=(n[t][e][1]-n[t][e-1][1])/(2*a);r<t;++r)o+=(n[r][e][1]-n[r][e-1][1])/a;u+=o*n[t][e][1]}p[e]=l-=i?u/i*a:0,l<c&&(c=l)}for(e=0;e<h;++e)p[e]-=c;return p},expand:function(n){for(var t,e,r=n.length,i=n[0].length,u=1/r,o=[],a=0;a<i;++a){for(e=t=0;t<r;t++)e+=n[t][a][1];if(e)for(t=0;t<r;t++)n[t][a][1]/=e;else for(t=0;t<r;t++)n[t][a][1]=u}for(a=0;a<i;++a)o[a]=0;return o},zero:so});function fo(n){return R.range(n.length)}function so(n){for(var t=-1,e=n[0].length,r=[];++t<e;)r[t]=0;return r}function ho(n){for(var t,e=1,r=0,i=n[0][1],u=n.length;e<u;++e)(t=n[e][1])>i&&(r=e,i=t);return r}function po(n){return n.reduce(go,0)}function go(n,t){return n+t[1]}function vo(n,t){return yo(n,Math.ceil(Math.log(t.length)/Math.LN2+1))}function yo(n,t){for(var e=-1,r=+n[0],i=(n[1]-r)/t,u=[];++e<=t;)u[e]=i*e+r;return u}function mo(n){return[R.min(n),R.max(n)]}function Mo(n,t){return n.value-t.value}function xo(n,t){var e=n._pack_next;(n._pack_next=t)._pack_prev=n,(t._pack_next=e)._pack_prev=t}function bo(n,t){(n._pack_next=t)._pack_prev=n}function _o(n,t){var e=t.x-n.x,r=t.y-n.y,i=n.r+t.r;return e*e+r*r<.999*i*i}function wo(n){if((t=n.children)&&(o=t.length)){var t,e,r,i,u,o,a=1/0,l=-1/0,c=1/0,f=-1/0;if(t.forEach(So),(e=t[0]).x=-e.r,e.y=0,M(e),1<o&&((r=t[1]).x=r.r,r.y=0,M(r),2<o))for(No(e,r,i=t[2]),M(i),xo(e,i),xo(e._pack_prev=i,r),r=e._pack_next,m=3;m<o;m++){No(e,r,i=t[m]);for(var s=0,h=1,p=1,g=r._pack_next;g!==r;g=g._pack_next,h++)if(_o(g,i)){s=1;break}if(1==s)for(u=e._pack_prev;u!==g._pack_prev&&!_o(u,i);u=u._pack_prev,p++);s?(h<p||h==p&&r.r<e.r?bo(e,r=g):bo(e=u,r),m--):(xo(e,i),M(r=i))}for(var v=(a+l)/2,d=(c+f)/2,y=0,m=0;m<o;m++)(i=t[m]).x-=v,i.y-=d,y=Math.max(y,i.r+Math.sqrt(i.x*i.x+i.y*i.y));n.r=y,t.forEach(ko)}function M(n){a=Math.min(n.x-n.r,a),l=Math.max(n.x+n.r,l),c=Math.min(n.y-n.r,c),f=Math.max(n.y+n.r,f)}}function So(n){n._pack_next=n._pack_prev=n}function ko(n){delete n._pack_next,delete n._pack_prev}function No(n,t,e){var r,i,u,o,a=n.r+e.r,l=t.x-n.x,c=t.y-n.y;a&&(l||c)?(r=t.r+e.r,u=.5+((a*=a)-(r*=r))/(2*(i=l*l+c*c)),o=Math.sqrt(Math.max(0,2*r*(a+i)-(a-=i)*a-r*r))/(2*i),e.x=n.x+u*l+o*c,e.y=n.y+u*c-o*l):(e.x=n.x+a,e.y=n.y)}function Eo(n,t){return n.parent==t.parent?1:2}function Ao(n){var t=n.children;return t.length?t[0]:n.t}function Co(n){var t,e=n.children;return(t=e.length)?e[t-1]:n.t}function zo(n,t,e){var r=e/(t.i-n.i);t.c-=r,t.s+=e,n.c+=r,t.z+=e,t.m+=e}function Lo(n){return{x:n.x,y:n.y,dx:n.dx,dy:n.dy}}function qo(n,t){var e=n.x+t[3],r=n.y+t[0],i=n.dx-t[1]-t[3],u=n.dy-t[0]-t[2];return i<0&&(e+=i/2,i=0),u<0&&(r+=u/2,u=0),{x:e,y:r,dx:i,dy:u}}function To(n){var t=n[0],e=n[n.length-1];return t<e?[t,e]:[e,t]}function Ro(n){return n.rangeExtent?n.rangeExtent():To(n.range())}function Do(n,t,e,r){var i=e(n[0],n[1]),u=r(t[0],t[1]);return function(n){return u(i(n))}}function Po(n,t){var e,r=0,i=n.length-1,u=n[r],o=n[i];return o<u&&(e=r,r=i,i=e,e=u,u=o,o=e),n[r]=t.floor(u),n[i]=t.ceil(o),n}R.layout.histogram=function(){var s=!0,h=Number,p=mo,g=vo;function e(n,t){for(var e,r,i=[],u=n.map(h,this),o=p.call(this,u,t),a=g.call(this,o,u,t),t=-1,l=u.length,c=a.length-1,f=s?1:1/l;++t<c;)(e=i[t]=[]).dx=a[t+1]-(e.x=a[t]),e.y=0;if(0<c)for(t=-1;++t<l;)(r=u[t])>=o[0]&&r<=o[1]&&((e=i[R.bisect(a,r,1,c)-1]).y+=f,e.push(n[t]));return i}return e.value=function(n){return arguments.length?(h=n,e):h},e.range=function(n){return arguments.length?(p=vt(n),e):p},e.bins=function(t){return arguments.length?(g="number"==typeof t?function(n){return yo(n,t)}:vt(t),e):g},e.frequency=function(n){return arguments.length?(s=!!n,e):s},e},R.layout.pack=function(){var l,c=R.layout.hierarchy().sort(Mo),f=0,s=[1,1];function t(n,t){var e,r=c.call(this,n,t),i=r[0],u=s[0],o=s[1],a=null==l?Math.sqrt:"function"==typeof l?l:function(){return l};return i.x=i.y=0,Qu(i,function(n){n.r=+a(n.value)}),Qu(i,wo),f&&(e=f*(l?1:Math.max(2*i.r/u,2*i.r/o))/2,Qu(i,function(n){n.r+=e}),Qu(i,wo),Qu(i,function(n){n.r-=e})),function n(t,e,r,i){var u=t.children;t.x=e+=i*t.x;t.y=r+=i*t.y;t.r*=i;if(u)for(var o=-1,a=u.length;++o<a;)n(u[o],e,r,i)}(i,u/2,o/2,l?1:1/Math.max(2*i.r/u,2*i.r/o)),r}return t.size=function(n){return arguments.length?(s=n,t):s},t.radius=function(n){return arguments.length?(l=null==n||"function"==typeof n?n:+n,t):l},t.padding=function(n){return arguments.length?(f=+n,t):f},Gu(t,c)},R.layout.tree=function(){var s=R.layout.hierarchy().sort(null).value(null),v=Eo,h=[1,1],p=null;function t(n,t){var e,r,i,u,o,a,l=s.call(this,n,t),c=l[0],f=function(n){var t,e={A:null,children:[n]},r=[e];for(;null!=(t=r.pop());)for(var i,u=t.children,o=0,a=u.length;o<a;++o)r.push((u[o]=i={_:u[o],parent:t,children:(i=u[o].children)&&i.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:o}).a=i);return e.children[0]}(c);return Qu(f,g),f.parent.m=-f.z,Ku(f,d),p?Ku(c,y):(Ku(i=r=e=c,function(n){n.x<e.x&&(e=n),n.x>r.x&&(r=n),n.depth>i.depth&&(i=n)}),u=v(e,r)/2-e.x,o=h[0]/(r.x+v(r,e)/2+u),a=h[1]/(i.depth||1),Ku(c,function(n){n.x=(n.x+u)*o,n.y=n.depth*a})),l}function g(n){var t,e=n.children,r=n.parent.children,i=n.i?r[n.i-1]:null;e.length?(function(n){var t,e=0,r=0,i=n.children,u=i.length;for(;0<=--u;)(t=i[u]).z+=e,t.m+=e,e+=t.s+(r+=t.c)}(n),t=(e[0].z+e[e.length-1].z)/2,i?(n.z=i.z+v(n._,i._),n.m=n.z-t):n.z=t):i&&(n.z=i.z+v(n._,i._)),n.parent.A=function(n,t,e){if(t){for(var r,i=n,u=n,o=t,a=i.parent.children[0],l=i.m,c=u.m,f=o.m,s=a.m;o=Co(o),i=Ao(i),o&&i;)a=Ao(a),(u=Co(u)).a=n,0<(r=o.z+f-i.z-l+v(o._,i._))&&(zo((p=n,g=e,(h=o).a.parent===p.parent?h.a:g),n,r),l+=r,c+=r),f+=o.m,l+=i.m,s+=a.m,c+=u.m;o&&!Co(u)&&(u.t=o,u.m+=f-c),i&&!Ao(a)&&(a.t=i,a.m+=l-s,e=n)}var h,p,g;return e}(n,i,n.parent.A||r[0])}function d(n){n._.x=n.z+n.parent.m,n.m+=n.parent.m}function y(n){n.x*=h[0],n.y=n.depth*h[1]}return t.separation=function(n){return arguments.length?(v=n,t):v},t.size=function(n){return arguments.length?(p=null==(h=n)?y:null,t):p?null:h},t.nodeSize=function(n){return arguments.length?(p=null==(h=n)?null:y,t):p?h:null},Gu(t,s)},R.layout.cluster=function(){var f=R.layout.hierarchy().sort(null).value(null),s=Eo,h=[1,1],p=!1;function t(n,t){var i,e=f.call(this,n,t),r=e[0],u=0;Qu(r,function(n){var t,e,r=n.children;r&&r.length?(n.x=(e=r).reduce(function(n,t){return n+t.x},0)/e.length,n.y=(t=r,1+R.max(t,function(n){return n.y}))):(n.x=i?u+=s(n,i):0,n.y=0,i=n)});var o=function n(t){var e=t.children;return e&&e.length?n(e[0]):t}(r),a=function n(t){var e,r=t.children;return r&&(e=r.length)?n(r[e-1]):t}(r),l=o.x-s(o,a)/2,c=a.x+s(a,o)/2;return Qu(r,p?function(n){n.x=(n.x-r.x)*h[0],n.y=(r.y-n.y)*h[1]}:function(n){n.x=(n.x-l)/(c-l)*h[0],n.y=(1-(r.y?n.y/r.y:1))*h[1]}),e}return t.separation=function(n){return arguments.length?(s=n,t):s},t.size=function(n){return arguments.length?(p=null==(h=n),t):p?null:h},t.nodeSize=function(n){return arguments.length?(p=null!=(h=n),t):p?h:null},Gu(t,f)},R.layout.treemap=function(){var r,i=R.layout.hierarchy(),f=Math.round,u=[1,1],o=null,s=Lo,a=!1,h="squarify",l=.5*(1+Math.sqrt(5));function p(n,t){for(var e,r,i=-1,u=n.length;++i<u;)r=(e=n[i]).value*(t<0?0:t),e.area=isNaN(r)||r<=0?0:r}function g(n){var t=n.children;if(t&&t.length){var e,r,i,u=s(n),o=[],a=t.slice(),l=1/0,c="slice"===h?u.dx:"dice"===h?u.dy:"slice-dice"===h?1&n.depth?u.dy:u.dx:Math.min(u.dx,u.dy);for(p(a,u.dx*u.dy/n.value),o.area=0;0<(i=a.length);)o.push(e=a[i-1]),o.area+=e.area,l="squarify"!==h||(r=v(o,c))<=l?(a.pop(),r):(o.area-=o.pop().area,d(o,c,u,!1),c=Math.min(u.dx,u.dy),o.length=o.area=0,1/0);o.length&&(d(o,c,u,!0),o.length=o.area=0),t.forEach(g)}}function c(n){var t=n.children;if(t&&t.length){var e,r=s(n),i=t.slice(),u=[];for(p(i,r.dx*r.dy/n.value),u.area=0;e=i.pop();)u.push(e),u.area+=e.area,null!=e.z&&(d(u,e.z?r.dx:r.dy,r,!i.length),u.length=u.area=0);t.forEach(c)}}function v(n,t){for(var e,r=n.area,i=0,u=1/0,o=-1,a=n.length;++o<a;)(e=n[o].area)&&(e<u&&(u=e),i<e&&(i=e));return t*=t,(r*=r)?Math.max(t*i*l/r,r/(t*u*l)):1/0}function d(n,t,e,r){var i,u=-1,o=n.length,a=e.x,l=e.y,c=t?f(n.area/t):0;if(t==e.dx){for((r||c>e.dy)&&(c=e.dy);++u<o;)(i=n[u]).x=a,i.y=l,i.dy=c,a+=i.dx=Math.min(e.x+e.dx-a,c?f(i.area/c):0);i.z=!0,i.dx+=e.x+e.dx-a,e.y+=c,e.dy-=c}else{for((r||c>e.dx)&&(c=e.dx);++u<o;)(i=n[u]).x=a,i.y=l,i.dx=c,l+=i.dy=Math.min(e.y+e.dy-l,c?f(i.area/c):0);i.z=!1,i.dy+=e.y+e.dy-l,e.x+=c,e.dx-=c}}function y(n){var t=r||i(n),e=t[0];return e.x=e.y=0,e.value?(e.dx=u[0],e.dy=u[1]):e.dx=e.dy=0,r&&i.revalue(e),p([e],e.dx*e.dy/e.value),(r?c:g)(e),a&&(r=t),t}return y.size=function(n){return arguments.length?(u=n,y):u},y.padding=function(e){if(!arguments.length)return o;function n(n){return qo(n,e)}var t;return s=null==(o=e)?Lo:"function"==(t=typeof e)?function(n){var t=e.call(y,n,n.depth);return null==t?Lo(n):qo(n,"number"==typeof t?[t,t,t,t]:t)}:("number"==t&&(e=[e,e,e,e]),n),y},y.round=function(n){return arguments.length?(f=n?Math.round:Number,y):f!=Number},y.sticky=function(n){return arguments.length?(a=n,r=null,y):a},y.ratio=function(n){return arguments.length?(l=n,y):l},y.mode=function(n){return arguments.length?(h=n+"",y):h},Gu(y,i)},R.random={normal:function(r,i){var n=arguments.length;return n<2&&(i=1),n<1&&(r=0),function(){for(var n,t,e;!(e=(n=2*Math.random()-1)*n+(t=2*Math.random()-1)*t)||1<e;);return r+i*n*Math.sqrt(-2*Math.log(e)/e)}},logNormal:function(){var n=R.random.normal.apply(R,arguments);return function(){return Math.exp(n())}},bates:function(n){var t=R.random.irwinHall(n);return function(){return t()/n}},irwinHall:function(e){return function(){for(var n=0,t=0;t<e;t++)n+=Math.random();return n}}},R.scale={};var jo={floor:P,ceil:P};function Uo(e,n,t,r){var i=[],u=[],o=0,a=Math.min(e.length,n.length)-1;for(e[a]<e[0]&&(e=e.slice().reverse(),n=n.slice().reverse());++o<=a;)i.push(t(e[o-1],e[o])),u.push(r(n[o-1],n[o]));return function(n){var t=R.bisect(e,n,1,a)-1;return u[t](i[t](n))}}function Fo(n,t){return R.rebind(n,t,"range","rangeRound","interpolate","clamp")}function Ho(n,t){return Po(n,(e=Oo(n,t)[2])?{floor:function(n){return Math.floor(n/e)*e},ceil:function(n){return Math.ceil(n/e)*e}}:jo);var e}function Oo(n,t){null==t&&(t=10);var e=To(n),r=e[1]-e[0],i=Math.pow(10,Math.floor(Math.log(r/t)/Math.LN10)),u=t/r*i;return u<=.15?i*=10:u<=.35?i*=5:u<=.75&&(i*=2),e[0]=Math.ceil(e[0]/i)*i,e[1]=Math.floor(e[1]/i)*i+.5*i,e[2]=i,e}function Io(n,t){return R.range.apply(R,Oo(n,t))}function Yo(n,t,e){var r,i,u,o=Oo(n,t);if(e){var a=Ct.exec(e);if(a.shift(),"s"===a[8]){var l=R.formatPrefix(Math.max(T(o[0]),T(o[1])));return a[7]||(a[7]="."+Vo(l.scale(o[2]))),a[8]="f",e=R.format(a.join("")),function(n){return e(l.scale(n))+l.symbol}}a[7]||(a[7]="."+(r=a[8],u=Vo((i=o)[2]),r in Zo?Math.abs(u-Vo(Math.max(T(i[0]),T(i[1]))))+ +("e"!==r):u-2*("%"===r))),e=a.join("")}else e=",."+Vo(o[2])+"f";return R.format(e)}R.scale.linear=function(){return function n(e,r,i,u){var o,a;function t(){var n=2<Math.min(e.length,r.length)?Uo:Do,t=u?Ou:Hu;return o=n(e,r,t,i),a=n(r,e,t,Mu),l}function l(n){return o(n)}l.invert=function(n){return a(n)};l.domain=function(n){return arguments.length?(e=n.map(Number),t()):e};l.range=function(n){return arguments.length?(r=n,t()):r};l.rangeRound=function(n){return l.range(n).interpolate(Tu)};l.clamp=function(n){return arguments.length?(u=n,t()):u};l.interpolate=function(n){return arguments.length?(i=n,t()):i};l.ticks=function(n){return Io(e,n)};l.tickFormat=function(n,t){return Yo(e,n,t)};l.nice=function(n){return Ho(e,n),t()};l.copy=function(){return n(e,r,i,u)};return t()}([0,1],[0,1],Mu,!1)};var Zo={s:1,g:1,p:1,r:1,e:1};function Vo(n){return-Math.floor(Math.log(n)/Math.LN10+.01)}R.scale.log=function(){return function n(t,l,c,f){function s(n){return(c?Math.log(n<0?0:n):-Math.log(0<n?0:-n))/Math.log(l)}function h(n){return c?Math.pow(l,n):-Math.pow(l,-n)}function u(n){return t(s(n))}u.invert=function(n){return h(t.invert(n))};u.domain=function(n){return arguments.length?(c=0<=n[0],t.domain((f=n.map(Number)).map(s)),u):f};u.base=function(n){return arguments.length?(l=+n,t.domain(f.map(s)),u):l};u.nice=function(){var n=Po(f.map(s),c?Math:$o);return t.domain(n),f=n.map(h),u};u.ticks=function(){var n=To(f),t=[],e=n[0],r=n[1],i=Math.floor(s(e)),u=Math.ceil(s(r)),o=l%1?2:l;if(isFinite(u-i)){if(c){for(;i<u;i++)for(var a=1;a<o;a++)t.push(h(i)*a);t.push(h(i))}else for(t.push(h(i));i++<u;)for(var a=o-1;0<a;a--)t.push(h(i)*a);for(i=0;t[i]<e;i++);for(u=t.length;t[u-1]>r;u--);t=t.slice(i,u)}return t};u.tickFormat=function(n,t){if(!arguments.length)return Xo;arguments.length<2?t=Xo:"function"!=typeof t&&(t=R.format(t));var e,r=Math.max(.1,n/u.ticks().length),i=c?(e=1e-12,Math.ceil):(e=-1e-12,Math.floor);return function(n){return n/h(i(s(n)+e))<=r?t(n):""}};u.copy=function(){return n(t.copy(),l,c,f)};return Fo(u,t)}(R.scale.linear().domain([0,1]),10,!0,[1,10])};var Xo=R.format(".0e"),$o={floor:function(n){return-Math.ceil(-n)},ceil:function(n){return-Math.floor(-n)}};function Bo(t){return function(n){return n<0?-Math.pow(-n,t):Math.pow(n,t)}}R.scale.pow=function(){return function n(t,e,r){var i=Bo(e),u=Bo(1/e);function o(n){return t(i(n))}o.invert=function(n){return u(t.invert(n))};o.domain=function(n){return arguments.length?(t.domain((r=n.map(Number)).map(i)),o):r};o.ticks=function(n){return Io(r,n)};o.tickFormat=function(n,t){return Yo(r,n,t)};o.nice=function(n){return o.domain(Ho(r,n))};o.exponent=function(n){return arguments.length?(i=Bo(e=n),u=Bo(1/e),t.domain(r.map(i)),o):e};o.copy=function(){return n(t.copy(),e,r)};return Fo(o,t)}(R.scale.linear(),1,[0,1])},R.scale.sqrt=function(){return R.scale.pow().exponent(.5)},R.scale.ordinal=function(){return function n(a,l){var i,c,f;function s(n){return c[((i.get(n)||("range"===l.t?i.set(n,a.push(n)):NaN))-1)%c.length]}function h(t,e){return R.range(a.length).map(function(n){return t+e*n})}s.domain=function(n){if(!arguments.length)return a;a=[],i=new m;for(var t,e=-1,r=n.length;++e<r;)i.has(t=n[e])||i.set(t,a.push(t));return s[l.t].apply(s,l.a)};s.range=function(n){return arguments.length?(c=n,f=0,l={t:"range",a:arguments},s):c};s.rangePoints=function(n,t){arguments.length<2&&(t=0);var e=n[0],r=n[1],i=a.length<2?(e=(e+r)/2,0):(r-e)/(a.length-1+t);return c=h(e+i*t/2,i),f=0,l={t:"rangePoints",a:arguments},s};s.rangeRoundPoints=function(n,t){arguments.length<2&&(t=0);var e=n[0],r=n[1],i=a.length<2?(e=r=Math.round((e+r)/2),0):(r-e)/(a.length-1+t)|0;return c=h(e+Math.round(i*t/2+(r-e-(a.length-1+t)*i)/2),i),f=0,l={t:"rangeRoundPoints",a:arguments},s};s.rangeBands=function(n,t,e){arguments.length<2&&(t=0),arguments.length<3&&(e=t);var r=n[1]<n[0],i=n[+r],u=n[1-r],o=(u-i)/(a.length-t+2*e);return c=h(i+o*e,o),r&&c.reverse(),f=o*(1-t),l={t:"rangeBands",a:arguments},s};s.rangeRoundBands=function(n,t,e){arguments.length<2&&(t=0),arguments.length<3&&(e=t);var r=n[1]<n[0],i=n[+r],u=n[1-r],o=Math.floor((u-i)/(a.length-t+2*e));return c=h(i+Math.round((u-i-(a.length-t)*o)/2),o),r&&c.reverse(),f=Math.round(o*(1-t)),l={t:"rangeRoundBands",a:arguments},s};s.rangeBand=function(){return f};s.rangeExtent=function(){return To(l.a[0])};s.copy=function(){return n(a,l)};return s.domain(a)}([],{t:"range",a:[[]]})},R.scale.category10=function(){return R.scale.ordinal().range(Wo)},R.scale.category20=function(){return R.scale.ordinal().range(Jo)},R.scale.category20b=function(){return R.scale.ordinal().range(Go)},R.scale.category20c=function(){return R.scale.ordinal().range(Ko)};var Wo=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(ot),Jo=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(ot),Go=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(ot),Ko=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(ot);function Qo(){return 0}R.scale.quantile=function(){return function n(e,r){var i;function t(){var n=0,t=r.length;for(i=[];++n<t;)i[n-1]=R.quantile(e,n/t);return u}function u(n){if(!isNaN(n=+n))return r[R.bisect(i,n)]}u.domain=function(n){return arguments.length?(e=n.map(c).filter(f).sort(l),t()):e};u.range=function(n){return arguments.length?(r=n,t()):r};u.quantiles=function(){return i};u.invertExtent=function(n){return(n=r.indexOf(n))<0?[NaN,NaN]:[0<n?i[n-1]:e[0],n<i.length?i[n]:e[e.length-1]]};u.copy=function(){return n(e,r)};return t()}([],[])},R.scale.quantize=function(){return function n(t,e,r){var i,u;function o(n){return r[Math.max(0,Math.min(u,Math.floor(i*(n-t))))]}function a(){return i=r.length/(e-t),u=r.length-1,o}o.domain=function(n){return arguments.length?(t=+n[0],e=+n[n.length-1],a()):[t,e]};o.range=function(n){return arguments.length?(r=n,a()):r};o.invertExtent=function(n){return[n=(n=r.indexOf(n))<0?NaN:n/i+t,n+1/i]};o.copy=function(){return n(t,e,r)};return a()}(0,1,[0,1])},R.scale.threshold=function(){return function n(t,e){function r(n){if(n<=n)return e[R.bisect(t,n)]}r.domain=function(n){return arguments.length?(t=n,r):t};r.range=function(n){return arguments.length?(e=n,r):e};r.invertExtent=function(n){return n=e.indexOf(n),[t[n-1],t[n]]};r.copy=function(){return n(t,e)};return r}([.5],[0,1])},R.scale.identity=function(){return function n(e){function t(n){return+n}t.invert=t;t.domain=t.range=function(n){return arguments.length?(e=n.map(t),t):e};t.ticks=function(n){return Io(e,n)};t.tickFormat=function(n,t){return Yo(e,n,t)};t.copy=function(){return n(e)};return t}([0,1])},R.svg={},R.svg.arc=function(){var U=ta,F=ea,H=Qo,O=na,I=ra,Y=ia,Z=ua;function t(){var n=Math.max(0,+U.apply(this,arguments)),t=Math.max(0,+F.apply(this,arguments)),e=I.apply(this,arguments)-En,r=Y.apply(this,arguments)-En,i=Math.abs(r-e),u=r<e?0:1;if(t<n&&(o=t,t=n,n=o),Nn<=i)return V(t,u)+(n?V(n,1-u):"")+"Z";var o,a,l,c,f,s,h,p,g,v,d,y,m,M,x,b,_,w,S,k,N,E,A,C,z,L,q,T,R,D=0,P=0,j=[];return(c=(+Z.apply(this,arguments)||0)/2)&&(l=O===na?Math.sqrt(n*n+t*t):+O.apply(this,arguments),u||(P*=-1),t&&(P=Tn(l/t*Math.sin(c))),n&&(D=Tn(l/n*Math.sin(c)))),t?(g=t*Math.cos(e+P),v=t*Math.sin(e+P),d=t*Math.cos(r-P),f=t*Math.sin(r-P),h=Math.abs(r-e-2*P)<=Sn?0:1,P&&oa(g,v,d,f)===u^h&&(p=(e+r)/2,g=t*Math.cos(p),v=t*Math.sin(p),d=f=null)):g=v=0,n?(M=n*Math.cos(r-D),x=n*Math.sin(r-D),b=n*Math.cos(e+D),s=n*Math.sin(e+D),y=Math.abs(e-r+2*D)<=Sn?0:1,D&&oa(M,x,b,s)===1-u^y&&(m=(e+r)/2,M=n*Math.cos(m),x=n*Math.sin(m),b=s=null)):M=x=0,_n<i&&.001<(o=Math.min(Math.abs(t-n)/2,+H.apply(this,arguments)))?(a=n<t^u?0:1,C=z=o,i<Sn&&(w=g-(_=null==b?[M,x]:null==d?[g,v]:Ci([g,v],[b,s],[d,f],[M,x]))[0],S=v-_[1],k=d-_[0],N=f-_[1],E=1/Math.sin(Math.acos((w*k+S*N)/(Math.sqrt(w*w+S*S)*Math.sqrt(k*k+N*N)))/2),A=Math.sqrt(_[0]*_[0]+_[1]*_[1]),C=Math.min(o,(n-A)/(E-1)),z=Math.min(o,(t-A)/(1+E))),null!=d?(L=aa(null==b?[M,x]:[b,s],[g,v],t,z,u),q=aa([d,f],[M,x],t,z,u),o===z?j.push("M",L[0],"A",z,",",z," 0 0,",a," ",L[1],"A",t,",",t," 0 ",1-u^oa(L[1][0],L[1][1],q[1][0],q[1][1]),",",u," ",q[1],"A",z,",",z," 0 0,",a," ",q[0]):j.push("M",L[0],"A",z,",",z," 0 1,",a," ",q[0])):j.push("M",g,",",v),null!=b?(T=aa([g,v],[b,s],n,-C,u),R=aa([M,x],null==d?[g,v]:[d,f],n,-C,u),o===C?j.push("L",R[0],"A",C,",",C," 0 0,",a," ",R[1],"A",n,",",n," 0 ",u^oa(R[1][0],R[1][1],T[1][0],T[1][1]),",",1-u," ",T[1],"A",C,",",C," 0 0,",a," ",T[0]):j.push("L",R[0],"A",C,",",C," 0 0,",a," ",T[0])):j.push("L",M,",",x)):(j.push("M",g,",",v),null!=d&&j.push("A",t,",",t," 0 ",h,",",u," ",d,",",f),j.push("L",M,",",x),null!=b&&j.push("A",n,",",n," 0 ",y,",",1-u," ",b,",",s)),j.push("Z"),j.join("")}function V(n,t){return"M0,"+n+"A"+n+","+n+" 0 1,"+t+" 0,"+-n+"A"+n+","+n+" 0 1,"+t+" 0,"+n}return t.innerRadius=function(n){return arguments.length?(U=vt(n),t):U},t.outerRadius=function(n){return arguments.length?(F=vt(n),t):F},t.cornerRadius=function(n){return arguments.length?(H=vt(n),t):H},t.padRadius=function(n){return arguments.length?(O=n==na?na:vt(n),t):O},t.startAngle=function(n){return arguments.length?(I=vt(n),t):I},t.endAngle=function(n){return arguments.length?(Y=vt(n),t):Y},t.padAngle=function(n){return arguments.length?(Z=vt(n),t):Z},t.centroid=function(){var n=(+U.apply(this,arguments)+ +F.apply(this,arguments))/2,t=(+I.apply(this,arguments)+ +Y.apply(this,arguments))/2-En;return[Math.cos(t)*n,Math.sin(t)*n]},t};var na="auto";function ta(n){return n.innerRadius}function ea(n){return n.outerRadius}function ra(n){return n.startAngle}function ia(n){return n.endAngle}function ua(n){return n&&n.padAngle}function oa(n,t,e,r){return 0<(n-e)*t-(t-r)*n?0:1}function aa(n,t,e,r,i){var u=n[0]-t[0],o=n[1]-t[1],a=(i?r:-r)/Math.sqrt(u*u+o*o),l=a*o,c=-a*u,f=n[0]+l,s=n[1]+c,h=t[0]+l,p=t[1]+c,g=(f+h)/2,v=(s+p)/2,d=h-f,y=p-s,m=d*d+y*y,M=e-r,x=f*p-h*s,b=(y<0?-1:1)*Math.sqrt(Math.max(0,M*M*m-x*x)),_=(x*y-d*b)/m,w=(-x*d-y*b)/m,S=(x*y+d*b)/m,k=(-x*d+y*b)/m,N=_-g,E=w-v,A=S-g,C=k-v;return A*A+C*C<N*N+E*E&&(_=S,w=k),[[_-l,w-c],[_*e/M,w*e/M]]}function la(c){var f=wi,s=Si,h=gr,p=fa,t=p.key,g=.7;function e(n){var t,e=[],r=[],i=-1,u=n.length,o=vt(f),a=vt(s);function l(){e.push("M",p(c(r),g))}for(;++i<u;)h.call(this,t=n[i],i)?r.push([+o.call(this,t,i),+a.call(this,t,i)]):r.length&&(l(),r=[]);return r.length&&l(),e.length?e.join(""):null}return e.x=function(n){return arguments.length?(f=n,e):f},e.y=function(n){return arguments.length?(s=n,e):s},e.defined=function(n){return arguments.length?(h=n,e):h},e.interpolate=function(n){return arguments.length?(t="function"==typeof n?p=n:(p=ca.get(n)||fa).key,e):t},e.tension=function(n){return arguments.length?(g=n,e):g},e}R.svg.line=function(){return la(P)};var ca=R.map({linear:fa,"linear-closed":sa,step:function(n){var t=0,e=n.length,r=n[0],i=[r[0],",",r[1]];for(;++t<e;)i.push("H",(r[0]+(r=n[t])[0])/2,"V",r[1]);1<e&&i.push("H",r[0]);return i.join("")},"step-before":ha,"step-after":pa,basis:da,"basis-open":function(n){if(n.length<4)return fa(n);var t,e=[],r=-1,i=n.length,u=[0],o=[0];for(;++r<3;)t=n[r],u.push(t[0]),o.push(t[1]);e.push(ya(xa,u)+","+ya(xa,o)),--r;for(;++r<i;)t=n[r],u.shift(),u.push(t[0]),o.shift(),o.push(t[1]),ba(e,u,o);return e.join("")},"basis-closed":function(n){var t,e,r=-1,i=n.length,u=i+4,o=[],a=[];for(;++r<4;)e=n[r%i],o.push(e[0]),a.push(e[1]);t=[ya(xa,o),",",ya(xa,a)],--r;for(;++r<u;)e=n[r%i],o.shift(),o.push(e[0]),a.shift(),a.push(e[1]),ba(t,o,a);return t.join("")},bundle:function(n,t){var e=n.length-1;if(e)for(var r,i,u=n[0][0],o=n[0][1],a=n[e][0]-u,l=n[e][1]-o,c=-1;++c<=e;)r=n[c],i=c/e,r[0]=t*r[0]+(1-t)*(u+i*a),r[1]=t*r[1]+(1-t)*(o+i*l);return da(n)},cardinal:function(n,t){return n.length<3?fa(n):n[0]+ga(n,va(n,t))},"cardinal-open":function(n,t){return n.length<4?fa(n):n[1]+ga(n.slice(1,-1),va(n,t))},"cardinal-closed":function(n,t){return n.length<3?sa(n):n[0]+ga((n.push(n[0]),n),va([n[n.length-2]].concat(n,[n[1]]),t))},monotone:function(n){return n.length<3?fa(n):n[0]+ga(n,function(n){var t,e,r,i,u=[],o=function(n){var t=0,e=n.length-1,r=[],i=n[0],u=n[1],o=r[0]=_a(i,u);for(;++t<e;)r[t]=(o+(o=_a(i=u,u=n[t+1])))/2;return r[t]=o,r}(n),a=-1,l=n.length-1;for(;++a<l;)t=_a(n[a],n[a+1]),T(t)<_n?o[a]=o[a+1]=0:(e=o[a]/t,r=o[a+1]/t,9<(i=e*e+r*r)&&(i=3*t/Math.sqrt(i),o[a]=i*e,o[a+1]=i*r));a=-1;for(;++a<=l;)i=(n[Math.min(l,a+1)][0]-n[Math.max(0,a-1)][0])/(6*(1+o[a]*o[a])),u.push([i||0,o[a]*i||0]);return u}(n))}});function fa(n){return 1<n.length?n.join("L"):n+"Z"}function sa(n){return n.join("L")+"Z"}function ha(n){for(var t=0,e=n.length,r=n[0],i=[r[0],",",r[1]];++t<e;)i.push("V",(r=n[t])[1],"H",r[0]);return i.join("")}function pa(n){for(var t=0,e=n.length,r=n[0],i=[r[0],",",r[1]];++t<e;)i.push("H",(r=n[t])[0],"V",r[1]);return i.join("")}function ga(n,t){if(t.length<1||n.length!=t.length&&n.length!=t.length+2)return fa(n);var e,r=n.length!=t.length,i="",u=n[0],o=n[1],a=t[0],l=a,c=1;if(r&&(i+="Q"+(o[0]-2*a[0]/3)+","+(o[1]-2*a[1]/3)+","+o[0]+","+o[1],u=n[1],c=2),1<t.length){l=t[1],o=n[c],c++,i+="C"+(u[0]+a[0])+","+(u[1]+a[1])+","+(o[0]-l[0])+","+(o[1]-l[1])+","+o[0]+","+o[1];for(var f=2;f<t.length;f++,c++)o=n[c],l=t[f],i+="S"+(o[0]-l[0])+","+(o[1]-l[1])+","+o[0]+","+o[1]}return r&&(e=n[c],i+="Q"+(o[0]+2*l[0]/3)+","+(o[1]+2*l[1]/3)+","+e[0]+","+e[1]),i}function va(n,t){for(var e,r=[],i=(1-t)/2,u=n[0],o=n[1],a=1,l=n.length;++a<l;)e=u,u=o,o=n[a],r.push([i*(o[0]-e[0]),i*(o[1]-e[1])]);return r}function da(n){if(n.length<3)return fa(n);var t=1,e=n.length,r=n[0],i=r[0],u=r[1],o=[i,i,i,(r=n[1])[0]],a=[u,u,u,r[1]],l=[i,",",u,"L",ya(xa,o),",",ya(xa,a)];for(n.push(n[e-1]);++t<=e;)r=n[t],o.shift(),o.push(r[0]),a.shift(),a.push(r[1]),ba(l,o,a);return n.pop(),l.push("L",r),l.join("")}function ya(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]+n[3]*t[3]}ca.forEach(function(n,t){t.key=n,t.closed=/-closed$/.test(n)});var ma=[0,2/3,1/3,0],Ma=[0,1/3,2/3,0],xa=[0,1/6,2/3,1/6];function ba(n,t,e){n.push("C",ya(ma,t),",",ya(ma,e),",",ya(Ma,t),",",ya(Ma,e),",",ya(xa,t),",",ya(xa,e))}function _a(n,t){return(t[1]-n[1])/(t[0]-n[0])}function wa(n){for(var t,e,r,i=-1,u=n.length;++i<u;)e=(t=n[i])[0],r=t[1]-En,t[0]=e*Math.cos(r),t[1]=e*Math.sin(r);return n}function Sa(g){var v=wi,d=wi,y=0,m=Si,M=gr,x=fa,t=x.key,b=x,_="L",w=.7;function e(n){var t,e,r,i=[],u=[],o=[],a=-1,l=n.length,c=vt(v),f=vt(y),s=v===d?function(){return e}:vt(d),h=y===m?function(){return r}:vt(m);function p(){i.push("M",x(g(o),w),_,b(g(u.reverse()),w),"Z")}for(;++a<l;)M.call(this,t=n[a],a)?(u.push([e=+c.call(this,t,a),r=+f.call(this,t,a)]),o.push([+s.call(this,t,a),+h.call(this,t,a)])):u.length&&(p(),u=[],o=[]);return u.length&&p(),i.length?i.join(""):null}return e.x=function(n){return arguments.length?(v=d=n,e):d},e.x0=function(n){return arguments.length?(v=n,e):v},e.x1=function(n){return arguments.length?(d=n,e):d},e.y=function(n){return arguments.length?(y=m=n,e):m},e.y0=function(n){return arguments.length?(y=n,e):y},e.y1=function(n){return arguments.length?(m=n,e):m},e.defined=function(n){return arguments.length?(M=n,e):M},e.interpolate=function(n){return arguments.length?(t="function"==typeof n?x=n:(x=ca.get(n)||fa).key,b=x.reverse||x,_=x.closed?"M":"L",e):t},e.tension=function(n){return arguments.length?(w=n,e):w},e}function ka(n){return n.radius}function Na(n){return[n.x,n.y]}function Ea(){return 64}function Aa(){return"circle"}function Ca(n){var t=Math.sqrt(n/Sn);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+-t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}R.svg.line.radial=function(){var n=la(wa);return n.radius=n.x,delete n.x,n.angle=n.y,delete n.y,n},(ha.reverse=pa).reverse=ha,R.svg.area=function(){return Sa(P)},R.svg.area.radial=function(){var n=Sa(wa);return n.radius=n.x,delete n.x,n.innerRadius=n.x0,delete n.x0,n.outerRadius=n.x1,delete n.x1,n.angle=n.y,delete n.y,n.startAngle=n.y0,delete n.y0,n.endAngle=n.y1,delete n.y1,n},R.svg.chord=function(){var o=ci,a=fi,l=ka,c=ra,f=ia;function t(n,t){var e,r,i=s(this,o,n,t),u=s(this,a,n,t);return"M"+i.p0+h(i.r,i.p1,i.a1-i.a0)+(r=u,(e=i).a0==r.a0&&e.a1==r.a1?p(i.r,i.p1,i.r,i.p0):p(i.r,i.p1,u.r,u.p0)+h(u.r,u.p1,u.a1-u.a0)+p(u.r,u.p1,i.r,i.p0))+"Z"}function s(n,t,e,r){var i=t.call(n,e,r),u=l.call(n,i,r),o=c.call(n,i,r)-En,a=f.call(n,i,r)-En;return{r:u,a0:o,a1:a,p0:[u*Math.cos(o),u*Math.sin(o)],p1:[u*Math.cos(a),u*Math.sin(a)]}}function h(n,t,e){return"A"+n+","+n+" 0 "+ +(Sn<e)+",1 "+t}function p(n,t,e,r){return"Q 0,0 "+r}return t.radius=function(n){return arguments.length?(l=vt(n),t):l},t.source=function(n){return arguments.length?(o=vt(n),t):o},t.target=function(n){return arguments.length?(a=vt(n),t):a},t.startAngle=function(n){return arguments.length?(c=vt(n),t):c},t.endAngle=function(n){return arguments.length?(f=vt(n),t):f},t},R.svg.diagonal=function(){var o=ci,a=fi,l=Na;function t(n,t){var e=o.call(this,n,t),r=a.call(this,n,t),i=(e.y+r.y)/2,u=[e,{x:e.x,y:i},{x:r.x,y:i},r];return"M"+(u=u.map(l))[0]+"C"+u[1]+" "+u[2]+" "+u[3]}return t.source=function(n){return arguments.length?(o=vt(n),t):o},t.target=function(n){return arguments.length?(a=vt(n),t):a},t.projection=function(n){return arguments.length?(l=n,t):l},t},R.svg.diagonal.radial=function(){var n=R.svg.diagonal(),t=Na,e=n.projection;return n.projection=function(n){return arguments.length?e((r=t=n,function(){var n=r.apply(this,arguments),t=n[0],e=n[1]-En;return[t*Math.cos(e),t*Math.sin(e)]})):t;var r},n},R.svg.symbol=function(){var e=Aa,r=Ea;function t(n,t){return(za.get(e.call(this,n,t))||Ca)(r.call(this,n,t))}return t.type=function(n){return arguments.length?(e=vt(n),t):e},t.size=function(n){return arguments.length?(r=vt(n),t):r},t};var za=R.map({circle:Ca,cross:function(n){var t=Math.sqrt(n/5)/2;return"M"+-3*t+","+-t+"H"+-t+"V"+-3*t+"H"+t+"V"+-t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+-t+"V"+t+"H"+-3*t+"Z"},diamond:function(n){var t=Math.sqrt(n/(2*qa)),e=t*qa;return"M0,"+-t+"L"+e+",0 0,"+t+" "+-e+",0Z"},square:function(n){var t=Math.sqrt(n)/2;return"M"+-t+","+-t+"L"+t+","+-t+" "+t+","+t+" "+-t+","+t+"Z"},"triangle-down":function(n){var t=Math.sqrt(n/La),e=t*La/2;return"M0,"+e+"L"+t+","+-e+" "+-t+","+-e+"Z"},"triangle-up":function(n){var t=Math.sqrt(n/La),e=t*La/2;return"M0,"+-e+"L"+t+","+e+" "+-t+","+e+"Z"}});R.svg.symbolTypes=za.keys();var La=Math.sqrt(3),qa=Math.tan(30*An);X.transition=function(n){for(var t,e,r=Pa||++Fa,i=Ia(n),u=[],o=ja||{time:Date.now(),ease:Au,delay:0,duration:250},a=-1,l=this.length;++a<l;){u.push(t=[]);for(var c=this[a],f=-1,s=c.length;++f<s;)(e=c[f])&&Ya(e,f,i,r,o),t.push(e)}return Da(u,i,r)},X.interrupt=function(n){return this.each(null==n?Ta:Ra(Ia(n)))};var Ta=Ra(Ia());function Ra(r){return function(){var n,t,e;(n=this[r])&&(e=n[t=n.active])&&(e.timer.c=null,e.timer.t=NaN,--n.count?delete n[t]:delete this[r],n.active+=.5,e.event&&e.event.interrupt.call(this,this.__data__,e.index))}}function Da(n,t,e){return O(n,Ua),n.namespace=t,n.id=e,n}var Pa,ja,Ua=[],Fa=0;function Ha(n,r,i,u){var o=n.id,a=n.namespace;return cn(n,"function"==typeof i?function(n,t,e){n[a][o].tween.set(r,u(i.call(n,n.__data__,t,e)))}:(i=u(i),function(n){n[a][o].tween.set(r,i)}))}function Oa(n){return null==n&&(n=""),function(){this.textContent=n}}function Ia(n){return null==n?"__transition__":"__transition_"+n+"__"}function Ya(u,o,i,a,n){var l,c,f,s,h,p=u[i]||(u[i]={active:0,count:0}),g=p[a];function e(n){var t,e=p.active,r=p[e];for(var i in r&&(r.timer.c=null,r.timer.t=NaN,--p.count,delete p[e],r.event&&r.event.interrupt.call(u,u.__data__,r.index)),p){+i<a&&((t=p[i]).timer.c=null,t.timer.t=NaN,--p.count,delete p[i])}c.c=v,wt(function(){return c.c&&v(n||1)&&(c.c=null,c.t=NaN),1},0,l),p.active=a,g.event&&g.event.start.call(u,u.__data__,o),h=[],g.tween.forEach(function(n,t){(t=t.call(u,u.__data__,o))&&h.push(t)}),s=g.ease,f=g.duration}function v(n){for(var t=n/f,e=s(t),r=h.length;0<r;)h[--r].call(u,e);if(1<=t)return g.event&&g.event.end.call(u,u.__data__,o),--p.count?delete p[a]:delete u[i],1}g||(l=n.time,c=wt(function(n){var t=g.delay;if(c.t=t+l,t<=n)return e(n-t);c.c=e},0,l),g=p[a]={tween:new m,time:l,timer:c,delay:n.delay,duration:n.duration,ease:n.ease,index:o},n=null,++p.count)}Ua.call=X.call,Ua.empty=X.empty,Ua.node=X.node,Ua.size=X.size,R.transition=function(n,t){return n&&n.transition?Pa?n.transition(t):n:R.selection().transition(n)},(R.transition.prototype=Ua).select=function(n){var t,e,r,i=this.id,u=this.namespace,o=[];n=$(n);for(var a=-1,l=this.length;++a<l;){o.push(t=[]);for(var c=this[a],f=-1,s=c.length;++f<s;)(r=c[f])&&(e=n.call(r,r.__data__,f,a))?("__data__"in r&&(e.__data__=r.__data__),Ya(e,f,u,i,r[u][i]),t.push(e)):t.push(null)}return Da(o,u,i)},Ua.selectAll=function(n){var t,e,r,i,u,o=this.id,a=this.namespace,l=[];n=B(n);for(var c=-1,f=this.length;++c<f;)for(var s=this[c],h=-1,p=s.length;++h<p;)if(r=s[h]){u=r[a][o],e=n.call(r,r.__data__,h,c),l.push(t=[]);for(var g=-1,v=e.length;++g<v;)(i=e[g])&&Ya(i,g,a,o,u),t.push(i)}return Da(l,a,o)},Ua.filter=function(n){var t,e,r=[];"function"!=typeof n&&(n=ln(n));for(var i=0,u=this.length;i<u;i++){r.push(t=[]);for(var o,a=0,l=(o=this[i]).length;a<l;a++)(e=o[a])&&n.call(e,e.__data__,a,i)&&t.push(e)}return Da(r,this.namespace,this.id)},Ua.tween=function(t,e){var r=this.id,i=this.namespace;return arguments.length<2?this.node()[i][r].tween.get(t):cn(this,null==e?function(n){n[i][r].tween.remove(t)}:function(n){n[i][r].tween.set(t,e)})},Ua.attr=function(n,t){if(arguments.length<2){for(t in n)this.attr(t,n[t]);return this}var r="transform"==n?Fu:Mu,i=R.ns.qualify(n);function u(){this.removeAttribute(i)}function o(){this.removeAttributeNS(i.space,i.local)}return Ha(this,"attr."+n,t,i.local?function(e){return null==e?o:(e+="",function(){var t,n=this.getAttributeNS(i.space,i.local);return n!==e&&(t=r(n,e),function(n){this.setAttributeNS(i.space,i.local,t(n))})})}:function(e){return null==e?u:(e+="",function(){var t,n=this.getAttribute(i);return n!==e&&(t=r(n,e),function(n){this.setAttribute(i,t(n))})})})},Ua.attrTween=function(n,r){var i=R.ns.qualify(n);return this.tween("attr."+n,i.local?function(n,t){var e=r.call(this,n,t,this.getAttributeNS(i.space,i.local));return e&&function(n){this.setAttributeNS(i.space,i.local,e(n))}}:function(n,t){var e=r.call(this,n,t,this.getAttribute(i));return e&&function(n){this.setAttribute(i,e(n))}})},Ua.style=function(r,n,i){var t=arguments.length;if(t<3){if("string"!=typeof r){for(i in t<2&&(n=""),r)this.style(i,r[i],n);return this}i=""}function u(){this.style.removeProperty(r)}return Ha(this,"style."+r,n,function(e){return null==e?u:(e+="",function(){var t,n=D(this).getComputedStyle(this,null).getPropertyValue(r);return n!==e&&(t=Mu(n,e),function(n){this.style.setProperty(r,t(n),i)})})})},Ua.styleTween=function(r,i,u){return arguments.length<3&&(u=""),this.tween("style."+r,function(n,t){var e=i.call(this,n,t,D(this).getComputedStyle(this,null).getPropertyValue(r));return e&&function(n){this.style.setProperty(r,e(n),u)}})},Ua.text=function(n){return Ha(this,"text",n,Oa)},Ua.remove=function(){var t=this.namespace;return this.each("end.transition",function(){var n;this[t].count<2&&(n=this.parentNode)&&n.removeChild(this)})},Ua.ease=function(t){var e=this.id,r=this.namespace;return arguments.length<1?this.node()[r][e].ease:("function"!=typeof t&&(t=R.ease.apply(R,arguments)),cn(this,function(n){n[r][e].ease=t}))},Ua.delay=function(r){var i=this.id,u=this.namespace;return arguments.length<1?this.node()[u][i].delay:cn(this,"function"==typeof r?function(n,t,e){n[u][i].delay=+r.call(n,n.__data__,t,e)}:(r=+r,function(n){n[u][i].delay=r}))},Ua.duration=function(r){var i=this.id,u=this.namespace;return arguments.length<1?this.node()[u][i].duration:cn(this,"function"==typeof r?function(n,t,e){n[u][i].duration=Math.max(1,r.call(n,n.__data__,t,e))}:(r=Math.max(1,r),function(n){n[u][i].duration=r}))},Ua.each=function(r,e){var i=this.id,u=this.namespace;if(arguments.length<2){var n=ja,t=Pa;try{Pa=i,cn(this,function(n,t,e){ja=n[u][i],r.call(n,n.__data__,t,e)})}finally{ja=n,Pa=t}}else cn(this,function(n){var t=n[u][i];(t.event||(t.event=R.dispatch("start","end","interrupt"))).on(r,e)});return this},Ua.transition=function(){for(var n,t,e,r=this.id,i=++Fa,u=this.namespace,o=[],a=0,l=this.length;a<l;a++){o.push(n=[]);for(var c,f=0,s=(c=this[a]).length;f<s;f++)(t=c[f])&&Ya(t,f,u,i,{time:(e=t[u][r]).time,ease:e.ease,delay:e.delay+e.duration,duration:e.duration}),n.push(t)}return Da(o,u,i)},R.svg.axis=function(){var N,E=R.scale.linear(),A=Za,C=6,z=6,L=3,q=[10],T=null;function e(n){n.each(function(){var n,t=R.select(this),e=this.__chart__||E,r=this.__chart__=E.copy(),i=null==T?r.ticks?r.ticks.apply(r,q):r.domain():T,u=null==N?r.tickFormat?r.tickFormat.apply(r,q):P:N,o=t.selectAll(".tick").data(i,r),a=o.enter().insert("g",".domain").attr("class","tick").style("opacity",_n),l=R.transition(o.exit()).style("opacity",_n).remove(),c=R.transition(o.order()).style("opacity",1),f=Math.max(C,0)+L,s=Ro(r),h=t.selectAll(".domain").data([0]),p=(h.enter().append("path").attr("class","domain"),R.transition(h));a.append("line"),a.append("text");var g,v,d,y,m,M,x=a.select("line"),b=c.select("line"),_=o.select("text").text(u),w=a.select("text"),S=c.select("text"),k="top"===A||"left"===A?-1:1;"bottom"===A||"top"===A?(n=Xa,g="x",d="y",v="x2",y="y2",_.attr("dy",k<0?"0em":".71em").style("text-anchor","middle"),p.attr("d","M"+s[0]+","+k*z+"V0H"+s[1]+"V"+k*z)):(n=$a,g="y",d="x",v="y2",y="x2",_.attr("dy",".32em").style("text-anchor",k<0?"end":"start"),p.attr("d","M"+k*z+","+s[0]+"H0V"+s[1]+"H"+k*z)),x.attr(y,k*C),w.attr(d,k*f),b.attr(v,0).attr(y,k*C),S.attr(g,0).attr(d,k*f),r.rangeBand?(M=(m=r).rangeBand()/2,e=r=function(n){return m(n)+M}):e.rangeBand?e=r:l.call(n,r,e),a.call(n,e,r),c.call(n,r,r)})}return e.scale=function(n){return arguments.length?(E=n,e):E},e.orient=function(n){return arguments.length?(A=n in Va?n+"":Za,e):A},e.ticks=function(){return arguments.length?(q=h(arguments),e):q},e.tickValues=function(n){return arguments.length?(T=n,e):T},e.tickFormat=function(n){return arguments.length?(N=n,e):N},e.tickSize=function(n){var t=arguments.length;return t?(C=+n,z=+arguments[t-1],e):C},e.innerTickSize=function(n){return arguments.length?(C=+n,e):C},e.outerTickSize=function(n){return arguments.length?(z=+n,e):z},e.tickPadding=function(n){return arguments.length?(L=+n,e):L},e.tickSubdivide=function(){return arguments.length&&e},e};var Za="bottom",Va={top:1,right:1,bottom:1,left:1};function Xa(n,e,r){n.attr("transform",function(n){var t=e(n);return"translate("+(isFinite(t)?t:r(n))+",0)"})}function $a(n,e,r){n.attr("transform",function(n){var t=e(n);return"translate(0,"+(isFinite(t)?t:r(n))+")"})}R.svg.brush=function(){var m,M,x=F(E,"brushstart","brush","brushend"),b=null,_=null,w=[0,0],S=[0,0],k=!0,N=!0,o=Wa[0];function E(n){n.each(function(){var n=R.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",a).on("touchstart.brush",a),t=n.selectAll(".background").data([0]);t.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),n.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var e=n.selectAll(".resize").data(o,P);e.exit().remove(),e.enter().append("g").attr("class",function(n){return"resize "+n}).style("cursor",function(n){return Ba[n]}).append("rect").attr("x",function(n){return/[ew]$/.test(n)?-3:null}).attr("y",function(n){return/^[ns]/.test(n)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),e.style("display",E.empty()?"none":null);var r,i=R.transition(n),u=R.transition(t);b&&(r=Ro(b),u.attr("x",r[0]).attr("width",r[1]-r[0]),C(i)),_&&(r=Ro(_),u.attr("y",r[0]).attr("height",r[1]-r[0]),z(i)),A(i)})}function A(n){n.selectAll(".resize").attr("transform",function(n){return"translate("+w[+/e$/.test(n)]+","+S[+/^s/.test(n)]+")"})}function C(n){n.select(".extent").attr("x",w[0]),n.selectAll(".extent,.n>rect,.s>rect").attr("width",w[1]-w[0])}function z(n){n.select(".extent").attr("y",S[0]),n.selectAll(".extent,.e>rect,.w>rect").attr("height",S[1]-S[0])}function a(){var s,n,t,e,r=this,i=R.select(R.event.target),u=x.of(r,arguments),o=R.select(r),a=i.datum(),l=!/^(n|s)$/.test(a)&&b,c=!/^(e|w)$/.test(a)&&_,h=i.classed("extent"),f=mn(r),p=R.mouse(r),g=R.select(D(r)).on("keydown.brush",function(){32==R.event.keyCode&&(h||(s=null,p[0]-=w[1],p[1]-=S[1],h=2),j())}).on("keyup.brush",function(){32==R.event.keyCode&&2==h&&(p[0]+=w[1],p[1]+=S[1],h=0,j())});function v(){var n=R.mouse(r),t=!1;e&&(n[0]+=e[0],n[1]+=e[1]),h||(R.event.altKey?(s=s||[(w[0]+w[1])/2,(S[0]+S[1])/2],p[0]=w[+(n[0]<s[0])],p[1]=S[+(n[1]<s[1])]):s=null),l&&d(n,b,0)&&(C(o),t=!0),c&&d(n,_,1)&&(z(o),t=!0),t&&(A(o),u({type:"brush",mode:h?"move":"resize"}))}function d(n,t,e){var r,i,u=Ro(t),o=u[0],a=u[1],l=p[e],c=e?S:w,f=c[1]-c[0];return h&&(o-=l,a-=f+l),r=(e?N:k)?Math.max(o,Math.min(a,n[e])):n[e],h?i=(r+=l)+f:(s&&(l=Math.max(o,Math.min(a,2*s[e]-r))),l<r?(i=r,r=l):i=l),c[0]!=r||c[1]!=i?(e?M=null:m=null,c[0]=r,c[1]=i,1):void 0}function y(){v(),o.style("pointer-events","all").selectAll(".resize").style("display",E.empty()?"none":null),R.select("body").style("cursor",null),g.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),f(),u({type:"brushend"})}R.event.changedTouches?g.on("touchmove.brush",v).on("touchend.brush",y):g.on("mousemove.brush",v).on("mouseup.brush",y),o.interrupt().selectAll("*").interrupt(),h?(p[0]=w[0]-p[0],p[1]=S[0]-p[1]):a?(n=+/w$/.test(a),t=+/^n/.test(a),e=[w[1-n]-p[0],S[1-t]-p[1]],p[0]=w[n],p[1]=S[t]):R.event.altKey&&(s=p.slice()),o.style("pointer-events","none").selectAll(".resize").style("display",null),R.select("body").style("cursor",i.style("cursor")),u({type:"brushstart"}),v()}return E.event=function(n){n.each(function(){var r=x.of(this,arguments),i={x:w,y:S,i:m,j:M},n=this.__chart__||i;this.__chart__=i,Pa?R.select(this).transition().each("start.brush",function(){m=n.i,M=n.j,w=n.x,S=n.y,r({type:"brushstart"})}).tween("brush:brush",function(){var t=xu(w,i.x),e=xu(S,i.y);return m=M=null,function(n){w=i.x=t(n),S=i.y=e(n),r({type:"brush",mode:"resize"})}}).each("end.brush",function(){m=i.i,M=i.j,r({type:"brush",mode:"resize"}),r({type:"brushend"})}):(r({type:"brushstart"}),r({type:"brush",mode:"resize"}),r({type:"brushend"}))})},E.x=function(n){return arguments.length?(o=Wa[!(b=n)<<1|!_],E):b},E.y=function(n){return arguments.length?(o=Wa[!b<<1|!(_=n)],E):_},E.clamp=function(n){return arguments.length?(b&&_?(k=!!n[0],N=!!n[1]):b?k=!!n:_&&(N=!!n),E):b&&_?[k,N]:b?k:_?N:null},E.extent=function(n){var t,e,r,i,u;return arguments.length?(b&&(t=n[0],e=n[1],_&&(t=t[0],e=e[0]),m=[t,e],b.invert&&(t=b(t),e=b(e)),e<t&&(u=t,t=e,e=u),t==w[0]&&e==w[1]||(w=[t,e])),_&&(r=n[0],i=n[1],b&&(r=r[1],i=i[1]),M=[r,i],_.invert&&(r=_(r),i=_(i)),i<r&&(u=r,r=i,i=u),r==S[0]&&i==S[1]||(S=[r,i])),E):(b&&(m?(t=m[0],e=m[1]):(t=w[0],e=w[1],b.invert&&(t=b.invert(t),e=b.invert(e)),e<t&&(u=t,t=e,e=u))),_&&(M?(r=M[0],i=M[1]):(r=S[0],i=S[1],_.invert&&(r=_.invert(r),i=_.invert(i)),i<r&&(u=r,r=i,i=u))),b&&_?[[t,r],[e,i]]:b?[t,e]:_&&[r,i])},E.clear=function(){return E.empty()||(w=[0,0],S=[0,0],m=M=null),E},E.empty=function(){return!!b&&w[0]==w[1]||!!_&&S[0]==S[1]},R.rebind(E,x,"on")};var Ba={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Wa=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Ja=qt.format=ae.timeFormat,Ga=Ja.utc,Ka=Ga("%Y-%m-%dT%H:%M:%S.%LZ");function Qa(n){return n.toISOString()}function nl(t,i,n){function o(n){return t(n)}function a(n,t){var e=(n[1]-n[0])/t,r=R.bisect(el,e);return r==el.length?[i.year,Oo(n.map(function(n){return n/31536e6}),t)[2]]:r?i[e/el[r-1]<el[r]/e?r-1:r]:[ul,Oo(n,t)[2]]}return o.invert=function(n){return tl(t.invert(n))},o.domain=function(n){return arguments.length?(t.domain(n),o):t.domain().map(tl)},o.nice=function(t,e){var n=o.domain(),r=To(n),i=null==t?a(r,10):"number"==typeof t&&a(r,t);function u(n){return!isNaN(n)&&!t.range(n,tl(+n+1),e).length}return i&&(t=i[0],e=i[1]),o.domain(Po(n,1<e?{floor:function(n){for(;u(n=t.floor(n));)n=tl(n-1);return n},ceil:function(n){for(;u(n=t.ceil(n));)n=tl(+n+1);return n}}:t))},o.ticks=function(n,t){var e=To(o.domain()),r=null==n?a(e,10):"number"==typeof n?a(e,n):!n.range&&[{range:n},t];return r&&(n=r[0],t=r[1]),n.range(e[0],tl(+e[1]+1),t<1?1:t)},o.tickFormat=function(){return n},o.copy=function(){return nl(t.copy(),i,n)},Fo(o,t)}function tl(n){return new Date(n)}Ja.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Qa:Ka,Qa.parse=function(n){var t=new Date(n);return isNaN(t)?null:t},Qa.toString=Ka.toString,qt.second=Pt(function(n){return new Tt(1e3*Math.floor(n/1e3))},function(n,t){n.setTime(n.getTime()+1e3*Math.floor(t))},function(n){return n.getSeconds()}),qt.seconds=qt.second.range,qt.seconds.utc=qt.second.utc.range,qt.minute=Pt(function(n){return new Tt(6e4*Math.floor(n/6e4))},function(n,t){n.setTime(n.getTime()+6e4*Math.floor(t))},function(n){return n.getMinutes()}),qt.minutes=qt.minute.range,qt.minutes.utc=qt.minute.utc.range,qt.hour=Pt(function(n){var t=n.getTimezoneOffset()/60;return new Tt(36e5*(Math.floor(n/36e5-t)+t))},function(n,t){n.setTime(n.getTime()+36e5*Math.floor(t))},function(n){return n.getHours()}),qt.hours=qt.hour.range,qt.hours.utc=qt.hour.utc.range,qt.month=Pt(function(n){return(n=qt.day(n)).setDate(1),n},function(n,t){n.setMonth(n.getMonth()+t)},function(n){return n.getMonth()}),qt.months=qt.month.range,qt.months.utc=qt.month.utc.range;var el=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],rl=[[qt.second,1],[qt.second,5],[qt.second,15],[qt.second,30],[qt.minute,1],[qt.minute,5],[qt.minute,15],[qt.minute,30],[qt.hour,1],[qt.hour,3],[qt.hour,6],[qt.hour,12],[qt.day,1],[qt.day,2],[qt.week,1],[qt.month,1],[qt.month,3],[qt.year,1]],il=Ja.multi([[".%L",function(n){return n.getMilliseconds()}],[":%S",function(n){return n.getSeconds()}],["%I:%M",function(n){return n.getMinutes()}],["%I %p",function(n){return n.getHours()}],["%a %d",function(n){return n.getDay()&&1!=n.getDate()}],["%b %d",function(n){return 1!=n.getDate()}],["%B",function(n){return n.getMonth()}],["%Y",gr]]),ul={range:function(n,t,e){return R.range(Math.ceil(n/e)*e,+t,e).map(tl)},floor:P,ceil:P};rl.year=qt.year,qt.scale=function(){return nl(R.scale.linear(),rl,il)};var ol=rl.map(function(n){return[n[0].utc,n[1]]}),al=Ga.multi([[".%L",function(n){return n.getUTCMilliseconds()}],[":%S",function(n){return n.getUTCSeconds()}],["%I:%M",function(n){return n.getUTCMinutes()}],["%I %p",function(n){return n.getUTCHours()}],["%a %d",function(n){return n.getUTCDay()&&1!=n.getUTCDate()}],["%b %d",function(n){return 1!=n.getUTCDate()}],["%B",function(n){return n.getUTCMonth()}],["%Y",gr]]);function ll(n){return JSON.parse(n.responseText)}function cl(n){var t=M.createRange();return t.selectNode(M.body),t.createContextualFragment(n.responseText)}ol.year=qt.year.utc,qt.scale.utc=function(){return nl(R.scale.linear(),ol,al)},R.text=dt(function(n){return n.responseText}),R.json=function(n,t){return yt(n,"application/json",ll,t)},R.html=function(n,t){return yt(n,"text/html",cl,t)},R.xml=dt(function(n){return n.responseXML}),"function"==typeof define&&define.amd?(this.d3=R,define(R)):"object"==typeof module&&module.exports?module.exports=R:this.d3=R}();
!function(t,e){"function"==typeof define&&define.amd?define(["d3"],e):"object"==typeof module&&module.exports?module.exports=function(t){return t.tip=e(t),t.tip}:t.d3.tip=e(t.d3)}(this,function(x){return function(){var s=function(){return"n"},a=function(){return[0,0]},c=function(){return" "},n=t(),r=null,u=null,p=null;function y(t){var e;r="svg"===(e=(e=t).node()).tagName.toLowerCase()?e:e.ownerSVGElement,u=r.createSVGPoint(),document.body.appendChild(n)}y.show=function(){var t=Array.prototype.slice.call(arguments);t[t.length-1]instanceof SVGElement&&(p=t.pop());var e,n=c.apply(this,t),r=a.apply(this,t),o=s.apply(this,t),i=h(),f=m.length,l=document.documentElement.scrollTop||document.body.scrollTop,u=document.documentElement.scrollLeft||document.body.scrollLeft;for(i.html(n).style({opacity:1,"pointer-events":"all"});f--;)i.classed(m[f],!1);return e=d.get(o).apply(this),i.classed(o,!0).style({top:e.top+r[0]+l+"px",left:e.left+r[1]+u+"px"}),y},y.hide=function(){return h().style({opacity:0,"pointer-events":"none"}),y},y.attr=function(t,e){if(arguments.length<2&&"string"==typeof t)return h().attr(t);var n=Array.prototype.slice.call(arguments);return x.selection.prototype.attr.apply(h(),n),y},y.style=function(t,e){if(arguments.length<2&&"string"==typeof t)return h().style(t);var n=Array.prototype.slice.call(arguments);return x.selection.prototype.style.apply(h(),n),y},y.direction=function(t){return arguments.length?(s=null==t?t:x.functor(t),y):s},y.offset=function(t){return arguments.length?(a=null==t?t:x.functor(t),y):a},y.html=function(t){return arguments.length?(c=null==t?t:x.functor(t),y):c},y.destroy=function(){return n&&(h().remove(),n=null),y};var d=x.map({n:function(){var t=e();return{top:t.n.y-n.offsetHeight,left:t.n.x-n.offsetWidth/2}},s:function(){var t=e();return{top:t.s.y,left:t.s.x-n.offsetWidth/2}},e:function(){var t=e();return{top:t.e.y-n.offsetHeight/2,left:t.e.x}},w:function(){var t=e();return{top:t.w.y-n.offsetHeight/2,left:t.w.x-n.offsetWidth}},nw:function(){var t=e();return{top:t.nw.y-n.offsetHeight,left:t.nw.x-n.offsetWidth}},ne:function(){var t=e();return{top:t.ne.y-n.offsetHeight,left:t.ne.x}},sw:function(){var t=e();return{top:t.sw.y,left:t.sw.x-n.offsetWidth}},se:function(){var t=e();return{top:t.se.y,left:t.e.x}}}),m=d.keys();function t(){var t=x.select(document.createElement("div"));return t.style({position:"absolute",top:0,opacity:0,"pointer-events":"none","box-sizing":"border-box"}),t.node()}function h(){return null===n&&(n=t(),document.body.appendChild(n)),x.select(n)}function e(){for(var t=p||x.event.target;void 0===t.getScreenCTM&&"undefined"===t.parentNode;)t=t.parentNode;var e={},n=t.getScreenCTM(),r=t.getBBox(),o=r.width,i=r.height,f=r.x,l=r.y;return u.x=f,u.y=l,e.nw=u.matrixTransform(n),u.x+=o,e.ne=u.matrixTransform(n),u.y+=i,e.se=u.matrixTransform(n),u.x-=o,e.sw=u.matrixTransform(n),u.y-=i/2,e.w=u.matrixTransform(n),u.x+=o,e.e=u.matrixTransform(n),u.x-=o/2,u.y-=i/2,e.n=u.matrixTransform(n),u.y+=i,e.s=u.matrixTransform(n),e}return y}});
!function(){d3.geo={};var d=Math.PI/180;function n(t,r){return function(n){return n&&n.type in t?t[n.type](n):r}}function h(n){return"m0,"+n+"a"+n+","+n+" 0 1,1 0,"+-2*n+"a"+n+","+n+" 0 1,1 0,"+2*n+"z"}function i(n,t){n.type in r&&r[n.type](n,t)}d3.geo.azimuthal=function(){var t,f,r,h,g,p="orthographic",M=200,v=[480,250];function e(n){var t,r=n[0]*d-f,e=n[1]*d,o=Math.cos(r),a=Math.sin(r),i=Math.cos(e),u=Math.sin(e),c="orthographic"!==p?g*u+h*i*o:null,l="stereographic"===p?1/(1+c):"gnomonic"===p?1/c:"equidistant"===p?(t=Math.acos(c))?t/Math.sin(t):0:"equalarea"===p?Math.sqrt(2/(1+c)):1,s=l*(g*i*o-h*u);return[M*(l*i*a)+v[0],M*s+v[1]]}return e.invert=function(n){var t=(n[0]-v[0])/M,r=(n[1]-v[1])/M,e=Math.sqrt(t*t+r*r),o="stereographic"===p?2*Math.atan(e):"gnomonic"===p?Math.atan(e):"equidistant"===p?e:"equalarea"===p?2*Math.asin(.5*e):Math.asin(e),a=Math.sin(o),i=Math.cos(o);return[(f+Math.atan2(t*a,e*h*i+r*g*a))/d,Math.asin(i*g-(e?r*a*h/e:0))/d]},e.mode=function(n){return arguments.length?(p=n+"",e):p},e.origin=function(n){return arguments.length?(f=(t=n)[0]*d,r=t[1]*d,h=Math.cos(r),g=Math.sin(r),e):t},e.scale=function(n){return arguments.length?(M=+n,e):M},e.translate=function(n){return arguments.length?(v=[+n[0],+n[1]],e):v},e.origin([0,0])},d3.geo.albers=function(){var i,u,c,l,a=[-98,38],s=[29.5,45.5],f=1e3,h=[480,250];function g(n){var t=u*(d*n[0]-i),r=Math.sqrt(c-2*u*Math.sin(d*n[1]))/u;return[f*r*Math.sin(t)+h[0],f*(r*Math.cos(t)-l)+h[1]]}function t(){var n=d*s[0],t=d*s[1],r=d*a[1],e=Math.sin(n),o=Math.cos(n);return i=d*a[0],u=.5*(e+Math.sin(t)),c=o*o+2*u*e,l=Math.sqrt(c-2*u*Math.sin(r))/u,g}return g.invert=function(n){var t=(n[0]-h[0])/f,r=(n[1]-h[1])/f,e=l+r,o=Math.atan2(t,e),a=Math.sqrt(t*t+e*e);return[(i+o/u)/d,Math.asin((c-a*a*u*u)/(2*u))/d]},g.origin=function(n){return arguments.length?(a=[+n[0],+n[1]],t()):a},g.parallels=function(n){return arguments.length?(s=[+n[0],+n[1]],t()):s},g.scale=function(n){return arguments.length?(f=+n,g):f},g.translate=function(n){return arguments.length?(h=[+n[0],+n[1]],g):h},t()},d3.geo.albersUsa=function(){var o=d3.geo.albers(),a=d3.geo.albers().origin([-160,60]).parallels([55,65]),i=d3.geo.albers().origin([-160,20]).parallels([8,18]),u=d3.geo.albers().origin([-60,10]).parallels([8,18]);function c(n){var t=n[0],r=n[1];return(50<r?a:t<-140?i:r<21?u:o)(n)}return c.scale=function(n){return arguments.length?(o.scale(n),a.scale(.6*n),i.scale(n),u.scale(1.5*n),c.translate(o.translate())):o.scale()},c.translate=function(n){if(!arguments.length)return o.translate();var t=o.scale()/1e3,r=n[0],e=n[1];return o.translate(n),a.translate([r-400*t,e+170*t]),i.translate([r-190*t,e+200*t]),u.translate([r+580*t,e+430*t]),c},c.scale(o.scale())},d3.geo.bonne=function(){var a,i,u,c,l=200,s=[480,250];function t(n){var t,r,e=n[0]*d-a,o=n[1]*d-i;return u?(t=c+u-o,r=e*Math.cos(o)/t,e=t*Math.sin(r),o=t*Math.cos(r)-c):(e*=Math.cos(o),o*=-1),[l*e+s[0],l*o+s[1]]}return t.invert=function(n){var t,r,e=(n[0]-s[0])/l,o=(n[1]-s[1])/l;return u?(t=c+o,r=Math.sqrt(e*e+t*t),o=c+u-r,e=a+r*Math.atan2(e,t)/Math.cos(o)):(o*=-1,e/=Math.cos(o)),[e/d,o/d]},t.parallel=function(n){return arguments.length?(c=1/Math.tan(u=n*d),t):u/d},t.origin=function(n){return arguments.length?(a=n[0]*d,i=n[1]*d,t):[a/d,i/d]},t.scale=function(n){return arguments.length?(l=+n,t):l},t.translate=function(n){return arguments.length?(s=[+n[0],+n[1]],t):s},t.origin([0,0]).parallel(45)},d3.geo.equirectangular=function(){var e=500,o=[480,250];function t(n){var t=n[0]/360,r=-n[1]/360;return[e*t+o[0],e*r+o[1]]}return t.invert=function(n){return[360*((n[0]-o[0])/e),-360*((n[1]-o[1])/e)]},t.scale=function(n){return arguments.length?(e=+n,t):e},t.translate=function(n){return arguments.length?(o=[+n[0],+n[1]],t):o},t},d3.geo.mercator=function(){var e=500,o=[480,250];function t(n){var t=n[0]/360,r=-Math.log(Math.tan(Math.PI/4+n[1]*d/2))/d/360;return[e*t+o[0],e*Math.max(-.5,Math.min(.5,r))+o[1]]}return t.invert=function(n){var t=(n[0]-o[0])/e,r=(n[1]-o[1])/e;return[360*t,2*Math.atan(Math.exp(-360*r*d))/d-90]},t.scale=function(n){return arguments.length?(e=+n,t):e},t.translate=function(n){return arguments.length?(o=[+n[0],+n[1]],t):o},t},d3.geo.path=function(){var r=4.5,a=h(r),l=d3.geo.albersUsa();function t(n,t){return"function"==typeof r&&(a=h(r.apply(this,arguments))),i(n)||null}function f(n){return l(n).join(",")}var i=n({FeatureCollection:function(n){for(var t=[],r=n.features,e=-1,o=r.length;++e<o;)t.push(i(r[e].geometry));return t.join("")},Feature:function(n){return i(n.geometry)},Point:function(n){return"M"+f(n.coordinates)+a},MultiPoint:function(n){for(var t=[],r=n.coordinates,e=-1,o=r.length;++e<o;)t.push("M",f(r[e]),a);return t.join("")},LineString:function(n){for(var t=["M"],r=n.coordinates,e=-1,o=r.length;++e<o;)t.push(f(r[e]),"L");return t.pop(),t.join("")},MultiLineString:function(n){for(var t,r,e,o=[],a=n.coordinates,i=-1,u=a.length;++i<u;){for(r=-1,e=(t=a[i]).length,o.push("M");++r<e;)o.push(f(t[r]),"L");o.pop()}return o.join("")},Polygon:function(n){for(var t,r,e,o=[],a=n.coordinates,i=-1,u=a.length;++i<u;)if(r=-1,0<(e=(t=a[i]).length-1)){for(o.push("M");++r<e;)o.push(f(t[r]),"L");o[o.length-1]="Z"}return o.join("")},MultiPolygon:function(n){for(var t,r,e,o,a,i,u=[],c=n.coordinates,l=-1,s=c.length;++l<s;)for(r=-1,e=(t=c[l]).length;++r<e;)if(a=-1,0<(i=(o=t[r]).length-1)){for(u.push("M");++a<i;)u.push(f(o[a]),"L");u[u.length-1]="Z"}return u.join("")},GeometryCollection:function(n){for(var t=[],r=n.geometries,e=-1,o=r.length;++e<o;)t.push(i(r[e]));return t.join("")}}),u=t.area=n({FeatureCollection:function(n){for(var t=0,r=n.features,e=-1,o=r.length;++e<o;)t+=u(r[e]);return t},Feature:function(n){return u(n.geometry)},Polygon:function(n){return c(n.coordinates)},MultiPolygon:function(n){for(var t=0,r=n.coordinates,e=-1,o=r.length;++e<o;)t+=c(r[e]);return t},GeometryCollection:function(n){for(var t=0,r=n.geometries,e=-1,o=r.length;++e<o;)t+=u(r[e]);return t}},0);function c(n){for(var t=o(n[0]),r=0,e=n.length;++r<e;)t-=o(n[r]);return t}function s(n){for(var t=d3.geom.polygon(n[0].map(l)),r=t.area(),e=t.centroid(r<0?(r*=-1,1):-1),o=e[0],a=e[1],i=r,u=0,c=n.length;++u<c;)r=(t=d3.geom.polygon(n[u].map(l))).area(),o-=(e=t.centroid(r<0?(r*=-1,1):-1))[0],a-=e[1],i-=r;return[o,a,6*i]}var e=t.centroid=n({Feature:function(n){return e(n.geometry)},Polygon:function(n){var t=s(n.coordinates);return[t[0]/t[2],t[1]/t[2]]},MultiPolygon:function(n){for(var t,r=n.coordinates,e=0,o=0,a=0,i=-1,u=r.length;++i<u;)e+=(t=s(r[i]))[0],o+=t[1],a+=t[2];return[e/a,o/a]}});function o(n){return Math.abs(d3.geom.polygon(n.map(l)).area())}return t.projection=function(n){return l=n,t},t.pointRadius=function(n){return"function"==typeof n?r=n:a=h(r=+n),t},t},d3.geo.bounds=function(n){var r=1/0,e=1/0,o=-1/0,a=-1/0;return i(n,function(n,t){n<r&&(r=n),o<n&&(o=n),t<e&&(e=t),a<t&&(a=t)}),[[r,e],[o,a]]};var r={Feature:function(n,t){i(n.geometry,t)},FeatureCollection:function(n,t){for(var r=n.features,e=0,o=r.length;e<o;e++)i(r[e].geometry,t)},GeometryCollection:function(n,t){for(var r=n.geometries,e=0,o=r.length;e<o;e++)i(r[e],t)},LineString:t,MultiLineString:function(n,t){for(var r=n.coordinates,e=0,o=r.length;e<o;e++)for(var a=r[e],i=0,u=a.length;i<u;i++)t.apply(null,a[i])},MultiPoint:t,MultiPolygon:function(n,t){for(var r=n.coordinates,e=0,o=r.length;e<o;e++)for(var a=r[e][0],i=0,u=a.length;i<u;i++)t.apply(null,a[i])},Point:function(n,t){t.apply(null,n.coordinates)},Polygon:function(n,t){for(var r=n.coordinates[0],e=0,o=r.length;e<o;e++)t.apply(null,r[e])}};function t(n,t){for(var r=n.coordinates,e=0,o=r.length;e<o;e++)t.apply(null,r[e])}function e(n){return n.source}function o(n){return n.target}function f(n,t){var r=n[0]*d,i=Math.cos(r),u=Math.sin(r),e=n[1]*d,c=Math.cos(e),l=Math.sin(e),o=t[0]*d,s=Math.cos(o),f=Math.sin(o),a=t[1]*d,h=Math.cos(a),g=Math.sin(a),p=v.d=Math.acos(Math.max(-1,Math.min(1,l*g+c*h*Math.cos(o-r)))),M=Math.sin(p);function v(n){var t=Math.sin(p-(n*=p))/M,r=Math.sin(n)/M,e=t*c*i+r*h*s,o=t*c*u+r*h*f,a=t*l+r*g;return[Math.atan2(o,e)/d,Math.atan2(a,Math.sqrt(e*e+o*o))/d]}return v}d3.geo.circle=function(){var t=[0,0],r=89.99,l=r*d,s=d3.geo.greatArc().target(Object);function e(){}function o(n){return s.distance(n)<l}e.clip=function(n){return s.source("function"==typeof t?t.apply(this,arguments):t),a(n)};var a=n({FeatureCollection:function(n){var t=n.features.map(a).filter(Object);return t&&((n=Object.create(n)).features=t,n)},Feature:function(n){var t=a(n.geometry);return t&&((n=Object.create(n)).geometry=t,n)},Point:function(n){return o(n.coordinates)&&n},MultiPoint:function(n){var t=n.coordinates.filter(o);return t.length&&{type:n.type,coordinates:t}},LineString:function(n){var t=i(n.coordinates);return t.length&&((n=Object.create(n)).coordinates=t,n)},MultiLineString:function(n){var t=n.coordinates.map(i).filter(function(n){return n.length});return t.length&&((n=Object.create(n)).coordinates=t,n)},Polygon:function(n){var t=n.coordinates.map(i);return t[0].length&&((n=Object.create(n)).coordinates=t,n)},MultiPolygon:function(n){var t=n.coordinates.map(function(n){return n.map(i)}).filter(function(n){return n[0].length});return t.length&&((n=Object.create(n)).coordinates=t,n)},GeometryCollection:function(n){var t=n.geometries.map(a).filter(Object);return t.length&&((n=Object.create(n)).geometries=t,n)}});function i(n){for(var t,r,e,o,a,i=-1,u=n.length,c=[];++i<u;)(a=s.distance(e=n[i]))<l?(r&&c.push(f(r,e)((o-l)/(o-a))),c.push(e),t=r=null):(r=e,!t&&c.length&&(c.push(f(c[c.length-1],r)((l-o)/(a-o))),t=r)),o=a;return r&&c.length&&(a=s.distance(e=c[0]),c.push(f(r,e)((o-l)/(o-a)))),function(n){var t,r,e,o=0,a=n.length,i=a?[n[0]]:n,u=s.source();for(;++o<a;)for(e=s.source(n[o-1])(n[o]).coordinates,t=0,r=e.length;++t<r;)i.push(e[t]);return s.source(u),i}(c)}return e.origin=function(n){return arguments.length?(t=n,e):t},e.angle=function(n){return arguments.length?(l=(r=+n)*d,e):r},e.precision=function(n){return arguments.length?(s.precision(n),e):s.precision()},e},d3.geo.greatArc=function(){var i=e,u=o,c=6*d;function t(){for(var n="function"==typeof i?i.apply(this,arguments):i,t="function"==typeof u?u.apply(this,arguments):u,r=f(n,t),e=c/r.d,o=0,a=[n];(o+=e)<1;)a.push(r(o));return a.push(t),{type:"LineString",coordinates:a}}return t.distance=function(){return f("function"==typeof i?i.apply(this,arguments):i,"function"==typeof u?u.apply(this,arguments):u).d},t.source=function(n){return arguments.length?(i=n,t):i},t.target=function(n){return arguments.length?(u=n,t):u},t.precision=function(n){return arguments.length?(c=n*d,t):c/d},t},d3.geo.greatCircle=d3.geo.circle}();
var gJ=function(a){var e=this,t=IG$.j$ext._w(a),n=IG$.j$ext._h(a);e.c=a,e.d3_geo_radians=Math.PI/180,e.lng0=null,e.n=null,e.origin=[-98,38],e.C=null,e.p0=null,e.scale=1e3,e.translate=[t/2,n/2],e.parallels=[29.5,45.5],this.init_f()};gJ.prototype={init_f:function(){var a=this,e=(a.d3_geo_radians,a.c),t=IG$.j$ext._w(e),n=IG$.j$ext._h(e);a.paper=new Raphael(e[0],t,n);a.attr={fill:"white",stroke:"#666","stroke-width":.5,"stroke-linejoin":"round"},a.legend=$("<ul class='map-legend'></ul>").appendTo(e)},getAlbers:function(a){var e=this.d3_geo_radians,t=e*a.parallels[0],n=e*a.parallels[1],l=e*a.origin[1],r=Math.sin(t),s=Math.cos(t),i={};return i.lng0=e*a.origin[0],i.n=.5*(r+Math.sin(n)),i.C=s*s+2*i.n*r,i.p0=Math.sqrt(i.C-2*i.n*Math.sin(l))/i.n,i.parallels=a.parallels,i.scale=a.scale||1,i.translate=a.translate,i},drawMap:function(a,e){var t,n,l,r,s=this,i=s.attr,o=s.paper,p=s.d3_geo_radians,c=s.c,h=IG$.j$ext._w(c),d=IG$.j$ext._h(c);switch(s.mode=e&&e.mode||"albers",e&&(s.azmode=e.azmode||null,s.scale=e.scale?e.scale:s.scale,s.mapdp=e.mapdp,s.mapseries=e.mapseries),m=Math.min(h/480,d/250),s.scale=m*s.scale,s.mode){case"albers":n=s.getAlbers({origin:s.origin,parallels:s.parallels,scale:1}),s.lng0=n.lng0,s.n=n.n,s.C=n.C,s.p0=n.p0;break;case"azimuthal":s.x0=s.origin[0]*p,s.y0=s.origin[1]*p,s.cy0=Math.cos(s.y0),s.sy0=Math.sin(s.y0);break;case"bonne":s.x0=s.origin[0]*p,s.y0=s.origin[1]*p,s.c1=1/Math.tan(s.y1=45*p)}if(e.maptype!=s.maptype)if(s.paper.clear(),s.data={},s.label="",s.frame=o.popup(100,100,"","right").attr({fill:"#000",stroke:"#666","stroke-width":2,"fill-opacity":.7}).hide(),a.pathes){var g,u,f,m,y=parseFloat(a.width),M=parseFloat(a.height),o=s.paper,v=h-y*(m=Math.min(h/y,d/M)),w=d-M*m;for(g in a.pathes)u=a.pathes[g],l=o.set(),(f=o.path(u.path).attr(i)).color=Raphael.getColor(),l.push(f),l[0].scale(m,m,m,m),l[0].translate(v,w),r={id:g,name:u.name||g,data:[],set:l},s.addEvent(l,r),s.data[g]=r}else for(t=0;t<a.features.length;t++)s.drawFeature(a.features[t]);else for(g in s.data)s.data[g].set.attr(i);s.maptype=e.maptype,s.prepareLegend(),s.y1=0,s.applyColor(0)},mouseUp:function(a){var e=this;e.clickHandler&&e.clickHandler.f.call(e.clickHandler.o,a)},prepareLegend:function(){var t=this,n=t.legend,a=t.mapseries;n.empty(),t.legidx=0,a&&0<a.length&&$.each(a,function(a,e){$("<li class='map-legend-item'>"+e.name+"</li>").appendTo(n).bind("click",function(){t.legidx=a,t.applyColor.call(t,a)})})},applyColor:function(a){var e,t,n,l,r,s,i,o,p,c,h=this,d=h.data,g=h.mapdp,u=(h.paper,h.mapseries),f=(h.label,h.legend);if(g&&u&&u.length>a){if((c=f.children("li"))&&0<c.length)for(o=0;o<c.length;o++)$(c[o]).removeClass("map-legend-selected"),o==a&&$(c[o]).addClass("map-legend-selected");for(o=0;o<u.length;o++);for(e in n=(s=u[a]).maxvalue,l=s.minvalue,d){if(r="#ffffff",i=[],p=g[e]||(d[e].name?g[d[e].name.toLowerCase()]:null))for(t=n-l==0?1:(p[a]-l)/(n-l),r=IG$.interpolateColor("#ffffff","#153a6f",100,100*t),o=0;o<u.length;o++)i.push(u[o].name+": "+p[o]);d[e].set.attr({fill:r}),d[e].data=i}}},albers:function(a,e){var n,l,r=this,s=r.d3_geo_radians,i=e&&e.scale?r.scale*e.scale:r.scale,o=e?e.n:r.n,c=e?e.lng0:r.lng0,h=e?e.C:r.C,d=e?e.p0:r.p0;return t=o*(s*a[0]-c),p=Math.sqrt(h-2*o*Math.sin(s*a[1]))/o,translate=[r.translate[0],r.translate[1]],e&&e.translate&&2==e.translate.length&&(n=translate[0],l=translate[1],translate=[n+e.translate[0]*translate[0]*1,l+e.translate[1]*translate[1]*1]),[i*p*Math.sin(t)+translate[0],i*(p*Math.cos(t)-d)+translate[1]]},azimuthal:function(a){var e,t=this,n=t.d3_geo_radians,l=t.x0,r=t.sy0,s=t.cy0,i=t.scale,o=a[0]*n-l,p=a[1]*n,c=Math.cos(o),h=Math.sin(o),d=Math.cos(p),g=Math.sin(p),u=t.azmode,f="orthographic"!==u?r*g+s*d*c:null,m="stereographic"===u?1/(1+f):"gnomonic"===u?1/f:"equidistant"===u?(e=Math.acos(f))?e/Math.sin(e):0:"equalarea"===u?Math.sqrt(2/(1+f)):1,y=m*(r*d*c-s*g);return[i*(m*d*h)+t.translate[0],i*y+t.translate[1]]},bonne:function(a){var e,t,n=this,l=n.d3_geo_radians,r=n.x0,s=n.y0,i=n.y1,o=n.c1,p=n.scale,c=a[0]*l-r,h=a[1]*l-s;return i?(e=o+i-h,t=c*Math.cos(h)/e,c=e*Math.sin(t),h=e*Math.cos(t)-o):(c*=Math.cos(h),h*=-1),[p*c+n.translate[0],p*h+n.translate[1]]},drawPolygon:function(a,e){var t,n,l,r,s=this,i=s.paper,o=s.attr,p=[];if(1==(2==a[0].length&&"number"==typeof a[0][0])){for(p=[],t=0;t<a.length;t++)n=a[t],l=(n=s[s.mode](n,e))[0],r=n[1],p.push((0==t?"M":"L")+l+" "+r);p.push("Z"),i.path(p.join("")).attr(o).color=Raphael.getColor()}else for(t=0;t<a.length;t++)s.drawPolygon(a[t],e)},drawGeom:function(a,e){var t,n,l,r=this,s=r.paper;switch((a.parallels||a.origin)&&(l=r.getAlbers({origin:a.origin,parallels:a.parallels,translate:a.translate,scale:a.scale})),a.type){case"Polygon":case"MultiPolygon":t=a.coordinates,s.setStart(),r.drawPolygon(t,l),n=s.setFinish()}return n&&r.addEvent(n,e),n},addEvent:function(a,e){var t,s,i,o=this;s=e,i=o,(t=a).mouseover(function(){t.animate({stroke:"#FF0000","stroke-width":2},500),t.toFront(),i.current=t},i),t.mouseup(function(){i.mouseUp.call(i,s)},i),t.mouseout(function(){t.animate({stroke:"#666","stroke-width":.5},500),t.toFront()},i),t.hover(function(a){var e,t=o.c.offset(),n=a.pageX-t.left,l=a.pageY-t.top-10,r=o.label;o.frame,o.paper;for(clearTimeout(o.leave_timer),r=s.name+"\n",e=0;e<s.data.length;e++)r+=s.data[e]+"\n";o.ppp&&o.ppp.remove(),o.ppp=i.paper.popup(n,l,r,"up")})},drawFeature:function(a){var e,t;switch(a.type){case"Feature":t={id:(a.usps||a.id).toLowerCase(),value:a.usps||a.id,name:a.properties.name||a.usps||a.id,data:[]},e=this.drawGeom(a.geometry,t),t.set=e,this.data[t.id]=t}}};
!function(S,z,N){var t;t=function(L){"use strict";function t(){return{common:{type:"line",lineColor:"#00f",fillColor:"#cdf",defaultPixelsPerValue:3,width:"auto",height:"auto",composite:!1,tagValuesAttribute:"values",tagOptionsPrefix:"spark",enableTagOptions:!1,enableHighlight:!0,highlightLighten:1.4,tooltipSkipNull:!0,tooltipPrefix:"",tooltipSuffix:"",disableHiddenCheck:!1,numberFormatter:!1,numberDigitGroupCount:3,numberDigitGroupSep:",",numberDecimalMark:".",disableTooltips:!1,disableInteraction:!1},line:{spotColor:"#f80",highlightSpotColor:"#5f5",highlightLineColor:"#f22",spotRadius:1.5,minSpotColor:"#f80",maxSpotColor:"#f80",lineWidth:1,normalRangeMin:N,normalRangeMax:N,normalRangeColor:"#ccc",drawNormalOnTop:!1,chartRangeMin:N,chartRangeMax:N,chartRangeMinX:N,chartRangeMaxX:N,tooltipFormat:new m('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{y}}{{suffix}}')},bar:{barColor:"#3366cc",negBarColor:"#f44",stackedBarColor:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],zeroColor:N,nullColor:N,zeroAxis:!0,barWidth:4,barSpacing:1,chartRangeMax:N,chartRangeMin:N,chartRangeClip:!1,colorMap:N,tooltipFormat:new m('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{value}}{{suffix}}')},tristate:{barWidth:4,barSpacing:1,posBarColor:"#6f6",negBarColor:"#f44",zeroBarColor:"#999",colorMap:{},tooltipFormat:new m('<span style="color: {{color}}">&#9679;</span> {{value:map}}'),tooltipValueLookups:{map:{"-1":"Loss",0:"Draw",1:"Win"}}},discrete:{lineHeight:"auto",thresholdColor:N,thresholdValue:0,chartRangeMax:N,chartRangeMin:N,chartRangeClip:!1,tooltipFormat:new m("{{prefix}}{{value}}{{suffix}}")},bullet:{targetColor:"#f33",targetWidth:3,performanceColor:"#33f",rangeColors:["#d3dafe","#a8b6ff","#7f94ff"],base:N,tooltipFormat:new m("{{fieldkey:fields}} - {{value}}"),tooltipValueLookups:{fields:{r:"Range",p:"Performance",t:"Target"}}},pie:{offset:0,sliceColors:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],borderWidth:0,borderColor:"#000",tooltipFormat:new m('<span style="color: {{color}}">&#9679;</span> {{value}} ({{percent.1}}%)')},box:{raw:!1,boxLineColor:"#000",boxFillColor:"#cdf",whiskerColor:"#000",outlierLineColor:"#333",outlierFillColor:"#fff",medianColor:"#f00",showOutliers:!0,outlierIQR:1.5,spotRadius:1.5,target:N,targetColor:"#4a2",chartRangeMax:N,chartRangeMin:N,tooltipFormat:new m("{{field:fields}}: {{value}}"),tooltipFormatFieldlistKey:"field",tooltipValueLookups:{fields:{lq:"Lower Quartile",med:"Median",uq:"Upper Quartile",lo:"Left Outlier",ro:"Right Outlier",lw:"Left Whisker",rw:"Right Whisker"}}}}}function e(){function t(){this.init.apply(this,arguments)}var e;return 1<arguments.length?(arguments[0]?(t.prototype=L.extend(new arguments[0],arguments[arguments.length-1]),t._super=arguments[0].prototype):t.prototype=arguments[arguments.length-1],2<arguments.length&&((e=Array.prototype.slice.call(arguments,1,-1)).unshift(t.prototype),L.extend.apply(L,e))):t.prototype=arguments[0],t.prototype.cls=t}var m,A,C,F,B,O,g,b,i,n,p,V,u,s,r,q,X,h,a,o,l,w,c,d,f,v,x,y={},R=0;L.SPFormatClass=m=e({fre:/\{\{([\w.]+?)(:(.+?))?\}\}/g,precre:/(\w+)\.(\d+)/,init:function(t,e){this.format=t,this.fclass=e},render:function(t,e,i){var s,r,n,a,h,o=this,l=t;return this.format.replace(this.fre,function(){return r=arguments[1],n=arguments[3],(s=o.precre.exec(r))?(h=s[2],r=s[1]):h=!1,(a=l[r])===N?"":n&&e&&e[n]?e[n].get?e[n].get(a)||a:e[n][a]||a:(g(a)&&(a=i.get("numberFormatter")?i.get("numberFormatter")(a):p(a,h,i.get("numberDigitGroupCount"),i.get("numberDigitGroupSep"),i.get("numberDecimalMark"))),a)})}}),L.spformat=function(t,e){return new m(t,e)},A=function(t,e,i){return t<e?e:i<t?i:t},C=function(t,e){var i;return 2===e?(i=z.floor(t.length/2),t.length%2?t[i]:(t[i-1]+t[i])/2):t.length%2?(i=(t.length*e+e)/4)%1?(t[z.floor(i)]+t[z.floor(i)-1])/2:t[i-1]:(i=(t.length*e+2)/4)%1?(t[z.floor(i)]+t[z.floor(i)-1])/2:t[i-1]},F=function(t){var e;switch(t){case"undefined":t=N;break;case"null":t=null;break;case"true":t=!0;break;case"false":t=!1;break;default:t==(e=parseFloat(t))&&(t=e)}return t},B=function(t){for(var e=[],i=t.length;i--;)e[i]=F(t[i]);return e},O=function(t,e){for(var i=[],s=0,r=t.length;s<r;s++)t[s]!==e&&i.push(t[s]);return i},g=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},p=function(t,e,i,s,r){var n,a;for(t=(!1===e?parseFloat(t).toString():t.toFixed(e)).split(""),(n=(n=L.inArray(".",t))<0?t.length:n)<t.length&&(t[n]=r),a=n-i;0<a;a-=i)t.splice(a,0,s);return t.join("")},b=function(t,e,i){for(var s=e.length;s--;)if((!i||null!==e[s])&&e[s]!==t)return!1;return!0},n=function(t){return L.isArray(t)?t:[t]},i=function(t){var e;S.createStyleSheet?S.createStyleSheet().cssText=t:((e=S.createElement("style")).type="text/css",S.getElementsByTagName("head")[0].appendChild(e),e["string"==typeof S.body.style.WebkitAppearance?"innerText":"innerHTML"]=t)},L.fn.simpledraw=function(t,e,i,s){var r,n;if(i&&(r=this.data("_jqs_vcanvas")))return r;if(!1===L.fn.sparkline.canvas)return!1;if(L.fn.sparkline.canvas===N){var a=S.createElement("canvas");if(a.getContext&&a.getContext("2d"))L.fn.sparkline.canvas=function(t,e,i,s){return new f(t,e,i,s)};else{if(!S.namespaces||S.namespaces.v)return L.fn.sparkline.canvas=!1;S.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML"),L.fn.sparkline.canvas=function(t,e,i,s){return new v(t,e,i)}}}return t===N&&(t=L(this).innerWidth()),e===N&&(e=L(this).innerHeight()),r=L.fn.sparkline.canvas(t,e,this,s),(n=L(this).data("_jqs_mhandler"))&&n.registerCanvas(r),r},L.fn.cleardraw=function(){var t=this.data("_jqs_vcanvas");t&&t.reset()},L.RangeMapClass=V=e({init:function(t){var e,i,s=[];for(e in t)t.hasOwnProperty(e)&&"string"==typeof e&&-1<e.indexOf(":")&&((i=e.split(":"))[0]=0===i[0].length?-1/0:parseFloat(i[0]),i[1]=0===i[1].length?1/0:parseFloat(i[1]),i[2]=t[e],s.push(i));this.map=t,this.rangelist=s||!1},get:function(t){var e,i,s,r=this.rangelist;if((s=this.map[t])!==N)return s;if(r)for(e=r.length;e--;)if((i=r[e])[0]<=t&&i[1]>=t)return i[2];return N}}),L.range_map=function(t){return new V(t)},u=e({init:function(t,e){var i=L(t);this.$el=i,this.options=e,this.currentPageX=0,this.currentPageY=0,this.el=t,this.splist=[],this.tooltip=null,this.over=!1,this.displayTooltips=!e.get("disableTooltips"),this.highlightEnabled=!e.get("disableHighlight")},registerSparkline:function(t){this.splist.push(t),this.over&&this.updateDisplay()},registerCanvas:function(t){var e=L(t.canvas);this.canvas=t,(this.$canvas=e).mouseenter(L.proxy(this.mouseenter,this)),e.mouseleave(L.proxy(this.mouseleave,this)),e.click(L.proxy(this.mouseclick,this))},reset:function(t){this.splist=[],this.tooltip&&t&&(this.tooltip.remove(),this.tooltip=N)},mouseclick:function(t){var e=L.Event("sparklineClick");e.originalEvent=t,e.sparklines=this.splist,this.$el.trigger(e)},mouseenter:function(t){L(S.body).unbind("mousemove.jqs"),L(S.body).bind("mousemove.jqs",L.proxy(this.mousemove,this)),this.over=!0,this.currentPageX=t.pageX,this.currentPageY=t.pageY,this.currentEl=t.target,!this.tooltip&&this.displayTooltips&&(this.tooltip=new s(this.options),this.tooltip.updatePosition(t.pageX,t.pageY)),this.updateDisplay()},mouseleave:function(){L(S.body).unbind("mousemove.jqs");var t,e=this.splist,i=e.length,s=!1;for(this.over=!1,this.currentEl=null,this.tooltip&&(this.tooltip.remove(),this.tooltip=null),t=0;t<i;t++)e[t].clearRegionHighlight()&&(s=!0);s&&this.canvas.render()},mousemove:function(t){this.currentPageX=t.pageX,this.currentPageY=t.pageY,this.currentEl=t.target,this.tooltip&&this.tooltip.updatePosition(t.pageX,t.pageY),this.updateDisplay()},updateDisplay:function(){var t,e,i,s,r=this.splist,n=r.length,a=!1,h=this.$canvas.offset(),o=this.currentPageX-h.left,l=this.currentPageY-h.top;if(this.over){for(e=0;e<n;e++)(i=r[e].setRegionHighlight(this.currentEl,o,l))&&(a=!0);if(a){if((s=L.Event("sparklineRegionChange")).sparklines=this.splist,this.$el.trigger(s),this.tooltip){for(t="",e=0;e<n;e++)t+=r[e].getCurrentRegionTooltip();this.tooltip.setContent(t)}this.disableHighlight||this.canvas.render()}null===i&&this.mouseleave()}}}),s=e({sizeStyle:"position: static !important;display: block !important;visibility: hidden !important;float: left !important;",init:function(t){var e,i=t.get("tooltipClassname","jqstooltip"),s=this.sizeStyle;this.container=t.get("tooltipContainer")||S.body,this.tooltipOffsetX=t.get("tooltipOffsetX",10),this.tooltipOffsetY=t.get("tooltipOffsetY",12),L("#jqssizetip").remove(),L("#jqstooltip").remove(),this.sizetip=L("<div/>",{id:"jqssizetip",style:s,class:i}),this.tooltip=L("<div/>",{id:"jqstooltip",class:i}).appendTo(this.container),e=this.tooltip.offset(),this.offsetLeft=e.left,this.offsetTop=e.top,this.hidden=!0,L(window).unbind("resize.jqs scroll.jqs"),L(window).bind("resize.jqs scroll.jqs",L.proxy(this.updateWindowDims,this)),this.updateWindowDims()},updateWindowDims:function(){this.scrollTop=L(window).scrollTop(),this.scrollLeft=L(window).scrollLeft(),this.scrollRight=this.scrollLeft+L(window).width(),this.updatePosition()},getSize:function(t){this.sizetip.html(t).appendTo(this.container),this.width=this.sizetip.width()+1,this.height=this.sizetip.height(),this.sizetip.remove()},setContent:function(t){if(!t)return this.tooltip.css("visibility","hidden"),void(this.hidden=!0);this.getSize(t),this.tooltip.html(t).css({width:this.width,height:this.height,visibility:"visible"}),this.hidden&&(this.hidden=!1,this.updatePosition())},updatePosition:function(t,e){if(t===N){if(this.mousex===N)return;t=this.mousex-this.offsetLeft,e=this.mousey-this.offsetTop}else this.mousex=t-=this.offsetLeft,this.mousey=e-=this.offsetTop;this.height&&this.width&&!this.hidden&&(e-=this.height+this.tooltipOffsetY,t+=this.tooltipOffsetX,e<this.scrollTop&&(e=this.scrollTop),t<this.scrollLeft?t=this.scrollLeft:t+this.width>this.scrollRight&&(t=this.scrollRight-this.width),this.tooltip.css({left:t,top:e}))},remove:function(){this.tooltip.remove(),this.sizetip.remove(),this.sizetip=this.tooltip=N,L(window).unbind("resize.jqs scroll.jqs")}}),L(function(){i('.jqstooltip { position: absolute;left: 0px;top: 0px;visibility: hidden;background: rgb(0, 0, 0) transparent;background-color: rgba(0,0,0,0.6);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000);-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000)";color: white;font: 10px arial, san serif;text-align: left;white-space: nowrap;padding: 5px;border: 1px solid white;z-index: 10000;}.jqsfield { color: white;font: 10px arial, san serif;text-align: left;}')}),x=[],L.fn.sparkline=function(l,i){return this.each(function(){function t(){var t,e,i,s,r,n="html"===l||l===N?((r=this.getAttribute(h.get("tagValuesAttribute")))!==N&&null!==r||(r=o.html()),r.replace(/(^\s*<!--)|(-->\s*$)|\s+/g,"").split(",")):l,a="auto"===h.get("width")?n.length*h.get("defaultPixelsPerValue"):h.get("width");"auto"===h.get("height")?h.get("composite")&&L.data(this,"_jqs_vcanvas")||((e=S.createElement("span")).innerHTML="a",o.html(e),t=L(e).innerHeight()||L(e).height(),L(e).remove(),e=null):t=h.get("height"),h.get("disableInteraction")?i=!1:(i=L.data(this,"_jqs_mhandler"))?h.get("composite")||i.reset():(i=new u(this,h),L.data(this,"_jqs_mhandler",i)),!h.get("composite")||L.data(this,"_jqs_vcanvas")?((s=new(L.fn.sparkline[h.get("type")])(this,n,h,a,t)).render(),i&&i.registerSparkline(s)):L.data(this,"_jqs_errnotify")||(alert("Attempted to attach a composite sparkline to an element with no existing sparkline"),L.data(this,"_jqs_errnotify",!0))}var e,h=new L.fn.sparkline.options(this,i),o=L(this);if(L(this).html()&&!h.get("disableHiddenCheck")&&L(this).is(":hidden")||!L(this).parents("body").length){if(!h.get("composite")&&L.data(this,"_jqs_pending"))for(e=x.length;e;e--)x[e-1][0]==this&&x.splice(e-1,1);x.push([this,t]),L.data(this,"_jqs_pending",!0)}else t.call(this)})},L.fn.sparkline.defaults=t(),L.sparkline_display_visible=function(){for(var t,e=[],i=0,s=x.length;i<s;i++)t=x[i][0],L(t).is(":visible")&&!L(t).parents().is(":hidden")?(x[i][1].call(t),L.data(x[i][0],"_jqs_pending",!1),e.push(i)):L(t).closest("html").length||L.data(t,"_jqs_pending")||(L.data(x[i][0],"_jqs_pending",!1),e.push(i));for(i=e.length;i;i--)x.splice(e[i-1],1)},L.fn.sparkline.options=e({init:function(t,e){var i,s,r,n;this.userOptions=e=e||{},this.tag=t,this.tagValCache={},r=(s=L.fn.sparkline.defaults).common,this.tagOptionsPrefix=e.enableTagOptions&&(e.tagOptionsPrefix||r.tagOptionsPrefix),i=(n=this.getTagSetting("type"))===y?s[e.type||r.type]:s[n],this.mergedOptions=L.extend({},r,i,e)},getTagSetting:function(t){var e,i,s,r,n=this.tagOptionsPrefix;if(!1===n||n===N)return y;if(this.tagValCache.hasOwnProperty(t))e=this.tagValCache.key;else{if((e=this.tag.getAttribute(n+t))===N||null===e)e=y;else if("["===e.substr(0,1))for(i=(e=e.substr(1,e.length-2).split(",")).length;i--;)e[i]=F(e[i].replace(/(^\s*)|(\s*$)/g,""));else if("{"===e.substr(0,1))for(s=e.substr(1,e.length-2).split(","),e={},i=s.length;i--;)e[(r=s[i].split(":",2))[0].replace(/(^\s*)|(\s*$)/g,"")]=F(r[1].replace(/(^\s*)|(\s*$)/g,""));else e=F(e);this.tagValCache.key=e}return e},get:function(t,e){var i,s=this.getTagSetting(t);return s!==y?s:(i=this.mergedOptions[t])===N?e:i}}),L.fn.sparkline._base=e({disabled:!1,init:function(t,e,i,s,r){this.el=t,this.$el=L(t),this.values=e,this.options=i,this.width=s,this.height=r,this.currentRegion=N},initTarget:function(){var t=!this.options.get("disableInteraction");(this.target=this.$el.simpledraw(this.width,this.height,this.options.get("composite"),t))?(this.canvasWidth=this.target.pixelWidth,this.canvasHeight=this.target.pixelHeight):this.disabled=!0},render:function(){return!this.disabled||(this.el.innerHTML="",!1)},getRegion:function(t,e){},setRegionHighlight:function(t,e,i){var s,r=this.currentRegion,n=!this.options.get("disableHighlight");return e>this.canvasWidth||i>this.canvasHeight||e<0||i<0?null:r!==(s=this.getRegion(t,e,i))&&(r!==N&&n&&this.removeHighlight(),(this.currentRegion=s)!==N&&n&&this.renderHighlight(),!0)},clearRegionHighlight:function(){return this.currentRegion!==N&&(this.removeHighlight(),!(this.currentRegion=N))},renderHighlight:function(){this.changeHighlight(!0)},removeHighlight:function(){this.changeHighlight(!1)},changeHighlight:function(t){},getCurrentRegionTooltip:function(){var t,e,i,s,r,n,a,h,o,l,g,p,u,c,d=this.options,f="",v=[];if(this.currentRegion===N)return"";if(t=this.getCurrentRegionFields(),g=d.get("tooltipFormatter"))return g(this,d,t);if(d.get("tooltipChartTitle")&&(f+='<div class="jqs jqstitle">'+d.get("tooltipChartTitle")+"</div>\n"),!(e=this.options.get("tooltipFormat")))return"";if(L.isArray(e)||(e=[e]),L.isArray(t)||(t=[t]),a=this.options.get("tooltipFormatFieldlist"),h=this.options.get("tooltipFormatFieldlistKey"),a&&h){for(o=[],n=t.length;n--;)l=t[n][h],-1!=(c=L.inArray(l,a))&&(o[c]=t[n]);t=o}for(i=e.length,u=t.length,n=0;n<i;n++)for("string"==typeof(p=e[n])&&(p=new m(p)),s=p.fclass||"jqsfield",c=0;c<u;c++)t[c].isNull&&d.get("tooltipSkipNull")||(L.extend(t[c],{prefix:d.get("tooltipPrefix"),suffix:d.get("tooltipSuffix")}),r=p.render(t[c],d.get("tooltipValueLookups"),d),v.push('<div class="'+s+'">'+r+"</div>"));return v.length?f+v.join("\n"):""},getCurrentRegionFields:function(){},calcHighlightColor:function(t,e){var i,s,r,n,a=e.get("highlightColor"),h=e.get("highlightLighten");if(a)return a;if(h&&(i=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(t)||/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(t))){for(r=[],s=4===t.length?16:1,n=0;n<3;n++)r[n]=A(z.round(parseInt(i[n+1],16)*s*h),0,255);return"rgb("+r.join(",")+")"}return t}}),r={changeHighlight:function(t){var e,i=this.currentRegion,s=this.target,r=this.regionShapes[i];r&&(e=this.renderRegion(i,t),L.isArray(e)||L.isArray(r)?(s.replaceWithShapes(r,e),this.regionShapes[i]=L.map(e,function(t){return t.id})):(s.replaceWithShape(r,e),this.regionShapes[i]=e.id))},render:function(){var t,e,i,s,r=this.values,n=this.target,a=this.regionShapes;if(this.cls._super.render.call(this)){for(i=r.length;i--;)if(t=this.renderRegion(i))if(L.isArray(t)){for(e=[],s=t.length;s--;)t[s].append(),e.push(t[s].id);a[i]=e}else t.append(),a[i]=t.id;else a[i]=null;n.render()}}},L.fn.sparkline.line=q=e(L.fn.sparkline._base,{type:"line",init:function(t,e,i,s,r){q._super.init.call(this,t,e,i,s,r),this.vertices=[],this.regionMap=[],this.xvalues=[],this.yvalues=[],this.yminmax=[],this.hightlightSpotId=null,this.lastShapeId=null,this.initTarget()},getRegion:function(t,e,i){for(var s=this.regionMap,r=s.length;r--;)if(null!==s[r]&&e>=s[r][0]&&e<=s[r][1])return s[r][2];return N},getCurrentRegionFields:function(){var t=this.currentRegion;return{isNull:null===this.yvalues[t],x:this.xvalues[t],y:this.yvalues[t],color:this.options.get("lineColor"),fillColor:this.options.get("fillColor"),offset:t}},renderHighlight:function(){var t,e,i=this.currentRegion,s=this.target,r=this.vertices[i],n=this.options,a=n.get("spotRadius"),h=n.get("highlightSpotColor"),o=n.get("highlightLineColor");r&&(a&&h&&(t=s.drawCircle(r[0],r[1],a,N,h),this.highlightSpotId=t.id,s.insertAfterShape(this.lastShapeId,t)),o&&(e=s.drawLine(r[0],this.canvasTop,r[0],this.canvasTop+this.canvasHeight,o),this.highlightLineId=e.id,s.insertAfterShape(this.lastShapeId,e)))},removeHighlight:function(){var t=this.target;this.highlightSpotId&&(t.removeShapeId(this.highlightSpotId),this.highlightSpotId=null),this.highlightLineId&&(t.removeShapeId(this.highlightLineId),this.highlightLineId=null)},scanValues:function(){for(var t,e,i,s,r=this.values,n=r.length,a=this.xvalues,h=this.yvalues,o=this.yminmax,l=0;l<n;l++)t=r[l],e="string"==typeof r[l],i="object"==typeof r[l]&&r[l]instanceof Array,s=e&&r[l].split(":"),e&&2===s.length?(a.push(Number(s[0])),h.push(Number(s[1])),o.push(Number(s[1]))):i?(a.push(t[0]),h.push(t[1]),o.push(t[1])):(a.push(l),null===r[l]||"null"===r[l]?h.push(null):(h.push(Number(t)),o.push(Number(t))));this.options.get("xvalues")&&(a=this.options.get("xvalues")),this.maxy=this.maxyorg=z.max.apply(z,o),this.miny=this.minyorg=z.min.apply(z,o),this.maxx=z.max.apply(z,a),this.minx=z.min.apply(z,a),this.xvalues=a,this.yvalues=h,this.yminmax=o},processRangeOptions:function(){var t=this.options,e=t.get("normalRangeMin"),i=t.get("normalRangeMax");e!==N&&(e<this.miny&&(this.miny=e),i>this.maxy&&(this.maxy=i)),t.get("chartRangeMin")!==N&&(t.get("chartRangeClip")||t.get("chartRangeMin")<this.miny)&&(this.miny=t.get("chartRangeMin")),t.get("chartRangeMax")!==N&&(t.get("chartRangeClip")||t.get("chartRangeMax")>this.maxy)&&(this.maxy=t.get("chartRangeMax")),t.get("chartRangeMinX")!==N&&(t.get("chartRangeClipX")||t.get("chartRangeMinX")<this.minx)&&(this.minx=t.get("chartRangeMinX")),t.get("chartRangeMaxX")!==N&&(t.get("chartRangeClipX")||t.get("chartRangeMaxX")>this.maxx)&&(this.maxx=t.get("chartRangeMaxX"))},drawNormalRange:function(t,e,i,s,r){var n=this.options.get("normalRangeMin"),a=this.options.get("normalRangeMax"),h=e+z.round(i-i*((a-this.miny)/r)),o=z.round(i*(a-n)/r);this.target.drawRect(t,h,s,o,N,this.options.get("normalRangeColor")).append()},render:function(){var t,e,i,s,r,n,a,h,o,l,g,p,u,c,d,f,v,m,x,y,C,w,b,R,S=this.options,k=this.target,M=this.canvasWidth,_=this.canvasHeight,H=this.vertices,W=S.get("spotRadius"),T=this.regionMap;if(q._super.render.call(this)&&(this.scanValues(),this.processRangeOptions(),w=this.xvalues,b=this.yvalues,this.yminmax.length&&!(this.yvalues.length<2))){for(s=r=0,t=this.maxx-this.minx==0?1:this.maxx-this.minx,e=this.maxy-this.miny==0?1:this.maxy-this.miny,i=this.yvalues.length-1,W&&(M<4*W||_<4*W)&&(W=0),W&&(((y=S.get("highlightSpotColor")&&!S.get("disableInteraction"))||S.get("minSpotColor")||S.get("spotColor")&&b[i]===this.miny)&&(_-=z.ceil(W)),(y||S.get("maxSpotColor")||S.get("spotColor")&&b[i]===this.maxy)&&(_-=z.ceil(W),s+=z.ceil(W)),!y&&(!S.get("minSpotColor")&&!S.get("maxSpotColor")||b[0]!==this.miny&&b[0]!==this.maxy)||(r+=z.ceil(W),M-=z.ceil(W)),(y||S.get("spotColor")||S.get("minSpotColor")||S.get("maxSpotColor")&&(b[i]===this.miny||b[i]===this.maxy))&&(M-=z.ceil(W))),_--,S.get("normalRangeMin")===N||S.get("drawNormalOnTop")||this.drawNormalRange(r,s,_,M,e),h=[a=[]],u=c=null,d=b.length,R=0;R<d;R++)o=w[R],g=w[R+1],l=b[R],c=(p=r+z.round((o-this.minx)*(M/t)))+((R<d-1?r+z.round((g-this.minx)*(M/t)):M)-p)/2,T[R]=[u||0,c,R],u=c,null===l?R&&(null!==b[R-1]&&(a=[],h.push(a)),H.push(null)):(l<this.miny&&(l=this.miny),l>this.maxy&&(l=this.maxy),a.length||a.push([p,s+_]),n=[p,s+z.round(_-_*((l-this.miny)/e))],a.push(n),H.push(n));for(f=[],v=[],m=h.length,R=0;R<m;R++)(a=h[R]).length&&(S.get("fillColor")&&(a.push([a[a.length-1][0],s+_]),v.push(a.slice(0)),a.pop()),2<a.length&&(a[0]=[a[0][0],a[1][1]]),f.push(a));for(m=v.length,R=0;R<m;R++)k.drawShape(v[R],S.get("fillColor"),S.get("fillColor")).append();for(S.get("normalRangeMin")!==N&&S.get("drawNormalOnTop")&&this.drawNormalRange(r,s,_,M,e),m=f.length,R=0;R<m;R++)k.drawShape(f[R],S.get("lineColor"),N,S.get("lineWidth")).append();if(W&&S.get("valueSpots"))for((x=S.get("valueSpots")).get===N&&(x=new V(x)),R=0;R<d;R++)(C=x.get(b[R]))&&k.drawCircle(r+z.round((w[R]-this.minx)*(M/t)),s+z.round(_-_*((b[R]-this.miny)/e)),W,N,C).append();W&&S.get("spotColor")&&null!==b[i]&&k.drawCircle(r+z.round((w[w.length-1]-this.minx)*(M/t)),s+z.round(_-_*((b[i]-this.miny)/e)),W,N,S.get("spotColor")).append(),this.maxy!==this.minyorg&&(W&&S.get("minSpotColor")&&(o=w[L.inArray(this.minyorg,b)],k.drawCircle(r+z.round((o-this.minx)*(M/t)),s+z.round(_-_*((this.minyorg-this.miny)/e)),W,N,S.get("minSpotColor")).append()),W&&S.get("maxSpotColor")&&(o=w[L.inArray(this.maxyorg,b)],k.drawCircle(r+z.round((o-this.minx)*(M/t)),s+z.round(_-_*((this.maxyorg-this.miny)/e)),W,N,S.get("maxSpotColor")).append())),this.lastShapeId=k.getLastShapeId(),this.canvasTop=s,k.render()}}}),L.fn.sparkline.bar=X=e(L.fn.sparkline._base,r,{type:"bar",init:function(t,e,i,s,r){var n,a,h,o,l,g,p,u,c,d,f,v,m,x,y,C,w,b,R,S=parseInt(i.get("barWidth"),10),k=parseInt(i.get("barSpacing"),10),M=i.get("chartRangeMin"),_=i.get("chartRangeMax"),H=i.get("chartRangeClip"),W=1/0,T=-1/0;for(X._super.init.call(this,t,e,i,s,r),j=0,P=e.length;j<P;j++)((n="string"==typeof(b=e[j])&&-1<b.indexOf(":"))||L.isArray(b))&&(m=!0,n&&(b=e[j]=B(b.split(":"))),b=O(b,null),(a=z.min.apply(z,b))<W&&(W=a),T<(h=z.max.apply(z,b))&&(T=h));this.stacked=m,this.regionShapes={},this.barWidth=S,this.barSpacing=k,this.totalBarWidth=S+k,this.width=s=e.length*S+(e.length-1)*k,this.initTarget(),H&&(f=M===N?-1/0:M,v=_===N?1/0:_),l=[],o=m?[]:l;for(var q=[],I=[],j=0,P=e.length;j<P;j++)if(m)for(x=e[j],e[j]=w=[],q[j]=0,o[j]=I[j]=0,y=0,C=x.length;y<C;y++)null!==(b=w[y]=H?A(x[y],f,v):x[y])&&(0<b&&(q[j]+=b),W<0&&0<T?b<0?I[j]+=z.abs(b):o[j]+=b:o[j]+=z.abs(b-(b<0?T:W)),l.push(b));else b=H?A(e[j],f,v):e[j],null!==(b=e[j]=F(b))&&l.push(b);this.max=d=z.max.apply(z,l),this.min=c=z.min.apply(z,l),this.stackMax=T=m?z.max.apply(z,q):d,this.stackMin=W=m?z.min.apply(z,l):c,i.get("chartRangeMin")!==N&&(i.get("chartRangeClip")||i.get("chartRangeMin")<c)&&(c=i.get("chartRangeMin")),i.get("chartRangeMax")!==N&&(i.get("chartRangeClip")||i.get("chartRangeMax")>d)&&(d=i.get("chartRangeMax")),this.zeroAxis=p=i.get("zeroAxis",!0),u=c<=0&&0<=d&&p?0:0==p||0<c?c:d,this.xaxisOffset=u,g=m?z.max.apply(z,o)+z.max.apply(z,I):d-c,this.canvasHeightEf=p&&c<0?this.canvasHeight-2:this.canvasHeight-1,c<u?(R=((m&&0<=d?T:d)-u)/g*this.canvasHeight)!==z.ceil(R)&&(this.canvasHeightEf-=2,R=z.ceil(R)):R=this.canvasHeight,this.yoffset=R,L.isArray(i.get("colorMap"))?(this.colorMapByIndex=i.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=i.get("colorMap"),this.colorMapByValue&&this.colorMapByValue.get===N&&(this.colorMapByValue=new V(this.colorMapByValue))),this.range=g},getRegion:function(t,e,i){var s=z.floor(e/this.totalBarWidth);return s<0||s>=this.values.length?N:s},getCurrentRegionFields:function(){for(var t,e=this.currentRegion,i=n(this.values[e]),s=[],r=i.length;r--;)t=i[r],s.push({isNull:null===t,value:t,color:this.calcColor(r,t,e),offset:e});return s},calcColor:function(t,e,i){var s,r=this.colorMapByIndex,n=this.colorMapByValue,a=this.options,h=this.stacked?a.get("stackedBarColor"):e<0?a.get("negBarColor"):a.get("barColor");return 0===e&&a.get("zeroColor")!==N&&(h=a.get("zeroColor")),n&&(s=n.get(e))?h=s:r&&r.length>i&&(h=r[i]),L.isArray(h)?h[t%h.length]:h},renderRegion:function(t,e){var i,s,r,n,a,h,o=this.values[t],l=this.options,g=this.xaxisOffset,p=[],u=this.range,c=this.stacked,d=this.target,f=t*this.totalBarWidth,v=this.canvasHeightEf,m=this.yoffset,x=(o=L.isArray(o)?o:[o]).length,y=o[0],C=b(null,o),w=b(g,o,!0);if(C)return l.get("nullColor")?(r=e?l.get("nullColor"):this.calcHighlightColor(l.get("nullColor"),l),i=0<m?m-1:m,d.drawRect(f,i,this.barWidth-1,0,r,r)):N;for(n=m,a=0;a<x;a++){if(y=o[a],c&&y===g){if(!w||h)continue;h=!0}s=0<u?z.floor(v*(z.abs(y-g)/u))+1:1,y<g||y===g&&0===m?(i=n,n+=s):(i=m-s,m-=s),r=this.calcColor(a,y,t),e&&(r=this.calcHighlightColor(r,l)),p.push(d.drawRect(f,i,this.barWidth-1,s-1,r,r))}return 1===p.length?p[0]:p}}),L.fn.sparkline.tristate=h=e(L.fn.sparkline._base,r,{type:"tristate",init:function(t,e,i,s,r){var n=parseInt(i.get("barWidth"),10),a=parseInt(i.get("barSpacing"),10);h._super.init.call(this,t,e,i,s,r),this.regionShapes={},this.barWidth=n,this.barSpacing=a,this.totalBarWidth=n+a,this.values=L.map(e,Number),this.width=s=e.length*n+(e.length-1)*a,L.isArray(i.get("colorMap"))?(this.colorMapByIndex=i.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=i.get("colorMap"),this.colorMapByValue&&this.colorMapByValue.get===N&&(this.colorMapByValue=new V(this.colorMapByValue))),this.initTarget()},getRegion:function(t,e,i){return z.floor(e/this.totalBarWidth)},getCurrentRegionFields:function(){var t=this.currentRegion;return{isNull:this.values[t]===N,value:this.values[t],color:this.calcColor(this.values[t],t),offset:t}},calcColor:function(t,e){var i,s=this.values,r=this.options,n=this.colorMapByIndex,a=this.colorMapByValue,h=a&&(i=a.get(t))?i:n&&n.length>e?n[e]:s[e]<0?r.get("negBarColor"):0<s[e]?r.get("posBarColor"):r.get("zeroBarColor");return h},renderRegion:function(t,e){var i,s=this.values,r=this.options,n=this.target,a=n.pixelHeight,h=z.round(a/2),o=t*this.totalBarWidth,l=s[t]<0?(i=h)-1:0<s[t]?(i=0,h-1):(i=h-1,2),g=this.calcColor(s[t],t);if(null!==g)return e&&(g=this.calcHighlightColor(g,r)),n.drawRect(o,i,this.barWidth-1,l-1,g,g)}}),L.fn.sparkline.discrete=a=e(L.fn.sparkline._base,r,{type:"discrete",init:function(t,e,i,s,r){a._super.init.call(this,t,e,i,s,r),this.regionShapes={},this.values=e=L.map(e,Number),this.min=z.min.apply(z,e),this.max=z.max.apply(z,e),this.range=this.max-this.min,this.width=s="auto"===i.get("width")?2*e.length:this.width,this.interval=z.floor(s/e.length),this.itemWidth=s/e.length,i.get("chartRangeMin")!==N&&(i.get("chartRangeClip")||i.get("chartRangeMin")<this.min)&&(this.min=i.get("chartRangeMin")),i.get("chartRangeMax")!==N&&(i.get("chartRangeClip")||i.get("chartRangeMax")>this.max)&&(this.max=i.get("chartRangeMax")),this.initTarget(),this.target&&(this.lineHeight="auto"===i.get("lineHeight")?z.round(.3*this.canvasHeight):i.get("lineHeight"))},getRegion:function(t,e,i){return z.floor(e/this.itemWidth)},getCurrentRegionFields:function(){var t=this.currentRegion;return{isNull:this.values[t]===N,value:this.values[t],offset:t}},renderRegion:function(t,e){var i=this.values,s=this.options,r=this.min,n=this.max,a=this.range,h=this.interval,o=this.target,l=this.canvasHeight,g=this.lineHeight,p=l-g,u=A(i[t],r,n),c=t*h,d=z.round(p-(u-r)/a*p),f=s.get("thresholdColor")&&u<s.get("thresholdValue")?s.get("thresholdColor"):s.get("lineColor");return e&&(f=this.calcHighlightColor(f,s)),o.drawLine(c,d,c,d+g,f)}}),L.fn.sparkline.bullet=o=e(L.fn.sparkline._base,{type:"bullet",init:function(t,e,i,s,r){var n,a,h;o._super.init.call(this,t,e,i,s,r),this.values=e=B(e),(h=e.slice())[0]=null===h[0]?h[2]:h[0],h[1]=null===e[1]?h[2]:h[1],n=z.min.apply(z,e),a=z.max.apply(z,e),n=i.get("base")===N?n<0?n:0:i.get("base"),this.min=n,this.max=a,this.range=a-n,this.shapes={},this.valueShapes={},this.regiondata={},this.width=s="auto"===i.get("width")?"4.0em":s,this.target=this.$el.simpledraw(s,r,i.get("composite")),e.length||(this.disabled=!0),this.initTarget()},getRegion:function(t,e,i){var s=this.target.getShapeAt(t,e,i);return s!==N&&this.shapes[s]!==N?this.shapes[s]:N},getCurrentRegionFields:function(){var t=this.currentRegion;return{fieldkey:t.substr(0,1),value:this.values[t.substr(1)],region:t}},changeHighlight:function(t){var e,i=this.currentRegion,s=this.valueShapes[i];switch(delete this.shapes[s],i.substr(0,1)){case"r":e=this.renderRange(i.substr(1),t);break;case"p":e=this.renderPerformance(t);break;case"t":e=this.renderTarget(t)}this.valueShapes[i]=e.id,this.shapes[e.id]=i,this.target.replaceWithShape(s,e)},renderRange:function(t,e){var i=this.values[t],s=z.round(this.canvasWidth*((i-this.min)/this.range)),r=this.options.get("rangeColors")[t-2];return e&&(r=this.calcHighlightColor(r,this.options)),this.target.drawRect(0,0,s-1,this.canvasHeight-1,r,r)},renderPerformance:function(t){var e=this.values[1],i=z.round(this.canvasWidth*((e-this.min)/this.range)),s=this.options.get("performanceColor");return t&&(s=this.calcHighlightColor(s,this.options)),this.target.drawRect(0,z.round(.3*this.canvasHeight),i-1,z.round(.4*this.canvasHeight)-1,s,s)},renderTarget:function(t){var e=this.values[0],i=z.round(this.canvasWidth*((e-this.min)/this.range)-this.options.get("targetWidth")/2),s=z.round(.1*this.canvasHeight),r=this.canvasHeight-2*s,n=this.options.get("targetColor");return t&&(n=this.calcHighlightColor(n,this.options)),this.target.drawRect(i,s,this.options.get("targetWidth")-1,r-1,n,n)},render:function(){var t,e,i=this.values.length,s=this.target;if(o._super.render.call(this)){for(t=2;t<i;t++)e=this.renderRange(t).append(),this.shapes[e.id]="r"+t,this.valueShapes["r"+t]=e.id;null!==this.values[1]&&(e=this.renderPerformance().append(),this.shapes[e.id]="p1",this.valueShapes.p1=e.id),null!==this.values[0]&&(e=this.renderTarget().append(),this.shapes[e.id]="t0",this.valueShapes.t0=e.id),s.render()}}}),L.fn.sparkline.pie=l=e(L.fn.sparkline._base,{type:"pie",init:function(t,e,i,s,r){var n,a=0;if(l._super.init.call(this,t,e,i,s,r),this.shapes={},this.valueShapes={},this.values=e=L.map(e,Number),"auto"===i.get("width")&&(this.width=this.height),0<e.length)for(n=e.length;n--;)a+=e[n];this.total=a,this.initTarget(),this.radius=z.floor(z.min(this.canvasWidth,this.canvasHeight)/2)},getRegion:function(t,e,i){var s=this.target.getShapeAt(t,e,i);return s!==N&&this.shapes[s]!==N?this.shapes[s]:N},getCurrentRegionFields:function(){var t=this.currentRegion;return{isNull:this.values[t]===N,value:this.values[t],percent:this.values[t]/this.total*100,color:this.options.get("sliceColors")[t%this.options.get("sliceColors").length],offset:t}},changeHighlight:function(t){var e=this.currentRegion,i=this.renderSlice(e,t),s=this.valueShapes[e];delete this.shapes[s],this.target.replaceWithShape(s,i),this.valueShapes[e]=i.id,this.shapes[i.id]=e},renderSlice:function(t,e){for(var i,s,r,n=this.target,a=this.options,h=this.radius,o=a.get("borderWidth"),l=a.get("offset"),g=2*z.PI,p=this.values,u=this.total,c=l?2*z.PI*(l/360):0,d=p.length,f=0;f<d;f++){if(s=i=c,0<u&&(s=c+g*(p[f]/u)),t===f)return r=a.get("sliceColors")[f%a.get("sliceColors").length],e&&(r=this.calcHighlightColor(r,a)),n.drawPieSlice(h,h,h-o,i,s,N,r);c=s}},render:function(){var t,e,i=this.target,s=this.values,r=this.options,n=this.radius,a=r.get("borderWidth");if(l._super.render.call(this)){for(a&&i.drawCircle(n,n,z.floor(n-a/2),r.get("borderColor"),N,a).append(),e=s.length;e--;)s[e]&&(t=this.renderSlice(e).append(),this.valueShapes[e]=t.id,this.shapes[t.id]=e);i.render()}}}),L.fn.sparkline.box=w=e(L.fn.sparkline._base,{type:"box",init:function(t,e,i,s,r){w._super.init.call(this,t,e,i,s,r),this.values=L.map(e,Number),this.width="auto"===i.get("width")?"4.0em":s,this.initTarget(),this.values.length||(this.disabled=1)},getRegion:function(){return 1},getCurrentRegionFields:function(){var t=[{field:"lq",value:this.quartiles[0]},{field:"med",value:this.quartiles[1]},{field:"uq",value:this.quartiles[2]}];return this.loutlier!==N&&t.push({field:"lo",value:this.loutlier}),this.routlier!==N&&t.push({field:"ro",value:this.routlier}),this.lwhisker!==N&&t.push({field:"lw",value:this.lwhisker}),this.rwhisker!==N&&t.push({field:"rw",value:this.rwhisker}),t},render:function(){var t,e,i,s,r,n,a,h,o,l,g,p=this.target,u=this.values,c=u.length,d=this.options,f=this.canvasWidth,v=this.canvasHeight,m=d.get("chartRangeMin")===N?z.min.apply(z,u):d.get("chartRangeMin"),x=d.get("chartRangeMax")===N?z.max.apply(z,u):d.get("chartRangeMax"),y=0;if(w._super.render.call(this)){if(d.get("raw"))d.get("showOutliers")&&5<u.length?(e=u[0],t=u[1],s=u[2],r=u[3],n=u[4],a=u[5],h=u[6]):(t=u[0],s=u[1],r=u[2],n=u[3],a=u[4]);else if(u.sort(function(t,e){return t-e}),s=C(u,1),r=C(u,2),i=(n=C(u,3))-s,d.get("showOutliers")){for(t=a=N,o=0;o<c;o++)t===N&&u[o]>s-i*d.get("outlierIQR")&&(t=u[o]),u[o]<n+i*d.get("outlierIQR")&&(a=u[o]);e=u[0],h=u[c-1]}else t=u[0],a=u[c-1];this.quartiles=[s,r,n],this.lwhisker=t,this.rwhisker=a,this.loutlier=e,this.routlier=h,g=f/(x-m+1),d.get("showOutliers")&&(y=z.ceil(d.get("spotRadius")),g=(f-=2*z.ceil(d.get("spotRadius")))/(x-m+1),e<t&&p.drawCircle((e-m)*g+y,v/2,d.get("spotRadius"),d.get("outlierLineColor"),d.get("outlierFillColor")).append(),a<h&&p.drawCircle((h-m)*g+y,v/2,d.get("spotRadius"),d.get("outlierLineColor"),d.get("outlierFillColor")).append()),p.drawRect(z.round((s-m)*g+y),z.round(.1*v),z.round((n-s)*g),z.round(.8*v),d.get("boxLineColor"),d.get("boxFillColor")).append(),p.drawLine(z.round((t-m)*g+y),z.round(v/2),z.round((s-m)*g+y),z.round(v/2),d.get("lineColor")).append(),p.drawLine(z.round((t-m)*g+y),z.round(v/4),z.round((t-m)*g+y),z.round(v-v/4),d.get("whiskerColor")).append(),p.drawLine(z.round((a-m)*g+y),z.round(v/2),z.round((n-m)*g+y),z.round(v/2),d.get("lineColor")).append(),p.drawLine(z.round((a-m)*g+y),z.round(v/4),z.round((a-m)*g+y),z.round(v-v/4),d.get("whiskerColor")).append(),p.drawLine(z.round((r-m)*g+y),z.round(.1*v),z.round((r-m)*g+y),z.round(.9*v),d.get("medianColor")).append(),d.get("target")&&(l=z.ceil(d.get("spotRadius")),p.drawLine(z.round((d.get("target")-m)*g+y),z.round(v/2-l),z.round((d.get("target")-m)*g+y),z.round(v/2+l),d.get("targetColor")).append(),p.drawLine(z.round((d.get("target")-m)*g+y-l),z.round(v/2),z.round((d.get("target")-m)*g+y+l),z.round(v/2),d.get("targetColor")).append()),p.render()}}}),c=e({init:function(t,e,i,s){this.target=t,this.id=e,this.type=i,this.args=s},append:function(){return this.target.appendShape(this),this}}),d=e({_pxregex:/(\d+)(px)?\s*$/i,init:function(t,e,i){t&&(this.width=t,this.height=e,this.target=i,this.lastShapeId=null,i[0]&&(i=i[0]),L.data(i,"_jqs_vcanvas",this))},drawLine:function(t,e,i,s,r,n){return this.drawShape([[t,e],[i,s]],r,n)},drawShape:function(t,e,i,s){return this._genShape("Shape",[t,e,i,s])},drawCircle:function(t,e,i,s,r,n){return this._genShape("Circle",[t,e,i,s,r,n])},drawPieSlice:function(t,e,i,s,r,n,a){return this._genShape("PieSlice",[t,e,i,s,r,n,a])},drawRect:function(t,e,i,s,r,n){return this._genShape("Rect",[t,e,i,s,r,n])},getElement:function(){return this.canvas},getLastShapeId:function(){return this.lastShapeId},reset:function(){alert("reset not implemented")},_insert:function(t,e){L(e).html(t)},_calculatePixelDims:function(t,e,i){var s=this._pxregex.exec(e);this.pixelHeight=s?s[1]:L(i).height(),s=this._pxregex.exec(t),this.pixelWidth=s?s[1]:L(i).width()},_genShape:function(t,e){var i=R++;return e.unshift(i),new c(this,i,t,e)},appendShape:function(t){alert("appendShape not implemented")},replaceWithShape:function(t,e){alert("replaceWithShape not implemented")},insertAfterShape:function(t,e){alert("insertAfterShape not implemented")},removeShapeId:function(t){alert("removeShapeId not implemented")},getShapeAt:function(t,e,i){alert("getShapeAt not implemented")},render:function(){alert("render not implemented")}}),f=e(d,{init:function(t,e,i,s){f._super.init.call(this,t,e,i),this.canvas=S.createElement("canvas"),i[0]&&(i=i[0]),L.data(i,"_jqs_vcanvas",this),L(this.canvas).css({display:"inline-block",width:t,height:e,verticalAlign:"top"}),this._insert(this.canvas,i),this._calculatePixelDims(t,e,this.canvas),this.canvas.width=this.pixelWidth,this.canvas.height=this.pixelHeight,this.interact=s,this.shapes={},this.shapeseq=[],this.currentTargetShapeId=N,L(this.canvas).css({width:this.pixelWidth,height:this.pixelHeight})},_getContext:function(t,e,i){var s=this.canvas.getContext("2d");return t!==N&&(s.strokeStyle=t),s.lineWidth=i===N?1:i,e!==N&&(s.fillStyle=e),s},reset:function(){this._getContext().clearRect(0,0,this.pixelWidth,this.pixelHeight),this.shapes={},this.shapeseq=[],this.currentTargetShapeId=N},_drawShape:function(t,e,i,s,r){var n,a,h=this._getContext(i,s,r);for(h.beginPath(),h.moveTo(e[0][0]+.5,e[0][1]+.5),n=1,a=e.length;n<a;n++)h.lineTo(e[n][0]+.5,e[n][1]+.5);i!==N&&h.stroke(),s!==N&&h.fill(),this.targetX!==N&&this.targetY!==N&&h.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=t)},_drawCircle:function(t,e,i,s,r,n,a){var h=this._getContext(r,n,a);h.beginPath(),h.arc(e,i,s,0,2*z.PI,!1),this.targetX!==N&&this.targetY!==N&&h.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=t),r!==N&&h.stroke(),n!==N&&h.fill()},_drawPieSlice:function(t,e,i,s,r,n,a,h){var o=this._getContext(a,h);o.beginPath(),o.moveTo(e,i),o.arc(e,i,s,r,n,!1),o.lineTo(e,i),o.closePath(),a!==N&&o.stroke(),h&&o.fill(),this.targetX!==N&&this.targetY!==N&&o.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=t)},_drawRect:function(t,e,i,s,r,n,a){return this._drawShape(t,[[e,i],[e+s,i],[e+s,i+r],[e,i+r],[e,i]],n,a)},appendShape:function(t){return this.shapes[t.id]=t,this.shapeseq.push(t.id),this.lastShapeId=t.id,t.id},replaceWithShape:function(t,e){var i,s=this.shapeseq;for(this.shapes[e.id]=e,i=s.length;i--;)s[i]==t&&(s[i]=e.id);delete this.shapes[t]},replaceWithShapes:function(t,e){for(var i,s,r=this.shapeseq,n={},a=t.length;a--;)n[t[a]]=!0;for(a=r.length;a--;)n[i=r[a]]&&(r.splice(a,1),delete this.shapes[i],s=a);for(a=e.length;a--;)r.splice(s,0,e[a].id),this.shapes[e[a].id]=e[a]},insertAfterShape:function(t,e){for(var i=this.shapeseq,s=i.length;s--;)if(i[s]===t)return i.splice(s+1,0,e.id),void(this.shapes[e.id]=e)},removeShapeId:function(t){for(var e=this.shapeseq,i=e.length;i--;)if(e[i]===t){e.splice(i,1);break}delete this.shapes[t]},getShapeAt:function(t,e,i){return this.targetX=e,this.targetY=i,this.render(),this.currentTargetShapeId},render:function(){var t,e,i=this.shapeseq,s=this.shapes,r=i.length;for(this._getContext().clearRect(0,0,this.pixelWidth,this.pixelHeight),e=0;e<r;e++)this["_draw"+(t=s[i[e]]).type].apply(this,t.args);this.interact||(this.shapes={},this.shapeseq=[])}}),v=e(d,{init:function(t,e,i){var s;v._super.init.call(this,t,e,i),i[0]&&(i=i[0]),L.data(i,"_jqs_vcanvas",this),this.canvas=S.createElement("span"),L(this.canvas).css({display:"inline-block",position:"relative",overflow:"hidden",width:t,height:e,margin:"0px",padding:"0px",verticalAlign:"top"}),this._insert(this.canvas,i),this._calculatePixelDims(t,e,this.canvas),this.canvas.width=this.pixelWidth,this.canvas.height=this.pixelHeight,s='<v:group coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'" style="position:absolute;top:0;left:0;width:'+this.pixelWidth+"px;height="+this.pixelHeight+'px;"></v:group>',this.canvas.insertAdjacentHTML("beforeEnd",s),this.group=L(this.canvas).children()[0],this.rendered=!1,this.prerender=""},_drawShape:function(t,e,i,s,r){for(var n,a,h,o,l=[],g=0,p=e.length;g<p;g++)l[g]=e[g][0]+","+e[g][1];return n=l.splice(0,1),r=r===N?1:r,a=i===N?' stroked="false" ':' strokeWeight="'+r+'px" strokeColor="'+i+'" ',h=s===N?' filled="false"':' fillColor="'+s+'" filled="true" ',o=l[0]===l[l.length-1]?"x ":"",'<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'"  id="jqsshape'+t+'" '+a+h+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;"  path="m '+n+" l "+l.join(", ")+" "+o+'e"> </v:shape>'},_drawCircle:function(t,e,i,s,r,n,a){return'<v:oval  id="jqsshape'+t+'" '+(r===N?' stroked="false" ':' strokeWeight="'+a+'px" strokeColor="'+r+'" ')+(n===N?' filled="false"':' fillColor="'+n+'" filled="true" ')+' style="position:absolute;top:'+(i-=s)+"px; left:"+(e-=s)+"px; width:"+2*s+"px; height:"+2*s+'px"></v:oval>'},_drawPieSlice:function(t,e,i,s,r,n,a,h){var o,l,g,p,u,c,d;if(r===n)return"";if(n-r==2*z.PI&&(r=0,n=2*z.PI),l=e+z.round(z.cos(r)*s),g=i+z.round(z.sin(r)*s),p=e+z.round(z.cos(n)*s),u=i+z.round(z.sin(n)*s),l===p&&g===u){if(n-r<z.PI)return"";l=p=e+s,g=u=i}return l===p&&g===u&&n-r<z.PI?"":(o=[e-s,i-s,e+s,i+s,l,g,p,u],c=a===N?' stroked="false" ':' strokeWeight="1px" strokeColor="'+a+'" ',d=h===N?' filled="false"':' fillColor="'+h+'" filled="true" ','<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'"  id="jqsshape'+t+'" '+c+d+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;"  path="m '+e+","+i+" wa "+o.join(", ")+' x e"> </v:shape>')},_drawRect:function(t,e,i,s,r,n,a){return this._drawShape(t,[[e,i],[e,i+r],[e+s,i+r],[e+s,i],[e,i]],n,a)},reset:function(){this.group.innerHTML=""},appendShape:function(t){var e=this["_draw"+t.type].apply(this,t.args);return this.rendered?this.group.insertAdjacentHTML("beforeEnd",e):this.prerender+=e,this.lastShapeId=t.id,t.id},replaceWithShape:function(t,e){var i=L("#jqsshape"+t),s=this["_draw"+e.type].apply(this,e.args);i[0].outerHTML=s},replaceWithShapes:function(t,e){for(var i=L("#jqsshape"+t[0]),s="",r=e.length,n=0;n<r;n++)s+=this["_draw"+e[n].type].apply(this,e[n].args);for(i[0].outerHTML=s,n=1;n<t.length;n++)L("#jqsshape"+t[n]).remove()},insertAfterShape:function(t,e){var i=L("#jqsshape"+t),s=this["_draw"+e.type].apply(this,e.args);i[0].insertAdjacentHTML("afterEnd",s)},removeShapeId:function(t){var e=L("#jqsshape"+t);this.group.removeChild(e[0])},getShapeAt:function(t,e,i){return t.id.substr(8)},render:function(){this.rendered||(this.group.innerHTML=this.prerender,this.rendered=!0)}})},"function"==typeof define&&define.amd?define(["jquery"],t):jQuery&&!jQuery.fn.sparkline&&t(jQuery)}(document,Math);
!function(g,I){"object"==typeof exports&&"object"==typeof module?module.exports=I():"function"==typeof define&&define.amd?define([],I):"object"==typeof exports?exports.Raphael=I():g.Raphael=I()}(window,function(){return d={"./dev/raphael.amd.js":function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(/*! ./raphael.core */ "./dev/raphael.core.js"), __webpack_require__(/*! ./raphael.svg */ "./dev/raphael.svg.js"), __webpack_require__(/*! ./raphael.vml */ "./dev/raphael.vml.js")], __WEBPACK_AMD_DEFINE_RESULT__ = (function(R) {\n\n    return R;\n\n}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9kZXYvcmFwaGFlbC5hbWQuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9SYXBoYWVsLy4vZGV2L3JhcGhhZWwuYW1kLmpzPzM1NjQiXSwic291cmNlc0NvbnRlbnQiOlsiZGVmaW5lKFtcIi4vcmFwaGFlbC5jb3JlXCIsIFwiLi9yYXBoYWVsLnN2Z1wiLCBcIi4vcmFwaGFlbC52bWxcIl0sIGZ1bmN0aW9uKFIpIHtcblxuICAgIHJldHVybiBSO1xuXG59KTsiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./dev/raphael.amd.js\n')},"./dev/raphael.core.js":function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(/*! eve */ "./node_modules/eve-raphael/eve.js")], __WEBPACK_AMD_DEFINE_RESULT__ = (function(eve) {\n\n    /*\\\n     * Raphael\n     [ method ]\n     **\n     * Creates a canvas object on which to draw.\n     * You must do this first, as all future calls to drawing methods\n     * from this instance will be bound to this canvas.\n     > Parameters\n     **\n     - container (HTMLElement|string) DOM element or its ID which is going to be a parent for drawing surface\n     - width (number)\n     - height (number)\n     - callback (function) #optional callback function which is going to be executed in the context of newly created paper\n     * or\n     - x (number)\n     - y (number)\n     - width (number)\n     - height (number)\n     - callback (function) #optional callback function which is going to be executed in the context of newly created paper\n     * or\n     - all (array) (first 3 or 4 elements in the array are equal to [containerID, width, height] or [x, y, width, height]. The rest are element descriptions in format {type: type, <attributes>}). See @Paper.add.\n     - callback (function) #optional callback function which is going to be executed in the context of newly created paper\n     * or\n     - onReadyCallback (function) function that is going to be called on DOM ready event. You can also subscribe to this event via Eve’s “DOMLoad” event. In this case method returns `undefined`.\n     = (object) @Paper\n     > Usage\n     | // Each of the following examples create a canvas\n     | // that is 320px wide by 200px high.\n     | // Canvas is created at the viewport’s 10,50 coordinate.\n     | var paper = Raphael(10, 50, 320, 200);\n     | // Canvas is created at the top left corner of the #notepad element\n     | // (or its top right corner in dir="rtl" elements)\n     | var paper = Raphael(document.getElementById("notepad"), 320, 200);\n     | // Same as above\n     | var paper = Raphael("notepad", 320, 200);\n     | // Image dump\n     | var set = Raphael(["notepad", 320, 200, {\n     |     type: "rect",\n     |     x: 10,\n     |     y: 10,\n     |     width: 25,\n     |     height: 25,\n     |     stroke: "#f00"\n     | }, {\n     |     type: "text",\n     |     x: 30,\n     |     y: 40,\n     |     text: "Dump"\n     | }]);\n    \\*/\n    function R(first) {\n        if (R.is(first, "function")) {\n            return loaded ? first() : eve.on("raphael.DOMload", first);\n        } else if (R.is(first, array)) {\n            return R._engine.create[apply](R, first.splice(0, 3 + R.is(first[0], nu))).add(first);\n        } else {\n            var args = Array.prototype.slice.call(arguments, 0);\n            if (R.is(args[args.length - 1], "function")) {\n                var f = args.pop();\n                return loaded ? f.call(R._engine.create[apply](R, args)) : eve.on("raphael.DOMload", function () {\n                    f.call(R._engine.create[apply](R, args));\n                });\n            } else {\n                return R._engine.create[apply](R, arguments);\n            }\n        }\n    }\n    R.version = "2.2.0";\n    R.eve = eve;\n    var loaded,\n        separator = /[, ]+/,\n        elements = {circle: 1, rect: 1, path: 1, ellipse: 1, text: 1, image: 1},\n        formatrg = /\\{(\\d+)\\}/g,\n        proto = "prototype",\n        has = "hasOwnProperty",\n        g = {\n            doc: document,\n            win: window\n        },\n        oldRaphael = {\n            was: Object.prototype[has].call(g.win, "Raphael"),\n            is: g.win.Raphael\n        },\n        Paper = function () {\n            /*\\\n             * Paper.ca\n             [ property (object) ]\n             **\n             * Shortcut for @Paper.customAttributes\n            \\*/\n            /*\\\n             * Paper.customAttributes\n             [ property (object) ]\n             **\n             * If you have a set of attributes that you would like to represent\n             * as a function of some number you can do it easily with custom attributes:\n             > Usage\n             | paper.customAttributes.hue = function (num) {\n             |     num = num % 1;\n             |     return {fill: "hsb(" + num + ", 0.75, 1)"};\n             | };\n             | // Custom attribute “hue” will change fill\n             | // to be given hue with fixed saturation and brightness.\n             | // Now you can use it like this:\n             | var c = paper.circle(10, 10, 10).attr({hue: .45});\n             | // or even like this:\n             | c.animate({hue: 1}, 1e3);\n             |\n             | // You could also create custom attribute\n             | // with multiple parameters:\n             | paper.customAttributes.hsb = function (h, s, b) {\n             |     return {fill: "hsb(" + [h, s, b].join(",") + ")"};\n             | };\n             | c.attr({hsb: "0.5 .8 1"});\n             | c.animate({hsb: [1, 0, 0.5]}, 1e3);\n            \\*/\n            this.ca = this.customAttributes = {};\n        },\n        paperproto,\n        appendChild = "appendChild",\n        apply = "apply",\n        concat = "concat",\n        //taken from Modernizr touch test: https://github.com/Modernizr/Modernizr/blob/master/feature-detects/touchevents.js#L40\n        supportsTouch = (\'ontouchstart\' in window) || window.TouchEvent || window.DocumentTouch && document instanceof DocumentTouch,\n        E = "",\n        S = " ",\n        Str = String,\n        split = "split",\n        events = "click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[split](S),\n        touchMap = {\n            mousedown: "touchstart",\n            mousemove: "touchmove",\n            mouseup: "touchend"\n        },\n        lowerCase = Str.prototype.toLowerCase,\n        math = Math,\n        mmax = math.max,\n        mmin = math.min,\n        abs = math.abs,\n        pow = math.pow,\n        PI = math.PI,\n        nu = "number",\n        string = "string",\n        array = "array",\n        toString = "toString",\n        fillString = "fill",\n        objectToString = Object.prototype.toString,\n        paper = {},\n        push = "push",\n        ISURL = R._ISURL = /^url\\([\'"]?(.+?)[\'"]?\\)$/i,\n        colourRegExp = /^\\s*((#[a-f\\d]{6})|(#[a-f\\d]{3})|rgba?\\(\\s*([\\d\\.]+%?\\s*,\\s*[\\d\\.]+%?\\s*,\\s*[\\d\\.]+%?(?:\\s*,\\s*[\\d\\.]+%?)?)\\s*\\)|hsba?\\(\\s*([\\d\\.]+(?:deg|\\xb0|%)?\\s*,\\s*[\\d\\.]+%?\\s*,\\s*[\\d\\.]+(?:%?\\s*,\\s*[\\d\\.]+)?)%?\\s*\\)|hsla?\\(\\s*([\\d\\.]+(?:deg|\\xb0|%)?\\s*,\\s*[\\d\\.]+%?\\s*,\\s*[\\d\\.]+(?:%?\\s*,\\s*[\\d\\.]+)?)%?\\s*\\))\\s*$/i,\n        isnan = {"NaN": 1, "Infinity": 1, "-Infinity": 1},\n        bezierrg = /^(?:cubic-)?bezier\\(([^,]+),([^,]+),([^,]+),([^\\)]+)\\)/,\n        round = math.round,\n        setAttribute = "setAttribute",\n        toFloat = parseFloat,\n        toInt = parseInt,\n        upperCase = Str.prototype.toUpperCase,\n        availableAttrs = R._availableAttrs = {\n            "arrow-end": "none",\n            "arrow-start": "none",\n            blur: 0,\n            "clip-rect": "0 0 1e9 1e9",\n            cursor: "default",\n            cx: 0,\n            cy: 0,\n            fill: "#fff",\n            "fill-opacity": 1,\n            font: \'10px "Arial"\',\n            "font-family": \'"Arial"\',\n            "font-size": "10",\n            "font-style": "normal",\n            "font-weight": 400,\n            gradient: 0,\n            height: 0,\n            href: "http://raphaeljs.com/",\n            "letter-spacing": 0,\n            opacity: 1,\n            path: "M0,0",\n            r: 0,\n            rx: 0,\n            ry: 0,\n            src: "",\n            stroke: "#000",\n            "stroke-dasharray": "",\n            "stroke-linecap": "butt",\n            "stroke-linejoin": "butt",\n            "stroke-miterlimit": 0,\n            "stroke-opacity": 1,\n            "stroke-width": 1,\n            target: "_blank",\n            "text-anchor": "middle",\n            title: "Raphael",\n            transform: "",\n            width: 0,\n            x: 0,\n            y: 0,\n            "class": ""\n        },\n        availableAnimAttrs = R._availableAnimAttrs = {\n            blur: nu,\n            "clip-rect": "csv",\n            cx: nu,\n            cy: nu,\n            fill: "colour",\n            "fill-opacity": nu,\n            "font-size": nu,\n            height: nu,\n            opacity: nu,\n            path: "path",\n            r: nu,\n            rx: nu,\n            ry: nu,\n            stroke: "colour",\n            "stroke-opacity": nu,\n            "stroke-width": nu,\n            transform: "transform",\n            width: nu,\n            x: nu,\n            y: nu\n        },\n        whitespace = /[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029]/g,\n        commaSpaces = /[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029]*,[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029]*/,\n        hsrg = {hs: 1, rg: 1},\n        p2s = /,?([achlmqrstvxz]),?/gi,\n        pathCommand = /([achlmrqstvz])[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029,]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029]*,?[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029]*)+)/ig,\n        tCommand = /([rstm])[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029,]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029]*,?[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029]*)+)/ig,\n        pathValues = /(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029]*,?[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029]*/ig,\n        radial_gradient = R._radial_gradient = /^r(?:\\(([^,]+?)[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029]*,[\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\xa0\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\u2028\\u2029]*([^\\)]+?)\\))?/,\n        eldata = {},\n        sortByKey = function (a, b) {\n            return a.key - b.key;\n        },\n        sortByNumber = function (a, b) {\n            return toFloat(a) - toFloat(b);\n        },\n        fun = function () {},\n        pipe = function (x) {\n            return x;\n        },\n        rectPath = R._rectPath = function (x, y, w, h, r) {\n            if (r) {\n                return [["M", x + r, y], ["l", w - r * 2, 0], ["a", r, r, 0, 0, 1, r, r], ["l", 0, h - r * 2], ["a", r, r, 0, 0, 1, -r, r], ["l", r * 2 - w, 0], ["a", r, r, 0, 0, 1, -r, -r], ["l", 0, r * 2 - h], ["a", r, r, 0, 0, 1, r, -r], ["z"]];\n            }\n            return [["M", x, y], ["l", w, 0], ["l", 0, h], ["l", -w, 0], ["z"]];\n        },\n        ellipsePath = function (x, y, rx, ry) {\n            if (ry == null) {\n                ry = rx;\n            }\n            return [["M", x, y], ["m", 0, -ry], ["a", rx, ry, 0, 1, 1, 0, 2 * ry], ["a", rx, ry, 0, 1, 1, 0, -2 * ry], ["z"]];\n        },\n        getPath = R._getPath = {\n            path: function (el) {\n                return el.attr("path");\n            },\n            circle: function (el) {\n                var a = el.attrs;\n                return ellipsePath(a.cx, a.cy, a.r);\n            },\n            ellipse: function (el) {\n                var a = el.attrs;\n                return ellipsePath(a.cx, a.cy, a.rx, a.ry);\n            },\n            rect: function (el) {\n                var a = el.attrs;\n                return rectPath(a.x, a.y, a.width, a.height, a.r);\n            },\n            image: function (el) {\n                var a = el.attrs;\n                return rectPath(a.x, a.y, a.width, a.height);\n            },\n            text: function (el) {\n                var bbox = el._getBBox();\n                return rectPath(bbox.x, bbox.y, bbox.width, bbox.height);\n            },\n            set : function(el) {\n                var bbox = el._getBBox();\n                return rectPath(bbox.x, bbox.y, bbox.width, bbox.height);\n            }\n        },\n        /*\\\n         * Raphael.mapPath\n         [ method ]\n         **\n         * Transform the path string with given matrix.\n         > Parameters\n         - path (string) path string\n         - matrix (object) see @Matrix\n         = (string) transformed path string\n        \\*/\n        mapPath = R.mapPath = function (path, matrix) {\n            if (!matrix) {\n                return path;\n            }\n            var x, y, i, j, ii, jj, pathi;\n            path = path2curve(path);\n            for (i = 0, ii = path.length; i < ii; i++) {\n                pathi = path[i];\n                for (j = 1, jj = pathi.length; j < jj; j += 2) {\n                    x = matrix.x(pathi[j], pathi[j + 1]);\n                    y = matrix.y(pathi[j], pathi[j + 1]);\n                    pathi[j] = x;\n                    pathi[j + 1] = y;\n                }\n            }\n            return path;\n        };\n\n    R._g = g;\n    /*\\\n     * Raphael.type\n     [ property (string) ]\n     **\n     * Can be “SVG”, “VML” or empty, depending on browser support.\n    \\*/\n    R.type = (g.win.SVGAngle || g.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure", "1.1") ? "SVG" : "VML");\n    if (R.type == "VML") {\n        var d = g.doc.createElement("div"),\n            b;\n        d.innerHTML = \'<v:shape adj="1"/>\';\n        b = d.firstChild;\n        b.style.behavior = "url(#default#VML)";\n        if (!(b && typeof b.adj == "object")) {\n            return (R.type = E);\n        }\n        d = null;\n    }\n    /*\\\n     * Raphael.svg\n     [ property (boolean) ]\n     **\n     * `true` if browser supports SVG.\n    \\*/\n    /*\\\n     * Raphael.vml\n     [ property (boolean) ]\n     **\n     * `true` if browser supports VML.\n    \\*/\n    R.svg = !(R.vml = R.type == "VML");\n    R._Paper = Paper;\n    /*\\\n     * Raphael.fn\n     [ property (object) ]\n     **\n     * You can add your own method to the canvas. For example if you want to draw a pie chart,\n     * you can create your own pie chart function and ship it as a Raphaël plugin. To do this\n     * you need to extend the `Raphael.fn` object. You should modify the `fn` object before a\n     * Raphaël instance is created, otherwise it will take no effect. Please note that the\n     * ability for namespaced plugins was removed in Raphael 2.0. It is up to the plugin to\n     * ensure any namespacing ensures proper context.\n     > Usage\n     | Raphael.fn.arrow = function (x1, y1, x2, y2, size) {\n     |     return this.path( ... );\n     | };\n     | // or create namespace\n     | Raphael.fn.mystuff = {\n     |     arrow: function () {…},\n     |     star: function () {…},\n     |     // etc…\n     | };\n     | var paper = Raphael(10, 10, 630, 480);\n     | // then use it\n     | paper.arrow(10, 10, 30, 30, 5).attr({fill: "#f00"});\n     | paper.mystuff.arrow();\n     | paper.mystuff.star();\n    \\*/\n    R.fn = paperproto = Paper.prototype = R.prototype;\n    R._id = 0;\n    /*\\\n     * Raphael.is\n     [ method ]\n     **\n     * Handful of replacements for `typeof` operator.\n     > Parameters\n     - o (…) any object or primitive\n     - type (string) name of the type, i.e. “string”, “function”, “number”, etc.\n     = (boolean) is given value is of given type\n    \\*/\n    R.is = function (o, type) {\n        type = lowerCase.call(type);\n        if (type == "finite") {\n            return !isnan[has](+o);\n        }\n        if (type == "array") {\n            return o instanceof Array;\n        }\n        return  (type == "null" && o === null) ||\n                (type == typeof o && o !== null) ||\n                (type == "object" && o === Object(o)) ||\n                (type == "array" && Array.isArray && Array.isArray(o)) ||\n                objectToString.call(o).slice(8, -1).toLowerCase() == type;\n    };\n\n    function clone(obj) {\n        if (typeof obj == "function" || Object(obj) !== obj) {\n            return obj;\n        }\n        var res = new obj.constructor;\n        for (var key in obj) if (obj[has](key)) {\n            res[key] = clone(obj[key]);\n        }\n        return res;\n    }\n\n    /*\\\n     * Raphael.angle\n     [ method ]\n     **\n     * Returns angle between two or three points\n     > Parameters\n     - x1 (number) x coord of first point\n     - y1 (number) y coord of first point\n     - x2 (number) x coord of second point\n     - y2 (number) y coord of second point\n     - x3 (number) #optional x coord of third point\n     - y3 (number) #optional y coord of third point\n     = (number) angle in degrees.\n    \\*/\n    R.angle = function (x1, y1, x2, y2, x3, y3) {\n        if (x3 == null) {\n            var x = x1 - x2,\n                y = y1 - y2;\n            if (!x && !y) {\n                return 0;\n            }\n            return (180 + math.atan2(-y, -x) * 180 / PI + 360) % 360;\n        } else {\n            return R.angle(x1, y1, x3, y3) - R.angle(x2, y2, x3, y3);\n        }\n    };\n    /*\\\n     * Raphael.rad\n     [ method ]\n     **\n     * Transform angle to radians\n     > Parameters\n     - deg (number) angle in degrees\n     = (number) angle in radians.\n    \\*/\n    R.rad = function (deg) {\n        return deg % 360 * PI / 180;\n    };\n    /*\\\n     * Raphael.deg\n     [ method ]\n     **\n     * Transform angle to degrees\n     > Parameters\n     - rad (number) angle in radians\n     = (number) angle in degrees.\n    \\*/\n    R.deg = function (rad) {\n        return Math.round ((rad * 180 / PI% 360)* 1000) / 1000;\n    };\n    /*\\\n     * Raphael.snapTo\n     [ method ]\n     **\n     * Snaps given value to given grid.\n     > Parameters\n     - values (array|number) given array of values or step of the grid\n     - value (number) value to adjust\n     - tolerance (number) #optional tolerance for snapping. Default is `10`.\n     = (number) adjusted value.\n    \\*/\n    R.snapTo = function (values, value, tolerance) {\n        tolerance = R.is(tolerance, "finite") ? tolerance : 10;\n        if (R.is(values, array)) {\n            var i = values.length;\n            while (i--) if (abs(values[i] - value) <= tolerance) {\n                return values[i];\n            }\n        } else {\n            values = +values;\n            var rem = value % values;\n            if (rem < tolerance) {\n                return value - rem;\n            }\n            if (rem > values - tolerance) {\n                return value - rem + values;\n            }\n        }\n        return value;\n    };\n\n    /*\\\n     * Raphael.createUUID\n     [ method ]\n     **\n     * Returns RFC4122, version 4 ID\n    \\*/\n    var createUUID = R.createUUID = (function (uuidRegEx, uuidReplacer) {\n        return function () {\n            return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(uuidRegEx, uuidReplacer).toUpperCase();\n        };\n    })(/[xy]/g, function (c) {\n        var r = math.random() * 16 | 0,\n            v = c == "x" ? r : (r & 3 | 8);\n        return v.toString(16);\n    });\n\n    /*\\\n     * Raphael.setWindow\n     [ method ]\n     **\n     * Used when you need to draw in `&lt;iframe>`. Switched window to the iframe one.\n     > Parameters\n     - newwin (window) new window object\n    \\*/\n    R.setWindow = function (newwin) {\n        eve("raphael.setWindow", R, g.win, newwin);\n        g.win = newwin;\n        g.doc = g.win.document;\n        if (R._engine.initWin) {\n            R._engine.initWin(g.win);\n        }\n    };\n    var toHex = function (color) {\n        if (R.vml) {\n            // http://dean.edwards.name/weblog/2009/10/convert-any-colour-value-to-hex-in-msie/\n            var trim = /^\\s+|\\s+$/g;\n            var bod;\n            try {\n                var docum = new ActiveXObject("htmlfile");\n                docum.write("<body>");\n                docum.close();\n                bod = docum.body;\n            } catch(e) {\n                bod = createPopup().document.body;\n            }\n            var range = bod.createTextRange();\n            toHex = cacher(function (color) {\n                try {\n                    bod.style.color = Str(color).replace(trim, E);\n                    var value = range.queryCommandValue("ForeColor");\n                    value = ((value & 255) << 16) | (value & 65280) | ((value & 16711680) >>> 16);\n                    return "#" + ("000000" + value.toString(16)).slice(-6);\n                } catch(e) {\n                    return "none";\n                }\n            });\n        } else {\n            var i = g.doc.createElement("i");\n            i.title = "Rapha\\xebl Colour Picker";\n            i.style.display = "none";\n            g.doc.body.appendChild(i);\n            toHex = cacher(function (color) {\n                i.style.color = color;\n                return g.doc.defaultView.getComputedStyle(i, E).getPropertyValue("color");\n            });\n        }\n        return toHex(color);\n    },\n    hsbtoString = function () {\n        return "hsb(" + [this.h, this.s, this.b] + ")";\n    },\n    hsltoString = function () {\n        return "hsl(" + [this.h, this.s, this.l] + ")";\n    },\n    rgbtoString = function () {\n        return this.hex;\n    },\n    prepareRGB = function (r, g, b) {\n        if (g == null && R.is(r, "object") && "r" in r && "g" in r && "b" in r) {\n            b = r.b;\n            g = r.g;\n            r = r.r;\n        }\n        if (g == null && R.is(r, string)) {\n            var clr = R.getRGB(r);\n            r = clr.r;\n            g = clr.g;\n            b = clr.b;\n        }\n        if (r > 1 || g > 1 || b > 1) {\n            r /= 255;\n            g /= 255;\n            b /= 255;\n        }\n\n        return [r, g, b];\n    },\n    packageRGB = function (r, g, b, o) {\n        r *= 255;\n        g *= 255;\n        b *= 255;\n        var rgb = {\n            r: r,\n            g: g,\n            b: b,\n            hex: R.rgb(r, g, b),\n            toString: rgbtoString\n        };\n        R.is(o, "finite") && (rgb.opacity = o);\n        return rgb;\n    };\n\n    /*\\\n     * Raphael.color\n     [ method ]\n     **\n     * Parses the color string and returns object with all values for the given color.\n     > Parameters\n     - clr (string) color string in one of the supported formats (see @Raphael.getRGB)\n     = (object) Combined RGB & HSB object in format:\n     o {\n     o     r (number) red,\n     o     g (number) green,\n     o     b (number) blue,\n     o     hex (string) color in HTML/CSS format: #••••••,\n     o     error (boolean) `true` if string can’t be parsed,\n     o     h (number) hue,\n     o     s (number) saturation,\n     o     v (number) value (brightness),\n     o     l (number) lightness\n     o }\n    \\*/\n    R.color = function (clr) {\n        var rgb;\n        if (R.is(clr, "object") && "h" in clr && "s" in clr && "b" in clr) {\n            rgb = R.hsb2rgb(clr);\n            clr.r = rgb.r;\n            clr.g = rgb.g;\n            clr.b = rgb.b;\n            clr.hex = rgb.hex;\n        } else if (R.is(clr, "object") && "h" in clr && "s" in clr && "l" in clr) {\n            rgb = R.hsl2rgb(clr);\n            clr.r = rgb.r;\n            clr.g = rgb.g;\n            clr.b = rgb.b;\n            clr.hex = rgb.hex;\n        } else {\n            if (R.is(clr, "string")) {\n                clr = R.getRGB(clr);\n            }\n            if (R.is(clr, "object") && "r" in clr && "g" in clr && "b" in clr) {\n                rgb = R.rgb2hsl(clr);\n                clr.h = rgb.h;\n                clr.s = rgb.s;\n                clr.l = rgb.l;\n                rgb = R.rgb2hsb(clr);\n                clr.v = rgb.b;\n            } else {\n                clr = {hex: "none"};\n                clr.r = clr.g = clr.b = clr.h = clr.s = clr.v = clr.l = -1;\n            }\n        }\n        clr.toString = rgbtoString;\n        return clr;\n    };\n    /*\\\n     * Raphael.hsb2rgb\n     [ method ]\n     **\n     * Converts HSB values to RGB object.\n     > Parameters\n     - h (number) hue\n     - s (number) saturation\n     - v (number) value or brightness\n     = (object) RGB object in format:\n     o {\n     o     r (number) red,\n     o     g (number) green,\n     o     b (number) blue,\n     o     hex (string) color in HTML/CSS format: #••••••\n     o }\n    \\*/\n    R.hsb2rgb = function (h, s, v, o) {\n        if (this.is(h, "object") && "h" in h && "s" in h && "b" in h) {\n            v = h.b;\n            s = h.s;\n            o = h.o;\n            h = h.h;\n        }\n        h *= 360;\n        var R, G, B, X, C;\n        h = (h % 360) / 60;\n        C = v * s;\n        X = C * (1 - abs(h % 2 - 1));\n        R = G = B = v - C;\n\n        h = ~~h;\n        R += [C, X, 0, 0, X, C][h];\n        G += [X, C, C, X, 0, 0][h];\n        B += [0, 0, X, C, C, X][h];\n        return packageRGB(R, G, B, o);\n    };\n    /*\\\n     * Raphael.hsl2rgb\n     [ method ]\n     **\n     * Converts HSL values to RGB object.\n     > Parameters\n     - h (number) hue\n     - s (number) saturation\n     - l (number) luminosity\n     = (object) RGB object in format:\n     o {\n     o     r (number) red,\n     o     g (number) green,\n     o     b (number) blue,\n     o     hex (string) color in HTML/CSS format: #••••••\n     o }\n    \\*/\n    R.hsl2rgb = function (h, s, l, o) {\n        if (this.is(h, "object") && "h" in h && "s" in h && "l" in h) {\n            l = h.l;\n            s = h.s;\n            h = h.h;\n        }\n        if (h > 1 || s > 1 || l > 1) {\n            h /= 360;\n            s /= 100;\n            l /= 100;\n        }\n        h *= 360;\n        var R, G, B, X, C;\n        h = (h % 360) / 60;\n        C = 2 * s * (l < .5 ? l : 1 - l);\n        X = C * (1 - abs(h % 2 - 1));\n        R = G = B = l - C / 2;\n\n        h = ~~h;\n        R += [C, X, 0, 0, X, C][h];\n        G += [X, C, C, X, 0, 0][h];\n        B += [0, 0, X, C, C, X][h];\n        return packageRGB(R, G, B, o);\n    };\n    /*\\\n     * Raphael.rgb2hsb\n     [ method ]\n     **\n     * Converts RGB values to HSB object.\n     > Parameters\n     - r (number) red\n     - g (number) green\n     - b (number) blue\n     = (object) HSB object in format:\n     o {\n     o     h (number) hue\n     o     s (number) saturation\n     o     b (number) brightness\n     o }\n    \\*/\n    R.rgb2hsb = function (r, g, b) {\n        b = prepareRGB(r, g, b);\n        r = b[0];\n        g = b[1];\n        b = b[2];\n\n        var H, S, V, C;\n        V = mmax(r, g, b);\n        C = V - mmin(r, g, b);\n        H = (C == 0 ? null :\n             V == r ? (g - b) / C :\n             V == g ? (b - r) / C + 2 :\n                      (r - g) / C + 4\n            );\n        H = ((H + 360) % 6) * 60 / 360;\n        S = C == 0 ? 0 : C / V;\n        return {h: H, s: S, b: V, toString: hsbtoString};\n    };\n    /*\\\n     * Raphael.rgb2hsl\n     [ method ]\n     **\n     * Converts RGB values to HSL object.\n     > Parameters\n     - r (number) red\n     - g (number) green\n     - b (number) blue\n     = (object) HSL object in format:\n     o {\n     o     h (number) hue\n     o     s (number) saturation\n     o     l (number) luminosity\n     o }\n    \\*/\n    R.rgb2hsl = function (r, g, b) {\n        b = prepareRGB(r, g, b);\n        r = b[0];\n        g = b[1];\n        b = b[2];\n\n        var H, S, L, M, m, C;\n        M = mmax(r, g, b);\n        m = mmin(r, g, b);\n        C = M - m;\n        H = (C == 0 ? null :\n             M == r ? (g - b) / C :\n             M == g ? (b - r) / C + 2 :\n                      (r - g) / C + 4);\n        H = ((H + 360) % 6) * 60 / 360;\n        L = (M + m) / 2;\n        S = (C == 0 ? 0 :\n             L < .5 ? C / (2 * L) :\n                      C / (2 - 2 * L));\n        return {h: H, s: S, l: L, toString: hsltoString};\n    };\n    R._path2string = function () {\n        return this.join(",").replace(p2s, "$1");\n    };\n    function repush(array, item) {\n        for (var i = 0, ii = array.length; i < ii; i++) if (array[i] === item) {\n            return array.push(array.splice(i, 1)[0]);\n        }\n    }\n    function cacher(f, scope, postprocessor) {\n        function newf() {\n            var arg = Array.prototype.slice.call(arguments, 0),\n                args = arg.join("\\u2400"),\n                cache = newf.cache = newf.cache || {},\n                count = newf.count = newf.count || [];\n            if (cache[has](args)) {\n                repush(count, args);\n                return postprocessor ? postprocessor(cache[args]) : cache[args];\n            }\n            count.length >= 1e3 && delete cache[count.shift()];\n            count.push(args);\n            cache[args] = f[apply](scope, arg);\n            return postprocessor ? postprocessor(cache[args]) : cache[args];\n        }\n        return newf;\n    }\n\n    var preload = R._preload = function (src, f) {\n        var img = g.doc.createElement("img");\n        img.style.cssText = "position:absolute;left:-9999em;top:-9999em";\n        img.onload = function () {\n            f.call(this);\n            this.onload = null;\n            g.doc.body.removeChild(this);\n        };\n        img.onerror = function () {\n            g.doc.body.removeChild(this);\n        };\n        g.doc.body.appendChild(img);\n        img.src = src;\n    };\n\n    function clrToString() {\n        return this.hex;\n    }\n\n    /*\\\n     * Raphael.getRGB\n     [ method ]\n     **\n     * Parses colour string as RGB object\n     > Parameters\n     - colour (string) colour string in one of formats:\n     # <ul>\n     #     <li>Colour name (“<code>red</code>”, “<code>green</code>”, “<code>cornflowerblue</code>”, etc)</li>\n     #     <li>#••• — shortened HTML colour: (“<code>#000</code>”, “<code>#fc0</code>”, etc)</li>\n     #     <li>#•••••• — full length HTML colour: (“<code>#000000</code>”, “<code>#bd2300</code>”)</li>\n     #     <li>rgb(•••, •••, •••) — red, green and blue channels’ values: (“<code>rgb(200,&nbsp;100,&nbsp;0)</code>”)</li>\n     #     <li>rgb(•••%, •••%, •••%) — same as above, but in %: (“<code>rgb(100%,&nbsp;175%,&nbsp;0%)</code>”)</li>\n     #     <li>hsb(•••, •••, •••) — hue, saturation and brightness values: (“<code>hsb(0.5,&nbsp;0.25,&nbsp;1)</code>”)</li>\n     #     <li>hsb(•••%, •••%, •••%) — same as above, but in %</li>\n     #     <li>hsl(•••, •••, •••) — same as hsb</li>\n     #     <li>hsl(•••%, •••%, •••%) — same as hsb</li>\n     # </ul>\n     = (object) RGB object in format:\n     o {\n     o     r (number) red,\n     o     g (number) green,\n     o     b (number) blue\n     o     hex (string) color in HTML/CSS format: #••••••,\n     o     error (boolean) true if string can’t be parsed\n     o }\n    \\*/\n    R.getRGB = cacher(function (colour) {\n        if (!colour || !!((colour = Str(colour)).indexOf("-") + 1)) {\n            return {r: -1, g: -1, b: -1, hex: "none", error: 1, toString: clrToString};\n        }\n        if (colour == "none") {\n            return {r: -1, g: -1, b: -1, hex: "none", toString: clrToString};\n        }\n        !(hsrg[has](colour.toLowerCase().substring(0, 2)) || colour.charAt() == "#") && (colour = toHex(colour));\n        var res,\n            red,\n            green,\n            blue,\n            opacity,\n            t,\n            values,\n            rgb = colour.match(colourRegExp);\n        if (rgb) {\n            if (rgb[2]) {\n                blue = toInt(rgb[2].substring(5), 16);\n                green = toInt(rgb[2].substring(3, 5), 16);\n                red = toInt(rgb[2].substring(1, 3), 16);\n            }\n            if (rgb[3]) {\n                blue = toInt((t = rgb[3].charAt(3)) + t, 16);\n                green = toInt((t = rgb[3].charAt(2)) + t, 16);\n                red = toInt((t = rgb[3].charAt(1)) + t, 16);\n            }\n            if (rgb[4]) {\n                values = rgb[4][split](commaSpaces);\n                red = toFloat(values[0]);\n                values[0].slice(-1) == "%" && (red *= 2.55);\n                green = toFloat(values[1]);\n                values[1].slice(-1) == "%" && (green *= 2.55);\n                blue = toFloat(values[2]);\n                values[2].slice(-1) == "%" && (blue *= 2.55);\n                rgb[1].toLowerCase().slice(0, 4) == "rgba" && (opacity = toFloat(values[3]));\n                values[3] && values[3].slice(-1) == "%" && (opacity /= 100);\n            }\n            if (rgb[5]) {\n                values = rgb[5][split](commaSpaces);\n                red = toFloat(values[0]);\n                values[0].slice(-1) == "%" && (red *= 2.55);\n                green = toFloat(values[1]);\n                values[1].slice(-1) == "%" && (green *= 2.55);\n                blue = toFloat(values[2]);\n                values[2].slice(-1) == "%" && (blue *= 2.55);\n                (values[0].slice(-3) == "deg" || values[0].slice(-1) == "\\xb0") && (red /= 360);\n                rgb[1].toLowerCase().slice(0, 4) == "hsba" && (opacity = toFloat(values[3]));\n                values[3] && values[3].slice(-1) == "%" && (opacity /= 100);\n                return R.hsb2rgb(red, green, blue, opacity);\n            }\n            if (rgb[6]) {\n                values = rgb[6][split](commaSpaces);\n                red = toFloat(values[0]);\n                values[0].slice(-1) == "%" && (red *= 2.55);\n                green = toFloat(values[1]);\n                values[1].slice(-1) == "%" && (green *= 2.55);\n                blue = toFloat(values[2]);\n                values[2].slice(-1) == "%" && (blue *= 2.55);\n                (values[0].slice(-3) == "deg" || values[0].slice(-1) == "\\xb0") && (red /= 360);\n                rgb[1].toLowerCase().slice(0, 4) == "hsla" && (opacity = toFloat(values[3]));\n                values[3] && values[3].slice(-1) == "%" && (opacity /= 100);\n                return R.hsl2rgb(red, green, blue, opacity);\n            }\n            rgb = {r: red, g: green, b: blue, toString: clrToString};\n            rgb.hex = "#" + (16777216 | blue | (green << 8) | (red << 16)).toString(16).slice(1);\n            R.is(opacity, "finite") && (rgb.opacity = opacity);\n            return rgb;\n        }\n        return {r: -1, g: -1, b: -1, hex: "none", error: 1, toString: clrToString};\n    }, R);\n    /*\\\n     * Raphael.hsb\n     [ method ]\n     **\n     * Converts HSB values to hex representation of the colour.\n     > Parameters\n     - h (number) hue\n     - s (number) saturation\n     - b (number) value or brightness\n     = (string) hex representation of the colour.\n    \\*/\n    R.hsb = cacher(function (h, s, b) {\n        return R.hsb2rgb(h, s, b).hex;\n    });\n    /*\\\n     * Raphael.hsl\n     [ method ]\n     **\n     * Converts HSL values to hex representation of the colour.\n     > Parameters\n     - h (number) hue\n     - s (number) saturation\n     - l (number) luminosity\n     = (string) hex representation of the colour.\n    \\*/\n    R.hsl = cacher(function (h, s, l) {\n        return R.hsl2rgb(h, s, l).hex;\n    });\n    /*\\\n     * Raphael.rgb\n     [ method ]\n     **\n     * Converts RGB values to hex representation of the colour.\n     > Parameters\n     - r (number) red\n     - g (number) green\n     - b (number) blue\n     = (string) hex representation of the colour.\n    \\*/\n    R.rgb = cacher(function (r, g, b) {\n        function round(x) { return (x + 0.5) | 0; }\n        return "#" + (16777216 | round(b) | (round(g) << 8) | (round(r) << 16)).toString(16).slice(1);\n    });\n    /*\\\n     * Raphael.getColor\n     [ method ]\n     **\n     * On each call returns next colour in the spectrum. To reset it back to red call @Raphael.getColor.reset\n     > Parameters\n     - value (number) #optional brightness, default is `0.75`\n     = (string) hex representation of the colour.\n    \\*/\n    R.getColor = function (value) {\n        var start = this.getColor.start = this.getColor.start || {h: 0, s: 1, b: value || .75},\n            rgb = this.hsb2rgb(start.h, start.s, start.b);\n        start.h += .075;\n        if (start.h > 1) {\n            start.h = 0;\n            start.s -= .2;\n            start.s <= 0 && (this.getColor.start = {h: 0, s: 1, b: start.b});\n        }\n        return rgb.hex;\n    };\n    /*\\\n     * Raphael.getColor.reset\n     [ method ]\n     **\n     * Resets spectrum position for @Raphael.getColor back to red.\n    \\*/\n    R.getColor.reset = function () {\n        delete this.start;\n    };\n\n    // http://schepers.cc/getting-to-the-point\n    function catmullRom2bezier(crp, z) {\n        var d = [];\n        for (var i = 0, iLen = crp.length; iLen - 2 * !z > i; i += 2) {\n            var p = [\n                        {x: +crp[i - 2], y: +crp[i - 1]},\n                        {x: +crp[i],     y: +crp[i + 1]},\n                        {x: +crp[i + 2], y: +crp[i + 3]},\n                        {x: +crp[i + 4], y: +crp[i + 5]}\n                    ];\n            if (z) {\n                if (!i) {\n                    p[0] = {x: +crp[iLen - 2], y: +crp[iLen - 1]};\n                } else if (iLen - 4 == i) {\n                    p[3] = {x: +crp[0], y: +crp[1]};\n                } else if (iLen - 2 == i) {\n                    p[2] = {x: +crp[0], y: +crp[1]};\n                    p[3] = {x: +crp[2], y: +crp[3]};\n                }\n            } else {\n                if (iLen - 4 == i) {\n                    p[3] = p[2];\n                } else if (!i) {\n                    p[0] = {x: +crp[i], y: +crp[i + 1]};\n                }\n            }\n            d.push(["C",\n                  (-p[0].x + 6 * p[1].x + p[2].x) / 6,\n                  (-p[0].y + 6 * p[1].y + p[2].y) / 6,\n                  (p[1].x + 6 * p[2].x - p[3].x) / 6,\n                  (p[1].y + 6*p[2].y - p[3].y) / 6,\n                  p[2].x,\n                  p[2].y\n            ]);\n        }\n\n        return d;\n    }\n    /*\\\n     * Raphael.parsePathString\n     [ method ]\n     **\n     * Utility method\n     **\n     * Parses given path string into an array of arrays of path segments.\n     > Parameters\n     - pathString (string|array) path string or array of segments (in the last case it will be returned straight away)\n     = (array) array of segments.\n    \\*/\n    R.parsePathString = function (pathString) {\n        if (!pathString) {\n            return null;\n        }\n        var pth = paths(pathString);\n        if (pth.arr) {\n            return pathClone(pth.arr);\n        }\n\n        var paramCounts = {a: 7, c: 6, h: 1, l: 2, m: 2, r: 4, q: 4, s: 4, t: 2, v: 1, z: 0},\n            data = [];\n        if (R.is(pathString, array) && R.is(pathString[0], array)) { // rough assumption\n            data = pathClone(pathString);\n        }\n        if (!data.length) {\n            Str(pathString).replace(pathCommand, function (a, b, c) {\n                var params = [],\n                    name = b.toLowerCase();\n                c.replace(pathValues, function (a, b) {\n                    b && params.push(+b);\n                });\n                if (name == "m" && params.length > 2) {\n                    data.push([b][concat](params.splice(0, 2)));\n                    name = "l";\n                    b = b == "m" ? "l" : "L";\n                }\n                if (name == "r") {\n                    data.push([b][concat](params));\n                } else while (params.length >= paramCounts[name]) {\n                    data.push([b][concat](params.splice(0, paramCounts[name])));\n                    if (!paramCounts[name]) {\n                        break;\n                    }\n                }\n            });\n        }\n        data.toString = R._path2string;\n        pth.arr = pathClone(data);\n        return data;\n    };\n    /*\\\n     * Raphael.parseTransformString\n     [ method ]\n     **\n     * Utility method\n     **\n     * Parses given path string into an array of transformations.\n     > Parameters\n     - TString (string|array) transform string or array of transformations (in the last case it will be returned straight away)\n     = (array) array of transformations.\n    \\*/\n    R.parseTransformString = cacher(function (TString) {\n        if (!TString) {\n            return null;\n        }\n        var paramCounts = {r: 3, s: 4, t: 2, m: 6},\n            data = [];\n        if (R.is(TString, array) && R.is(TString[0], array)) { // rough assumption\n            data = pathClone(TString);\n        }\n        if (!data.length) {\n            Str(TString).replace(tCommand, function (a, b, c) {\n                var params = [],\n                    name = lowerCase.call(b);\n                c.replace(pathValues, function (a, b) {\n                    b && params.push(+b);\n                });\n                data.push([b][concat](params));\n            });\n        }\n        data.toString = R._path2string;\n        return data;\n    }, this, function(elem) {\n        if (!elem) return elem;\n        var newData = [];\n        for (var i = 0; i < elem.length; i++) {\n            var newLevel = [];\n            for (var j = 0; j < elem[i].length; j++) {\n                newLevel.push(elem[i][j]);\n            }\n            newData.push(newLevel);\n        }\n      return newData; } );\n    // PATHS\n    var paths = function (ps) {\n        var p = paths.ps = paths.ps || {};\n        if (p[ps]) {\n            p[ps].sleep = 100;\n        } else {\n            p[ps] = {\n                sleep: 100\n            };\n        }\n        setTimeout(function () {\n            for (var key in p) if (p[has](key) && key != ps) {\n                p[key].sleep--;\n                !p[key].sleep && delete p[key];\n            }\n        });\n        return p[ps];\n    };\n    /*\\\n     * Raphael.findDotsAtSegment\n     [ method ]\n     **\n     * Utility method\n     **\n     * Find dot coordinates on the given cubic bezier curve at the given t.\n     > Parameters\n     - p1x (number) x of the first point of the curve\n     - p1y (number) y of the first point of the curve\n     - c1x (number) x of the first anchor of the curve\n     - c1y (number) y of the first anchor of the curve\n     - c2x (number) x of the second anchor of the curve\n     - c2y (number) y of the second anchor of the curve\n     - p2x (number) x of the second point of the curve\n     - p2y (number) y of the second point of the curve\n     - t (number) position on the curve (0..1)\n     = (object) point information in format:\n     o {\n     o     x: (number) x coordinate of the point\n     o     y: (number) y coordinate of the point\n     o     m: {\n     o         x: (number) x coordinate of the left anchor\n     o         y: (number) y coordinate of the left anchor\n     o     }\n     o     n: {\n     o         x: (number) x coordinate of the right anchor\n     o         y: (number) y coordinate of the right anchor\n     o     }\n     o     start: {\n     o         x: (number) x coordinate of the start of the curve\n     o         y: (number) y coordinate of the start of the curve\n     o     }\n     o     end: {\n     o         x: (number) x coordinate of the end of the curve\n     o         y: (number) y coordinate of the end of the curve\n     o     }\n     o     alpha: (number) angle of the curve derivative at the point\n     o }\n    \\*/\n    R.findDotsAtSegment = function (p1x, p1y, c1x, c1y, c2x, c2y, p2x, p2y, t) {\n        var t1 = 1 - t,\n            t13 = pow(t1, 3),\n            t12 = pow(t1, 2),\n            t2 = t * t,\n            t3 = t2 * t,\n            x = t13 * p1x + t12 * 3 * t * c1x + t1 * 3 * t * t * c2x + t3 * p2x,\n            y = t13 * p1y + t12 * 3 * t * c1y + t1 * 3 * t * t * c2y + t3 * p2y,\n            mx = p1x + 2 * t * (c1x - p1x) + t2 * (c2x - 2 * c1x + p1x),\n            my = p1y + 2 * t * (c1y - p1y) + t2 * (c2y - 2 * c1y + p1y),\n            nx = c1x + 2 * t * (c2x - c1x) + t2 * (p2x - 2 * c2x + c1x),\n            ny = c1y + 2 * t * (c2y - c1y) + t2 * (p2y - 2 * c2y + c1y),\n            ax = t1 * p1x + t * c1x,\n            ay = t1 * p1y + t * c1y,\n            cx = t1 * c2x + t * p2x,\n            cy = t1 * c2y + t * p2y,\n            alpha = (90 - math.atan2(mx - nx, my - ny) * 180 / PI);\n        (mx > nx || my < ny) && (alpha += 180);\n        return {\n            x: x,\n            y: y,\n            m: {x: mx, y: my},\n            n: {x: nx, y: ny},\n            start: {x: ax, y: ay},\n            end: {x: cx, y: cy},\n            alpha: alpha\n        };\n    };\n    /*\\\n     * Raphael.bezierBBox\n     [ method ]\n     **\n     * Utility method\n     **\n     * Return bounding box of a given cubic bezier curve\n     > Parameters\n     - p1x (number) x of the first point of the curve\n     - p1y (number) y of the first point of the curve\n     - c1x (number) x of the first anchor of the curve\n     - c1y (number) y of the first anchor of the curve\n     - c2x (number) x of the second anchor of the curve\n     - c2y (number) y of the second anchor of the curve\n     - p2x (number) x of the second point of the curve\n     - p2y (number) y of the second point of the curve\n     * or\n     - bez (array) array of six points for bezier curve\n     = (object) point information in format:\n     o {\n     o     min: {\n     o         x: (number) x coordinate of the left point\n     o         y: (number) y coordinate of the top point\n     o     }\n     o     max: {\n     o         x: (number) x coordinate of the right point\n     o         y: (number) y coordinate of the bottom point\n     o     }\n     o }\n    \\*/\n    R.bezierBBox = function (p1x, p1y, c1x, c1y, c2x, c2y, p2x, p2y) {\n        if (!R.is(p1x, "array")) {\n            p1x = [p1x, p1y, c1x, c1y, c2x, c2y, p2x, p2y];\n        }\n        var bbox = curveDim.apply(null, p1x);\n        return {\n            x: bbox.min.x,\n            y: bbox.min.y,\n            x2: bbox.max.x,\n            y2: bbox.max.y,\n            width: bbox.max.x - bbox.min.x,\n            height: bbox.max.y - bbox.min.y\n        };\n    };\n    /*\\\n     * Raphael.isPointInsideBBox\n     [ method ]\n     **\n     * Utility method\n     **\n     * Returns `true` if given point is inside bounding boxes.\n     > Parameters\n     - bbox (string) bounding box\n     - x (string) x coordinate of the point\n     - y (string) y coordinate of the point\n     = (boolean) `true` if point inside\n    \\*/\n    R.isPointInsideBBox = function (bbox, x, y) {\n        return x >= bbox.x && x <= bbox.x2 && y >= bbox.y && y <= bbox.y2;\n    };\n    /*\\\n     * Raphael.isBBoxIntersect\n     [ method ]\n     **\n     * Utility method\n     **\n     * Returns `true` if two bounding boxes intersect\n     > Parameters\n     - bbox1 (string) first bounding box\n     - bbox2 (string) second bounding box\n     = (boolean) `true` if they intersect\n    \\*/\n    R.isBBoxIntersect = function (bbox1, bbox2) {\n        var i = R.isPointInsideBBox;\n        return i(bbox2, bbox1.x, bbox1.y)\n            || i(bbox2, bbox1.x2, bbox1.y)\n            || i(bbox2, bbox1.x, bbox1.y2)\n            || i(bbox2, bbox1.x2, bbox1.y2)\n            || i(bbox1, bbox2.x, bbox2.y)\n            || i(bbox1, bbox2.x2, bbox2.y)\n            || i(bbox1, bbox2.x, bbox2.y2)\n            || i(bbox1, bbox2.x2, bbox2.y2)\n            || (bbox1.x < bbox2.x2 && bbox1.x > bbox2.x || bbox2.x < bbox1.x2 && bbox2.x > bbox1.x)\n            && (bbox1.y < bbox2.y2 && bbox1.y > bbox2.y || bbox2.y < bbox1.y2 && bbox2.y > bbox1.y);\n    };\n    function base3(t, p1, p2, p3, p4) {\n        var t1 = -3 * p1 + 9 * p2 - 9 * p3 + 3 * p4,\n            t2 = t * t1 + 6 * p1 - 12 * p2 + 6 * p3;\n        return t * t2 - 3 * p1 + 3 * p2;\n    }\n    function bezlen(x1, y1, x2, y2, x3, y3, x4, y4, z) {\n        if (z == null) {\n            z = 1;\n        }\n        z = z > 1 ? 1 : z < 0 ? 0 : z;\n        var z2 = z / 2,\n            n = 12,\n            Tvalues = [-0.1252,0.1252,-0.3678,0.3678,-0.5873,0.5873,-0.7699,0.7699,-0.9041,0.9041,-0.9816,0.9816],\n            Cvalues = [0.2491,0.2491,0.2335,0.2335,0.2032,0.2032,0.1601,0.1601,0.1069,0.1069,0.0472,0.0472],\n            sum = 0;\n        for (var i = 0; i < n; i++) {\n            var ct = z2 * Tvalues[i] + z2,\n                xbase = base3(ct, x1, x2, x3, x4),\n                ybase = base3(ct, y1, y2, y3, y4),\n                comb = xbase * xbase + ybase * ybase;\n            sum += Cvalues[i] * math.sqrt(comb);\n        }\n        return z2 * sum;\n    }\n    function getTatLen(x1, y1, x2, y2, x3, y3, x4, y4, ll) {\n        if (ll < 0 || bezlen(x1, y1, x2, y2, x3, y3, x4, y4) < ll) {\n            return;\n        }\n        var t = 1,\n            step = t / 2,\n            t2 = t - step,\n            l,\n            e = .01;\n        l = bezlen(x1, y1, x2, y2, x3, y3, x4, y4, t2);\n        while (abs(l - ll) > e) {\n            step /= 2;\n            t2 += (l < ll ? 1 : -1) * step;\n            l = bezlen(x1, y1, x2, y2, x3, y3, x4, y4, t2);\n        }\n        return t2;\n    }\n    function intersect(x1, y1, x2, y2, x3, y3, x4, y4) {\n        if (\n            mmax(x1, x2) < mmin(x3, x4) ||\n            mmin(x1, x2) > mmax(x3, x4) ||\n            mmax(y1, y2) < mmin(y3, y4) ||\n            mmin(y1, y2) > mmax(y3, y4)\n        ) {\n            return;\n        }\n        var nx = (x1 * y2 - y1 * x2) * (x3 - x4) - (x1 - x2) * (x3 * y4 - y3 * x4),\n            ny = (x1 * y2 - y1 * x2) * (y3 - y4) - (y1 - y2) * (x3 * y4 - y3 * x4),\n            denominator = (x1 - x2) * (y3 - y4) - (y1 - y2) * (x3 - x4);\n\n        if (!denominator) {\n            return;\n        }\n        var px = nx / denominator,\n            py = ny / denominator,\n            px2 = +px.toFixed(2),\n            py2 = +py.toFixed(2);\n        if (\n            px2 < +mmin(x1, x2).toFixed(2) ||\n            px2 > +mmax(x1, x2).toFixed(2) ||\n            px2 < +mmin(x3, x4).toFixed(2) ||\n            px2 > +mmax(x3, x4).toFixed(2) ||\n            py2 < +mmin(y1, y2).toFixed(2) ||\n            py2 > +mmax(y1, y2).toFixed(2) ||\n            py2 < +mmin(y3, y4).toFixed(2) ||\n            py2 > +mmax(y3, y4).toFixed(2)\n        ) {\n            return;\n        }\n        return {x: px, y: py};\n    }\n    function inter(bez1, bez2) {\n        return interHelper(bez1, bez2);\n    }\n    function interCount(bez1, bez2) {\n        return interHelper(bez1, bez2, 1);\n    }\n    function interHelper(bez1, bez2, justCount) {\n        var bbox1 = R.bezierBBox(bez1),\n            bbox2 = R.bezierBBox(bez2);\n        if (!R.isBBoxIntersect(bbox1, bbox2)) {\n            return justCount ? 0 : [];\n        }\n        var l1 = bezlen.apply(0, bez1),\n            l2 = bezlen.apply(0, bez2),\n            n1 = mmax(~~(l1 / 5), 1),\n            n2 = mmax(~~(l2 / 5), 1),\n            dots1 = [],\n            dots2 = [],\n            xy = {},\n            res = justCount ? 0 : [];\n        for (var i = 0; i < n1 + 1; i++) {\n            var p = R.findDotsAtSegment.apply(R, bez1.concat(i / n1));\n            dots1.push({x: p.x, y: p.y, t: i / n1});\n        }\n        for (i = 0; i < n2 + 1; i++) {\n            p = R.findDotsAtSegment.apply(R, bez2.concat(i / n2));\n            dots2.push({x: p.x, y: p.y, t: i / n2});\n        }\n        for (i = 0; i < n1; i++) {\n            for (var j = 0; j < n2; j++) {\n                var di = dots1[i],\n                    di1 = dots1[i + 1],\n                    dj = dots2[j],\n                    dj1 = dots2[j + 1],\n                    ci = abs(di1.x - di.x) < .001 ? "y" : "x",\n                    cj = abs(dj1.x - dj.x) < .001 ? "y" : "x",\n                    is = intersect(di.x, di.y, di1.x, di1.y, dj.x, dj.y, dj1.x, dj1.y);\n                if (is) {\n                    if (xy[is.x.toFixed(4)] == is.y.toFixed(4)) {\n                        continue;\n                    }\n                    xy[is.x.toFixed(4)] = is.y.toFixed(4);\n                    var t1 = di.t + abs((is[ci] - di[ci]) / (di1[ci] - di[ci])) * (di1.t - di.t),\n                        t2 = dj.t + abs((is[cj] - dj[cj]) / (dj1[cj] - dj[cj])) * (dj1.t - dj.t);\n                    if (t1 >= 0 && t1 <= 1.001 && t2 >= 0 && t2 <= 1.001) {\n                        if (justCount) {\n                            res++;\n                        } else {\n                            res.push({\n                                x: is.x,\n                                y: is.y,\n                                t1: mmin(t1, 1),\n                                t2: mmin(t2, 1)\n                            });\n                        }\n                    }\n                }\n            }\n        }\n        return res;\n    }\n    /*\\\n     * Raphael.pathIntersection\n     [ method ]\n     **\n     * Utility method\n     **\n     * Finds intersections of two paths\n     > Parameters\n     - path1 (string) path string\n     - path2 (string) path string\n     = (array) dots of intersection\n     o [\n     o     {\n     o         x: (number) x coordinate of the point\n     o         y: (number) y coordinate of the point\n     o         t1: (number) t value for segment of path1\n     o         t2: (number) t value for segment of path2\n     o         segment1: (number) order number for segment of path1\n     o         segment2: (number) order number for segment of path2\n     o         bez1: (array) eight coordinates representing beziér curve for the segment of path1\n     o         bez2: (array) eight coordinates representing beziér curve for the segment of path2\n     o     }\n     o ]\n    \\*/\n    R.pathIntersection = function (path1, path2) {\n        return interPathHelper(path1, path2);\n    };\n    R.pathIntersectionNumber = function (path1, path2) {\n        return interPathHelper(path1, path2, 1);\n    };\n    function interPathHelper(path1, path2, justCount) {\n        path1 = R._path2curve(path1);\n        path2 = R._path2curve(path2);\n        var x1, y1, x2, y2, x1m, y1m, x2m, y2m, bez1, bez2,\n            res = justCount ? 0 : [];\n        for (var i = 0, ii = path1.length; i < ii; i++) {\n            var pi = path1[i];\n            if (pi[0] == "M") {\n                x1 = x1m = pi[1];\n                y1 = y1m = pi[2];\n            } else {\n                if (pi[0] == "C") {\n                    bez1 = [x1, y1].concat(pi.slice(1));\n                    x1 = bez1[6];\n                    y1 = bez1[7];\n                } else {\n                    bez1 = [x1, y1, x1, y1, x1m, y1m, x1m, y1m];\n                    x1 = x1m;\n                    y1 = y1m;\n                }\n                for (var j = 0, jj = path2.length; j < jj; j++) {\n                    var pj = path2[j];\n                    if (pj[0] == "M") {\n                        x2 = x2m = pj[1];\n                        y2 = y2m = pj[2];\n                    } else {\n                        if (pj[0] == "C") {\n                            bez2 = [x2, y2].concat(pj.slice(1));\n                            x2 = bez2[6];\n                            y2 = bez2[7];\n                        } else {\n                            bez2 = [x2, y2, x2, y2, x2m, y2m, x2m, y2m];\n                            x2 = x2m;\n                            y2 = y2m;\n                        }\n                        var intr = interHelper(bez1, bez2, justCount);\n                        if (justCount) {\n                            res += intr;\n                        } else {\n                            for (var k = 0, kk = intr.length; k < kk; k++) {\n                                intr[k].segment1 = i;\n                                intr[k].segment2 = j;\n                                intr[k].bez1 = bez1;\n                                intr[k].bez2 = bez2;\n                            }\n                            res = res.concat(intr);\n                        }\n                    }\n                }\n            }\n        }\n        return res;\n    }\n    /*\\\n     * Raphael.isPointInsidePath\n     [ method ]\n     **\n     * Utility method\n     **\n     * Returns `true` if given point is inside a given closed path.\n     > Parameters\n     - path (string) path string\n     - x (number) x of the point\n     - y (number) y of the point\n     = (boolean) true, if point is inside the path\n    \\*/\n    R.isPointInsidePath = function (path, x, y) {\n        var bbox = R.pathBBox(path);\n        return R.isPointInsideBBox(bbox, x, y) &&\n               interPathHelper(path, [["M", x, y], ["H", bbox.x2 + 10]], 1) % 2 == 1;\n    };\n    R._removedFactory = function (methodname) {\n        return function () {\n            eve("raphael.log", null, "Rapha\\xebl: you are calling to method \\u201c" + methodname + "\\u201d of removed object", methodname);\n        };\n    };\n    /*\\\n     * Raphael.pathBBox\n     [ method ]\n     **\n     * Utility method\n     **\n     * Return bounding box of a given path\n     > Parameters\n     - path (string) path string\n     = (object) bounding box\n     o {\n     o     x: (number) x coordinate of the left top point of the box\n     o     y: (number) y coordinate of the left top point of the box\n     o     x2: (number) x coordinate of the right bottom point of the box\n     o     y2: (number) y coordinate of the right bottom point of the box\n     o     width: (number) width of the box\n     o     height: (number) height of the box\n     o     cx: (number) x coordinate of the center of the box\n     o     cy: (number) y coordinate of the center of the box\n     o }\n    \\*/\n    var pathDimensions = R.pathBBox = function (path) {\n        var pth = paths(path);\n        if (pth.bbox) {\n            return clone(pth.bbox);\n        }\n        if (!path) {\n            return {x: 0, y: 0, width: 0, height: 0, x2: 0, y2: 0};\n        }\n        path = path2curve(path);\n        var x = 0,\n            y = 0,\n            X = [],\n            Y = [],\n            p;\n        for (var i = 0, ii = path.length; i < ii; i++) {\n            p = path[i];\n            if (p[0] == "M") {\n                x = p[1];\n                y = p[2];\n                X.push(x);\n                Y.push(y);\n            } else {\n                var dim = curveDim(x, y, p[1], p[2], p[3], p[4], p[5], p[6]);\n                X = X[concat](dim.min.x, dim.max.x);\n                Y = Y[concat](dim.min.y, dim.max.y);\n                x = p[5];\n                y = p[6];\n            }\n        }\n        var xmin = mmin[apply](0, X),\n            ymin = mmin[apply](0, Y),\n            xmax = mmax[apply](0, X),\n            ymax = mmax[apply](0, Y),\n            width = xmax - xmin,\n            height = ymax - ymin,\n                bb = {\n                x: xmin,\n                y: ymin,\n                x2: xmax,\n                y2: ymax,\n                width: width,\n                height: height,\n                cx: xmin + width / 2,\n                cy: ymin + height / 2\n            };\n        pth.bbox = clone(bb);\n        return bb;\n    },\n        pathClone = function (pathArray) {\n            var res = clone(pathArray);\n            res.toString = R._path2string;\n            return res;\n        },\n        pathToRelative = R._pathToRelative = function (pathArray) {\n            var pth = paths(pathArray);\n            if (pth.rel) {\n                return pathClone(pth.rel);\n            }\n            if (!R.is(pathArray, array) || !R.is(pathArray && pathArray[0], array)) { // rough assumption\n                pathArray = R.parsePathString(pathArray);\n            }\n            var res = [],\n                x = 0,\n                y = 0,\n                mx = 0,\n                my = 0,\n                start = 0;\n            if (pathArray[0][0] == "M") {\n                x = pathArray[0][1];\n                y = pathArray[0][2];\n                mx = x;\n                my = y;\n                start++;\n                res.push(["M", x, y]);\n            }\n            for (var i = start, ii = pathArray.length; i < ii; i++) {\n                var r = res[i] = [],\n                    pa = pathArray[i];\n                if (pa[0] != lowerCase.call(pa[0])) {\n                    r[0] = lowerCase.call(pa[0]);\n                    switch (r[0]) {\n                        case "a":\n                            r[1] = pa[1];\n                            r[2] = pa[2];\n                            r[3] = pa[3];\n                            r[4] = pa[4];\n                            r[5] = pa[5];\n                            r[6] = +(pa[6] - x).toFixed(3);\n                            r[7] = +(pa[7] - y).toFixed(3);\n                            break;\n                        case "v":\n                            r[1] = +(pa[1] - y).toFixed(3);\n                            break;\n                        case "m":\n                            mx = pa[1];\n                            my = pa[2];\n                        default:\n                            for (var j = 1, jj = pa.length; j < jj; j++) {\n                                r[j] = +(pa[j] - ((j % 2) ? x : y)).toFixed(3);\n                            }\n                    }\n                } else {\n                    r = res[i] = [];\n                    if (pa[0] == "m") {\n                        mx = pa[1] + x;\n                        my = pa[2] + y;\n                    }\n                    for (var k = 0, kk = pa.length; k < kk; k++) {\n                        res[i][k] = pa[k];\n                    }\n                }\n                var len = res[i].length;\n                switch (res[i][0]) {\n                    case "z":\n                        x = mx;\n                        y = my;\n                        break;\n                    case "h":\n                        x += +res[i][len - 1];\n                        break;\n                    case "v":\n                        y += +res[i][len - 1];\n                        break;\n                    default:\n                        x += +res[i][len - 2];\n                        y += +res[i][len - 1];\n                }\n            }\n            res.toString = R._path2string;\n            pth.rel = pathClone(res);\n            return res;\n        },\n        pathToAbsolute = R._pathToAbsolute = function (pathArray) {\n            var pth = paths(pathArray);\n            if (pth.abs) {\n                return pathClone(pth.abs);\n            }\n            if (!R.is(pathArray, array) || !R.is(pathArray && pathArray[0], array)) { // rough assumption\n                pathArray = R.parsePathString(pathArray);\n            }\n            if (!pathArray || !pathArray.length) {\n                return [["M", 0, 0]];\n            }\n            var res = [],\n                x = 0,\n                y = 0,\n                mx = 0,\n                my = 0,\n                start = 0;\n            if (pathArray[0][0] == "M") {\n                x = +pathArray[0][1];\n                y = +pathArray[0][2];\n                mx = x;\n                my = y;\n                start++;\n                res[0] = ["M", x, y];\n            }\n            var crz = pathArray.length == 3 && pathArray[0][0] == "M" && pathArray[1][0].toUpperCase() == "R" && pathArray[2][0].toUpperCase() == "Z";\n            for (var r, pa, i = start, ii = pathArray.length; i < ii; i++) {\n                res.push(r = []);\n                pa = pathArray[i];\n                if (pa[0] != upperCase.call(pa[0])) {\n                    r[0] = upperCase.call(pa[0]);\n                    switch (r[0]) {\n                        case "A":\n                            r[1] = pa[1];\n                            r[2] = pa[2];\n                            r[3] = pa[3];\n                            r[4] = pa[4];\n                            r[5] = pa[5];\n                            r[6] = +(pa[6] + x);\n                            r[7] = +(pa[7] + y);\n                            break;\n                        case "V":\n                            r[1] = +pa[1] + y;\n                            break;\n                        case "H":\n                            r[1] = +pa[1] + x;\n                            break;\n                        case "R":\n                            var dots = [x, y][concat](pa.slice(1));\n                            for (var j = 2, jj = dots.length; j < jj; j++) {\n                                dots[j] = +dots[j] + x;\n                                dots[++j] = +dots[j] + y;\n                            }\n                            res.pop();\n                            res = res[concat](catmullRom2bezier(dots, crz));\n                            break;\n                        case "M":\n                            mx = +pa[1] + x;\n                            my = +pa[2] + y;\n                        default:\n                            for (j = 1, jj = pa.length; j < jj; j++) {\n                                r[j] = +pa[j] + ((j % 2) ? x : y);\n                            }\n                    }\n                } else if (pa[0] == "R") {\n                    dots = [x, y][concat](pa.slice(1));\n                    res.pop();\n                    res = res[concat](catmullRom2bezier(dots, crz));\n                    r = ["R"][concat](pa.slice(-2));\n                } else {\n                    for (var k = 0, kk = pa.length; k < kk; k++) {\n                        r[k] = pa[k];\n                    }\n                }\n                switch (r[0]) {\n                    case "Z":\n                        x = mx;\n                        y = my;\n                        break;\n                    case "H":\n                        x = r[1];\n                        break;\n                    case "V":\n                        y = r[1];\n                        break;\n                    case "M":\n                        mx = r[r.length - 2];\n                        my = r[r.length - 1];\n                    default:\n                        x = r[r.length - 2];\n                        y = r[r.length - 1];\n                }\n            }\n            res.toString = R._path2string;\n            pth.abs = pathClone(res);\n            return res;\n        },\n        l2c = function (x1, y1, x2, y2) {\n            return [x1, y1, x2, y2, x2, y2];\n        },\n        q2c = function (x1, y1, ax, ay, x2, y2) {\n            var _13 = 1 / 3,\n                _23 = 2 / 3;\n            return [\n                    _13 * x1 + _23 * ax,\n                    _13 * y1 + _23 * ay,\n                    _13 * x2 + _23 * ax,\n                    _13 * y2 + _23 * ay,\n                    x2,\n                    y2\n                ];\n        },\n        a2c = function (x1, y1, rx, ry, angle, large_arc_flag, sweep_flag, x2, y2, recursive) {\n            // for more information of where this math came from visit:\n            // http://www.w3.org/TR/SVG11/implnote.html#ArcImplementationNotes\n            var _120 = PI * 120 / 180,\n                rad = PI / 180 * (+angle || 0),\n                res = [],\n                xy,\n                rotate = cacher(function (x, y, rad) {\n                    var X = x * math.cos(rad) - y * math.sin(rad),\n                        Y = x * math.sin(rad) + y * math.cos(rad);\n                    return {x: X, y: Y};\n                });\n            if (!recursive) {\n                xy = rotate(x1, y1, -rad);\n                x1 = xy.x;\n                y1 = xy.y;\n                xy = rotate(x2, y2, -rad);\n                x2 = xy.x;\n                y2 = xy.y;\n                var cos = math.cos(PI / 180 * angle),\n                    sin = math.sin(PI / 180 * angle),\n                    x = (x1 - x2) / 2,\n                    y = (y1 - y2) / 2;\n                var h = (x * x) / (rx * rx) + (y * y) / (ry * ry);\n                if (h > 1) {\n                    h = math.sqrt(h);\n                    rx = h * rx;\n                    ry = h * ry;\n                }\n                var rx2 = rx * rx,\n                    ry2 = ry * ry,\n                    k = (large_arc_flag == sweep_flag ? -1 : 1) *\n                        math.sqrt(abs((rx2 * ry2 - rx2 * y * y - ry2 * x * x) / (rx2 * y * y + ry2 * x * x))),\n                    cx = k * rx * y / ry + (x1 + x2) / 2,\n                    cy = k * -ry * x / rx + (y1 + y2) / 2,\n                    f1 = math.asin(((y1 - cy) / ry).toFixed(9)),\n                    f2 = math.asin(((y2 - cy) / ry).toFixed(9));\n\n                f1 = x1 < cx ? PI - f1 : f1;\n                f2 = x2 < cx ? PI - f2 : f2;\n                f1 < 0 && (f1 = PI * 2 + f1);\n                f2 < 0 && (f2 = PI * 2 + f2);\n                if (sweep_flag && f1 > f2) {\n                    f1 = f1 - PI * 2;\n                }\n                if (!sweep_flag && f2 > f1) {\n                    f2 = f2 - PI * 2;\n                }\n            } else {\n                f1 = recursive[0];\n                f2 = recursive[1];\n                cx = recursive[2];\n                cy = recursive[3];\n            }\n            var df = f2 - f1;\n            if (abs(df) > _120) {\n                var f2old = f2,\n                    x2old = x2,\n                    y2old = y2;\n                f2 = f1 + _120 * (sweep_flag && f2 > f1 ? 1 : -1);\n                x2 = cx + rx * math.cos(f2);\n                y2 = cy + ry * math.sin(f2);\n                res = a2c(x2, y2, rx, ry, angle, 0, sweep_flag, x2old, y2old, [f2, f2old, cx, cy]);\n            }\n            df = f2 - f1;\n            var c1 = math.cos(f1),\n                s1 = math.sin(f1),\n                c2 = math.cos(f2),\n                s2 = math.sin(f2),\n                t = math.tan(df / 4),\n                hx = 4 / 3 * rx * t,\n                hy = 4 / 3 * ry * t,\n                m1 = [x1, y1],\n                m2 = [x1 + hx * s1, y1 - hy * c1],\n                m3 = [x2 + hx * s2, y2 - hy * c2],\n                m4 = [x2, y2];\n            m2[0] = 2 * m1[0] - m2[0];\n            m2[1] = 2 * m1[1] - m2[1];\n            if (recursive) {\n                return [m2, m3, m4][concat](res);\n            } else {\n                res = [m2, m3, m4][concat](res).join()[split](",");\n                var newres = [];\n                for (var i = 0, ii = res.length; i < ii; i++) {\n                    newres[i] = i % 2 ? rotate(res[i - 1], res[i], rad).y : rotate(res[i], res[i + 1], rad).x;\n                }\n                return newres;\n            }\n        },\n        findDotAtSegment = function (p1x, p1y, c1x, c1y, c2x, c2y, p2x, p2y, t) {\n            var t1 = 1 - t;\n            return {\n                x: pow(t1, 3) * p1x + pow(t1, 2) * 3 * t * c1x + t1 * 3 * t * t * c2x + pow(t, 3) * p2x,\n                y: pow(t1, 3) * p1y + pow(t1, 2) * 3 * t * c1y + t1 * 3 * t * t * c2y + pow(t, 3) * p2y\n            };\n        },\n        curveDim = cacher(function (p1x, p1y, c1x, c1y, c2x, c2y, p2x, p2y) {\n            var a = (c2x - 2 * c1x + p1x) - (p2x - 2 * c2x + c1x),\n                b = 2 * (c1x - p1x) - 2 * (c2x - c1x),\n                c = p1x - c1x,\n                t1 = (-b + math.sqrt(b * b - 4 * a * c)) / 2 / a,\n                t2 = (-b - math.sqrt(b * b - 4 * a * c)) / 2 / a,\n                y = [p1y, p2y],\n                x = [p1x, p2x],\n                dot;\n            abs(t1) > "1e12" && (t1 = .5);\n            abs(t2) > "1e12" && (t2 = .5);\n            if (t1 > 0 && t1 < 1) {\n                dot = findDotAtSegment(p1x, p1y, c1x, c1y, c2x, c2y, p2x, p2y, t1);\n                x.push(dot.x);\n                y.push(dot.y);\n            }\n            if (t2 > 0 && t2 < 1) {\n                dot = findDotAtSegment(p1x, p1y, c1x, c1y, c2x, c2y, p2x, p2y, t2);\n                x.push(dot.x);\n                y.push(dot.y);\n            }\n            a = (c2y - 2 * c1y + p1y) - (p2y - 2 * c2y + c1y);\n            b = 2 * (c1y - p1y) - 2 * (c2y - c1y);\n            c = p1y - c1y;\n            t1 = (-b + math.sqrt(b * b - 4 * a * c)) / 2 / a;\n            t2 = (-b - math.sqrt(b * b - 4 * a * c)) / 2 / a;\n            abs(t1) > "1e12" && (t1 = .5);\n            abs(t2) > "1e12" && (t2 = .5);\n            if (t1 > 0 && t1 < 1) {\n                dot = findDotAtSegment(p1x, p1y, c1x, c1y, c2x, c2y, p2x, p2y, t1);\n                x.push(dot.x);\n                y.push(dot.y);\n            }\n            if (t2 > 0 && t2 < 1) {\n                dot = findDotAtSegment(p1x, p1y, c1x, c1y, c2x, c2y, p2x, p2y, t2);\n                x.push(dot.x);\n                y.push(dot.y);\n            }\n            return {\n                min: {x: mmin[apply](0, x), y: mmin[apply](0, y)},\n                max: {x: mmax[apply](0, x), y: mmax[apply](0, y)}\n            };\n        }),\n        path2curve = R._path2curve = cacher(function (path, path2) {\n            var pth = !path2 && paths(path);\n            if (!path2 && pth.curve) {\n                return pathClone(pth.curve);\n            }\n            var p = pathToAbsolute(path),\n                p2 = path2 && pathToAbsolute(path2),\n                attrs = {x: 0, y: 0, bx: 0, by: 0, X: 0, Y: 0, qx: null, qy: null},\n                attrs2 = {x: 0, y: 0, bx: 0, by: 0, X: 0, Y: 0, qx: null, qy: null},\n                processPath = function (path, d, pcom) {\n                    var nx, ny, tq = {T:1, Q:1};\n                    if (!path) {\n                        return ["C", d.x, d.y, d.x, d.y, d.x, d.y];\n                    }\n                    !(path[0] in tq) && (d.qx = d.qy = null);\n                    switch (path[0]) {\n                        case "M":\n                            d.X = path[1];\n                            d.Y = path[2];\n                            break;\n                        case "A":\n                            path = ["C"][concat](a2c[apply](0, [d.x, d.y][concat](path.slice(1))));\n                            break;\n                        case "S":\n                            if (pcom == "C" || pcom == "S") { // In "S" case we have to take into account, if the previous command is C/S.\n                                nx = d.x * 2 - d.bx;          // And reflect the previous\n                                ny = d.y * 2 - d.by;          // command\'s control point relative to the current point.\n                            }\n                            else {                            // or some else or nothing\n                                nx = d.x;\n                                ny = d.y;\n                            }\n                            path = ["C", nx, ny][concat](path.slice(1));\n                            break;\n                        case "T":\n                            if (pcom == "Q" || pcom == "T") { // In "T" case we have to take into account, if the previous command is Q/T.\n                                d.qx = d.x * 2 - d.qx;        // And make a reflection similar\n                                d.qy = d.y * 2 - d.qy;        // to case "S".\n                            }\n                            else {                            // or something else or nothing\n                                d.qx = d.x;\n                                d.qy = d.y;\n                            }\n                            path = ["C"][concat](q2c(d.x, d.y, d.qx, d.qy, path[1], path[2]));\n                            break;\n                        case "Q":\n                            d.qx = path[1];\n                            d.qy = path[2];\n                            path = ["C"][concat](q2c(d.x, d.y, path[1], path[2], path[3], path[4]));\n                            break;\n                        case "L":\n                            path = ["C"][concat](l2c(d.x, d.y, path[1], path[2]));\n                            break;\n                        case "H":\n                            path = ["C"][concat](l2c(d.x, d.y, path[1], d.y));\n                            break;\n                        case "V":\n                            path = ["C"][concat](l2c(d.x, d.y, d.x, path[1]));\n                            break;\n                        case "Z":\n                            path = ["C"][concat](l2c(d.x, d.y, d.X, d.Y));\n                            break;\n                    }\n                    return path;\n                },\n                fixArc = function (pp, i) {\n                    if (pp[i].length > 7) {\n                        pp[i].shift();\n                        var pi = pp[i];\n                        while (pi.length) {\n                            pcoms1[i]="A"; // if created multiple C:s, their original seg is saved\n                            p2 && (pcoms2[i]="A"); // the same as above\n                            pp.splice(i++, 0, ["C"][concat](pi.splice(0, 6)));\n                        }\n                        pp.splice(i, 1);\n                        ii = mmax(p.length, p2 && p2.length || 0);\n                    }\n                },\n                fixM = function (path1, path2, a1, a2, i) {\n                    if (path1 && path2 && path1[i][0] == "M" && path2[i][0] != "M") {\n                        path2.splice(i, 0, ["M", a2.x, a2.y]);\n                        a1.bx = 0;\n                        a1.by = 0;\n                        a1.x = path1[i][1];\n                        a1.y = path1[i][2];\n                        ii = mmax(p.length, p2 && p2.length || 0);\n                    }\n                },\n                pcoms1 = [], // path commands of original path p\n                pcoms2 = [], // path commands of original path p2\n                pfirst = "", // temporary holder for original path command\n                pcom = ""; // holder for previous path command of original path\n            for (var i = 0, ii = mmax(p.length, p2 && p2.length || 0); i < ii; i++) {\n                p[i] && (pfirst = p[i][0]); // save current path command\n\n                if (pfirst != "C") // C is not saved yet, because it may be result of conversion\n                {\n                    pcoms1[i] = pfirst; // Save current path command\n                    i && ( pcom = pcoms1[i-1]); // Get previous path command pcom\n                }\n                p[i] = processPath(p[i], attrs, pcom); // Previous path command is inputted to processPath\n\n                if (pcoms1[i] != "A" && pfirst == "C") pcoms1[i] = "C"; // A is the only command\n                // which may produce multiple C:s\n                // so we have to make sure that C is also C in original path\n\n                fixArc(p, i); // fixArc adds also the right amount of A:s to pcoms1\n\n                if (p2) { // the same procedures is done to p2\n                    p2[i] && (pfirst = p2[i][0]);\n                    if (pfirst != "C")\n                    {\n                        pcoms2[i] = pfirst;\n                        i && (pcom = pcoms2[i-1]);\n                    }\n                    p2[i] = processPath(p2[i], attrs2, pcom);\n\n                    if (pcoms2[i]!="A" && pfirst=="C") pcoms2[i]="C";\n\n                    fixArc(p2, i);\n                }\n                fixM(p, p2, attrs, attrs2, i);\n                fixM(p2, p, attrs2, attrs, i);\n                var seg = p[i],\n                    seg2 = p2 && p2[i],\n                    seglen = seg.length,\n                    seg2len = p2 && seg2.length;\n                attrs.x = seg[seglen - 2];\n                attrs.y = seg[seglen - 1];\n                attrs.bx = toFloat(seg[seglen - 4]) || attrs.x;\n                attrs.by = toFloat(seg[seglen - 3]) || attrs.y;\n                attrs2.bx = p2 && (toFloat(seg2[seg2len - 4]) || attrs2.x);\n                attrs2.by = p2 && (toFloat(seg2[seg2len - 3]) || attrs2.y);\n                attrs2.x = p2 && seg2[seg2len - 2];\n                attrs2.y = p2 && seg2[seg2len - 1];\n            }\n            if (!p2) {\n                pth.curve = pathClone(p);\n            }\n            return p2 ? [p, p2] : p;\n        }, null, pathClone),\n        parseDots = R._parseDots = cacher(function (gradient) {\n            var dots = [];\n            for (var i = 0, ii = gradient.length; i < ii; i++) {\n                var dot = {},\n                    par = gradient[i].match(/^([^:]*):?([\\d\\.]*)/);\n                dot.color = R.getRGB(par[1]);\n                if (dot.color.error) {\n                    return null;\n                }\n                dot.opacity = dot.color.opacity;\n                dot.color = dot.color.hex;\n                par[2] && (dot.offset = par[2] + "%");\n                dots.push(dot);\n            }\n            for (i = 1, ii = dots.length - 1; i < ii; i++) {\n                if (!dots[i].offset) {\n                    var start = toFloat(dots[i - 1].offset || 0),\n                        end = 0;\n                    for (var j = i + 1; j < ii; j++) {\n                        if (dots[j].offset) {\n                            end = dots[j].offset;\n                            break;\n                        }\n                    }\n                    if (!end) {\n                        end = 100;\n                        j = ii;\n                    }\n                    end = toFloat(end);\n                    var d = (end - start) / (j - i + 1);\n                    for (; i < j; i++) {\n                        start += d;\n                        dots[i].offset = start + "%";\n                    }\n                }\n            }\n            return dots;\n        }),\n        tear = R._tear = function (el, paper) {\n            el == paper.top && (paper.top = el.prev);\n            el == paper.bottom && (paper.bottom = el.next);\n            el.next && (el.next.prev = el.prev);\n            el.prev && (el.prev.next = el.next);\n        },\n        tofront = R._tofront = function (el, paper) {\n            if (paper.top === el) {\n                return;\n            }\n            tear(el, paper);\n            el.next = null;\n            el.prev = paper.top;\n            paper.top.next = el;\n            paper.top = el;\n        },\n        toback = R._toback = function (el, paper) {\n            if (paper.bottom === el) {\n                return;\n            }\n            tear(el, paper);\n            el.next = paper.bottom;\n            el.prev = null;\n            paper.bottom.prev = el;\n            paper.bottom = el;\n        },\n        insertafter = R._insertafter = function (el, el2, paper) {\n            tear(el, paper);\n            el2 == paper.top && (paper.top = el);\n            el2.next && (el2.next.prev = el);\n            el.next = el2.next;\n            el.prev = el2;\n            el2.next = el;\n        },\n        insertbefore = R._insertbefore = function (el, el2, paper) {\n            tear(el, paper);\n            el2 == paper.bottom && (paper.bottom = el);\n            el2.prev && (el2.prev.next = el);\n            el.prev = el2.prev;\n            el2.prev = el;\n            el.next = el2;\n        },\n        /*\\\n         * Raphael.toMatrix\n         [ method ]\n         **\n         * Utility method\n         **\n         * Returns matrix of transformations applied to a given path\n         > Parameters\n         - path (string) path string\n         - transform (string|array) transformation string\n         = (object) @Matrix\n        \\*/\n        toMatrix = R.toMatrix = function (path, transform) {\n            var bb = pathDimensions(path),\n                el = {\n                    _: {\n                        transform: E\n                    },\n                    getBBox: function () {\n                        return bb;\n                    }\n                };\n            extractTransform(el, transform);\n            return el.matrix;\n        },\n        /*\\\n         * Raphael.transformPath\n         [ method ]\n         **\n         * Utility method\n         **\n         * Returns path transformed by a given transformation\n         > Parameters\n         - path (string) path string\n         - transform (string|array) transformation string\n         = (string) path\n        \\*/\n        transformPath = R.transformPath = function (path, transform) {\n            return mapPath(path, toMatrix(path, transform));\n        },\n        extractTransform = R._extractTransform = function (el, tstr) {\n            if (tstr == null) {\n                return el._.transform;\n            }\n            tstr = Str(tstr).replace(/\\.{3}|\\u2026/g, el._.transform || E);\n            var tdata = R.parseTransformString(tstr),\n                deg = 0,\n                dx = 0,\n                dy = 0,\n                sx = 1,\n                sy = 1,\n                _ = el._,\n                m = new Matrix;\n            _.transform = tdata || [];\n            if (tdata) {\n                for (var i = 0, ii = tdata.length; i < ii; i++) {\n                    var t = tdata[i],\n                        tlen = t.length,\n                        command = Str(t[0]).toLowerCase(),\n                        absolute = t[0] != command,\n                        inver = absolute ? m.invert() : 0,\n                        x1,\n                        y1,\n                        x2,\n                        y2,\n                        bb;\n                    if (command == "t" && tlen == 3) {\n                        if (absolute) {\n                            x1 = inver.x(0, 0);\n                            y1 = inver.y(0, 0);\n                            x2 = inver.x(t[1], t[2]);\n                            y2 = inver.y(t[1], t[2]);\n                            m.translate(x2 - x1, y2 - y1);\n                        } else {\n                            m.translate(t[1], t[2]);\n                        }\n                    } else if (command == "r") {\n                        if (tlen == 2) {\n                            bb = bb || el.getBBox(1);\n                            m.rotate(t[1], bb.x + bb.width / 2, bb.y + bb.height / 2);\n                            deg += t[1];\n                        } else if (tlen == 4) {\n                            if (absolute) {\n                                x2 = inver.x(t[2], t[3]);\n                                y2 = inver.y(t[2], t[3]);\n                                m.rotate(t[1], x2, y2);\n                            } else {\n                                m.rotate(t[1], t[2], t[3]);\n                            }\n                            deg += t[1];\n                        }\n                    } else if (command == "s") {\n                        if (tlen == 2 || tlen == 3) {\n                            bb = bb || el.getBBox(1);\n                            m.scale(t[1], t[tlen - 1], bb.x + bb.width / 2, bb.y + bb.height / 2);\n                            sx *= t[1];\n                            sy *= t[tlen - 1];\n                        } else if (tlen == 5) {\n                            if (absolute) {\n                                x2 = inver.x(t[3], t[4]);\n                                y2 = inver.y(t[3], t[4]);\n                                m.scale(t[1], t[2], x2, y2);\n                            } else {\n                                m.scale(t[1], t[2], t[3], t[4]);\n                            }\n                            sx *= t[1];\n                            sy *= t[2];\n                        }\n                    } else if (command == "m" && tlen == 7) {\n                        m.add(t[1], t[2], t[3], t[4], t[5], t[6]);\n                    }\n                    _.dirtyT = 1;\n                    el.matrix = m;\n                }\n            }\n\n            /*\\\n             * Element.matrix\n             [ property (object) ]\n             **\n             * Keeps @Matrix object, which represents element transformation\n            \\*/\n            el.matrix = m;\n\n            _.sx = sx;\n            _.sy = sy;\n            _.deg = deg;\n            _.dx = dx = m.e;\n            _.dy = dy = m.f;\n\n            if (sx == 1 && sy == 1 && !deg && _.bbox) {\n                _.bbox.x += +dx;\n                _.bbox.y += +dy;\n            } else {\n                _.dirtyT = 1;\n            }\n        },\n        getEmpty = function (item) {\n            var l = item[0];\n            switch (l.toLowerCase()) {\n                case "t": return [l, 0, 0];\n                case "m": return [l, 1, 0, 0, 1, 0, 0];\n                case "r": if (item.length == 4) {\n                    return [l, 0, item[2], item[3]];\n                } else {\n                    return [l, 0];\n                }\n                case "s": if (item.length == 5) {\n                    return [l, 1, 1, item[3], item[4]];\n                } else if (item.length == 3) {\n                    return [l, 1, 1];\n                } else {\n                    return [l, 1];\n                }\n            }\n        },\n        equaliseTransform = R._equaliseTransform = function (t1, t2) {\n            t2 = Str(t2).replace(/\\.{3}|\\u2026/g, t1);\n            t1 = R.parseTransformString(t1) || [];\n            t2 = R.parseTransformString(t2) || [];\n            var maxlength = mmax(t1.length, t2.length),\n                from = [],\n                to = [],\n                i = 0, j, jj,\n                tt1, tt2;\n            for (; i < maxlength; i++) {\n                tt1 = t1[i] || getEmpty(t2[i]);\n                tt2 = t2[i] || getEmpty(tt1);\n                if ((tt1[0] != tt2[0]) ||\n                    (tt1[0].toLowerCase() == "r" && (tt1[2] != tt2[2] || tt1[3] != tt2[3])) ||\n                    (tt1[0].toLowerCase() == "s" && (tt1[3] != tt2[3] || tt1[4] != tt2[4]))\n                    ) {\n                    return;\n                }\n                from[i] = [];\n                to[i] = [];\n                for (j = 0, jj = mmax(tt1.length, tt2.length); j < jj; j++) {\n                    j in tt1 && (from[i][j] = tt1[j]);\n                    j in tt2 && (to[i][j] = tt2[j]);\n                }\n            }\n            return {\n                from: from,\n                to: to\n            };\n        };\n    R._getContainer = function (x, y, w, h) {\n        var container;\n        container = h == null && !R.is(x, "object") ? g.doc.getElementById(x) : x;\n        if (container == null) {\n            return;\n        }\n        if (container.tagName) {\n            if (y == null) {\n                return {\n                    container: container,\n                    width: container.style.pixelWidth || container.offsetWidth,\n                    height: container.style.pixelHeight || container.offsetHeight\n                };\n            } else {\n                return {\n                    container: container,\n                    width: y,\n                    height: w\n                };\n            }\n        }\n        return {\n            container: 1,\n            x: x,\n            y: y,\n            width: w,\n            height: h\n        };\n    };\n    /*\\\n     * Raphael.pathToRelative\n     [ method ]\n     **\n     * Utility method\n     **\n     * Converts path to relative form\n     > Parameters\n     - pathString (string|array) path string or array of segments\n     = (array) array of segments.\n    \\*/\n    R.pathToRelative = pathToRelative;\n    R._engine = {};\n    /*\\\n     * Raphael.path2curve\n     [ method ]\n     **\n     * Utility method\n     **\n     * Converts path to a new path where all segments are cubic bezier curves.\n     > Parameters\n     - pathString (string|array) path string or array of segments\n     = (array) array of segments.\n    \\*/\n    R.path2curve = path2curve;\n    /*\\\n     * Raphael.matrix\n     [ method ]\n     **\n     * Utility method\n     **\n     * Returns matrix based on given parameters.\n     > Parameters\n     - a (number)\n     - b (number)\n     - c (number)\n     - d (number)\n     - e (number)\n     - f (number)\n     = (object) @Matrix\n    \\*/\n    R.matrix = function (a, b, c, d, e, f) {\n        return new Matrix(a, b, c, d, e, f);\n    };\n    function Matrix(a, b, c, d, e, f) {\n        if (a != null) {\n            this.a = +a;\n            this.b = +b;\n            this.c = +c;\n            this.d = +d;\n            this.e = +e;\n            this.f = +f;\n        } else {\n            this.a = 1;\n            this.b = 0;\n            this.c = 0;\n            this.d = 1;\n            this.e = 0;\n            this.f = 0;\n        }\n    }\n    (function (matrixproto) {\n        /*\\\n         * Matrix.add\n         [ method ]\n         **\n         * Adds given matrix to existing one.\n         > Parameters\n         - a (number)\n         - b (number)\n         - c (number)\n         - d (number)\n         - e (number)\n         - f (number)\n         or\n         - matrix (object) @Matrix\n        \\*/\n        matrixproto.add = function (a, b, c, d, e, f) {\n            var out = [[], [], []],\n                m = [[this.a, this.c, this.e], [this.b, this.d, this.f], [0, 0, 1]],\n                matrix = [[a, c, e], [b, d, f], [0, 0, 1]],\n                x, y, z, res;\n\n            if (a && a instanceof Matrix) {\n                matrix = [[a.a, a.c, a.e], [a.b, a.d, a.f], [0, 0, 1]];\n            }\n\n            for (x = 0; x < 3; x++) {\n                for (y = 0; y < 3; y++) {\n                    res = 0;\n                    for (z = 0; z < 3; z++) {\n                        res += m[x][z] * matrix[z][y];\n                    }\n                    out[x][y] = res;\n                }\n            }\n            this.a = out[0][0];\n            this.b = out[1][0];\n            this.c = out[0][1];\n            this.d = out[1][1];\n            this.e = out[0][2];\n            this.f = out[1][2];\n        };\n        /*\\\n         * Matrix.invert\n         [ method ]\n         **\n         * Returns inverted version of the matrix\n         = (object) @Matrix\n        \\*/\n        matrixproto.invert = function () {\n            var me = this,\n                x = me.a * me.d - me.b * me.c;\n            return new Matrix(me.d / x, -me.b / x, -me.c / x, me.a / x, (me.c * me.f - me.d * me.e) / x, (me.b * me.e - me.a * me.f) / x);\n        };\n        /*\\\n         * Matrix.clone\n         [ method ]\n         **\n         * Returns copy of the matrix\n         = (object) @Matrix\n        \\*/\n        matrixproto.clone = function () {\n            return new Matrix(this.a, this.b, this.c, this.d, this.e, this.f);\n        };\n        /*\\\n         * Matrix.translate\n         [ method ]\n         **\n         * Translate the matrix\n         > Parameters\n         - x (number)\n         - y (number)\n        \\*/\n        matrixproto.translate = function (x, y) {\n            this.add(1, 0, 0, 1, x, y);\n        };\n        /*\\\n         * Matrix.scale\n         [ method ]\n         **\n         * Scales the matrix\n         > Parameters\n         - x (number)\n         - y (number) #optional\n         - cx (number) #optional\n         - cy (number) #optional\n        \\*/\n        matrixproto.scale = function (x, y, cx, cy) {\n            y == null && (y = x);\n            (cx || cy) && this.add(1, 0, 0, 1, cx, cy);\n            this.add(x, 0, 0, y, 0, 0);\n            (cx || cy) && this.add(1, 0, 0, 1, -cx, -cy);\n        };\n        /*\\\n         * Matrix.rotate\n         [ method ]\n         **\n         * Rotates the matrix\n         > Parameters\n         - a (number)\n         - x (number)\n         - y (number)\n        \\*/\n        matrixproto.rotate = function (a, x, y) {\n            a = R.rad(a);\n            x = x || 0;\n            y = y || 0;\n            var cos = +math.cos(a).toFixed(9),\n                sin = +math.sin(a).toFixed(9);\n            this.add(cos, sin, -sin, cos, x, y);\n            this.add(1, 0, 0, 1, -x, -y);\n        };\n        /*\\\n         * Matrix.x\n         [ method ]\n         **\n         * Return x coordinate for given point after transformation described by the matrix. See also @Matrix.y\n         > Parameters\n         - x (number)\n         - y (number)\n         = (number) x\n        \\*/\n        matrixproto.x = function (x, y) {\n            return x * this.a + y * this.c + this.e;\n        };\n        /*\\\n         * Matrix.y\n         [ method ]\n         **\n         * Return y coordinate for given point after transformation described by the matrix. See also @Matrix.x\n         > Parameters\n         - x (number)\n         - y (number)\n         = (number) y\n        \\*/\n        matrixproto.y = function (x, y) {\n            return x * this.b + y * this.d + this.f;\n        };\n        matrixproto.get = function (i) {\n            return +this[Str.fromCharCode(97 + i)].toFixed(4);\n        };\n        matrixproto.toString = function () {\n            return R.svg ?\n                "matrix(" + [this.get(0), this.get(1), this.get(2), this.get(3), this.get(4), this.get(5)].join() + ")" :\n                [this.get(0), this.get(2), this.get(1), this.get(3), 0, 0].join();\n        };\n        matrixproto.toFilter = function () {\n            return "progid:DXImageTransform.Microsoft.Matrix(M11=" + this.get(0) +\n                ", M12=" + this.get(2) + ", M21=" + this.get(1) + ", M22=" + this.get(3) +\n                ", Dx=" + this.get(4) + ", Dy=" + this.get(5) + ", sizingmethod=\'auto expand\')";\n        };\n        matrixproto.offset = function () {\n            return [this.e.toFixed(4), this.f.toFixed(4)];\n        };\n        function norm(a) {\n            return a[0] * a[0] + a[1] * a[1];\n        }\n        function normalize(a) {\n            var mag = math.sqrt(norm(a));\n            a[0] && (a[0] /= mag);\n            a[1] && (a[1] /= mag);\n        }\n        /*\\\n         * Matrix.split\n         [ method ]\n         **\n         * Splits matrix into primitive transformations\n         = (object) in format:\n         o dx (number) translation by x\n         o dy (number) translation by y\n         o scalex (number) scale by x\n         o scaley (number) scale by y\n         o shear (number) shear\n         o rotate (number) rotation in deg\n         o isSimple (boolean) could it be represented via simple transformations\n        \\*/\n        matrixproto.split = function () {\n            var out = {};\n            // translation\n            out.dx = this.e;\n            out.dy = this.f;\n\n            // scale and shear\n            var row = [[this.a, this.c], [this.b, this.d]];\n            out.scalex = math.sqrt(norm(row[0]));\n            normalize(row[0]);\n\n            out.shear = row[0][0] * row[1][0] + row[0][1] * row[1][1];\n            row[1] = [row[1][0] - row[0][0] * out.shear, row[1][1] - row[0][1] * out.shear];\n\n            out.scaley = math.sqrt(norm(row[1]));\n            normalize(row[1]);\n            out.shear /= out.scaley;\n\n            // rotation\n            var sin = -row[0][1],\n                cos = row[1][1];\n            if (cos < 0) {\n                out.rotate = R.deg(math.acos(cos));\n                if (sin < 0) {\n                    out.rotate = 360 - out.rotate;\n                }\n            } else {\n                out.rotate = R.deg(math.asin(sin));\n            }\n\n            out.isSimple = !+out.shear.toFixed(9) && (out.scalex.toFixed(9) == out.scaley.toFixed(9) || !out.rotate);\n            out.isSuperSimple = !+out.shear.toFixed(9) && out.scalex.toFixed(9) == out.scaley.toFixed(9) && !out.rotate;\n            out.noRotation = !+out.shear.toFixed(9) && !out.rotate;\n            return out;\n        };\n        /*\\\n         * Matrix.toTransformString\n         [ method ]\n         **\n         * Return transform string that represents given matrix\n         = (string) transform string\n        \\*/\n        matrixproto.toTransformString = function (shorter) {\n            var s = shorter || this[split]();\n            if (s.isSimple) {\n                s.scalex = +s.scalex.toFixed(4);\n                s.scaley = +s.scaley.toFixed(4);\n                s.rotate = +s.rotate.toFixed(4);\n                return  (s.dx || s.dy ? "t" + [s.dx, s.dy] : E) +\n                        (s.scalex != 1 || s.scaley != 1 ? "s" + [s.scalex, s.scaley, 0, 0] : E) +\n                        (s.rotate ? "r" + [s.rotate, 0, 0] : E);\n            } else {\n                return "m" + [this.get(0), this.get(1), this.get(2), this.get(3), this.get(4), this.get(5)];\n            }\n        };\n    })(Matrix.prototype);\n\n    var preventDefault = function () {\n        this.returnValue = false;\n    },\n    preventTouch = function () {\n        return this.originalEvent.preventDefault();\n    },\n    stopPropagation = function () {\n        this.cancelBubble = true;\n    },\n    stopTouch = function () {\n        return this.originalEvent.stopPropagation();\n    },\n    getEventPosition = function (e) {\n        var scrollY = g.doc.documentElement.scrollTop || g.doc.body.scrollTop,\n            scrollX = g.doc.documentElement.scrollLeft || g.doc.body.scrollLeft;\n\n        return {\n            x: e.clientX + scrollX,\n            y: e.clientY + scrollY\n        };\n    },\n    addEvent = (function () {\n        if (g.doc.addEventListener) {\n            return function (obj, type, fn, element) {\n                var f = function (e) {\n                    var pos = getEventPosition(e);\n                    return fn.call(element, e, pos.x, pos.y);\n                };\n                obj.addEventListener(type, f, false);\n\n                if (supportsTouch && touchMap[type]) {\n                    var _f = function (e) {\n                        var pos = getEventPosition(e),\n                            olde = e;\n\n                        for (var i = 0, ii = e.targetTouches && e.targetTouches.length; i < ii; i++) {\n                            if (e.targetTouches[i].target == obj) {\n                                e = e.targetTouches[i];\n                                e.originalEvent = olde;\n                                e.preventDefault = preventTouch;\n                                e.stopPropagation = stopTouch;\n                                break;\n                            }\n                        }\n\n                        return fn.call(element, e, pos.x, pos.y);\n                    };\n                    obj.addEventListener(touchMap[type], _f, false);\n                }\n\n                return function () {\n                    obj.removeEventListener(type, f, false);\n\n                    if (supportsTouch && touchMap[type])\n                        obj.removeEventListener(touchMap[type], _f, false);\n\n                    return true;\n                };\n            };\n        } else if (g.doc.attachEvent) {\n            return function (obj, type, fn, element) {\n                var f = function (e) {\n                    e = e || g.win.event;\n                    var scrollY = g.doc.documentElement.scrollTop || g.doc.body.scrollTop,\n                        scrollX = g.doc.documentElement.scrollLeft || g.doc.body.scrollLeft,\n                        x = e.clientX + scrollX,\n                        y = e.clientY + scrollY;\n                    e.preventDefault = e.preventDefault || preventDefault;\n                    e.stopPropagation = e.stopPropagation || stopPropagation;\n                    return fn.call(element, e, x, y);\n                };\n                obj.attachEvent("on" + type, f);\n                var detacher = function () {\n                    obj.detachEvent("on" + type, f);\n                    return true;\n                };\n                return detacher;\n            };\n        }\n    })(),\n    drag = [],\n    dragMove = function (e) {\n        var x = e.clientX,\n            y = e.clientY,\n            scrollY = g.doc.documentElement.scrollTop || g.doc.body.scrollTop,\n            scrollX = g.doc.documentElement.scrollLeft || g.doc.body.scrollLeft,\n            dragi,\n            j = drag.length;\n        while (j--) {\n            dragi = drag[j];\n            if (supportsTouch && e.touches) {\n                var i = e.touches.length,\n                    touch;\n                while (i--) {\n                    touch = e.touches[i];\n                    if (touch.identifier == dragi.el._drag.id) {\n                        x = touch.clientX;\n                        y = touch.clientY;\n                        (e.originalEvent ? e.originalEvent : e).preventDefault();\n                        break;\n                    }\n                }\n            } else {\n                e.preventDefault();\n            }\n            var node = dragi.el.node,\n                o,\n                next = node.nextSibling,\n                parent = node.parentNode,\n                display = node.style.display;\n            g.win.opera && parent.removeChild(node);\n            node.style.display = "none";\n            o = dragi.el.paper.getElementByPoint(x, y);\n            node.style.display = display;\n            g.win.opera && (next ? parent.insertBefore(node, next) : parent.appendChild(node));\n            o && eve("raphael.drag.over." + dragi.el.id, dragi.el, o);\n            x += scrollX;\n            y += scrollY;\n            eve("raphael.drag.move." + dragi.el.id, dragi.move_scope || dragi.el, x - dragi.el._drag.x, y - dragi.el._drag.y, x, y, e);\n        }\n    },\n    dragUp = function (e) {\n        R.unmousemove(dragMove).unmouseup(dragUp);\n        var i = drag.length,\n            dragi;\n        while (i--) {\n            dragi = drag[i];\n            dragi.el._drag = {};\n            eve("raphael.drag.end." + dragi.el.id, dragi.end_scope || dragi.start_scope || dragi.move_scope || dragi.el, e);\n        }\n        drag = [];\n    },\n    /*\\\n     * Raphael.el\n     [ property (object) ]\n     **\n     * You can add your own method to elements. This is useful when you want to hack default functionality or\n     * want to wrap some common transformation or attributes in one method. In difference to canvas methods,\n     * you can redefine element method at any time. Expending element methods wouldn’t affect set.\n     > Usage\n     | Raphael.el.red = function () {\n     |     this.attr({fill: "#f00"});\n     | };\n     | // then use it\n     | paper.circle(100, 100, 20).red();\n    \\*/\n    elproto = R.el = {};\n    /*\\\n     * Element.click\n     [ method ]\n     **\n     * Adds event handler for click for the element.\n     > Parameters\n     - handler (function) handler for the event\n     = (object) @Element\n    \\*/\n    /*\\\n     * Element.unclick\n     [ method ]\n     **\n     * Removes event handler for click for the element.\n     > Parameters\n     - handler (function) #optional handler for the event\n     = (object) @Element\n    \\*/\n\n    /*\\\n     * Element.dblclick\n     [ method ]\n     **\n     * Adds event handler for double click for the element.\n     > Parameters\n     - handler (function) handler for the event\n     = (object) @Element\n    \\*/\n    /*\\\n     * Element.undblclick\n     [ method ]\n     **\n     * Removes event handler for double click for the element.\n     > Parameters\n     - handler (function) #optional handler for the event\n     = (object) @Element\n    \\*/\n\n    /*\\\n     * Element.mousedown\n     [ method ]\n     **\n     * Adds event handler for mousedown for the element.\n     > Parameters\n     - handler (function) handler for the event\n     = (object) @Element\n    \\*/\n    /*\\\n     * Element.unmousedown\n     [ method ]\n     **\n     * Removes event handler for mousedown for the element.\n     > Parameters\n     - handler (function) #optional handler for the event\n     = (object) @Element\n    \\*/\n\n    /*\\\n     * Element.mousemove\n     [ method ]\n     **\n     * Adds event handler for mousemove for the element.\n     > Parameters\n     - handler (function) handler for the event\n     = (object) @Element\n    \\*/\n    /*\\\n     * Element.unmousemove\n     [ method ]\n     **\n     * Removes event handler for mousemove for the element.\n     > Parameters\n     - handler (function) #optional handler for the event\n     = (object) @Element\n    \\*/\n\n    /*\\\n     * Element.mouseout\n     [ method ]\n     **\n     * Adds event handler for mouseout for the element.\n     > Parameters\n     - handler (function) handler for the event\n     = (object) @Element\n    \\*/\n    /*\\\n     * Element.unmouseout\n     [ method ]\n     **\n     * Removes event handler for mouseout for the element.\n     > Parameters\n     - handler (function) #optional handler for the event\n     = (object) @Element\n    \\*/\n\n    /*\\\n     * Element.mouseover\n     [ method ]\n     **\n     * Adds event handler for mouseover for the element.\n     > Parameters\n     - handler (function) handler for the event\n     = (object) @Element\n    \\*/\n    /*\\\n     * Element.unmouseover\n     [ method ]\n     **\n     * Removes event handler for mouseover for the element.\n     > Parameters\n     - handler (function) #optional handler for the event\n     = (object) @Element\n    \\*/\n\n    /*\\\n     * Element.mouseup\n     [ method ]\n     **\n     * Adds event handler for mouseup for the element.\n     > Parameters\n     - handler (function) handler for the event\n     = (object) @Element\n    \\*/\n    /*\\\n     * Element.unmouseup\n     [ method ]\n     **\n     * Removes event handler for mouseup for the element.\n     > Parameters\n     - handler (function) #optional handler for the event\n     = (object) @Element\n    \\*/\n\n    /*\\\n     * Element.touchstart\n     [ method ]\n     **\n     * Adds event handler for touchstart for the element.\n     > Parameters\n     - handler (function) handler for the event\n     = (object) @Element\n    \\*/\n    /*\\\n     * Element.untouchstart\n     [ method ]\n     **\n     * Removes event handler for touchstart for the element.\n     > Parameters\n     - handler (function) #optional handler for the event\n     = (object) @Element\n    \\*/\n\n    /*\\\n     * Element.touchmove\n     [ method ]\n     **\n     * Adds event handler for touchmove for the element.\n     > Parameters\n     - handler (function) handler for the event\n     = (object) @Element\n    \\*/\n    /*\\\n     * Element.untouchmove\n     [ method ]\n     **\n     * Removes event handler for touchmove for the element.\n     > Parameters\n     - handler (function) #optional handler for the event\n     = (object) @Element\n    \\*/\n\n    /*\\\n     * Element.touchend\n     [ method ]\n     **\n     * Adds event handler for touchend for the element.\n     > Parameters\n     - handler (function) handler for the event\n     = (object) @Element\n    \\*/\n    /*\\\n     * Element.untouchend\n     [ method ]\n     **\n     * Removes event handler for touchend for the element.\n     > Parameters\n     - handler (function) #optional handler for the event\n     = (object) @Element\n    \\*/\n\n    /*\\\n     * Element.touchcancel\n     [ method ]\n     **\n     * Adds event handler for touchcancel for the element.\n     > Parameters\n     - handler (function) handler for the event\n     = (object) @Element\n    \\*/\n    /*\\\n     * Element.untouchcancel\n     [ method ]\n     **\n     * Removes event handler for touchcancel for the element.\n     > Parameters\n     - handler (function) #optional handler for the event\n     = (object) @Element\n    \\*/\n    for (var i = events.length; i--;) {\n        (function (eventName) {\n            R[eventName] = elproto[eventName] = function (fn, scope) {\n                if (R.is(fn, "function")) {\n                    this.events = this.events || [];\n                    this.events.push({name: eventName, f: fn, unbind: addEvent(this.shape || this.node || g.doc, eventName, fn, scope || this)});\n                }\n                return this;\n            };\n            R["un" + eventName] = elproto["un" + eventName] = function (fn) {\n                var events = this.events || [],\n                    l = events.length;\n                while (l--){\n                    if (events[l].name == eventName && (R.is(fn, "undefined") || events[l].f == fn)) {\n                        events[l].unbind();\n                        events.splice(l, 1);\n                        !events.length && delete this.events;\n                    }\n                }\n                return this;\n            };\n        })(events[i]);\n    }\n\n    /*\\\n     * Element.data\n     [ method ]\n     **\n     * Adds or retrieves given value associated with given key.\n     **\n     * See also @Element.removeData\n     > Parameters\n     - key (string) key to store data\n     - value (any) #optional value to store\n     = (object) @Element\n     * or, if value is not specified:\n     = (any) value\n     * or, if key and value are not specified:\n     = (object) Key/value pairs for all the data associated with the element.\n     > Usage\n     | for (var i = 0, i < 5, i++) {\n     |     paper.circle(10 + 15 * i, 10, 10)\n     |          .attr({fill: "#000"})\n     |          .data("i", i)\n     |          .click(function () {\n     |             alert(this.data("i"));\n     |          });\n     | }\n    \\*/\n    elproto.data = function (key, value) {\n        var data = eldata[this.id] = eldata[this.id] || {};\n        if (arguments.length == 0) {\n            return data;\n        }\n        if (arguments.length == 1) {\n            if (R.is(key, "object")) {\n                for (var i in key) if (key[has](i)) {\n                    this.data(i, key[i]);\n                }\n                return this;\n            }\n            eve("raphael.data.get." + this.id, this, data[key], key);\n            return data[key];\n        }\n        data[key] = value;\n        eve("raphael.data.set." + this.id, this, value, key);\n        return this;\n    };\n    /*\\\n     * Element.removeData\n     [ method ]\n     **\n     * Removes value associated with an element by given key.\n     * If key is not provided, removes all the data of the element.\n     > Parameters\n     - key (string) #optional key\n     = (object) @Element\n    \\*/\n    elproto.removeData = function (key) {\n        if (key == null) {\n            delete eldata[this.id];\n        } else {\n            eldata[this.id] && delete eldata[this.id][key];\n        }\n        return this;\n    };\n     /*\\\n     * Element.getData\n     [ method ]\n     **\n     * Retrieves the element data\n     = (object) data\n    \\*/\n    elproto.getData = function () {\n        return clone(eldata[this.id] || {});\n    };\n    /*\\\n     * Element.hover\n     [ method ]\n     **\n     * Adds event handlers for hover for the element.\n     > Parameters\n     - f_in (function) handler for hover in\n     - f_out (function) handler for hover out\n     - icontext (object) #optional context for hover in handler\n     - ocontext (object) #optional context for hover out handler\n     = (object) @Element\n    \\*/\n    elproto.hover = function (f_in, f_out, scope_in, scope_out) {\n        return this.mouseover(f_in, scope_in).mouseout(f_out, scope_out || scope_in);\n    };\n    /*\\\n     * Element.unhover\n     [ method ]\n     **\n     * Removes event handlers for hover for the element.\n     > Parameters\n     - f_in (function) handler for hover in\n     - f_out (function) handler for hover out\n     = (object) @Element\n    \\*/\n    elproto.unhover = function (f_in, f_out) {\n        return this.unmouseover(f_in).unmouseout(f_out);\n    };\n    var draggable = [];\n    /*\\\n     * Element.drag\n     [ method ]\n     **\n     * Adds event handlers for drag of the element.\n     > Parameters\n     - onmove (function) handler for moving\n     - onstart (function) handler for drag start\n     - onend (function) handler for drag end\n     - mcontext (object) #optional context for moving handler\n     - scontext (object) #optional context for drag start handler\n     - econtext (object) #optional context for drag end handler\n     * Additionally following `drag` events will be triggered: `drag.start.<id>` on start,\n     * `drag.end.<id>` on end and `drag.move.<id>` on every move. When element will be dragged over another element\n     * `drag.over.<id>` will be fired as well.\n     *\n     * Start event and start handler will be called in specified context or in context of the element with following parameters:\n     o x (number) x position of the mouse\n     o y (number) y position of the mouse\n     o event (object) DOM event object\n     * Move event and move handler will be called in specified context or in context of the element with following parameters:\n     o dx (number) shift by x from the start point\n     o dy (number) shift by y from the start point\n     o x (number) x position of the mouse\n     o y (number) y position of the mouse\n     o event (object) DOM event object\n     * End event and end handler will be called in specified context or in context of the element with following parameters:\n     o event (object) DOM event object\n     = (object) @Element\n    \\*/\n    elproto.drag = function (onmove, onstart, onend, move_scope, start_scope, end_scope) {\n        function start(e) {\n            (e.originalEvent || e).preventDefault();\n            var x = e.clientX,\n                y = e.clientY,\n                scrollY = g.doc.documentElement.scrollTop || g.doc.body.scrollTop,\n                scrollX = g.doc.documentElement.scrollLeft || g.doc.body.scrollLeft;\n            this._drag.id = e.identifier;\n            if (supportsTouch && e.touches) {\n                var i = e.touches.length, touch;\n                while (i--) {\n                    touch = e.touches[i];\n                    this._drag.id = touch.identifier;\n                    if (touch.identifier == this._drag.id) {\n                        x = touch.clientX;\n                        y = touch.clientY;\n                        break;\n                    }\n                }\n            }\n            this._drag.x = x + scrollX;\n            this._drag.y = y + scrollY;\n            !drag.length && R.mousemove(dragMove).mouseup(dragUp);\n            drag.push({el: this, move_scope: move_scope, start_scope: start_scope, end_scope: end_scope});\n            onstart && eve.on("raphael.drag.start." + this.id, onstart);\n            onmove && eve.on("raphael.drag.move." + this.id, onmove);\n            onend && eve.on("raphael.drag.end." + this.id, onend);\n            eve("raphael.drag.start." + this.id, start_scope || move_scope || this, this._drag.x, this._drag.y, e);\n        }\n        this._drag = {};\n        draggable.push({el: this, start: start});\n        this.mousedown(start);\n        return this;\n    };\n    /*\\\n     * Element.onDragOver\n     [ method ]\n     **\n     * Shortcut for assigning event handler for `drag.over.<id>` event, where id is id of the element (see @Element.id).\n     > Parameters\n     - f (function) handler for event, first argument would be the element you are dragging over\n    \\*/\n    elproto.onDragOver = function (f) {\n        f ? eve.on("raphael.drag.over." + this.id, f) : eve.unbind("raphael.drag.over." + this.id);\n    };\n    /*\\\n     * Element.undrag\n     [ method ]\n     **\n     * Removes all drag event handlers from given element.\n    \\*/\n    elproto.undrag = function () {\n        var i = draggable.length;\n        while (i--) if (draggable[i].el == this) {\n            this.unmousedown(draggable[i].start);\n            draggable.splice(i, 1);\n            eve.unbind("raphael.drag.*." + this.id);\n        }\n        !draggable.length && R.unmousemove(dragMove).unmouseup(dragUp);\n        drag = [];\n    };\n    /*\\\n     * Paper.circle\n     [ method ]\n     **\n     * Draws a circle.\n     **\n     > Parameters\n     **\n     - x (number) x coordinate of the centre\n     - y (number) y coordinate of the centre\n     - r (number) radius\n     = (object) Raphaël element object with type “circle”\n     **\n     > Usage\n     | var c = paper.circle(50, 50, 40);\n    \\*/\n    paperproto.circle = function (x, y, r) {\n        var out = R._engine.circle(this, x || 0, y || 0, r || 0);\n        this.__set__ && this.__set__.push(out);\n        return out;\n    };\n    /*\\\n     * Paper.rect\n     [ method ]\n     *\n     * Draws a rectangle.\n     **\n     > Parameters\n     **\n     - x (number) x coordinate of the top left corner\n     - y (number) y coordinate of the top left corner\n     - width (number) width\n     - height (number) height\n     - r (number) #optional radius for rounded corners, default is 0\n     = (object) Raphaël element object with type “rect”\n     **\n     > Usage\n     | // regular rectangle\n     | var c = paper.rect(10, 10, 50, 50);\n     | // rectangle with rounded corners\n     | var c = paper.rect(40, 40, 50, 50, 10);\n    \\*/\n    paperproto.rect = function (x, y, w, h, r) {\n        var out = R._engine.rect(this, x || 0, y || 0, w || 0, h || 0, r || 0);\n        this.__set__ && this.__set__.push(out);\n        return out;\n    };\n    /*\\\n     * Paper.ellipse\n     [ method ]\n     **\n     * Draws an ellipse.\n     **\n     > Parameters\n     **\n     - x (number) x coordinate of the centre\n     - y (number) y coordinate of the centre\n     - rx (number) horizontal radius\n     - ry (number) vertical radius\n     = (object) Raphaël element object with type “ellipse”\n     **\n     > Usage\n     | var c = paper.ellipse(50, 50, 40, 20);\n    \\*/\n    paperproto.ellipse = function (x, y, rx, ry) {\n        var out = R._engine.ellipse(this, x || 0, y || 0, rx || 0, ry || 0);\n        this.__set__ && this.__set__.push(out);\n        return out;\n    };\n    /*\\\n     * Paper.path\n     [ method ]\n     **\n     * Creates a path element by given path data string.\n     > Parameters\n     - pathString (string) #optional path string in SVG format.\n     * Path string consists of one-letter commands, followed by comma seprarated arguments in numercal form. Example:\n     | "M10,20L30,40"\n     * Here we can see two commands: “M”, with arguments `(10, 20)` and “L” with arguments `(30, 40)`. Upper case letter mean command is absolute, lower case—relative.\n     *\n     # <p>Here is short list of commands available, for more details see <a href="http://www.w3.org/TR/SVG/paths.html#PathData" title="Details of a path\'s data attribute\'s format are described in the SVG specification.">SVG path string format</a>.</p>\n     # <table><thead><tr><th>Command</th><th>Name</th><th>Parameters</th></tr></thead><tbody>\n     # <tr><td>M</td><td>moveto</td><td>(x y)+</td></tr>\n     # <tr><td>Z</td><td>closepath</td><td>(none)</td></tr>\n     # <tr><td>L</td><td>lineto</td><td>(x y)+</td></tr>\n     # <tr><td>H</td><td>horizontal lineto</td><td>x+</td></tr>\n     # <tr><td>V</td><td>vertical lineto</td><td>y+</td></tr>\n     # <tr><td>C</td><td>curveto</td><td>(x1 y1 x2 y2 x y)+</td></tr>\n     # <tr><td>S</td><td>smooth curveto</td><td>(x2 y2 x y)+</td></tr>\n     # <tr><td>Q</td><td>quadratic Bézier curveto</td><td>(x1 y1 x y)+</td></tr>\n     # <tr><td>T</td><td>smooth quadratic Bézier curveto</td><td>(x y)+</td></tr>\n     # <tr><td>A</td><td>elliptical arc</td><td>(rx ry x-axis-rotation large-arc-flag sweep-flag x y)+</td></tr>\n     # <tr><td>R</td><td><a href="http://en.wikipedia.org/wiki/Catmull–Rom_spline#Catmull.E2.80.93Rom_spline">Catmull-Rom curveto</a>*</td><td>x1 y1 (x y)+</td></tr></tbody></table>\n     * * “Catmull-Rom curveto” is a not standard SVG command and added in 2.0 to make life easier.\n     * Note: there is a special case when path consist of just three commands: “M10,10R…z”. In this case path will smoothly connects to its beginning.\n     > Usage\n     | var c = paper.path("M10 10L90 90");\n     | // draw a diagonal line:\n     | // move to 10,10, line to 90,90\n     * For example of path strings, check out these icons: http://raphaeljs.com/icons/\n    \\*/\n    paperproto.path = function (pathString) {\n        pathString && !R.is(pathString, string) && !R.is(pathString[0], array) && (pathString += E);\n        var out = R._engine.path(R.format[apply](R, arguments), this);\n        this.__set__ && this.__set__.push(out);\n        return out;\n    };\n    /*\\\n     * Paper.image\n     [ method ]\n     **\n     * Embeds an image into the surface.\n     **\n     > Parameters\n     **\n     - src (string) URI of the source image\n     - x (number) x coordinate position\n     - y (number) y coordinate position\n     - width (number) width of the image\n     - height (number) height of the image\n     = (object) Raphaël element object with type “image”\n     **\n     > Usage\n     | var c = paper.image("apple.png", 10, 10, 80, 80);\n    \\*/\n    paperproto.image = function (src, x, y, w, h) {\n        var out = R._engine.image(this, src || "about:blank", x || 0, y || 0, w || 0, h || 0);\n        this.__set__ && this.__set__.push(out);\n        return out;\n    };\n    /*\\\n     * Paper.text\n     [ method ]\n     **\n     * Draws a text string. If you need line breaks, put “\\n” in the string.\n     **\n     > Parameters\n     **\n     - x (number) x coordinate position\n     - y (number) y coordinate position\n     - text (string) The text string to draw\n     = (object) Raphaël element object with type “text”\n     **\n     > Usage\n     | var t = paper.text(50, 50, "Raphaël\\nkicks\\nbutt!");\n    \\*/\n    paperproto.text = function (x, y, text) {\n        var out = R._engine.text(this, x || 0, y || 0, Str(text));\n        this.__set__ && this.__set__.push(out);\n        return out;\n    };\n    /*\\\n     * Paper.set\n     [ method ]\n     **\n     * Creates array-like object to keep and operate several elements at once.\n     * Warning: it doesn’t create any elements for itself in the page, it just groups existing elements.\n     * Sets act as pseudo elements — all methods available to an element can be used on a set.\n     = (object) array-like object that represents set of elements\n     **\n     > Usage\n     | var st = paper.set();\n     | st.push(\n     |     paper.circle(10, 10, 5),\n     |     paper.circle(30, 10, 5)\n     | );\n     | st.attr({fill: "red"}); // changes the fill of both circles\n    \\*/\n    paperproto.set = function (itemsArray) {\n        !R.is(itemsArray, "array") && (itemsArray = Array.prototype.splice.call(arguments, 0, arguments.length));\n        var out = new Set(itemsArray);\n        this.__set__ && this.__set__.push(out);\n        out["paper"] = this;\n        out["type"] = "set";\n        return out;\n    };\n    /*\\\n     * Paper.setStart\n     [ method ]\n     **\n     * Creates @Paper.set. All elements that will be created after calling this method and before calling\n     * @Paper.setFinish will be added to the set.\n     **\n     > Usage\n     | paper.setStart();\n     | paper.circle(10, 10, 5),\n     | paper.circle(30, 10, 5)\n     | var st = paper.setFinish();\n     | st.attr({fill: "red"}); // changes the fill of both circles\n    \\*/\n    paperproto.setStart = function (set) {\n        this.__set__ = set || this.set();\n    };\n    /*\\\n     * Paper.setFinish\n     [ method ]\n     **\n     * See @Paper.setStart. This method finishes catching and returns resulting set.\n     **\n     = (object) set\n    \\*/\n    paperproto.setFinish = function (set) {\n        var out = this.__set__;\n        delete this.__set__;\n        return out;\n    };\n    /*\\\n     * Paper.getSize\n     [ method ]\n     **\n     * Obtains current paper actual size.\n     **\n     = (object)\n     \\*/\n    paperproto.getSize = function () {\n        var container = this.canvas.parentNode;\n        return {\n            width: container.offsetWidth,\n            height: container.offsetHeight\n                };\n        };\n    /*\\\n     * Paper.setSize\n     [ method ]\n     **\n     * If you need to change dimensions of the canvas call this method\n     **\n     > Parameters\n     **\n     - width (number) new width of the canvas\n     - height (number) new height of the canvas\n    \\*/\n    paperproto.setSize = function (width, height) {\n        return R._engine.setSize.call(this, width, height);\n    };\n    /*\\\n     * Paper.setViewBox\n     [ method ]\n     **\n     * Sets the view box of the paper. Practically it gives you ability to zoom and pan whole paper surface by\n     * specifying new boundaries.\n     **\n     > Parameters\n     **\n     - x (number) new x position, default is `0`\n     - y (number) new y position, default is `0`\n     - w (number) new width of the canvas\n     - h (number) new height of the canvas\n     - fit (boolean) `true` if you want graphics to fit into new boundary box\n    \\*/\n    paperproto.setViewBox = function (x, y, w, h, fit) {\n        return R._engine.setViewBox.call(this, x, y, w, h, fit);\n    };\n    /*\\\n     * Paper.top\n     [ property ]\n     **\n     * Points to the topmost element on the paper\n    \\*/\n    /*\\\n     * Paper.bottom\n     [ property ]\n     **\n     * Points to the bottom element on the paper\n    \\*/\n    paperproto.top = paperproto.bottom = null;\n    /*\\\n     * Paper.raphael\n     [ property ]\n     **\n     * Points to the @Raphael object/function\n    \\*/\n    paperproto.raphael = R;\n    var getOffset = function (elem) {\n        var box = elem.getBoundingClientRect(),\n            doc = elem.ownerDocument,\n            body = doc.body,\n            docElem = doc.documentElement,\n            clientTop = docElem.clientTop || body.clientTop || 0, clientLeft = docElem.clientLeft || body.clientLeft || 0,\n            top  = box.top  + (g.win.pageYOffset || docElem.scrollTop || body.scrollTop ) - clientTop,\n            left = box.left + (g.win.pageXOffset || docElem.scrollLeft || body.scrollLeft) - clientLeft;\n        return {\n            y: top,\n            x: left\n        };\n    };\n    /*\\\n     * Paper.getElementByPoint\n     [ method ]\n     **\n     * Returns you topmost element under given point.\n     **\n     = (object) Raphaël element object\n     > Parameters\n     **\n     - x (number) x coordinate from the top left corner of the window\n     - y (number) y coordinate from the top left corner of the window\n     > Usage\n     | paper.getElementByPoint(mouseX, mouseY).attr({stroke: "#f00"});\n    \\*/\n    paperproto.getElementByPoint = function (x, y) {\n        var paper = this,\n            svg = paper.canvas,\n            target = g.doc.elementFromPoint(x, y);\n        if (g.win.opera && target.tagName == "svg") {\n            var so = getOffset(svg),\n                sr = svg.createSVGRect();\n            sr.x = x - so.x;\n            sr.y = y - so.y;\n            sr.width = sr.height = 1;\n            var hits = svg.getIntersectionList(sr, null);\n            if (hits.length) {\n                target = hits[hits.length - 1];\n            }\n        }\n        if (!target) {\n            return null;\n        }\n        while (target.parentNode && target != svg.parentNode && !target.raphael) {\n            target = target.parentNode;\n        }\n        target == paper.canvas.parentNode && (target = svg);\n        target = target && target.raphael ? paper.getById(target.raphaelid) : null;\n        return target;\n    };\n\n    /*\\\n     * Paper.getElementsByBBox\n     [ method ]\n     **\n     * Returns set of elements that have an intersecting bounding box\n     **\n     > Parameters\n     **\n     - bbox (object) bbox to check with\n     = (object) @Set\n     \\*/\n    paperproto.getElementsByBBox = function (bbox) {\n        var set = this.set();\n        this.forEach(function (el) {\n            if (R.isBBoxIntersect(el.getBBox(), bbox)) {\n                set.push(el);\n            }\n        });\n        return set;\n    };\n\n    /*\\\n     * Paper.getById\n     [ method ]\n     **\n     * Returns you element by its internal ID.\n     **\n     > Parameters\n     **\n     - id (number) id\n     = (object) Raphaël element object\n    \\*/\n    paperproto.getById = function (id) {\n        var bot = this.bottom;\n        while (bot) {\n            if (bot.id == id) {\n                return bot;\n            }\n            bot = bot.next;\n        }\n        return null;\n    };\n    /*\\\n     * Paper.forEach\n     [ method ]\n     **\n     * Executes given function for each element on the paper\n     *\n     * If callback function returns `false` it will stop loop running.\n     **\n     > Parameters\n     **\n     - callback (function) function to run\n     - thisArg (object) context object for the callback\n     = (object) Paper object\n     > Usage\n     | paper.forEach(function (el) {\n     |     el.attr({ stroke: "blue" });\n     | });\n    \\*/\n    paperproto.forEach = function (callback, thisArg) {\n        var bot = this.bottom;\n        while (bot) {\n            if (callback.call(thisArg, bot) === false) {\n                return this;\n            }\n            bot = bot.next;\n        }\n        return this;\n    };\n    /*\\\n     * Paper.getElementsByPoint\n     [ method ]\n     **\n     * Returns set of elements that have common point inside\n     **\n     > Parameters\n     **\n     - x (number) x coordinate of the point\n     - y (number) y coordinate of the point\n     = (object) @Set\n    \\*/\n    paperproto.getElementsByPoint = function (x, y) {\n        var set = this.set();\n        this.forEach(function (el) {\n            if (el.isPointInside(x, y)) {\n                set.push(el);\n            }\n        });\n        return set;\n    };\n    function x_y() {\n        return this.x + S + this.y;\n    }\n    function x_y_w_h() {\n        return this.x + S + this.y + S + this.width + " \\xd7 " + this.height;\n    }\n    /*\\\n     * Element.isPointInside\n     [ method ]\n     **\n     * Determine if given point is inside this element’s shape\n     **\n     > Parameters\n     **\n     - x (number) x coordinate of the point\n     - y (number) y coordinate of the point\n     = (boolean) `true` if point inside the shape\n    \\*/\n    elproto.isPointInside = function (x, y) {\n        var rp = this.realPath = getPath[this.type](this);\n        if (this.attr(\'transform\') && this.attr(\'transform\').length) {\n            rp = R.transformPath(rp, this.attr(\'transform\'));\n        }\n        return R.isPointInsidePath(rp, x, y);\n    };\n    /*\\\n     * Element.getBBox\n     [ method ]\n     **\n     * Return bounding box for a given element\n     **\n     > Parameters\n     **\n     - isWithoutTransform (boolean) flag, `true` if you want to have bounding box before transformations. Default is `false`.\n     = (object) Bounding box object:\n     o {\n     o     x: (number) top left corner x\n     o     y: (number) top left corner y\n     o     x2: (number) bottom right corner x\n     o     y2: (number) bottom right corner y\n     o     width: (number) width\n     o     height: (number) height\n     o }\n    \\*/\n    elproto.getBBox = function (isWithoutTransform) {\n        if (this.removed) {\n            return {};\n        }\n        var _ = this._;\n        if (isWithoutTransform) {\n            if (_.dirty || !_.bboxwt) {\n                this.realPath = getPath[this.type](this);\n                _.bboxwt = pathDimensions(this.realPath);\n                _.bboxwt.toString = x_y_w_h;\n                _.dirty = 0;\n            }\n            return _.bboxwt;\n        }\n        if (_.dirty || _.dirtyT || !_.bbox) {\n            if (_.dirty || !this.realPath) {\n                _.bboxwt = 0;\n                this.realPath = getPath[this.type](this);\n            }\n            _.bbox = pathDimensions(mapPath(this.realPath, this.matrix));\n            _.bbox.toString = x_y_w_h;\n            _.dirty = _.dirtyT = 0;\n        }\n        return _.bbox;\n    };\n    /*\\\n     * Element.clone\n     [ method ]\n     **\n     = (object) clone of a given element\n     **\n    \\*/\n    elproto.clone = function () {\n        if (this.removed) {\n            return null;\n        }\n        var out = this.paper[this.type]().attr(this.attr());\n        this.__set__ && this.__set__.push(out);\n        return out;\n    };\n    /*\\\n     * Element.glow\n     [ method ]\n     **\n     * Return set of elements that create glow-like effect around given element. See @Paper.set.\n     *\n     * Note: Glow is not connected to the element. If you change element attributes it won’t adjust itself.\n     **\n     > Parameters\n     **\n     - glow (object) #optional parameters object with all properties optional:\n     o {\n     o     width (number) size of the glow, default is `10`\n     o     fill (boolean) will it be filled, default is `false`\n     o     opacity (number) opacity, default is `0.5`\n     o     offsetx (number) horizontal offset, default is `0`\n     o     offsety (number) vertical offset, default is `0`\n     o     color (string) glow colour, default is `black`\n     o }\n     = (object) @Paper.set of elements that represents glow\n    \\*/\n    elproto.glow = function (glow) {\n        if (this.type == "text") {\n            return null;\n        }\n        glow = glow || {};\n        var s = {\n            width: (glow.width || 10) + (+this.attr("stroke-width") || 1),\n            fill: glow.fill || false,\n            opacity: glow.opacity == null ? .5 : glow.opacity,\n            offsetx: glow.offsetx || 0,\n            offsety: glow.offsety || 0,\n            color: glow.color || "#000"\n        },\n            c = s.width / 2,\n            r = this.paper,\n            out = r.set(),\n            path = this.realPath || getPath[this.type](this);\n        path = this.matrix ? mapPath(path, this.matrix) : path;\n        for (var i = 1; i < c + 1; i++) {\n            out.push(r.path(path).attr({\n                stroke: s.color,\n                fill: s.fill ? s.color : "none",\n                "stroke-linejoin": "round",\n                "stroke-linecap": "round",\n                "stroke-width": +(s.width / c * i).toFixed(3),\n                opacity: +(s.opacity / c).toFixed(3)\n            }));\n        }\n        return out.insertBefore(this).translate(s.offsetx, s.offsety);\n    };\n    var curveslengths = {},\n    getPointAtSegmentLength = function (p1x, p1y, c1x, c1y, c2x, c2y, p2x, p2y, length) {\n        if (length == null) {\n            return bezlen(p1x, p1y, c1x, c1y, c2x, c2y, p2x, p2y);\n        } else {\n            return R.findDotsAtSegment(p1x, p1y, c1x, c1y, c2x, c2y, p2x, p2y, getTatLen(p1x, p1y, c1x, c1y, c2x, c2y, p2x, p2y, length));\n        }\n    },\n    getLengthFactory = function (istotal, subpath) {\n        return function (path, length, onlystart) {\n            path = path2curve(path);\n            var x, y, p, l, sp = "", subpaths = {}, point,\n                len = 0;\n            for (var i = 0, ii = path.length; i < ii; i++) {\n                p = path[i];\n                if (p[0] == "M") {\n                    x = +p[1];\n                    y = +p[2];\n                } else {\n                    l = getPointAtSegmentLength(x, y, p[1], p[2], p[3], p[4], p[5], p[6]);\n                    if (len + l > length) {\n                        if (subpath && !subpaths.start) {\n                            point = getPointAtSegmentLength(x, y, p[1], p[2], p[3], p[4], p[5], p[6], length - len);\n                            sp += ["C" + point.start.x, point.start.y, point.m.x, point.m.y, point.x, point.y];\n                            if (onlystart) {return sp;}\n                            subpaths.start = sp;\n                            sp = ["M" + point.x, point.y + "C" + point.n.x, point.n.y, point.end.x, point.end.y, p[5], p[6]].join();\n                            len += l;\n                            x = +p[5];\n                            y = +p[6];\n                            continue;\n                        }\n                        if (!istotal && !subpath) {\n                            point = getPointAtSegmentLength(x, y, p[1], p[2], p[3], p[4], p[5], p[6], length - len);\n                            return {x: point.x, y: point.y, alpha: point.alpha};\n                        }\n                    }\n                    len += l;\n                    x = +p[5];\n                    y = +p[6];\n                }\n                sp += p.shift() + p;\n            }\n            subpaths.end = sp;\n            point = istotal ? len : subpath ? subpaths : R.findDotsAtSegment(x, y, p[0], p[1], p[2], p[3], p[4], p[5], 1);\n            point.alpha && (point = {x: point.x, y: point.y, alpha: point.alpha});\n            return point;\n        };\n    };\n    var getTotalLength = getLengthFactory(1),\n        getPointAtLength = getLengthFactory(),\n        getSubpathsAtLength = getLengthFactory(0, 1);\n    /*\\\n     * Raphael.getTotalLength\n     [ method ]\n     **\n     * Returns length of the given path in pixels.\n     **\n     > Parameters\n     **\n     - path (string) SVG path string.\n     **\n     = (number) length.\n    \\*/\n    R.getTotalLength = getTotalLength;\n    /*\\\n     * Raphael.getPointAtLength\n     [ method ]\n     **\n     * Return coordinates of the point located at the given length on the given path.\n     **\n     > Parameters\n     **\n     - path (string) SVG path string\n     - length (number)\n     **\n     = (object) representation of the point:\n     o {\n     o     x: (number) x coordinate\n     o     y: (number) y coordinate\n     o     alpha: (number) angle of derivative\n     o }\n    \\*/\n    R.getPointAtLength = getPointAtLength;\n    /*\\\n     * Raphael.getSubpath\n     [ method ]\n     **\n     * Return subpath of a given path from given length to given length.\n     **\n     > Parameters\n     **\n     - path (string) SVG path string\n     - from (number) position of the start of the segment\n     - to (number) position of the end of the segment\n     **\n     = (string) pathstring for the segment\n    \\*/\n    R.getSubpath = function (path, from, to) {\n        if (this.getTotalLength(path) - to < 1e-6) {\n            return getSubpathsAtLength(path, from).end;\n        }\n        var a = getSubpathsAtLength(path, to, 1);\n        return from ? getSubpathsAtLength(a, from).end : a;\n    };\n    /*\\\n     * Element.getTotalLength\n     [ method ]\n     **\n     * Returns length of the path in pixels. Only works for element of “path” type.\n     = (number) length.\n    \\*/\n    elproto.getTotalLength = function () {\n        var path = this.getPath();\n        if (!path) {\n            return;\n        }\n\n        if (this.node.getTotalLength) {\n            return this.node.getTotalLength();\n        }\n\n        return getTotalLength(path);\n    };\n    /*\\\n     * Element.getPointAtLength\n     [ method ]\n     **\n     * Return coordinates of the point located at the given length on the given path. Only works for element of “path” type.\n     **\n     > Parameters\n     **\n     - length (number)\n     **\n     = (object) representation of the point:\n     o {\n     o     x: (number) x coordinate\n     o     y: (number) y coordinate\n     o     alpha: (number) angle of derivative\n     o }\n    \\*/\n    elproto.getPointAtLength = function (length) {\n        var path = this.getPath();\n        if (!path) {\n            return;\n        }\n\n        return getPointAtLength(path, length);\n    };\n    /*\\\n     * Element.getPath\n     [ method ]\n     **\n     * Returns path of the element. Only works for elements of “path” type and simple elements like circle.\n     = (object) path\n     **\n    \\*/\n    elproto.getPath = function () {\n        var path,\n            getPath = R._getPath[this.type];\n\n        if (this.type == "text" || this.type == "set") {\n            return;\n        }\n\n        if (getPath) {\n            path = getPath(this);\n        }\n\n        return path;\n    };\n    /*\\\n     * Element.getSubpath\n     [ method ]\n     **\n     * Return subpath of a given element from given length to given length. Only works for element of “path” type.\n     **\n     > Parameters\n     **\n     - from (number) position of the start of the segment\n     - to (number) position of the end of the segment\n     **\n     = (string) pathstring for the segment\n    \\*/\n    elproto.getSubpath = function (from, to) {\n        var path = this.getPath();\n        if (!path) {\n            return;\n        }\n\n        return R.getSubpath(path, from, to);\n    };\n    /*\\\n     * Raphael.easing_formulas\n     [ property ]\n     **\n     * Object that contains easing formulas for animation. You could extend it with your own. By default it has following list of easing:\n     # <ul>\n     #     <li>“linear”</li>\n     #     <li>“&lt;” or “easeIn” or “ease-in”</li>\n     #     <li>“>” or “easeOut” or “ease-out”</li>\n     #     <li>“&lt;>” or “easeInOut” or “ease-in-out”</li>\n     #     <li>“backIn” or “back-in”</li>\n     #     <li>“backOut” or “back-out”</li>\n     #     <li>“elastic”</li>\n     #     <li>“bounce”</li>\n     # </ul>\n     # <p>See also <a href="http://raphaeljs.com/easing.html">Easing demo</a>.</p>\n    \\*/\n    var ef = R.easing_formulas = {\n        linear: function (n) {\n            return n;\n        },\n        "<": function (n) {\n            return pow(n, 1.7);\n        },\n        ">": function (n) {\n            return pow(n, .48);\n        },\n        "<>": function (n) {\n            var q = .48 - n / 1.04,\n                Q = math.sqrt(.1734 + q * q),\n                x = Q - q,\n                X = pow(abs(x), 1 / 3) * (x < 0 ? -1 : 1),\n                y = -Q - q,\n                Y = pow(abs(y), 1 / 3) * (y < 0 ? -1 : 1),\n                t = X + Y + .5;\n            return (1 - t) * 3 * t * t + t * t * t;\n        },\n        backIn: function (n) {\n            var s = 1.70158;\n            return n * n * ((s + 1) * n - s);\n        },\n        backOut: function (n) {\n            n = n - 1;\n            var s = 1.70158;\n            return n * n * ((s + 1) * n + s) + 1;\n        },\n        elastic: function (n) {\n            if (n == !!n) {\n                return n;\n            }\n            return pow(2, -10 * n) * math.sin((n - .075) * (2 * PI) / .3) + 1;\n        },\n        bounce: function (n) {\n            var s = 7.5625,\n                p = 2.75,\n                l;\n            if (n < (1 / p)) {\n                l = s * n * n;\n            } else {\n                if (n < (2 / p)) {\n                    n -= (1.5 / p);\n                    l = s * n * n + .75;\n                } else {\n                    if (n < (2.5 / p)) {\n                        n -= (2.25 / p);\n                        l = s * n * n + .9375;\n                    } else {\n                        n -= (2.625 / p);\n                        l = s * n * n + .984375;\n                    }\n                }\n            }\n            return l;\n        }\n    };\n    ef.easeIn = ef["ease-in"] = ef["<"];\n    ef.easeOut = ef["ease-out"] = ef[">"];\n    ef.easeInOut = ef["ease-in-out"] = ef["<>"];\n    ef["back-in"] = ef.backIn;\n    ef["back-out"] = ef.backOut;\n\n    var animationElements = [],\n        requestAnimFrame = window.requestAnimationFrame       ||\n                           window.webkitRequestAnimationFrame ||\n                           window.mozRequestAnimationFrame    ||\n                           window.oRequestAnimationFrame      ||\n                           window.msRequestAnimationFrame     ||\n                           function (callback) {\n                               setTimeout(callback, 16);\n                           },\n        animation = function () {\n            var Now = +new Date,\n                l = 0;\n            for (; l < animationElements.length; l++) {\n                var e = animationElements[l];\n                if (e.el.removed || e.paused) {\n                    continue;\n                }\n                var time = Now - e.start,\n                    ms = e.ms,\n                    easing = e.easing,\n                    from = e.from,\n                    diff = e.diff,\n                    to = e.to,\n                    t = e.t,\n                    that = e.el,\n                    set = {},\n                    now,\n                    init = {},\n                    key;\n                if (e.initstatus) {\n                    time = (e.initstatus * e.anim.top - e.prev) / (e.percent - e.prev) * ms;\n                    e.status = e.initstatus;\n                    delete e.initstatus;\n                    e.stop && animationElements.splice(l--, 1);\n                } else {\n                    e.status = (e.prev + (e.percent - e.prev) * (time / ms)) / e.anim.top;\n                }\n                if (time < 0) {\n                    continue;\n                }\n                if (time < ms) {\n                    var pos = easing(time / ms);\n                    for (var attr in from) if (from[has](attr)) {\n                        switch (availableAnimAttrs[attr]) {\n                            case nu:\n                                now = +from[attr] + pos * ms * diff[attr];\n                                break;\n                            case "colour":\n                                now = "rgb(" + [\n                                    upto255(round(from[attr].r + pos * ms * diff[attr].r)),\n                                    upto255(round(from[attr].g + pos * ms * diff[attr].g)),\n                                    upto255(round(from[attr].b + pos * ms * diff[attr].b))\n                                ].join(",") + ")";\n                                break;\n                            case "path":\n                                now = [];\n                                for (var i = 0, ii = from[attr].length; i < ii; i++) {\n                                    now[i] = [from[attr][i][0]];\n                                    for (var j = 1, jj = from[attr][i].length; j < jj; j++) {\n                                        now[i][j] = +from[attr][i][j] + pos * ms * diff[attr][i][j];\n                                    }\n                                    now[i] = now[i].join(S);\n                                }\n                                now = now.join(S);\n                                break;\n                            case "transform":\n                                if (diff[attr].real) {\n                                    now = [];\n                                    for (i = 0, ii = from[attr].length; i < ii; i++) {\n                                        now[i] = [from[attr][i][0]];\n                                        for (j = 1, jj = from[attr][i].length; j < jj; j++) {\n                                            now[i][j] = from[attr][i][j] + pos * ms * diff[attr][i][j];\n                                        }\n                                    }\n                                } else {\n                                    var get = function (i) {\n                                        return +from[attr][i] + pos * ms * diff[attr][i];\n                                    };\n                                    // now = [["r", get(2), 0, 0], ["t", get(3), get(4)], ["s", get(0), get(1), 0, 0]];\n                                    now = [["m", get(0), get(1), get(2), get(3), get(4), get(5)]];\n                                }\n                                break;\n                            case "csv":\n                                if (attr == "clip-rect") {\n                                    now = [];\n                                    i = 4;\n                                    while (i--) {\n                                        now[i] = +from[attr][i] + pos * ms * diff[attr][i];\n                                    }\n                                }\n                                break;\n                            default:\n                                var from2 = [][concat](from[attr]);\n                                now = [];\n                                i = that.paper.customAttributes[attr].length;\n                                while (i--) {\n                                    now[i] = +from2[i] + pos * ms * diff[attr][i];\n                                }\n                                break;\n                        }\n                        set[attr] = now;\n                    }\n                    that.attr(set);\n                    (function (id, that, anim) {\n                        setTimeout(function () {\n                            eve("raphael.anim.frame." + id, that, anim);\n                        });\n                    })(that.id, that, e.anim);\n                } else {\n                    (function(f, el, a) {\n                        setTimeout(function() {\n                            eve("raphael.anim.frame." + el.id, el, a);\n                            eve("raphael.anim.finish." + el.id, el, a);\n                            R.is(f, "function") && f.call(el);\n                        });\n                    })(e.callback, that, e.anim);\n                    that.attr(to);\n                    animationElements.splice(l--, 1);\n                    if (e.repeat > 1 && !e.next) {\n                        for (key in to) if (to[has](key)) {\n                            init[key] = e.totalOrigin[key];\n                        }\n                        e.el.attr(init);\n                        runAnimation(e.anim, e.el, e.anim.percents[0], null, e.totalOrigin, e.repeat - 1);\n                    }\n                    if (e.next && !e.stop) {\n                        runAnimation(e.anim, e.el, e.next, null, e.totalOrigin, e.repeat);\n                    }\n                }\n            }\n            animationElements.length && requestAnimFrame(animation);\n        },\n        upto255 = function (color) {\n            return color > 255 ? 255 : color < 0 ? 0 : color;\n        };\n    /*\\\n     * Element.animateWith\n     [ method ]\n     **\n     * Acts similar to @Element.animate, but ensure that given animation runs in sync with another given element.\n     **\n     > Parameters\n     **\n     - el (object) element to sync with\n     - anim (object) animation to sync with\n     - params (object) #optional final attributes for the element, see also @Element.attr\n     - ms (number) #optional number of milliseconds for animation to run\n     - easing (string) #optional easing type. Accept on of @Raphael.easing_formulas or CSS format: `cubic&#x2010;bezier(XX,&#160;XX,&#160;XX,&#160;XX)`\n     - callback (function) #optional callback function. Will be called at the end of animation.\n     * or\n     - element (object) element to sync with\n     - anim (object) animation to sync with\n     - animation (object) #optional animation object, see @Raphael.animation\n     **\n     = (object) original element\n    \\*/\n    elproto.animateWith = function (el, anim, params, ms, easing, callback) {\n        var element = this;\n        if (element.removed) {\n            callback && callback.call(element);\n            return element;\n        }\n        var a = params instanceof Animation ? params : R.animation(params, ms, easing, callback),\n            x, y;\n        runAnimation(a, element, a.percents[0], null, element.attr());\n        for (var i = 0, ii = animationElements.length; i < ii; i++) {\n            if (animationElements[i].anim == anim && animationElements[i].el == el) {\n                animationElements[ii - 1].start = animationElements[i].start;\n                break;\n            }\n        }\n        return element;\n        //\n        //\n        // var a = params ? R.animation(params, ms, easing, callback) : anim,\n        //     status = element.status(anim);\n        // return this.animate(a).status(a, status * anim.ms / a.ms);\n    };\n    function CubicBezierAtTime(t, p1x, p1y, p2x, p2y, duration) {\n        var cx = 3 * p1x,\n            bx = 3 * (p2x - p1x) - cx,\n            ax = 1 - cx - bx,\n            cy = 3 * p1y,\n            by = 3 * (p2y - p1y) - cy,\n            ay = 1 - cy - by;\n        function sampleCurveX(t) {\n            return ((ax * t + bx) * t + cx) * t;\n        }\n        function solve(x, epsilon) {\n            var t = solveCurveX(x, epsilon);\n            return ((ay * t + by) * t + cy) * t;\n        }\n        function solveCurveX(x, epsilon) {\n            var t0, t1, t2, x2, d2, i;\n            for(t2 = x, i = 0; i < 8; i++) {\n                x2 = sampleCurveX(t2) - x;\n                if (abs(x2) < epsilon) {\n                    return t2;\n                }\n                d2 = (3 * ax * t2 + 2 * bx) * t2 + cx;\n                if (abs(d2) < 1e-6) {\n                    break;\n                }\n                t2 = t2 - x2 / d2;\n            }\n            t0 = 0;\n            t1 = 1;\n            t2 = x;\n            if (t2 < t0) {\n                return t0;\n            }\n            if (t2 > t1) {\n                return t1;\n            }\n            while (t0 < t1) {\n                x2 = sampleCurveX(t2);\n                if (abs(x2 - x) < epsilon) {\n                    return t2;\n                }\n                if (x > x2) {\n                    t0 = t2;\n                } else {\n                    t1 = t2;\n                }\n                t2 = (t1 - t0) / 2 + t0;\n            }\n            return t2;\n        }\n        return solve(t, 1 / (200 * duration));\n    }\n    elproto.onAnimation = function (f) {\n        f ? eve.on("raphael.anim.frame." + this.id, f) : eve.unbind("raphael.anim.frame." + this.id);\n        return this;\n    };\n    function Animation(anim, ms) {\n        var percents = [],\n            newAnim = {};\n        this.ms = ms;\n        this.times = 1;\n        if (anim) {\n            for (var attr in anim) if (anim[has](attr)) {\n                newAnim[toFloat(attr)] = anim[attr];\n                percents.push(toFloat(attr));\n            }\n            percents.sort(sortByNumber);\n        }\n        this.anim = newAnim;\n        this.top = percents[percents.length - 1];\n        this.percents = percents;\n    }\n    /*\\\n     * Animation.delay\n     [ method ]\n     **\n     * Creates a copy of existing animation object with given delay.\n     **\n     > Parameters\n     **\n     - delay (number) number of ms to pass between animation start and actual animation\n     **\n     = (object) new altered Animation object\n     | var anim = Raphael.animation({cx: 10, cy: 20}, 2e3);\n     | circle1.animate(anim); // run the given animation immediately\n     | circle2.animate(anim.delay(500)); // run the given animation after 500 ms\n    \\*/\n    Animation.prototype.delay = function (delay) {\n        var a = new Animation(this.anim, this.ms);\n        a.times = this.times;\n        a.del = +delay || 0;\n        return a;\n    };\n    /*\\\n     * Animation.repeat\n     [ method ]\n     **\n     * Creates a copy of existing animation object with given repetition.\n     **\n     > Parameters\n     **\n     - repeat (number) number iterations of animation. For infinite animation pass `Infinity`\n     **\n     = (object) new altered Animation object\n    \\*/\n    Animation.prototype.repeat = function (times) {\n        var a = new Animation(this.anim, this.ms);\n        a.del = this.del;\n        a.times = math.floor(mmax(times, 0)) || 1;\n        return a;\n    };\n    function runAnimation(anim, element, percent, status, totalOrigin, times) {\n        percent = toFloat(percent);\n        var params,\n            isInAnim,\n            isInAnimSet,\n            percents = [],\n            next,\n            prev,\n            timestamp,\n            ms = anim.ms,\n            from = {},\n            to = {},\n            diff = {};\n        if (status) {\n            for (i = 0, ii = animationElements.length; i < ii; i++) {\n                var e = animationElements[i];\n                if (e.el.id == element.id && e.anim == anim) {\n                    if (e.percent != percent) {\n                        animationElements.splice(i, 1);\n                        isInAnimSet = 1;\n                    } else {\n                        isInAnim = e;\n                    }\n                    element.attr(e.totalOrigin);\n                    break;\n                }\n            }\n        } else {\n            status = +to; // NaN\n        }\n        for (var i = 0, ii = anim.percents.length; i < ii; i++) {\n            if (anim.percents[i] == percent || anim.percents[i] > status * anim.top) {\n                percent = anim.percents[i];\n                prev = anim.percents[i - 1] || 0;\n                ms = ms / anim.top * (percent - prev);\n                next = anim.percents[i + 1];\n                params = anim.anim[percent];\n                break;\n            } else if (status) {\n                element.attr(anim.anim[anim.percents[i]]);\n            }\n        }\n        if (!params) {\n            return;\n        }\n        if (!isInAnim) {\n            for (var attr in params) if (params[has](attr)) {\n                if (availableAnimAttrs[has](attr) || element.paper.customAttributes[has](attr)) {\n                    from[attr] = element.attr(attr);\n                    (from[attr] == null) && (from[attr] = availableAttrs[attr]);\n                    to[attr] = params[attr];\n                    switch (availableAnimAttrs[attr]) {\n                        case nu:\n                            diff[attr] = (to[attr] - from[attr]) / ms;\n                            break;\n                        case "colour":\n                            from[attr] = R.getRGB(from[attr]);\n                            var toColour = R.getRGB(to[attr]);\n                            diff[attr] = {\n                                r: (toColour.r - from[attr].r) / ms,\n                                g: (toColour.g - from[attr].g) / ms,\n                                b: (toColour.b - from[attr].b) / ms\n                            };\n                            break;\n                        case "path":\n                            var pathes = path2curve(from[attr], to[attr]),\n                                toPath = pathes[1];\n                            from[attr] = pathes[0];\n                            diff[attr] = [];\n                            for (i = 0, ii = from[attr].length; i < ii; i++) {\n                                diff[attr][i] = [0];\n                                for (var j = 1, jj = from[attr][i].length; j < jj; j++) {\n                                    diff[attr][i][j] = (toPath[i][j] - from[attr][i][j]) / ms;\n                                }\n                            }\n                            break;\n                        case "transform":\n                            var _ = element._,\n                                eq = equaliseTransform(_[attr], to[attr]);\n                            if (eq) {\n                                from[attr] = eq.from;\n                                to[attr] = eq.to;\n                                diff[attr] = [];\n                                diff[attr].real = true;\n                                for (i = 0, ii = from[attr].length; i < ii; i++) {\n                                    diff[attr][i] = [from[attr][i][0]];\n                                    for (j = 1, jj = from[attr][i].length; j < jj; j++) {\n                                        diff[attr][i][j] = (to[attr][i][j] - from[attr][i][j]) / ms;\n                                    }\n                                }\n                            } else {\n                                var m = (element.matrix || new Matrix),\n                                    to2 = {\n                                        _: {transform: _.transform},\n                                        getBBox: function () {\n                                            return element.getBBox(1);\n                                        }\n                                    };\n                                from[attr] = [\n                                    m.a,\n                                    m.b,\n                                    m.c,\n                                    m.d,\n                                    m.e,\n                                    m.f\n                                ];\n                                extractTransform(to2, to[attr]);\n                                to[attr] = to2._.transform;\n                                diff[attr] = [\n                                    (to2.matrix.a - m.a) / ms,\n                                    (to2.matrix.b - m.b) / ms,\n                                    (to2.matrix.c - m.c) / ms,\n                                    (to2.matrix.d - m.d) / ms,\n                                    (to2.matrix.e - m.e) / ms,\n                                    (to2.matrix.f - m.f) / ms\n                                ];\n                                // from[attr] = [_.sx, _.sy, _.deg, _.dx, _.dy];\n                                // var to2 = {_:{}, getBBox: function () { return element.getBBox(); }};\n                                // extractTransform(to2, to[attr]);\n                                // diff[attr] = [\n                                //     (to2._.sx - _.sx) / ms,\n                                //     (to2._.sy - _.sy) / ms,\n                                //     (to2._.deg - _.deg) / ms,\n                                //     (to2._.dx - _.dx) / ms,\n                                //     (to2._.dy - _.dy) / ms\n                                // ];\n                            }\n                            break;\n                        case "csv":\n                            var values = Str(params[attr])[split](separator),\n                                from2 = Str(from[attr])[split](separator);\n                            if (attr == "clip-rect") {\n                                from[attr] = from2;\n                                diff[attr] = [];\n                                i = from2.length;\n                                while (i--) {\n                                    diff[attr][i] = (values[i] - from[attr][i]) / ms;\n                                }\n                            }\n                            to[attr] = values;\n                            break;\n                        default:\n                            values = [][concat](params[attr]);\n                            from2 = [][concat](from[attr]);\n                            diff[attr] = [];\n                            i = element.paper.customAttributes[attr].length;\n                            while (i--) {\n                                diff[attr][i] = ((values[i] || 0) - (from2[i] || 0)) / ms;\n                            }\n                            break;\n                    }\n                }\n            }\n            var easing = params.easing,\n                easyeasy = R.easing_formulas[easing];\n            if (!easyeasy) {\n                easyeasy = Str(easing).match(bezierrg);\n                if (easyeasy && easyeasy.length == 5) {\n                    var curve = easyeasy;\n                    easyeasy = function (t) {\n                        return CubicBezierAtTime(t, +curve[1], +curve[2], +curve[3], +curve[4], ms);\n                    };\n                } else {\n                    easyeasy = pipe;\n                }\n            }\n            timestamp = params.start || anim.start || +new Date;\n            e = {\n                anim: anim,\n                percent: percent,\n                timestamp: timestamp,\n                start: timestamp + (anim.del || 0),\n                status: 0,\n                initstatus: status || 0,\n                stop: false,\n                ms: ms,\n                easing: easyeasy,\n                from: from,\n                diff: diff,\n                to: to,\n                el: element,\n                callback: params.callback,\n                prev: prev,\n                next: next,\n                repeat: times || anim.times,\n                origin: element.attr(),\n                totalOrigin: totalOrigin\n            };\n            animationElements.push(e);\n            if (status && !isInAnim && !isInAnimSet) {\n                e.stop = true;\n                e.start = new Date - ms * status;\n                if (animationElements.length == 1) {\n                    return animation();\n                }\n            }\n            if (isInAnimSet) {\n                e.start = new Date - e.ms * status;\n            }\n            animationElements.length == 1 && requestAnimFrame(animation);\n        } else {\n            isInAnim.initstatus = status;\n            isInAnim.start = new Date - isInAnim.ms * status;\n        }\n        eve("raphael.anim.start." + element.id, element, anim);\n    }\n    /*\\\n     * Raphael.animation\n     [ method ]\n     **\n     * Creates an animation object that can be passed to the @Element.animate or @Element.animateWith methods.\n     * See also @Animation.delay and @Animation.repeat methods.\n     **\n     > Parameters\n     **\n     - params (object) final attributes for the element, see also @Element.attr\n     - ms (number) number of milliseconds for animation to run\n     - easing (string) #optional easing type. Accept one of @Raphael.easing_formulas or CSS format: `cubic&#x2010;bezier(XX,&#160;XX,&#160;XX,&#160;XX)`\n     - callback (function) #optional callback function. Will be called at the end of animation.\n     **\n     = (object) @Animation\n    \\*/\n    R.animation = function (params, ms, easing, callback) {\n        if (params instanceof Animation) {\n            return params;\n        }\n        if (R.is(easing, "function") || !easing) {\n            callback = callback || easing || null;\n            easing = null;\n        }\n        params = Object(params);\n        ms = +ms || 0;\n        var p = {},\n            json,\n            attr;\n        for (attr in params) if (params[has](attr) && toFloat(attr) != attr && toFloat(attr) + "%" != attr) {\n            json = true;\n            p[attr] = params[attr];\n        }\n        if (!json) {\n            // if percent-like syntax is used and end-of-all animation callback used\n            if(callback){\n                // find the last one\n                var lastKey = 0;\n                for(var i in params){\n                    var percent = toInt(i);\n                    if(params[has](i) && percent > lastKey){\n                        lastKey = percent;\n                    }\n                }\n                lastKey += \'%\';\n                // if already defined callback in the last keyframe, skip\n                !params[lastKey].callback && (params[lastKey].callback = callback);\n            }\n          return new Animation(params, ms);\n        } else {\n            easing && (p.easing = easing);\n            callback && (p.callback = callback);\n            return new Animation({100: p}, ms);\n        }\n    };\n    /*\\\n     * Element.animate\n     [ method ]\n     **\n     * Creates and starts animation for given element.\n     **\n     > Parameters\n     **\n     - params (object) final attributes for the element, see also @Element.attr\n     - ms (number) number of milliseconds for animation to run\n     - easing (string) #optional easing type. Accept one of @Raphael.easing_formulas or CSS format: `cubic&#x2010;bezier(XX,&#160;XX,&#160;XX,&#160;XX)`\n     - callback (function) #optional callback function. Will be called at the end of animation.\n     * or\n     - animation (object) animation object, see @Raphael.animation\n     **\n     = (object) original element\n    \\*/\n    elproto.animate = function (params, ms, easing, callback) {\n        var element = this;\n        if (element.removed) {\n            callback && callback.call(element);\n            return element;\n        }\n        var anim = params instanceof Animation ? params : R.animation(params, ms, easing, callback);\n        runAnimation(anim, element, anim.percents[0], null, element.attr());\n        return element;\n    };\n    /*\\\n     * Element.setTime\n     [ method ]\n     **\n     * Sets the status of animation of the element in milliseconds. Similar to @Element.status method.\n     **\n     > Parameters\n     **\n     - anim (object) animation object\n     - value (number) number of milliseconds from the beginning of the animation\n     **\n     = (object) original element if `value` is specified\n     * Note, that during animation following events are triggered:\n     *\n     * On each animation frame event `anim.frame.<id>`, on start `anim.start.<id>` and on end `anim.finish.<id>`.\n    \\*/\n    elproto.setTime = function (anim, value) {\n        if (anim && value != null) {\n            this.status(anim, mmin(value, anim.ms) / anim.ms);\n        }\n        return this;\n    };\n    /*\\\n     * Element.status\n     [ method ]\n     **\n     * Gets or sets the status of animation of the element.\n     **\n     > Parameters\n     **\n     - anim (object) #optional animation object\n     - value (number) #optional 0 – 1. If specified, method works like a setter and sets the status of a given animation to the value. This will cause animation to jump to the given position.\n     **\n     = (number) status\n     * or\n     = (array) status if `anim` is not specified. Array of objects in format:\n     o {\n     o     anim: (object) animation object\n     o     status: (number) status\n     o }\n     * or\n     = (object) original element if `value` is specified\n    \\*/\n    elproto.status = function (anim, value) {\n        var out = [],\n            i = 0,\n            len,\n            e;\n        if (value != null) {\n            runAnimation(anim, this, -1, mmin(value, 1));\n            return this;\n        } else {\n            len = animationElements.length;\n            for (; i < len; i++) {\n                e = animationElements[i];\n                if (e.el.id == this.id && (!anim || e.anim == anim)) {\n                    if (anim) {\n                        return e.status;\n                    }\n                    out.push({\n                        anim: e.anim,\n                        status: e.status\n                    });\n                }\n            }\n            if (anim) {\n                return 0;\n            }\n            return out;\n        }\n    };\n    /*\\\n     * Element.pause\n     [ method ]\n     **\n     * Stops animation of the element with ability to resume it later on.\n     **\n     > Parameters\n     **\n     - anim (object) #optional animation object\n     **\n     = (object) original element\n    \\*/\n    elproto.pause = function (anim) {\n        for (var i = 0; i < animationElements.length; i++) if (animationElements[i].el.id == this.id && (!anim || animationElements[i].anim == anim)) {\n            if (eve("raphael.anim.pause." + this.id, this, animationElements[i].anim) !== false) {\n                animationElements[i].paused = true;\n            }\n        }\n        return this;\n    };\n    /*\\\n     * Element.resume\n     [ method ]\n     **\n     * Resumes animation if it was paused with @Element.pause method.\n     **\n     > Parameters\n     **\n     - anim (object) #optional animation object\n     **\n     = (object) original element\n    \\*/\n    elproto.resume = function (anim) {\n        for (var i = 0; i < animationElements.length; i++) if (animationElements[i].el.id == this.id && (!anim || animationElements[i].anim == anim)) {\n            var e = animationElements[i];\n            if (eve("raphael.anim.resume." + this.id, this, e.anim) !== false) {\n                delete e.paused;\n                this.status(e.anim, e.status);\n            }\n        }\n        return this;\n    };\n    /*\\\n     * Element.stop\n     [ method ]\n     **\n     * Stops animation of the element.\n     **\n     > Parameters\n     **\n     - anim (object) #optional animation object\n     **\n     = (object) original element\n    \\*/\n    elproto.stop = function (anim) {\n        for (var i = 0; i < animationElements.length; i++) if (animationElements[i].el.id == this.id && (!anim || animationElements[i].anim == anim)) {\n            if (eve("raphael.anim.stop." + this.id, this, animationElements[i].anim) !== false) {\n                animationElements.splice(i--, 1);\n            }\n        }\n        return this;\n    };\n    function stopAnimation(paper) {\n        for (var i = 0; i < animationElements.length; i++) if (animationElements[i].el.paper == paper) {\n            animationElements.splice(i--, 1);\n        }\n    }\n    eve.on("raphael.remove", stopAnimation);\n    eve.on("raphael.clear", stopAnimation);\n    elproto.toString = function () {\n        return "Rapha\\xebl\\u2019s object";\n    };\n\n    // Set\n    var Set = function (items) {\n        this.items = [];\n        this.length = 0;\n        this.type = "set";\n        if (items) {\n            for (var i = 0, ii = items.length; i < ii; i++) {\n                if (items[i] && (items[i].constructor == elproto.constructor || items[i].constructor == Set)) {\n                    this[this.items.length] = this.items[this.items.length] = items[i];\n                    this.length++;\n                }\n            }\n        }\n    },\n    setproto = Set.prototype;\n    /*\\\n     * Set.push\n     [ method ]\n     **\n     * Adds each argument to the current set.\n     = (object) original element\n    \\*/\n    setproto.push = function () {\n        var item,\n            len;\n        for (var i = 0, ii = arguments.length; i < ii; i++) {\n            item = arguments[i];\n            if (item && (item.constructor == elproto.constructor || item.constructor == Set)) {\n                len = this.items.length;\n                this[len] = this.items[len] = item;\n                this.length++;\n            }\n        }\n        return this;\n    };\n    /*\\\n     * Set.pop\n     [ method ]\n     **\n     * Removes last element and returns it.\n     = (object) element\n    \\*/\n    setproto.pop = function () {\n        this.length && delete this[this.length--];\n        return this.items.pop();\n    };\n    /*\\\n     * Set.forEach\n     [ method ]\n     **\n     * Executes given function for each element in the set.\n     *\n     * If function returns `false` it will stop loop running.\n     **\n     > Parameters\n     **\n     - callback (function) function to run\n     - thisArg (object) context object for the callback\n     = (object) Set object\n    \\*/\n    setproto.forEach = function (callback, thisArg) {\n        for (var i = 0, ii = this.items.length; i < ii; i++) {\n            if (callback.call(thisArg, this.items[i], i) === false) {\n                return this;\n            }\n        }\n        return this;\n    };\n    for (var method in elproto) if (elproto[has](method)) {\n        setproto[method] = (function (methodname) {\n            return function () {\n                var arg = arguments;\n                return this.forEach(function (el) {\n                    el[methodname][apply](el, arg);\n                });\n            };\n        })(method);\n    }\n    setproto.attr = function (name, value) {\n        if (name && R.is(name, array) && R.is(name[0], "object")) {\n            for (var j = 0, jj = name.length; j < jj; j++) {\n                this.items[j].attr(name[j]);\n            }\n        } else {\n            for (var i = 0, ii = this.items.length; i < ii; i++) {\n                this.items[i].attr(name, value);\n            }\n        }\n        return this;\n    };\n    /*\\\n     * Set.clear\n     [ method ]\n     **\n     * Removes all elements from the set\n    \\*/\n    setproto.clear = function () {\n        while (this.length) {\n            this.pop();\n        }\n    };\n    /*\\\n     * Set.splice\n     [ method ]\n     **\n     * Removes given element from the set\n     **\n     > Parameters\n     **\n     - index (number) position of the deletion\n     - count (number) number of element to remove\n     - insertion… (object) #optional elements to insert\n     = (object) set elements that were deleted\n    \\*/\n    setproto.splice = function (index, count, insertion) {\n        index = index < 0 ? mmax(this.length + index, 0) : index;\n        count = mmax(0, mmin(this.length - index, count));\n        var tail = [],\n            todel = [],\n            args = [],\n            i;\n        for (i = 2; i < arguments.length; i++) {\n            args.push(arguments[i]);\n        }\n        for (i = 0; i < count; i++) {\n            todel.push(this[index + i]);\n        }\n        for (; i < this.length - index; i++) {\n            tail.push(this[index + i]);\n        }\n        var arglen = args.length;\n        for (i = 0; i < arglen + tail.length; i++) {\n            this.items[index + i] = this[index + i] = i < arglen ? args[i] : tail[i - arglen];\n        }\n        i = this.items.length = this.length -= count - arglen;\n        while (this[i]) {\n            delete this[i++];\n        }\n        return new Set(todel);\n    };\n    /*\\\n     * Set.exclude\n     [ method ]\n     **\n     * Removes given element from the set\n     **\n     > Parameters\n     **\n     - element (object) element to remove\n     = (boolean) `true` if object was found & removed from the set\n    \\*/\n    setproto.exclude = function (el) {\n        for (var i = 0, ii = this.length; i < ii; i++) if (this[i] == el) {\n            this.splice(i, 1);\n            return true;\n        }\n    };\n    setproto.animate = function (params, ms, easing, callback) {\n        (R.is(easing, "function") || !easing) && (callback = easing || null);\n        var len = this.items.length,\n            i = len,\n            item,\n            set = this,\n            collector;\n        if (!len) {\n            return this;\n        }\n        callback && (collector = function () {\n            !--len && callback.call(set);\n        });\n        easing = R.is(easing, string) ? easing : collector;\n        var anim = R.animation(params, ms, easing, collector);\n        item = this.items[--i].animate(anim);\n        while (i--) {\n            this.items[i] && !this.items[i].removed && this.items[i].animateWith(item, anim, anim);\n            (this.items[i] && !this.items[i].removed) || len--;\n        }\n        return this;\n    };\n    setproto.insertAfter = function (el) {\n        var i = this.items.length;\n        while (i--) {\n            this.items[i].insertAfter(el);\n        }\n        return this;\n    };\n    setproto.getBBox = function () {\n        var x = [],\n            y = [],\n            x2 = [],\n            y2 = [];\n        for (var i = this.items.length; i--;) if (!this.items[i].removed) {\n            var box = this.items[i].getBBox();\n            x.push(box.x);\n            y.push(box.y);\n            x2.push(box.x + box.width);\n            y2.push(box.y + box.height);\n        }\n        x = mmin[apply](0, x);\n        y = mmin[apply](0, y);\n        x2 = mmax[apply](0, x2);\n        y2 = mmax[apply](0, y2);\n        return {\n            x: x,\n            y: y,\n            x2: x2,\n            y2: y2,\n            width: x2 - x,\n            height: y2 - y\n        };\n    };\n    setproto.clone = function (s) {\n        s = this.paper.set();\n        for (var i = 0, ii = this.items.length; i < ii; i++) {\n            s.push(this.items[i].clone());\n        }\n        return s;\n    };\n    setproto.toString = function () {\n        return "Rapha\\xebl\\u2018s set";\n    };\n\n    setproto.glow = function(glowConfig) {\n        var ret = this.paper.set();\n        this.forEach(function(shape, index){\n            var g = shape.glow(glowConfig);\n            if(g != null){\n                g.forEach(function(shape2, index2){\n                    ret.push(shape2);\n                });\n            }\n        });\n        return ret;\n    };\n\n\n    /*\\\n     * Set.isPointInside\n     [ method ]\n     **\n     * Determine if given point is inside this set’s elements\n     **\n     > Parameters\n     **\n     - x (number) x coordinate of the point\n     - y (number) y coordinate of the point\n     = (boolean) `true` if point is inside any of the set\'s elements\n     \\*/\n    setproto.isPointInside = function (x, y) {\n        var isPointInside = false;\n        this.forEach(function (el) {\n            if (el.isPointInside(x, y)) {\n                isPointInside = true;\n                return false; // stop loop\n            }\n        });\n        return isPointInside;\n    };\n\n    /*\\\n     * Raphael.registerFont\n     [ method ]\n     **\n     * Adds given font to the registered set of fonts for Raphaël. Should be used as an internal call from within Cufón’s font file.\n     * Returns original parameter, so it could be used with chaining.\n     # <a href="http://wiki.github.com/sorccu/cufon/about">More about Cufón and how to convert your font form TTF, OTF, etc to JavaScript file.</a>\n     **\n     > Parameters\n     **\n     - font (object) the font to register\n     = (object) the font you passed in\n     > Usage\n     | Cufon.registerFont(Raphael.registerFont({…}));\n    \\*/\n    R.registerFont = function (font) {\n        if (!font.face) {\n            return font;\n        }\n        this.fonts = this.fonts || {};\n        var fontcopy = {\n                w: font.w,\n                face: {},\n                glyphs: {}\n            },\n            family = font.face["font-family"];\n        for (var prop in font.face) if (font.face[has](prop)) {\n            fontcopy.face[prop] = font.face[prop];\n        }\n        if (this.fonts[family]) {\n            this.fonts[family].push(fontcopy);\n        } else {\n            this.fonts[family] = [fontcopy];\n        }\n        if (!font.svg) {\n            fontcopy.face["units-per-em"] = toInt(font.face["units-per-em"], 10);\n            for (var glyph in font.glyphs) if (font.glyphs[has](glyph)) {\n                var path = font.glyphs[glyph];\n                fontcopy.glyphs[glyph] = {\n                    w: path.w,\n                    k: {},\n                    d: path.d && "M" + path.d.replace(/[mlcxtrv]/g, function (command) {\n                            return {l: "L", c: "C", x: "z", t: "m", r: "l", v: "c"}[command] || "M";\n                        }) + "z"\n                };\n                if (path.k) {\n                    for (var k in path.k) if (path[has](k)) {\n                        fontcopy.glyphs[glyph].k[k] = path.k[k];\n                    }\n                }\n            }\n        }\n        return font;\n    };\n    /*\\\n     * Paper.getFont\n     [ method ]\n     **\n     * Finds font object in the registered fonts by given parameters. You could specify only one word from the font name, like “Myriad” for “Myriad Pro”.\n     **\n     > Parameters\n     **\n     - family (string) font family name or any word from it\n     - weight (string) #optional font weight\n     - style (string) #optional font style\n     - stretch (string) #optional font stretch\n     = (object) the font object\n     > Usage\n     | paper.print(100, 100, "Test string", paper.getFont("Times", 800), 30);\n    \\*/\n    paperproto.getFont = function (family, weight, style, stretch) {\n        stretch = stretch || "normal";\n        style = style || "normal";\n        weight = +weight || {normal: 400, bold: 700, lighter: 300, bolder: 800}[weight] || 400;\n        if (!R.fonts) {\n            return;\n        }\n        var font = R.fonts[family];\n        if (!font) {\n            var name = new RegExp("(^|\\\\s)" + family.replace(/[^\\w\\d\\s+!~.:_-]/g, E) + "(\\\\s|$)", "i");\n            for (var fontName in R.fonts) if (R.fonts[has](fontName)) {\n                if (name.test(fontName)) {\n                    font = R.fonts[fontName];\n                    break;\n                }\n            }\n        }\n        var thefont;\n        if (font) {\n            for (var i = 0, ii = font.length; i < ii; i++) {\n                thefont = font[i];\n                if (thefont.face["font-weight"] == weight && (thefont.face["font-style"] == style || !thefont.face["font-style"]) && thefont.face["font-stretch"] == stretch) {\n                    break;\n                }\n            }\n        }\n        return thefont;\n    };\n    /*\\\n     * Paper.print\n     [ method ]\n     **\n     * Creates path that represent given text written using given font at given position with given size.\n     * Result of the method is path element that contains whole text as a separate path.\n     **\n     > Parameters\n     **\n     - x (number) x position of the text\n     - y (number) y position of the text\n     - string (string) text to print\n     - font (object) font object, see @Paper.getFont\n     - size (number) #optional size of the font, default is `16`\n     - origin (string) #optional could be `"baseline"` or `"middle"`, default is `"middle"`\n     - letter_spacing (number) #optional number in range `-1..1`, default is `0`\n     - line_spacing (number) #optional number in range `1..3`, default is `1`\n     = (object) resulting path element, which consist of all letters\n     > Usage\n     | var txt = r.print(10, 50, "print", r.getFont("Museo"), 30).attr({fill: "#fff"});\n    \\*/\n    paperproto.print = function (x, y, string, font, size, origin, letter_spacing, line_spacing) {\n        origin = origin || "middle"; // baseline|middle\n        letter_spacing = mmax(mmin(letter_spacing || 0, 1), -1);\n        line_spacing = mmax(mmin(line_spacing || 1, 3), 1);\n        var letters = Str(string)[split](E),\n            shift = 0,\n            notfirst = 0,\n            path = E,\n            scale;\n        R.is(font, "string") && (font = this.getFont(font));\n        if (font) {\n            scale = (size || 16) / font.face["units-per-em"];\n            var bb = font.face.bbox[split](separator),\n                top = +bb[0],\n                lineHeight = bb[3] - bb[1],\n                shifty = 0,\n                height = +bb[1] + (origin == "baseline" ? lineHeight + (+font.face.descent) : lineHeight / 2);\n            for (var i = 0, ii = letters.length; i < ii; i++) {\n                if (letters[i] == "\\n") {\n                    shift = 0;\n                    curr = 0;\n                    notfirst = 0;\n                    shifty += lineHeight * line_spacing;\n                } else {\n                    var prev = notfirst && font.glyphs[letters[i - 1]] || {},\n                        curr = font.glyphs[letters[i]];\n                    shift += notfirst ? (prev.w || font.w) + (prev.k && prev.k[letters[i]] || 0) + (font.w * letter_spacing) : 0;\n                    notfirst = 1;\n                }\n                if (curr && curr.d) {\n                    path += R.transformPath(curr.d, ["t", shift * scale, shifty * scale, "s", scale, scale, top, height, "t", (x - top) / scale, (y - height) / scale]);\n                }\n            }\n        }\n        return this.path(path).attr({\n            fill: "#000",\n            stroke: "none"\n        });\n    };\n\n    /*\\\n     * Paper.add\n     [ method ]\n     **\n     * Imports elements in JSON array in format `{type: type, <attributes>}`\n     **\n     > Parameters\n     **\n     - json (array)\n     = (object) resulting set of imported elements\n     > Usage\n     | paper.add([\n     |     {\n     |         type: "circle",\n     |         cx: 10,\n     |         cy: 10,\n     |         r: 5\n     |     },\n     |     {\n     |         type: "rect",\n     |         x: 10,\n     |         y: 10,\n     |         width: 10,\n     |         height: 10,\n     |         fill: "#fc0"\n     |     }\n     | ]);\n    \\*/\n    paperproto.add = function (json) {\n        if (R.is(json, "array")) {\n            var res = this.set(),\n                i = 0,\n                ii = json.length,\n                j;\n            for (; i < ii; i++) {\n                j = json[i] || {};\n                elements[has](j.type) && res.push(this[j.type]().attr(j));\n            }\n        }\n        return res;\n    };\n\n    /*\\\n     * Raphael.format\n     [ method ]\n     **\n     * Simple format function. Replaces construction of type “`{<number>}`” to the corresponding argument.\n     **\n     > Parameters\n     **\n     - token (string) string to format\n     - … (string) rest of arguments will be treated as parameters for replacement\n     = (string) formated string\n     > Usage\n     | var x = 10,\n     |     y = 20,\n     |     width = 40,\n     |     height = 50;\n     | // this will draw a rectangular shape equivalent to "M10,20h40v50h-40z"\n     | paper.path(Raphael.format("M{0},{1}h{2}v{3}h{4}z", x, y, width, height, -width));\n    \\*/\n    R.format = function (token, params) {\n        var args = R.is(params, array) ? [0][concat](params) : arguments;\n        token && R.is(token, string) && args.length - 1 && (token = token.replace(formatrg, function (str, i) {\n            return args[++i] == null ? E : args[i];\n        }));\n        return token || E;\n    };\n    /*\\\n     * Raphael.fullfill\n     [ method ]\n     **\n     * A little bit more advanced format function than @Raphael.format. Replaces construction of type “`{<name>}`” to the corresponding argument.\n     **\n     > Parameters\n     **\n     - token (string) string to format\n     - json (object) object which properties will be used as a replacement\n     = (string) formated string\n     > Usage\n     | // this will draw a rectangular shape equivalent to "M10,20h40v50h-40z"\n     | paper.path(Raphael.fullfill("M{x},{y}h{dim.width}v{dim.height}h{dim[\'negative width\']}z", {\n     |     x: 10,\n     |     y: 20,\n     |     dim: {\n     |         width: 40,\n     |         height: 50,\n     |         "negative width": -40\n     |     }\n     | }));\n    \\*/\n    R.fullfill = (function () {\n        var tokenRegex = /\\{([^\\}]+)\\}/g,\n            objNotationRegex = /(?:(?:^|\\.)(.+?)(?=\\[|\\.|$|\\()|\\[(\'|")(.+?)\\2\\])(\\(\\))?/g, // matches .xxxxx or ["xxxxx"] to run over object properties\n            replacer = function (all, key, obj) {\n                var res = obj;\n                key.replace(objNotationRegex, function (all, name, quote, quotedName, isFunc) {\n                    name = name || quotedName;\n                    if (res) {\n                        if (name in res) {\n                            res = res[name];\n                        }\n                        typeof res == "function" && isFunc && (res = res());\n                    }\n                });\n                res = (res == null || res == obj ? all : res) + "";\n                return res;\n            };\n        return function (str, obj) {\n            return String(str).replace(tokenRegex, function (all, key) {\n                return replacer(all, key, obj);\n            });\n        };\n    })();\n    /*\\\n     * Raphael.ninja\n     [ method ]\n     **\n     * If you want to leave no trace of Raphaël (Well, Raphaël creates only one global variable `Raphael`, but anyway.) You can use `ninja` method.\n     * Beware, that in this case plugins could stop working, because they are depending on global variable existence.\n     **\n     = (object) Raphael object\n     > Usage\n     | (function (local_raphael) {\n     |     var paper = local_raphael(10, 10, 320, 200);\n     |     …\n     | })(Raphael.ninja());\n    \\*/\n    R.ninja = function () {\n        if (oldRaphael.was) {\n            g.win.Raphael = oldRaphael.is;\n        } else {\n            // IE8 raises an error when deleting window property\n            window.Raphael = undefined;\n            try {\n                delete window.Raphael;\n            } catch(e) {}\n        }\n        return R;\n    };\n    /*\\\n     * Raphael.st\n     [ property (object) ]\n     **\n     * You can add your own method to elements and sets. It is wise to add a set method for each element method\n     * you added, so you will be able to call the same method on sets too.\n     **\n     * See also @Raphael.el.\n     > Usage\n     | Raphael.el.red = function () {\n     |     this.attr({fill: "#f00"});\n     | };\n     | Raphael.st.red = function () {\n     |     this.forEach(function (el) {\n     |         el.red();\n     |     });\n     | };\n     | // then use it\n     | paper.set(paper.circle(100, 100, 20), paper.circle(110, 100, 20)).red();\n    \\*/\n    R.st = setproto;\n\n    eve.on("raphael.DOMload", function () {\n        loaded = true;\n    });\n\n    // Firefox <3.6 fix: http://webreflection.blogspot.com/2009/11/195-chars-to-help-lazy-loading.html\n    (function (doc, loaded, f) {\n        if (doc.readyState == null && doc.addEventListener){\n            doc.addEventListener(loaded, f = function () {\n                doc.removeEventListener(loaded, f, false);\n                doc.readyState = "complete";\n            }, false);\n            doc.readyState = "loading";\n        }\n        function isLoaded() {\n            (/in/).test(doc.readyState) ? setTimeout(isLoaded, 9) : R.eve("raphael.DOMload");\n        }\n        isLoaded();\n    })(document, "DOMContentLoaded");\n\n    return R;\n}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9kZXYvcmFwaGFlbC5jb3JlLmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vUmFwaGFlbC8uL2Rldi9yYXBoYWVsLmNvcmUuanM/OTRkOSJdLCJzb3VyY2VzQ29udGVudCI6WyJkZWZpbmUoW1wiZXZlXCJdLCBmdW5jdGlvbihldmUpIHtcblxuICAgIC8qXFxcbiAgICAgKiBSYXBoYWVsXG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBDcmVhdGVzIGEgY2FudmFzIG9iamVjdCBvbiB3aGljaCB0byBkcmF3LlxuICAgICAqIFlvdSBtdXN0IGRvIHRoaXMgZmlyc3QsIGFzIGFsbCBmdXR1cmUgY2FsbHMgdG8gZHJhd2luZyBtZXRob2RzXG4gICAgICogZnJvbSB0aGlzIGluc3RhbmNlIHdpbGwgYmUgYm91bmQgdG8gdGhpcyBjYW52YXMuXG4gICAgID4gUGFyYW1ldGVyc1xuICAgICAqKlxuICAgICAtIGNvbnRhaW5lciAoSFRNTEVsZW1lbnR8c3RyaW5nKSBET00gZWxlbWVudCBvciBpdHMgSUQgd2hpY2ggaXMgZ29pbmcgdG8gYmUgYSBwYXJlbnQgZm9yIGRyYXdpbmcgc3VyZmFjZVxuICAgICAtIHdpZHRoIChudW1iZXIpXG4gICAgIC0gaGVpZ2h0IChudW1iZXIpXG4gICAgIC0gY2FsbGJhY2sgKGZ1bmN0aW9uKSAjb3B0aW9uYWwgY2FsbGJhY2sgZnVuY3Rpb24gd2hpY2ggaXMgZ29pbmcgdG8gYmUgZXhlY3V0ZWQgaW4gdGhlIGNvbnRleHQgb2YgbmV3bHkgY3JlYXRlZCBwYXBlclxuICAgICAqIG9yXG4gICAgIC0geCAobnVtYmVyKVxuICAgICAtIHkgKG51bWJlcilcbiAgICAgLSB3aWR0aCAobnVtYmVyKVxuICAgICAtIGhlaWdodCAobnVtYmVyKVxuICAgICAtIGNhbGxiYWNrIChmdW5jdGlvbikgI29wdGlvbmFsIGNhbGxiYWNrIGZ1bmN0aW9uIHdoaWNoIGlzIGdvaW5nIHRvIGJlIGV4ZWN1dGVkIGluIHRoZSBjb250ZXh0IG9mIG5ld2x5IGNyZWF0ZWQgcGFwZXJcbiAgICAgKiBvclxuICAgICAtIGFsbCAoYXJyYXkpIChmaXJzdCAzIG9yIDQgZWxlbWVudHMgaW4gdGhlIGFycmF5IGFyZSBlcXVhbCB0byBbY29udGFpbmVySUQsIHdpZHRoLCBoZWlnaHRdIG9yIFt4LCB5LCB3aWR0aCwgaGVpZ2h0XS4gVGhlIHJlc3QgYXJlIGVsZW1lbnQgZGVzY3JpcHRpb25zIGluIGZvcm1hdCB7dHlwZTogdHlwZSwgPGF0dHJpYnV0ZXM+fSkuIFNlZSBAUGFwZXIuYWRkLlxuICAgICAtIGNhbGxiYWNrIChmdW5jdGlvbikgI29wdGlvbmFsIGNhbGxiYWNrIGZ1bmN0aW9uIHdoaWNoIGlzIGdvaW5nIHRvIGJlIGV4ZWN1dGVkIGluIHRoZSBjb250ZXh0IG9mIG5ld2x5IGNyZWF0ZWQgcGFwZXJcbiAgICAgKiBvclxuICAgICAtIG9uUmVhZHlDYWxsYmFjayAoZnVuY3Rpb24pIGZ1bmN0aW9uIHRoYXQgaXMgZ29pbmcgdG8gYmUgY2FsbGVkIG9uIERPTSByZWFkeSBldmVudC4gWW91IGNhbiBhbHNvIHN1YnNjcmliZSB0byB0aGlzIGV2ZW50IHZpYSBFdmXigJlzIOKAnERPTUxvYWTigJ0gZXZlbnQuIEluIHRoaXMgY2FzZSBtZXRob2QgcmV0dXJucyBgdW5kZWZpbmVkYC5cbiAgICAgPSAob2JqZWN0KSBAUGFwZXJcbiAgICAgPiBVc2FnZVxuICAgICB8IC8vIEVhY2ggb2YgdGhlIGZvbGxvd2luZyBleGFtcGxlcyBjcmVhdGUgYSBjYW52YXNcbiAgICAgfCAvLyB0aGF0IGlzIDMyMHB4IHdpZGUgYnkgMjAwcHggaGlnaC5cbiAgICAgfCAvLyBDYW52YXMgaXMgY3JlYXRlZCBhdCB0aGUgdmlld3BvcnTigJlzIDEwLDUwIGNvb3JkaW5hdGUuXG4gICAgIHwgdmFyIHBhcGVyID0gUmFwaGFlbCgxMCwgNTAsIDMyMCwgMjAwKTtcbiAgICAgfCAvLyBDYW52YXMgaXMgY3JlYXRlZCBhdCB0aGUgdG9wIGxlZnQgY29ybmVyIG9mIHRoZSAjbm90ZXBhZCBlbGVtZW50XG4gICAgIHwgLy8gKG9yIGl0cyB0b3AgcmlnaHQgY29ybmVyIGluIGRpcj1cInJ0bFwiIGVsZW1lbnRzKVxuICAgICB8IHZhciBwYXBlciA9IFJhcGhhZWwoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJub3RlcGFkXCIpLCAzMjAsIDIwMCk7XG4gICAgIHwgLy8gU2FtZSBhcyBhYm92ZVxuICAgICB8IHZhciBwYXBlciA9IFJhcGhhZWwoXCJub3RlcGFkXCIsIDMyMCwgMjAwKTtcbiAgICAgfCAvLyBJbWFnZSBkdW1wXG4gICAgIHwgdmFyIHNldCA9IFJhcGhhZWwoW1wibm90ZXBhZFwiLCAzMjAsIDIwMCwge1xuICAgICB8ICAgICB0eXBlOiBcInJlY3RcIixcbiAgICAgfCAgICAgeDogMTAsXG4gICAgIHwgICAgIHk6IDEwLFxuICAgICB8ICAgICB3aWR0aDogMjUsXG4gICAgIHwgICAgIGhlaWdodDogMjUsXG4gICAgIHwgICAgIHN0cm9rZTogXCIjZjAwXCJcbiAgICAgfCB9LCB7XG4gICAgIHwgICAgIHR5cGU6IFwidGV4dFwiLFxuICAgICB8ICAgICB4OiAzMCxcbiAgICAgfCAgICAgeTogNDAsXG4gICAgIHwgICAgIHRleHQ6IFwiRHVtcFwiXG4gICAgIHwgfV0pO1xuICAgIFxcKi9cbiAgICBmdW5jdGlvbiBSKGZpcnN0KSB7XG4gICAgICAgIGlmIChSLmlzKGZpcnN0LCBcImZ1bmN0aW9uXCIpKSB7XG4gICAgICAgICAgICByZXR1cm4gbG9hZGVkID8gZmlyc3QoKSA6IGV2ZS5vbihcInJhcGhhZWwuRE9NbG9hZFwiLCBmaXJzdCk7XG4gICAgICAgIH0gZWxzZSBpZiAoUi5pcyhmaXJzdCwgYXJyYXkpKSB7XG4gICAgICAgICAgICByZXR1cm4gUi5fZW5naW5lLmNyZWF0ZVthcHBseV0oUiwgZmlyc3Quc3BsaWNlKDAsIDMgKyBSLmlzKGZpcnN0WzBdLCBudSkpKS5hZGQoZmlyc3QpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDApO1xuICAgICAgICAgICAgaWYgKFIuaXMoYXJnc1thcmdzLmxlbmd0aCAtIDFdLCBcImZ1bmN0aW9uXCIpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGYgPSBhcmdzLnBvcCgpO1xuICAgICAgICAgICAgICAgIHJldHVybiBsb2FkZWQgPyBmLmNhbGwoUi5fZW5naW5lLmNyZWF0ZVthcHBseV0oUiwgYXJncykpIDogZXZlLm9uKFwicmFwaGFlbC5ET01sb2FkXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgZi5jYWxsKFIuX2VuZ2luZS5jcmVhdGVbYXBwbHldKFIsIGFyZ3MpKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFIuX2VuZ2luZS5jcmVhdGVbYXBwbHldKFIsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgUi52ZXJzaW9uID0gXCIyLjIuMFwiO1xuICAgIFIuZXZlID0gZXZlO1xuICAgIHZhciBsb2FkZWQsXG4gICAgICAgIHNlcGFyYXRvciA9IC9bLCBdKy8sXG4gICAgICAgIGVsZW1lbnRzID0ge2NpcmNsZTogMSwgcmVjdDogMSwgcGF0aDogMSwgZWxsaXBzZTogMSwgdGV4dDogMSwgaW1hZ2U6IDF9LFxuICAgICAgICBmb3JtYXRyZyA9IC9cXHsoXFxkKylcXH0vZyxcbiAgICAgICAgcHJvdG8gPSBcInByb3RvdHlwZVwiLFxuICAgICAgICBoYXMgPSBcImhhc093blByb3BlcnR5XCIsXG4gICAgICAgIGcgPSB7XG4gICAgICAgICAgICBkb2M6IGRvY3VtZW50LFxuICAgICAgICAgICAgd2luOiB3aW5kb3dcbiAgICAgICAgfSxcbiAgICAgICAgb2xkUmFwaGFlbCA9IHtcbiAgICAgICAgICAgIHdhczogT2JqZWN0LnByb3RvdHlwZVtoYXNdLmNhbGwoZy53aW4sIFwiUmFwaGFlbFwiKSxcbiAgICAgICAgICAgIGlzOiBnLndpbi5SYXBoYWVsXG4gICAgICAgIH0sXG4gICAgICAgIFBhcGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLypcXFxuICAgICAgICAgICAgICogUGFwZXIuY2FcbiAgICAgICAgICAgICBbIHByb3BlcnR5IChvYmplY3QpIF1cbiAgICAgICAgICAgICAqKlxuICAgICAgICAgICAgICogU2hvcnRjdXQgZm9yIEBQYXBlci5jdXN0b21BdHRyaWJ1dGVzXG4gICAgICAgICAgICBcXCovXG4gICAgICAgICAgICAvKlxcXG4gICAgICAgICAgICAgKiBQYXBlci5jdXN0b21BdHRyaWJ1dGVzXG4gICAgICAgICAgICAgWyBwcm9wZXJ0eSAob2JqZWN0KSBdXG4gICAgICAgICAgICAgKipcbiAgICAgICAgICAgICAqIElmIHlvdSBoYXZlIGEgc2V0IG9mIGF0dHJpYnV0ZXMgdGhhdCB5b3Ugd291bGQgbGlrZSB0byByZXByZXNlbnRcbiAgICAgICAgICAgICAqIGFzIGEgZnVuY3Rpb24gb2Ygc29tZSBudW1iZXIgeW91IGNhbiBkbyBpdCBlYXNpbHkgd2l0aCBjdXN0b20gYXR0cmlidXRlczpcbiAgICAgICAgICAgICA+IFVzYWdlXG4gICAgICAgICAgICAgfCBwYXBlci5jdXN0b21BdHRyaWJ1dGVzLmh1ZSA9IGZ1bmN0aW9uIChudW0pIHtcbiAgICAgICAgICAgICB8ICAgICBudW0gPSBudW0gJSAxO1xuICAgICAgICAgICAgIHwgICAgIHJldHVybiB7ZmlsbDogXCJoc2IoXCIgKyBudW0gKyBcIiwgMC43NSwgMSlcIn07XG4gICAgICAgICAgICAgfCB9O1xuICAgICAgICAgICAgIHwgLy8gQ3VzdG9tIGF0dHJpYnV0ZSDigJxodWXigJ0gd2lsbCBjaGFuZ2UgZmlsbFxuICAgICAgICAgICAgIHwgLy8gdG8gYmUgZ2l2ZW4gaHVlIHdpdGggZml4ZWQgc2F0dXJhdGlvbiBhbmQgYnJpZ2h0bmVzcy5cbiAgICAgICAgICAgICB8IC8vIE5vdyB5b3UgY2FuIHVzZSBpdCBsaWtlIHRoaXM6XG4gICAgICAgICAgICAgfCB2YXIgYyA9IHBhcGVyLmNpcmNsZSgxMCwgMTAsIDEwKS5hdHRyKHtodWU6IC40NX0pO1xuICAgICAgICAgICAgIHwgLy8gb3IgZXZlbiBsaWtlIHRoaXM6XG4gICAgICAgICAgICAgfCBjLmFuaW1hdGUoe2h1ZTogMX0sIDFlMyk7XG4gICAgICAgICAgICAgfFxuICAgICAgICAgICAgIHwgLy8gWW91IGNvdWxkIGFsc28gY3JlYXRlIGN1c3RvbSBhdHRyaWJ1dGVcbiAgICAgICAgICAgICB8IC8vIHdpdGggbXVsdGlwbGUgcGFyYW1ldGVyczpcbiAgICAgICAgICAgICB8IHBhcGVyLmN1c3RvbUF0dHJpYnV0ZXMuaHNiID0gZnVuY3Rpb24gKGgsIHMsIGIpIHtcbiAgICAgICAgICAgICB8ICAgICByZXR1cm4ge2ZpbGw6IFwiaHNiKFwiICsgW2gsIHMsIGJdLmpvaW4oXCIsXCIpICsgXCIpXCJ9O1xuICAgICAgICAgICAgIHwgfTtcbiAgICAgICAgICAgICB8IGMuYXR0cih7aHNiOiBcIjAuNSAuOCAxXCJ9KTtcbiAgICAgICAgICAgICB8IGMuYW5pbWF0ZSh7aHNiOiBbMSwgMCwgMC41XX0sIDFlMyk7XG4gICAgICAgICAgICBcXCovXG4gICAgICAgICAgICB0aGlzLmNhID0gdGhpcy5jdXN0b21BdHRyaWJ1dGVzID0ge307XG4gICAgICAgIH0sXG4gICAgICAgIHBhcGVycHJvdG8sXG4gICAgICAgIGFwcGVuZENoaWxkID0gXCJhcHBlbmRDaGlsZFwiLFxuICAgICAgICBhcHBseSA9IFwiYXBwbHlcIixcbiAgICAgICAgY29uY2F0ID0gXCJjb25jYXRcIixcbiAgICAgICAgLy90YWtlbiBmcm9tIE1vZGVybml6ciB0b3VjaCB0ZXN0OiBodHRwczovL2dpdGh1Yi5jb20vTW9kZXJuaXpyL01vZGVybml6ci9ibG9iL21hc3Rlci9mZWF0dXJlLWRldGVjdHMvdG91Y2hldmVudHMuanMjTDQwXG4gICAgICAgIHN1cHBvcnRzVG91Y2ggPSAoJ29udG91Y2hzdGFydCcgaW4gd2luZG93KSB8fCB3aW5kb3cuVG91Y2hFdmVudCB8fCB3aW5kb3cuRG9jdW1lbnRUb3VjaCAmJiBkb2N1bWVudCBpbnN0YW5jZW9mIERvY3VtZW50VG91Y2gsXG4gICAgICAgIEUgPSBcIlwiLFxuICAgICAgICBTID0gXCIgXCIsXG4gICAgICAgIFN0ciA9IFN0cmluZyxcbiAgICAgICAgc3BsaXQgPSBcInNwbGl0XCIsXG4gICAgICAgIGV2ZW50cyA9IFwiY2xpY2sgZGJsY2xpY2sgbW91c2Vkb3duIG1vdXNlbW92ZSBtb3VzZW91dCBtb3VzZW92ZXIgbW91c2V1cCB0b3VjaHN0YXJ0IHRvdWNobW92ZSB0b3VjaGVuZCB0b3VjaGNhbmNlbFwiW3NwbGl0XShTKSxcbiAgICAgICAgdG91Y2hNYXAgPSB7XG4gICAgICAgICAgICBtb3VzZWRvd246IFwidG91Y2hzdGFydFwiLFxuICAgICAgICAgICAgbW91c2Vtb3ZlOiBcInRvdWNobW92ZVwiLFxuICAgICAgICAgICAgbW91c2V1cDogXCJ0b3VjaGVuZFwiXG4gICAgICAgIH0sXG4gICAgICAgIGxvd2VyQ2FzZSA9IFN0ci5wcm90b3R5cGUudG9Mb3dlckNhc2UsXG4gICAgICAgIG1hdGggPSBNYXRoLFxuICAgICAgICBtbWF4ID0gbWF0aC5tYXgsXG4gICAgICAgIG1taW4gPSBtYXRoLm1pbixcbiAgICAgICAgYWJzID0gbWF0aC5hYnMsXG4gICAgICAgIHBvdyA9IG1hdGgucG93LFxuICAgICAgICBQSSA9IG1hdGguUEksXG4gICAgICAgIG51ID0gXCJudW1iZXJcIixcbiAgICAgICAgc3RyaW5nID0gXCJzdHJpbmdcIixcbiAgICAgICAgYXJyYXkgPSBcImFycmF5XCIsXG4gICAgICAgIHRvU3RyaW5nID0gXCJ0b1N0cmluZ1wiLFxuICAgICAgICBmaWxsU3RyaW5nID0gXCJmaWxsXCIsXG4gICAgICAgIG9iamVjdFRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZyxcbiAgICAgICAgcGFwZXIgPSB7fSxcbiAgICAgICAgcHVzaCA9IFwicHVzaFwiLFxuICAgICAgICBJU1VSTCA9IFIuX0lTVVJMID0gL151cmxcXChbJ1wiXT8oLis/KVsnXCJdP1xcKSQvaSxcbiAgICAgICAgY29sb3VyUmVnRXhwID0gL15cXHMqKCgjW2EtZlxcZF17Nn0pfCgjW2EtZlxcZF17M30pfHJnYmE/XFwoXFxzKihbXFxkXFwuXSslP1xccyosXFxzKltcXGRcXC5dKyU/XFxzKixcXHMqW1xcZFxcLl0rJT8oPzpcXHMqLFxccypbXFxkXFwuXSslPyk/KVxccypcXCl8aHNiYT9cXChcXHMqKFtcXGRcXC5dKyg/OmRlZ3xcXHhiMHwlKT9cXHMqLFxccypbXFxkXFwuXSslP1xccyosXFxzKltcXGRcXC5dKyg/OiU/XFxzKixcXHMqW1xcZFxcLl0rKT8pJT9cXHMqXFwpfGhzbGE/XFwoXFxzKihbXFxkXFwuXSsoPzpkZWd8XFx4YjB8JSk/XFxzKixcXHMqW1xcZFxcLl0rJT9cXHMqLFxccypbXFxkXFwuXSsoPzolP1xccyosXFxzKltcXGRcXC5dKyk/KSU/XFxzKlxcKSlcXHMqJC9pLFxuICAgICAgICBpc25hbiA9IHtcIk5hTlwiOiAxLCBcIkluZmluaXR5XCI6IDEsIFwiLUluZmluaXR5XCI6IDF9LFxuICAgICAgICBiZXppZXJyZyA9IC9eKD86Y3ViaWMtKT9iZXppZXJcXCgoW14sXSspLChbXixdKyksKFteLF0rKSwoW15cXCldKylcXCkvLFxuICAgICAgICByb3VuZCA9IG1hdGgucm91bmQsXG4gICAgICAgIHNldEF0dHJpYnV0ZSA9IFwic2V0QXR0cmlidXRlXCIsXG4gICAgICAgIHRvRmxvYXQgPSBwYXJzZUZsb2F0LFxuICAgICAgICB0b0ludCA9IHBhcnNlSW50LFxuICAgICAgICB1cHBlckNhc2UgPSBTdHIucHJvdG90eXBlLnRvVXBwZXJDYXNlLFxuICAgICAgICBhdmFpbGFibGVBdHRycyA9IFIuX2F2YWlsYWJsZUF0dHJzID0ge1xuICAgICAgICAgICAgXCJhcnJvdy1lbmRcIjogXCJub25lXCIsXG4gICAgICAgICAgICBcImFycm93LXN0YXJ0XCI6IFwibm9uZVwiLFxuICAgICAgICAgICAgYmx1cjogMCxcbiAgICAgICAgICAgIFwiY2xpcC1yZWN0XCI6IFwiMCAwIDFlOSAxZTlcIixcbiAgICAgICAgICAgIGN1cnNvcjogXCJkZWZhdWx0XCIsXG4gICAgICAgICAgICBjeDogMCxcbiAgICAgICAgICAgIGN5OiAwLFxuICAgICAgICAgICAgZmlsbDogXCIjZmZmXCIsXG4gICAgICAgICAgICBcImZpbGwtb3BhY2l0eVwiOiAxLFxuICAgICAgICAgICAgZm9udDogJzEwcHggXCJBcmlhbFwiJyxcbiAgICAgICAgICAgIFwiZm9udC1mYW1pbHlcIjogJ1wiQXJpYWxcIicsXG4gICAgICAgICAgICBcImZvbnQtc2l6ZVwiOiBcIjEwXCIsXG4gICAgICAgICAgICBcImZvbnQtc3R5bGVcIjogXCJub3JtYWxcIixcbiAgICAgICAgICAgIFwiZm9udC13ZWlnaHRcIjogNDAwLFxuICAgICAgICAgICAgZ3JhZGllbnQ6IDAsXG4gICAgICAgICAgICBoZWlnaHQ6IDAsXG4gICAgICAgICAgICBocmVmOiBcImh0dHA6Ly9yYXBoYWVsanMuY29tL1wiLFxuICAgICAgICAgICAgXCJsZXR0ZXItc3BhY2luZ1wiOiAwLFxuICAgICAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgICAgIHBhdGg6IFwiTTAsMFwiLFxuICAgICAgICAgICAgcjogMCxcbiAgICAgICAgICAgIHJ4OiAwLFxuICAgICAgICAgICAgcnk6IDAsXG4gICAgICAgICAgICBzcmM6IFwiXCIsXG4gICAgICAgICAgICBzdHJva2U6IFwiIzAwMFwiLFxuICAgICAgICAgICAgXCJzdHJva2UtZGFzaGFycmF5XCI6IFwiXCIsXG4gICAgICAgICAgICBcInN0cm9rZS1saW5lY2FwXCI6IFwiYnV0dFwiLFxuICAgICAgICAgICAgXCJzdHJva2UtbGluZWpvaW5cIjogXCJidXR0XCIsXG4gICAgICAgICAgICBcInN0cm9rZS1taXRlcmxpbWl0XCI6IDAsXG4gICAgICAgICAgICBcInN0cm9rZS1vcGFjaXR5XCI6IDEsXG4gICAgICAgICAgICBcInN0cm9rZS13aWR0aFwiOiAxLFxuICAgICAgICAgICAgdGFyZ2V0OiBcIl9ibGFua1wiLFxuICAgICAgICAgICAgXCJ0ZXh0LWFuY2hvclwiOiBcIm1pZGRsZVwiLFxuICAgICAgICAgICAgdGl0bGU6IFwiUmFwaGFlbFwiLFxuICAgICAgICAgICAgdHJhbnNmb3JtOiBcIlwiLFxuICAgICAgICAgICAgd2lkdGg6IDAsXG4gICAgICAgICAgICB4OiAwLFxuICAgICAgICAgICAgeTogMCxcbiAgICAgICAgICAgIFwiY2xhc3NcIjogXCJcIlxuICAgICAgICB9LFxuICAgICAgICBhdmFpbGFibGVBbmltQXR0cnMgPSBSLl9hdmFpbGFibGVBbmltQXR0cnMgPSB7XG4gICAgICAgICAgICBibHVyOiBudSxcbiAgICAgICAgICAgIFwiY2xpcC1yZWN0XCI6IFwiY3N2XCIsXG4gICAgICAgICAgICBjeDogbnUsXG4gICAgICAgICAgICBjeTogbnUsXG4gICAgICAgICAgICBmaWxsOiBcImNvbG91clwiLFxuICAgICAgICAgICAgXCJmaWxsLW9wYWNpdHlcIjogbnUsXG4gICAgICAgICAgICBcImZvbnQtc2l6ZVwiOiBudSxcbiAgICAgICAgICAgIGhlaWdodDogbnUsXG4gICAgICAgICAgICBvcGFjaXR5OiBudSxcbiAgICAgICAgICAgIHBhdGg6IFwicGF0aFwiLFxuICAgICAgICAgICAgcjogbnUsXG4gICAgICAgICAgICByeDogbnUsXG4gICAgICAgICAgICByeTogbnUsXG4gICAgICAgICAgICBzdHJva2U6IFwiY29sb3VyXCIsXG4gICAgICAgICAgICBcInN0cm9rZS1vcGFjaXR5XCI6IG51LFxuICAgICAgICAgICAgXCJzdHJva2Utd2lkdGhcIjogbnUsXG4gICAgICAgICAgICB0cmFuc2Zvcm06IFwidHJhbnNmb3JtXCIsXG4gICAgICAgICAgICB3aWR0aDogbnUsXG4gICAgICAgICAgICB4OiBudSxcbiAgICAgICAgICAgIHk6IG51XG4gICAgICAgIH0sXG4gICAgICAgIHdoaXRlc3BhY2UgPSAvW1xceDA5XFx4MGFcXHgwYlxceDBjXFx4MGRcXHgyMFxceGEwXFx1MTY4MFxcdTE4MGVcXHUyMDAwXFx1MjAwMVxcdTIwMDJcXHUyMDAzXFx1MjAwNFxcdTIwMDVcXHUyMDA2XFx1MjAwN1xcdTIwMDhcXHUyMDA5XFx1MjAwYVxcdTIwMmZcXHUyMDVmXFx1MzAwMFxcdTIwMjhcXHUyMDI5XS9nLFxuICAgICAgICBjb21tYVNwYWNlcyA9IC9bXFx4MDlcXHgwYVxceDBiXFx4MGNcXHgwZFxceDIwXFx4YTBcXHUxNjgwXFx1MTgwZVxcdTIwMDBcXHUyMDAxXFx1MjAwMlxcdTIwMDNcXHUyMDA0XFx1MjAwNVxcdTIwMDZcXHUyMDA3XFx1MjAwOFxcdTIwMDlcXHUyMDBhXFx1MjAyZlxcdTIwNWZcXHUzMDAwXFx1MjAyOFxcdTIwMjldKixbXFx4MDlcXHgwYVxceDBiXFx4MGNcXHgwZFxceDIwXFx4YTBcXHUxNjgwXFx1MTgwZVxcdTIwMDBcXHUyMDAxXFx1MjAwMlxcdTIwMDNcXHUyMDA0XFx1MjAwNVxcdTIwMDZcXHUyMDA3XFx1MjAwOFxcdTIwMDlcXHUyMDBhXFx1MjAyZlxcdTIwNWZcXHUzMDAwXFx1MjAyOFxcdTIwMjldKi8sXG4gICAgICAgIGhzcmcgPSB7aHM6IDEsIHJnOiAxfSxcbiAgICAgICAgcDJzID0gLyw/KFthY2hsbXFyc3R2eHpdKSw/L2dpLFxuICAgICAgICBwYXRoQ29tbWFuZCA9IC8oW2FjaGxtcnFzdHZ6XSlbXFx4MDlcXHgwYVxceDBiXFx4MGNcXHgwZFxceDIwXFx4YTBcXHUxNjgwXFx1MTgwZVxcdTIwMDBcXHUyMDAxXFx1MjAwMlxcdTIwMDNcXHUyMDA0XFx1MjAwNVxcdTIwMDZcXHUyMDA3XFx1MjAwOFxcdTIwMDlcXHUyMDBhXFx1MjAyZlxcdTIwNWZcXHUzMDAwXFx1MjAyOFxcdTIwMjksXSooKC0/XFxkKlxcLj9cXGQqKD86ZVtcXC0rXT9cXGQrKT9bXFx4MDlcXHgwYVxceDBiXFx4MGNcXHgwZFxceDIwXFx4YTBcXHUxNjgwXFx1MTgwZVxcdTIwMDBcXHUyMDAxXFx1MjAwMlxcdTIwMDNcXHUyMDA0XFx1MjAwNVxcdTIwMDZcXHUyMDA3XFx1MjAwOFxcdTIwMDlcXHUyMDBhXFx1MjAyZlxcdTIwNWZcXHUzMDAwXFx1MjAyOFxcdTIwMjldKiw/W1xceDA5XFx4MGFcXHgwYlxceDBjXFx4MGRcXHgyMFxceGEwXFx1MTY4MFxcdTE4MGVcXHUyMDAwXFx1MjAwMVxcdTIwMDJcXHUyMDAzXFx1MjAwNFxcdTIwMDVcXHUyMDA2XFx1MjAwN1xcdTIwMDhcXHUyMDA5XFx1MjAwYVxcdTIwMmZcXHUyMDVmXFx1MzAwMFxcdTIwMjhcXHUyMDI5XSopKykvaWcsXG4gICAgICAgIHRDb21tYW5kID0gLyhbcnN0bV0pW1xceDA5XFx4MGFcXHgwYlxceDBjXFx4MGRcXHgyMFxceGEwXFx1MTY4MFxcdTE4MGVcXHUyMDAwXFx1MjAwMVxcdTIwMDJcXHUyMDAzXFx1MjAwNFxcdTIwMDVcXHUyMDA2XFx1MjAwN1xcdTIwMDhcXHUyMDA5XFx1MjAwYVxcdTIwMmZcXHUyMDVmXFx1MzAwMFxcdTIwMjhcXHUyMDI5LF0qKCgtP1xcZCpcXC4/XFxkKig/OmVbXFwtK10/XFxkKyk/W1xceDA5XFx4MGFcXHgwYlxceDBjXFx4MGRcXHgyMFxceGEwXFx1MTY4MFxcdTE4MGVcXHUyMDAwXFx1MjAwMVxcdTIwMDJcXHUyMDAzXFx1MjAwNFxcdTIwMDVcXHUyMDA2XFx1MjAwN1xcdTIwMDhcXHUyMDA5XFx1MjAwYVxcdTIwMmZcXHUyMDVmXFx1MzAwMFxcdTIwMjhcXHUyMDI5XSosP1tcXHgwOVxceDBhXFx4MGJcXHgwY1xceDBkXFx4MjBcXHhhMFxcdTE2ODBcXHUxODBlXFx1MjAwMFxcdTIwMDFcXHUyMDAyXFx1MjAwM1xcdTIwMDRcXHUyMDA1XFx1MjAwNlxcdTIwMDdcXHUyMDA4XFx1MjAwOVxcdTIwMGFcXHUyMDJmXFx1MjA1ZlxcdTMwMDBcXHUyMDI4XFx1MjAyOV0qKSspL2lnLFxuICAgICAgICBwYXRoVmFsdWVzID0gLygtP1xcZCpcXC4/XFxkKig/OmVbXFwtK10/XFxkKyk/KVtcXHgwOVxceDBhXFx4MGJcXHgwY1xceDBkXFx4MjBcXHhhMFxcdTE2ODBcXHUxODBlXFx1MjAwMFxcdTIwMDFcXHUyMDAyXFx1MjAwM1xcdTIwMDRcXHUyMDA1XFx1MjAwNlxcdTIwMDdcXHUyMDA4XFx1MjAwOVxcdTIwMGFcXHUyMDJmXFx1MjA1ZlxcdTMwMDBcXHUyMDI4XFx1MjAyOV0qLD9bXFx4MDlcXHgwYVxceDBiXFx4MGNcXHgwZFxceDIwXFx4YTBcXHUxNjgwXFx1MTgwZVxcdTIwMDBcXHUyMDAxXFx1MjAwMlxcdTIwMDNcXHUyMDA0XFx1MjAwNVxcdTIwMDZcXHUyMDA3XFx1MjAwOFxcdTIwMDlcXHUyMDBhXFx1MjAyZlxcdTIwNWZcXHUzMDAwXFx1MjAyOFxcdTIwMjldKi9pZyxcbiAgICAgICAgcmFkaWFsX2dyYWRpZW50ID0gUi5fcmFkaWFsX2dyYWRpZW50ID0gL15yKD86XFwoKFteLF0rPylbXFx4MDlcXHgwYVxceDBiXFx4MGNcXHgwZFxceDIwXFx4YTBcXHUxNjgwXFx1MTgwZVxcdTIwMDBcXHUyMDAxXFx1MjAwMlxcdTIwMDNcXHUyMDA0XFx1MjAwNVxcdTIwMDZcXHUyMDA3XFx1MjAwOFxcdTIwMDlcXHUyMDBhXFx1MjAyZlxcdTIwNWZcXHUzMDAwXFx1MjAyOFxcdTIwMjldKixbXFx4MDlcXHgwYVxceDBiXFx4MGNcXHgwZFxceDIwXFx4YTBcXHUxNjgwXFx1MTgwZVxcdTIwMDBcXHUyMDAxXFx1MjAwMlxcdTIwMDNcXHUyMDA0XFx1MjAwNVxcdTIwMDZcXHUyMDA3XFx1MjAwOFxcdTIwMDlcXHUyMDBhXFx1MjAyZlxcdTIwNWZcXHUzMDAwXFx1MjAyOFxcdTIwMjldKihbXlxcKV0rPylcXCkpPy8sXG4gICAgICAgIGVsZGF0YSA9IHt9LFxuICAgICAgICBzb3J0QnlLZXkgPSBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICAgICAgcmV0dXJuIGEua2V5IC0gYi5rZXk7XG4gICAgICAgIH0sXG4gICAgICAgIHNvcnRCeU51bWJlciA9IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICByZXR1cm4gdG9GbG9hdChhKSAtIHRvRmxvYXQoYik7XG4gICAgICAgIH0sXG4gICAgICAgIGZ1biA9IGZ1bmN0aW9uICgpIHt9LFxuICAgICAgICBwaXBlID0gZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgIHJldHVybiB4O1xuICAgICAgICB9LFxuICAgICAgICByZWN0UGF0aCA9IFIuX3JlY3RQYXRoID0gZnVuY3Rpb24gKHgsIHksIHcsIGgsIHIpIHtcbiAgICAgICAgICAgIGlmIChyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtbXCJNXCIsIHggKyByLCB5XSwgW1wibFwiLCB3IC0gciAqIDIsIDBdLCBbXCJhXCIsIHIsIHIsIDAsIDAsIDEsIHIsIHJdLCBbXCJsXCIsIDAsIGggLSByICogMl0sIFtcImFcIiwgciwgciwgMCwgMCwgMSwgLXIsIHJdLCBbXCJsXCIsIHIgKiAyIC0gdywgMF0sIFtcImFcIiwgciwgciwgMCwgMCwgMSwgLXIsIC1yXSwgW1wibFwiLCAwLCByICogMiAtIGhdLCBbXCJhXCIsIHIsIHIsIDAsIDAsIDEsIHIsIC1yXSwgW1wielwiXV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gW1tcIk1cIiwgeCwgeV0sIFtcImxcIiwgdywgMF0sIFtcImxcIiwgMCwgaF0sIFtcImxcIiwgLXcsIDBdLCBbXCJ6XCJdXTtcbiAgICAgICAgfSxcbiAgICAgICAgZWxsaXBzZVBhdGggPSBmdW5jdGlvbiAoeCwgeSwgcngsIHJ5KSB7XG4gICAgICAgICAgICBpZiAocnkgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHJ5ID0gcng7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gW1tcIk1cIiwgeCwgeV0sIFtcIm1cIiwgMCwgLXJ5XSwgW1wiYVwiLCByeCwgcnksIDAsIDEsIDEsIDAsIDIgKiByeV0sIFtcImFcIiwgcngsIHJ5LCAwLCAxLCAxLCAwLCAtMiAqIHJ5XSwgW1wielwiXV07XG4gICAgICAgIH0sXG4gICAgICAgIGdldFBhdGggPSBSLl9nZXRQYXRoID0ge1xuICAgICAgICAgICAgcGF0aDogZnVuY3Rpb24gKGVsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGVsLmF0dHIoXCJwYXRoXCIpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNpcmNsZTogZnVuY3Rpb24gKGVsKSB7XG4gICAgICAgICAgICAgICAgdmFyIGEgPSBlbC5hdHRycztcbiAgICAgICAgICAgICAgICByZXR1cm4gZWxsaXBzZVBhdGgoYS5jeCwgYS5jeSwgYS5yKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlbGxpcHNlOiBmdW5jdGlvbiAoZWwpIHtcbiAgICAgICAgICAgICAgICB2YXIgYSA9IGVsLmF0dHJzO1xuICAgICAgICAgICAgICAgIHJldHVybiBlbGxpcHNlUGF0aChhLmN4LCBhLmN5LCBhLnJ4LCBhLnJ5KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZWN0OiBmdW5jdGlvbiAoZWwpIHtcbiAgICAgICAgICAgICAgICB2YXIgYSA9IGVsLmF0dHJzO1xuICAgICAgICAgICAgICAgIHJldHVybiByZWN0UGF0aChhLngsIGEueSwgYS53aWR0aCwgYS5oZWlnaHQsIGEucik7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaW1hZ2U6IGZ1bmN0aW9uIChlbCkge1xuICAgICAgICAgICAgICAgIHZhciBhID0gZWwuYXR0cnM7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlY3RQYXRoKGEueCwgYS55LCBhLndpZHRoLCBhLmhlaWdodCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdGV4dDogZnVuY3Rpb24gKGVsKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJib3ggPSBlbC5fZ2V0QkJveCgpO1xuICAgICAgICAgICAgICAgIHJldHVybiByZWN0UGF0aChiYm94LngsIGJib3gueSwgYmJveC53aWR0aCwgYmJveC5oZWlnaHQpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldCA6IGZ1bmN0aW9uKGVsKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJib3ggPSBlbC5fZ2V0QkJveCgpO1xuICAgICAgICAgICAgICAgIHJldHVybiByZWN0UGF0aChiYm94LngsIGJib3gueSwgYmJveC53aWR0aCwgYmJveC5oZWlnaHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICAvKlxcXG4gICAgICAgICAqIFJhcGhhZWwubWFwUGF0aFxuICAgICAgICAgWyBtZXRob2QgXVxuICAgICAgICAgKipcbiAgICAgICAgICogVHJhbnNmb3JtIHRoZSBwYXRoIHN0cmluZyB3aXRoIGdpdmVuIG1hdHJpeC5cbiAgICAgICAgID4gUGFyYW1ldGVyc1xuICAgICAgICAgLSBwYXRoIChzdHJpbmcpIHBhdGggc3RyaW5nXG4gICAgICAgICAtIG1hdHJpeCAob2JqZWN0KSBzZWUgQE1hdHJpeFxuICAgICAgICAgPSAoc3RyaW5nKSB0cmFuc2Zvcm1lZCBwYXRoIHN0cmluZ1xuICAgICAgICBcXCovXG4gICAgICAgIG1hcFBhdGggPSBSLm1hcFBhdGggPSBmdW5jdGlvbiAocGF0aCwgbWF0cml4KSB7XG4gICAgICAgICAgICBpZiAoIW1hdHJpeCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBwYXRoO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHgsIHksIGksIGosIGlpLCBqaiwgcGF0aGk7XG4gICAgICAgICAgICBwYXRoID0gcGF0aDJjdXJ2ZShwYXRoKTtcbiAgICAgICAgICAgIGZvciAoaSA9IDAsIGlpID0gcGF0aC5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgcGF0aGkgPSBwYXRoW2ldO1xuICAgICAgICAgICAgICAgIGZvciAoaiA9IDEsIGpqID0gcGF0aGkubGVuZ3RoOyBqIDwgamo7IGogKz0gMikge1xuICAgICAgICAgICAgICAgICAgICB4ID0gbWF0cml4LngocGF0aGlbal0sIHBhdGhpW2ogKyAxXSk7XG4gICAgICAgICAgICAgICAgICAgIHkgPSBtYXRyaXgueShwYXRoaVtqXSwgcGF0aGlbaiArIDFdKTtcbiAgICAgICAgICAgICAgICAgICAgcGF0aGlbal0gPSB4O1xuICAgICAgICAgICAgICAgICAgICBwYXRoaVtqICsgMV0gPSB5O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBwYXRoO1xuICAgICAgICB9O1xuXG4gICAgUi5fZyA9IGc7XG4gICAgLypcXFxuICAgICAqIFJhcGhhZWwudHlwZVxuICAgICBbIHByb3BlcnR5IChzdHJpbmcpIF1cbiAgICAgKipcbiAgICAgKiBDYW4gYmUg4oCcU1ZH4oCdLCDigJxWTUzigJ0gb3IgZW1wdHksIGRlcGVuZGluZyBvbiBicm93c2VyIHN1cHBvcnQuXG4gICAgXFwqL1xuICAgIFIudHlwZSA9IChnLndpbi5TVkdBbmdsZSB8fCBnLmRvYy5pbXBsZW1lbnRhdGlvbi5oYXNGZWF0dXJlKFwiaHR0cDovL3d3dy53My5vcmcvVFIvU1ZHMTEvZmVhdHVyZSNCYXNpY1N0cnVjdHVyZVwiLCBcIjEuMVwiKSA/IFwiU1ZHXCIgOiBcIlZNTFwiKTtcbiAgICBpZiAoUi50eXBlID09IFwiVk1MXCIpIHtcbiAgICAgICAgdmFyIGQgPSBnLmRvYy5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLFxuICAgICAgICAgICAgYjtcbiAgICAgICAgZC5pbm5lckhUTUwgPSAnPHY6c2hhcGUgYWRqPVwiMVwiLz4nO1xuICAgICAgICBiID0gZC5maXJzdENoaWxkO1xuICAgICAgICBiLnN0eWxlLmJlaGF2aW9yID0gXCJ1cmwoI2RlZmF1bHQjVk1MKVwiO1xuICAgICAgICBpZiAoIShiICYmIHR5cGVvZiBiLmFkaiA9PSBcIm9iamVjdFwiKSkge1xuICAgICAgICAgICAgcmV0dXJuIChSLnR5cGUgPSBFKTtcbiAgICAgICAgfVxuICAgICAgICBkID0gbnVsbDtcbiAgICB9XG4gICAgLypcXFxuICAgICAqIFJhcGhhZWwuc3ZnXG4gICAgIFsgcHJvcGVydHkgKGJvb2xlYW4pIF1cbiAgICAgKipcbiAgICAgKiBgdHJ1ZWAgaWYgYnJvd3NlciBzdXBwb3J0cyBTVkcuXG4gICAgXFwqL1xuICAgIC8qXFxcbiAgICAgKiBSYXBoYWVsLnZtbFxuICAgICBbIHByb3BlcnR5IChib29sZWFuKSBdXG4gICAgICoqXG4gICAgICogYHRydWVgIGlmIGJyb3dzZXIgc3VwcG9ydHMgVk1MLlxuICAgIFxcKi9cbiAgICBSLnN2ZyA9ICEoUi52bWwgPSBSLnR5cGUgPT0gXCJWTUxcIik7XG4gICAgUi5fUGFwZXIgPSBQYXBlcjtcbiAgICAvKlxcXG4gICAgICogUmFwaGFlbC5mblxuICAgICBbIHByb3BlcnR5IChvYmplY3QpIF1cbiAgICAgKipcbiAgICAgKiBZb3UgY2FuIGFkZCB5b3VyIG93biBtZXRob2QgdG8gdGhlIGNhbnZhcy4gRm9yIGV4YW1wbGUgaWYgeW91IHdhbnQgdG8gZHJhdyBhIHBpZSBjaGFydCxcbiAgICAgKiB5b3UgY2FuIGNyZWF0ZSB5b3VyIG93biBwaWUgY2hhcnQgZnVuY3Rpb24gYW5kIHNoaXAgaXQgYXMgYSBSYXBoYcOrbCBwbHVnaW4uIFRvIGRvIHRoaXNcbiAgICAgKiB5b3UgbmVlZCB0byBleHRlbmQgdGhlIGBSYXBoYWVsLmZuYCBvYmplY3QuIFlvdSBzaG91bGQgbW9kaWZ5IHRoZSBgZm5gIG9iamVjdCBiZWZvcmUgYVxuICAgICAqIFJhcGhhw6tsIGluc3RhbmNlIGlzIGNyZWF0ZWQsIG90aGVyd2lzZSBpdCB3aWxsIHRha2Ugbm8gZWZmZWN0LiBQbGVhc2Ugbm90ZSB0aGF0IHRoZVxuICAgICAqIGFiaWxpdHkgZm9yIG5hbWVzcGFjZWQgcGx1Z2lucyB3YXMgcmVtb3ZlZCBpbiBSYXBoYWVsIDIuMC4gSXQgaXMgdXAgdG8gdGhlIHBsdWdpbiB0b1xuICAgICAqIGVuc3VyZSBhbnkgbmFtZXNwYWNpbmcgZW5zdXJlcyBwcm9wZXIgY29udGV4dC5cbiAgICAgPiBVc2FnZVxuICAgICB8IFJhcGhhZWwuZm4uYXJyb3cgPSBmdW5jdGlvbiAoeDEsIHkxLCB4MiwgeTIsIHNpemUpIHtcbiAgICAgfCAgICAgcmV0dXJuIHRoaXMucGF0aCggLi4uICk7XG4gICAgIHwgfTtcbiAgICAgfCAvLyBvciBjcmVhdGUgbmFtZXNwYWNlXG4gICAgIHwgUmFwaGFlbC5mbi5teXN0dWZmID0ge1xuICAgICB8ICAgICBhcnJvdzogZnVuY3Rpb24gKCkge+KApn0sXG4gICAgIHwgICAgIHN0YXI6IGZ1bmN0aW9uICgpIHvigKZ9LFxuICAgICB8ICAgICAvLyBldGPigKZcbiAgICAgfCB9O1xuICAgICB8IHZhciBwYXBlciA9IFJhcGhhZWwoMTAsIDEwLCA2MzAsIDQ4MCk7XG4gICAgIHwgLy8gdGhlbiB1c2UgaXRcbiAgICAgfCBwYXBlci5hcnJvdygxMCwgMTAsIDMwLCAzMCwgNSkuYXR0cih7ZmlsbDogXCIjZjAwXCJ9KTtcbiAgICAgfCBwYXBlci5teXN0dWZmLmFycm93KCk7XG4gICAgIHwgcGFwZXIubXlzdHVmZi5zdGFyKCk7XG4gICAgXFwqL1xuICAgIFIuZm4gPSBwYXBlcnByb3RvID0gUGFwZXIucHJvdG90eXBlID0gUi5wcm90b3R5cGU7XG4gICAgUi5faWQgPSAwO1xuICAgIC8qXFxcbiAgICAgKiBSYXBoYWVsLmlzXG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBIYW5kZnVsIG9mIHJlcGxhY2VtZW50cyBmb3IgYHR5cGVvZmAgb3BlcmF0b3IuXG4gICAgID4gUGFyYW1ldGVyc1xuICAgICAtIG8gKOKApikgYW55IG9iamVjdCBvciBwcmltaXRpdmVcbiAgICAgLSB0eXBlIChzdHJpbmcpIG5hbWUgb2YgdGhlIHR5cGUsIGkuZS4g4oCcc3RyaW5n4oCdLCDigJxmdW5jdGlvbuKAnSwg4oCcbnVtYmVy4oCdLCBldGMuXG4gICAgID0gKGJvb2xlYW4pIGlzIGdpdmVuIHZhbHVlIGlzIG9mIGdpdmVuIHR5cGVcbiAgICBcXCovXG4gICAgUi5pcyA9IGZ1bmN0aW9uIChvLCB0eXBlKSB7XG4gICAgICAgIHR5cGUgPSBsb3dlckNhc2UuY2FsbCh0eXBlKTtcbiAgICAgICAgaWYgKHR5cGUgPT0gXCJmaW5pdGVcIikge1xuICAgICAgICAgICAgcmV0dXJuICFpc25hbltoYXNdKCtvKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZSA9PSBcImFycmF5XCIpIHtcbiAgICAgICAgICAgIHJldHVybiBvIGluc3RhbmNlb2YgQXJyYXk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICAodHlwZSA9PSBcIm51bGxcIiAmJiBvID09PSBudWxsKSB8fFxuICAgICAgICAgICAgICAgICh0eXBlID09IHR5cGVvZiBvICYmIG8gIT09IG51bGwpIHx8XG4gICAgICAgICAgICAgICAgKHR5cGUgPT0gXCJvYmplY3RcIiAmJiBvID09PSBPYmplY3QobykpIHx8XG4gICAgICAgICAgICAgICAgKHR5cGUgPT0gXCJhcnJheVwiICYmIEFycmF5LmlzQXJyYXkgJiYgQXJyYXkuaXNBcnJheShvKSkgfHxcbiAgICAgICAgICAgICAgICBvYmplY3RUb1N0cmluZy5jYWxsKG8pLnNsaWNlKDgsIC0xKS50b0xvd2VyQ2FzZSgpID09IHR5cGU7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIGNsb25lKG9iaikge1xuICAgICAgICBpZiAodHlwZW9mIG9iaiA9PSBcImZ1bmN0aW9uXCIgfHwgT2JqZWN0KG9iaikgIT09IG9iaikge1xuICAgICAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcmVzID0gbmV3IG9iai5jb25zdHJ1Y3RvcjtcbiAgICAgICAgZm9yICh2YXIga2V5IGluIG9iaikgaWYgKG9ialtoYXNdKGtleSkpIHtcbiAgICAgICAgICAgIHJlc1trZXldID0gY2xvbmUob2JqW2tleV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfVxuXG4gICAgLypcXFxuICAgICAqIFJhcGhhZWwuYW5nbGVcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIFJldHVybnMgYW5nbGUgYmV0d2VlbiB0d28gb3IgdGhyZWUgcG9pbnRzXG4gICAgID4gUGFyYW1ldGVyc1xuICAgICAtIHgxIChudW1iZXIpIHggY29vcmQgb2YgZmlyc3QgcG9pbnRcbiAgICAgLSB5MSAobnVtYmVyKSB5IGNvb3JkIG9mIGZpcnN0IHBvaW50XG4gICAgIC0geDIgKG51bWJlcikgeCBjb29yZCBvZiBzZWNvbmQgcG9pbnRcbiAgICAgLSB5MiAobnVtYmVyKSB5IGNvb3JkIG9mIHNlY29uZCBwb2ludFxuICAgICAtIHgzIChudW1iZXIpICNvcHRpb25hbCB4IGNvb3JkIG9mIHRoaXJkIHBvaW50XG4gICAgIC0geTMgKG51bWJlcikgI29wdGlvbmFsIHkgY29vcmQgb2YgdGhpcmQgcG9pbnRcbiAgICAgPSAobnVtYmVyKSBhbmdsZSBpbiBkZWdyZWVzLlxuICAgIFxcKi9cbiAgICBSLmFuZ2xlID0gZnVuY3Rpb24gKHgxLCB5MSwgeDIsIHkyLCB4MywgeTMpIHtcbiAgICAgICAgaWYgKHgzID09IG51bGwpIHtcbiAgICAgICAgICAgIHZhciB4ID0geDEgLSB4MixcbiAgICAgICAgICAgICAgICB5ID0geTEgLSB5MjtcbiAgICAgICAgICAgIGlmICgheCAmJiAheSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICgxODAgKyBtYXRoLmF0YW4yKC15LCAteCkgKiAxODAgLyBQSSArIDM2MCkgJSAzNjA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gUi5hbmdsZSh4MSwgeTEsIHgzLCB5MykgLSBSLmFuZ2xlKHgyLCB5MiwgeDMsIHkzKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLypcXFxuICAgICAqIFJhcGhhZWwucmFkXG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBUcmFuc2Zvcm0gYW5nbGUgdG8gcmFkaWFuc1xuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgLSBkZWcgKG51bWJlcikgYW5nbGUgaW4gZGVncmVlc1xuICAgICA9IChudW1iZXIpIGFuZ2xlIGluIHJhZGlhbnMuXG4gICAgXFwqL1xuICAgIFIucmFkID0gZnVuY3Rpb24gKGRlZykge1xuICAgICAgICByZXR1cm4gZGVnICUgMzYwICogUEkgLyAxODA7XG4gICAgfTtcbiAgICAvKlxcXG4gICAgICogUmFwaGFlbC5kZWdcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIFRyYW5zZm9ybSBhbmdsZSB0byBkZWdyZWVzXG4gICAgID4gUGFyYW1ldGVyc1xuICAgICAtIHJhZCAobnVtYmVyKSBhbmdsZSBpbiByYWRpYW5zXG4gICAgID0gKG51bWJlcikgYW5nbGUgaW4gZGVncmVlcy5cbiAgICBcXCovXG4gICAgUi5kZWcgPSBmdW5jdGlvbiAocmFkKSB7XG4gICAgICAgIHJldHVybiBNYXRoLnJvdW5kICgocmFkICogMTgwIC8gUEklIDM2MCkqIDEwMDApIC8gMTAwMDtcbiAgICB9O1xuICAgIC8qXFxcbiAgICAgKiBSYXBoYWVsLnNuYXBUb1xuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogU25hcHMgZ2l2ZW4gdmFsdWUgdG8gZ2l2ZW4gZ3JpZC5cbiAgICAgPiBQYXJhbWV0ZXJzXG4gICAgIC0gdmFsdWVzIChhcnJheXxudW1iZXIpIGdpdmVuIGFycmF5IG9mIHZhbHVlcyBvciBzdGVwIG9mIHRoZSBncmlkXG4gICAgIC0gdmFsdWUgKG51bWJlcikgdmFsdWUgdG8gYWRqdXN0XG4gICAgIC0gdG9sZXJhbmNlIChudW1iZXIpICNvcHRpb25hbCB0b2xlcmFuY2UgZm9yIHNuYXBwaW5nLiBEZWZhdWx0IGlzIGAxMGAuXG4gICAgID0gKG51bWJlcikgYWRqdXN0ZWQgdmFsdWUuXG4gICAgXFwqL1xuICAgIFIuc25hcFRvID0gZnVuY3Rpb24gKHZhbHVlcywgdmFsdWUsIHRvbGVyYW5jZSkge1xuICAgICAgICB0b2xlcmFuY2UgPSBSLmlzKHRvbGVyYW5jZSwgXCJmaW5pdGVcIikgPyB0b2xlcmFuY2UgOiAxMDtcbiAgICAgICAgaWYgKFIuaXModmFsdWVzLCBhcnJheSkpIHtcbiAgICAgICAgICAgIHZhciBpID0gdmFsdWVzLmxlbmd0aDtcbiAgICAgICAgICAgIHdoaWxlIChpLS0pIGlmIChhYnModmFsdWVzW2ldIC0gdmFsdWUpIDw9IHRvbGVyYW5jZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZXNbaV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YWx1ZXMgPSArdmFsdWVzO1xuICAgICAgICAgICAgdmFyIHJlbSA9IHZhbHVlICUgdmFsdWVzO1xuICAgICAgICAgICAgaWYgKHJlbSA8IHRvbGVyYW5jZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZSAtIHJlbTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChyZW0gPiB2YWx1ZXMgLSB0b2xlcmFuY2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWUgLSByZW0gKyB2YWx1ZXM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH07XG5cbiAgICAvKlxcXG4gICAgICogUmFwaGFlbC5jcmVhdGVVVUlEXG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBSZXR1cm5zIFJGQzQxMjIsIHZlcnNpb24gNCBJRFxuICAgIFxcKi9cbiAgICB2YXIgY3JlYXRlVVVJRCA9IFIuY3JlYXRlVVVJRCA9IChmdW5jdGlvbiAodXVpZFJlZ0V4LCB1dWlkUmVwbGFjZXIpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBcInh4eHh4eHh4LXh4eHgtNHh4eC15eHh4LXh4eHh4eHh4eHh4eFwiLnJlcGxhY2UodXVpZFJlZ0V4LCB1dWlkUmVwbGFjZXIpLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgIH07XG4gICAgfSkoL1t4eV0vZywgZnVuY3Rpb24gKGMpIHtcbiAgICAgICAgdmFyIHIgPSBtYXRoLnJhbmRvbSgpICogMTYgfCAwLFxuICAgICAgICAgICAgdiA9IGMgPT0gXCJ4XCIgPyByIDogKHIgJiAzIHwgOCk7XG4gICAgICAgIHJldHVybiB2LnRvU3RyaW5nKDE2KTtcbiAgICB9KTtcblxuICAgIC8qXFxcbiAgICAgKiBSYXBoYWVsLnNldFdpbmRvd1xuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogVXNlZCB3aGVuIHlvdSBuZWVkIHRvIGRyYXcgaW4gYCZsdDtpZnJhbWU+YC4gU3dpdGNoZWQgd2luZG93IHRvIHRoZSBpZnJhbWUgb25lLlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgLSBuZXd3aW4gKHdpbmRvdykgbmV3IHdpbmRvdyBvYmplY3RcbiAgICBcXCovXG4gICAgUi5zZXRXaW5kb3cgPSBmdW5jdGlvbiAobmV3d2luKSB7XG4gICAgICAgIGV2ZShcInJhcGhhZWwuc2V0V2luZG93XCIsIFIsIGcud2luLCBuZXd3aW4pO1xuICAgICAgICBnLndpbiA9IG5ld3dpbjtcbiAgICAgICAgZy5kb2MgPSBnLndpbi5kb2N1bWVudDtcbiAgICAgICAgaWYgKFIuX2VuZ2luZS5pbml0V2luKSB7XG4gICAgICAgICAgICBSLl9lbmdpbmUuaW5pdFdpbihnLndpbik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHZhciB0b0hleCA9IGZ1bmN0aW9uIChjb2xvcikge1xuICAgICAgICBpZiAoUi52bWwpIHtcbiAgICAgICAgICAgIC8vIGh0dHA6Ly9kZWFuLmVkd2FyZHMubmFtZS93ZWJsb2cvMjAwOS8xMC9jb252ZXJ0LWFueS1jb2xvdXItdmFsdWUtdG8taGV4LWluLW1zaWUvXG4gICAgICAgICAgICB2YXIgdHJpbSA9IC9eXFxzK3xcXHMrJC9nO1xuICAgICAgICAgICAgdmFyIGJvZDtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdmFyIGRvY3VtID0gbmV3IEFjdGl2ZVhPYmplY3QoXCJodG1sZmlsZVwiKTtcbiAgICAgICAgICAgICAgICBkb2N1bS53cml0ZShcIjxib2R5PlwiKTtcbiAgICAgICAgICAgICAgICBkb2N1bS5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIGJvZCA9IGRvY3VtLmJvZHk7XG4gICAgICAgICAgICB9IGNhdGNoKGUpIHtcbiAgICAgICAgICAgICAgICBib2QgPSBjcmVhdGVQb3B1cCgpLmRvY3VtZW50LmJvZHk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcmFuZ2UgPSBib2QuY3JlYXRlVGV4dFJhbmdlKCk7XG4gICAgICAgICAgICB0b0hleCA9IGNhY2hlcihmdW5jdGlvbiAoY29sb3IpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBib2Quc3R5bGUuY29sb3IgPSBTdHIoY29sb3IpLnJlcGxhY2UodHJpbSwgRSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHJhbmdlLnF1ZXJ5Q29tbWFuZFZhbHVlKFwiRm9yZUNvbG9yXCIpO1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9ICgodmFsdWUgJiAyNTUpIDw8IDE2KSB8ICh2YWx1ZSAmIDY1MjgwKSB8ICgodmFsdWUgJiAxNjcxMTY4MCkgPj4+IDE2KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiI1wiICsgKFwiMDAwMDAwXCIgKyB2YWx1ZS50b1N0cmluZygxNikpLnNsaWNlKC02KTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwibm9uZVwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIGkgPSBnLmRvYy5jcmVhdGVFbGVtZW50KFwiaVwiKTtcbiAgICAgICAgICAgIGkudGl0bGUgPSBcIlJhcGhhXFx4ZWJsIENvbG91ciBQaWNrZXJcIjtcbiAgICAgICAgICAgIGkuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgICAgICAgZy5kb2MuYm9keS5hcHBlbmRDaGlsZChpKTtcbiAgICAgICAgICAgIHRvSGV4ID0gY2FjaGVyKGZ1bmN0aW9uIChjb2xvcikge1xuICAgICAgICAgICAgICAgIGkuc3R5bGUuY29sb3IgPSBjb2xvcjtcbiAgICAgICAgICAgICAgICByZXR1cm4gZy5kb2MuZGVmYXVsdFZpZXcuZ2V0Q29tcHV0ZWRTdHlsZShpLCBFKS5nZXRQcm9wZXJ0eVZhbHVlKFwiY29sb3JcIik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG9IZXgoY29sb3IpO1xuICAgIH0sXG4gICAgaHNidG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBcImhzYihcIiArIFt0aGlzLmgsIHRoaXMucywgdGhpcy5iXSArIFwiKVwiO1xuICAgIH0sXG4gICAgaHNsdG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBcImhzbChcIiArIFt0aGlzLmgsIHRoaXMucywgdGhpcy5sXSArIFwiKVwiO1xuICAgIH0sXG4gICAgcmdidG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmhleDtcbiAgICB9LFxuICAgIHByZXBhcmVSR0IgPSBmdW5jdGlvbiAociwgZywgYikge1xuICAgICAgICBpZiAoZyA9PSBudWxsICYmIFIuaXMociwgXCJvYmplY3RcIikgJiYgXCJyXCIgaW4gciAmJiBcImdcIiBpbiByICYmIFwiYlwiIGluIHIpIHtcbiAgICAgICAgICAgIGIgPSByLmI7XG4gICAgICAgICAgICBnID0gci5nO1xuICAgICAgICAgICAgciA9IHIucjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZyA9PSBudWxsICYmIFIuaXMociwgc3RyaW5nKSkge1xuICAgICAgICAgICAgdmFyIGNsciA9IFIuZ2V0UkdCKHIpO1xuICAgICAgICAgICAgciA9IGNsci5yO1xuICAgICAgICAgICAgZyA9IGNsci5nO1xuICAgICAgICAgICAgYiA9IGNsci5iO1xuICAgICAgICB9XG4gICAgICAgIGlmIChyID4gMSB8fCBnID4gMSB8fCBiID4gMSkge1xuICAgICAgICAgICAgciAvPSAyNTU7XG4gICAgICAgICAgICBnIC89IDI1NTtcbiAgICAgICAgICAgIGIgLz0gMjU1O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIFtyLCBnLCBiXTtcbiAgICB9LFxuICAgIHBhY2thZ2VSR0IgPSBmdW5jdGlvbiAociwgZywgYiwgbykge1xuICAgICAgICByICo9IDI1NTtcbiAgICAgICAgZyAqPSAyNTU7XG4gICAgICAgIGIgKj0gMjU1O1xuICAgICAgICB2YXIgcmdiID0ge1xuICAgICAgICAgICAgcjogcixcbiAgICAgICAgICAgIGc6IGcsXG4gICAgICAgICAgICBiOiBiLFxuICAgICAgICAgICAgaGV4OiBSLnJnYihyLCBnLCBiKSxcbiAgICAgICAgICAgIHRvU3RyaW5nOiByZ2J0b1N0cmluZ1xuICAgICAgICB9O1xuICAgICAgICBSLmlzKG8sIFwiZmluaXRlXCIpICYmIChyZ2Iub3BhY2l0eSA9IG8pO1xuICAgICAgICByZXR1cm4gcmdiO1xuICAgIH07XG5cbiAgICAvKlxcXG4gICAgICogUmFwaGFlbC5jb2xvclxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogUGFyc2VzIHRoZSBjb2xvciBzdHJpbmcgYW5kIHJldHVybnMgb2JqZWN0IHdpdGggYWxsIHZhbHVlcyBmb3IgdGhlIGdpdmVuIGNvbG9yLlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgLSBjbHIgKHN0cmluZykgY29sb3Igc3RyaW5nIGluIG9uZSBvZiB0aGUgc3VwcG9ydGVkIGZvcm1hdHMgKHNlZSBAUmFwaGFlbC5nZXRSR0IpXG4gICAgID0gKG9iamVjdCkgQ29tYmluZWQgUkdCICYgSFNCIG9iamVjdCBpbiBmb3JtYXQ6XG4gICAgIG8ge1xuICAgICBvICAgICByIChudW1iZXIpIHJlZCxcbiAgICAgbyAgICAgZyAobnVtYmVyKSBncmVlbixcbiAgICAgbyAgICAgYiAobnVtYmVyKSBibHVlLFxuICAgICBvICAgICBoZXggKHN0cmluZykgY29sb3IgaW4gSFRNTC9DU1MgZm9ybWF0OiAj4oCi4oCi4oCi4oCi4oCi4oCiLFxuICAgICBvICAgICBlcnJvciAoYm9vbGVhbikgYHRydWVgIGlmIHN0cmluZyBjYW7igJl0IGJlIHBhcnNlZCxcbiAgICAgbyAgICAgaCAobnVtYmVyKSBodWUsXG4gICAgIG8gICAgIHMgKG51bWJlcikgc2F0dXJhdGlvbixcbiAgICAgbyAgICAgdiAobnVtYmVyKSB2YWx1ZSAoYnJpZ2h0bmVzcyksXG4gICAgIG8gICAgIGwgKG51bWJlcikgbGlnaHRuZXNzXG4gICAgIG8gfVxuICAgIFxcKi9cbiAgICBSLmNvbG9yID0gZnVuY3Rpb24gKGNscikge1xuICAgICAgICB2YXIgcmdiO1xuICAgICAgICBpZiAoUi5pcyhjbHIsIFwib2JqZWN0XCIpICYmIFwiaFwiIGluIGNsciAmJiBcInNcIiBpbiBjbHIgJiYgXCJiXCIgaW4gY2xyKSB7XG4gICAgICAgICAgICByZ2IgPSBSLmhzYjJyZ2IoY2xyKTtcbiAgICAgICAgICAgIGNsci5yID0gcmdiLnI7XG4gICAgICAgICAgICBjbHIuZyA9IHJnYi5nO1xuICAgICAgICAgICAgY2xyLmIgPSByZ2IuYjtcbiAgICAgICAgICAgIGNsci5oZXggPSByZ2IuaGV4O1xuICAgICAgICB9IGVsc2UgaWYgKFIuaXMoY2xyLCBcIm9iamVjdFwiKSAmJiBcImhcIiBpbiBjbHIgJiYgXCJzXCIgaW4gY2xyICYmIFwibFwiIGluIGNscikge1xuICAgICAgICAgICAgcmdiID0gUi5oc2wycmdiKGNscik7XG4gICAgICAgICAgICBjbHIuciA9IHJnYi5yO1xuICAgICAgICAgICAgY2xyLmcgPSByZ2IuZztcbiAgICAgICAgICAgIGNsci5iID0gcmdiLmI7XG4gICAgICAgICAgICBjbHIuaGV4ID0gcmdiLmhleDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChSLmlzKGNsciwgXCJzdHJpbmdcIikpIHtcbiAgICAgICAgICAgICAgICBjbHIgPSBSLmdldFJHQihjbHIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKFIuaXMoY2xyLCBcIm9iamVjdFwiKSAmJiBcInJcIiBpbiBjbHIgJiYgXCJnXCIgaW4gY2xyICYmIFwiYlwiIGluIGNscikge1xuICAgICAgICAgICAgICAgIHJnYiA9IFIucmdiMmhzbChjbHIpO1xuICAgICAgICAgICAgICAgIGNsci5oID0gcmdiLmg7XG4gICAgICAgICAgICAgICAgY2xyLnMgPSByZ2IucztcbiAgICAgICAgICAgICAgICBjbHIubCA9IHJnYi5sO1xuICAgICAgICAgICAgICAgIHJnYiA9IFIucmdiMmhzYihjbHIpO1xuICAgICAgICAgICAgICAgIGNsci52ID0gcmdiLmI7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNsciA9IHtoZXg6IFwibm9uZVwifTtcbiAgICAgICAgICAgICAgICBjbHIuciA9IGNsci5nID0gY2xyLmIgPSBjbHIuaCA9IGNsci5zID0gY2xyLnYgPSBjbHIubCA9IC0xO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNsci50b1N0cmluZyA9IHJnYnRvU3RyaW5nO1xuICAgICAgICByZXR1cm4gY2xyO1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIFJhcGhhZWwuaHNiMnJnYlxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogQ29udmVydHMgSFNCIHZhbHVlcyB0byBSR0Igb2JqZWN0LlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgLSBoIChudW1iZXIpIGh1ZVxuICAgICAtIHMgKG51bWJlcikgc2F0dXJhdGlvblxuICAgICAtIHYgKG51bWJlcikgdmFsdWUgb3IgYnJpZ2h0bmVzc1xuICAgICA9IChvYmplY3QpIFJHQiBvYmplY3QgaW4gZm9ybWF0OlxuICAgICBvIHtcbiAgICAgbyAgICAgciAobnVtYmVyKSByZWQsXG4gICAgIG8gICAgIGcgKG51bWJlcikgZ3JlZW4sXG4gICAgIG8gICAgIGIgKG51bWJlcikgYmx1ZSxcbiAgICAgbyAgICAgaGV4IChzdHJpbmcpIGNvbG9yIGluIEhUTUwvQ1NTIGZvcm1hdDogI+KAouKAouKAouKAouKAouKAolxuICAgICBvIH1cbiAgICBcXCovXG4gICAgUi5oc2IycmdiID0gZnVuY3Rpb24gKGgsIHMsIHYsIG8pIHtcbiAgICAgICAgaWYgKHRoaXMuaXMoaCwgXCJvYmplY3RcIikgJiYgXCJoXCIgaW4gaCAmJiBcInNcIiBpbiBoICYmIFwiYlwiIGluIGgpIHtcbiAgICAgICAgICAgIHYgPSBoLmI7XG4gICAgICAgICAgICBzID0gaC5zO1xuICAgICAgICAgICAgbyA9IGgubztcbiAgICAgICAgICAgIGggPSBoLmg7XG4gICAgICAgIH1cbiAgICAgICAgaCAqPSAzNjA7XG4gICAgICAgIHZhciBSLCBHLCBCLCBYLCBDO1xuICAgICAgICBoID0gKGggJSAzNjApIC8gNjA7XG4gICAgICAgIEMgPSB2ICogcztcbiAgICAgICAgWCA9IEMgKiAoMSAtIGFicyhoICUgMiAtIDEpKTtcbiAgICAgICAgUiA9IEcgPSBCID0gdiAtIEM7XG5cbiAgICAgICAgaCA9IH5+aDtcbiAgICAgICAgUiArPSBbQywgWCwgMCwgMCwgWCwgQ11baF07XG4gICAgICAgIEcgKz0gW1gsIEMsIEMsIFgsIDAsIDBdW2hdO1xuICAgICAgICBCICs9IFswLCAwLCBYLCBDLCBDLCBYXVtoXTtcbiAgICAgICAgcmV0dXJuIHBhY2thZ2VSR0IoUiwgRywgQiwgbyk7XG4gICAgfTtcbiAgICAvKlxcXG4gICAgICogUmFwaGFlbC5oc2wycmdiXG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBDb252ZXJ0cyBIU0wgdmFsdWVzIHRvIFJHQiBvYmplY3QuXG4gICAgID4gUGFyYW1ldGVyc1xuICAgICAtIGggKG51bWJlcikgaHVlXG4gICAgIC0gcyAobnVtYmVyKSBzYXR1cmF0aW9uXG4gICAgIC0gbCAobnVtYmVyKSBsdW1pbm9zaXR5XG4gICAgID0gKG9iamVjdCkgUkdCIG9iamVjdCBpbiBmb3JtYXQ6XG4gICAgIG8ge1xuICAgICBvICAgICByIChudW1iZXIpIHJlZCxcbiAgICAgbyAgICAgZyAobnVtYmVyKSBncmVlbixcbiAgICAgbyAgICAgYiAobnVtYmVyKSBibHVlLFxuICAgICBvICAgICBoZXggKHN0cmluZykgY29sb3IgaW4gSFRNTC9DU1MgZm9ybWF0OiAj4oCi4oCi4oCi4oCi4oCi4oCiXG4gICAgIG8gfVxuICAgIFxcKi9cbiAgICBSLmhzbDJyZ2IgPSBmdW5jdGlvbiAoaCwgcywgbCwgbykge1xuICAgICAgICBpZiAodGhpcy5pcyhoLCBcIm9iamVjdFwiKSAmJiBcImhcIiBpbiBoICYmIFwic1wiIGluIGggJiYgXCJsXCIgaW4gaCkge1xuICAgICAgICAgICAgbCA9IGgubDtcbiAgICAgICAgICAgIHMgPSBoLnM7XG4gICAgICAgICAgICBoID0gaC5oO1xuICAgICAgICB9XG4gICAgICAgIGlmIChoID4gMSB8fCBzID4gMSB8fCBsID4gMSkge1xuICAgICAgICAgICAgaCAvPSAzNjA7XG4gICAgICAgICAgICBzIC89IDEwMDtcbiAgICAgICAgICAgIGwgLz0gMTAwO1xuICAgICAgICB9XG4gICAgICAgIGggKj0gMzYwO1xuICAgICAgICB2YXIgUiwgRywgQiwgWCwgQztcbiAgICAgICAgaCA9IChoICUgMzYwKSAvIDYwO1xuICAgICAgICBDID0gMiAqIHMgKiAobCA8IC41ID8gbCA6IDEgLSBsKTtcbiAgICAgICAgWCA9IEMgKiAoMSAtIGFicyhoICUgMiAtIDEpKTtcbiAgICAgICAgUiA9IEcgPSBCID0gbCAtIEMgLyAyO1xuXG4gICAgICAgIGggPSB+fmg7XG4gICAgICAgIFIgKz0gW0MsIFgsIDAsIDAsIFgsIENdW2hdO1xuICAgICAgICBHICs9IFtYLCBDLCBDLCBYLCAwLCAwXVtoXTtcbiAgICAgICAgQiArPSBbMCwgMCwgWCwgQywgQywgWF1baF07XG4gICAgICAgIHJldHVybiBwYWNrYWdlUkdCKFIsIEcsIEIsIG8pO1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIFJhcGhhZWwucmdiMmhzYlxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogQ29udmVydHMgUkdCIHZhbHVlcyB0byBIU0Igb2JqZWN0LlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgLSByIChudW1iZXIpIHJlZFxuICAgICAtIGcgKG51bWJlcikgZ3JlZW5cbiAgICAgLSBiIChudW1iZXIpIGJsdWVcbiAgICAgPSAob2JqZWN0KSBIU0Igb2JqZWN0IGluIGZvcm1hdDpcbiAgICAgbyB7XG4gICAgIG8gICAgIGggKG51bWJlcikgaHVlXG4gICAgIG8gICAgIHMgKG51bWJlcikgc2F0dXJhdGlvblxuICAgICBvICAgICBiIChudW1iZXIpIGJyaWdodG5lc3NcbiAgICAgbyB9XG4gICAgXFwqL1xuICAgIFIucmdiMmhzYiA9IGZ1bmN0aW9uIChyLCBnLCBiKSB7XG4gICAgICAgIGIgPSBwcmVwYXJlUkdCKHIsIGcsIGIpO1xuICAgICAgICByID0gYlswXTtcbiAgICAgICAgZyA9IGJbMV07XG4gICAgICAgIGIgPSBiWzJdO1xuXG4gICAgICAgIHZhciBILCBTLCBWLCBDO1xuICAgICAgICBWID0gbW1heChyLCBnLCBiKTtcbiAgICAgICAgQyA9IFYgLSBtbWluKHIsIGcsIGIpO1xuICAgICAgICBIID0gKEMgPT0gMCA/IG51bGwgOlxuICAgICAgICAgICAgIFYgPT0gciA/IChnIC0gYikgLyBDIDpcbiAgICAgICAgICAgICBWID09IGcgPyAoYiAtIHIpIC8gQyArIDIgOlxuICAgICAgICAgICAgICAgICAgICAgIChyIC0gZykgLyBDICsgNFxuICAgICAgICAgICAgKTtcbiAgICAgICAgSCA9ICgoSCArIDM2MCkgJSA2KSAqIDYwIC8gMzYwO1xuICAgICAgICBTID0gQyA9PSAwID8gMCA6IEMgLyBWO1xuICAgICAgICByZXR1cm4ge2g6IEgsIHM6IFMsIGI6IFYsIHRvU3RyaW5nOiBoc2J0b1N0cmluZ307XG4gICAgfTtcbiAgICAvKlxcXG4gICAgICogUmFwaGFlbC5yZ2IyaHNsXG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBDb252ZXJ0cyBSR0IgdmFsdWVzIHRvIEhTTCBvYmplY3QuXG4gICAgID4gUGFyYW1ldGVyc1xuICAgICAtIHIgKG51bWJlcikgcmVkXG4gICAgIC0gZyAobnVtYmVyKSBncmVlblxuICAgICAtIGIgKG51bWJlcikgYmx1ZVxuICAgICA9IChvYmplY3QpIEhTTCBvYmplY3QgaW4gZm9ybWF0OlxuICAgICBvIHtcbiAgICAgbyAgICAgaCAobnVtYmVyKSBodWVcbiAgICAgbyAgICAgcyAobnVtYmVyKSBzYXR1cmF0aW9uXG4gICAgIG8gICAgIGwgKG51bWJlcikgbHVtaW5vc2l0eVxuICAgICBvIH1cbiAgICBcXCovXG4gICAgUi5yZ2IyaHNsID0gZnVuY3Rpb24gKHIsIGcsIGIpIHtcbiAgICAgICAgYiA9IHByZXBhcmVSR0IociwgZywgYik7XG4gICAgICAgIHIgPSBiWzBdO1xuICAgICAgICBnID0gYlsxXTtcbiAgICAgICAgYiA9IGJbMl07XG5cbiAgICAgICAgdmFyIEgsIFMsIEwsIE0sIG0sIEM7XG4gICAgICAgIE0gPSBtbWF4KHIsIGcsIGIpO1xuICAgICAgICBtID0gbW1pbihyLCBnLCBiKTtcbiAgICAgICAgQyA9IE0gLSBtO1xuICAgICAgICBIID0gKEMgPT0gMCA/IG51bGwgOlxuICAgICAgICAgICAgIE0gPT0gciA/IChnIC0gYikgLyBDIDpcbiAgICAgICAgICAgICBNID09IGcgPyAoYiAtIHIpIC8gQyArIDIgOlxuICAgICAgICAgICAgICAgICAgICAgIChyIC0gZykgLyBDICsgNCk7XG4gICAgICAgIEggPSAoKEggKyAzNjApICUgNikgKiA2MCAvIDM2MDtcbiAgICAgICAgTCA9IChNICsgbSkgLyAyO1xuICAgICAgICBTID0gKEMgPT0gMCA/IDAgOlxuICAgICAgICAgICAgIEwgPCAuNSA/IEMgLyAoMiAqIEwpIDpcbiAgICAgICAgICAgICAgICAgICAgICBDIC8gKDIgLSAyICogTCkpO1xuICAgICAgICByZXR1cm4ge2g6IEgsIHM6IFMsIGw6IEwsIHRvU3RyaW5nOiBoc2x0b1N0cmluZ307XG4gICAgfTtcbiAgICBSLl9wYXRoMnN0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuam9pbihcIixcIikucmVwbGFjZShwMnMsIFwiJDFcIik7XG4gICAgfTtcbiAgICBmdW5jdGlvbiByZXB1c2goYXJyYXksIGl0ZW0pIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gYXJyYXkubGVuZ3RoOyBpIDwgaWk7IGkrKykgaWYgKGFycmF5W2ldID09PSBpdGVtKSB7XG4gICAgICAgICAgICByZXR1cm4gYXJyYXkucHVzaChhcnJheS5zcGxpY2UoaSwgMSlbMF0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIGNhY2hlcihmLCBzY29wZSwgcG9zdHByb2Nlc3Nvcikge1xuICAgICAgICBmdW5jdGlvbiBuZXdmKCkge1xuICAgICAgICAgICAgdmFyIGFyZyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMCksXG4gICAgICAgICAgICAgICAgYXJncyA9IGFyZy5qb2luKFwiXFx1MjQwMFwiKSxcbiAgICAgICAgICAgICAgICBjYWNoZSA9IG5ld2YuY2FjaGUgPSBuZXdmLmNhY2hlIHx8IHt9LFxuICAgICAgICAgICAgICAgIGNvdW50ID0gbmV3Zi5jb3VudCA9IG5ld2YuY291bnQgfHwgW107XG4gICAgICAgICAgICBpZiAoY2FjaGVbaGFzXShhcmdzKSkge1xuICAgICAgICAgICAgICAgIHJlcHVzaChjb3VudCwgYXJncyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBvc3Rwcm9jZXNzb3IgPyBwb3N0cHJvY2Vzc29yKGNhY2hlW2FyZ3NdKSA6IGNhY2hlW2FyZ3NdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY291bnQubGVuZ3RoID49IDFlMyAmJiBkZWxldGUgY2FjaGVbY291bnQuc2hpZnQoKV07XG4gICAgICAgICAgICBjb3VudC5wdXNoKGFyZ3MpO1xuICAgICAgICAgICAgY2FjaGVbYXJnc10gPSBmW2FwcGx5XShzY29wZSwgYXJnKTtcbiAgICAgICAgICAgIHJldHVybiBwb3N0cHJvY2Vzc29yID8gcG9zdHByb2Nlc3NvcihjYWNoZVthcmdzXSkgOiBjYWNoZVthcmdzXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3ZjtcbiAgICB9XG5cbiAgICB2YXIgcHJlbG9hZCA9IFIuX3ByZWxvYWQgPSBmdW5jdGlvbiAoc3JjLCBmKSB7XG4gICAgICAgIHZhciBpbWcgPSBnLmRvYy5jcmVhdGVFbGVtZW50KFwiaW1nXCIpO1xuICAgICAgICBpbWcuc3R5bGUuY3NzVGV4dCA9IFwicG9zaXRpb246YWJzb2x1dGU7bGVmdDotOTk5OWVtO3RvcDotOTk5OWVtXCI7XG4gICAgICAgIGltZy5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBmLmNhbGwodGhpcyk7XG4gICAgICAgICAgICB0aGlzLm9ubG9hZCA9IG51bGw7XG4gICAgICAgICAgICBnLmRvYy5ib2R5LnJlbW92ZUNoaWxkKHRoaXMpO1xuICAgICAgICB9O1xuICAgICAgICBpbWcub25lcnJvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGcuZG9jLmJvZHkucmVtb3ZlQ2hpbGQodGhpcyk7XG4gICAgICAgIH07XG4gICAgICAgIGcuZG9jLmJvZHkuYXBwZW5kQ2hpbGQoaW1nKTtcbiAgICAgICAgaW1nLnNyYyA9IHNyYztcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gY2xyVG9TdHJpbmcoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmhleDtcbiAgICB9XG5cbiAgICAvKlxcXG4gICAgICogUmFwaGFlbC5nZXRSR0JcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIFBhcnNlcyBjb2xvdXIgc3RyaW5nIGFzIFJHQiBvYmplY3RcbiAgICAgPiBQYXJhbWV0ZXJzXG4gICAgIC0gY29sb3VyIChzdHJpbmcpIGNvbG91ciBzdHJpbmcgaW4gb25lIG9mIGZvcm1hdHM6XG4gICAgICMgPHVsPlxuICAgICAjICAgICA8bGk+Q29sb3VyIG5hbWUgKOKAnDxjb2RlPnJlZDwvY29kZT7igJ0sIOKAnDxjb2RlPmdyZWVuPC9jb2RlPuKAnSwg4oCcPGNvZGU+Y29ybmZsb3dlcmJsdWU8L2NvZGU+4oCdLCBldGMpPC9saT5cbiAgICAgIyAgICAgPGxpPiPigKLigKLigKIg4oCUIHNob3J0ZW5lZCBIVE1MIGNvbG91cjogKOKAnDxjb2RlPiMwMDA8L2NvZGU+4oCdLCDigJw8Y29kZT4jZmMwPC9jb2RlPuKAnSwgZXRjKTwvbGk+XG4gICAgICMgICAgIDxsaT4j4oCi4oCi4oCi4oCi4oCi4oCiIOKAlCBmdWxsIGxlbmd0aCBIVE1MIGNvbG91cjogKOKAnDxjb2RlPiMwMDAwMDA8L2NvZGU+4oCdLCDigJw8Y29kZT4jYmQyMzAwPC9jb2RlPuKAnSk8L2xpPlxuICAgICAjICAgICA8bGk+cmdiKOKAouKAouKAoiwg4oCi4oCi4oCiLCDigKLigKLigKIpIOKAlCByZWQsIGdyZWVuIGFuZCBibHVlIGNoYW5uZWxz4oCZIHZhbHVlczogKOKAnDxjb2RlPnJnYigyMDAsJm5ic3A7MTAwLCZuYnNwOzApPC9jb2RlPuKAnSk8L2xpPlxuICAgICAjICAgICA8bGk+cmdiKOKAouKAouKAoiUsIOKAouKAouKAoiUsIOKAouKAouKAoiUpIOKAlCBzYW1lIGFzIGFib3ZlLCBidXQgaW4gJTogKOKAnDxjb2RlPnJnYigxMDAlLCZuYnNwOzE3NSUsJm5ic3A7MCUpPC9jb2RlPuKAnSk8L2xpPlxuICAgICAjICAgICA8bGk+aHNiKOKAouKAouKAoiwg4oCi4oCi4oCiLCDigKLigKLigKIpIOKAlCBodWUsIHNhdHVyYXRpb24gYW5kIGJyaWdodG5lc3MgdmFsdWVzOiAo4oCcPGNvZGU+aHNiKDAuNSwmbmJzcDswLjI1LCZuYnNwOzEpPC9jb2RlPuKAnSk8L2xpPlxuICAgICAjICAgICA8bGk+aHNiKOKAouKAouKAoiUsIOKAouKAouKAoiUsIOKAouKAouKAoiUpIOKAlCBzYW1lIGFzIGFib3ZlLCBidXQgaW4gJTwvbGk+XG4gICAgICMgICAgIDxsaT5oc2wo4oCi4oCi4oCiLCDigKLigKLigKIsIOKAouKAouKAoikg4oCUIHNhbWUgYXMgaHNiPC9saT5cbiAgICAgIyAgICAgPGxpPmhzbCjigKLigKLigKIlLCDigKLigKLigKIlLCDigKLigKLigKIlKSDigJQgc2FtZSBhcyBoc2I8L2xpPlxuICAgICAjIDwvdWw+XG4gICAgID0gKG9iamVjdCkgUkdCIG9iamVjdCBpbiBmb3JtYXQ6XG4gICAgIG8ge1xuICAgICBvICAgICByIChudW1iZXIpIHJlZCxcbiAgICAgbyAgICAgZyAobnVtYmVyKSBncmVlbixcbiAgICAgbyAgICAgYiAobnVtYmVyKSBibHVlXG4gICAgIG8gICAgIGhleCAoc3RyaW5nKSBjb2xvciBpbiBIVE1ML0NTUyBmb3JtYXQ6ICPigKLigKLigKLigKLigKLigKIsXG4gICAgIG8gICAgIGVycm9yIChib29sZWFuKSB0cnVlIGlmIHN0cmluZyBjYW7igJl0IGJlIHBhcnNlZFxuICAgICBvIH1cbiAgICBcXCovXG4gICAgUi5nZXRSR0IgPSBjYWNoZXIoZnVuY3Rpb24gKGNvbG91cikge1xuICAgICAgICBpZiAoIWNvbG91ciB8fCAhISgoY29sb3VyID0gU3RyKGNvbG91cikpLmluZGV4T2YoXCItXCIpICsgMSkpIHtcbiAgICAgICAgICAgIHJldHVybiB7cjogLTEsIGc6IC0xLCBiOiAtMSwgaGV4OiBcIm5vbmVcIiwgZXJyb3I6IDEsIHRvU3RyaW5nOiBjbHJUb1N0cmluZ307XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbG91ciA9PSBcIm5vbmVcIikge1xuICAgICAgICAgICAgcmV0dXJuIHtyOiAtMSwgZzogLTEsIGI6IC0xLCBoZXg6IFwibm9uZVwiLCB0b1N0cmluZzogY2xyVG9TdHJpbmd9O1xuICAgICAgICB9XG4gICAgICAgICEoaHNyZ1toYXNdKGNvbG91ci50b0xvd2VyQ2FzZSgpLnN1YnN0cmluZygwLCAyKSkgfHwgY29sb3VyLmNoYXJBdCgpID09IFwiI1wiKSAmJiAoY29sb3VyID0gdG9IZXgoY29sb3VyKSk7XG4gICAgICAgIHZhciByZXMsXG4gICAgICAgICAgICByZWQsXG4gICAgICAgICAgICBncmVlbixcbiAgICAgICAgICAgIGJsdWUsXG4gICAgICAgICAgICBvcGFjaXR5LFxuICAgICAgICAgICAgdCxcbiAgICAgICAgICAgIHZhbHVlcyxcbiAgICAgICAgICAgIHJnYiA9IGNvbG91ci5tYXRjaChjb2xvdXJSZWdFeHApO1xuICAgICAgICBpZiAocmdiKSB7XG4gICAgICAgICAgICBpZiAocmdiWzJdKSB7XG4gICAgICAgICAgICAgICAgYmx1ZSA9IHRvSW50KHJnYlsyXS5zdWJzdHJpbmcoNSksIDE2KTtcbiAgICAgICAgICAgICAgICBncmVlbiA9IHRvSW50KHJnYlsyXS5zdWJzdHJpbmcoMywgNSksIDE2KTtcbiAgICAgICAgICAgICAgICByZWQgPSB0b0ludChyZ2JbMl0uc3Vic3RyaW5nKDEsIDMpLCAxNik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocmdiWzNdKSB7XG4gICAgICAgICAgICAgICAgYmx1ZSA9IHRvSW50KCh0ID0gcmdiWzNdLmNoYXJBdCgzKSkgKyB0LCAxNik7XG4gICAgICAgICAgICAgICAgZ3JlZW4gPSB0b0ludCgodCA9IHJnYlszXS5jaGFyQXQoMikpICsgdCwgMTYpO1xuICAgICAgICAgICAgICAgIHJlZCA9IHRvSW50KCh0ID0gcmdiWzNdLmNoYXJBdCgxKSkgKyB0LCAxNik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocmdiWzRdKSB7XG4gICAgICAgICAgICAgICAgdmFsdWVzID0gcmdiWzRdW3NwbGl0XShjb21tYVNwYWNlcyk7XG4gICAgICAgICAgICAgICAgcmVkID0gdG9GbG9hdCh2YWx1ZXNbMF0pO1xuICAgICAgICAgICAgICAgIHZhbHVlc1swXS5zbGljZSgtMSkgPT0gXCIlXCIgJiYgKHJlZCAqPSAyLjU1KTtcbiAgICAgICAgICAgICAgICBncmVlbiA9IHRvRmxvYXQodmFsdWVzWzFdKTtcbiAgICAgICAgICAgICAgICB2YWx1ZXNbMV0uc2xpY2UoLTEpID09IFwiJVwiICYmIChncmVlbiAqPSAyLjU1KTtcbiAgICAgICAgICAgICAgICBibHVlID0gdG9GbG9hdCh2YWx1ZXNbMl0pO1xuICAgICAgICAgICAgICAgIHZhbHVlc1syXS5zbGljZSgtMSkgPT0gXCIlXCIgJiYgKGJsdWUgKj0gMi41NSk7XG4gICAgICAgICAgICAgICAgcmdiWzFdLnRvTG93ZXJDYXNlKCkuc2xpY2UoMCwgNCkgPT0gXCJyZ2JhXCIgJiYgKG9wYWNpdHkgPSB0b0Zsb2F0KHZhbHVlc1szXSkpO1xuICAgICAgICAgICAgICAgIHZhbHVlc1szXSAmJiB2YWx1ZXNbM10uc2xpY2UoLTEpID09IFwiJVwiICYmIChvcGFjaXR5IC89IDEwMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocmdiWzVdKSB7XG4gICAgICAgICAgICAgICAgdmFsdWVzID0gcmdiWzVdW3NwbGl0XShjb21tYVNwYWNlcyk7XG4gICAgICAgICAgICAgICAgcmVkID0gdG9GbG9hdCh2YWx1ZXNbMF0pO1xuICAgICAgICAgICAgICAgIHZhbHVlc1swXS5zbGljZSgtMSkgPT0gXCIlXCIgJiYgKHJlZCAqPSAyLjU1KTtcbiAgICAgICAgICAgICAgICBncmVlbiA9IHRvRmxvYXQodmFsdWVzWzFdKTtcbiAgICAgICAgICAgICAgICB2YWx1ZXNbMV0uc2xpY2UoLTEpID09IFwiJVwiICYmIChncmVlbiAqPSAyLjU1KTtcbiAgICAgICAgICAgICAgICBibHVlID0gdG9GbG9hdCh2YWx1ZXNbMl0pO1xuICAgICAgICAgICAgICAgIHZhbHVlc1syXS5zbGljZSgtMSkgPT0gXCIlXCIgJiYgKGJsdWUgKj0gMi41NSk7XG4gICAgICAgICAgICAgICAgKHZhbHVlc1swXS5zbGljZSgtMykgPT0gXCJkZWdcIiB8fCB2YWx1ZXNbMF0uc2xpY2UoLTEpID09IFwiXFx4YjBcIikgJiYgKHJlZCAvPSAzNjApO1xuICAgICAgICAgICAgICAgIHJnYlsxXS50b0xvd2VyQ2FzZSgpLnNsaWNlKDAsIDQpID09IFwiaHNiYVwiICYmIChvcGFjaXR5ID0gdG9GbG9hdCh2YWx1ZXNbM10pKTtcbiAgICAgICAgICAgICAgICB2YWx1ZXNbM10gJiYgdmFsdWVzWzNdLnNsaWNlKC0xKSA9PSBcIiVcIiAmJiAob3BhY2l0eSAvPSAxMDApO1xuICAgICAgICAgICAgICAgIHJldHVybiBSLmhzYjJyZ2IocmVkLCBncmVlbiwgYmx1ZSwgb3BhY2l0eSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocmdiWzZdKSB7XG4gICAgICAgICAgICAgICAgdmFsdWVzID0gcmdiWzZdW3NwbGl0XShjb21tYVNwYWNlcyk7XG4gICAgICAgICAgICAgICAgcmVkID0gdG9GbG9hdCh2YWx1ZXNbMF0pO1xuICAgICAgICAgICAgICAgIHZhbHVlc1swXS5zbGljZSgtMSkgPT0gXCIlXCIgJiYgKHJlZCAqPSAyLjU1KTtcbiAgICAgICAgICAgICAgICBncmVlbiA9IHRvRmxvYXQodmFsdWVzWzFdKTtcbiAgICAgICAgICAgICAgICB2YWx1ZXNbMV0uc2xpY2UoLTEpID09IFwiJVwiICYmIChncmVlbiAqPSAyLjU1KTtcbiAgICAgICAgICAgICAgICBibHVlID0gdG9GbG9hdCh2YWx1ZXNbMl0pO1xuICAgICAgICAgICAgICAgIHZhbHVlc1syXS5zbGljZSgtMSkgPT0gXCIlXCIgJiYgKGJsdWUgKj0gMi41NSk7XG4gICAgICAgICAgICAgICAgKHZhbHVlc1swXS5zbGljZSgtMykgPT0gXCJkZWdcIiB8fCB2YWx1ZXNbMF0uc2xpY2UoLTEpID09IFwiXFx4YjBcIikgJiYgKHJlZCAvPSAzNjApO1xuICAgICAgICAgICAgICAgIHJnYlsxXS50b0xvd2VyQ2FzZSgpLnNsaWNlKDAsIDQpID09IFwiaHNsYVwiICYmIChvcGFjaXR5ID0gdG9GbG9hdCh2YWx1ZXNbM10pKTtcbiAgICAgICAgICAgICAgICB2YWx1ZXNbM10gJiYgdmFsdWVzWzNdLnNsaWNlKC0xKSA9PSBcIiVcIiAmJiAob3BhY2l0eSAvPSAxMDApO1xuICAgICAgICAgICAgICAgIHJldHVybiBSLmhzbDJyZ2IocmVkLCBncmVlbiwgYmx1ZSwgb3BhY2l0eSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZ2IgPSB7cjogcmVkLCBnOiBncmVlbiwgYjogYmx1ZSwgdG9TdHJpbmc6IGNsclRvU3RyaW5nfTtcbiAgICAgICAgICAgIHJnYi5oZXggPSBcIiNcIiArICgxNjc3NzIxNiB8IGJsdWUgfCAoZ3JlZW4gPDwgOCkgfCAocmVkIDw8IDE2KSkudG9TdHJpbmcoMTYpLnNsaWNlKDEpO1xuICAgICAgICAgICAgUi5pcyhvcGFjaXR5LCBcImZpbml0ZVwiKSAmJiAocmdiLm9wYWNpdHkgPSBvcGFjaXR5KTtcbiAgICAgICAgICAgIHJldHVybiByZ2I7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtyOiAtMSwgZzogLTEsIGI6IC0xLCBoZXg6IFwibm9uZVwiLCBlcnJvcjogMSwgdG9TdHJpbmc6IGNsclRvU3RyaW5nfTtcbiAgICB9LCBSKTtcbiAgICAvKlxcXG4gICAgICogUmFwaGFlbC5oc2JcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIENvbnZlcnRzIEhTQiB2YWx1ZXMgdG8gaGV4IHJlcHJlc2VudGF0aW9uIG9mIHRoZSBjb2xvdXIuXG4gICAgID4gUGFyYW1ldGVyc1xuICAgICAtIGggKG51bWJlcikgaHVlXG4gICAgIC0gcyAobnVtYmVyKSBzYXR1cmF0aW9uXG4gICAgIC0gYiAobnVtYmVyKSB2YWx1ZSBvciBicmlnaHRuZXNzXG4gICAgID0gKHN0cmluZykgaGV4IHJlcHJlc2VudGF0aW9uIG9mIHRoZSBjb2xvdXIuXG4gICAgXFwqL1xuICAgIFIuaHNiID0gY2FjaGVyKGZ1bmN0aW9uIChoLCBzLCBiKSB7XG4gICAgICAgIHJldHVybiBSLmhzYjJyZ2IoaCwgcywgYikuaGV4O1xuICAgIH0pO1xuICAgIC8qXFxcbiAgICAgKiBSYXBoYWVsLmhzbFxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogQ29udmVydHMgSFNMIHZhbHVlcyB0byBoZXggcmVwcmVzZW50YXRpb24gb2YgdGhlIGNvbG91ci5cbiAgICAgPiBQYXJhbWV0ZXJzXG4gICAgIC0gaCAobnVtYmVyKSBodWVcbiAgICAgLSBzIChudW1iZXIpIHNhdHVyYXRpb25cbiAgICAgLSBsIChudW1iZXIpIGx1bWlub3NpdHlcbiAgICAgPSAoc3RyaW5nKSBoZXggcmVwcmVzZW50YXRpb24gb2YgdGhlIGNvbG91ci5cbiAgICBcXCovXG4gICAgUi5oc2wgPSBjYWNoZXIoZnVuY3Rpb24gKGgsIHMsIGwpIHtcbiAgICAgICAgcmV0dXJuIFIuaHNsMnJnYihoLCBzLCBsKS5oZXg7XG4gICAgfSk7XG4gICAgLypcXFxuICAgICAqIFJhcGhhZWwucmdiXG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBDb252ZXJ0cyBSR0IgdmFsdWVzIHRvIGhleCByZXByZXNlbnRhdGlvbiBvZiB0aGUgY29sb3VyLlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgLSByIChudW1iZXIpIHJlZFxuICAgICAtIGcgKG51bWJlcikgZ3JlZW5cbiAgICAgLSBiIChudW1iZXIpIGJsdWVcbiAgICAgPSAoc3RyaW5nKSBoZXggcmVwcmVzZW50YXRpb24gb2YgdGhlIGNvbG91ci5cbiAgICBcXCovXG4gICAgUi5yZ2IgPSBjYWNoZXIoZnVuY3Rpb24gKHIsIGcsIGIpIHtcbiAgICAgICAgZnVuY3Rpb24gcm91bmQoeCkgeyByZXR1cm4gKHggKyAwLjUpIHwgMDsgfVxuICAgICAgICByZXR1cm4gXCIjXCIgKyAoMTY3NzcyMTYgfCByb3VuZChiKSB8IChyb3VuZChnKSA8PCA4KSB8IChyb3VuZChyKSA8PCAxNikpLnRvU3RyaW5nKDE2KS5zbGljZSgxKTtcbiAgICB9KTtcbiAgICAvKlxcXG4gICAgICogUmFwaGFlbC5nZXRDb2xvclxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogT24gZWFjaCBjYWxsIHJldHVybnMgbmV4dCBjb2xvdXIgaW4gdGhlIHNwZWN0cnVtLiBUbyByZXNldCBpdCBiYWNrIHRvIHJlZCBjYWxsIEBSYXBoYWVsLmdldENvbG9yLnJlc2V0XG4gICAgID4gUGFyYW1ldGVyc1xuICAgICAtIHZhbHVlIChudW1iZXIpICNvcHRpb25hbCBicmlnaHRuZXNzLCBkZWZhdWx0IGlzIGAwLjc1YFxuICAgICA9IChzdHJpbmcpIGhleCByZXByZXNlbnRhdGlvbiBvZiB0aGUgY29sb3VyLlxuICAgIFxcKi9cbiAgICBSLmdldENvbG9yID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBzdGFydCA9IHRoaXMuZ2V0Q29sb3Iuc3RhcnQgPSB0aGlzLmdldENvbG9yLnN0YXJ0IHx8IHtoOiAwLCBzOiAxLCBiOiB2YWx1ZSB8fCAuNzV9LFxuICAgICAgICAgICAgcmdiID0gdGhpcy5oc2IycmdiKHN0YXJ0LmgsIHN0YXJ0LnMsIHN0YXJ0LmIpO1xuICAgICAgICBzdGFydC5oICs9IC4wNzU7XG4gICAgICAgIGlmIChzdGFydC5oID4gMSkge1xuICAgICAgICAgICAgc3RhcnQuaCA9IDA7XG4gICAgICAgICAgICBzdGFydC5zIC09IC4yO1xuICAgICAgICAgICAgc3RhcnQucyA8PSAwICYmICh0aGlzLmdldENvbG9yLnN0YXJ0ID0ge2g6IDAsIHM6IDEsIGI6IHN0YXJ0LmJ9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmdiLmhleDtcbiAgICB9O1xuICAgIC8qXFxcbiAgICAgKiBSYXBoYWVsLmdldENvbG9yLnJlc2V0XG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBSZXNldHMgc3BlY3RydW0gcG9zaXRpb24gZm9yIEBSYXBoYWVsLmdldENvbG9yIGJhY2sgdG8gcmVkLlxuICAgIFxcKi9cbiAgICBSLmdldENvbG9yLnJlc2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBkZWxldGUgdGhpcy5zdGFydDtcbiAgICB9O1xuXG4gICAgLy8gaHR0cDovL3NjaGVwZXJzLmNjL2dldHRpbmctdG8tdGhlLXBvaW50XG4gICAgZnVuY3Rpb24gY2F0bXVsbFJvbTJiZXppZXIoY3JwLCB6KSB7XG4gICAgICAgIHZhciBkID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBpTGVuID0gY3JwLmxlbmd0aDsgaUxlbiAtIDIgKiAheiA+IGk7IGkgKz0gMikge1xuICAgICAgICAgICAgdmFyIHAgPSBbXG4gICAgICAgICAgICAgICAgICAgICAgICB7eDogK2NycFtpIC0gMl0sIHk6ICtjcnBbaSAtIDFdfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHt4OiArY3JwW2ldLCAgICAgeTogK2NycFtpICsgMV19LFxuICAgICAgICAgICAgICAgICAgICAgICAge3g6ICtjcnBbaSArIDJdLCB5OiArY3JwW2kgKyAzXX0sXG4gICAgICAgICAgICAgICAgICAgICAgICB7eDogK2NycFtpICsgNF0sIHk6ICtjcnBbaSArIDVdfVxuICAgICAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgaWYgKHopIHtcbiAgICAgICAgICAgICAgICBpZiAoIWkpIHtcbiAgICAgICAgICAgICAgICAgICAgcFswXSA9IHt4OiArY3JwW2lMZW4gLSAyXSwgeTogK2NycFtpTGVuIC0gMV19O1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaUxlbiAtIDQgPT0gaSkge1xuICAgICAgICAgICAgICAgICAgICBwWzNdID0ge3g6ICtjcnBbMF0sIHk6ICtjcnBbMV19O1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaUxlbiAtIDIgPT0gaSkge1xuICAgICAgICAgICAgICAgICAgICBwWzJdID0ge3g6ICtjcnBbMF0sIHk6ICtjcnBbMV19O1xuICAgICAgICAgICAgICAgICAgICBwWzNdID0ge3g6ICtjcnBbMl0sIHk6ICtjcnBbM119O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGlMZW4gLSA0ID09IGkpIHtcbiAgICAgICAgICAgICAgICAgICAgcFszXSA9IHBbMl07XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICghaSkge1xuICAgICAgICAgICAgICAgICAgICBwWzBdID0ge3g6ICtjcnBbaV0sIHk6ICtjcnBbaSArIDFdfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkLnB1c2goW1wiQ1wiLFxuICAgICAgICAgICAgICAgICAgKC1wWzBdLnggKyA2ICogcFsxXS54ICsgcFsyXS54KSAvIDYsXG4gICAgICAgICAgICAgICAgICAoLXBbMF0ueSArIDYgKiBwWzFdLnkgKyBwWzJdLnkpIC8gNixcbiAgICAgICAgICAgICAgICAgIChwWzFdLnggKyA2ICogcFsyXS54IC0gcFszXS54KSAvIDYsXG4gICAgICAgICAgICAgICAgICAocFsxXS55ICsgNipwWzJdLnkgLSBwWzNdLnkpIC8gNixcbiAgICAgICAgICAgICAgICAgIHBbMl0ueCxcbiAgICAgICAgICAgICAgICAgIHBbMl0ueVxuICAgICAgICAgICAgXSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZDtcbiAgICB9XG4gICAgLypcXFxuICAgICAqIFJhcGhhZWwucGFyc2VQYXRoU3RyaW5nXG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBVdGlsaXR5IG1ldGhvZFxuICAgICAqKlxuICAgICAqIFBhcnNlcyBnaXZlbiBwYXRoIHN0cmluZyBpbnRvIGFuIGFycmF5IG9mIGFycmF5cyBvZiBwYXRoIHNlZ21lbnRzLlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgLSBwYXRoU3RyaW5nIChzdHJpbmd8YXJyYXkpIHBhdGggc3RyaW5nIG9yIGFycmF5IG9mIHNlZ21lbnRzIChpbiB0aGUgbGFzdCBjYXNlIGl0IHdpbGwgYmUgcmV0dXJuZWQgc3RyYWlnaHQgYXdheSlcbiAgICAgPSAoYXJyYXkpIGFycmF5IG9mIHNlZ21lbnRzLlxuICAgIFxcKi9cbiAgICBSLnBhcnNlUGF0aFN0cmluZyA9IGZ1bmN0aW9uIChwYXRoU3RyaW5nKSB7XG4gICAgICAgIGlmICghcGF0aFN0cmluZykge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHB0aCA9IHBhdGhzKHBhdGhTdHJpbmcpO1xuICAgICAgICBpZiAocHRoLmFycikge1xuICAgICAgICAgICAgcmV0dXJuIHBhdGhDbG9uZShwdGguYXJyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBwYXJhbUNvdW50cyA9IHthOiA3LCBjOiA2LCBoOiAxLCBsOiAyLCBtOiAyLCByOiA0LCBxOiA0LCBzOiA0LCB0OiAyLCB2OiAxLCB6OiAwfSxcbiAgICAgICAgICAgIGRhdGEgPSBbXTtcbiAgICAgICAgaWYgKFIuaXMocGF0aFN0cmluZywgYXJyYXkpICYmIFIuaXMocGF0aFN0cmluZ1swXSwgYXJyYXkpKSB7IC8vIHJvdWdoIGFzc3VtcHRpb25cbiAgICAgICAgICAgIGRhdGEgPSBwYXRoQ2xvbmUocGF0aFN0cmluZyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFkYXRhLmxlbmd0aCkge1xuICAgICAgICAgICAgU3RyKHBhdGhTdHJpbmcpLnJlcGxhY2UocGF0aENvbW1hbmQsIGZ1bmN0aW9uIChhLCBiLCBjKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmFtcyA9IFtdLFxuICAgICAgICAgICAgICAgICAgICBuYW1lID0gYi50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgICAgIGMucmVwbGFjZShwYXRoVmFsdWVzLCBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICAgICAgICAgICAgICBiICYmIHBhcmFtcy5wdXNoKCtiKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAobmFtZSA9PSBcIm1cIiAmJiBwYXJhbXMubGVuZ3RoID4gMikge1xuICAgICAgICAgICAgICAgICAgICBkYXRhLnB1c2goW2JdW2NvbmNhdF0ocGFyYW1zLnNwbGljZSgwLCAyKSkpO1xuICAgICAgICAgICAgICAgICAgICBuYW1lID0gXCJsXCI7XG4gICAgICAgICAgICAgICAgICAgIGIgPSBiID09IFwibVwiID8gXCJsXCIgOiBcIkxcIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG5hbWUgPT0gXCJyXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5wdXNoKFtiXVtjb25jYXRdKHBhcmFtcykpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB3aGlsZSAocGFyYW1zLmxlbmd0aCA+PSBwYXJhbUNvdW50c1tuYW1lXSkge1xuICAgICAgICAgICAgICAgICAgICBkYXRhLnB1c2goW2JdW2NvbmNhdF0ocGFyYW1zLnNwbGljZSgwLCBwYXJhbUNvdW50c1tuYW1lXSkpKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFwYXJhbUNvdW50c1tuYW1lXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBkYXRhLnRvU3RyaW5nID0gUi5fcGF0aDJzdHJpbmc7XG4gICAgICAgIHB0aC5hcnIgPSBwYXRoQ2xvbmUoZGF0YSk7XG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIFJhcGhhZWwucGFyc2VUcmFuc2Zvcm1TdHJpbmdcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIFV0aWxpdHkgbWV0aG9kXG4gICAgICoqXG4gICAgICogUGFyc2VzIGdpdmVuIHBhdGggc3RyaW5nIGludG8gYW4gYXJyYXkgb2YgdHJhbnNmb3JtYXRpb25zLlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgLSBUU3RyaW5nIChzdHJpbmd8YXJyYXkpIHRyYW5zZm9ybSBzdHJpbmcgb3IgYXJyYXkgb2YgdHJhbnNmb3JtYXRpb25zIChpbiB0aGUgbGFzdCBjYXNlIGl0IHdpbGwgYmUgcmV0dXJuZWQgc3RyYWlnaHQgYXdheSlcbiAgICAgPSAoYXJyYXkpIGFycmF5IG9mIHRyYW5zZm9ybWF0aW9ucy5cbiAgICBcXCovXG4gICAgUi5wYXJzZVRyYW5zZm9ybVN0cmluZyA9IGNhY2hlcihmdW5jdGlvbiAoVFN0cmluZykge1xuICAgICAgICBpZiAoIVRTdHJpbmcpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHZhciBwYXJhbUNvdW50cyA9IHtyOiAzLCBzOiA0LCB0OiAyLCBtOiA2fSxcbiAgICAgICAgICAgIGRhdGEgPSBbXTtcbiAgICAgICAgaWYgKFIuaXMoVFN0cmluZywgYXJyYXkpICYmIFIuaXMoVFN0cmluZ1swXSwgYXJyYXkpKSB7IC8vIHJvdWdoIGFzc3VtcHRpb25cbiAgICAgICAgICAgIGRhdGEgPSBwYXRoQ2xvbmUoVFN0cmluZyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFkYXRhLmxlbmd0aCkge1xuICAgICAgICAgICAgU3RyKFRTdHJpbmcpLnJlcGxhY2UodENvbW1hbmQsIGZ1bmN0aW9uIChhLCBiLCBjKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmFtcyA9IFtdLFxuICAgICAgICAgICAgICAgICAgICBuYW1lID0gbG93ZXJDYXNlLmNhbGwoYik7XG4gICAgICAgICAgICAgICAgYy5yZXBsYWNlKHBhdGhWYWx1ZXMsIGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICAgICAgICAgIGIgJiYgcGFyYW1zLnB1c2goK2IpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGRhdGEucHVzaChbYl1bY29uY2F0XShwYXJhbXMpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGRhdGEudG9TdHJpbmcgPSBSLl9wYXRoMnN0cmluZztcbiAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfSwgdGhpcywgZnVuY3Rpb24oZWxlbSkge1xuICAgICAgICBpZiAoIWVsZW0pIHJldHVybiBlbGVtO1xuICAgICAgICB2YXIgbmV3RGF0YSA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVsZW0ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBuZXdMZXZlbCA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBlbGVtW2ldLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgbmV3TGV2ZWwucHVzaChlbGVtW2ldW2pdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5ld0RhdGEucHVzaChuZXdMZXZlbCk7XG4gICAgICAgIH1cbiAgICAgIHJldHVybiBuZXdEYXRhOyB9ICk7XG4gICAgLy8gUEFUSFNcbiAgICB2YXIgcGF0aHMgPSBmdW5jdGlvbiAocHMpIHtcbiAgICAgICAgdmFyIHAgPSBwYXRocy5wcyA9IHBhdGhzLnBzIHx8IHt9O1xuICAgICAgICBpZiAocFtwc10pIHtcbiAgICAgICAgICAgIHBbcHNdLnNsZWVwID0gMTAwO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcFtwc10gPSB7XG4gICAgICAgICAgICAgICAgc2xlZXA6IDEwMFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBwKSBpZiAocFtoYXNdKGtleSkgJiYga2V5ICE9IHBzKSB7XG4gICAgICAgICAgICAgICAgcFtrZXldLnNsZWVwLS07XG4gICAgICAgICAgICAgICAgIXBba2V5XS5zbGVlcCAmJiBkZWxldGUgcFtrZXldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHBbcHNdO1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIFJhcGhhZWwuZmluZERvdHNBdFNlZ21lbnRcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIFV0aWxpdHkgbWV0aG9kXG4gICAgICoqXG4gICAgICogRmluZCBkb3QgY29vcmRpbmF0ZXMgb24gdGhlIGdpdmVuIGN1YmljIGJlemllciBjdXJ2ZSBhdCB0aGUgZ2l2ZW4gdC5cbiAgICAgPiBQYXJhbWV0ZXJzXG4gICAgIC0gcDF4IChudW1iZXIpIHggb2YgdGhlIGZpcnN0IHBvaW50IG9mIHRoZSBjdXJ2ZVxuICAgICAtIHAxeSAobnVtYmVyKSB5IG9mIHRoZSBmaXJzdCBwb2ludCBvZiB0aGUgY3VydmVcbiAgICAgLSBjMXggKG51bWJlcikgeCBvZiB0aGUgZmlyc3QgYW5jaG9yIG9mIHRoZSBjdXJ2ZVxuICAgICAtIGMxeSAobnVtYmVyKSB5IG9mIHRoZSBmaXJzdCBhbmNob3Igb2YgdGhlIGN1cnZlXG4gICAgIC0gYzJ4IChudW1iZXIpIHggb2YgdGhlIHNlY29uZCBhbmNob3Igb2YgdGhlIGN1cnZlXG4gICAgIC0gYzJ5IChudW1iZXIpIHkgb2YgdGhlIHNlY29uZCBhbmNob3Igb2YgdGhlIGN1cnZlXG4gICAgIC0gcDJ4IChudW1iZXIpIHggb2YgdGhlIHNlY29uZCBwb2ludCBvZiB0aGUgY3VydmVcbiAgICAgLSBwMnkgKG51bWJlcikgeSBvZiB0aGUgc2Vjb25kIHBvaW50IG9mIHRoZSBjdXJ2ZVxuICAgICAtIHQgKG51bWJlcikgcG9zaXRpb24gb24gdGhlIGN1cnZlICgwLi4xKVxuICAgICA9IChvYmplY3QpIHBvaW50IGluZm9ybWF0aW9uIGluIGZvcm1hdDpcbiAgICAgbyB7XG4gICAgIG8gICAgIHg6IChudW1iZXIpIHggY29vcmRpbmF0ZSBvZiB0aGUgcG9pbnRcbiAgICAgbyAgICAgeTogKG51bWJlcikgeSBjb29yZGluYXRlIG9mIHRoZSBwb2ludFxuICAgICBvICAgICBtOiB7XG4gICAgIG8gICAgICAgICB4OiAobnVtYmVyKSB4IGNvb3JkaW5hdGUgb2YgdGhlIGxlZnQgYW5jaG9yXG4gICAgIG8gICAgICAgICB5OiAobnVtYmVyKSB5IGNvb3JkaW5hdGUgb2YgdGhlIGxlZnQgYW5jaG9yXG4gICAgIG8gICAgIH1cbiAgICAgbyAgICAgbjoge1xuICAgICBvICAgICAgICAgeDogKG51bWJlcikgeCBjb29yZGluYXRlIG9mIHRoZSByaWdodCBhbmNob3JcbiAgICAgbyAgICAgICAgIHk6IChudW1iZXIpIHkgY29vcmRpbmF0ZSBvZiB0aGUgcmlnaHQgYW5jaG9yXG4gICAgIG8gICAgIH1cbiAgICAgbyAgICAgc3RhcnQ6IHtcbiAgICAgbyAgICAgICAgIHg6IChudW1iZXIpIHggY29vcmRpbmF0ZSBvZiB0aGUgc3RhcnQgb2YgdGhlIGN1cnZlXG4gICAgIG8gICAgICAgICB5OiAobnVtYmVyKSB5IGNvb3JkaW5hdGUgb2YgdGhlIHN0YXJ0IG9mIHRoZSBjdXJ2ZVxuICAgICBvICAgICB9XG4gICAgIG8gICAgIGVuZDoge1xuICAgICBvICAgICAgICAgeDogKG51bWJlcikgeCBjb29yZGluYXRlIG9mIHRoZSBlbmQgb2YgdGhlIGN1cnZlXG4gICAgIG8gICAgICAgICB5OiAobnVtYmVyKSB5IGNvb3JkaW5hdGUgb2YgdGhlIGVuZCBvZiB0aGUgY3VydmVcbiAgICAgbyAgICAgfVxuICAgICBvICAgICBhbHBoYTogKG51bWJlcikgYW5nbGUgb2YgdGhlIGN1cnZlIGRlcml2YXRpdmUgYXQgdGhlIHBvaW50XG4gICAgIG8gfVxuICAgIFxcKi9cbiAgICBSLmZpbmREb3RzQXRTZWdtZW50ID0gZnVuY3Rpb24gKHAxeCwgcDF5LCBjMXgsIGMxeSwgYzJ4LCBjMnksIHAyeCwgcDJ5LCB0KSB7XG4gICAgICAgIHZhciB0MSA9IDEgLSB0LFxuICAgICAgICAgICAgdDEzID0gcG93KHQxLCAzKSxcbiAgICAgICAgICAgIHQxMiA9IHBvdyh0MSwgMiksXG4gICAgICAgICAgICB0MiA9IHQgKiB0LFxuICAgICAgICAgICAgdDMgPSB0MiAqIHQsXG4gICAgICAgICAgICB4ID0gdDEzICogcDF4ICsgdDEyICogMyAqIHQgKiBjMXggKyB0MSAqIDMgKiB0ICogdCAqIGMyeCArIHQzICogcDJ4LFxuICAgICAgICAgICAgeSA9IHQxMyAqIHAxeSArIHQxMiAqIDMgKiB0ICogYzF5ICsgdDEgKiAzICogdCAqIHQgKiBjMnkgKyB0MyAqIHAyeSxcbiAgICAgICAgICAgIG14ID0gcDF4ICsgMiAqIHQgKiAoYzF4IC0gcDF4KSArIHQyICogKGMyeCAtIDIgKiBjMXggKyBwMXgpLFxuICAgICAgICAgICAgbXkgPSBwMXkgKyAyICogdCAqIChjMXkgLSBwMXkpICsgdDIgKiAoYzJ5IC0gMiAqIGMxeSArIHAxeSksXG4gICAgICAgICAgICBueCA9IGMxeCArIDIgKiB0ICogKGMyeCAtIGMxeCkgKyB0MiAqIChwMnggLSAyICogYzJ4ICsgYzF4KSxcbiAgICAgICAgICAgIG55ID0gYzF5ICsgMiAqIHQgKiAoYzJ5IC0gYzF5KSArIHQyICogKHAyeSAtIDIgKiBjMnkgKyBjMXkpLFxuICAgICAgICAgICAgYXggPSB0MSAqIHAxeCArIHQgKiBjMXgsXG4gICAgICAgICAgICBheSA9IHQxICogcDF5ICsgdCAqIGMxeSxcbiAgICAgICAgICAgIGN4ID0gdDEgKiBjMnggKyB0ICogcDJ4LFxuICAgICAgICAgICAgY3kgPSB0MSAqIGMyeSArIHQgKiBwMnksXG4gICAgICAgICAgICBhbHBoYSA9ICg5MCAtIG1hdGguYXRhbjIobXggLSBueCwgbXkgLSBueSkgKiAxODAgLyBQSSk7XG4gICAgICAgIChteCA+IG54IHx8IG15IDwgbnkpICYmIChhbHBoYSArPSAxODApO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgeDogeCxcbiAgICAgICAgICAgIHk6IHksXG4gICAgICAgICAgICBtOiB7eDogbXgsIHk6IG15fSxcbiAgICAgICAgICAgIG46IHt4OiBueCwgeTogbnl9LFxuICAgICAgICAgICAgc3RhcnQ6IHt4OiBheCwgeTogYXl9LFxuICAgICAgICAgICAgZW5kOiB7eDogY3gsIHk6IGN5fSxcbiAgICAgICAgICAgIGFscGhhOiBhbHBoYVxuICAgICAgICB9O1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIFJhcGhhZWwuYmV6aWVyQkJveFxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogVXRpbGl0eSBtZXRob2RcbiAgICAgKipcbiAgICAgKiBSZXR1cm4gYm91bmRpbmcgYm94IG9mIGEgZ2l2ZW4gY3ViaWMgYmV6aWVyIGN1cnZlXG4gICAgID4gUGFyYW1ldGVyc1xuICAgICAtIHAxeCAobnVtYmVyKSB4IG9mIHRoZSBmaXJzdCBwb2ludCBvZiB0aGUgY3VydmVcbiAgICAgLSBwMXkgKG51bWJlcikgeSBvZiB0aGUgZmlyc3QgcG9pbnQgb2YgdGhlIGN1cnZlXG4gICAgIC0gYzF4IChudW1iZXIpIHggb2YgdGhlIGZpcnN0IGFuY2hvciBvZiB0aGUgY3VydmVcbiAgICAgLSBjMXkgKG51bWJlcikgeSBvZiB0aGUgZmlyc3QgYW5jaG9yIG9mIHRoZSBjdXJ2ZVxuICAgICAtIGMyeCAobnVtYmVyKSB4IG9mIHRoZSBzZWNvbmQgYW5jaG9yIG9mIHRoZSBjdXJ2ZVxuICAgICAtIGMyeSAobnVtYmVyKSB5IG9mIHRoZSBzZWNvbmQgYW5jaG9yIG9mIHRoZSBjdXJ2ZVxuICAgICAtIHAyeCAobnVtYmVyKSB4IG9mIHRoZSBzZWNvbmQgcG9pbnQgb2YgdGhlIGN1cnZlXG4gICAgIC0gcDJ5IChudW1iZXIpIHkgb2YgdGhlIHNlY29uZCBwb2ludCBvZiB0aGUgY3VydmVcbiAgICAgKiBvclxuICAgICAtIGJleiAoYXJyYXkpIGFycmF5IG9mIHNpeCBwb2ludHMgZm9yIGJlemllciBjdXJ2ZVxuICAgICA9IChvYmplY3QpIHBvaW50IGluZm9ybWF0aW9uIGluIGZvcm1hdDpcbiAgICAgbyB7XG4gICAgIG8gICAgIG1pbjoge1xuICAgICBvICAgICAgICAgeDogKG51bWJlcikgeCBjb29yZGluYXRlIG9mIHRoZSBsZWZ0IHBvaW50XG4gICAgIG8gICAgICAgICB5OiAobnVtYmVyKSB5IGNvb3JkaW5hdGUgb2YgdGhlIHRvcCBwb2ludFxuICAgICBvICAgICB9XG4gICAgIG8gICAgIG1heDoge1xuICAgICBvICAgICAgICAgeDogKG51bWJlcikgeCBjb29yZGluYXRlIG9mIHRoZSByaWdodCBwb2ludFxuICAgICBvICAgICAgICAgeTogKG51bWJlcikgeSBjb29yZGluYXRlIG9mIHRoZSBib3R0b20gcG9pbnRcbiAgICAgbyAgICAgfVxuICAgICBvIH1cbiAgICBcXCovXG4gICAgUi5iZXppZXJCQm94ID0gZnVuY3Rpb24gKHAxeCwgcDF5LCBjMXgsIGMxeSwgYzJ4LCBjMnksIHAyeCwgcDJ5KSB7XG4gICAgICAgIGlmICghUi5pcyhwMXgsIFwiYXJyYXlcIikpIHtcbiAgICAgICAgICAgIHAxeCA9IFtwMXgsIHAxeSwgYzF4LCBjMXksIGMyeCwgYzJ5LCBwMngsIHAyeV07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGJib3ggPSBjdXJ2ZURpbS5hcHBseShudWxsLCBwMXgpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgeDogYmJveC5taW4ueCxcbiAgICAgICAgICAgIHk6IGJib3gubWluLnksXG4gICAgICAgICAgICB4MjogYmJveC5tYXgueCxcbiAgICAgICAgICAgIHkyOiBiYm94Lm1heC55LFxuICAgICAgICAgICAgd2lkdGg6IGJib3gubWF4LnggLSBiYm94Lm1pbi54LFxuICAgICAgICAgICAgaGVpZ2h0OiBiYm94Lm1heC55IC0gYmJveC5taW4ueVxuICAgICAgICB9O1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIFJhcGhhZWwuaXNQb2ludEluc2lkZUJCb3hcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIFV0aWxpdHkgbWV0aG9kXG4gICAgICoqXG4gICAgICogUmV0dXJucyBgdHJ1ZWAgaWYgZ2l2ZW4gcG9pbnQgaXMgaW5zaWRlIGJvdW5kaW5nIGJveGVzLlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgLSBiYm94IChzdHJpbmcpIGJvdW5kaW5nIGJveFxuICAgICAtIHggKHN0cmluZykgeCBjb29yZGluYXRlIG9mIHRoZSBwb2ludFxuICAgICAtIHkgKHN0cmluZykgeSBjb29yZGluYXRlIG9mIHRoZSBwb2ludFxuICAgICA9IChib29sZWFuKSBgdHJ1ZWAgaWYgcG9pbnQgaW5zaWRlXG4gICAgXFwqL1xuICAgIFIuaXNQb2ludEluc2lkZUJCb3ggPSBmdW5jdGlvbiAoYmJveCwgeCwgeSkge1xuICAgICAgICByZXR1cm4geCA+PSBiYm94LnggJiYgeCA8PSBiYm94LngyICYmIHkgPj0gYmJveC55ICYmIHkgPD0gYmJveC55MjtcbiAgICB9O1xuICAgIC8qXFxcbiAgICAgKiBSYXBoYWVsLmlzQkJveEludGVyc2VjdFxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogVXRpbGl0eSBtZXRob2RcbiAgICAgKipcbiAgICAgKiBSZXR1cm5zIGB0cnVlYCBpZiB0d28gYm91bmRpbmcgYm94ZXMgaW50ZXJzZWN0XG4gICAgID4gUGFyYW1ldGVyc1xuICAgICAtIGJib3gxIChzdHJpbmcpIGZpcnN0IGJvdW5kaW5nIGJveFxuICAgICAtIGJib3gyIChzdHJpbmcpIHNlY29uZCBib3VuZGluZyBib3hcbiAgICAgPSAoYm9vbGVhbikgYHRydWVgIGlmIHRoZXkgaW50ZXJzZWN0XG4gICAgXFwqL1xuICAgIFIuaXNCQm94SW50ZXJzZWN0ID0gZnVuY3Rpb24gKGJib3gxLCBiYm94Mikge1xuICAgICAgICB2YXIgaSA9IFIuaXNQb2ludEluc2lkZUJCb3g7XG4gICAgICAgIHJldHVybiBpKGJib3gyLCBiYm94MS54LCBiYm94MS55KVxuICAgICAgICAgICAgfHwgaShiYm94MiwgYmJveDEueDIsIGJib3gxLnkpXG4gICAgICAgICAgICB8fCBpKGJib3gyLCBiYm94MS54LCBiYm94MS55MilcbiAgICAgICAgICAgIHx8IGkoYmJveDIsIGJib3gxLngyLCBiYm94MS55MilcbiAgICAgICAgICAgIHx8IGkoYmJveDEsIGJib3gyLngsIGJib3gyLnkpXG4gICAgICAgICAgICB8fCBpKGJib3gxLCBiYm94Mi54MiwgYmJveDIueSlcbiAgICAgICAgICAgIHx8IGkoYmJveDEsIGJib3gyLngsIGJib3gyLnkyKVxuICAgICAgICAgICAgfHwgaShiYm94MSwgYmJveDIueDIsIGJib3gyLnkyKVxuICAgICAgICAgICAgfHwgKGJib3gxLnggPCBiYm94Mi54MiAmJiBiYm94MS54ID4gYmJveDIueCB8fCBiYm94Mi54IDwgYmJveDEueDIgJiYgYmJveDIueCA+IGJib3gxLngpXG4gICAgICAgICAgICAmJiAoYmJveDEueSA8IGJib3gyLnkyICYmIGJib3gxLnkgPiBiYm94Mi55IHx8IGJib3gyLnkgPCBiYm94MS55MiAmJiBiYm94Mi55ID4gYmJveDEueSk7XG4gICAgfTtcbiAgICBmdW5jdGlvbiBiYXNlMyh0LCBwMSwgcDIsIHAzLCBwNCkge1xuICAgICAgICB2YXIgdDEgPSAtMyAqIHAxICsgOSAqIHAyIC0gOSAqIHAzICsgMyAqIHA0LFxuICAgICAgICAgICAgdDIgPSB0ICogdDEgKyA2ICogcDEgLSAxMiAqIHAyICsgNiAqIHAzO1xuICAgICAgICByZXR1cm4gdCAqIHQyIC0gMyAqIHAxICsgMyAqIHAyO1xuICAgIH1cbiAgICBmdW5jdGlvbiBiZXpsZW4oeDEsIHkxLCB4MiwgeTIsIHgzLCB5MywgeDQsIHk0LCB6KSB7XG4gICAgICAgIGlmICh6ID09IG51bGwpIHtcbiAgICAgICAgICAgIHogPSAxO1xuICAgICAgICB9XG4gICAgICAgIHogPSB6ID4gMSA/IDEgOiB6IDwgMCA/IDAgOiB6O1xuICAgICAgICB2YXIgejIgPSB6IC8gMixcbiAgICAgICAgICAgIG4gPSAxMixcbiAgICAgICAgICAgIFR2YWx1ZXMgPSBbLTAuMTI1MiwwLjEyNTIsLTAuMzY3OCwwLjM2NzgsLTAuNTg3MywwLjU4NzMsLTAuNzY5OSwwLjc2OTksLTAuOTA0MSwwLjkwNDEsLTAuOTgxNiwwLjk4MTZdLFxuICAgICAgICAgICAgQ3ZhbHVlcyA9IFswLjI0OTEsMC4yNDkxLDAuMjMzNSwwLjIzMzUsMC4yMDMyLDAuMjAzMiwwLjE2MDEsMC4xNjAxLDAuMTA2OSwwLjEwNjksMC4wNDcyLDAuMDQ3Ml0sXG4gICAgICAgICAgICBzdW0gPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG47IGkrKykge1xuICAgICAgICAgICAgdmFyIGN0ID0gejIgKiBUdmFsdWVzW2ldICsgejIsXG4gICAgICAgICAgICAgICAgeGJhc2UgPSBiYXNlMyhjdCwgeDEsIHgyLCB4MywgeDQpLFxuICAgICAgICAgICAgICAgIHliYXNlID0gYmFzZTMoY3QsIHkxLCB5MiwgeTMsIHk0KSxcbiAgICAgICAgICAgICAgICBjb21iID0geGJhc2UgKiB4YmFzZSArIHliYXNlICogeWJhc2U7XG4gICAgICAgICAgICBzdW0gKz0gQ3ZhbHVlc1tpXSAqIG1hdGguc3FydChjb21iKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gejIgKiBzdW07XG4gICAgfVxuICAgIGZ1bmN0aW9uIGdldFRhdExlbih4MSwgeTEsIHgyLCB5MiwgeDMsIHkzLCB4NCwgeTQsIGxsKSB7XG4gICAgICAgIGlmIChsbCA8IDAgfHwgYmV6bGVuKHgxLCB5MSwgeDIsIHkyLCB4MywgeTMsIHg0LCB5NCkgPCBsbCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciB0ID0gMSxcbiAgICAgICAgICAgIHN0ZXAgPSB0IC8gMixcbiAgICAgICAgICAgIHQyID0gdCAtIHN0ZXAsXG4gICAgICAgICAgICBsLFxuICAgICAgICAgICAgZSA9IC4wMTtcbiAgICAgICAgbCA9IGJlemxlbih4MSwgeTEsIHgyLCB5MiwgeDMsIHkzLCB4NCwgeTQsIHQyKTtcbiAgICAgICAgd2hpbGUgKGFicyhsIC0gbGwpID4gZSkge1xuICAgICAgICAgICAgc3RlcCAvPSAyO1xuICAgICAgICAgICAgdDIgKz0gKGwgPCBsbCA/IDEgOiAtMSkgKiBzdGVwO1xuICAgICAgICAgICAgbCA9IGJlemxlbih4MSwgeTEsIHgyLCB5MiwgeDMsIHkzLCB4NCwgeTQsIHQyKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdDI7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGludGVyc2VjdCh4MSwgeTEsIHgyLCB5MiwgeDMsIHkzLCB4NCwgeTQpIHtcbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgbW1heCh4MSwgeDIpIDwgbW1pbih4MywgeDQpIHx8XG4gICAgICAgICAgICBtbWluKHgxLCB4MikgPiBtbWF4KHgzLCB4NCkgfHxcbiAgICAgICAgICAgIG1tYXgoeTEsIHkyKSA8IG1taW4oeTMsIHk0KSB8fFxuICAgICAgICAgICAgbW1pbih5MSwgeTIpID4gbW1heCh5MywgeTQpXG4gICAgICAgICkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBueCA9ICh4MSAqIHkyIC0geTEgKiB4MikgKiAoeDMgLSB4NCkgLSAoeDEgLSB4MikgKiAoeDMgKiB5NCAtIHkzICogeDQpLFxuICAgICAgICAgICAgbnkgPSAoeDEgKiB5MiAtIHkxICogeDIpICogKHkzIC0geTQpIC0gKHkxIC0geTIpICogKHgzICogeTQgLSB5MyAqIHg0KSxcbiAgICAgICAgICAgIGRlbm9taW5hdG9yID0gKHgxIC0geDIpICogKHkzIC0geTQpIC0gKHkxIC0geTIpICogKHgzIC0geDQpO1xuXG4gICAgICAgIGlmICghZGVub21pbmF0b3IpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcHggPSBueCAvIGRlbm9taW5hdG9yLFxuICAgICAgICAgICAgcHkgPSBueSAvIGRlbm9taW5hdG9yLFxuICAgICAgICAgICAgcHgyID0gK3B4LnRvRml4ZWQoMiksXG4gICAgICAgICAgICBweTIgPSArcHkudG9GaXhlZCgyKTtcbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgcHgyIDwgK21taW4oeDEsIHgyKS50b0ZpeGVkKDIpIHx8XG4gICAgICAgICAgICBweDIgPiArbW1heCh4MSwgeDIpLnRvRml4ZWQoMikgfHxcbiAgICAgICAgICAgIHB4MiA8ICttbWluKHgzLCB4NCkudG9GaXhlZCgyKSB8fFxuICAgICAgICAgICAgcHgyID4gK21tYXgoeDMsIHg0KS50b0ZpeGVkKDIpIHx8XG4gICAgICAgICAgICBweTIgPCArbW1pbih5MSwgeTIpLnRvRml4ZWQoMikgfHxcbiAgICAgICAgICAgIHB5MiA+ICttbWF4KHkxLCB5MikudG9GaXhlZCgyKSB8fFxuICAgICAgICAgICAgcHkyIDwgK21taW4oeTMsIHk0KS50b0ZpeGVkKDIpIHx8XG4gICAgICAgICAgICBweTIgPiArbW1heCh5MywgeTQpLnRvRml4ZWQoMilcbiAgICAgICAgKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHt4OiBweCwgeTogcHl9O1xuICAgIH1cbiAgICBmdW5jdGlvbiBpbnRlcihiZXoxLCBiZXoyKSB7XG4gICAgICAgIHJldHVybiBpbnRlckhlbHBlcihiZXoxLCBiZXoyKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gaW50ZXJDb3VudChiZXoxLCBiZXoyKSB7XG4gICAgICAgIHJldHVybiBpbnRlckhlbHBlcihiZXoxLCBiZXoyLCAxKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gaW50ZXJIZWxwZXIoYmV6MSwgYmV6MiwganVzdENvdW50KSB7XG4gICAgICAgIHZhciBiYm94MSA9IFIuYmV6aWVyQkJveChiZXoxKSxcbiAgICAgICAgICAgIGJib3gyID0gUi5iZXppZXJCQm94KGJlejIpO1xuICAgICAgICBpZiAoIVIuaXNCQm94SW50ZXJzZWN0KGJib3gxLCBiYm94MikpIHtcbiAgICAgICAgICAgIHJldHVybiBqdXN0Q291bnQgPyAwIDogW107XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGwxID0gYmV6bGVuLmFwcGx5KDAsIGJlejEpLFxuICAgICAgICAgICAgbDIgPSBiZXpsZW4uYXBwbHkoMCwgYmV6MiksXG4gICAgICAgICAgICBuMSA9IG1tYXgofn4obDEgLyA1KSwgMSksXG4gICAgICAgICAgICBuMiA9IG1tYXgofn4obDIgLyA1KSwgMSksXG4gICAgICAgICAgICBkb3RzMSA9IFtdLFxuICAgICAgICAgICAgZG90czIgPSBbXSxcbiAgICAgICAgICAgIHh5ID0ge30sXG4gICAgICAgICAgICByZXMgPSBqdXN0Q291bnQgPyAwIDogW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbjEgKyAxOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBwID0gUi5maW5kRG90c0F0U2VnbWVudC5hcHBseShSLCBiZXoxLmNvbmNhdChpIC8gbjEpKTtcbiAgICAgICAgICAgIGRvdHMxLnB1c2goe3g6IHAueCwgeTogcC55LCB0OiBpIC8gbjF9KTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbjIgKyAxOyBpKyspIHtcbiAgICAgICAgICAgIHAgPSBSLmZpbmREb3RzQXRTZWdtZW50LmFwcGx5KFIsIGJlejIuY29uY2F0KGkgLyBuMikpO1xuICAgICAgICAgICAgZG90czIucHVzaCh7eDogcC54LCB5OiBwLnksIHQ6IGkgLyBuMn0pO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBuMTsgaSsrKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG4yOyBqKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgZGkgPSBkb3RzMVtpXSxcbiAgICAgICAgICAgICAgICAgICAgZGkxID0gZG90czFbaSArIDFdLFxuICAgICAgICAgICAgICAgICAgICBkaiA9IGRvdHMyW2pdLFxuICAgICAgICAgICAgICAgICAgICBkajEgPSBkb3RzMltqICsgMV0sXG4gICAgICAgICAgICAgICAgICAgIGNpID0gYWJzKGRpMS54IC0gZGkueCkgPCAuMDAxID8gXCJ5XCIgOiBcInhcIixcbiAgICAgICAgICAgICAgICAgICAgY2ogPSBhYnMoZGoxLnggLSBkai54KSA8IC4wMDEgPyBcInlcIiA6IFwieFwiLFxuICAgICAgICAgICAgICAgICAgICBpcyA9IGludGVyc2VjdChkaS54LCBkaS55LCBkaTEueCwgZGkxLnksIGRqLngsIGRqLnksIGRqMS54LCBkajEueSk7XG4gICAgICAgICAgICAgICAgaWYgKGlzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh4eVtpcy54LnRvRml4ZWQoNCldID09IGlzLnkudG9GaXhlZCg0KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgeHlbaXMueC50b0ZpeGVkKDQpXSA9IGlzLnkudG9GaXhlZCg0KTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHQxID0gZGkudCArIGFicygoaXNbY2ldIC0gZGlbY2ldKSAvIChkaTFbY2ldIC0gZGlbY2ldKSkgKiAoZGkxLnQgLSBkaS50KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHQyID0gZGoudCArIGFicygoaXNbY2pdIC0gZGpbY2pdKSAvIChkajFbY2pdIC0gZGpbY2pdKSkgKiAoZGoxLnQgLSBkai50KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQxID49IDAgJiYgdDEgPD0gMS4wMDEgJiYgdDIgPj0gMCAmJiB0MiA8PSAxLjAwMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGp1c3RDb3VudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcysrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHg6IGlzLngsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHk6IGlzLnksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQxOiBtbWluKHQxLCAxKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdDI6IG1taW4odDIsIDEpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG4gICAgLypcXFxuICAgICAqIFJhcGhhZWwucGF0aEludGVyc2VjdGlvblxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogVXRpbGl0eSBtZXRob2RcbiAgICAgKipcbiAgICAgKiBGaW5kcyBpbnRlcnNlY3Rpb25zIG9mIHR3byBwYXRoc1xuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgLSBwYXRoMSAoc3RyaW5nKSBwYXRoIHN0cmluZ1xuICAgICAtIHBhdGgyIChzdHJpbmcpIHBhdGggc3RyaW5nXG4gICAgID0gKGFycmF5KSBkb3RzIG9mIGludGVyc2VjdGlvblxuICAgICBvIFtcbiAgICAgbyAgICAge1xuICAgICBvICAgICAgICAgeDogKG51bWJlcikgeCBjb29yZGluYXRlIG9mIHRoZSBwb2ludFxuICAgICBvICAgICAgICAgeTogKG51bWJlcikgeSBjb29yZGluYXRlIG9mIHRoZSBwb2ludFxuICAgICBvICAgICAgICAgdDE6IChudW1iZXIpIHQgdmFsdWUgZm9yIHNlZ21lbnQgb2YgcGF0aDFcbiAgICAgbyAgICAgICAgIHQyOiAobnVtYmVyKSB0IHZhbHVlIGZvciBzZWdtZW50IG9mIHBhdGgyXG4gICAgIG8gICAgICAgICBzZWdtZW50MTogKG51bWJlcikgb3JkZXIgbnVtYmVyIGZvciBzZWdtZW50IG9mIHBhdGgxXG4gICAgIG8gICAgICAgICBzZWdtZW50MjogKG51bWJlcikgb3JkZXIgbnVtYmVyIGZvciBzZWdtZW50IG9mIHBhdGgyXG4gICAgIG8gICAgICAgICBiZXoxOiAoYXJyYXkpIGVpZ2h0IGNvb3JkaW5hdGVzIHJlcHJlc2VudGluZyBiZXppw6lyIGN1cnZlIGZvciB0aGUgc2VnbWVudCBvZiBwYXRoMVxuICAgICBvICAgICAgICAgYmV6MjogKGFycmF5KSBlaWdodCBjb29yZGluYXRlcyByZXByZXNlbnRpbmcgYmV6acOpciBjdXJ2ZSBmb3IgdGhlIHNlZ21lbnQgb2YgcGF0aDJcbiAgICAgbyAgICAgfVxuICAgICBvIF1cbiAgICBcXCovXG4gICAgUi5wYXRoSW50ZXJzZWN0aW9uID0gZnVuY3Rpb24gKHBhdGgxLCBwYXRoMikge1xuICAgICAgICByZXR1cm4gaW50ZXJQYXRoSGVscGVyKHBhdGgxLCBwYXRoMik7XG4gICAgfTtcbiAgICBSLnBhdGhJbnRlcnNlY3Rpb25OdW1iZXIgPSBmdW5jdGlvbiAocGF0aDEsIHBhdGgyKSB7XG4gICAgICAgIHJldHVybiBpbnRlclBhdGhIZWxwZXIocGF0aDEsIHBhdGgyLCAxKTtcbiAgICB9O1xuICAgIGZ1bmN0aW9uIGludGVyUGF0aEhlbHBlcihwYXRoMSwgcGF0aDIsIGp1c3RDb3VudCkge1xuICAgICAgICBwYXRoMSA9IFIuX3BhdGgyY3VydmUocGF0aDEpO1xuICAgICAgICBwYXRoMiA9IFIuX3BhdGgyY3VydmUocGF0aDIpO1xuICAgICAgICB2YXIgeDEsIHkxLCB4MiwgeTIsIHgxbSwgeTFtLCB4Mm0sIHkybSwgYmV6MSwgYmV6MixcbiAgICAgICAgICAgIHJlcyA9IGp1c3RDb3VudCA/IDAgOiBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gcGF0aDEubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuICAgICAgICAgICAgdmFyIHBpID0gcGF0aDFbaV07XG4gICAgICAgICAgICBpZiAocGlbMF0gPT0gXCJNXCIpIHtcbiAgICAgICAgICAgICAgICB4MSA9IHgxbSA9IHBpWzFdO1xuICAgICAgICAgICAgICAgIHkxID0geTFtID0gcGlbMl07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChwaVswXSA9PSBcIkNcIikge1xuICAgICAgICAgICAgICAgICAgICBiZXoxID0gW3gxLCB5MV0uY29uY2F0KHBpLnNsaWNlKDEpKTtcbiAgICAgICAgICAgICAgICAgICAgeDEgPSBiZXoxWzZdO1xuICAgICAgICAgICAgICAgICAgICB5MSA9IGJlejFbN107XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYmV6MSA9IFt4MSwgeTEsIHgxLCB5MSwgeDFtLCB5MW0sIHgxbSwgeTFtXTtcbiAgICAgICAgICAgICAgICAgICAgeDEgPSB4MW07XG4gICAgICAgICAgICAgICAgICAgIHkxID0geTFtO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMCwgamogPSBwYXRoMi5sZW5ndGg7IGogPCBqajsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwaiA9IHBhdGgyW2pdO1xuICAgICAgICAgICAgICAgICAgICBpZiAocGpbMF0gPT0gXCJNXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHgyID0geDJtID0gcGpbMV07XG4gICAgICAgICAgICAgICAgICAgICAgICB5MiA9IHkybSA9IHBqWzJdO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBqWzBdID09IFwiQ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmV6MiA9IFt4MiwgeTJdLmNvbmNhdChwai5zbGljZSgxKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeDIgPSBiZXoyWzZdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHkyID0gYmV6Mls3XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmV6MiA9IFt4MiwgeTIsIHgyLCB5MiwgeDJtLCB5Mm0sIHgybSwgeTJtXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4MiA9IHgybTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5MiA9IHkybTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbnRyID0gaW50ZXJIZWxwZXIoYmV6MSwgYmV6MiwganVzdENvdW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChqdXN0Q291bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXMgKz0gaW50cjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgayA9IDAsIGtrID0gaW50ci5sZW5ndGg7IGsgPCBrazsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludHJba10uc2VnbWVudDEgPSBpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnRyW2tdLnNlZ21lbnQyID0gajtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50cltrXS5iZXoxID0gYmV6MTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50cltrXS5iZXoyID0gYmV6MjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gcmVzLmNvbmNhdChpbnRyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cbiAgICAvKlxcXG4gICAgICogUmFwaGFlbC5pc1BvaW50SW5zaWRlUGF0aFxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogVXRpbGl0eSBtZXRob2RcbiAgICAgKipcbiAgICAgKiBSZXR1cm5zIGB0cnVlYCBpZiBnaXZlbiBwb2ludCBpcyBpbnNpZGUgYSBnaXZlbiBjbG9zZWQgcGF0aC5cbiAgICAgPiBQYXJhbWV0ZXJzXG4gICAgIC0gcGF0aCAoc3RyaW5nKSBwYXRoIHN0cmluZ1xuICAgICAtIHggKG51bWJlcikgeCBvZiB0aGUgcG9pbnRcbiAgICAgLSB5IChudW1iZXIpIHkgb2YgdGhlIHBvaW50XG4gICAgID0gKGJvb2xlYW4pIHRydWUsIGlmIHBvaW50IGlzIGluc2lkZSB0aGUgcGF0aFxuICAgIFxcKi9cbiAgICBSLmlzUG9pbnRJbnNpZGVQYXRoID0gZnVuY3Rpb24gKHBhdGgsIHgsIHkpIHtcbiAgICAgICAgdmFyIGJib3ggPSBSLnBhdGhCQm94KHBhdGgpO1xuICAgICAgICByZXR1cm4gUi5pc1BvaW50SW5zaWRlQkJveChiYm94LCB4LCB5KSAmJlxuICAgICAgICAgICAgICAgaW50ZXJQYXRoSGVscGVyKHBhdGgsIFtbXCJNXCIsIHgsIHldLCBbXCJIXCIsIGJib3gueDIgKyAxMF1dLCAxKSAlIDIgPT0gMTtcbiAgICB9O1xuICAgIFIuX3JlbW92ZWRGYWN0b3J5ID0gZnVuY3Rpb24gKG1ldGhvZG5hbWUpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGV2ZShcInJhcGhhZWwubG9nXCIsIG51bGwsIFwiUmFwaGFcXHhlYmw6IHlvdSBhcmUgY2FsbGluZyB0byBtZXRob2QgXFx1MjAxY1wiICsgbWV0aG9kbmFtZSArIFwiXFx1MjAxZCBvZiByZW1vdmVkIG9iamVjdFwiLCBtZXRob2RuYW1lKTtcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIC8qXFxcbiAgICAgKiBSYXBoYWVsLnBhdGhCQm94XG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBVdGlsaXR5IG1ldGhvZFxuICAgICAqKlxuICAgICAqIFJldHVybiBib3VuZGluZyBib3ggb2YgYSBnaXZlbiBwYXRoXG4gICAgID4gUGFyYW1ldGVyc1xuICAgICAtIHBhdGggKHN0cmluZykgcGF0aCBzdHJpbmdcbiAgICAgPSAob2JqZWN0KSBib3VuZGluZyBib3hcbiAgICAgbyB7XG4gICAgIG8gICAgIHg6IChudW1iZXIpIHggY29vcmRpbmF0ZSBvZiB0aGUgbGVmdCB0b3AgcG9pbnQgb2YgdGhlIGJveFxuICAgICBvICAgICB5OiAobnVtYmVyKSB5IGNvb3JkaW5hdGUgb2YgdGhlIGxlZnQgdG9wIHBvaW50IG9mIHRoZSBib3hcbiAgICAgbyAgICAgeDI6IChudW1iZXIpIHggY29vcmRpbmF0ZSBvZiB0aGUgcmlnaHQgYm90dG9tIHBvaW50IG9mIHRoZSBib3hcbiAgICAgbyAgICAgeTI6IChudW1iZXIpIHkgY29vcmRpbmF0ZSBvZiB0aGUgcmlnaHQgYm90dG9tIHBvaW50IG9mIHRoZSBib3hcbiAgICAgbyAgICAgd2lkdGg6IChudW1iZXIpIHdpZHRoIG9mIHRoZSBib3hcbiAgICAgbyAgICAgaGVpZ2h0OiAobnVtYmVyKSBoZWlnaHQgb2YgdGhlIGJveFxuICAgICBvICAgICBjeDogKG51bWJlcikgeCBjb29yZGluYXRlIG9mIHRoZSBjZW50ZXIgb2YgdGhlIGJveFxuICAgICBvICAgICBjeTogKG51bWJlcikgeSBjb29yZGluYXRlIG9mIHRoZSBjZW50ZXIgb2YgdGhlIGJveFxuICAgICBvIH1cbiAgICBcXCovXG4gICAgdmFyIHBhdGhEaW1lbnNpb25zID0gUi5wYXRoQkJveCA9IGZ1bmN0aW9uIChwYXRoKSB7XG4gICAgICAgIHZhciBwdGggPSBwYXRocyhwYXRoKTtcbiAgICAgICAgaWYgKHB0aC5iYm94KSB7XG4gICAgICAgICAgICByZXR1cm4gY2xvbmUocHRoLmJib3gpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghcGF0aCkge1xuICAgICAgICAgICAgcmV0dXJuIHt4OiAwLCB5OiAwLCB3aWR0aDogMCwgaGVpZ2h0OiAwLCB4MjogMCwgeTI6IDB9O1xuICAgICAgICB9XG4gICAgICAgIHBhdGggPSBwYXRoMmN1cnZlKHBhdGgpO1xuICAgICAgICB2YXIgeCA9IDAsXG4gICAgICAgICAgICB5ID0gMCxcbiAgICAgICAgICAgIFggPSBbXSxcbiAgICAgICAgICAgIFkgPSBbXSxcbiAgICAgICAgICAgIHA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IHBhdGgubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuICAgICAgICAgICAgcCA9IHBhdGhbaV07XG4gICAgICAgICAgICBpZiAocFswXSA9PSBcIk1cIikge1xuICAgICAgICAgICAgICAgIHggPSBwWzFdO1xuICAgICAgICAgICAgICAgIHkgPSBwWzJdO1xuICAgICAgICAgICAgICAgIFgucHVzaCh4KTtcbiAgICAgICAgICAgICAgICBZLnB1c2goeSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBkaW0gPSBjdXJ2ZURpbSh4LCB5LCBwWzFdLCBwWzJdLCBwWzNdLCBwWzRdLCBwWzVdLCBwWzZdKTtcbiAgICAgICAgICAgICAgICBYID0gWFtjb25jYXRdKGRpbS5taW4ueCwgZGltLm1heC54KTtcbiAgICAgICAgICAgICAgICBZID0gWVtjb25jYXRdKGRpbS5taW4ueSwgZGltLm1heC55KTtcbiAgICAgICAgICAgICAgICB4ID0gcFs1XTtcbiAgICAgICAgICAgICAgICB5ID0gcFs2XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgeG1pbiA9IG1taW5bYXBwbHldKDAsIFgpLFxuICAgICAgICAgICAgeW1pbiA9IG1taW5bYXBwbHldKDAsIFkpLFxuICAgICAgICAgICAgeG1heCA9IG1tYXhbYXBwbHldKDAsIFgpLFxuICAgICAgICAgICAgeW1heCA9IG1tYXhbYXBwbHldKDAsIFkpLFxuICAgICAgICAgICAgd2lkdGggPSB4bWF4IC0geG1pbixcbiAgICAgICAgICAgIGhlaWdodCA9IHltYXggLSB5bWluLFxuICAgICAgICAgICAgICAgIGJiID0ge1xuICAgICAgICAgICAgICAgIHg6IHhtaW4sXG4gICAgICAgICAgICAgICAgeTogeW1pbixcbiAgICAgICAgICAgICAgICB4MjogeG1heCxcbiAgICAgICAgICAgICAgICB5MjogeW1heCxcbiAgICAgICAgICAgICAgICB3aWR0aDogd2lkdGgsXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiBoZWlnaHQsXG4gICAgICAgICAgICAgICAgY3g6IHhtaW4gKyB3aWR0aCAvIDIsXG4gICAgICAgICAgICAgICAgY3k6IHltaW4gKyBoZWlnaHQgLyAyXG4gICAgICAgICAgICB9O1xuICAgICAgICBwdGguYmJveCA9IGNsb25lKGJiKTtcbiAgICAgICAgcmV0dXJuIGJiO1xuICAgIH0sXG4gICAgICAgIHBhdGhDbG9uZSA9IGZ1bmN0aW9uIChwYXRoQXJyYXkpIHtcbiAgICAgICAgICAgIHZhciByZXMgPSBjbG9uZShwYXRoQXJyYXkpO1xuICAgICAgICAgICAgcmVzLnRvU3RyaW5nID0gUi5fcGF0aDJzdHJpbmc7XG4gICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICB9LFxuICAgICAgICBwYXRoVG9SZWxhdGl2ZSA9IFIuX3BhdGhUb1JlbGF0aXZlID0gZnVuY3Rpb24gKHBhdGhBcnJheSkge1xuICAgICAgICAgICAgdmFyIHB0aCA9IHBhdGhzKHBhdGhBcnJheSk7XG4gICAgICAgICAgICBpZiAocHRoLnJlbCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBwYXRoQ2xvbmUocHRoLnJlbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIVIuaXMocGF0aEFycmF5LCBhcnJheSkgfHwgIVIuaXMocGF0aEFycmF5ICYmIHBhdGhBcnJheVswXSwgYXJyYXkpKSB7IC8vIHJvdWdoIGFzc3VtcHRpb25cbiAgICAgICAgICAgICAgICBwYXRoQXJyYXkgPSBSLnBhcnNlUGF0aFN0cmluZyhwYXRoQXJyYXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHJlcyA9IFtdLFxuICAgICAgICAgICAgICAgIHggPSAwLFxuICAgICAgICAgICAgICAgIHkgPSAwLFxuICAgICAgICAgICAgICAgIG14ID0gMCxcbiAgICAgICAgICAgICAgICBteSA9IDAsXG4gICAgICAgICAgICAgICAgc3RhcnQgPSAwO1xuICAgICAgICAgICAgaWYgKHBhdGhBcnJheVswXVswXSA9PSBcIk1cIikge1xuICAgICAgICAgICAgICAgIHggPSBwYXRoQXJyYXlbMF1bMV07XG4gICAgICAgICAgICAgICAgeSA9IHBhdGhBcnJheVswXVsyXTtcbiAgICAgICAgICAgICAgICBteCA9IHg7XG4gICAgICAgICAgICAgICAgbXkgPSB5O1xuICAgICAgICAgICAgICAgIHN0YXJ0Kys7XG4gICAgICAgICAgICAgICAgcmVzLnB1c2goW1wiTVwiLCB4LCB5XSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gc3RhcnQsIGlpID0gcGF0aEFycmF5Lmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgciA9IHJlc1tpXSA9IFtdLFxuICAgICAgICAgICAgICAgICAgICBwYSA9IHBhdGhBcnJheVtpXTtcbiAgICAgICAgICAgICAgICBpZiAocGFbMF0gIT0gbG93ZXJDYXNlLmNhbGwocGFbMF0pKSB7XG4gICAgICAgICAgICAgICAgICAgIHJbMF0gPSBsb3dlckNhc2UuY2FsbChwYVswXSk7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoclswXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImFcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByWzFdID0gcGFbMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgclsyXSA9IHBhWzJdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJbM10gPSBwYVszXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByWzRdID0gcGFbNF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcls1XSA9IHBhWzVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJbNl0gPSArKHBhWzZdIC0geCkudG9GaXhlZCgzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByWzddID0gKyhwYVs3XSAtIHkpLnRvRml4ZWQoMyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwidlwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJbMV0gPSArKHBhWzFdIC0geSkudG9GaXhlZCgzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJtXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbXggPSBwYVsxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBteSA9IHBhWzJdO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMSwgamogPSBwYS5sZW5ndGg7IGogPCBqajsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJbal0gPSArKHBhW2pdIC0gKChqICUgMikgPyB4IDogeSkpLnRvRml4ZWQoMyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgciA9IHJlc1tpXSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBpZiAocGFbMF0gPT0gXCJtXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG14ID0gcGFbMV0gKyB4O1xuICAgICAgICAgICAgICAgICAgICAgICAgbXkgPSBwYVsyXSArIHk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgayA9IDAsIGtrID0gcGEubGVuZ3RoOyBrIDwga2s7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzW2ldW2tdID0gcGFba107XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGxlbiA9IHJlc1tpXS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChyZXNbaV1bMF0pIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcInpcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHggPSBteDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHkgPSBteTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiaFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgeCArPSArcmVzW2ldW2xlbiAtIDFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJ2XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICB5ICs9ICtyZXNbaV1bbGVuIC0gMV07XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHggKz0gK3Jlc1tpXVtsZW4gLSAyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHkgKz0gK3Jlc1tpXVtsZW4gLSAxXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXMudG9TdHJpbmcgPSBSLl9wYXRoMnN0cmluZztcbiAgICAgICAgICAgIHB0aC5yZWwgPSBwYXRoQ2xvbmUocmVzKTtcbiAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgIH0sXG4gICAgICAgIHBhdGhUb0Fic29sdXRlID0gUi5fcGF0aFRvQWJzb2x1dGUgPSBmdW5jdGlvbiAocGF0aEFycmF5KSB7XG4gICAgICAgICAgICB2YXIgcHRoID0gcGF0aHMocGF0aEFycmF5KTtcbiAgICAgICAgICAgIGlmIChwdGguYWJzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhdGhDbG9uZShwdGguYWJzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghUi5pcyhwYXRoQXJyYXksIGFycmF5KSB8fCAhUi5pcyhwYXRoQXJyYXkgJiYgcGF0aEFycmF5WzBdLCBhcnJheSkpIHsgLy8gcm91Z2ggYXNzdW1wdGlvblxuICAgICAgICAgICAgICAgIHBhdGhBcnJheSA9IFIucGFyc2VQYXRoU3RyaW5nKHBhdGhBcnJheSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXBhdGhBcnJheSB8fCAhcGF0aEFycmF5Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBbW1wiTVwiLCAwLCAwXV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcmVzID0gW10sXG4gICAgICAgICAgICAgICAgeCA9IDAsXG4gICAgICAgICAgICAgICAgeSA9IDAsXG4gICAgICAgICAgICAgICAgbXggPSAwLFxuICAgICAgICAgICAgICAgIG15ID0gMCxcbiAgICAgICAgICAgICAgICBzdGFydCA9IDA7XG4gICAgICAgICAgICBpZiAocGF0aEFycmF5WzBdWzBdID09IFwiTVwiKSB7XG4gICAgICAgICAgICAgICAgeCA9ICtwYXRoQXJyYXlbMF1bMV07XG4gICAgICAgICAgICAgICAgeSA9ICtwYXRoQXJyYXlbMF1bMl07XG4gICAgICAgICAgICAgICAgbXggPSB4O1xuICAgICAgICAgICAgICAgIG15ID0geTtcbiAgICAgICAgICAgICAgICBzdGFydCsrO1xuICAgICAgICAgICAgICAgIHJlc1swXSA9IFtcIk1cIiwgeCwgeV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgY3J6ID0gcGF0aEFycmF5Lmxlbmd0aCA9PSAzICYmIHBhdGhBcnJheVswXVswXSA9PSBcIk1cIiAmJiBwYXRoQXJyYXlbMV1bMF0udG9VcHBlckNhc2UoKSA9PSBcIlJcIiAmJiBwYXRoQXJyYXlbMl1bMF0udG9VcHBlckNhc2UoKSA9PSBcIlpcIjtcbiAgICAgICAgICAgIGZvciAodmFyIHIsIHBhLCBpID0gc3RhcnQsIGlpID0gcGF0aEFycmF5Lmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcbiAgICAgICAgICAgICAgICByZXMucHVzaChyID0gW10pO1xuICAgICAgICAgICAgICAgIHBhID0gcGF0aEFycmF5W2ldO1xuICAgICAgICAgICAgICAgIGlmIChwYVswXSAhPSB1cHBlckNhc2UuY2FsbChwYVswXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgclswXSA9IHVwcGVyQ2FzZS5jYWxsKHBhWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChyWzBdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiQVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJbMV0gPSBwYVsxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByWzJdID0gcGFbMl07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgclszXSA9IHBhWzNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJbNF0gPSBwYVs0XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByWzVdID0gcGFbNV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcls2XSA9ICsocGFbNl0gKyB4KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByWzddID0gKyhwYVs3XSArIHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlZcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByWzFdID0gK3BhWzFdICsgeTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJIXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgclsxXSA9ICtwYVsxXSArIHg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiUlwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkb3RzID0gW3gsIHldW2NvbmNhdF0ocGEuc2xpY2UoMSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAyLCBqaiA9IGRvdHMubGVuZ3RoOyBqIDwgamo7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb3RzW2pdID0gK2RvdHNbal0gKyB4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb3RzWysral0gPSArZG90c1tqXSArIHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcy5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXMgPSByZXNbY29uY2F0XShjYXRtdWxsUm9tMmJlemllcihkb3RzLCBjcnopKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJNXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbXggPSArcGFbMV0gKyB4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG15ID0gK3BhWzJdICsgeTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChqID0gMSwgamogPSBwYS5sZW5ndGg7IGogPCBqajsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJbal0gPSArcGFbal0gKyAoKGogJSAyKSA/IHggOiB5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHBhWzBdID09IFwiUlwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGRvdHMgPSBbeCwgeV1bY29uY2F0XShwYS5zbGljZSgxKSk7XG4gICAgICAgICAgICAgICAgICAgIHJlcy5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzID0gcmVzW2NvbmNhdF0oY2F0bXVsbFJvbTJiZXppZXIoZG90cywgY3J6KSk7XG4gICAgICAgICAgICAgICAgICAgIHIgPSBbXCJSXCJdW2NvbmNhdF0ocGEuc2xpY2UoLTIpKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMCwga2sgPSBwYS5sZW5ndGg7IGsgPCBrazsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByW2tdID0gcGFba107XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3dpdGNoIChyWzBdKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJaXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICB4ID0gbXg7XG4gICAgICAgICAgICAgICAgICAgICAgICB5ID0gbXk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIkhcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHggPSByWzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJWXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICB5ID0gclsxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiTVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgbXggPSByW3IubGVuZ3RoIC0gMl07XG4gICAgICAgICAgICAgICAgICAgICAgICBteSA9IHJbci5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHggPSByW3IubGVuZ3RoIC0gMl07XG4gICAgICAgICAgICAgICAgICAgICAgICB5ID0gcltyLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlcy50b1N0cmluZyA9IFIuX3BhdGgyc3RyaW5nO1xuICAgICAgICAgICAgcHRoLmFicyA9IHBhdGhDbG9uZShyZXMpO1xuICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgfSxcbiAgICAgICAgbDJjID0gZnVuY3Rpb24gKHgxLCB5MSwgeDIsIHkyKSB7XG4gICAgICAgICAgICByZXR1cm4gW3gxLCB5MSwgeDIsIHkyLCB4MiwgeTJdO1xuICAgICAgICB9LFxuICAgICAgICBxMmMgPSBmdW5jdGlvbiAoeDEsIHkxLCBheCwgYXksIHgyLCB5Mikge1xuICAgICAgICAgICAgdmFyIF8xMyA9IDEgLyAzLFxuICAgICAgICAgICAgICAgIF8yMyA9IDIgLyAzO1xuICAgICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICAgICAgICAgXzEzICogeDEgKyBfMjMgKiBheCxcbiAgICAgICAgICAgICAgICAgICAgXzEzICogeTEgKyBfMjMgKiBheSxcbiAgICAgICAgICAgICAgICAgICAgXzEzICogeDIgKyBfMjMgKiBheCxcbiAgICAgICAgICAgICAgICAgICAgXzEzICogeTIgKyBfMjMgKiBheSxcbiAgICAgICAgICAgICAgICAgICAgeDIsXG4gICAgICAgICAgICAgICAgICAgIHkyXG4gICAgICAgICAgICAgICAgXTtcbiAgICAgICAgfSxcbiAgICAgICAgYTJjID0gZnVuY3Rpb24gKHgxLCB5MSwgcngsIHJ5LCBhbmdsZSwgbGFyZ2VfYXJjX2ZsYWcsIHN3ZWVwX2ZsYWcsIHgyLCB5MiwgcmVjdXJzaXZlKSB7XG4gICAgICAgICAgICAvLyBmb3IgbW9yZSBpbmZvcm1hdGlvbiBvZiB3aGVyZSB0aGlzIG1hdGggY2FtZSBmcm9tIHZpc2l0OlxuICAgICAgICAgICAgLy8gaHR0cDovL3d3dy53My5vcmcvVFIvU1ZHMTEvaW1wbG5vdGUuaHRtbCNBcmNJbXBsZW1lbnRhdGlvbk5vdGVzXG4gICAgICAgICAgICB2YXIgXzEyMCA9IFBJICogMTIwIC8gMTgwLFxuICAgICAgICAgICAgICAgIHJhZCA9IFBJIC8gMTgwICogKCthbmdsZSB8fCAwKSxcbiAgICAgICAgICAgICAgICByZXMgPSBbXSxcbiAgICAgICAgICAgICAgICB4eSxcbiAgICAgICAgICAgICAgICByb3RhdGUgPSBjYWNoZXIoZnVuY3Rpb24gKHgsIHksIHJhZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgWCA9IHggKiBtYXRoLmNvcyhyYWQpIC0geSAqIG1hdGguc2luKHJhZCksXG4gICAgICAgICAgICAgICAgICAgICAgICBZID0geCAqIG1hdGguc2luKHJhZCkgKyB5ICogbWF0aC5jb3MocmFkKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHt4OiBYLCB5OiBZfTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmICghcmVjdXJzaXZlKSB7XG4gICAgICAgICAgICAgICAgeHkgPSByb3RhdGUoeDEsIHkxLCAtcmFkKTtcbiAgICAgICAgICAgICAgICB4MSA9IHh5Lng7XG4gICAgICAgICAgICAgICAgeTEgPSB4eS55O1xuICAgICAgICAgICAgICAgIHh5ID0gcm90YXRlKHgyLCB5MiwgLXJhZCk7XG4gICAgICAgICAgICAgICAgeDIgPSB4eS54O1xuICAgICAgICAgICAgICAgIHkyID0geHkueTtcbiAgICAgICAgICAgICAgICB2YXIgY29zID0gbWF0aC5jb3MoUEkgLyAxODAgKiBhbmdsZSksXG4gICAgICAgICAgICAgICAgICAgIHNpbiA9IG1hdGguc2luKFBJIC8gMTgwICogYW5nbGUpLFxuICAgICAgICAgICAgICAgICAgICB4ID0gKHgxIC0geDIpIC8gMixcbiAgICAgICAgICAgICAgICAgICAgeSA9ICh5MSAtIHkyKSAvIDI7XG4gICAgICAgICAgICAgICAgdmFyIGggPSAoeCAqIHgpIC8gKHJ4ICogcngpICsgKHkgKiB5KSAvIChyeSAqIHJ5KTtcbiAgICAgICAgICAgICAgICBpZiAoaCA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgaCA9IG1hdGguc3FydChoKTtcbiAgICAgICAgICAgICAgICAgICAgcnggPSBoICogcng7XG4gICAgICAgICAgICAgICAgICAgIHJ5ID0gaCAqIHJ5O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcngyID0gcnggKiByeCxcbiAgICAgICAgICAgICAgICAgICAgcnkyID0gcnkgKiByeSxcbiAgICAgICAgICAgICAgICAgICAgayA9IChsYXJnZV9hcmNfZmxhZyA9PSBzd2VlcF9mbGFnID8gLTEgOiAxKSAqXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXRoLnNxcnQoYWJzKChyeDIgKiByeTIgLSByeDIgKiB5ICogeSAtIHJ5MiAqIHggKiB4KSAvIChyeDIgKiB5ICogeSArIHJ5MiAqIHggKiB4KSkpLFxuICAgICAgICAgICAgICAgICAgICBjeCA9IGsgKiByeCAqIHkgLyByeSArICh4MSArIHgyKSAvIDIsXG4gICAgICAgICAgICAgICAgICAgIGN5ID0gayAqIC1yeSAqIHggLyByeCArICh5MSArIHkyKSAvIDIsXG4gICAgICAgICAgICAgICAgICAgIGYxID0gbWF0aC5hc2luKCgoeTEgLSBjeSkgLyByeSkudG9GaXhlZCg5KSksXG4gICAgICAgICAgICAgICAgICAgIGYyID0gbWF0aC5hc2luKCgoeTIgLSBjeSkgLyByeSkudG9GaXhlZCg5KSk7XG5cbiAgICAgICAgICAgICAgICBmMSA9IHgxIDwgY3ggPyBQSSAtIGYxIDogZjE7XG4gICAgICAgICAgICAgICAgZjIgPSB4MiA8IGN4ID8gUEkgLSBmMiA6IGYyO1xuICAgICAgICAgICAgICAgIGYxIDwgMCAmJiAoZjEgPSBQSSAqIDIgKyBmMSk7XG4gICAgICAgICAgICAgICAgZjIgPCAwICYmIChmMiA9IFBJICogMiArIGYyKTtcbiAgICAgICAgICAgICAgICBpZiAoc3dlZXBfZmxhZyAmJiBmMSA+IGYyKSB7XG4gICAgICAgICAgICAgICAgICAgIGYxID0gZjEgLSBQSSAqIDI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghc3dlZXBfZmxhZyAmJiBmMiA+IGYxKSB7XG4gICAgICAgICAgICAgICAgICAgIGYyID0gZjIgLSBQSSAqIDI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBmMSA9IHJlY3Vyc2l2ZVswXTtcbiAgICAgICAgICAgICAgICBmMiA9IHJlY3Vyc2l2ZVsxXTtcbiAgICAgICAgICAgICAgICBjeCA9IHJlY3Vyc2l2ZVsyXTtcbiAgICAgICAgICAgICAgICBjeSA9IHJlY3Vyc2l2ZVszXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBkZiA9IGYyIC0gZjE7XG4gICAgICAgICAgICBpZiAoYWJzKGRmKSA+IF8xMjApIHtcbiAgICAgICAgICAgICAgICB2YXIgZjJvbGQgPSBmMixcbiAgICAgICAgICAgICAgICAgICAgeDJvbGQgPSB4MixcbiAgICAgICAgICAgICAgICAgICAgeTJvbGQgPSB5MjtcbiAgICAgICAgICAgICAgICBmMiA9IGYxICsgXzEyMCAqIChzd2VlcF9mbGFnICYmIGYyID4gZjEgPyAxIDogLTEpO1xuICAgICAgICAgICAgICAgIHgyID0gY3ggKyByeCAqIG1hdGguY29zKGYyKTtcbiAgICAgICAgICAgICAgICB5MiA9IGN5ICsgcnkgKiBtYXRoLnNpbihmMik7XG4gICAgICAgICAgICAgICAgcmVzID0gYTJjKHgyLCB5MiwgcngsIHJ5LCBhbmdsZSwgMCwgc3dlZXBfZmxhZywgeDJvbGQsIHkyb2xkLCBbZjIsIGYyb2xkLCBjeCwgY3ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRmID0gZjIgLSBmMTtcbiAgICAgICAgICAgIHZhciBjMSA9IG1hdGguY29zKGYxKSxcbiAgICAgICAgICAgICAgICBzMSA9IG1hdGguc2luKGYxKSxcbiAgICAgICAgICAgICAgICBjMiA9IG1hdGguY29zKGYyKSxcbiAgICAgICAgICAgICAgICBzMiA9IG1hdGguc2luKGYyKSxcbiAgICAgICAgICAgICAgICB0ID0gbWF0aC50YW4oZGYgLyA0KSxcbiAgICAgICAgICAgICAgICBoeCA9IDQgLyAzICogcnggKiB0LFxuICAgICAgICAgICAgICAgIGh5ID0gNCAvIDMgKiByeSAqIHQsXG4gICAgICAgICAgICAgICAgbTEgPSBbeDEsIHkxXSxcbiAgICAgICAgICAgICAgICBtMiA9IFt4MSArIGh4ICogczEsIHkxIC0gaHkgKiBjMV0sXG4gICAgICAgICAgICAgICAgbTMgPSBbeDIgKyBoeCAqIHMyLCB5MiAtIGh5ICogYzJdLFxuICAgICAgICAgICAgICAgIG00ID0gW3gyLCB5Ml07XG4gICAgICAgICAgICBtMlswXSA9IDIgKiBtMVswXSAtIG0yWzBdO1xuICAgICAgICAgICAgbTJbMV0gPSAyICogbTFbMV0gLSBtMlsxXTtcbiAgICAgICAgICAgIGlmIChyZWN1cnNpdmUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gW20yLCBtMywgbTRdW2NvbmNhdF0ocmVzKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVzID0gW20yLCBtMywgbTRdW2NvbmNhdF0ocmVzKS5qb2luKClbc3BsaXRdKFwiLFwiKTtcbiAgICAgICAgICAgICAgICB2YXIgbmV3cmVzID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gcmVzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3cmVzW2ldID0gaSAlIDIgPyByb3RhdGUocmVzW2kgLSAxXSwgcmVzW2ldLCByYWQpLnkgOiByb3RhdGUocmVzW2ldLCByZXNbaSArIDFdLCByYWQpLng7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBuZXdyZXM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGZpbmREb3RBdFNlZ21lbnQgPSBmdW5jdGlvbiAocDF4LCBwMXksIGMxeCwgYzF5LCBjMngsIGMyeSwgcDJ4LCBwMnksIHQpIHtcbiAgICAgICAgICAgIHZhciB0MSA9IDEgLSB0O1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB4OiBwb3codDEsIDMpICogcDF4ICsgcG93KHQxLCAyKSAqIDMgKiB0ICogYzF4ICsgdDEgKiAzICogdCAqIHQgKiBjMnggKyBwb3codCwgMykgKiBwMngsXG4gICAgICAgICAgICAgICAgeTogcG93KHQxLCAzKSAqIHAxeSArIHBvdyh0MSwgMikgKiAzICogdCAqIGMxeSArIHQxICogMyAqIHQgKiB0ICogYzJ5ICsgcG93KHQsIDMpICogcDJ5XG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuICAgICAgICBjdXJ2ZURpbSA9IGNhY2hlcihmdW5jdGlvbiAocDF4LCBwMXksIGMxeCwgYzF5LCBjMngsIGMyeSwgcDJ4LCBwMnkpIHtcbiAgICAgICAgICAgIHZhciBhID0gKGMyeCAtIDIgKiBjMXggKyBwMXgpIC0gKHAyeCAtIDIgKiBjMnggKyBjMXgpLFxuICAgICAgICAgICAgICAgIGIgPSAyICogKGMxeCAtIHAxeCkgLSAyICogKGMyeCAtIGMxeCksXG4gICAgICAgICAgICAgICAgYyA9IHAxeCAtIGMxeCxcbiAgICAgICAgICAgICAgICB0MSA9ICgtYiArIG1hdGguc3FydChiICogYiAtIDQgKiBhICogYykpIC8gMiAvIGEsXG4gICAgICAgICAgICAgICAgdDIgPSAoLWIgLSBtYXRoLnNxcnQoYiAqIGIgLSA0ICogYSAqIGMpKSAvIDIgLyBhLFxuICAgICAgICAgICAgICAgIHkgPSBbcDF5LCBwMnldLFxuICAgICAgICAgICAgICAgIHggPSBbcDF4LCBwMnhdLFxuICAgICAgICAgICAgICAgIGRvdDtcbiAgICAgICAgICAgIGFicyh0MSkgPiBcIjFlMTJcIiAmJiAodDEgPSAuNSk7XG4gICAgICAgICAgICBhYnModDIpID4gXCIxZTEyXCIgJiYgKHQyID0gLjUpO1xuICAgICAgICAgICAgaWYgKHQxID4gMCAmJiB0MSA8IDEpIHtcbiAgICAgICAgICAgICAgICBkb3QgPSBmaW5kRG90QXRTZWdtZW50KHAxeCwgcDF5LCBjMXgsIGMxeSwgYzJ4LCBjMnksIHAyeCwgcDJ5LCB0MSk7XG4gICAgICAgICAgICAgICAgeC5wdXNoKGRvdC54KTtcbiAgICAgICAgICAgICAgICB5LnB1c2goZG90LnkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHQyID4gMCAmJiB0MiA8IDEpIHtcbiAgICAgICAgICAgICAgICBkb3QgPSBmaW5kRG90QXRTZWdtZW50KHAxeCwgcDF5LCBjMXgsIGMxeSwgYzJ4LCBjMnksIHAyeCwgcDJ5LCB0Mik7XG4gICAgICAgICAgICAgICAgeC5wdXNoKGRvdC54KTtcbiAgICAgICAgICAgICAgICB5LnB1c2goZG90LnkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYSA9IChjMnkgLSAyICogYzF5ICsgcDF5KSAtIChwMnkgLSAyICogYzJ5ICsgYzF5KTtcbiAgICAgICAgICAgIGIgPSAyICogKGMxeSAtIHAxeSkgLSAyICogKGMyeSAtIGMxeSk7XG4gICAgICAgICAgICBjID0gcDF5IC0gYzF5O1xuICAgICAgICAgICAgdDEgPSAoLWIgKyBtYXRoLnNxcnQoYiAqIGIgLSA0ICogYSAqIGMpKSAvIDIgLyBhO1xuICAgICAgICAgICAgdDIgPSAoLWIgLSBtYXRoLnNxcnQoYiAqIGIgLSA0ICogYSAqIGMpKSAvIDIgLyBhO1xuICAgICAgICAgICAgYWJzKHQxKSA+IFwiMWUxMlwiICYmICh0MSA9IC41KTtcbiAgICAgICAgICAgIGFicyh0MikgPiBcIjFlMTJcIiAmJiAodDIgPSAuNSk7XG4gICAgICAgICAgICBpZiAodDEgPiAwICYmIHQxIDwgMSkge1xuICAgICAgICAgICAgICAgIGRvdCA9IGZpbmREb3RBdFNlZ21lbnQocDF4LCBwMXksIGMxeCwgYzF5LCBjMngsIGMyeSwgcDJ4LCBwMnksIHQxKTtcbiAgICAgICAgICAgICAgICB4LnB1c2goZG90LngpO1xuICAgICAgICAgICAgICAgIHkucHVzaChkb3QueSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodDIgPiAwICYmIHQyIDwgMSkge1xuICAgICAgICAgICAgICAgIGRvdCA9IGZpbmREb3RBdFNlZ21lbnQocDF4LCBwMXksIGMxeCwgYzF5LCBjMngsIGMyeSwgcDJ4LCBwMnksIHQyKTtcbiAgICAgICAgICAgICAgICB4LnB1c2goZG90LngpO1xuICAgICAgICAgICAgICAgIHkucHVzaChkb3QueSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIG1pbjoge3g6IG1taW5bYXBwbHldKDAsIHgpLCB5OiBtbWluW2FwcGx5XSgwLCB5KX0sXG4gICAgICAgICAgICAgICAgbWF4OiB7eDogbW1heFthcHBseV0oMCwgeCksIHk6IG1tYXhbYXBwbHldKDAsIHkpfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSksXG4gICAgICAgIHBhdGgyY3VydmUgPSBSLl9wYXRoMmN1cnZlID0gY2FjaGVyKGZ1bmN0aW9uIChwYXRoLCBwYXRoMikge1xuICAgICAgICAgICAgdmFyIHB0aCA9ICFwYXRoMiAmJiBwYXRocyhwYXRoKTtcbiAgICAgICAgICAgIGlmICghcGF0aDIgJiYgcHRoLmN1cnZlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhdGhDbG9uZShwdGguY3VydmUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHAgPSBwYXRoVG9BYnNvbHV0ZShwYXRoKSxcbiAgICAgICAgICAgICAgICBwMiA9IHBhdGgyICYmIHBhdGhUb0Fic29sdXRlKHBhdGgyKSxcbiAgICAgICAgICAgICAgICBhdHRycyA9IHt4OiAwLCB5OiAwLCBieDogMCwgYnk6IDAsIFg6IDAsIFk6IDAsIHF4OiBudWxsLCBxeTogbnVsbH0sXG4gICAgICAgICAgICAgICAgYXR0cnMyID0ge3g6IDAsIHk6IDAsIGJ4OiAwLCBieTogMCwgWDogMCwgWTogMCwgcXg6IG51bGwsIHF5OiBudWxsfSxcbiAgICAgICAgICAgICAgICBwcm9jZXNzUGF0aCA9IGZ1bmN0aW9uIChwYXRoLCBkLCBwY29tKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBueCwgbnksIHRxID0ge1Q6MSwgUToxfTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFwYXRoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gW1wiQ1wiLCBkLngsIGQueSwgZC54LCBkLnksIGQueCwgZC55XTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAhKHBhdGhbMF0gaW4gdHEpICYmIChkLnF4ID0gZC5xeSA9IG51bGwpO1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHBhdGhbMF0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJNXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5YID0gcGF0aFsxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLlkgPSBwYXRoWzJdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIkFcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoID0gW1wiQ1wiXVtjb25jYXRdKGEyY1thcHBseV0oMCwgW2QueCwgZC55XVtjb25jYXRdKHBhdGguc2xpY2UoMSkpKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiU1wiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwY29tID09IFwiQ1wiIHx8IHBjb20gPT0gXCJTXCIpIHsgLy8gSW4gXCJTXCIgY2FzZSB3ZSBoYXZlIHRvIHRha2UgaW50byBhY2NvdW50LCBpZiB0aGUgcHJldmlvdXMgY29tbWFuZCBpcyBDL1MuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG54ID0gZC54ICogMiAtIGQuYng7ICAgICAgICAgIC8vIEFuZCByZWZsZWN0IHRoZSBwcmV2aW91c1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBueSA9IGQueSAqIDIgLSBkLmJ5OyAgICAgICAgICAvLyBjb21tYW5kJ3MgY29udHJvbCBwb2ludCByZWxhdGl2ZSB0byB0aGUgY3VycmVudCBwb2ludC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9yIHNvbWUgZWxzZSBvciBub3RoaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG54ID0gZC54O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBueSA9IGQueTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aCA9IFtcIkNcIiwgbngsIG55XVtjb25jYXRdKHBhdGguc2xpY2UoMSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlRcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGNvbSA9PSBcIlFcIiB8fCBwY29tID09IFwiVFwiKSB7IC8vIEluIFwiVFwiIGNhc2Ugd2UgaGF2ZSB0byB0YWtlIGludG8gYWNjb3VudCwgaWYgdGhlIHByZXZpb3VzIGNvbW1hbmQgaXMgUS9ULlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnF4ID0gZC54ICogMiAtIGQucXg7ICAgICAgICAvLyBBbmQgbWFrZSBhIHJlZmxlY3Rpb24gc2ltaWxhclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnF5ID0gZC55ICogMiAtIGQucXk7ICAgICAgICAvLyB0byBjYXNlIFwiU1wiLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gb3Igc29tZXRoaW5nIGVsc2Ugb3Igbm90aGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnF4ID0gZC54O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnF5ID0gZC55O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoID0gW1wiQ1wiXVtjb25jYXRdKHEyYyhkLngsIGQueSwgZC5xeCwgZC5xeSwgcGF0aFsxXSwgcGF0aFsyXSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIlFcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnF4ID0gcGF0aFsxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnF5ID0gcGF0aFsyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoID0gW1wiQ1wiXVtjb25jYXRdKHEyYyhkLngsIGQueSwgcGF0aFsxXSwgcGF0aFsyXSwgcGF0aFszXSwgcGF0aFs0XSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIkxcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoID0gW1wiQ1wiXVtjb25jYXRdKGwyYyhkLngsIGQueSwgcGF0aFsxXSwgcGF0aFsyXSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIkhcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoID0gW1wiQ1wiXVtjb25jYXRdKGwyYyhkLngsIGQueSwgcGF0aFsxXSwgZC55KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiVlwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGggPSBbXCJDXCJdW2NvbmNhdF0obDJjKGQueCwgZC55LCBkLngsIHBhdGhbMV0pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJaXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aCA9IFtcIkNcIl1bY29uY2F0XShsMmMoZC54LCBkLnksIGQuWCwgZC5ZKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhdGg7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBmaXhBcmMgPSBmdW5jdGlvbiAocHAsIGkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBwW2ldLmxlbmd0aCA+IDcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBwW2ldLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGkgPSBwcFtpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChwaS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwY29tczFbaV09XCJBXCI7IC8vIGlmIGNyZWF0ZWQgbXVsdGlwbGUgQzpzLCB0aGVpciBvcmlnaW5hbCBzZWcgaXMgc2F2ZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwMiAmJiAocGNvbXMyW2ldPVwiQVwiKTsgLy8gdGhlIHNhbWUgYXMgYWJvdmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcC5zcGxpY2UoaSsrLCAwLCBbXCJDXCJdW2NvbmNhdF0ocGkuc3BsaWNlKDAsIDYpKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBwcC5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpaSA9IG1tYXgocC5sZW5ndGgsIHAyICYmIHAyLmxlbmd0aCB8fCAwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZml4TSA9IGZ1bmN0aW9uIChwYXRoMSwgcGF0aDIsIGExLCBhMiwgaSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocGF0aDEgJiYgcGF0aDIgJiYgcGF0aDFbaV1bMF0gPT0gXCJNXCIgJiYgcGF0aDJbaV1bMF0gIT0gXCJNXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGgyLnNwbGljZShpLCAwLCBbXCJNXCIsIGEyLngsIGEyLnldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGExLmJ4ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGExLmJ5ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGExLnggPSBwYXRoMVtpXVsxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGExLnkgPSBwYXRoMVtpXVsyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlpID0gbW1heChwLmxlbmd0aCwgcDIgJiYgcDIubGVuZ3RoIHx8IDApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBwY29tczEgPSBbXSwgLy8gcGF0aCBjb21tYW5kcyBvZiBvcmlnaW5hbCBwYXRoIHBcbiAgICAgICAgICAgICAgICBwY29tczIgPSBbXSwgLy8gcGF0aCBjb21tYW5kcyBvZiBvcmlnaW5hbCBwYXRoIHAyXG4gICAgICAgICAgICAgICAgcGZpcnN0ID0gXCJcIiwgLy8gdGVtcG9yYXJ5IGhvbGRlciBmb3Igb3JpZ2luYWwgcGF0aCBjb21tYW5kXG4gICAgICAgICAgICAgICAgcGNvbSA9IFwiXCI7IC8vIGhvbGRlciBmb3IgcHJldmlvdXMgcGF0aCBjb21tYW5kIG9mIG9yaWdpbmFsIHBhdGhcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IG1tYXgocC5sZW5ndGgsIHAyICYmIHAyLmxlbmd0aCB8fCAwKTsgaSA8IGlpOyBpKyspIHtcbiAgICAgICAgICAgICAgICBwW2ldICYmIChwZmlyc3QgPSBwW2ldWzBdKTsgLy8gc2F2ZSBjdXJyZW50IHBhdGggY29tbWFuZFxuXG4gICAgICAgICAgICAgICAgaWYgKHBmaXJzdCAhPSBcIkNcIikgLy8gQyBpcyBub3Qgc2F2ZWQgeWV0LCBiZWNhdXNlIGl0IG1heSBiZSByZXN1bHQgb2YgY29udmVyc2lvblxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgcGNvbXMxW2ldID0gcGZpcnN0OyAvLyBTYXZlIGN1cnJlbnQgcGF0aCBjb21tYW5kXG4gICAgICAgICAgICAgICAgICAgIGkgJiYgKCBwY29tID0gcGNvbXMxW2ktMV0pOyAvLyBHZXQgcHJldmlvdXMgcGF0aCBjb21tYW5kIHBjb21cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcFtpXSA9IHByb2Nlc3NQYXRoKHBbaV0sIGF0dHJzLCBwY29tKTsgLy8gUHJldmlvdXMgcGF0aCBjb21tYW5kIGlzIGlucHV0dGVkIHRvIHByb2Nlc3NQYXRoXG5cbiAgICAgICAgICAgICAgICBpZiAocGNvbXMxW2ldICE9IFwiQVwiICYmIHBmaXJzdCA9PSBcIkNcIikgcGNvbXMxW2ldID0gXCJDXCI7IC8vIEEgaXMgdGhlIG9ubHkgY29tbWFuZFxuICAgICAgICAgICAgICAgIC8vIHdoaWNoIG1heSBwcm9kdWNlIG11bHRpcGxlIEM6c1xuICAgICAgICAgICAgICAgIC8vIHNvIHdlIGhhdmUgdG8gbWFrZSBzdXJlIHRoYXQgQyBpcyBhbHNvIEMgaW4gb3JpZ2luYWwgcGF0aFxuXG4gICAgICAgICAgICAgICAgZml4QXJjKHAsIGkpOyAvLyBmaXhBcmMgYWRkcyBhbHNvIHRoZSByaWdodCBhbW91bnQgb2YgQTpzIHRvIHBjb21zMVxuXG4gICAgICAgICAgICAgICAgaWYgKHAyKSB7IC8vIHRoZSBzYW1lIHByb2NlZHVyZXMgaXMgZG9uZSB0byBwMlxuICAgICAgICAgICAgICAgICAgICBwMltpXSAmJiAocGZpcnN0ID0gcDJbaV1bMF0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAocGZpcnN0ICE9IFwiQ1wiKVxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwY29tczJbaV0gPSBwZmlyc3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICBpICYmIChwY29tID0gcGNvbXMyW2ktMV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHAyW2ldID0gcHJvY2Vzc1BhdGgocDJbaV0sIGF0dHJzMiwgcGNvbSk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHBjb21zMltpXSE9XCJBXCIgJiYgcGZpcnN0PT1cIkNcIikgcGNvbXMyW2ldPVwiQ1wiO1xuXG4gICAgICAgICAgICAgICAgICAgIGZpeEFyYyhwMiwgaSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZpeE0ocCwgcDIsIGF0dHJzLCBhdHRyczIsIGkpO1xuICAgICAgICAgICAgICAgIGZpeE0ocDIsIHAsIGF0dHJzMiwgYXR0cnMsIGkpO1xuICAgICAgICAgICAgICAgIHZhciBzZWcgPSBwW2ldLFxuICAgICAgICAgICAgICAgICAgICBzZWcyID0gcDIgJiYgcDJbaV0sXG4gICAgICAgICAgICAgICAgICAgIHNlZ2xlbiA9IHNlZy5sZW5ndGgsXG4gICAgICAgICAgICAgICAgICAgIHNlZzJsZW4gPSBwMiAmJiBzZWcyLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBhdHRycy54ID0gc2VnW3NlZ2xlbiAtIDJdO1xuICAgICAgICAgICAgICAgIGF0dHJzLnkgPSBzZWdbc2VnbGVuIC0gMV07XG4gICAgICAgICAgICAgICAgYXR0cnMuYnggPSB0b0Zsb2F0KHNlZ1tzZWdsZW4gLSA0XSkgfHwgYXR0cnMueDtcbiAgICAgICAgICAgICAgICBhdHRycy5ieSA9IHRvRmxvYXQoc2VnW3NlZ2xlbiAtIDNdKSB8fCBhdHRycy55O1xuICAgICAgICAgICAgICAgIGF0dHJzMi5ieCA9IHAyICYmICh0b0Zsb2F0KHNlZzJbc2VnMmxlbiAtIDRdKSB8fCBhdHRyczIueCk7XG4gICAgICAgICAgICAgICAgYXR0cnMyLmJ5ID0gcDIgJiYgKHRvRmxvYXQoc2VnMltzZWcybGVuIC0gM10pIHx8IGF0dHJzMi55KTtcbiAgICAgICAgICAgICAgICBhdHRyczIueCA9IHAyICYmIHNlZzJbc2VnMmxlbiAtIDJdO1xuICAgICAgICAgICAgICAgIGF0dHJzMi55ID0gcDIgJiYgc2VnMltzZWcybGVuIC0gMV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXAyKSB7XG4gICAgICAgICAgICAgICAgcHRoLmN1cnZlID0gcGF0aENsb25lKHApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHAyID8gW3AsIHAyXSA6IHA7XG4gICAgICAgIH0sIG51bGwsIHBhdGhDbG9uZSksXG4gICAgICAgIHBhcnNlRG90cyA9IFIuX3BhcnNlRG90cyA9IGNhY2hlcihmdW5jdGlvbiAoZ3JhZGllbnQpIHtcbiAgICAgICAgICAgIHZhciBkb3RzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBncmFkaWVudC5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRvdCA9IHt9LFxuICAgICAgICAgICAgICAgICAgICBwYXIgPSBncmFkaWVudFtpXS5tYXRjaCgvXihbXjpdKik6PyhbXFxkXFwuXSopLyk7XG4gICAgICAgICAgICAgICAgZG90LmNvbG9yID0gUi5nZXRSR0IocGFyWzFdKTtcbiAgICAgICAgICAgICAgICBpZiAoZG90LmNvbG9yLmVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBkb3Qub3BhY2l0eSA9IGRvdC5jb2xvci5vcGFjaXR5O1xuICAgICAgICAgICAgICAgIGRvdC5jb2xvciA9IGRvdC5jb2xvci5oZXg7XG4gICAgICAgICAgICAgICAgcGFyWzJdICYmIChkb3Qub2Zmc2V0ID0gcGFyWzJdICsgXCIlXCIpO1xuICAgICAgICAgICAgICAgIGRvdHMucHVzaChkb3QpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChpID0gMSwgaWkgPSBkb3RzLmxlbmd0aCAtIDE7IGkgPCBpaTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFkb3RzW2ldLm9mZnNldCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3RhcnQgPSB0b0Zsb2F0KGRvdHNbaSAtIDFdLm9mZnNldCB8fCAwKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZCA9IDA7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSBpICsgMTsgaiA8IGlpOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkb3RzW2pdLm9mZnNldCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZCA9IGRvdHNbal0ub2Zmc2V0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICghZW5kKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbmQgPSAxMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBqID0gaWk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZW5kID0gdG9GbG9hdChlbmQpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IChlbmQgLSBzdGFydCkgLyAoaiAtIGkgKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICg7IGkgPCBqOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0ICs9IGQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBkb3RzW2ldLm9mZnNldCA9IHN0YXJ0ICsgXCIlXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZG90cztcbiAgICAgICAgfSksXG4gICAgICAgIHRlYXIgPSBSLl90ZWFyID0gZnVuY3Rpb24gKGVsLCBwYXBlcikge1xuICAgICAgICAgICAgZWwgPT0gcGFwZXIudG9wICYmIChwYXBlci50b3AgPSBlbC5wcmV2KTtcbiAgICAgICAgICAgIGVsID09IHBhcGVyLmJvdHRvbSAmJiAocGFwZXIuYm90dG9tID0gZWwubmV4dCk7XG4gICAgICAgICAgICBlbC5uZXh0ICYmIChlbC5uZXh0LnByZXYgPSBlbC5wcmV2KTtcbiAgICAgICAgICAgIGVsLnByZXYgJiYgKGVsLnByZXYubmV4dCA9IGVsLm5leHQpO1xuICAgICAgICB9LFxuICAgICAgICB0b2Zyb250ID0gUi5fdG9mcm9udCA9IGZ1bmN0aW9uIChlbCwgcGFwZXIpIHtcbiAgICAgICAgICAgIGlmIChwYXBlci50b3AgPT09IGVsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGVhcihlbCwgcGFwZXIpO1xuICAgICAgICAgICAgZWwubmV4dCA9IG51bGw7XG4gICAgICAgICAgICBlbC5wcmV2ID0gcGFwZXIudG9wO1xuICAgICAgICAgICAgcGFwZXIudG9wLm5leHQgPSBlbDtcbiAgICAgICAgICAgIHBhcGVyLnRvcCA9IGVsO1xuICAgICAgICB9LFxuICAgICAgICB0b2JhY2sgPSBSLl90b2JhY2sgPSBmdW5jdGlvbiAoZWwsIHBhcGVyKSB7XG4gICAgICAgICAgICBpZiAocGFwZXIuYm90dG9tID09PSBlbCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRlYXIoZWwsIHBhcGVyKTtcbiAgICAgICAgICAgIGVsLm5leHQgPSBwYXBlci5ib3R0b207XG4gICAgICAgICAgICBlbC5wcmV2ID0gbnVsbDtcbiAgICAgICAgICAgIHBhcGVyLmJvdHRvbS5wcmV2ID0gZWw7XG4gICAgICAgICAgICBwYXBlci5ib3R0b20gPSBlbDtcbiAgICAgICAgfSxcbiAgICAgICAgaW5zZXJ0YWZ0ZXIgPSBSLl9pbnNlcnRhZnRlciA9IGZ1bmN0aW9uIChlbCwgZWwyLCBwYXBlcikge1xuICAgICAgICAgICAgdGVhcihlbCwgcGFwZXIpO1xuICAgICAgICAgICAgZWwyID09IHBhcGVyLnRvcCAmJiAocGFwZXIudG9wID0gZWwpO1xuICAgICAgICAgICAgZWwyLm5leHQgJiYgKGVsMi5uZXh0LnByZXYgPSBlbCk7XG4gICAgICAgICAgICBlbC5uZXh0ID0gZWwyLm5leHQ7XG4gICAgICAgICAgICBlbC5wcmV2ID0gZWwyO1xuICAgICAgICAgICAgZWwyLm5leHQgPSBlbDtcbiAgICAgICAgfSxcbiAgICAgICAgaW5zZXJ0YmVmb3JlID0gUi5faW5zZXJ0YmVmb3JlID0gZnVuY3Rpb24gKGVsLCBlbDIsIHBhcGVyKSB7XG4gICAgICAgICAgICB0ZWFyKGVsLCBwYXBlcik7XG4gICAgICAgICAgICBlbDIgPT0gcGFwZXIuYm90dG9tICYmIChwYXBlci5ib3R0b20gPSBlbCk7XG4gICAgICAgICAgICBlbDIucHJldiAmJiAoZWwyLnByZXYubmV4dCA9IGVsKTtcbiAgICAgICAgICAgIGVsLnByZXYgPSBlbDIucHJldjtcbiAgICAgICAgICAgIGVsMi5wcmV2ID0gZWw7XG4gICAgICAgICAgICBlbC5uZXh0ID0gZWwyO1xuICAgICAgICB9LFxuICAgICAgICAvKlxcXG4gICAgICAgICAqIFJhcGhhZWwudG9NYXRyaXhcbiAgICAgICAgIFsgbWV0aG9kIF1cbiAgICAgICAgICoqXG4gICAgICAgICAqIFV0aWxpdHkgbWV0aG9kXG4gICAgICAgICAqKlxuICAgICAgICAgKiBSZXR1cm5zIG1hdHJpeCBvZiB0cmFuc2Zvcm1hdGlvbnMgYXBwbGllZCB0byBhIGdpdmVuIHBhdGhcbiAgICAgICAgID4gUGFyYW1ldGVyc1xuICAgICAgICAgLSBwYXRoIChzdHJpbmcpIHBhdGggc3RyaW5nXG4gICAgICAgICAtIHRyYW5zZm9ybSAoc3RyaW5nfGFycmF5KSB0cmFuc2Zvcm1hdGlvbiBzdHJpbmdcbiAgICAgICAgID0gKG9iamVjdCkgQE1hdHJpeFxuICAgICAgICBcXCovXG4gICAgICAgIHRvTWF0cml4ID0gUi50b01hdHJpeCA9IGZ1bmN0aW9uIChwYXRoLCB0cmFuc2Zvcm0pIHtcbiAgICAgICAgICAgIHZhciBiYiA9IHBhdGhEaW1lbnNpb25zKHBhdGgpLFxuICAgICAgICAgICAgICAgIGVsID0ge1xuICAgICAgICAgICAgICAgICAgICBfOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2Zvcm06IEVcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgZ2V0QkJveDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGJiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGV4dHJhY3RUcmFuc2Zvcm0oZWwsIHRyYW5zZm9ybSk7XG4gICAgICAgICAgICByZXR1cm4gZWwubWF0cml4O1xuICAgICAgICB9LFxuICAgICAgICAvKlxcXG4gICAgICAgICAqIFJhcGhhZWwudHJhbnNmb3JtUGF0aFxuICAgICAgICAgWyBtZXRob2QgXVxuICAgICAgICAgKipcbiAgICAgICAgICogVXRpbGl0eSBtZXRob2RcbiAgICAgICAgICoqXG4gICAgICAgICAqIFJldHVybnMgcGF0aCB0cmFuc2Zvcm1lZCBieSBhIGdpdmVuIHRyYW5zZm9ybWF0aW9uXG4gICAgICAgICA+IFBhcmFtZXRlcnNcbiAgICAgICAgIC0gcGF0aCAoc3RyaW5nKSBwYXRoIHN0cmluZ1xuICAgICAgICAgLSB0cmFuc2Zvcm0gKHN0cmluZ3xhcnJheSkgdHJhbnNmb3JtYXRpb24gc3RyaW5nXG4gICAgICAgICA9IChzdHJpbmcpIHBhdGhcbiAgICAgICAgXFwqL1xuICAgICAgICB0cmFuc2Zvcm1QYXRoID0gUi50cmFuc2Zvcm1QYXRoID0gZnVuY3Rpb24gKHBhdGgsIHRyYW5zZm9ybSkge1xuICAgICAgICAgICAgcmV0dXJuIG1hcFBhdGgocGF0aCwgdG9NYXRyaXgocGF0aCwgdHJhbnNmb3JtKSk7XG4gICAgICAgIH0sXG4gICAgICAgIGV4dHJhY3RUcmFuc2Zvcm0gPSBSLl9leHRyYWN0VHJhbnNmb3JtID0gZnVuY3Rpb24gKGVsLCB0c3RyKSB7XG4gICAgICAgICAgICBpZiAodHN0ciA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGVsLl8udHJhbnNmb3JtO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdHN0ciA9IFN0cih0c3RyKS5yZXBsYWNlKC9cXC57M318XFx1MjAyNi9nLCBlbC5fLnRyYW5zZm9ybSB8fCBFKTtcbiAgICAgICAgICAgIHZhciB0ZGF0YSA9IFIucGFyc2VUcmFuc2Zvcm1TdHJpbmcodHN0ciksXG4gICAgICAgICAgICAgICAgZGVnID0gMCxcbiAgICAgICAgICAgICAgICBkeCA9IDAsXG4gICAgICAgICAgICAgICAgZHkgPSAwLFxuICAgICAgICAgICAgICAgIHN4ID0gMSxcbiAgICAgICAgICAgICAgICBzeSA9IDEsXG4gICAgICAgICAgICAgICAgXyA9IGVsLl8sXG4gICAgICAgICAgICAgICAgbSA9IG5ldyBNYXRyaXg7XG4gICAgICAgICAgICBfLnRyYW5zZm9ybSA9IHRkYXRhIHx8IFtdO1xuICAgICAgICAgICAgaWYgKHRkYXRhKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gdGRhdGEubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdCA9IHRkYXRhW2ldLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGxlbiA9IHQubGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29tbWFuZCA9IFN0cih0WzBdKS50b0xvd2VyQ2FzZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgYWJzb2x1dGUgPSB0WzBdICE9IGNvbW1hbmQsXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnZlciA9IGFic29sdXRlID8gbS5pbnZlcnQoKSA6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICB4MSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHkxLFxuICAgICAgICAgICAgICAgICAgICAgICAgeDIsXG4gICAgICAgICAgICAgICAgICAgICAgICB5MixcbiAgICAgICAgICAgICAgICAgICAgICAgIGJiO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29tbWFuZCA9PSBcInRcIiAmJiB0bGVuID09IDMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYnNvbHV0ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHgxID0gaW52ZXIueCgwLCAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5MSA9IGludmVyLnkoMCwgMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeDIgPSBpbnZlci54KHRbMV0sIHRbMl0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHkyID0gaW52ZXIueSh0WzFdLCB0WzJdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtLnRyYW5zbGF0ZSh4MiAtIHgxLCB5MiAtIHkxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbS50cmFuc2xhdGUodFsxXSwgdFsyXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY29tbWFuZCA9PSBcInJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRsZW4gPT0gMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJiID0gYmIgfHwgZWwuZ2V0QkJveCgxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtLnJvdGF0ZSh0WzFdLCBiYi54ICsgYmIud2lkdGggLyAyLCBiYi55ICsgYmIuaGVpZ2h0IC8gMik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVnICs9IHRbMV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRsZW4gPT0gNCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYnNvbHV0ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4MiA9IGludmVyLngodFsyXSwgdFszXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHkyID0gaW52ZXIueSh0WzJdLCB0WzNdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbS5yb3RhdGUodFsxXSwgeDIsIHkyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtLnJvdGF0ZSh0WzFdLCB0WzJdLCB0WzNdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVnICs9IHRbMV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY29tbWFuZCA9PSBcInNcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRsZW4gPT0gMiB8fCB0bGVuID09IDMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYiA9IGJiIHx8IGVsLmdldEJCb3goMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbS5zY2FsZSh0WzFdLCB0W3RsZW4gLSAxXSwgYmIueCArIGJiLndpZHRoIC8gMiwgYmIueSArIGJiLmhlaWdodCAvIDIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN4ICo9IHRbMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3kgKj0gdFt0bGVuIC0gMV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRsZW4gPT0gNSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYnNvbHV0ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4MiA9IGludmVyLngodFszXSwgdFs0XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHkyID0gaW52ZXIueSh0WzNdLCB0WzRdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbS5zY2FsZSh0WzFdLCB0WzJdLCB4MiwgeTIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0uc2NhbGUodFsxXSwgdFsyXSwgdFszXSwgdFs0XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN4ICo9IHRbMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3kgKj0gdFsyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb21tYW5kID09IFwibVwiICYmIHRsZW4gPT0gNykge1xuICAgICAgICAgICAgICAgICAgICAgICAgbS5hZGQodFsxXSwgdFsyXSwgdFszXSwgdFs0XSwgdFs1XSwgdFs2XSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXy5kaXJ0eVQgPSAxO1xuICAgICAgICAgICAgICAgICAgICBlbC5tYXRyaXggPSBtO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLypcXFxuICAgICAgICAgICAgICogRWxlbWVudC5tYXRyaXhcbiAgICAgICAgICAgICBbIHByb3BlcnR5IChvYmplY3QpIF1cbiAgICAgICAgICAgICAqKlxuICAgICAgICAgICAgICogS2VlcHMgQE1hdHJpeCBvYmplY3QsIHdoaWNoIHJlcHJlc2VudHMgZWxlbWVudCB0cmFuc2Zvcm1hdGlvblxuICAgICAgICAgICAgXFwqL1xuICAgICAgICAgICAgZWwubWF0cml4ID0gbTtcblxuICAgICAgICAgICAgXy5zeCA9IHN4O1xuICAgICAgICAgICAgXy5zeSA9IHN5O1xuICAgICAgICAgICAgXy5kZWcgPSBkZWc7XG4gICAgICAgICAgICBfLmR4ID0gZHggPSBtLmU7XG4gICAgICAgICAgICBfLmR5ID0gZHkgPSBtLmY7XG5cbiAgICAgICAgICAgIGlmIChzeCA9PSAxICYmIHN5ID09IDEgJiYgIWRlZyAmJiBfLmJib3gpIHtcbiAgICAgICAgICAgICAgICBfLmJib3gueCArPSArZHg7XG4gICAgICAgICAgICAgICAgXy5iYm94LnkgKz0gK2R5O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBfLmRpcnR5VCA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGdldEVtcHR5ID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgIHZhciBsID0gaXRlbVswXTtcbiAgICAgICAgICAgIHN3aXRjaCAobC50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBcInRcIjogcmV0dXJuIFtsLCAwLCAwXTtcbiAgICAgICAgICAgICAgICBjYXNlIFwibVwiOiByZXR1cm4gW2wsIDEsIDAsIDAsIDEsIDAsIDBdO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJyXCI6IGlmIChpdGVtLmxlbmd0aCA9PSA0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbbCwgMCwgaXRlbVsyXSwgaXRlbVszXV07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtsLCAwXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2FzZSBcInNcIjogaWYgKGl0ZW0ubGVuZ3RoID09IDUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtsLCAxLCAxLCBpdGVtWzNdLCBpdGVtWzRdXTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGl0ZW0ubGVuZ3RoID09IDMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtsLCAxLCAxXTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW2wsIDFdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZXF1YWxpc2VUcmFuc2Zvcm0gPSBSLl9lcXVhbGlzZVRyYW5zZm9ybSA9IGZ1bmN0aW9uICh0MSwgdDIpIHtcbiAgICAgICAgICAgIHQyID0gU3RyKHQyKS5yZXBsYWNlKC9cXC57M318XFx1MjAyNi9nLCB0MSk7XG4gICAgICAgICAgICB0MSA9IFIucGFyc2VUcmFuc2Zvcm1TdHJpbmcodDEpIHx8IFtdO1xuICAgICAgICAgICAgdDIgPSBSLnBhcnNlVHJhbnNmb3JtU3RyaW5nKHQyKSB8fCBbXTtcbiAgICAgICAgICAgIHZhciBtYXhsZW5ndGggPSBtbWF4KHQxLmxlbmd0aCwgdDIubGVuZ3RoKSxcbiAgICAgICAgICAgICAgICBmcm9tID0gW10sXG4gICAgICAgICAgICAgICAgdG8gPSBbXSxcbiAgICAgICAgICAgICAgICBpID0gMCwgaiwgamosXG4gICAgICAgICAgICAgICAgdHQxLCB0dDI7XG4gICAgICAgICAgICBmb3IgKDsgaSA8IG1heGxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdHQxID0gdDFbaV0gfHwgZ2V0RW1wdHkodDJbaV0pO1xuICAgICAgICAgICAgICAgIHR0MiA9IHQyW2ldIHx8IGdldEVtcHR5KHR0MSk7XG4gICAgICAgICAgICAgICAgaWYgKCh0dDFbMF0gIT0gdHQyWzBdKSB8fFxuICAgICAgICAgICAgICAgICAgICAodHQxWzBdLnRvTG93ZXJDYXNlKCkgPT0gXCJyXCIgJiYgKHR0MVsyXSAhPSB0dDJbMl0gfHwgdHQxWzNdICE9IHR0MlszXSkpIHx8XG4gICAgICAgICAgICAgICAgICAgICh0dDFbMF0udG9Mb3dlckNhc2UoKSA9PSBcInNcIiAmJiAodHQxWzNdICE9IHR0MlszXSB8fCB0dDFbNF0gIT0gdHQyWzRdKSlcbiAgICAgICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZnJvbVtpXSA9IFtdO1xuICAgICAgICAgICAgICAgIHRvW2ldID0gW107XG4gICAgICAgICAgICAgICAgZm9yIChqID0gMCwgamogPSBtbWF4KHR0MS5sZW5ndGgsIHR0Mi5sZW5ndGgpOyBqIDwgamo7IGorKykge1xuICAgICAgICAgICAgICAgICAgICBqIGluIHR0MSAmJiAoZnJvbVtpXVtqXSA9IHR0MVtqXSk7XG4gICAgICAgICAgICAgICAgICAgIGogaW4gdHQyICYmICh0b1tpXVtqXSA9IHR0MltqXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBmcm9tOiBmcm9tLFxuICAgICAgICAgICAgICAgIHRvOiB0b1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICBSLl9nZXRDb250YWluZXIgPSBmdW5jdGlvbiAoeCwgeSwgdywgaCkge1xuICAgICAgICB2YXIgY29udGFpbmVyO1xuICAgICAgICBjb250YWluZXIgPSBoID09IG51bGwgJiYgIVIuaXMoeCwgXCJvYmplY3RcIikgPyBnLmRvYy5nZXRFbGVtZW50QnlJZCh4KSA6IHg7XG4gICAgICAgIGlmIChjb250YWluZXIgPT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb250YWluZXIudGFnTmFtZSkge1xuICAgICAgICAgICAgaWYgKHkgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lcjogY29udGFpbmVyLFxuICAgICAgICAgICAgICAgICAgICB3aWR0aDogY29udGFpbmVyLnN0eWxlLnBpeGVsV2lkdGggfHwgY29udGFpbmVyLm9mZnNldFdpZHRoLFxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IGNvbnRhaW5lci5zdHlsZS5waXhlbEhlaWdodCB8fCBjb250YWluZXIub2Zmc2V0SGVpZ2h0XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyOiBjb250YWluZXIsXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoOiB5LFxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IHdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBjb250YWluZXI6IDEsXG4gICAgICAgICAgICB4OiB4LFxuICAgICAgICAgICAgeTogeSxcbiAgICAgICAgICAgIHdpZHRoOiB3LFxuICAgICAgICAgICAgaGVpZ2h0OiBoXG4gICAgICAgIH07XG4gICAgfTtcbiAgICAvKlxcXG4gICAgICogUmFwaGFlbC5wYXRoVG9SZWxhdGl2ZVxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogVXRpbGl0eSBtZXRob2RcbiAgICAgKipcbiAgICAgKiBDb252ZXJ0cyBwYXRoIHRvIHJlbGF0aXZlIGZvcm1cbiAgICAgPiBQYXJhbWV0ZXJzXG4gICAgIC0gcGF0aFN0cmluZyAoc3RyaW5nfGFycmF5KSBwYXRoIHN0cmluZyBvciBhcnJheSBvZiBzZWdtZW50c1xuICAgICA9IChhcnJheSkgYXJyYXkgb2Ygc2VnbWVudHMuXG4gICAgXFwqL1xuICAgIFIucGF0aFRvUmVsYXRpdmUgPSBwYXRoVG9SZWxhdGl2ZTtcbiAgICBSLl9lbmdpbmUgPSB7fTtcbiAgICAvKlxcXG4gICAgICogUmFwaGFlbC5wYXRoMmN1cnZlXG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBVdGlsaXR5IG1ldGhvZFxuICAgICAqKlxuICAgICAqIENvbnZlcnRzIHBhdGggdG8gYSBuZXcgcGF0aCB3aGVyZSBhbGwgc2VnbWVudHMgYXJlIGN1YmljIGJlemllciBjdXJ2ZXMuXG4gICAgID4gUGFyYW1ldGVyc1xuICAgICAtIHBhdGhTdHJpbmcgKHN0cmluZ3xhcnJheSkgcGF0aCBzdHJpbmcgb3IgYXJyYXkgb2Ygc2VnbWVudHNcbiAgICAgPSAoYXJyYXkpIGFycmF5IG9mIHNlZ21lbnRzLlxuICAgIFxcKi9cbiAgICBSLnBhdGgyY3VydmUgPSBwYXRoMmN1cnZlO1xuICAgIC8qXFxcbiAgICAgKiBSYXBoYWVsLm1hdHJpeFxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogVXRpbGl0eSBtZXRob2RcbiAgICAgKipcbiAgICAgKiBSZXR1cm5zIG1hdHJpeCBiYXNlZCBvbiBnaXZlbiBwYXJhbWV0ZXJzLlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgLSBhIChudW1iZXIpXG4gICAgIC0gYiAobnVtYmVyKVxuICAgICAtIGMgKG51bWJlcilcbiAgICAgLSBkIChudW1iZXIpXG4gICAgIC0gZSAobnVtYmVyKVxuICAgICAtIGYgKG51bWJlcilcbiAgICAgPSAob2JqZWN0KSBATWF0cml4XG4gICAgXFwqL1xuICAgIFIubWF0cml4ID0gZnVuY3Rpb24gKGEsIGIsIGMsIGQsIGUsIGYpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBNYXRyaXgoYSwgYiwgYywgZCwgZSwgZik7XG4gICAgfTtcbiAgICBmdW5jdGlvbiBNYXRyaXgoYSwgYiwgYywgZCwgZSwgZikge1xuICAgICAgICBpZiAoYSAhPSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLmEgPSArYTtcbiAgICAgICAgICAgIHRoaXMuYiA9ICtiO1xuICAgICAgICAgICAgdGhpcy5jID0gK2M7XG4gICAgICAgICAgICB0aGlzLmQgPSArZDtcbiAgICAgICAgICAgIHRoaXMuZSA9ICtlO1xuICAgICAgICAgICAgdGhpcy5mID0gK2Y7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmEgPSAxO1xuICAgICAgICAgICAgdGhpcy5iID0gMDtcbiAgICAgICAgICAgIHRoaXMuYyA9IDA7XG4gICAgICAgICAgICB0aGlzLmQgPSAxO1xuICAgICAgICAgICAgdGhpcy5lID0gMDtcbiAgICAgICAgICAgIHRoaXMuZiA9IDA7XG4gICAgICAgIH1cbiAgICB9XG4gICAgKGZ1bmN0aW9uIChtYXRyaXhwcm90bykge1xuICAgICAgICAvKlxcXG4gICAgICAgICAqIE1hdHJpeC5hZGRcbiAgICAgICAgIFsgbWV0aG9kIF1cbiAgICAgICAgICoqXG4gICAgICAgICAqIEFkZHMgZ2l2ZW4gbWF0cml4IHRvIGV4aXN0aW5nIG9uZS5cbiAgICAgICAgID4gUGFyYW1ldGVyc1xuICAgICAgICAgLSBhIChudW1iZXIpXG4gICAgICAgICAtIGIgKG51bWJlcilcbiAgICAgICAgIC0gYyAobnVtYmVyKVxuICAgICAgICAgLSBkIChudW1iZXIpXG4gICAgICAgICAtIGUgKG51bWJlcilcbiAgICAgICAgIC0gZiAobnVtYmVyKVxuICAgICAgICAgb3JcbiAgICAgICAgIC0gbWF0cml4IChvYmplY3QpIEBNYXRyaXhcbiAgICAgICAgXFwqL1xuICAgICAgICBtYXRyaXhwcm90by5hZGQgPSBmdW5jdGlvbiAoYSwgYiwgYywgZCwgZSwgZikge1xuICAgICAgICAgICAgdmFyIG91dCA9IFtbXSwgW10sIFtdXSxcbiAgICAgICAgICAgICAgICBtID0gW1t0aGlzLmEsIHRoaXMuYywgdGhpcy5lXSwgW3RoaXMuYiwgdGhpcy5kLCB0aGlzLmZdLCBbMCwgMCwgMV1dLFxuICAgICAgICAgICAgICAgIG1hdHJpeCA9IFtbYSwgYywgZV0sIFtiLCBkLCBmXSwgWzAsIDAsIDFdXSxcbiAgICAgICAgICAgICAgICB4LCB5LCB6LCByZXM7XG5cbiAgICAgICAgICAgIGlmIChhICYmIGEgaW5zdGFuY2VvZiBNYXRyaXgpIHtcbiAgICAgICAgICAgICAgICBtYXRyaXggPSBbW2EuYSwgYS5jLCBhLmVdLCBbYS5iLCBhLmQsIGEuZl0sIFswLCAwLCAxXV07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZvciAoeCA9IDA7IHggPCAzOyB4KyspIHtcbiAgICAgICAgICAgICAgICBmb3IgKHkgPSAwOyB5IDwgMzsgeSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlcyA9IDA7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoeiA9IDA7IHogPCAzOyB6KyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyArPSBtW3hdW3pdICogbWF0cml4W3pdW3ldO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIG91dFt4XVt5XSA9IHJlcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmEgPSBvdXRbMF1bMF07XG4gICAgICAgICAgICB0aGlzLmIgPSBvdXRbMV1bMF07XG4gICAgICAgICAgICB0aGlzLmMgPSBvdXRbMF1bMV07XG4gICAgICAgICAgICB0aGlzLmQgPSBvdXRbMV1bMV07XG4gICAgICAgICAgICB0aGlzLmUgPSBvdXRbMF1bMl07XG4gICAgICAgICAgICB0aGlzLmYgPSBvdXRbMV1bMl07XG4gICAgICAgIH07XG4gICAgICAgIC8qXFxcbiAgICAgICAgICogTWF0cml4LmludmVydFxuICAgICAgICAgWyBtZXRob2QgXVxuICAgICAgICAgKipcbiAgICAgICAgICogUmV0dXJucyBpbnZlcnRlZCB2ZXJzaW9uIG9mIHRoZSBtYXRyaXhcbiAgICAgICAgID0gKG9iamVjdCkgQE1hdHJpeFxuICAgICAgICBcXCovXG4gICAgICAgIG1hdHJpeHByb3RvLmludmVydCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBtZSA9IHRoaXMsXG4gICAgICAgICAgICAgICAgeCA9IG1lLmEgKiBtZS5kIC0gbWUuYiAqIG1lLmM7XG4gICAgICAgICAgICByZXR1cm4gbmV3IE1hdHJpeChtZS5kIC8geCwgLW1lLmIgLyB4LCAtbWUuYyAvIHgsIG1lLmEgLyB4LCAobWUuYyAqIG1lLmYgLSBtZS5kICogbWUuZSkgLyB4LCAobWUuYiAqIG1lLmUgLSBtZS5hICogbWUuZikgLyB4KTtcbiAgICAgICAgfTtcbiAgICAgICAgLypcXFxuICAgICAgICAgKiBNYXRyaXguY2xvbmVcbiAgICAgICAgIFsgbWV0aG9kIF1cbiAgICAgICAgICoqXG4gICAgICAgICAqIFJldHVybnMgY29weSBvZiB0aGUgbWF0cml4XG4gICAgICAgICA9IChvYmplY3QpIEBNYXRyaXhcbiAgICAgICAgXFwqL1xuICAgICAgICBtYXRyaXhwcm90by5jbG9uZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgTWF0cml4KHRoaXMuYSwgdGhpcy5iLCB0aGlzLmMsIHRoaXMuZCwgdGhpcy5lLCB0aGlzLmYpO1xuICAgICAgICB9O1xuICAgICAgICAvKlxcXG4gICAgICAgICAqIE1hdHJpeC50cmFuc2xhdGVcbiAgICAgICAgIFsgbWV0aG9kIF1cbiAgICAgICAgICoqXG4gICAgICAgICAqIFRyYW5zbGF0ZSB0aGUgbWF0cml4XG4gICAgICAgICA+IFBhcmFtZXRlcnNcbiAgICAgICAgIC0geCAobnVtYmVyKVxuICAgICAgICAgLSB5IChudW1iZXIpXG4gICAgICAgIFxcKi9cbiAgICAgICAgbWF0cml4cHJvdG8udHJhbnNsYXRlID0gZnVuY3Rpb24gKHgsIHkpIHtcbiAgICAgICAgICAgIHRoaXMuYWRkKDEsIDAsIDAsIDEsIHgsIHkpO1xuICAgICAgICB9O1xuICAgICAgICAvKlxcXG4gICAgICAgICAqIE1hdHJpeC5zY2FsZVxuICAgICAgICAgWyBtZXRob2QgXVxuICAgICAgICAgKipcbiAgICAgICAgICogU2NhbGVzIHRoZSBtYXRyaXhcbiAgICAgICAgID4gUGFyYW1ldGVyc1xuICAgICAgICAgLSB4IChudW1iZXIpXG4gICAgICAgICAtIHkgKG51bWJlcikgI29wdGlvbmFsXG4gICAgICAgICAtIGN4IChudW1iZXIpICNvcHRpb25hbFxuICAgICAgICAgLSBjeSAobnVtYmVyKSAjb3B0aW9uYWxcbiAgICAgICAgXFwqL1xuICAgICAgICBtYXRyaXhwcm90by5zY2FsZSA9IGZ1bmN0aW9uICh4LCB5LCBjeCwgY3kpIHtcbiAgICAgICAgICAgIHkgPT0gbnVsbCAmJiAoeSA9IHgpO1xuICAgICAgICAgICAgKGN4IHx8IGN5KSAmJiB0aGlzLmFkZCgxLCAwLCAwLCAxLCBjeCwgY3kpO1xuICAgICAgICAgICAgdGhpcy5hZGQoeCwgMCwgMCwgeSwgMCwgMCk7XG4gICAgICAgICAgICAoY3ggfHwgY3kpICYmIHRoaXMuYWRkKDEsIDAsIDAsIDEsIC1jeCwgLWN5KTtcbiAgICAgICAgfTtcbiAgICAgICAgLypcXFxuICAgICAgICAgKiBNYXRyaXgucm90YXRlXG4gICAgICAgICBbIG1ldGhvZCBdXG4gICAgICAgICAqKlxuICAgICAgICAgKiBSb3RhdGVzIHRoZSBtYXRyaXhcbiAgICAgICAgID4gUGFyYW1ldGVyc1xuICAgICAgICAgLSBhIChudW1iZXIpXG4gICAgICAgICAtIHggKG51bWJlcilcbiAgICAgICAgIC0geSAobnVtYmVyKVxuICAgICAgICBcXCovXG4gICAgICAgIG1hdHJpeHByb3RvLnJvdGF0ZSA9IGZ1bmN0aW9uIChhLCB4LCB5KSB7XG4gICAgICAgICAgICBhID0gUi5yYWQoYSk7XG4gICAgICAgICAgICB4ID0geCB8fCAwO1xuICAgICAgICAgICAgeSA9IHkgfHwgMDtcbiAgICAgICAgICAgIHZhciBjb3MgPSArbWF0aC5jb3MoYSkudG9GaXhlZCg5KSxcbiAgICAgICAgICAgICAgICBzaW4gPSArbWF0aC5zaW4oYSkudG9GaXhlZCg5KTtcbiAgICAgICAgICAgIHRoaXMuYWRkKGNvcywgc2luLCAtc2luLCBjb3MsIHgsIHkpO1xuICAgICAgICAgICAgdGhpcy5hZGQoMSwgMCwgMCwgMSwgLXgsIC15KTtcbiAgICAgICAgfTtcbiAgICAgICAgLypcXFxuICAgICAgICAgKiBNYXRyaXgueFxuICAgICAgICAgWyBtZXRob2QgXVxuICAgICAgICAgKipcbiAgICAgICAgICogUmV0dXJuIHggY29vcmRpbmF0ZSBmb3IgZ2l2ZW4gcG9pbnQgYWZ0ZXIgdHJhbnNmb3JtYXRpb24gZGVzY3JpYmVkIGJ5IHRoZSBtYXRyaXguIFNlZSBhbHNvIEBNYXRyaXgueVxuICAgICAgICAgPiBQYXJhbWV0ZXJzXG4gICAgICAgICAtIHggKG51bWJlcilcbiAgICAgICAgIC0geSAobnVtYmVyKVxuICAgICAgICAgPSAobnVtYmVyKSB4XG4gICAgICAgIFxcKi9cbiAgICAgICAgbWF0cml4cHJvdG8ueCA9IGZ1bmN0aW9uICh4LCB5KSB7XG4gICAgICAgICAgICByZXR1cm4geCAqIHRoaXMuYSArIHkgKiB0aGlzLmMgKyB0aGlzLmU7XG4gICAgICAgIH07XG4gICAgICAgIC8qXFxcbiAgICAgICAgICogTWF0cml4LnlcbiAgICAgICAgIFsgbWV0aG9kIF1cbiAgICAgICAgICoqXG4gICAgICAgICAqIFJldHVybiB5IGNvb3JkaW5hdGUgZm9yIGdpdmVuIHBvaW50IGFmdGVyIHRyYW5zZm9ybWF0aW9uIGRlc2NyaWJlZCBieSB0aGUgbWF0cml4LiBTZWUgYWxzbyBATWF0cml4LnhcbiAgICAgICAgID4gUGFyYW1ldGVyc1xuICAgICAgICAgLSB4IChudW1iZXIpXG4gICAgICAgICAtIHkgKG51bWJlcilcbiAgICAgICAgID0gKG51bWJlcikgeVxuICAgICAgICBcXCovXG4gICAgICAgIG1hdHJpeHByb3RvLnkgPSBmdW5jdGlvbiAoeCwgeSkge1xuICAgICAgICAgICAgcmV0dXJuIHggKiB0aGlzLmIgKyB5ICogdGhpcy5kICsgdGhpcy5mO1xuICAgICAgICB9O1xuICAgICAgICBtYXRyaXhwcm90by5nZXQgPSBmdW5jdGlvbiAoaSkge1xuICAgICAgICAgICAgcmV0dXJuICt0aGlzW1N0ci5mcm9tQ2hhckNvZGUoOTcgKyBpKV0udG9GaXhlZCg0KTtcbiAgICAgICAgfTtcbiAgICAgICAgbWF0cml4cHJvdG8udG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gUi5zdmcgP1xuICAgICAgICAgICAgICAgIFwibWF0cml4KFwiICsgW3RoaXMuZ2V0KDApLCB0aGlzLmdldCgxKSwgdGhpcy5nZXQoMiksIHRoaXMuZ2V0KDMpLCB0aGlzLmdldCg0KSwgdGhpcy5nZXQoNSldLmpvaW4oKSArIFwiKVwiIDpcbiAgICAgICAgICAgICAgICBbdGhpcy5nZXQoMCksIHRoaXMuZ2V0KDIpLCB0aGlzLmdldCgxKSwgdGhpcy5nZXQoMyksIDAsIDBdLmpvaW4oKTtcbiAgICAgICAgfTtcbiAgICAgICAgbWF0cml4cHJvdG8udG9GaWx0ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJwcm9naWQ6RFhJbWFnZVRyYW5zZm9ybS5NaWNyb3NvZnQuTWF0cml4KE0xMT1cIiArIHRoaXMuZ2V0KDApICtcbiAgICAgICAgICAgICAgICBcIiwgTTEyPVwiICsgdGhpcy5nZXQoMikgKyBcIiwgTTIxPVwiICsgdGhpcy5nZXQoMSkgKyBcIiwgTTIyPVwiICsgdGhpcy5nZXQoMykgK1xuICAgICAgICAgICAgICAgIFwiLCBEeD1cIiArIHRoaXMuZ2V0KDQpICsgXCIsIER5PVwiICsgdGhpcy5nZXQoNSkgKyBcIiwgc2l6aW5nbWV0aG9kPSdhdXRvIGV4cGFuZCcpXCI7XG4gICAgICAgIH07XG4gICAgICAgIG1hdHJpeHByb3RvLm9mZnNldCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBbdGhpcy5lLnRvRml4ZWQoNCksIHRoaXMuZi50b0ZpeGVkKDQpXTtcbiAgICAgICAgfTtcbiAgICAgICAgZnVuY3Rpb24gbm9ybShhKSB7XG4gICAgICAgICAgICByZXR1cm4gYVswXSAqIGFbMF0gKyBhWzFdICogYVsxXTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBub3JtYWxpemUoYSkge1xuICAgICAgICAgICAgdmFyIG1hZyA9IG1hdGguc3FydChub3JtKGEpKTtcbiAgICAgICAgICAgIGFbMF0gJiYgKGFbMF0gLz0gbWFnKTtcbiAgICAgICAgICAgIGFbMV0gJiYgKGFbMV0gLz0gbWFnKTtcbiAgICAgICAgfVxuICAgICAgICAvKlxcXG4gICAgICAgICAqIE1hdHJpeC5zcGxpdFxuICAgICAgICAgWyBtZXRob2QgXVxuICAgICAgICAgKipcbiAgICAgICAgICogU3BsaXRzIG1hdHJpeCBpbnRvIHByaW1pdGl2ZSB0cmFuc2Zvcm1hdGlvbnNcbiAgICAgICAgID0gKG9iamVjdCkgaW4gZm9ybWF0OlxuICAgICAgICAgbyBkeCAobnVtYmVyKSB0cmFuc2xhdGlvbiBieSB4XG4gICAgICAgICBvIGR5IChudW1iZXIpIHRyYW5zbGF0aW9uIGJ5IHlcbiAgICAgICAgIG8gc2NhbGV4IChudW1iZXIpIHNjYWxlIGJ5IHhcbiAgICAgICAgIG8gc2NhbGV5IChudW1iZXIpIHNjYWxlIGJ5IHlcbiAgICAgICAgIG8gc2hlYXIgKG51bWJlcikgc2hlYXJcbiAgICAgICAgIG8gcm90YXRlIChudW1iZXIpIHJvdGF0aW9uIGluIGRlZ1xuICAgICAgICAgbyBpc1NpbXBsZSAoYm9vbGVhbikgY291bGQgaXQgYmUgcmVwcmVzZW50ZWQgdmlhIHNpbXBsZSB0cmFuc2Zvcm1hdGlvbnNcbiAgICAgICAgXFwqL1xuICAgICAgICBtYXRyaXhwcm90by5zcGxpdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBvdXQgPSB7fTtcbiAgICAgICAgICAgIC8vIHRyYW5zbGF0aW9uXG4gICAgICAgICAgICBvdXQuZHggPSB0aGlzLmU7XG4gICAgICAgICAgICBvdXQuZHkgPSB0aGlzLmY7XG5cbiAgICAgICAgICAgIC8vIHNjYWxlIGFuZCBzaGVhclxuICAgICAgICAgICAgdmFyIHJvdyA9IFtbdGhpcy5hLCB0aGlzLmNdLCBbdGhpcy5iLCB0aGlzLmRdXTtcbiAgICAgICAgICAgIG91dC5zY2FsZXggPSBtYXRoLnNxcnQobm9ybShyb3dbMF0pKTtcbiAgICAgICAgICAgIG5vcm1hbGl6ZShyb3dbMF0pO1xuXG4gICAgICAgICAgICBvdXQuc2hlYXIgPSByb3dbMF1bMF0gKiByb3dbMV1bMF0gKyByb3dbMF1bMV0gKiByb3dbMV1bMV07XG4gICAgICAgICAgICByb3dbMV0gPSBbcm93WzFdWzBdIC0gcm93WzBdWzBdICogb3V0LnNoZWFyLCByb3dbMV1bMV0gLSByb3dbMF1bMV0gKiBvdXQuc2hlYXJdO1xuXG4gICAgICAgICAgICBvdXQuc2NhbGV5ID0gbWF0aC5zcXJ0KG5vcm0ocm93WzFdKSk7XG4gICAgICAgICAgICBub3JtYWxpemUocm93WzFdKTtcbiAgICAgICAgICAgIG91dC5zaGVhciAvPSBvdXQuc2NhbGV5O1xuXG4gICAgICAgICAgICAvLyByb3RhdGlvblxuICAgICAgICAgICAgdmFyIHNpbiA9IC1yb3dbMF1bMV0sXG4gICAgICAgICAgICAgICAgY29zID0gcm93WzFdWzFdO1xuICAgICAgICAgICAgaWYgKGNvcyA8IDApIHtcbiAgICAgICAgICAgICAgICBvdXQucm90YXRlID0gUi5kZWcobWF0aC5hY29zKGNvcykpO1xuICAgICAgICAgICAgICAgIGlmIChzaW4gPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgIG91dC5yb3RhdGUgPSAzNjAgLSBvdXQucm90YXRlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgb3V0LnJvdGF0ZSA9IFIuZGVnKG1hdGguYXNpbihzaW4pKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgb3V0LmlzU2ltcGxlID0gIStvdXQuc2hlYXIudG9GaXhlZCg5KSAmJiAob3V0LnNjYWxleC50b0ZpeGVkKDkpID09IG91dC5zY2FsZXkudG9GaXhlZCg5KSB8fCAhb3V0LnJvdGF0ZSk7XG4gICAgICAgICAgICBvdXQuaXNTdXBlclNpbXBsZSA9ICErb3V0LnNoZWFyLnRvRml4ZWQoOSkgJiYgb3V0LnNjYWxleC50b0ZpeGVkKDkpID09IG91dC5zY2FsZXkudG9GaXhlZCg5KSAmJiAhb3V0LnJvdGF0ZTtcbiAgICAgICAgICAgIG91dC5ub1JvdGF0aW9uID0gIStvdXQuc2hlYXIudG9GaXhlZCg5KSAmJiAhb3V0LnJvdGF0ZTtcbiAgICAgICAgICAgIHJldHVybiBvdXQ7XG4gICAgICAgIH07XG4gICAgICAgIC8qXFxcbiAgICAgICAgICogTWF0cml4LnRvVHJhbnNmb3JtU3RyaW5nXG4gICAgICAgICBbIG1ldGhvZCBdXG4gICAgICAgICAqKlxuICAgICAgICAgKiBSZXR1cm4gdHJhbnNmb3JtIHN0cmluZyB0aGF0IHJlcHJlc2VudHMgZ2l2ZW4gbWF0cml4XG4gICAgICAgICA9IChzdHJpbmcpIHRyYW5zZm9ybSBzdHJpbmdcbiAgICAgICAgXFwqL1xuICAgICAgICBtYXRyaXhwcm90by50b1RyYW5zZm9ybVN0cmluZyA9IGZ1bmN0aW9uIChzaG9ydGVyKSB7XG4gICAgICAgICAgICB2YXIgcyA9IHNob3J0ZXIgfHwgdGhpc1tzcGxpdF0oKTtcbiAgICAgICAgICAgIGlmIChzLmlzU2ltcGxlKSB7XG4gICAgICAgICAgICAgICAgcy5zY2FsZXggPSArcy5zY2FsZXgudG9GaXhlZCg0KTtcbiAgICAgICAgICAgICAgICBzLnNjYWxleSA9ICtzLnNjYWxleS50b0ZpeGVkKDQpO1xuICAgICAgICAgICAgICAgIHMucm90YXRlID0gK3Mucm90YXRlLnRvRml4ZWQoNCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuICAocy5keCB8fCBzLmR5ID8gXCJ0XCIgKyBbcy5keCwgcy5keV0gOiBFKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAocy5zY2FsZXggIT0gMSB8fCBzLnNjYWxleSAhPSAxID8gXCJzXCIgKyBbcy5zY2FsZXgsIHMuc2NhbGV5LCAwLCAwXSA6IEUpICtcbiAgICAgICAgICAgICAgICAgICAgICAgIChzLnJvdGF0ZSA/IFwiclwiICsgW3Mucm90YXRlLCAwLCAwXSA6IEUpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJtXCIgKyBbdGhpcy5nZXQoMCksIHRoaXMuZ2V0KDEpLCB0aGlzLmdldCgyKSwgdGhpcy5nZXQoMyksIHRoaXMuZ2V0KDQpLCB0aGlzLmdldCg1KV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSkoTWF0cml4LnByb3RvdHlwZSk7XG5cbiAgICB2YXIgcHJldmVudERlZmF1bHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMucmV0dXJuVmFsdWUgPSBmYWxzZTtcbiAgICB9LFxuICAgIHByZXZlbnRUb3VjaCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub3JpZ2luYWxFdmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0sXG4gICAgc3RvcFByb3BhZ2F0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmNhbmNlbEJ1YmJsZSA9IHRydWU7XG4gICAgfSxcbiAgICBzdG9wVG91Y2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm9yaWdpbmFsRXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgfSxcbiAgICBnZXRFdmVudFBvc2l0aW9uID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIHNjcm9sbFkgPSBnLmRvYy5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wIHx8IGcuZG9jLmJvZHkuc2Nyb2xsVG9wLFxuICAgICAgICAgICAgc2Nyb2xsWCA9IGcuZG9jLmRvY3VtZW50RWxlbWVudC5zY3JvbGxMZWZ0IHx8IGcuZG9jLmJvZHkuc2Nyb2xsTGVmdDtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgeDogZS5jbGllbnRYICsgc2Nyb2xsWCxcbiAgICAgICAgICAgIHk6IGUuY2xpZW50WSArIHNjcm9sbFlcbiAgICAgICAgfTtcbiAgICB9LFxuICAgIGFkZEV2ZW50ID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKGcuZG9jLmFkZEV2ZW50TGlzdGVuZXIpIHtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAob2JqLCB0eXBlLCBmbiwgZWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHZhciBmID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBvcyA9IGdldEV2ZW50UG9zaXRpb24oZSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmbi5jYWxsKGVsZW1lbnQsIGUsIHBvcy54LCBwb3MueSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBvYmouYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBmLCBmYWxzZSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoc3VwcG9ydHNUb3VjaCAmJiB0b3VjaE1hcFt0eXBlXSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgX2YgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBvcyA9IGdldEV2ZW50UG9zaXRpb24oZSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2xkZSA9IGU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IGUudGFyZ2V0VG91Y2hlcyAmJiBlLnRhcmdldFRvdWNoZXMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlLnRhcmdldFRvdWNoZXNbaV0udGFyZ2V0ID09IG9iaikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlID0gZS50YXJnZXRUb3VjaGVzW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLm9yaWdpbmFsRXZlbnQgPSBvbGRlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0ID0gcHJldmVudFRvdWNoO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbiA9IHN0b3BUb3VjaDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm4uY2FsbChlbGVtZW50LCBlLCBwb3MueCwgcG9zLnkpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBvYmouYWRkRXZlbnRMaXN0ZW5lcih0b3VjaE1hcFt0eXBlXSwgX2YsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBvYmoucmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLCBmLCBmYWxzZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHN1cHBvcnRzVG91Y2ggJiYgdG91Y2hNYXBbdHlwZV0pXG4gICAgICAgICAgICAgICAgICAgICAgICBvYmoucmVtb3ZlRXZlbnRMaXN0ZW5lcih0b3VjaE1hcFt0eXBlXSwgX2YsIGZhbHNlKTtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSBlbHNlIGlmIChnLmRvYy5hdHRhY2hFdmVudCkge1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChvYmosIHR5cGUsIGZuLCBlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgdmFyIGYgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICBlID0gZSB8fCBnLndpbi5ldmVudDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNjcm9sbFkgPSBnLmRvYy5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wIHx8IGcuZG9jLmJvZHkuc2Nyb2xsVG9wLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsWCA9IGcuZG9jLmRvY3VtZW50RWxlbWVudC5zY3JvbGxMZWZ0IHx8IGcuZG9jLmJvZHkuc2Nyb2xsTGVmdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHggPSBlLmNsaWVudFggKyBzY3JvbGxYLFxuICAgICAgICAgICAgICAgICAgICAgICAgeSA9IGUuY2xpZW50WSArIHNjcm9sbFk7XG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQgPSBlLnByZXZlbnREZWZhdWx0IHx8IHByZXZlbnREZWZhdWx0O1xuICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbiA9IGUuc3RvcFByb3BhZ2F0aW9uIHx8IHN0b3BQcm9wYWdhdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZuLmNhbGwoZWxlbWVudCwgZSwgeCwgeSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBvYmouYXR0YWNoRXZlbnQoXCJvblwiICsgdHlwZSwgZik7XG4gICAgICAgICAgICAgICAgdmFyIGRldGFjaGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBvYmouZGV0YWNoRXZlbnQoXCJvblwiICsgdHlwZSwgZik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRldGFjaGVyO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH0pKCksXG4gICAgZHJhZyA9IFtdLFxuICAgIGRyYWdNb3ZlID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIHggPSBlLmNsaWVudFgsXG4gICAgICAgICAgICB5ID0gZS5jbGllbnRZLFxuICAgICAgICAgICAgc2Nyb2xsWSA9IGcuZG9jLmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3AgfHwgZy5kb2MuYm9keS5zY3JvbGxUb3AsXG4gICAgICAgICAgICBzY3JvbGxYID0gZy5kb2MuZG9jdW1lbnRFbGVtZW50LnNjcm9sbExlZnQgfHwgZy5kb2MuYm9keS5zY3JvbGxMZWZ0LFxuICAgICAgICAgICAgZHJhZ2ksXG4gICAgICAgICAgICBqID0gZHJhZy5sZW5ndGg7XG4gICAgICAgIHdoaWxlIChqLS0pIHtcbiAgICAgICAgICAgIGRyYWdpID0gZHJhZ1tqXTtcbiAgICAgICAgICAgIGlmIChzdXBwb3J0c1RvdWNoICYmIGUudG91Y2hlcykge1xuICAgICAgICAgICAgICAgIHZhciBpID0gZS50b3VjaGVzLmxlbmd0aCxcbiAgICAgICAgICAgICAgICAgICAgdG91Y2g7XG4gICAgICAgICAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgICAgICAgICB0b3VjaCA9IGUudG91Y2hlc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRvdWNoLmlkZW50aWZpZXIgPT0gZHJhZ2kuZWwuX2RyYWcuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHggPSB0b3VjaC5jbGllbnRYO1xuICAgICAgICAgICAgICAgICAgICAgICAgeSA9IHRvdWNoLmNsaWVudFk7XG4gICAgICAgICAgICAgICAgICAgICAgICAoZS5vcmlnaW5hbEV2ZW50ID8gZS5vcmlnaW5hbEV2ZW50IDogZSkucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgbm9kZSA9IGRyYWdpLmVsLm5vZGUsXG4gICAgICAgICAgICAgICAgbyxcbiAgICAgICAgICAgICAgICBuZXh0ID0gbm9kZS5uZXh0U2libGluZyxcbiAgICAgICAgICAgICAgICBwYXJlbnQgPSBub2RlLnBhcmVudE5vZGUsXG4gICAgICAgICAgICAgICAgZGlzcGxheSA9IG5vZGUuc3R5bGUuZGlzcGxheTtcbiAgICAgICAgICAgIGcud2luLm9wZXJhICYmIHBhcmVudC5yZW1vdmVDaGlsZChub2RlKTtcbiAgICAgICAgICAgIG5vZGUuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgICAgICAgbyA9IGRyYWdpLmVsLnBhcGVyLmdldEVsZW1lbnRCeVBvaW50KHgsIHkpO1xuICAgICAgICAgICAgbm9kZS5zdHlsZS5kaXNwbGF5ID0gZGlzcGxheTtcbiAgICAgICAgICAgIGcud2luLm9wZXJhICYmIChuZXh0ID8gcGFyZW50Lmluc2VydEJlZm9yZShub2RlLCBuZXh0KSA6IHBhcmVudC5hcHBlbmRDaGlsZChub2RlKSk7XG4gICAgICAgICAgICBvICYmIGV2ZShcInJhcGhhZWwuZHJhZy5vdmVyLlwiICsgZHJhZ2kuZWwuaWQsIGRyYWdpLmVsLCBvKTtcbiAgICAgICAgICAgIHggKz0gc2Nyb2xsWDtcbiAgICAgICAgICAgIHkgKz0gc2Nyb2xsWTtcbiAgICAgICAgICAgIGV2ZShcInJhcGhhZWwuZHJhZy5tb3ZlLlwiICsgZHJhZ2kuZWwuaWQsIGRyYWdpLm1vdmVfc2NvcGUgfHwgZHJhZ2kuZWwsIHggLSBkcmFnaS5lbC5fZHJhZy54LCB5IC0gZHJhZ2kuZWwuX2RyYWcueSwgeCwgeSwgZSk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIGRyYWdVcCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIFIudW5tb3VzZW1vdmUoZHJhZ01vdmUpLnVubW91c2V1cChkcmFnVXApO1xuICAgICAgICB2YXIgaSA9IGRyYWcubGVuZ3RoLFxuICAgICAgICAgICAgZHJhZ2k7XG4gICAgICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgICAgIGRyYWdpID0gZHJhZ1tpXTtcbiAgICAgICAgICAgIGRyYWdpLmVsLl9kcmFnID0ge307XG4gICAgICAgICAgICBldmUoXCJyYXBoYWVsLmRyYWcuZW5kLlwiICsgZHJhZ2kuZWwuaWQsIGRyYWdpLmVuZF9zY29wZSB8fCBkcmFnaS5zdGFydF9zY29wZSB8fCBkcmFnaS5tb3ZlX3Njb3BlIHx8IGRyYWdpLmVsLCBlKTtcbiAgICAgICAgfVxuICAgICAgICBkcmFnID0gW107XG4gICAgfSxcbiAgICAvKlxcXG4gICAgICogUmFwaGFlbC5lbFxuICAgICBbIHByb3BlcnR5IChvYmplY3QpIF1cbiAgICAgKipcbiAgICAgKiBZb3UgY2FuIGFkZCB5b3VyIG93biBtZXRob2QgdG8gZWxlbWVudHMuIFRoaXMgaXMgdXNlZnVsIHdoZW4geW91IHdhbnQgdG8gaGFjayBkZWZhdWx0IGZ1bmN0aW9uYWxpdHkgb3JcbiAgICAgKiB3YW50IHRvIHdyYXAgc29tZSBjb21tb24gdHJhbnNmb3JtYXRpb24gb3IgYXR0cmlidXRlcyBpbiBvbmUgbWV0aG9kLiBJbiBkaWZmZXJlbmNlIHRvIGNhbnZhcyBtZXRob2RzLFxuICAgICAqIHlvdSBjYW4gcmVkZWZpbmUgZWxlbWVudCBtZXRob2QgYXQgYW55IHRpbWUuIEV4cGVuZGluZyBlbGVtZW50IG1ldGhvZHMgd291bGRu4oCZdCBhZmZlY3Qgc2V0LlxuICAgICA+IFVzYWdlXG4gICAgIHwgUmFwaGFlbC5lbC5yZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgIHwgICAgIHRoaXMuYXR0cih7ZmlsbDogXCIjZjAwXCJ9KTtcbiAgICAgfCB9O1xuICAgICB8IC8vIHRoZW4gdXNlIGl0XG4gICAgIHwgcGFwZXIuY2lyY2xlKDEwMCwgMTAwLCAyMCkucmVkKCk7XG4gICAgXFwqL1xuICAgIGVscHJvdG8gPSBSLmVsID0ge307XG4gICAgLypcXFxuICAgICAqIEVsZW1lbnQuY2xpY2tcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIEFkZHMgZXZlbnQgaGFuZGxlciBmb3IgY2xpY2sgZm9yIHRoZSBlbGVtZW50LlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgLSBoYW5kbGVyIChmdW5jdGlvbikgaGFuZGxlciBmb3IgdGhlIGV2ZW50XG4gICAgID0gKG9iamVjdCkgQEVsZW1lbnRcbiAgICBcXCovXG4gICAgLypcXFxuICAgICAqIEVsZW1lbnQudW5jbGlja1xuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogUmVtb3ZlcyBldmVudCBoYW5kbGVyIGZvciBjbGljayBmb3IgdGhlIGVsZW1lbnQuXG4gICAgID4gUGFyYW1ldGVyc1xuICAgICAtIGhhbmRsZXIgKGZ1bmN0aW9uKSAjb3B0aW9uYWwgaGFuZGxlciBmb3IgdGhlIGV2ZW50XG4gICAgID0gKG9iamVjdCkgQEVsZW1lbnRcbiAgICBcXCovXG5cbiAgICAvKlxcXG4gICAgICogRWxlbWVudC5kYmxjbGlja1xuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogQWRkcyBldmVudCBoYW5kbGVyIGZvciBkb3VibGUgY2xpY2sgZm9yIHRoZSBlbGVtZW50LlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgLSBoYW5kbGVyIChmdW5jdGlvbikgaGFuZGxlciBmb3IgdGhlIGV2ZW50XG4gICAgID0gKG9iamVjdCkgQEVsZW1lbnRcbiAgICBcXCovXG4gICAgLypcXFxuICAgICAqIEVsZW1lbnQudW5kYmxjbGlja1xuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogUmVtb3ZlcyBldmVudCBoYW5kbGVyIGZvciBkb3VibGUgY2xpY2sgZm9yIHRoZSBlbGVtZW50LlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgLSBoYW5kbGVyIChmdW5jdGlvbikgI29wdGlvbmFsIGhhbmRsZXIgZm9yIHRoZSBldmVudFxuICAgICA9IChvYmplY3QpIEBFbGVtZW50XG4gICAgXFwqL1xuXG4gICAgLypcXFxuICAgICAqIEVsZW1lbnQubW91c2Vkb3duXG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBBZGRzIGV2ZW50IGhhbmRsZXIgZm9yIG1vdXNlZG93biBmb3IgdGhlIGVsZW1lbnQuXG4gICAgID4gUGFyYW1ldGVyc1xuICAgICAtIGhhbmRsZXIgKGZ1bmN0aW9uKSBoYW5kbGVyIGZvciB0aGUgZXZlbnRcbiAgICAgPSAob2JqZWN0KSBARWxlbWVudFxuICAgIFxcKi9cbiAgICAvKlxcXG4gICAgICogRWxlbWVudC51bm1vdXNlZG93blxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogUmVtb3ZlcyBldmVudCBoYW5kbGVyIGZvciBtb3VzZWRvd24gZm9yIHRoZSBlbGVtZW50LlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgLSBoYW5kbGVyIChmdW5jdGlvbikgI29wdGlvbmFsIGhhbmRsZXIgZm9yIHRoZSBldmVudFxuICAgICA9IChvYmplY3QpIEBFbGVtZW50XG4gICAgXFwqL1xuXG4gICAgLypcXFxuICAgICAqIEVsZW1lbnQubW91c2Vtb3ZlXG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBBZGRzIGV2ZW50IGhhbmRsZXIgZm9yIG1vdXNlbW92ZSBmb3IgdGhlIGVsZW1lbnQuXG4gICAgID4gUGFyYW1ldGVyc1xuICAgICAtIGhhbmRsZXIgKGZ1bmN0aW9uKSBoYW5kbGVyIGZvciB0aGUgZXZlbnRcbiAgICAgPSAob2JqZWN0KSBARWxlbWVudFxuICAgIFxcKi9cbiAgICAvKlxcXG4gICAgICogRWxlbWVudC51bm1vdXNlbW92ZVxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogUmVtb3ZlcyBldmVudCBoYW5kbGVyIGZvciBtb3VzZW1vdmUgZm9yIHRoZSBlbGVtZW50LlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgLSBoYW5kbGVyIChmdW5jdGlvbikgI29wdGlvbmFsIGhhbmRsZXIgZm9yIHRoZSBldmVudFxuICAgICA9IChvYmplY3QpIEBFbGVtZW50XG4gICAgXFwqL1xuXG4gICAgLypcXFxuICAgICAqIEVsZW1lbnQubW91c2VvdXRcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIEFkZHMgZXZlbnQgaGFuZGxlciBmb3IgbW91c2VvdXQgZm9yIHRoZSBlbGVtZW50LlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgLSBoYW5kbGVyIChmdW5jdGlvbikgaGFuZGxlciBmb3IgdGhlIGV2ZW50XG4gICAgID0gKG9iamVjdCkgQEVsZW1lbnRcbiAgICBcXCovXG4gICAgLypcXFxuICAgICAqIEVsZW1lbnQudW5tb3VzZW91dFxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogUmVtb3ZlcyBldmVudCBoYW5kbGVyIGZvciBtb3VzZW91dCBmb3IgdGhlIGVsZW1lbnQuXG4gICAgID4gUGFyYW1ldGVyc1xuICAgICAtIGhhbmRsZXIgKGZ1bmN0aW9uKSAjb3B0aW9uYWwgaGFuZGxlciBmb3IgdGhlIGV2ZW50XG4gICAgID0gKG9iamVjdCkgQEVsZW1lbnRcbiAgICBcXCovXG5cbiAgICAvKlxcXG4gICAgICogRWxlbWVudC5tb3VzZW92ZXJcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIEFkZHMgZXZlbnQgaGFuZGxlciBmb3IgbW91c2VvdmVyIGZvciB0aGUgZWxlbWVudC5cbiAgICAgPiBQYXJhbWV0ZXJzXG4gICAgIC0gaGFuZGxlciAoZnVuY3Rpb24pIGhhbmRsZXIgZm9yIHRoZSBldmVudFxuICAgICA9IChvYmplY3QpIEBFbGVtZW50XG4gICAgXFwqL1xuICAgIC8qXFxcbiAgICAgKiBFbGVtZW50LnVubW91c2VvdmVyXG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBSZW1vdmVzIGV2ZW50IGhhbmRsZXIgZm9yIG1vdXNlb3ZlciBmb3IgdGhlIGVsZW1lbnQuXG4gICAgID4gUGFyYW1ldGVyc1xuICAgICAtIGhhbmRsZXIgKGZ1bmN0aW9uKSAjb3B0aW9uYWwgaGFuZGxlciBmb3IgdGhlIGV2ZW50XG4gICAgID0gKG9iamVjdCkgQEVsZW1lbnRcbiAgICBcXCovXG5cbiAgICAvKlxcXG4gICAgICogRWxlbWVudC5tb3VzZXVwXG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBBZGRzIGV2ZW50IGhhbmRsZXIgZm9yIG1vdXNldXAgZm9yIHRoZSBlbGVtZW50LlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgLSBoYW5kbGVyIChmdW5jdGlvbikgaGFuZGxlciBmb3IgdGhlIGV2ZW50XG4gICAgID0gKG9iamVjdCkgQEVsZW1lbnRcbiAgICBcXCovXG4gICAgLypcXFxuICAgICAqIEVsZW1lbnQudW5tb3VzZXVwXG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBSZW1vdmVzIGV2ZW50IGhhbmRsZXIgZm9yIG1vdXNldXAgZm9yIHRoZSBlbGVtZW50LlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgLSBoYW5kbGVyIChmdW5jdGlvbikgI29wdGlvbmFsIGhhbmRsZXIgZm9yIHRoZSBldmVudFxuICAgICA9IChvYmplY3QpIEBFbGVtZW50XG4gICAgXFwqL1xuXG4gICAgLypcXFxuICAgICAqIEVsZW1lbnQudG91Y2hzdGFydFxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogQWRkcyBldmVudCBoYW5kbGVyIGZvciB0b3VjaHN0YXJ0IGZvciB0aGUgZWxlbWVudC5cbiAgICAgPiBQYXJhbWV0ZXJzXG4gICAgIC0gaGFuZGxlciAoZnVuY3Rpb24pIGhhbmRsZXIgZm9yIHRoZSBldmVudFxuICAgICA9IChvYmplY3QpIEBFbGVtZW50XG4gICAgXFwqL1xuICAgIC8qXFxcbiAgICAgKiBFbGVtZW50LnVudG91Y2hzdGFydFxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogUmVtb3ZlcyBldmVudCBoYW5kbGVyIGZvciB0b3VjaHN0YXJ0IGZvciB0aGUgZWxlbWVudC5cbiAgICAgPiBQYXJhbWV0ZXJzXG4gICAgIC0gaGFuZGxlciAoZnVuY3Rpb24pICNvcHRpb25hbCBoYW5kbGVyIGZvciB0aGUgZXZlbnRcbiAgICAgPSAob2JqZWN0KSBARWxlbWVudFxuICAgIFxcKi9cblxuICAgIC8qXFxcbiAgICAgKiBFbGVtZW50LnRvdWNobW92ZVxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogQWRkcyBldmVudCBoYW5kbGVyIGZvciB0b3VjaG1vdmUgZm9yIHRoZSBlbGVtZW50LlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgLSBoYW5kbGVyIChmdW5jdGlvbikgaGFuZGxlciBmb3IgdGhlIGV2ZW50XG4gICAgID0gKG9iamVjdCkgQEVsZW1lbnRcbiAgICBcXCovXG4gICAgLypcXFxuICAgICAqIEVsZW1lbnQudW50b3VjaG1vdmVcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIFJlbW92ZXMgZXZlbnQgaGFuZGxlciBmb3IgdG91Y2htb3ZlIGZvciB0aGUgZWxlbWVudC5cbiAgICAgPiBQYXJhbWV0ZXJzXG4gICAgIC0gaGFuZGxlciAoZnVuY3Rpb24pICNvcHRpb25hbCBoYW5kbGVyIGZvciB0aGUgZXZlbnRcbiAgICAgPSAob2JqZWN0KSBARWxlbWVudFxuICAgIFxcKi9cblxuICAgIC8qXFxcbiAgICAgKiBFbGVtZW50LnRvdWNoZW5kXG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBBZGRzIGV2ZW50IGhhbmRsZXIgZm9yIHRvdWNoZW5kIGZvciB0aGUgZWxlbWVudC5cbiAgICAgPiBQYXJhbWV0ZXJzXG4gICAgIC0gaGFuZGxlciAoZnVuY3Rpb24pIGhhbmRsZXIgZm9yIHRoZSBldmVudFxuICAgICA9IChvYmplY3QpIEBFbGVtZW50XG4gICAgXFwqL1xuICAgIC8qXFxcbiAgICAgKiBFbGVtZW50LnVudG91Y2hlbmRcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIFJlbW92ZXMgZXZlbnQgaGFuZGxlciBmb3IgdG91Y2hlbmQgZm9yIHRoZSBlbGVtZW50LlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgLSBoYW5kbGVyIChmdW5jdGlvbikgI29wdGlvbmFsIGhhbmRsZXIgZm9yIHRoZSBldmVudFxuICAgICA9IChvYmplY3QpIEBFbGVtZW50XG4gICAgXFwqL1xuXG4gICAgLypcXFxuICAgICAqIEVsZW1lbnQudG91Y2hjYW5jZWxcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIEFkZHMgZXZlbnQgaGFuZGxlciBmb3IgdG91Y2hjYW5jZWwgZm9yIHRoZSBlbGVtZW50LlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgLSBoYW5kbGVyIChmdW5jdGlvbikgaGFuZGxlciBmb3IgdGhlIGV2ZW50XG4gICAgID0gKG9iamVjdCkgQEVsZW1lbnRcbiAgICBcXCovXG4gICAgLypcXFxuICAgICAqIEVsZW1lbnQudW50b3VjaGNhbmNlbFxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogUmVtb3ZlcyBldmVudCBoYW5kbGVyIGZvciB0b3VjaGNhbmNlbCBmb3IgdGhlIGVsZW1lbnQuXG4gICAgID4gUGFyYW1ldGVyc1xuICAgICAtIGhhbmRsZXIgKGZ1bmN0aW9uKSAjb3B0aW9uYWwgaGFuZGxlciBmb3IgdGhlIGV2ZW50XG4gICAgID0gKG9iamVjdCkgQEVsZW1lbnRcbiAgICBcXCovXG4gICAgZm9yICh2YXIgaSA9IGV2ZW50cy5sZW5ndGg7IGktLTspIHtcbiAgICAgICAgKGZ1bmN0aW9uIChldmVudE5hbWUpIHtcbiAgICAgICAgICAgIFJbZXZlbnROYW1lXSA9IGVscHJvdG9bZXZlbnROYW1lXSA9IGZ1bmN0aW9uIChmbiwgc2NvcGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoUi5pcyhmbiwgXCJmdW5jdGlvblwiKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmV2ZW50cyA9IHRoaXMuZXZlbnRzIHx8IFtdO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmV2ZW50cy5wdXNoKHtuYW1lOiBldmVudE5hbWUsIGY6IGZuLCB1bmJpbmQ6IGFkZEV2ZW50KHRoaXMuc2hhcGUgfHwgdGhpcy5ub2RlIHx8IGcuZG9jLCBldmVudE5hbWUsIGZuLCBzY29wZSB8fCB0aGlzKX0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBSW1widW5cIiArIGV2ZW50TmFtZV0gPSBlbHByb3RvW1widW5cIiArIGV2ZW50TmFtZV0gPSBmdW5jdGlvbiAoZm4pIHtcbiAgICAgICAgICAgICAgICB2YXIgZXZlbnRzID0gdGhpcy5ldmVudHMgfHwgW10sXG4gICAgICAgICAgICAgICAgICAgIGwgPSBldmVudHMubGVuZ3RoO1xuICAgICAgICAgICAgICAgIHdoaWxlIChsLS0pe1xuICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnRzW2xdLm5hbWUgPT0gZXZlbnROYW1lICYmIChSLmlzKGZuLCBcInVuZGVmaW5lZFwiKSB8fCBldmVudHNbbF0uZiA9PSBmbikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50c1tsXS51bmJpbmQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50cy5zcGxpY2UobCwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAhZXZlbnRzLmxlbmd0aCAmJiBkZWxldGUgdGhpcy5ldmVudHM7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KShldmVudHNbaV0pO1xuICAgIH1cblxuICAgIC8qXFxcbiAgICAgKiBFbGVtZW50LmRhdGFcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIEFkZHMgb3IgcmV0cmlldmVzIGdpdmVuIHZhbHVlIGFzc29jaWF0ZWQgd2l0aCBnaXZlbiBrZXkuXG4gICAgICoqXG4gICAgICogU2VlIGFsc28gQEVsZW1lbnQucmVtb3ZlRGF0YVxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgLSBrZXkgKHN0cmluZykga2V5IHRvIHN0b3JlIGRhdGFcbiAgICAgLSB2YWx1ZSAoYW55KSAjb3B0aW9uYWwgdmFsdWUgdG8gc3RvcmVcbiAgICAgPSAob2JqZWN0KSBARWxlbWVudFxuICAgICAqIG9yLCBpZiB2YWx1ZSBpcyBub3Qgc3BlY2lmaWVkOlxuICAgICA9IChhbnkpIHZhbHVlXG4gICAgICogb3IsIGlmIGtleSBhbmQgdmFsdWUgYXJlIG5vdCBzcGVjaWZpZWQ6XG4gICAgID0gKG9iamVjdCkgS2V5L3ZhbHVlIHBhaXJzIGZvciBhbGwgdGhlIGRhdGEgYXNzb2NpYXRlZCB3aXRoIHRoZSBlbGVtZW50LlxuICAgICA+IFVzYWdlXG4gICAgIHwgZm9yICh2YXIgaSA9IDAsIGkgPCA1LCBpKyspIHtcbiAgICAgfCAgICAgcGFwZXIuY2lyY2xlKDEwICsgMTUgKiBpLCAxMCwgMTApXG4gICAgIHwgICAgICAgICAgLmF0dHIoe2ZpbGw6IFwiIzAwMFwifSlcbiAgICAgfCAgICAgICAgICAuZGF0YShcImlcIiwgaSlcbiAgICAgfCAgICAgICAgICAuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICB8ICAgICAgICAgICAgIGFsZXJ0KHRoaXMuZGF0YShcImlcIikpO1xuICAgICB8ICAgICAgICAgIH0pO1xuICAgICB8IH1cbiAgICBcXCovXG4gICAgZWxwcm90by5kYXRhID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcbiAgICAgICAgdmFyIGRhdGEgPSBlbGRhdGFbdGhpcy5pZF0gPSBlbGRhdGFbdGhpcy5pZF0gfHwge307XG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09IDEpIHtcbiAgICAgICAgICAgIGlmIChSLmlzKGtleSwgXCJvYmplY3RcIikpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpIGluIGtleSkgaWYgKGtleVtoYXNdKGkpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YShpLCBrZXlbaV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGV2ZShcInJhcGhhZWwuZGF0YS5nZXQuXCIgKyB0aGlzLmlkLCB0aGlzLCBkYXRhW2tleV0sIGtleSk7XG4gICAgICAgICAgICByZXR1cm4gZGF0YVtrZXldO1xuICAgICAgICB9XG4gICAgICAgIGRhdGFba2V5XSA9IHZhbHVlO1xuICAgICAgICBldmUoXCJyYXBoYWVsLmRhdGEuc2V0LlwiICsgdGhpcy5pZCwgdGhpcywgdmFsdWUsIGtleSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIEVsZW1lbnQucmVtb3ZlRGF0YVxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogUmVtb3ZlcyB2YWx1ZSBhc3NvY2lhdGVkIHdpdGggYW4gZWxlbWVudCBieSBnaXZlbiBrZXkuXG4gICAgICogSWYga2V5IGlzIG5vdCBwcm92aWRlZCwgcmVtb3ZlcyBhbGwgdGhlIGRhdGEgb2YgdGhlIGVsZW1lbnQuXG4gICAgID4gUGFyYW1ldGVyc1xuICAgICAtIGtleSAoc3RyaW5nKSAjb3B0aW9uYWwga2V5XG4gICAgID0gKG9iamVjdCkgQEVsZW1lbnRcbiAgICBcXCovXG4gICAgZWxwcm90by5yZW1vdmVEYXRhID0gZnVuY3Rpb24gKGtleSkge1xuICAgICAgICBpZiAoa2V5ID09IG51bGwpIHtcbiAgICAgICAgICAgIGRlbGV0ZSBlbGRhdGFbdGhpcy5pZF07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBlbGRhdGFbdGhpcy5pZF0gJiYgZGVsZXRlIGVsZGF0YVt0aGlzLmlkXVtrZXldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgIC8qXFxcbiAgICAgKiBFbGVtZW50LmdldERhdGFcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIFJldHJpZXZlcyB0aGUgZWxlbWVudCBkYXRhXG4gICAgID0gKG9iamVjdCkgZGF0YVxuICAgIFxcKi9cbiAgICBlbHByb3RvLmdldERhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBjbG9uZShlbGRhdGFbdGhpcy5pZF0gfHwge30pO1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIEVsZW1lbnQuaG92ZXJcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIEFkZHMgZXZlbnQgaGFuZGxlcnMgZm9yIGhvdmVyIGZvciB0aGUgZWxlbWVudC5cbiAgICAgPiBQYXJhbWV0ZXJzXG4gICAgIC0gZl9pbiAoZnVuY3Rpb24pIGhhbmRsZXIgZm9yIGhvdmVyIGluXG4gICAgIC0gZl9vdXQgKGZ1bmN0aW9uKSBoYW5kbGVyIGZvciBob3ZlciBvdXRcbiAgICAgLSBpY29udGV4dCAob2JqZWN0KSAjb3B0aW9uYWwgY29udGV4dCBmb3IgaG92ZXIgaW4gaGFuZGxlclxuICAgICAtIG9jb250ZXh0IChvYmplY3QpICNvcHRpb25hbCBjb250ZXh0IGZvciBob3ZlciBvdXQgaGFuZGxlclxuICAgICA9IChvYmplY3QpIEBFbGVtZW50XG4gICAgXFwqL1xuICAgIGVscHJvdG8uaG92ZXIgPSBmdW5jdGlvbiAoZl9pbiwgZl9vdXQsIHNjb3BlX2luLCBzY29wZV9vdXQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubW91c2VvdmVyKGZfaW4sIHNjb3BlX2luKS5tb3VzZW91dChmX291dCwgc2NvcGVfb3V0IHx8IHNjb3BlX2luKTtcbiAgICB9O1xuICAgIC8qXFxcbiAgICAgKiBFbGVtZW50LnVuaG92ZXJcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIFJlbW92ZXMgZXZlbnQgaGFuZGxlcnMgZm9yIGhvdmVyIGZvciB0aGUgZWxlbWVudC5cbiAgICAgPiBQYXJhbWV0ZXJzXG4gICAgIC0gZl9pbiAoZnVuY3Rpb24pIGhhbmRsZXIgZm9yIGhvdmVyIGluXG4gICAgIC0gZl9vdXQgKGZ1bmN0aW9uKSBoYW5kbGVyIGZvciBob3ZlciBvdXRcbiAgICAgPSAob2JqZWN0KSBARWxlbWVudFxuICAgIFxcKi9cbiAgICBlbHByb3RvLnVuaG92ZXIgPSBmdW5jdGlvbiAoZl9pbiwgZl9vdXQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudW5tb3VzZW92ZXIoZl9pbikudW5tb3VzZW91dChmX291dCk7XG4gICAgfTtcbiAgICB2YXIgZHJhZ2dhYmxlID0gW107XG4gICAgLypcXFxuICAgICAqIEVsZW1lbnQuZHJhZ1xuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogQWRkcyBldmVudCBoYW5kbGVycyBmb3IgZHJhZyBvZiB0aGUgZWxlbWVudC5cbiAgICAgPiBQYXJhbWV0ZXJzXG4gICAgIC0gb25tb3ZlIChmdW5jdGlvbikgaGFuZGxlciBmb3IgbW92aW5nXG4gICAgIC0gb25zdGFydCAoZnVuY3Rpb24pIGhhbmRsZXIgZm9yIGRyYWcgc3RhcnRcbiAgICAgLSBvbmVuZCAoZnVuY3Rpb24pIGhhbmRsZXIgZm9yIGRyYWcgZW5kXG4gICAgIC0gbWNvbnRleHQgKG9iamVjdCkgI29wdGlvbmFsIGNvbnRleHQgZm9yIG1vdmluZyBoYW5kbGVyXG4gICAgIC0gc2NvbnRleHQgKG9iamVjdCkgI29wdGlvbmFsIGNvbnRleHQgZm9yIGRyYWcgc3RhcnQgaGFuZGxlclxuICAgICAtIGVjb250ZXh0IChvYmplY3QpICNvcHRpb25hbCBjb250ZXh0IGZvciBkcmFnIGVuZCBoYW5kbGVyXG4gICAgICogQWRkaXRpb25hbGx5IGZvbGxvd2luZyBgZHJhZ2AgZXZlbnRzIHdpbGwgYmUgdHJpZ2dlcmVkOiBgZHJhZy5zdGFydC48aWQ+YCBvbiBzdGFydCxcbiAgICAgKiBgZHJhZy5lbmQuPGlkPmAgb24gZW5kIGFuZCBgZHJhZy5tb3ZlLjxpZD5gIG9uIGV2ZXJ5IG1vdmUuIFdoZW4gZWxlbWVudCB3aWxsIGJlIGRyYWdnZWQgb3ZlciBhbm90aGVyIGVsZW1lbnRcbiAgICAgKiBgZHJhZy5vdmVyLjxpZD5gIHdpbGwgYmUgZmlyZWQgYXMgd2VsbC5cbiAgICAgKlxuICAgICAqIFN0YXJ0IGV2ZW50IGFuZCBzdGFydCBoYW5kbGVyIHdpbGwgYmUgY2FsbGVkIGluIHNwZWNpZmllZCBjb250ZXh0IG9yIGluIGNvbnRleHQgb2YgdGhlIGVsZW1lbnQgd2l0aCBmb2xsb3dpbmcgcGFyYW1ldGVyczpcbiAgICAgbyB4IChudW1iZXIpIHggcG9zaXRpb24gb2YgdGhlIG1vdXNlXG4gICAgIG8geSAobnVtYmVyKSB5IHBvc2l0aW9uIG9mIHRoZSBtb3VzZVxuICAgICBvIGV2ZW50IChvYmplY3QpIERPTSBldmVudCBvYmplY3RcbiAgICAgKiBNb3ZlIGV2ZW50IGFuZCBtb3ZlIGhhbmRsZXIgd2lsbCBiZSBjYWxsZWQgaW4gc3BlY2lmaWVkIGNvbnRleHQgb3IgaW4gY29udGV4dCBvZiB0aGUgZWxlbWVudCB3aXRoIGZvbGxvd2luZyBwYXJhbWV0ZXJzOlxuICAgICBvIGR4IChudW1iZXIpIHNoaWZ0IGJ5IHggZnJvbSB0aGUgc3RhcnQgcG9pbnRcbiAgICAgbyBkeSAobnVtYmVyKSBzaGlmdCBieSB5IGZyb20gdGhlIHN0YXJ0IHBvaW50XG4gICAgIG8geCAobnVtYmVyKSB4IHBvc2l0aW9uIG9mIHRoZSBtb3VzZVxuICAgICBvIHkgKG51bWJlcikgeSBwb3NpdGlvbiBvZiB0aGUgbW91c2VcbiAgICAgbyBldmVudCAob2JqZWN0KSBET00gZXZlbnQgb2JqZWN0XG4gICAgICogRW5kIGV2ZW50IGFuZCBlbmQgaGFuZGxlciB3aWxsIGJlIGNhbGxlZCBpbiBzcGVjaWZpZWQgY29udGV4dCBvciBpbiBjb250ZXh0IG9mIHRoZSBlbGVtZW50IHdpdGggZm9sbG93aW5nIHBhcmFtZXRlcnM6XG4gICAgIG8gZXZlbnQgKG9iamVjdCkgRE9NIGV2ZW50IG9iamVjdFxuICAgICA9IChvYmplY3QpIEBFbGVtZW50XG4gICAgXFwqL1xuICAgIGVscHJvdG8uZHJhZyA9IGZ1bmN0aW9uIChvbm1vdmUsIG9uc3RhcnQsIG9uZW5kLCBtb3ZlX3Njb3BlLCBzdGFydF9zY29wZSwgZW5kX3Njb3BlKSB7XG4gICAgICAgIGZ1bmN0aW9uIHN0YXJ0KGUpIHtcbiAgICAgICAgICAgIChlLm9yaWdpbmFsRXZlbnQgfHwgZSkucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHZhciB4ID0gZS5jbGllbnRYLFxuICAgICAgICAgICAgICAgIHkgPSBlLmNsaWVudFksXG4gICAgICAgICAgICAgICAgc2Nyb2xsWSA9IGcuZG9jLmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3AgfHwgZy5kb2MuYm9keS5zY3JvbGxUb3AsXG4gICAgICAgICAgICAgICAgc2Nyb2xsWCA9IGcuZG9jLmRvY3VtZW50RWxlbWVudC5zY3JvbGxMZWZ0IHx8IGcuZG9jLmJvZHkuc2Nyb2xsTGVmdDtcbiAgICAgICAgICAgIHRoaXMuX2RyYWcuaWQgPSBlLmlkZW50aWZpZXI7XG4gICAgICAgICAgICBpZiAoc3VwcG9ydHNUb3VjaCAmJiBlLnRvdWNoZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgaSA9IGUudG91Y2hlcy5sZW5ndGgsIHRvdWNoO1xuICAgICAgICAgICAgICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgICAgICAgICAgICAgdG91Y2ggPSBlLnRvdWNoZXNbaV07XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2RyYWcuaWQgPSB0b3VjaC5pZGVudGlmaWVyO1xuICAgICAgICAgICAgICAgICAgICBpZiAodG91Y2guaWRlbnRpZmllciA9PSB0aGlzLl9kcmFnLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB4ID0gdG91Y2guY2xpZW50WDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHkgPSB0b3VjaC5jbGllbnRZO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9kcmFnLnggPSB4ICsgc2Nyb2xsWDtcbiAgICAgICAgICAgIHRoaXMuX2RyYWcueSA9IHkgKyBzY3JvbGxZO1xuICAgICAgICAgICAgIWRyYWcubGVuZ3RoICYmIFIubW91c2Vtb3ZlKGRyYWdNb3ZlKS5tb3VzZXVwKGRyYWdVcCk7XG4gICAgICAgICAgICBkcmFnLnB1c2goe2VsOiB0aGlzLCBtb3ZlX3Njb3BlOiBtb3ZlX3Njb3BlLCBzdGFydF9zY29wZTogc3RhcnRfc2NvcGUsIGVuZF9zY29wZTogZW5kX3Njb3BlfSk7XG4gICAgICAgICAgICBvbnN0YXJ0ICYmIGV2ZS5vbihcInJhcGhhZWwuZHJhZy5zdGFydC5cIiArIHRoaXMuaWQsIG9uc3RhcnQpO1xuICAgICAgICAgICAgb25tb3ZlICYmIGV2ZS5vbihcInJhcGhhZWwuZHJhZy5tb3ZlLlwiICsgdGhpcy5pZCwgb25tb3ZlKTtcbiAgICAgICAgICAgIG9uZW5kICYmIGV2ZS5vbihcInJhcGhhZWwuZHJhZy5lbmQuXCIgKyB0aGlzLmlkLCBvbmVuZCk7XG4gICAgICAgICAgICBldmUoXCJyYXBoYWVsLmRyYWcuc3RhcnQuXCIgKyB0aGlzLmlkLCBzdGFydF9zY29wZSB8fCBtb3ZlX3Njb3BlIHx8IHRoaXMsIHRoaXMuX2RyYWcueCwgdGhpcy5fZHJhZy55LCBlKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9kcmFnID0ge307XG4gICAgICAgIGRyYWdnYWJsZS5wdXNoKHtlbDogdGhpcywgc3RhcnQ6IHN0YXJ0fSk7XG4gICAgICAgIHRoaXMubW91c2Vkb3duKHN0YXJ0KTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICAvKlxcXG4gICAgICogRWxlbWVudC5vbkRyYWdPdmVyXG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBTaG9ydGN1dCBmb3IgYXNzaWduaW5nIGV2ZW50IGhhbmRsZXIgZm9yIGBkcmFnLm92ZXIuPGlkPmAgZXZlbnQsIHdoZXJlIGlkIGlzIGlkIG9mIHRoZSBlbGVtZW50IChzZWUgQEVsZW1lbnQuaWQpLlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgLSBmIChmdW5jdGlvbikgaGFuZGxlciBmb3IgZXZlbnQsIGZpcnN0IGFyZ3VtZW50IHdvdWxkIGJlIHRoZSBlbGVtZW50IHlvdSBhcmUgZHJhZ2dpbmcgb3ZlclxuICAgIFxcKi9cbiAgICBlbHByb3RvLm9uRHJhZ092ZXIgPSBmdW5jdGlvbiAoZikge1xuICAgICAgICBmID8gZXZlLm9uKFwicmFwaGFlbC5kcmFnLm92ZXIuXCIgKyB0aGlzLmlkLCBmKSA6IGV2ZS51bmJpbmQoXCJyYXBoYWVsLmRyYWcub3Zlci5cIiArIHRoaXMuaWQpO1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIEVsZW1lbnQudW5kcmFnXG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBSZW1vdmVzIGFsbCBkcmFnIGV2ZW50IGhhbmRsZXJzIGZyb20gZ2l2ZW4gZWxlbWVudC5cbiAgICBcXCovXG4gICAgZWxwcm90by51bmRyYWcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBpID0gZHJhZ2dhYmxlLmxlbmd0aDtcbiAgICAgICAgd2hpbGUgKGktLSkgaWYgKGRyYWdnYWJsZVtpXS5lbCA9PSB0aGlzKSB7XG4gICAgICAgICAgICB0aGlzLnVubW91c2Vkb3duKGRyYWdnYWJsZVtpXS5zdGFydCk7XG4gICAgICAgICAgICBkcmFnZ2FibGUuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgZXZlLnVuYmluZChcInJhcGhhZWwuZHJhZy4qLlwiICsgdGhpcy5pZCk7XG4gICAgICAgIH1cbiAgICAgICAgIWRyYWdnYWJsZS5sZW5ndGggJiYgUi51bm1vdXNlbW92ZShkcmFnTW92ZSkudW5tb3VzZXVwKGRyYWdVcCk7XG4gICAgICAgIGRyYWcgPSBbXTtcbiAgICB9O1xuICAgIC8qXFxcbiAgICAgKiBQYXBlci5jaXJjbGVcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIERyYXdzIGEgY2lyY2xlLlxuICAgICAqKlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgKipcbiAgICAgLSB4IChudW1iZXIpIHggY29vcmRpbmF0ZSBvZiB0aGUgY2VudHJlXG4gICAgIC0geSAobnVtYmVyKSB5IGNvb3JkaW5hdGUgb2YgdGhlIGNlbnRyZVxuICAgICAtIHIgKG51bWJlcikgcmFkaXVzXG4gICAgID0gKG9iamVjdCkgUmFwaGHDq2wgZWxlbWVudCBvYmplY3Qgd2l0aCB0eXBlIOKAnGNpcmNsZeKAnVxuICAgICAqKlxuICAgICA+IFVzYWdlXG4gICAgIHwgdmFyIGMgPSBwYXBlci5jaXJjbGUoNTAsIDUwLCA0MCk7XG4gICAgXFwqL1xuICAgIHBhcGVycHJvdG8uY2lyY2xlID0gZnVuY3Rpb24gKHgsIHksIHIpIHtcbiAgICAgICAgdmFyIG91dCA9IFIuX2VuZ2luZS5jaXJjbGUodGhpcywgeCB8fCAwLCB5IHx8IDAsIHIgfHwgMCk7XG4gICAgICAgIHRoaXMuX19zZXRfXyAmJiB0aGlzLl9fc2V0X18ucHVzaChvdXQpO1xuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIFBhcGVyLnJlY3RcbiAgICAgWyBtZXRob2QgXVxuICAgICAqXG4gICAgICogRHJhd3MgYSByZWN0YW5nbGUuXG4gICAgICoqXG4gICAgID4gUGFyYW1ldGVyc1xuICAgICAqKlxuICAgICAtIHggKG51bWJlcikgeCBjb29yZGluYXRlIG9mIHRoZSB0b3AgbGVmdCBjb3JuZXJcbiAgICAgLSB5IChudW1iZXIpIHkgY29vcmRpbmF0ZSBvZiB0aGUgdG9wIGxlZnQgY29ybmVyXG4gICAgIC0gd2lkdGggKG51bWJlcikgd2lkdGhcbiAgICAgLSBoZWlnaHQgKG51bWJlcikgaGVpZ2h0XG4gICAgIC0gciAobnVtYmVyKSAjb3B0aW9uYWwgcmFkaXVzIGZvciByb3VuZGVkIGNvcm5lcnMsIGRlZmF1bHQgaXMgMFxuICAgICA9IChvYmplY3QpIFJhcGhhw6tsIGVsZW1lbnQgb2JqZWN0IHdpdGggdHlwZSDigJxyZWN04oCdXG4gICAgICoqXG4gICAgID4gVXNhZ2VcbiAgICAgfCAvLyByZWd1bGFyIHJlY3RhbmdsZVxuICAgICB8IHZhciBjID0gcGFwZXIucmVjdCgxMCwgMTAsIDUwLCA1MCk7XG4gICAgIHwgLy8gcmVjdGFuZ2xlIHdpdGggcm91bmRlZCBjb3JuZXJzXG4gICAgIHwgdmFyIGMgPSBwYXBlci5yZWN0KDQwLCA0MCwgNTAsIDUwLCAxMCk7XG4gICAgXFwqL1xuICAgIHBhcGVycHJvdG8ucmVjdCA9IGZ1bmN0aW9uICh4LCB5LCB3LCBoLCByKSB7XG4gICAgICAgIHZhciBvdXQgPSBSLl9lbmdpbmUucmVjdCh0aGlzLCB4IHx8IDAsIHkgfHwgMCwgdyB8fCAwLCBoIHx8IDAsIHIgfHwgMCk7XG4gICAgICAgIHRoaXMuX19zZXRfXyAmJiB0aGlzLl9fc2V0X18ucHVzaChvdXQpO1xuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIFBhcGVyLmVsbGlwc2VcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIERyYXdzIGFuIGVsbGlwc2UuXG4gICAgICoqXG4gICAgID4gUGFyYW1ldGVyc1xuICAgICAqKlxuICAgICAtIHggKG51bWJlcikgeCBjb29yZGluYXRlIG9mIHRoZSBjZW50cmVcbiAgICAgLSB5IChudW1iZXIpIHkgY29vcmRpbmF0ZSBvZiB0aGUgY2VudHJlXG4gICAgIC0gcnggKG51bWJlcikgaG9yaXpvbnRhbCByYWRpdXNcbiAgICAgLSByeSAobnVtYmVyKSB2ZXJ0aWNhbCByYWRpdXNcbiAgICAgPSAob2JqZWN0KSBSYXBoYcOrbCBlbGVtZW50IG9iamVjdCB3aXRoIHR5cGUg4oCcZWxsaXBzZeKAnVxuICAgICAqKlxuICAgICA+IFVzYWdlXG4gICAgIHwgdmFyIGMgPSBwYXBlci5lbGxpcHNlKDUwLCA1MCwgNDAsIDIwKTtcbiAgICBcXCovXG4gICAgcGFwZXJwcm90by5lbGxpcHNlID0gZnVuY3Rpb24gKHgsIHksIHJ4LCByeSkge1xuICAgICAgICB2YXIgb3V0ID0gUi5fZW5naW5lLmVsbGlwc2UodGhpcywgeCB8fCAwLCB5IHx8IDAsIHJ4IHx8IDAsIHJ5IHx8IDApO1xuICAgICAgICB0aGlzLl9fc2V0X18gJiYgdGhpcy5fX3NldF9fLnB1c2gob3V0KTtcbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xuICAgIC8qXFxcbiAgICAgKiBQYXBlci5wYXRoXG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBDcmVhdGVzIGEgcGF0aCBlbGVtZW50IGJ5IGdpdmVuIHBhdGggZGF0YSBzdHJpbmcuXG4gICAgID4gUGFyYW1ldGVyc1xuICAgICAtIHBhdGhTdHJpbmcgKHN0cmluZykgI29wdGlvbmFsIHBhdGggc3RyaW5nIGluIFNWRyBmb3JtYXQuXG4gICAgICogUGF0aCBzdHJpbmcgY29uc2lzdHMgb2Ygb25lLWxldHRlciBjb21tYW5kcywgZm9sbG93ZWQgYnkgY29tbWEgc2VwcmFyYXRlZCBhcmd1bWVudHMgaW4gbnVtZXJjYWwgZm9ybS4gRXhhbXBsZTpcbiAgICAgfCBcIk0xMCwyMEwzMCw0MFwiXG4gICAgICogSGVyZSB3ZSBjYW4gc2VlIHR3byBjb21tYW5kczog4oCcTeKAnSwgd2l0aCBhcmd1bWVudHMgYCgxMCwgMjApYCBhbmQg4oCcTOKAnSB3aXRoIGFyZ3VtZW50cyBgKDMwLCA0MClgLiBVcHBlciBjYXNlIGxldHRlciBtZWFuIGNvbW1hbmQgaXMgYWJzb2x1dGUsIGxvd2VyIGNhc2XigJRyZWxhdGl2ZS5cbiAgICAgKlxuICAgICAjIDxwPkhlcmUgaXMgc2hvcnQgbGlzdCBvZiBjb21tYW5kcyBhdmFpbGFibGUsIGZvciBtb3JlIGRldGFpbHMgc2VlIDxhIGhyZWY9XCJodHRwOi8vd3d3LnczLm9yZy9UUi9TVkcvcGF0aHMuaHRtbCNQYXRoRGF0YVwiIHRpdGxlPVwiRGV0YWlscyBvZiBhIHBhdGgncyBkYXRhIGF0dHJpYnV0ZSdzIGZvcm1hdCBhcmUgZGVzY3JpYmVkIGluIHRoZSBTVkcgc3BlY2lmaWNhdGlvbi5cIj5TVkcgcGF0aCBzdHJpbmcgZm9ybWF0PC9hPi48L3A+XG4gICAgICMgPHRhYmxlPjx0aGVhZD48dHI+PHRoPkNvbW1hbmQ8L3RoPjx0aD5OYW1lPC90aD48dGg+UGFyYW1ldGVyczwvdGg+PC90cj48L3RoZWFkPjx0Ym9keT5cbiAgICAgIyA8dHI+PHRkPk08L3RkPjx0ZD5tb3ZldG88L3RkPjx0ZD4oeCB5KSs8L3RkPjwvdHI+XG4gICAgICMgPHRyPjx0ZD5aPC90ZD48dGQ+Y2xvc2VwYXRoPC90ZD48dGQ+KG5vbmUpPC90ZD48L3RyPlxuICAgICAjIDx0cj48dGQ+TDwvdGQ+PHRkPmxpbmV0bzwvdGQ+PHRkPih4IHkpKzwvdGQ+PC90cj5cbiAgICAgIyA8dHI+PHRkPkg8L3RkPjx0ZD5ob3Jpem9udGFsIGxpbmV0bzwvdGQ+PHRkPngrPC90ZD48L3RyPlxuICAgICAjIDx0cj48dGQ+VjwvdGQ+PHRkPnZlcnRpY2FsIGxpbmV0bzwvdGQ+PHRkPnkrPC90ZD48L3RyPlxuICAgICAjIDx0cj48dGQ+QzwvdGQ+PHRkPmN1cnZldG88L3RkPjx0ZD4oeDEgeTEgeDIgeTIgeCB5KSs8L3RkPjwvdHI+XG4gICAgICMgPHRyPjx0ZD5TPC90ZD48dGQ+c21vb3RoIGN1cnZldG88L3RkPjx0ZD4oeDIgeTIgeCB5KSs8L3RkPjwvdHI+XG4gICAgICMgPHRyPjx0ZD5RPC90ZD48dGQ+cXVhZHJhdGljIELDqXppZXIgY3VydmV0bzwvdGQ+PHRkPih4MSB5MSB4IHkpKzwvdGQ+PC90cj5cbiAgICAgIyA8dHI+PHRkPlQ8L3RkPjx0ZD5zbW9vdGggcXVhZHJhdGljIELDqXppZXIgY3VydmV0bzwvdGQ+PHRkPih4IHkpKzwvdGQ+PC90cj5cbiAgICAgIyA8dHI+PHRkPkE8L3RkPjx0ZD5lbGxpcHRpY2FsIGFyYzwvdGQ+PHRkPihyeCByeSB4LWF4aXMtcm90YXRpb24gbGFyZ2UtYXJjLWZsYWcgc3dlZXAtZmxhZyB4IHkpKzwvdGQ+PC90cj5cbiAgICAgIyA8dHI+PHRkPlI8L3RkPjx0ZD48YSBocmVmPVwiaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9DYXRtdWxs4oCTUm9tX3NwbGluZSNDYXRtdWxsLkUyLjgwLjkzUm9tX3NwbGluZVwiPkNhdG11bGwtUm9tIGN1cnZldG88L2E+KjwvdGQ+PHRkPngxIHkxICh4IHkpKzwvdGQ+PC90cj48L3Rib2R5PjwvdGFibGU+XG4gICAgICogKiDigJxDYXRtdWxsLVJvbSBjdXJ2ZXRv4oCdIGlzIGEgbm90IHN0YW5kYXJkIFNWRyBjb21tYW5kIGFuZCBhZGRlZCBpbiAyLjAgdG8gbWFrZSBsaWZlIGVhc2llci5cbiAgICAgKiBOb3RlOiB0aGVyZSBpcyBhIHNwZWNpYWwgY2FzZSB3aGVuIHBhdGggY29uc2lzdCBvZiBqdXN0IHRocmVlIGNvbW1hbmRzOiDigJxNMTAsMTBS4oCmeuKAnS4gSW4gdGhpcyBjYXNlIHBhdGggd2lsbCBzbW9vdGhseSBjb25uZWN0cyB0byBpdHMgYmVnaW5uaW5nLlxuICAgICA+IFVzYWdlXG4gICAgIHwgdmFyIGMgPSBwYXBlci5wYXRoKFwiTTEwIDEwTDkwIDkwXCIpO1xuICAgICB8IC8vIGRyYXcgYSBkaWFnb25hbCBsaW5lOlxuICAgICB8IC8vIG1vdmUgdG8gMTAsMTAsIGxpbmUgdG8gOTAsOTBcbiAgICAgKiBGb3IgZXhhbXBsZSBvZiBwYXRoIHN0cmluZ3MsIGNoZWNrIG91dCB0aGVzZSBpY29uczogaHR0cDovL3JhcGhhZWxqcy5jb20vaWNvbnMvXG4gICAgXFwqL1xuICAgIHBhcGVycHJvdG8ucGF0aCA9IGZ1bmN0aW9uIChwYXRoU3RyaW5nKSB7XG4gICAgICAgIHBhdGhTdHJpbmcgJiYgIVIuaXMocGF0aFN0cmluZywgc3RyaW5nKSAmJiAhUi5pcyhwYXRoU3RyaW5nWzBdLCBhcnJheSkgJiYgKHBhdGhTdHJpbmcgKz0gRSk7XG4gICAgICAgIHZhciBvdXQgPSBSLl9lbmdpbmUucGF0aChSLmZvcm1hdFthcHBseV0oUiwgYXJndW1lbnRzKSwgdGhpcyk7XG4gICAgICAgIHRoaXMuX19zZXRfXyAmJiB0aGlzLl9fc2V0X18ucHVzaChvdXQpO1xuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIFBhcGVyLmltYWdlXG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBFbWJlZHMgYW4gaW1hZ2UgaW50byB0aGUgc3VyZmFjZS5cbiAgICAgKipcbiAgICAgPiBQYXJhbWV0ZXJzXG4gICAgICoqXG4gICAgIC0gc3JjIChzdHJpbmcpIFVSSSBvZiB0aGUgc291cmNlIGltYWdlXG4gICAgIC0geCAobnVtYmVyKSB4IGNvb3JkaW5hdGUgcG9zaXRpb25cbiAgICAgLSB5IChudW1iZXIpIHkgY29vcmRpbmF0ZSBwb3NpdGlvblxuICAgICAtIHdpZHRoIChudW1iZXIpIHdpZHRoIG9mIHRoZSBpbWFnZVxuICAgICAtIGhlaWdodCAobnVtYmVyKSBoZWlnaHQgb2YgdGhlIGltYWdlXG4gICAgID0gKG9iamVjdCkgUmFwaGHDq2wgZWxlbWVudCBvYmplY3Qgd2l0aCB0eXBlIOKAnGltYWdl4oCdXG4gICAgICoqXG4gICAgID4gVXNhZ2VcbiAgICAgfCB2YXIgYyA9IHBhcGVyLmltYWdlKFwiYXBwbGUucG5nXCIsIDEwLCAxMCwgODAsIDgwKTtcbiAgICBcXCovXG4gICAgcGFwZXJwcm90by5pbWFnZSA9IGZ1bmN0aW9uIChzcmMsIHgsIHksIHcsIGgpIHtcbiAgICAgICAgdmFyIG91dCA9IFIuX2VuZ2luZS5pbWFnZSh0aGlzLCBzcmMgfHwgXCJhYm91dDpibGFua1wiLCB4IHx8IDAsIHkgfHwgMCwgdyB8fCAwLCBoIHx8IDApO1xuICAgICAgICB0aGlzLl9fc2V0X18gJiYgdGhpcy5fX3NldF9fLnB1c2gob3V0KTtcbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xuICAgIC8qXFxcbiAgICAgKiBQYXBlci50ZXh0XG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBEcmF3cyBhIHRleHQgc3RyaW5nLiBJZiB5b3UgbmVlZCBsaW5lIGJyZWFrcywgcHV0IOKAnFxcbuKAnSBpbiB0aGUgc3RyaW5nLlxuICAgICAqKlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgKipcbiAgICAgLSB4IChudW1iZXIpIHggY29vcmRpbmF0ZSBwb3NpdGlvblxuICAgICAtIHkgKG51bWJlcikgeSBjb29yZGluYXRlIHBvc2l0aW9uXG4gICAgIC0gdGV4dCAoc3RyaW5nKSBUaGUgdGV4dCBzdHJpbmcgdG8gZHJhd1xuICAgICA9IChvYmplY3QpIFJhcGhhw6tsIGVsZW1lbnQgb2JqZWN0IHdpdGggdHlwZSDigJx0ZXh04oCdXG4gICAgICoqXG4gICAgID4gVXNhZ2VcbiAgICAgfCB2YXIgdCA9IHBhcGVyLnRleHQoNTAsIDUwLCBcIlJhcGhhw6tsXFxua2lja3NcXG5idXR0IVwiKTtcbiAgICBcXCovXG4gICAgcGFwZXJwcm90by50ZXh0ID0gZnVuY3Rpb24gKHgsIHksIHRleHQpIHtcbiAgICAgICAgdmFyIG91dCA9IFIuX2VuZ2luZS50ZXh0KHRoaXMsIHggfHwgMCwgeSB8fCAwLCBTdHIodGV4dCkpO1xuICAgICAgICB0aGlzLl9fc2V0X18gJiYgdGhpcy5fX3NldF9fLnB1c2gob3V0KTtcbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xuICAgIC8qXFxcbiAgICAgKiBQYXBlci5zZXRcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIENyZWF0ZXMgYXJyYXktbGlrZSBvYmplY3QgdG8ga2VlcCBhbmQgb3BlcmF0ZSBzZXZlcmFsIGVsZW1lbnRzIGF0IG9uY2UuXG4gICAgICogV2FybmluZzogaXQgZG9lc27igJl0IGNyZWF0ZSBhbnkgZWxlbWVudHMgZm9yIGl0c2VsZiBpbiB0aGUgcGFnZSwgaXQganVzdCBncm91cHMgZXhpc3RpbmcgZWxlbWVudHMuXG4gICAgICogU2V0cyBhY3QgYXMgcHNldWRvIGVsZW1lbnRzIOKAlCBhbGwgbWV0aG9kcyBhdmFpbGFibGUgdG8gYW4gZWxlbWVudCBjYW4gYmUgdXNlZCBvbiBhIHNldC5cbiAgICAgPSAob2JqZWN0KSBhcnJheS1saWtlIG9iamVjdCB0aGF0IHJlcHJlc2VudHMgc2V0IG9mIGVsZW1lbnRzXG4gICAgICoqXG4gICAgID4gVXNhZ2VcbiAgICAgfCB2YXIgc3QgPSBwYXBlci5zZXQoKTtcbiAgICAgfCBzdC5wdXNoKFxuICAgICB8ICAgICBwYXBlci5jaXJjbGUoMTAsIDEwLCA1KSxcbiAgICAgfCAgICAgcGFwZXIuY2lyY2xlKDMwLCAxMCwgNSlcbiAgICAgfCApO1xuICAgICB8IHN0LmF0dHIoe2ZpbGw6IFwicmVkXCJ9KTsgLy8gY2hhbmdlcyB0aGUgZmlsbCBvZiBib3RoIGNpcmNsZXNcbiAgICBcXCovXG4gICAgcGFwZXJwcm90by5zZXQgPSBmdW5jdGlvbiAoaXRlbXNBcnJheSkge1xuICAgICAgICAhUi5pcyhpdGVtc0FycmF5LCBcImFycmF5XCIpICYmIChpdGVtc0FycmF5ID0gQXJyYXkucHJvdG90eXBlLnNwbGljZS5jYWxsKGFyZ3VtZW50cywgMCwgYXJndW1lbnRzLmxlbmd0aCkpO1xuICAgICAgICB2YXIgb3V0ID0gbmV3IFNldChpdGVtc0FycmF5KTtcbiAgICAgICAgdGhpcy5fX3NldF9fICYmIHRoaXMuX19zZXRfXy5wdXNoKG91dCk7XG4gICAgICAgIG91dFtcInBhcGVyXCJdID0gdGhpcztcbiAgICAgICAgb3V0W1widHlwZVwiXSA9IFwic2V0XCI7XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbiAgICAvKlxcXG4gICAgICogUGFwZXIuc2V0U3RhcnRcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIENyZWF0ZXMgQFBhcGVyLnNldC4gQWxsIGVsZW1lbnRzIHRoYXQgd2lsbCBiZSBjcmVhdGVkIGFmdGVyIGNhbGxpbmcgdGhpcyBtZXRob2QgYW5kIGJlZm9yZSBjYWxsaW5nXG4gICAgICogQFBhcGVyLnNldEZpbmlzaCB3aWxsIGJlIGFkZGVkIHRvIHRoZSBzZXQuXG4gICAgICoqXG4gICAgID4gVXNhZ2VcbiAgICAgfCBwYXBlci5zZXRTdGFydCgpO1xuICAgICB8IHBhcGVyLmNpcmNsZSgxMCwgMTAsIDUpLFxuICAgICB8IHBhcGVyLmNpcmNsZSgzMCwgMTAsIDUpXG4gICAgIHwgdmFyIHN0ID0gcGFwZXIuc2V0RmluaXNoKCk7XG4gICAgIHwgc3QuYXR0cih7ZmlsbDogXCJyZWRcIn0pOyAvLyBjaGFuZ2VzIHRoZSBmaWxsIG9mIGJvdGggY2lyY2xlc1xuICAgIFxcKi9cbiAgICBwYXBlcnByb3RvLnNldFN0YXJ0ID0gZnVuY3Rpb24gKHNldCkge1xuICAgICAgICB0aGlzLl9fc2V0X18gPSBzZXQgfHwgdGhpcy5zZXQoKTtcbiAgICB9O1xuICAgIC8qXFxcbiAgICAgKiBQYXBlci5zZXRGaW5pc2hcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIFNlZSBAUGFwZXIuc2V0U3RhcnQuIFRoaXMgbWV0aG9kIGZpbmlzaGVzIGNhdGNoaW5nIGFuZCByZXR1cm5zIHJlc3VsdGluZyBzZXQuXG4gICAgICoqXG4gICAgID0gKG9iamVjdCkgc2V0XG4gICAgXFwqL1xuICAgIHBhcGVycHJvdG8uc2V0RmluaXNoID0gZnVuY3Rpb24gKHNldCkge1xuICAgICAgICB2YXIgb3V0ID0gdGhpcy5fX3NldF9fO1xuICAgICAgICBkZWxldGUgdGhpcy5fX3NldF9fO1xuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIFBhcGVyLmdldFNpemVcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIE9idGFpbnMgY3VycmVudCBwYXBlciBhY3R1YWwgc2l6ZS5cbiAgICAgKipcbiAgICAgPSAob2JqZWN0KVxuICAgICBcXCovXG4gICAgcGFwZXJwcm90by5nZXRTaXplID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY29udGFpbmVyID0gdGhpcy5jYW52YXMucGFyZW50Tm9kZTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHdpZHRoOiBjb250YWluZXIub2Zmc2V0V2lkdGgsXG4gICAgICAgICAgICBoZWlnaHQ6IGNvbnRhaW5lci5vZmZzZXRIZWlnaHRcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgIC8qXFxcbiAgICAgKiBQYXBlci5zZXRTaXplXG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBJZiB5b3UgbmVlZCB0byBjaGFuZ2UgZGltZW5zaW9ucyBvZiB0aGUgY2FudmFzIGNhbGwgdGhpcyBtZXRob2RcbiAgICAgKipcbiAgICAgPiBQYXJhbWV0ZXJzXG4gICAgICoqXG4gICAgIC0gd2lkdGggKG51bWJlcikgbmV3IHdpZHRoIG9mIHRoZSBjYW52YXNcbiAgICAgLSBoZWlnaHQgKG51bWJlcikgbmV3IGhlaWdodCBvZiB0aGUgY2FudmFzXG4gICAgXFwqL1xuICAgIHBhcGVycHJvdG8uc2V0U2l6ZSA9IGZ1bmN0aW9uICh3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgIHJldHVybiBSLl9lbmdpbmUuc2V0U2l6ZS5jYWxsKHRoaXMsIHdpZHRoLCBoZWlnaHQpO1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIFBhcGVyLnNldFZpZXdCb3hcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIFNldHMgdGhlIHZpZXcgYm94IG9mIHRoZSBwYXBlci4gUHJhY3RpY2FsbHkgaXQgZ2l2ZXMgeW91IGFiaWxpdHkgdG8gem9vbSBhbmQgcGFuIHdob2xlIHBhcGVyIHN1cmZhY2UgYnlcbiAgICAgKiBzcGVjaWZ5aW5nIG5ldyBib3VuZGFyaWVzLlxuICAgICAqKlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgKipcbiAgICAgLSB4IChudW1iZXIpIG5ldyB4IHBvc2l0aW9uLCBkZWZhdWx0IGlzIGAwYFxuICAgICAtIHkgKG51bWJlcikgbmV3IHkgcG9zaXRpb24sIGRlZmF1bHQgaXMgYDBgXG4gICAgIC0gdyAobnVtYmVyKSBuZXcgd2lkdGggb2YgdGhlIGNhbnZhc1xuICAgICAtIGggKG51bWJlcikgbmV3IGhlaWdodCBvZiB0aGUgY2FudmFzXG4gICAgIC0gZml0IChib29sZWFuKSBgdHJ1ZWAgaWYgeW91IHdhbnQgZ3JhcGhpY3MgdG8gZml0IGludG8gbmV3IGJvdW5kYXJ5IGJveFxuICAgIFxcKi9cbiAgICBwYXBlcnByb3RvLnNldFZpZXdCb3ggPSBmdW5jdGlvbiAoeCwgeSwgdywgaCwgZml0KSB7XG4gICAgICAgIHJldHVybiBSLl9lbmdpbmUuc2V0Vmlld0JveC5jYWxsKHRoaXMsIHgsIHksIHcsIGgsIGZpdCk7XG4gICAgfTtcbiAgICAvKlxcXG4gICAgICogUGFwZXIudG9wXG4gICAgIFsgcHJvcGVydHkgXVxuICAgICAqKlxuICAgICAqIFBvaW50cyB0byB0aGUgdG9wbW9zdCBlbGVtZW50IG9uIHRoZSBwYXBlclxuICAgIFxcKi9cbiAgICAvKlxcXG4gICAgICogUGFwZXIuYm90dG9tXG4gICAgIFsgcHJvcGVydHkgXVxuICAgICAqKlxuICAgICAqIFBvaW50cyB0byB0aGUgYm90dG9tIGVsZW1lbnQgb24gdGhlIHBhcGVyXG4gICAgXFwqL1xuICAgIHBhcGVycHJvdG8udG9wID0gcGFwZXJwcm90by5ib3R0b20gPSBudWxsO1xuICAgIC8qXFxcbiAgICAgKiBQYXBlci5yYXBoYWVsXG4gICAgIFsgcHJvcGVydHkgXVxuICAgICAqKlxuICAgICAqIFBvaW50cyB0byB0aGUgQFJhcGhhZWwgb2JqZWN0L2Z1bmN0aW9uXG4gICAgXFwqL1xuICAgIHBhcGVycHJvdG8ucmFwaGFlbCA9IFI7XG4gICAgdmFyIGdldE9mZnNldCA9IGZ1bmN0aW9uIChlbGVtKSB7XG4gICAgICAgIHZhciBib3ggPSBlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxuICAgICAgICAgICAgZG9jID0gZWxlbS5vd25lckRvY3VtZW50LFxuICAgICAgICAgICAgYm9keSA9IGRvYy5ib2R5LFxuICAgICAgICAgICAgZG9jRWxlbSA9IGRvYy5kb2N1bWVudEVsZW1lbnQsXG4gICAgICAgICAgICBjbGllbnRUb3AgPSBkb2NFbGVtLmNsaWVudFRvcCB8fCBib2R5LmNsaWVudFRvcCB8fCAwLCBjbGllbnRMZWZ0ID0gZG9jRWxlbS5jbGllbnRMZWZ0IHx8IGJvZHkuY2xpZW50TGVmdCB8fCAwLFxuICAgICAgICAgICAgdG9wICA9IGJveC50b3AgICsgKGcud2luLnBhZ2VZT2Zmc2V0IHx8IGRvY0VsZW0uc2Nyb2xsVG9wIHx8IGJvZHkuc2Nyb2xsVG9wICkgLSBjbGllbnRUb3AsXG4gICAgICAgICAgICBsZWZ0ID0gYm94LmxlZnQgKyAoZy53aW4ucGFnZVhPZmZzZXQgfHwgZG9jRWxlbS5zY3JvbGxMZWZ0IHx8IGJvZHkuc2Nyb2xsTGVmdCkgLSBjbGllbnRMZWZ0O1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgeTogdG9wLFxuICAgICAgICAgICAgeDogbGVmdFxuICAgICAgICB9O1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIFBhcGVyLmdldEVsZW1lbnRCeVBvaW50XG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBSZXR1cm5zIHlvdSB0b3Btb3N0IGVsZW1lbnQgdW5kZXIgZ2l2ZW4gcG9pbnQuXG4gICAgICoqXG4gICAgID0gKG9iamVjdCkgUmFwaGHDq2wgZWxlbWVudCBvYmplY3RcbiAgICAgPiBQYXJhbWV0ZXJzXG4gICAgICoqXG4gICAgIC0geCAobnVtYmVyKSB4IGNvb3JkaW5hdGUgZnJvbSB0aGUgdG9wIGxlZnQgY29ybmVyIG9mIHRoZSB3aW5kb3dcbiAgICAgLSB5IChudW1iZXIpIHkgY29vcmRpbmF0ZSBmcm9tIHRoZSB0b3AgbGVmdCBjb3JuZXIgb2YgdGhlIHdpbmRvd1xuICAgICA+IFVzYWdlXG4gICAgIHwgcGFwZXIuZ2V0RWxlbWVudEJ5UG9pbnQobW91c2VYLCBtb3VzZVkpLmF0dHIoe3N0cm9rZTogXCIjZjAwXCJ9KTtcbiAgICBcXCovXG4gICAgcGFwZXJwcm90by5nZXRFbGVtZW50QnlQb2ludCA9IGZ1bmN0aW9uICh4LCB5KSB7XG4gICAgICAgIHZhciBwYXBlciA9IHRoaXMsXG4gICAgICAgICAgICBzdmcgPSBwYXBlci5jYW52YXMsXG4gICAgICAgICAgICB0YXJnZXQgPSBnLmRvYy5lbGVtZW50RnJvbVBvaW50KHgsIHkpO1xuICAgICAgICBpZiAoZy53aW4ub3BlcmEgJiYgdGFyZ2V0LnRhZ05hbWUgPT0gXCJzdmdcIikge1xuICAgICAgICAgICAgdmFyIHNvID0gZ2V0T2Zmc2V0KHN2ZyksXG4gICAgICAgICAgICAgICAgc3IgPSBzdmcuY3JlYXRlU1ZHUmVjdCgpO1xuICAgICAgICAgICAgc3IueCA9IHggLSBzby54O1xuICAgICAgICAgICAgc3IueSA9IHkgLSBzby55O1xuICAgICAgICAgICAgc3Iud2lkdGggPSBzci5oZWlnaHQgPSAxO1xuICAgICAgICAgICAgdmFyIGhpdHMgPSBzdmcuZ2V0SW50ZXJzZWN0aW9uTGlzdChzciwgbnVsbCk7XG4gICAgICAgICAgICBpZiAoaGl0cy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0YXJnZXQgPSBoaXRzW2hpdHMubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0YXJnZXQpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHdoaWxlICh0YXJnZXQucGFyZW50Tm9kZSAmJiB0YXJnZXQgIT0gc3ZnLnBhcmVudE5vZGUgJiYgIXRhcmdldC5yYXBoYWVsKSB7XG4gICAgICAgICAgICB0YXJnZXQgPSB0YXJnZXQucGFyZW50Tm9kZTtcbiAgICAgICAgfVxuICAgICAgICB0YXJnZXQgPT0gcGFwZXIuY2FudmFzLnBhcmVudE5vZGUgJiYgKHRhcmdldCA9IHN2Zyk7XG4gICAgICAgIHRhcmdldCA9IHRhcmdldCAmJiB0YXJnZXQucmFwaGFlbCA/IHBhcGVyLmdldEJ5SWQodGFyZ2V0LnJhcGhhZWxpZCkgOiBudWxsO1xuICAgICAgICByZXR1cm4gdGFyZ2V0O1xuICAgIH07XG5cbiAgICAvKlxcXG4gICAgICogUGFwZXIuZ2V0RWxlbWVudHNCeUJCb3hcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIFJldHVybnMgc2V0IG9mIGVsZW1lbnRzIHRoYXQgaGF2ZSBhbiBpbnRlcnNlY3RpbmcgYm91bmRpbmcgYm94XG4gICAgICoqXG4gICAgID4gUGFyYW1ldGVyc1xuICAgICAqKlxuICAgICAtIGJib3ggKG9iamVjdCkgYmJveCB0byBjaGVjayB3aXRoXG4gICAgID0gKG9iamVjdCkgQFNldFxuICAgICBcXCovXG4gICAgcGFwZXJwcm90by5nZXRFbGVtZW50c0J5QkJveCA9IGZ1bmN0aW9uIChiYm94KSB7XG4gICAgICAgIHZhciBzZXQgPSB0aGlzLnNldCgpO1xuICAgICAgICB0aGlzLmZvckVhY2goZnVuY3Rpb24gKGVsKSB7XG4gICAgICAgICAgICBpZiAoUi5pc0JCb3hJbnRlcnNlY3QoZWwuZ2V0QkJveCgpLCBiYm94KSkge1xuICAgICAgICAgICAgICAgIHNldC5wdXNoKGVsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBzZXQ7XG4gICAgfTtcblxuICAgIC8qXFxcbiAgICAgKiBQYXBlci5nZXRCeUlkXG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBSZXR1cm5zIHlvdSBlbGVtZW50IGJ5IGl0cyBpbnRlcm5hbCBJRC5cbiAgICAgKipcbiAgICAgPiBQYXJhbWV0ZXJzXG4gICAgICoqXG4gICAgIC0gaWQgKG51bWJlcikgaWRcbiAgICAgPSAob2JqZWN0KSBSYXBoYcOrbCBlbGVtZW50IG9iamVjdFxuICAgIFxcKi9cbiAgICBwYXBlcnByb3RvLmdldEJ5SWQgPSBmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgdmFyIGJvdCA9IHRoaXMuYm90dG9tO1xuICAgICAgICB3aGlsZSAoYm90KSB7XG4gICAgICAgICAgICBpZiAoYm90LmlkID09IGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGJvdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJvdCA9IGJvdC5uZXh0O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIFBhcGVyLmZvckVhY2hcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIEV4ZWN1dGVzIGdpdmVuIGZ1bmN0aW9uIGZvciBlYWNoIGVsZW1lbnQgb24gdGhlIHBhcGVyXG4gICAgICpcbiAgICAgKiBJZiBjYWxsYmFjayBmdW5jdGlvbiByZXR1cm5zIGBmYWxzZWAgaXQgd2lsbCBzdG9wIGxvb3AgcnVubmluZy5cbiAgICAgKipcbiAgICAgPiBQYXJhbWV0ZXJzXG4gICAgICoqXG4gICAgIC0gY2FsbGJhY2sgKGZ1bmN0aW9uKSBmdW5jdGlvbiB0byBydW5cbiAgICAgLSB0aGlzQXJnIChvYmplY3QpIGNvbnRleHQgb2JqZWN0IGZvciB0aGUgY2FsbGJhY2tcbiAgICAgPSAob2JqZWN0KSBQYXBlciBvYmplY3RcbiAgICAgPiBVc2FnZVxuICAgICB8IHBhcGVyLmZvckVhY2goZnVuY3Rpb24gKGVsKSB7XG4gICAgIHwgICAgIGVsLmF0dHIoeyBzdHJva2U6IFwiYmx1ZVwiIH0pO1xuICAgICB8IH0pO1xuICAgIFxcKi9cbiAgICBwYXBlcnByb3RvLmZvckVhY2ggPSBmdW5jdGlvbiAoY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgICAgdmFyIGJvdCA9IHRoaXMuYm90dG9tO1xuICAgICAgICB3aGlsZSAoYm90KSB7XG4gICAgICAgICAgICBpZiAoY2FsbGJhY2suY2FsbCh0aGlzQXJnLCBib3QpID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYm90ID0gYm90Lm5leHQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICAvKlxcXG4gICAgICogUGFwZXIuZ2V0RWxlbWVudHNCeVBvaW50XG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBSZXR1cm5zIHNldCBvZiBlbGVtZW50cyB0aGF0IGhhdmUgY29tbW9uIHBvaW50IGluc2lkZVxuICAgICAqKlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgKipcbiAgICAgLSB4IChudW1iZXIpIHggY29vcmRpbmF0ZSBvZiB0aGUgcG9pbnRcbiAgICAgLSB5IChudW1iZXIpIHkgY29vcmRpbmF0ZSBvZiB0aGUgcG9pbnRcbiAgICAgPSAob2JqZWN0KSBAU2V0XG4gICAgXFwqL1xuICAgIHBhcGVycHJvdG8uZ2V0RWxlbWVudHNCeVBvaW50ID0gZnVuY3Rpb24gKHgsIHkpIHtcbiAgICAgICAgdmFyIHNldCA9IHRoaXMuc2V0KCk7XG4gICAgICAgIHRoaXMuZm9yRWFjaChmdW5jdGlvbiAoZWwpIHtcbiAgICAgICAgICAgIGlmIChlbC5pc1BvaW50SW5zaWRlKHgsIHkpKSB7XG4gICAgICAgICAgICAgICAgc2V0LnB1c2goZWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHNldDtcbiAgICB9O1xuICAgIGZ1bmN0aW9uIHhfeSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMueCArIFMgKyB0aGlzLnk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHhfeV93X2goKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnggKyBTICsgdGhpcy55ICsgUyArIHRoaXMud2lkdGggKyBcIiBcXHhkNyBcIiArIHRoaXMuaGVpZ2h0O1xuICAgIH1cbiAgICAvKlxcXG4gICAgICogRWxlbWVudC5pc1BvaW50SW5zaWRlXG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBEZXRlcm1pbmUgaWYgZ2l2ZW4gcG9pbnQgaXMgaW5zaWRlIHRoaXMgZWxlbWVudOKAmXMgc2hhcGVcbiAgICAgKipcbiAgICAgPiBQYXJhbWV0ZXJzXG4gICAgICoqXG4gICAgIC0geCAobnVtYmVyKSB4IGNvb3JkaW5hdGUgb2YgdGhlIHBvaW50XG4gICAgIC0geSAobnVtYmVyKSB5IGNvb3JkaW5hdGUgb2YgdGhlIHBvaW50XG4gICAgID0gKGJvb2xlYW4pIGB0cnVlYCBpZiBwb2ludCBpbnNpZGUgdGhlIHNoYXBlXG4gICAgXFwqL1xuICAgIGVscHJvdG8uaXNQb2ludEluc2lkZSA9IGZ1bmN0aW9uICh4LCB5KSB7XG4gICAgICAgIHZhciBycCA9IHRoaXMucmVhbFBhdGggPSBnZXRQYXRoW3RoaXMudHlwZV0odGhpcyk7XG4gICAgICAgIGlmICh0aGlzLmF0dHIoJ3RyYW5zZm9ybScpICYmIHRoaXMuYXR0cigndHJhbnNmb3JtJykubGVuZ3RoKSB7XG4gICAgICAgICAgICBycCA9IFIudHJhbnNmb3JtUGF0aChycCwgdGhpcy5hdHRyKCd0cmFuc2Zvcm0nKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFIuaXNQb2ludEluc2lkZVBhdGgocnAsIHgsIHkpO1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIEVsZW1lbnQuZ2V0QkJveFxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogUmV0dXJuIGJvdW5kaW5nIGJveCBmb3IgYSBnaXZlbiBlbGVtZW50XG4gICAgICoqXG4gICAgID4gUGFyYW1ldGVyc1xuICAgICAqKlxuICAgICAtIGlzV2l0aG91dFRyYW5zZm9ybSAoYm9vbGVhbikgZmxhZywgYHRydWVgIGlmIHlvdSB3YW50IHRvIGhhdmUgYm91bmRpbmcgYm94IGJlZm9yZSB0cmFuc2Zvcm1hdGlvbnMuIERlZmF1bHQgaXMgYGZhbHNlYC5cbiAgICAgPSAob2JqZWN0KSBCb3VuZGluZyBib3ggb2JqZWN0OlxuICAgICBvIHtcbiAgICAgbyAgICAgeDogKG51bWJlcikgdG9wIGxlZnQgY29ybmVyIHhcbiAgICAgbyAgICAgeTogKG51bWJlcikgdG9wIGxlZnQgY29ybmVyIHlcbiAgICAgbyAgICAgeDI6IChudW1iZXIpIGJvdHRvbSByaWdodCBjb3JuZXIgeFxuICAgICBvICAgICB5MjogKG51bWJlcikgYm90dG9tIHJpZ2h0IGNvcm5lciB5XG4gICAgIG8gICAgIHdpZHRoOiAobnVtYmVyKSB3aWR0aFxuICAgICBvICAgICBoZWlnaHQ6IChudW1iZXIpIGhlaWdodFxuICAgICBvIH1cbiAgICBcXCovXG4gICAgZWxwcm90by5nZXRCQm94ID0gZnVuY3Rpb24gKGlzV2l0aG91dFRyYW5zZm9ybSkge1xuICAgICAgICBpZiAodGhpcy5yZW1vdmVkKSB7XG4gICAgICAgICAgICByZXR1cm4ge307XG4gICAgICAgIH1cbiAgICAgICAgdmFyIF8gPSB0aGlzLl87XG4gICAgICAgIGlmIChpc1dpdGhvdXRUcmFuc2Zvcm0pIHtcbiAgICAgICAgICAgIGlmIChfLmRpcnR5IHx8ICFfLmJib3h3dCkge1xuICAgICAgICAgICAgICAgIHRoaXMucmVhbFBhdGggPSBnZXRQYXRoW3RoaXMudHlwZV0odGhpcyk7XG4gICAgICAgICAgICAgICAgXy5iYm94d3QgPSBwYXRoRGltZW5zaW9ucyh0aGlzLnJlYWxQYXRoKTtcbiAgICAgICAgICAgICAgICBfLmJib3h3dC50b1N0cmluZyA9IHhfeV93X2g7XG4gICAgICAgICAgICAgICAgXy5kaXJ0eSA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gXy5iYm94d3Q7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKF8uZGlydHkgfHwgXy5kaXJ0eVQgfHwgIV8uYmJveCkge1xuICAgICAgICAgICAgaWYgKF8uZGlydHkgfHwgIXRoaXMucmVhbFBhdGgpIHtcbiAgICAgICAgICAgICAgICBfLmJib3h3dCA9IDA7XG4gICAgICAgICAgICAgICAgdGhpcy5yZWFsUGF0aCA9IGdldFBhdGhbdGhpcy50eXBlXSh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF8uYmJveCA9IHBhdGhEaW1lbnNpb25zKG1hcFBhdGgodGhpcy5yZWFsUGF0aCwgdGhpcy5tYXRyaXgpKTtcbiAgICAgICAgICAgIF8uYmJveC50b1N0cmluZyA9IHhfeV93X2g7XG4gICAgICAgICAgICBfLmRpcnR5ID0gXy5kaXJ0eVQgPSAwO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfLmJib3g7XG4gICAgfTtcbiAgICAvKlxcXG4gICAgICogRWxlbWVudC5jbG9uZVxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgID0gKG9iamVjdCkgY2xvbmUgb2YgYSBnaXZlbiBlbGVtZW50XG4gICAgICoqXG4gICAgXFwqL1xuICAgIGVscHJvdG8uY2xvbmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnJlbW92ZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHZhciBvdXQgPSB0aGlzLnBhcGVyW3RoaXMudHlwZV0oKS5hdHRyKHRoaXMuYXR0cigpKTtcbiAgICAgICAgdGhpcy5fX3NldF9fICYmIHRoaXMuX19zZXRfXy5wdXNoKG91dCk7XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbiAgICAvKlxcXG4gICAgICogRWxlbWVudC5nbG93XG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBSZXR1cm4gc2V0IG9mIGVsZW1lbnRzIHRoYXQgY3JlYXRlIGdsb3ctbGlrZSBlZmZlY3QgYXJvdW5kIGdpdmVuIGVsZW1lbnQuIFNlZSBAUGFwZXIuc2V0LlxuICAgICAqXG4gICAgICogTm90ZTogR2xvdyBpcyBub3QgY29ubmVjdGVkIHRvIHRoZSBlbGVtZW50LiBJZiB5b3UgY2hhbmdlIGVsZW1lbnQgYXR0cmlidXRlcyBpdCB3b27igJl0IGFkanVzdCBpdHNlbGYuXG4gICAgICoqXG4gICAgID4gUGFyYW1ldGVyc1xuICAgICAqKlxuICAgICAtIGdsb3cgKG9iamVjdCkgI29wdGlvbmFsIHBhcmFtZXRlcnMgb2JqZWN0IHdpdGggYWxsIHByb3BlcnRpZXMgb3B0aW9uYWw6XG4gICAgIG8ge1xuICAgICBvICAgICB3aWR0aCAobnVtYmVyKSBzaXplIG9mIHRoZSBnbG93LCBkZWZhdWx0IGlzIGAxMGBcbiAgICAgbyAgICAgZmlsbCAoYm9vbGVhbikgd2lsbCBpdCBiZSBmaWxsZWQsIGRlZmF1bHQgaXMgYGZhbHNlYFxuICAgICBvICAgICBvcGFjaXR5IChudW1iZXIpIG9wYWNpdHksIGRlZmF1bHQgaXMgYDAuNWBcbiAgICAgbyAgICAgb2Zmc2V0eCAobnVtYmVyKSBob3Jpem9udGFsIG9mZnNldCwgZGVmYXVsdCBpcyBgMGBcbiAgICAgbyAgICAgb2Zmc2V0eSAobnVtYmVyKSB2ZXJ0aWNhbCBvZmZzZXQsIGRlZmF1bHQgaXMgYDBgXG4gICAgIG8gICAgIGNvbG9yIChzdHJpbmcpIGdsb3cgY29sb3VyLCBkZWZhdWx0IGlzIGBibGFja2BcbiAgICAgbyB9XG4gICAgID0gKG9iamVjdCkgQFBhcGVyLnNldCBvZiBlbGVtZW50cyB0aGF0IHJlcHJlc2VudHMgZ2xvd1xuICAgIFxcKi9cbiAgICBlbHByb3RvLmdsb3cgPSBmdW5jdGlvbiAoZ2xvdykge1xuICAgICAgICBpZiAodGhpcy50eXBlID09IFwidGV4dFwiKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBnbG93ID0gZ2xvdyB8fCB7fTtcbiAgICAgICAgdmFyIHMgPSB7XG4gICAgICAgICAgICB3aWR0aDogKGdsb3cud2lkdGggfHwgMTApICsgKCt0aGlzLmF0dHIoXCJzdHJva2Utd2lkdGhcIikgfHwgMSksXG4gICAgICAgICAgICBmaWxsOiBnbG93LmZpbGwgfHwgZmFsc2UsXG4gICAgICAgICAgICBvcGFjaXR5OiBnbG93Lm9wYWNpdHkgPT0gbnVsbCA/IC41IDogZ2xvdy5vcGFjaXR5LFxuICAgICAgICAgICAgb2Zmc2V0eDogZ2xvdy5vZmZzZXR4IHx8IDAsXG4gICAgICAgICAgICBvZmZzZXR5OiBnbG93Lm9mZnNldHkgfHwgMCxcbiAgICAgICAgICAgIGNvbG9yOiBnbG93LmNvbG9yIHx8IFwiIzAwMFwiXG4gICAgICAgIH0sXG4gICAgICAgICAgICBjID0gcy53aWR0aCAvIDIsXG4gICAgICAgICAgICByID0gdGhpcy5wYXBlcixcbiAgICAgICAgICAgIG91dCA9IHIuc2V0KCksXG4gICAgICAgICAgICBwYXRoID0gdGhpcy5yZWFsUGF0aCB8fCBnZXRQYXRoW3RoaXMudHlwZV0odGhpcyk7XG4gICAgICAgIHBhdGggPSB0aGlzLm1hdHJpeCA/IG1hcFBhdGgocGF0aCwgdGhpcy5tYXRyaXgpIDogcGF0aDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBjICsgMTsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaChyLnBhdGgocGF0aCkuYXR0cih7XG4gICAgICAgICAgICAgICAgc3Ryb2tlOiBzLmNvbG9yLFxuICAgICAgICAgICAgICAgIGZpbGw6IHMuZmlsbCA/IHMuY29sb3IgOiBcIm5vbmVcIixcbiAgICAgICAgICAgICAgICBcInN0cm9rZS1saW5lam9pblwiOiBcInJvdW5kXCIsXG4gICAgICAgICAgICAgICAgXCJzdHJva2UtbGluZWNhcFwiOiBcInJvdW5kXCIsXG4gICAgICAgICAgICAgICAgXCJzdHJva2Utd2lkdGhcIjogKyhzLndpZHRoIC8gYyAqIGkpLnRvRml4ZWQoMyksXG4gICAgICAgICAgICAgICAgb3BhY2l0eTogKyhzLm9wYWNpdHkgLyBjKS50b0ZpeGVkKDMpXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dC5pbnNlcnRCZWZvcmUodGhpcykudHJhbnNsYXRlKHMub2Zmc2V0eCwgcy5vZmZzZXR5KTtcbiAgICB9O1xuICAgIHZhciBjdXJ2ZXNsZW5ndGhzID0ge30sXG4gICAgZ2V0UG9pbnRBdFNlZ21lbnRMZW5ndGggPSBmdW5jdGlvbiAocDF4LCBwMXksIGMxeCwgYzF5LCBjMngsIGMyeSwgcDJ4LCBwMnksIGxlbmd0aCkge1xuICAgICAgICBpZiAobGVuZ3RoID09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybiBiZXpsZW4ocDF4LCBwMXksIGMxeCwgYzF5LCBjMngsIGMyeSwgcDJ4LCBwMnkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFIuZmluZERvdHNBdFNlZ21lbnQocDF4LCBwMXksIGMxeCwgYzF5LCBjMngsIGMyeSwgcDJ4LCBwMnksIGdldFRhdExlbihwMXgsIHAxeSwgYzF4LCBjMXksIGMyeCwgYzJ5LCBwMngsIHAyeSwgbGVuZ3RoKSk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIGdldExlbmd0aEZhY3RvcnkgPSBmdW5jdGlvbiAoaXN0b3RhbCwgc3VicGF0aCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHBhdGgsIGxlbmd0aCwgb25seXN0YXJ0KSB7XG4gICAgICAgICAgICBwYXRoID0gcGF0aDJjdXJ2ZShwYXRoKTtcbiAgICAgICAgICAgIHZhciB4LCB5LCBwLCBsLCBzcCA9IFwiXCIsIHN1YnBhdGhzID0ge30sIHBvaW50LFxuICAgICAgICAgICAgICAgIGxlbiA9IDA7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBwYXRoLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcbiAgICAgICAgICAgICAgICBwID0gcGF0aFtpXTtcbiAgICAgICAgICAgICAgICBpZiAocFswXSA9PSBcIk1cIikge1xuICAgICAgICAgICAgICAgICAgICB4ID0gK3BbMV07XG4gICAgICAgICAgICAgICAgICAgIHkgPSArcFsyXTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBsID0gZ2V0UG9pbnRBdFNlZ21lbnRMZW5ndGgoeCwgeSwgcFsxXSwgcFsyXSwgcFszXSwgcFs0XSwgcFs1XSwgcFs2XSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChsZW4gKyBsID4gbGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3VicGF0aCAmJiAhc3VicGF0aHMuc3RhcnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2ludCA9IGdldFBvaW50QXRTZWdtZW50TGVuZ3RoKHgsIHksIHBbMV0sIHBbMl0sIHBbM10sIHBbNF0sIHBbNV0sIHBbNl0sIGxlbmd0aCAtIGxlbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3AgKz0gW1wiQ1wiICsgcG9pbnQuc3RhcnQueCwgcG9pbnQuc3RhcnQueSwgcG9pbnQubS54LCBwb2ludC5tLnksIHBvaW50LngsIHBvaW50LnldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvbmx5c3RhcnQpIHtyZXR1cm4gc3A7fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YnBhdGhzLnN0YXJ0ID0gc3A7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3AgPSBbXCJNXCIgKyBwb2ludC54LCBwb2ludC55ICsgXCJDXCIgKyBwb2ludC5uLngsIHBvaW50Lm4ueSwgcG9pbnQuZW5kLngsIHBvaW50LmVuZC55LCBwWzVdLCBwWzZdXS5qb2luKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVuICs9IGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeCA9ICtwWzVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHkgPSArcFs2XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXN0b3RhbCAmJiAhc3VicGF0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50ID0gZ2V0UG9pbnRBdFNlZ21lbnRMZW5ndGgoeCwgeSwgcFsxXSwgcFsyXSwgcFszXSwgcFs0XSwgcFs1XSwgcFs2XSwgbGVuZ3RoIC0gbGVuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge3g6IHBvaW50LngsIHk6IHBvaW50LnksIGFscGhhOiBwb2ludC5hbHBoYX07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbGVuICs9IGw7XG4gICAgICAgICAgICAgICAgICAgIHggPSArcFs1XTtcbiAgICAgICAgICAgICAgICAgICAgeSA9ICtwWzZdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzcCArPSBwLnNoaWZ0KCkgKyBwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3VicGF0aHMuZW5kID0gc3A7XG4gICAgICAgICAgICBwb2ludCA9IGlzdG90YWwgPyBsZW4gOiBzdWJwYXRoID8gc3VicGF0aHMgOiBSLmZpbmREb3RzQXRTZWdtZW50KHgsIHksIHBbMF0sIHBbMV0sIHBbMl0sIHBbM10sIHBbNF0sIHBbNV0sIDEpO1xuICAgICAgICAgICAgcG9pbnQuYWxwaGEgJiYgKHBvaW50ID0ge3g6IHBvaW50LngsIHk6IHBvaW50LnksIGFscGhhOiBwb2ludC5hbHBoYX0pO1xuICAgICAgICAgICAgcmV0dXJuIHBvaW50O1xuICAgICAgICB9O1xuICAgIH07XG4gICAgdmFyIGdldFRvdGFsTGVuZ3RoID0gZ2V0TGVuZ3RoRmFjdG9yeSgxKSxcbiAgICAgICAgZ2V0UG9pbnRBdExlbmd0aCA9IGdldExlbmd0aEZhY3RvcnkoKSxcbiAgICAgICAgZ2V0U3VicGF0aHNBdExlbmd0aCA9IGdldExlbmd0aEZhY3RvcnkoMCwgMSk7XG4gICAgLypcXFxuICAgICAqIFJhcGhhZWwuZ2V0VG90YWxMZW5ndGhcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIFJldHVybnMgbGVuZ3RoIG9mIHRoZSBnaXZlbiBwYXRoIGluIHBpeGVscy5cbiAgICAgKipcbiAgICAgPiBQYXJhbWV0ZXJzXG4gICAgICoqXG4gICAgIC0gcGF0aCAoc3RyaW5nKSBTVkcgcGF0aCBzdHJpbmcuXG4gICAgICoqXG4gICAgID0gKG51bWJlcikgbGVuZ3RoLlxuICAgIFxcKi9cbiAgICBSLmdldFRvdGFsTGVuZ3RoID0gZ2V0VG90YWxMZW5ndGg7XG4gICAgLypcXFxuICAgICAqIFJhcGhhZWwuZ2V0UG9pbnRBdExlbmd0aFxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogUmV0dXJuIGNvb3JkaW5hdGVzIG9mIHRoZSBwb2ludCBsb2NhdGVkIGF0IHRoZSBnaXZlbiBsZW5ndGggb24gdGhlIGdpdmVuIHBhdGguXG4gICAgICoqXG4gICAgID4gUGFyYW1ldGVyc1xuICAgICAqKlxuICAgICAtIHBhdGggKHN0cmluZykgU1ZHIHBhdGggc3RyaW5nXG4gICAgIC0gbGVuZ3RoIChudW1iZXIpXG4gICAgICoqXG4gICAgID0gKG9iamVjdCkgcmVwcmVzZW50YXRpb24gb2YgdGhlIHBvaW50OlxuICAgICBvIHtcbiAgICAgbyAgICAgeDogKG51bWJlcikgeCBjb29yZGluYXRlXG4gICAgIG8gICAgIHk6IChudW1iZXIpIHkgY29vcmRpbmF0ZVxuICAgICBvICAgICBhbHBoYTogKG51bWJlcikgYW5nbGUgb2YgZGVyaXZhdGl2ZVxuICAgICBvIH1cbiAgICBcXCovXG4gICAgUi5nZXRQb2ludEF0TGVuZ3RoID0gZ2V0UG9pbnRBdExlbmd0aDtcbiAgICAvKlxcXG4gICAgICogUmFwaGFlbC5nZXRTdWJwYXRoXG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBSZXR1cm4gc3VicGF0aCBvZiBhIGdpdmVuIHBhdGggZnJvbSBnaXZlbiBsZW5ndGggdG8gZ2l2ZW4gbGVuZ3RoLlxuICAgICAqKlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgKipcbiAgICAgLSBwYXRoIChzdHJpbmcpIFNWRyBwYXRoIHN0cmluZ1xuICAgICAtIGZyb20gKG51bWJlcikgcG9zaXRpb24gb2YgdGhlIHN0YXJ0IG9mIHRoZSBzZWdtZW50XG4gICAgIC0gdG8gKG51bWJlcikgcG9zaXRpb24gb2YgdGhlIGVuZCBvZiB0aGUgc2VnbWVudFxuICAgICAqKlxuICAgICA9IChzdHJpbmcpIHBhdGhzdHJpbmcgZm9yIHRoZSBzZWdtZW50XG4gICAgXFwqL1xuICAgIFIuZ2V0U3VicGF0aCA9IGZ1bmN0aW9uIChwYXRoLCBmcm9tLCB0bykge1xuICAgICAgICBpZiAodGhpcy5nZXRUb3RhbExlbmd0aChwYXRoKSAtIHRvIDwgMWUtNikge1xuICAgICAgICAgICAgcmV0dXJuIGdldFN1YnBhdGhzQXRMZW5ndGgocGF0aCwgZnJvbSkuZW5kO1xuICAgICAgICB9XG4gICAgICAgIHZhciBhID0gZ2V0U3VicGF0aHNBdExlbmd0aChwYXRoLCB0bywgMSk7XG4gICAgICAgIHJldHVybiBmcm9tID8gZ2V0U3VicGF0aHNBdExlbmd0aChhLCBmcm9tKS5lbmQgOiBhO1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIEVsZW1lbnQuZ2V0VG90YWxMZW5ndGhcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIFJldHVybnMgbGVuZ3RoIG9mIHRoZSBwYXRoIGluIHBpeGVscy4gT25seSB3b3JrcyBmb3IgZWxlbWVudCBvZiDigJxwYXRo4oCdIHR5cGUuXG4gICAgID0gKG51bWJlcikgbGVuZ3RoLlxuICAgIFxcKi9cbiAgICBlbHByb3RvLmdldFRvdGFsTGVuZ3RoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcGF0aCA9IHRoaXMuZ2V0UGF0aCgpO1xuICAgICAgICBpZiAoIXBhdGgpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLm5vZGUuZ2V0VG90YWxMZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm5vZGUuZ2V0VG90YWxMZW5ndGgoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBnZXRUb3RhbExlbmd0aChwYXRoKTtcbiAgICB9O1xuICAgIC8qXFxcbiAgICAgKiBFbGVtZW50LmdldFBvaW50QXRMZW5ndGhcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIFJldHVybiBjb29yZGluYXRlcyBvZiB0aGUgcG9pbnQgbG9jYXRlZCBhdCB0aGUgZ2l2ZW4gbGVuZ3RoIG9uIHRoZSBnaXZlbiBwYXRoLiBPbmx5IHdvcmtzIGZvciBlbGVtZW50IG9mIOKAnHBhdGjigJ0gdHlwZS5cbiAgICAgKipcbiAgICAgPiBQYXJhbWV0ZXJzXG4gICAgICoqXG4gICAgIC0gbGVuZ3RoIChudW1iZXIpXG4gICAgICoqXG4gICAgID0gKG9iamVjdCkgcmVwcmVzZW50YXRpb24gb2YgdGhlIHBvaW50OlxuICAgICBvIHtcbiAgICAgbyAgICAgeDogKG51bWJlcikgeCBjb29yZGluYXRlXG4gICAgIG8gICAgIHk6IChudW1iZXIpIHkgY29vcmRpbmF0ZVxuICAgICBvICAgICBhbHBoYTogKG51bWJlcikgYW5nbGUgb2YgZGVyaXZhdGl2ZVxuICAgICBvIH1cbiAgICBcXCovXG4gICAgZWxwcm90by5nZXRQb2ludEF0TGVuZ3RoID0gZnVuY3Rpb24gKGxlbmd0aCkge1xuICAgICAgICB2YXIgcGF0aCA9IHRoaXMuZ2V0UGF0aCgpO1xuICAgICAgICBpZiAoIXBhdGgpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBnZXRQb2ludEF0TGVuZ3RoKHBhdGgsIGxlbmd0aCk7XG4gICAgfTtcbiAgICAvKlxcXG4gICAgICogRWxlbWVudC5nZXRQYXRoXG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBSZXR1cm5zIHBhdGggb2YgdGhlIGVsZW1lbnQuIE9ubHkgd29ya3MgZm9yIGVsZW1lbnRzIG9mIOKAnHBhdGjigJ0gdHlwZSBhbmQgc2ltcGxlIGVsZW1lbnRzIGxpa2UgY2lyY2xlLlxuICAgICA9IChvYmplY3QpIHBhdGhcbiAgICAgKipcbiAgICBcXCovXG4gICAgZWxwcm90by5nZXRQYXRoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcGF0aCxcbiAgICAgICAgICAgIGdldFBhdGggPSBSLl9nZXRQYXRoW3RoaXMudHlwZV07XG5cbiAgICAgICAgaWYgKHRoaXMudHlwZSA9PSBcInRleHRcIiB8fCB0aGlzLnR5cGUgPT0gXCJzZXRcIikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGdldFBhdGgpIHtcbiAgICAgICAgICAgIHBhdGggPSBnZXRQYXRoKHRoaXMpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHBhdGg7XG4gICAgfTtcbiAgICAvKlxcXG4gICAgICogRWxlbWVudC5nZXRTdWJwYXRoXG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBSZXR1cm4gc3VicGF0aCBvZiBhIGdpdmVuIGVsZW1lbnQgZnJvbSBnaXZlbiBsZW5ndGggdG8gZ2l2ZW4gbGVuZ3RoLiBPbmx5IHdvcmtzIGZvciBlbGVtZW50IG9mIOKAnHBhdGjigJ0gdHlwZS5cbiAgICAgKipcbiAgICAgPiBQYXJhbWV0ZXJzXG4gICAgICoqXG4gICAgIC0gZnJvbSAobnVtYmVyKSBwb3NpdGlvbiBvZiB0aGUgc3RhcnQgb2YgdGhlIHNlZ21lbnRcbiAgICAgLSB0byAobnVtYmVyKSBwb3NpdGlvbiBvZiB0aGUgZW5kIG9mIHRoZSBzZWdtZW50XG4gICAgICoqXG4gICAgID0gKHN0cmluZykgcGF0aHN0cmluZyBmb3IgdGhlIHNlZ21lbnRcbiAgICBcXCovXG4gICAgZWxwcm90by5nZXRTdWJwYXRoID0gZnVuY3Rpb24gKGZyb20sIHRvKSB7XG4gICAgICAgIHZhciBwYXRoID0gdGhpcy5nZXRQYXRoKCk7XG4gICAgICAgIGlmICghcGF0aCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIFIuZ2V0U3VicGF0aChwYXRoLCBmcm9tLCB0byk7XG4gICAgfTtcbiAgICAvKlxcXG4gICAgICogUmFwaGFlbC5lYXNpbmdfZm9ybXVsYXNcbiAgICAgWyBwcm9wZXJ0eSBdXG4gICAgICoqXG4gICAgICogT2JqZWN0IHRoYXQgY29udGFpbnMgZWFzaW5nIGZvcm11bGFzIGZvciBhbmltYXRpb24uIFlvdSBjb3VsZCBleHRlbmQgaXQgd2l0aCB5b3VyIG93bi4gQnkgZGVmYXVsdCBpdCBoYXMgZm9sbG93aW5nIGxpc3Qgb2YgZWFzaW5nOlxuICAgICAjIDx1bD5cbiAgICAgIyAgICAgPGxpPuKAnGxpbmVhcuKAnTwvbGk+XG4gICAgICMgICAgIDxsaT7igJwmbHQ74oCdIG9yIOKAnGVhc2VJbuKAnSBvciDigJxlYXNlLWlu4oCdPC9saT5cbiAgICAgIyAgICAgPGxpPuKAnD7igJ0gb3Ig4oCcZWFzZU91dOKAnSBvciDigJxlYXNlLW91dOKAnTwvbGk+XG4gICAgICMgICAgIDxsaT7igJwmbHQ7PuKAnSBvciDigJxlYXNlSW5PdXTigJ0gb3Ig4oCcZWFzZS1pbi1vdXTigJ08L2xpPlxuICAgICAjICAgICA8bGk+4oCcYmFja0lu4oCdIG9yIOKAnGJhY2staW7igJ08L2xpPlxuICAgICAjICAgICA8bGk+4oCcYmFja091dOKAnSBvciDigJxiYWNrLW91dOKAnTwvbGk+XG4gICAgICMgICAgIDxsaT7igJxlbGFzdGlj4oCdPC9saT5cbiAgICAgIyAgICAgPGxpPuKAnGJvdW5jZeKAnTwvbGk+XG4gICAgICMgPC91bD5cbiAgICAgIyA8cD5TZWUgYWxzbyA8YSBocmVmPVwiaHR0cDovL3JhcGhhZWxqcy5jb20vZWFzaW5nLmh0bWxcIj5FYXNpbmcgZGVtbzwvYT4uPC9wPlxuICAgIFxcKi9cbiAgICB2YXIgZWYgPSBSLmVhc2luZ19mb3JtdWxhcyA9IHtcbiAgICAgICAgbGluZWFyOiBmdW5jdGlvbiAobikge1xuICAgICAgICAgICAgcmV0dXJuIG47XG4gICAgICAgIH0sXG4gICAgICAgIFwiPFwiOiBmdW5jdGlvbiAobikge1xuICAgICAgICAgICAgcmV0dXJuIHBvdyhuLCAxLjcpO1xuICAgICAgICB9LFxuICAgICAgICBcIj5cIjogZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgIHJldHVybiBwb3cobiwgLjQ4KTtcbiAgICAgICAgfSxcbiAgICAgICAgXCI8PlwiOiBmdW5jdGlvbiAobikge1xuICAgICAgICAgICAgdmFyIHEgPSAuNDggLSBuIC8gMS4wNCxcbiAgICAgICAgICAgICAgICBRID0gbWF0aC5zcXJ0KC4xNzM0ICsgcSAqIHEpLFxuICAgICAgICAgICAgICAgIHggPSBRIC0gcSxcbiAgICAgICAgICAgICAgICBYID0gcG93KGFicyh4KSwgMSAvIDMpICogKHggPCAwID8gLTEgOiAxKSxcbiAgICAgICAgICAgICAgICB5ID0gLVEgLSBxLFxuICAgICAgICAgICAgICAgIFkgPSBwb3coYWJzKHkpLCAxIC8gMykgKiAoeSA8IDAgPyAtMSA6IDEpLFxuICAgICAgICAgICAgICAgIHQgPSBYICsgWSArIC41O1xuICAgICAgICAgICAgcmV0dXJuICgxIC0gdCkgKiAzICogdCAqIHQgKyB0ICogdCAqIHQ7XG4gICAgICAgIH0sXG4gICAgICAgIGJhY2tJbjogZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgIHZhciBzID0gMS43MDE1ODtcbiAgICAgICAgICAgIHJldHVybiBuICogbiAqICgocyArIDEpICogbiAtIHMpO1xuICAgICAgICB9LFxuICAgICAgICBiYWNrT3V0OiBmdW5jdGlvbiAobikge1xuICAgICAgICAgICAgbiA9IG4gLSAxO1xuICAgICAgICAgICAgdmFyIHMgPSAxLjcwMTU4O1xuICAgICAgICAgICAgcmV0dXJuIG4gKiBuICogKChzICsgMSkgKiBuICsgcykgKyAxO1xuICAgICAgICB9LFxuICAgICAgICBlbGFzdGljOiBmdW5jdGlvbiAobikge1xuICAgICAgICAgICAgaWYgKG4gPT0gISFuKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcG93KDIsIC0xMCAqIG4pICogbWF0aC5zaW4oKG4gLSAuMDc1KSAqICgyICogUEkpIC8gLjMpICsgMTtcbiAgICAgICAgfSxcbiAgICAgICAgYm91bmNlOiBmdW5jdGlvbiAobikge1xuICAgICAgICAgICAgdmFyIHMgPSA3LjU2MjUsXG4gICAgICAgICAgICAgICAgcCA9IDIuNzUsXG4gICAgICAgICAgICAgICAgbDtcbiAgICAgICAgICAgIGlmIChuIDwgKDEgLyBwKSkge1xuICAgICAgICAgICAgICAgIGwgPSBzICogbiAqIG47XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChuIDwgKDIgLyBwKSkge1xuICAgICAgICAgICAgICAgICAgICBuIC09ICgxLjUgLyBwKTtcbiAgICAgICAgICAgICAgICAgICAgbCA9IHMgKiBuICogbiArIC43NTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAobiA8ICgyLjUgLyBwKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbiAtPSAoMi4yNSAvIHApO1xuICAgICAgICAgICAgICAgICAgICAgICAgbCA9IHMgKiBuICogbiArIC45Mzc1O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbiAtPSAoMi42MjUgLyBwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGwgPSBzICogbiAqIG4gKyAuOTg0Mzc1O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGw7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGVmLmVhc2VJbiA9IGVmW1wiZWFzZS1pblwiXSA9IGVmW1wiPFwiXTtcbiAgICBlZi5lYXNlT3V0ID0gZWZbXCJlYXNlLW91dFwiXSA9IGVmW1wiPlwiXTtcbiAgICBlZi5lYXNlSW5PdXQgPSBlZltcImVhc2UtaW4tb3V0XCJdID0gZWZbXCI8PlwiXTtcbiAgICBlZltcImJhY2staW5cIl0gPSBlZi5iYWNrSW47XG4gICAgZWZbXCJiYWNrLW91dFwiXSA9IGVmLmJhY2tPdXQ7XG5cbiAgICB2YXIgYW5pbWF0aW9uRWxlbWVudHMgPSBbXSxcbiAgICAgICAgcmVxdWVzdEFuaW1GcmFtZSA9IHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgICAgICAgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy53ZWJraXRSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5tb3pSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgICAgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5vUmVxdWVzdEFuaW1hdGlvbkZyYW1lICAgICAgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5tc1JlcXVlc3RBbmltYXRpb25GcmFtZSAgICAgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoY2FsbGJhY2ssIDE2KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgIGFuaW1hdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBOb3cgPSArbmV3IERhdGUsXG4gICAgICAgICAgICAgICAgbCA9IDA7XG4gICAgICAgICAgICBmb3IgKDsgbCA8IGFuaW1hdGlvbkVsZW1lbnRzLmxlbmd0aDsgbCsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGUgPSBhbmltYXRpb25FbGVtZW50c1tsXTtcbiAgICAgICAgICAgICAgICBpZiAoZS5lbC5yZW1vdmVkIHx8IGUucGF1c2VkKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgdGltZSA9IE5vdyAtIGUuc3RhcnQsXG4gICAgICAgICAgICAgICAgICAgIG1zID0gZS5tcyxcbiAgICAgICAgICAgICAgICAgICAgZWFzaW5nID0gZS5lYXNpbmcsXG4gICAgICAgICAgICAgICAgICAgIGZyb20gPSBlLmZyb20sXG4gICAgICAgICAgICAgICAgICAgIGRpZmYgPSBlLmRpZmYsXG4gICAgICAgICAgICAgICAgICAgIHRvID0gZS50byxcbiAgICAgICAgICAgICAgICAgICAgdCA9IGUudCxcbiAgICAgICAgICAgICAgICAgICAgdGhhdCA9IGUuZWwsXG4gICAgICAgICAgICAgICAgICAgIHNldCA9IHt9LFxuICAgICAgICAgICAgICAgICAgICBub3csXG4gICAgICAgICAgICAgICAgICAgIGluaXQgPSB7fSxcbiAgICAgICAgICAgICAgICAgICAga2V5O1xuICAgICAgICAgICAgICAgIGlmIChlLmluaXRzdGF0dXMpIHtcbiAgICAgICAgICAgICAgICAgICAgdGltZSA9IChlLmluaXRzdGF0dXMgKiBlLmFuaW0udG9wIC0gZS5wcmV2KSAvIChlLnBlcmNlbnQgLSBlLnByZXYpICogbXM7XG4gICAgICAgICAgICAgICAgICAgIGUuc3RhdHVzID0gZS5pbml0c3RhdHVzO1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgZS5pbml0c3RhdHVzO1xuICAgICAgICAgICAgICAgICAgICBlLnN0b3AgJiYgYW5pbWF0aW9uRWxlbWVudHMuc3BsaWNlKGwtLSwgMSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZS5zdGF0dXMgPSAoZS5wcmV2ICsgKGUucGVyY2VudCAtIGUucHJldikgKiAodGltZSAvIG1zKSkgLyBlLmFuaW0udG9wO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGltZSA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aW1lIDwgbXMpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBvcyA9IGVhc2luZyh0aW1lIC8gbXMpO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhdHRyIGluIGZyb20pIGlmIChmcm9tW2hhc10oYXR0cikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoYXZhaWxhYmxlQW5pbUF0dHJzW2F0dHJdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBudTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm93ID0gK2Zyb21bYXR0cl0gKyBwb3MgKiBtcyAqIGRpZmZbYXR0cl07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJjb2xvdXJcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm93ID0gXCJyZ2IoXCIgKyBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cHRvMjU1KHJvdW5kKGZyb21bYXR0cl0uciArIHBvcyAqIG1zICogZGlmZlthdHRyXS5yKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cHRvMjU1KHJvdW5kKGZyb21bYXR0cl0uZyArIHBvcyAqIG1zICogZGlmZlthdHRyXS5nKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cHRvMjU1KHJvdW5kKGZyb21bYXR0cl0uYiArIHBvcyAqIG1zICogZGlmZlthdHRyXS5iKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXS5qb2luKFwiLFwiKSArIFwiKVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwicGF0aFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3cgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gZnJvbVthdHRyXS5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3dbaV0gPSBbZnJvbVthdHRyXVtpXVswXV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMSwgamogPSBmcm9tW2F0dHJdW2ldLmxlbmd0aDsgaiA8IGpqOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3dbaV1bal0gPSArZnJvbVthdHRyXVtpXVtqXSArIHBvcyAqIG1zICogZGlmZlthdHRyXVtpXVtqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vd1tpXSA9IG5vd1tpXS5qb2luKFMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vdyA9IG5vdy5qb2luKFMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwidHJhbnNmb3JtXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkaWZmW2F0dHJdLnJlYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vdyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gMCwgaWkgPSBmcm9tW2F0dHJdLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3dbaV0gPSBbZnJvbVthdHRyXVtpXVswXV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChqID0gMSwgamogPSBmcm9tW2F0dHJdW2ldLmxlbmd0aDsgaiA8IGpqOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm93W2ldW2pdID0gZnJvbVthdHRyXVtpXVtqXSArIHBvcyAqIG1zICogZGlmZlthdHRyXVtpXVtqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ2V0ID0gZnVuY3Rpb24gKGkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gK2Zyb21bYXR0cl1baV0gKyBwb3MgKiBtcyAqIGRpZmZbYXR0cl1baV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbm93ID0gW1tcInJcIiwgZ2V0KDIpLCAwLCAwXSwgW1widFwiLCBnZXQoMyksIGdldCg0KV0sIFtcInNcIiwgZ2V0KDApLCBnZXQoMSksIDAsIDBdXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vdyA9IFtbXCJtXCIsIGdldCgwKSwgZ2V0KDEpLCBnZXQoMiksIGdldCgzKSwgZ2V0KDQpLCBnZXQoNSldXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiY3N2XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdHRyID09IFwiY2xpcC1yZWN0XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vdyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaSA9IDQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm93W2ldID0gK2Zyb21bYXR0cl1baV0gKyBwb3MgKiBtcyAqIGRpZmZbYXR0cl1baV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZyb20yID0gW11bY29uY2F0XShmcm9tW2F0dHJdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm93ID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgPSB0aGF0LnBhcGVyLmN1c3RvbUF0dHJpYnV0ZXNbYXR0cl0ubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3dbaV0gPSArZnJvbTJbaV0gKyBwb3MgKiBtcyAqIGRpZmZbYXR0cl1baV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRbYXR0cl0gPSBub3c7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhhdC5hdHRyKHNldCk7XG4gICAgICAgICAgICAgICAgICAgIChmdW5jdGlvbiAoaWQsIHRoYXQsIGFuaW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZShcInJhcGhhZWwuYW5pbS5mcmFtZS5cIiArIGlkLCB0aGF0LCBhbmltKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KSh0aGF0LmlkLCB0aGF0LCBlLmFuaW0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIChmdW5jdGlvbihmLCBlbCwgYSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmUoXCJyYXBoYWVsLmFuaW0uZnJhbWUuXCIgKyBlbC5pZCwgZWwsIGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZShcInJhcGhhZWwuYW5pbS5maW5pc2guXCIgKyBlbC5pZCwgZWwsIGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFIuaXMoZiwgXCJmdW5jdGlvblwiKSAmJiBmLmNhbGwoZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pKGUuY2FsbGJhY2ssIHRoYXQsIGUuYW5pbSk7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuYXR0cih0byk7XG4gICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbkVsZW1lbnRzLnNwbGljZShsLS0sIDEpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZS5yZXBlYXQgPiAxICYmICFlLm5leHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoa2V5IGluIHRvKSBpZiAodG9baGFzXShrZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5pdFtrZXldID0gZS50b3RhbE9yaWdpbltrZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZS5lbC5hdHRyKGluaXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcnVuQW5pbWF0aW9uKGUuYW5pbSwgZS5lbCwgZS5hbmltLnBlcmNlbnRzWzBdLCBudWxsLCBlLnRvdGFsT3JpZ2luLCBlLnJlcGVhdCAtIDEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChlLm5leHQgJiYgIWUuc3RvcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcnVuQW5pbWF0aW9uKGUuYW5pbSwgZS5lbCwgZS5uZXh0LCBudWxsLCBlLnRvdGFsT3JpZ2luLCBlLnJlcGVhdCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhbmltYXRpb25FbGVtZW50cy5sZW5ndGggJiYgcmVxdWVzdEFuaW1GcmFtZShhbmltYXRpb24pO1xuICAgICAgICB9LFxuICAgICAgICB1cHRvMjU1ID0gZnVuY3Rpb24gKGNvbG9yKSB7XG4gICAgICAgICAgICByZXR1cm4gY29sb3IgPiAyNTUgPyAyNTUgOiBjb2xvciA8IDAgPyAwIDogY29sb3I7XG4gICAgICAgIH07XG4gICAgLypcXFxuICAgICAqIEVsZW1lbnQuYW5pbWF0ZVdpdGhcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIEFjdHMgc2ltaWxhciB0byBARWxlbWVudC5hbmltYXRlLCBidXQgZW5zdXJlIHRoYXQgZ2l2ZW4gYW5pbWF0aW9uIHJ1bnMgaW4gc3luYyB3aXRoIGFub3RoZXIgZ2l2ZW4gZWxlbWVudC5cbiAgICAgKipcbiAgICAgPiBQYXJhbWV0ZXJzXG4gICAgICoqXG4gICAgIC0gZWwgKG9iamVjdCkgZWxlbWVudCB0byBzeW5jIHdpdGhcbiAgICAgLSBhbmltIChvYmplY3QpIGFuaW1hdGlvbiB0byBzeW5jIHdpdGhcbiAgICAgLSBwYXJhbXMgKG9iamVjdCkgI29wdGlvbmFsIGZpbmFsIGF0dHJpYnV0ZXMgZm9yIHRoZSBlbGVtZW50LCBzZWUgYWxzbyBARWxlbWVudC5hdHRyXG4gICAgIC0gbXMgKG51bWJlcikgI29wdGlvbmFsIG51bWJlciBvZiBtaWxsaXNlY29uZHMgZm9yIGFuaW1hdGlvbiB0byBydW5cbiAgICAgLSBlYXNpbmcgKHN0cmluZykgI29wdGlvbmFsIGVhc2luZyB0eXBlLiBBY2NlcHQgb24gb2YgQFJhcGhhZWwuZWFzaW5nX2Zvcm11bGFzIG9yIENTUyBmb3JtYXQ6IGBjdWJpYyYjeDIwMTA7YmV6aWVyKFhYLCYjMTYwO1hYLCYjMTYwO1hYLCYjMTYwO1hYKWBcbiAgICAgLSBjYWxsYmFjayAoZnVuY3Rpb24pICNvcHRpb25hbCBjYWxsYmFjayBmdW5jdGlvbi4gV2lsbCBiZSBjYWxsZWQgYXQgdGhlIGVuZCBvZiBhbmltYXRpb24uXG4gICAgICogb3JcbiAgICAgLSBlbGVtZW50IChvYmplY3QpIGVsZW1lbnQgdG8gc3luYyB3aXRoXG4gICAgIC0gYW5pbSAob2JqZWN0KSBhbmltYXRpb24gdG8gc3luYyB3aXRoXG4gICAgIC0gYW5pbWF0aW9uIChvYmplY3QpICNvcHRpb25hbCBhbmltYXRpb24gb2JqZWN0LCBzZWUgQFJhcGhhZWwuYW5pbWF0aW9uXG4gICAgICoqXG4gICAgID0gKG9iamVjdCkgb3JpZ2luYWwgZWxlbWVudFxuICAgIFxcKi9cbiAgICBlbHByb3RvLmFuaW1hdGVXaXRoID0gZnVuY3Rpb24gKGVsLCBhbmltLCBwYXJhbXMsIG1zLCBlYXNpbmcsIGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBlbGVtZW50ID0gdGhpcztcbiAgICAgICAgaWYgKGVsZW1lbnQucmVtb3ZlZCkge1xuICAgICAgICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2suY2FsbChlbGVtZW50KTtcbiAgICAgICAgICAgIHJldHVybiBlbGVtZW50O1xuICAgICAgICB9XG4gICAgICAgIHZhciBhID0gcGFyYW1zIGluc3RhbmNlb2YgQW5pbWF0aW9uID8gcGFyYW1zIDogUi5hbmltYXRpb24ocGFyYW1zLCBtcywgZWFzaW5nLCBjYWxsYmFjayksXG4gICAgICAgICAgICB4LCB5O1xuICAgICAgICBydW5BbmltYXRpb24oYSwgZWxlbWVudCwgYS5wZXJjZW50c1swXSwgbnVsbCwgZWxlbWVudC5hdHRyKCkpO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBhbmltYXRpb25FbGVtZW50cy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoYW5pbWF0aW9uRWxlbWVudHNbaV0uYW5pbSA9PSBhbmltICYmIGFuaW1hdGlvbkVsZW1lbnRzW2ldLmVsID09IGVsKSB7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uRWxlbWVudHNbaWkgLSAxXS5zdGFydCA9IGFuaW1hdGlvbkVsZW1lbnRzW2ldLnN0YXJ0O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBlbGVtZW50O1xuICAgICAgICAvL1xuICAgICAgICAvL1xuICAgICAgICAvLyB2YXIgYSA9IHBhcmFtcyA/IFIuYW5pbWF0aW9uKHBhcmFtcywgbXMsIGVhc2luZywgY2FsbGJhY2spIDogYW5pbSxcbiAgICAgICAgLy8gICAgIHN0YXR1cyA9IGVsZW1lbnQuc3RhdHVzKGFuaW0pO1xuICAgICAgICAvLyByZXR1cm4gdGhpcy5hbmltYXRlKGEpLnN0YXR1cyhhLCBzdGF0dXMgKiBhbmltLm1zIC8gYS5tcyk7XG4gICAgfTtcbiAgICBmdW5jdGlvbiBDdWJpY0JlemllckF0VGltZSh0LCBwMXgsIHAxeSwgcDJ4LCBwMnksIGR1cmF0aW9uKSB7XG4gICAgICAgIHZhciBjeCA9IDMgKiBwMXgsXG4gICAgICAgICAgICBieCA9IDMgKiAocDJ4IC0gcDF4KSAtIGN4LFxuICAgICAgICAgICAgYXggPSAxIC0gY3ggLSBieCxcbiAgICAgICAgICAgIGN5ID0gMyAqIHAxeSxcbiAgICAgICAgICAgIGJ5ID0gMyAqIChwMnkgLSBwMXkpIC0gY3ksXG4gICAgICAgICAgICBheSA9IDEgLSBjeSAtIGJ5O1xuICAgICAgICBmdW5jdGlvbiBzYW1wbGVDdXJ2ZVgodCkge1xuICAgICAgICAgICAgcmV0dXJuICgoYXggKiB0ICsgYngpICogdCArIGN4KSAqIHQ7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gc29sdmUoeCwgZXBzaWxvbikge1xuICAgICAgICAgICAgdmFyIHQgPSBzb2x2ZUN1cnZlWCh4LCBlcHNpbG9uKTtcbiAgICAgICAgICAgIHJldHVybiAoKGF5ICogdCArIGJ5KSAqIHQgKyBjeSkgKiB0O1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHNvbHZlQ3VydmVYKHgsIGVwc2lsb24pIHtcbiAgICAgICAgICAgIHZhciB0MCwgdDEsIHQyLCB4MiwgZDIsIGk7XG4gICAgICAgICAgICBmb3IodDIgPSB4LCBpID0gMDsgaSA8IDg7IGkrKykge1xuICAgICAgICAgICAgICAgIHgyID0gc2FtcGxlQ3VydmVYKHQyKSAtIHg7XG4gICAgICAgICAgICAgICAgaWYgKGFicyh4MikgPCBlcHNpbG9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0MjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZDIgPSAoMyAqIGF4ICogdDIgKyAyICogYngpICogdDIgKyBjeDtcbiAgICAgICAgICAgICAgICBpZiAoYWJzKGQyKSA8IDFlLTYpIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHQyID0gdDIgLSB4MiAvIGQyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdDAgPSAwO1xuICAgICAgICAgICAgdDEgPSAxO1xuICAgICAgICAgICAgdDIgPSB4O1xuICAgICAgICAgICAgaWYgKHQyIDwgdDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodDIgPiB0MSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0MTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHdoaWxlICh0MCA8IHQxKSB7XG4gICAgICAgICAgICAgICAgeDIgPSBzYW1wbGVDdXJ2ZVgodDIpO1xuICAgICAgICAgICAgICAgIGlmIChhYnMoeDIgLSB4KSA8IGVwc2lsb24pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoeCA+IHgyKSB7XG4gICAgICAgICAgICAgICAgICAgIHQwID0gdDI7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdDEgPSB0MjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdDIgPSAodDEgLSB0MCkgLyAyICsgdDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdDI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNvbHZlKHQsIDEgLyAoMjAwICogZHVyYXRpb24pKTtcbiAgICB9XG4gICAgZWxwcm90by5vbkFuaW1hdGlvbiA9IGZ1bmN0aW9uIChmKSB7XG4gICAgICAgIGYgPyBldmUub24oXCJyYXBoYWVsLmFuaW0uZnJhbWUuXCIgKyB0aGlzLmlkLCBmKSA6IGV2ZS51bmJpbmQoXCJyYXBoYWVsLmFuaW0uZnJhbWUuXCIgKyB0aGlzLmlkKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBmdW5jdGlvbiBBbmltYXRpb24oYW5pbSwgbXMpIHtcbiAgICAgICAgdmFyIHBlcmNlbnRzID0gW10sXG4gICAgICAgICAgICBuZXdBbmltID0ge307XG4gICAgICAgIHRoaXMubXMgPSBtcztcbiAgICAgICAgdGhpcy50aW1lcyA9IDE7XG4gICAgICAgIGlmIChhbmltKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBhdHRyIGluIGFuaW0pIGlmIChhbmltW2hhc10oYXR0cikpIHtcbiAgICAgICAgICAgICAgICBuZXdBbmltW3RvRmxvYXQoYXR0cildID0gYW5pbVthdHRyXTtcbiAgICAgICAgICAgICAgICBwZXJjZW50cy5wdXNoKHRvRmxvYXQoYXR0cikpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcGVyY2VudHMuc29ydChzb3J0QnlOdW1iZXIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYW5pbSA9IG5ld0FuaW07XG4gICAgICAgIHRoaXMudG9wID0gcGVyY2VudHNbcGVyY2VudHMubGVuZ3RoIC0gMV07XG4gICAgICAgIHRoaXMucGVyY2VudHMgPSBwZXJjZW50cztcbiAgICB9XG4gICAgLypcXFxuICAgICAqIEFuaW1hdGlvbi5kZWxheVxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogQ3JlYXRlcyBhIGNvcHkgb2YgZXhpc3RpbmcgYW5pbWF0aW9uIG9iamVjdCB3aXRoIGdpdmVuIGRlbGF5LlxuICAgICAqKlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgKipcbiAgICAgLSBkZWxheSAobnVtYmVyKSBudW1iZXIgb2YgbXMgdG8gcGFzcyBiZXR3ZWVuIGFuaW1hdGlvbiBzdGFydCBhbmQgYWN0dWFsIGFuaW1hdGlvblxuICAgICAqKlxuICAgICA9IChvYmplY3QpIG5ldyBhbHRlcmVkIEFuaW1hdGlvbiBvYmplY3RcbiAgICAgfCB2YXIgYW5pbSA9IFJhcGhhZWwuYW5pbWF0aW9uKHtjeDogMTAsIGN5OiAyMH0sIDJlMyk7XG4gICAgIHwgY2lyY2xlMS5hbmltYXRlKGFuaW0pOyAvLyBydW4gdGhlIGdpdmVuIGFuaW1hdGlvbiBpbW1lZGlhdGVseVxuICAgICB8IGNpcmNsZTIuYW5pbWF0ZShhbmltLmRlbGF5KDUwMCkpOyAvLyBydW4gdGhlIGdpdmVuIGFuaW1hdGlvbiBhZnRlciA1MDAgbXNcbiAgICBcXCovXG4gICAgQW5pbWF0aW9uLnByb3RvdHlwZS5kZWxheSA9IGZ1bmN0aW9uIChkZWxheSkge1xuICAgICAgICB2YXIgYSA9IG5ldyBBbmltYXRpb24odGhpcy5hbmltLCB0aGlzLm1zKTtcbiAgICAgICAgYS50aW1lcyA9IHRoaXMudGltZXM7XG4gICAgICAgIGEuZGVsID0gK2RlbGF5IHx8IDA7XG4gICAgICAgIHJldHVybiBhO1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIEFuaW1hdGlvbi5yZXBlYXRcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIENyZWF0ZXMgYSBjb3B5IG9mIGV4aXN0aW5nIGFuaW1hdGlvbiBvYmplY3Qgd2l0aCBnaXZlbiByZXBldGl0aW9uLlxuICAgICAqKlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgKipcbiAgICAgLSByZXBlYXQgKG51bWJlcikgbnVtYmVyIGl0ZXJhdGlvbnMgb2YgYW5pbWF0aW9uLiBGb3IgaW5maW5pdGUgYW5pbWF0aW9uIHBhc3MgYEluZmluaXR5YFxuICAgICAqKlxuICAgICA9IChvYmplY3QpIG5ldyBhbHRlcmVkIEFuaW1hdGlvbiBvYmplY3RcbiAgICBcXCovXG4gICAgQW5pbWF0aW9uLnByb3RvdHlwZS5yZXBlYXQgPSBmdW5jdGlvbiAodGltZXMpIHtcbiAgICAgICAgdmFyIGEgPSBuZXcgQW5pbWF0aW9uKHRoaXMuYW5pbSwgdGhpcy5tcyk7XG4gICAgICAgIGEuZGVsID0gdGhpcy5kZWw7XG4gICAgICAgIGEudGltZXMgPSBtYXRoLmZsb29yKG1tYXgodGltZXMsIDApKSB8fCAxO1xuICAgICAgICByZXR1cm4gYTtcbiAgICB9O1xuICAgIGZ1bmN0aW9uIHJ1bkFuaW1hdGlvbihhbmltLCBlbGVtZW50LCBwZXJjZW50LCBzdGF0dXMsIHRvdGFsT3JpZ2luLCB0aW1lcykge1xuICAgICAgICBwZXJjZW50ID0gdG9GbG9hdChwZXJjZW50KTtcbiAgICAgICAgdmFyIHBhcmFtcyxcbiAgICAgICAgICAgIGlzSW5BbmltLFxuICAgICAgICAgICAgaXNJbkFuaW1TZXQsXG4gICAgICAgICAgICBwZXJjZW50cyA9IFtdLFxuICAgICAgICAgICAgbmV4dCxcbiAgICAgICAgICAgIHByZXYsXG4gICAgICAgICAgICB0aW1lc3RhbXAsXG4gICAgICAgICAgICBtcyA9IGFuaW0ubXMsXG4gICAgICAgICAgICBmcm9tID0ge30sXG4gICAgICAgICAgICB0byA9IHt9LFxuICAgICAgICAgICAgZGlmZiA9IHt9O1xuICAgICAgICBpZiAoc3RhdHVzKSB7XG4gICAgICAgICAgICBmb3IgKGkgPSAwLCBpaSA9IGFuaW1hdGlvbkVsZW1lbnRzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgZSA9IGFuaW1hdGlvbkVsZW1lbnRzW2ldO1xuICAgICAgICAgICAgICAgIGlmIChlLmVsLmlkID09IGVsZW1lbnQuaWQgJiYgZS5hbmltID09IGFuaW0pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUucGVyY2VudCAhPSBwZXJjZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRpb25FbGVtZW50cy5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpc0luQW5pbVNldCA9IDE7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpc0luQW5pbSA9IGU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5hdHRyKGUudG90YWxPcmlnaW4pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdGF0dXMgPSArdG87IC8vIE5hTlxuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IGFuaW0ucGVyY2VudHMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuICAgICAgICAgICAgaWYgKGFuaW0ucGVyY2VudHNbaV0gPT0gcGVyY2VudCB8fCBhbmltLnBlcmNlbnRzW2ldID4gc3RhdHVzICogYW5pbS50b3ApIHtcbiAgICAgICAgICAgICAgICBwZXJjZW50ID0gYW5pbS5wZXJjZW50c1tpXTtcbiAgICAgICAgICAgICAgICBwcmV2ID0gYW5pbS5wZXJjZW50c1tpIC0gMV0gfHwgMDtcbiAgICAgICAgICAgICAgICBtcyA9IG1zIC8gYW5pbS50b3AgKiAocGVyY2VudCAtIHByZXYpO1xuICAgICAgICAgICAgICAgIG5leHQgPSBhbmltLnBlcmNlbnRzW2kgKyAxXTtcbiAgICAgICAgICAgICAgICBwYXJhbXMgPSBhbmltLmFuaW1bcGVyY2VudF07XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHN0YXR1cykge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuYXR0cihhbmltLmFuaW1bYW5pbS5wZXJjZW50c1tpXV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICghcGFyYW1zKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFpc0luQW5pbSkge1xuICAgICAgICAgICAgZm9yICh2YXIgYXR0ciBpbiBwYXJhbXMpIGlmIChwYXJhbXNbaGFzXShhdHRyKSkge1xuICAgICAgICAgICAgICAgIGlmIChhdmFpbGFibGVBbmltQXR0cnNbaGFzXShhdHRyKSB8fCBlbGVtZW50LnBhcGVyLmN1c3RvbUF0dHJpYnV0ZXNbaGFzXShhdHRyKSkge1xuICAgICAgICAgICAgICAgICAgICBmcm9tW2F0dHJdID0gZWxlbWVudC5hdHRyKGF0dHIpO1xuICAgICAgICAgICAgICAgICAgICAoZnJvbVthdHRyXSA9PSBudWxsKSAmJiAoZnJvbVthdHRyXSA9IGF2YWlsYWJsZUF0dHJzW2F0dHJdKTtcbiAgICAgICAgICAgICAgICAgICAgdG9bYXR0cl0gPSBwYXJhbXNbYXR0cl07XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoYXZhaWxhYmxlQW5pbUF0dHJzW2F0dHJdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIG51OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpZmZbYXR0cl0gPSAodG9bYXR0cl0gLSBmcm9tW2F0dHJdKSAvIG1zO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImNvbG91clwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb21bYXR0cl0gPSBSLmdldFJHQihmcm9tW2F0dHJdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG9Db2xvdXIgPSBSLmdldFJHQih0b1thdHRyXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlmZlthdHRyXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcjogKHRvQ29sb3VyLnIgLSBmcm9tW2F0dHJdLnIpIC8gbXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGc6ICh0b0NvbG91ci5nIC0gZnJvbVthdHRyXS5nKSAvIG1zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiOiAodG9Db2xvdXIuYiAtIGZyb21bYXR0cl0uYikgLyBtc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwicGF0aFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXRoZXMgPSBwYXRoMmN1cnZlKGZyb21bYXR0cl0sIHRvW2F0dHJdKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9QYXRoID0gcGF0aGVzWzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb21bYXR0cl0gPSBwYXRoZXNbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlmZlthdHRyXSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaSA9IDAsIGlpID0gZnJvbVthdHRyXS5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpZmZbYXR0cl1baV0gPSBbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAxLCBqaiA9IGZyb21bYXR0cl1baV0ubGVuZ3RoOyBqIDwgamo7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlmZlthdHRyXVtpXVtqXSA9ICh0b1BhdGhbaV1bal0gLSBmcm9tW2F0dHJdW2ldW2pdKSAvIG1zO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcInRyYW5zZm9ybVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfID0gZWxlbWVudC5fLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcSA9IGVxdWFsaXNlVHJhbnNmb3JtKF9bYXR0cl0sIHRvW2F0dHJdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbVthdHRyXSA9IGVxLmZyb207XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvW2F0dHJdID0gZXEudG87XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpZmZbYXR0cl0gPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlmZlthdHRyXS5yZWFsID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gMCwgaWkgPSBmcm9tW2F0dHJdLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpZmZbYXR0cl1baV0gPSBbZnJvbVthdHRyXVtpXVswXV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGogPSAxLCBqaiA9IGZyb21bYXR0cl1baV0ubGVuZ3RoOyBqIDwgamo7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpZmZbYXR0cl1baV1bal0gPSAodG9bYXR0cl1baV1bal0gLSBmcm9tW2F0dHJdW2ldW2pdKSAvIG1zO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG0gPSAoZWxlbWVudC5tYXRyaXggfHwgbmV3IE1hdHJpeCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bzIgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXzoge3RyYW5zZm9ybTogXy50cmFuc2Zvcm19LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldEJCb3g6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQuZ2V0QkJveCgxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcm9tW2F0dHJdID0gW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbS5hLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbS5iLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbS5jLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbS5kLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbS5lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbS5mXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhY3RUcmFuc2Zvcm0odG8yLCB0b1thdHRyXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvW2F0dHJdID0gdG8yLl8udHJhbnNmb3JtO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaWZmW2F0dHJdID0gW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHRvMi5tYXRyaXguYSAtIG0uYSkgLyBtcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICh0bzIubWF0cml4LmIgLSBtLmIpIC8gbXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAodG8yLm1hdHJpeC5jIC0gbS5jKSAvIG1zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHRvMi5tYXRyaXguZCAtIG0uZCkgLyBtcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICh0bzIubWF0cml4LmUgLSBtLmUpIC8gbXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAodG8yLm1hdHJpeC5mIC0gbS5mKSAvIG1zXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZyb21bYXR0cl0gPSBbXy5zeCwgXy5zeSwgXy5kZWcsIF8uZHgsIF8uZHldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB2YXIgdG8yID0ge186e30sIGdldEJCb3g6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGVsZW1lbnQuZ2V0QkJveCgpOyB9fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXh0cmFjdFRyYW5zZm9ybSh0bzIsIHRvW2F0dHJdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZGlmZlthdHRyXSA9IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICh0bzIuXy5zeCAtIF8uc3gpIC8gbXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAodG8yLl8uc3kgLSBfLnN5KSAvIG1zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgKHRvMi5fLmRlZyAtIF8uZGVnKSAvIG1zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgKHRvMi5fLmR4IC0gXy5keCkgLyBtcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICh0bzIuXy5keSAtIF8uZHkpIC8gbXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiY3N2XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlcyA9IFN0cihwYXJhbXNbYXR0cl0pW3NwbGl0XShzZXBhcmF0b3IpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcm9tMiA9IFN0cihmcm9tW2F0dHJdKVtzcGxpdF0oc2VwYXJhdG9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXR0ciA9PSBcImNsaXAtcmVjdFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb21bYXR0cl0gPSBmcm9tMjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlmZlthdHRyXSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpID0gZnJvbTIubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaWZmW2F0dHJdW2ldID0gKHZhbHVlc1tpXSAtIGZyb21bYXR0cl1baV0pIC8gbXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9bYXR0cl0gPSB2YWx1ZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlcyA9IFtdW2NvbmNhdF0ocGFyYW1zW2F0dHJdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcm9tMiA9IFtdW2NvbmNhdF0oZnJvbVthdHRyXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlmZlthdHRyXSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgPSBlbGVtZW50LnBhcGVyLmN1c3RvbUF0dHJpYnV0ZXNbYXR0cl0ubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlmZlthdHRyXVtpXSA9ICgodmFsdWVzW2ldIHx8IDApIC0gKGZyb20yW2ldIHx8IDApKSAvIG1zO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBlYXNpbmcgPSBwYXJhbXMuZWFzaW5nLFxuICAgICAgICAgICAgICAgIGVhc3llYXN5ID0gUi5lYXNpbmdfZm9ybXVsYXNbZWFzaW5nXTtcbiAgICAgICAgICAgIGlmICghZWFzeWVhc3kpIHtcbiAgICAgICAgICAgICAgICBlYXN5ZWFzeSA9IFN0cihlYXNpbmcpLm1hdGNoKGJlemllcnJnKTtcbiAgICAgICAgICAgICAgICBpZiAoZWFzeWVhc3kgJiYgZWFzeWVhc3kubGVuZ3RoID09IDUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnZlID0gZWFzeWVhc3k7XG4gICAgICAgICAgICAgICAgICAgIGVhc3llYXN5ID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBDdWJpY0JlemllckF0VGltZSh0LCArY3VydmVbMV0sICtjdXJ2ZVsyXSwgK2N1cnZlWzNdLCArY3VydmVbNF0sIG1zKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBlYXN5ZWFzeSA9IHBpcGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGltZXN0YW1wID0gcGFyYW1zLnN0YXJ0IHx8IGFuaW0uc3RhcnQgfHwgK25ldyBEYXRlO1xuICAgICAgICAgICAgZSA9IHtcbiAgICAgICAgICAgICAgICBhbmltOiBhbmltLFxuICAgICAgICAgICAgICAgIHBlcmNlbnQ6IHBlcmNlbnQsXG4gICAgICAgICAgICAgICAgdGltZXN0YW1wOiB0aW1lc3RhbXAsXG4gICAgICAgICAgICAgICAgc3RhcnQ6IHRpbWVzdGFtcCArIChhbmltLmRlbCB8fCAwKSxcbiAgICAgICAgICAgICAgICBzdGF0dXM6IDAsXG4gICAgICAgICAgICAgICAgaW5pdHN0YXR1czogc3RhdHVzIHx8IDAsXG4gICAgICAgICAgICAgICAgc3RvcDogZmFsc2UsXG4gICAgICAgICAgICAgICAgbXM6IG1zLFxuICAgICAgICAgICAgICAgIGVhc2luZzogZWFzeWVhc3ksXG4gICAgICAgICAgICAgICAgZnJvbTogZnJvbSxcbiAgICAgICAgICAgICAgICBkaWZmOiBkaWZmLFxuICAgICAgICAgICAgICAgIHRvOiB0byxcbiAgICAgICAgICAgICAgICBlbDogZWxlbWVudCxcbiAgICAgICAgICAgICAgICBjYWxsYmFjazogcGFyYW1zLmNhbGxiYWNrLFxuICAgICAgICAgICAgICAgIHByZXY6IHByZXYsXG4gICAgICAgICAgICAgICAgbmV4dDogbmV4dCxcbiAgICAgICAgICAgICAgICByZXBlYXQ6IHRpbWVzIHx8IGFuaW0udGltZXMsXG4gICAgICAgICAgICAgICAgb3JpZ2luOiBlbGVtZW50LmF0dHIoKSxcbiAgICAgICAgICAgICAgICB0b3RhbE9yaWdpbjogdG90YWxPcmlnaW5cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBhbmltYXRpb25FbGVtZW50cy5wdXNoKGUpO1xuICAgICAgICAgICAgaWYgKHN0YXR1cyAmJiAhaXNJbkFuaW0gJiYgIWlzSW5BbmltU2V0KSB7XG4gICAgICAgICAgICAgICAgZS5zdG9wID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBlLnN0YXJ0ID0gbmV3IERhdGUgLSBtcyAqIHN0YXR1cztcbiAgICAgICAgICAgICAgICBpZiAoYW5pbWF0aW9uRWxlbWVudHMubGVuZ3RoID09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFuaW1hdGlvbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpc0luQW5pbVNldCkge1xuICAgICAgICAgICAgICAgIGUuc3RhcnQgPSBuZXcgRGF0ZSAtIGUubXMgKiBzdGF0dXM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhbmltYXRpb25FbGVtZW50cy5sZW5ndGggPT0gMSAmJiByZXF1ZXN0QW5pbUZyYW1lKGFuaW1hdGlvbik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpc0luQW5pbS5pbml0c3RhdHVzID0gc3RhdHVzO1xuICAgICAgICAgICAgaXNJbkFuaW0uc3RhcnQgPSBuZXcgRGF0ZSAtIGlzSW5BbmltLm1zICogc3RhdHVzO1xuICAgICAgICB9XG4gICAgICAgIGV2ZShcInJhcGhhZWwuYW5pbS5zdGFydC5cIiArIGVsZW1lbnQuaWQsIGVsZW1lbnQsIGFuaW0pO1xuICAgIH1cbiAgICAvKlxcXG4gICAgICogUmFwaGFlbC5hbmltYXRpb25cbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIENyZWF0ZXMgYW4gYW5pbWF0aW9uIG9iamVjdCB0aGF0IGNhbiBiZSBwYXNzZWQgdG8gdGhlIEBFbGVtZW50LmFuaW1hdGUgb3IgQEVsZW1lbnQuYW5pbWF0ZVdpdGggbWV0aG9kcy5cbiAgICAgKiBTZWUgYWxzbyBAQW5pbWF0aW9uLmRlbGF5IGFuZCBAQW5pbWF0aW9uLnJlcGVhdCBtZXRob2RzLlxuICAgICAqKlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgKipcbiAgICAgLSBwYXJhbXMgKG9iamVjdCkgZmluYWwgYXR0cmlidXRlcyBmb3IgdGhlIGVsZW1lbnQsIHNlZSBhbHNvIEBFbGVtZW50LmF0dHJcbiAgICAgLSBtcyAobnVtYmVyKSBudW1iZXIgb2YgbWlsbGlzZWNvbmRzIGZvciBhbmltYXRpb24gdG8gcnVuXG4gICAgIC0gZWFzaW5nIChzdHJpbmcpICNvcHRpb25hbCBlYXNpbmcgdHlwZS4gQWNjZXB0IG9uZSBvZiBAUmFwaGFlbC5lYXNpbmdfZm9ybXVsYXMgb3IgQ1NTIGZvcm1hdDogYGN1YmljJiN4MjAxMDtiZXppZXIoWFgsJiMxNjA7WFgsJiMxNjA7WFgsJiMxNjA7WFgpYFxuICAgICAtIGNhbGxiYWNrIChmdW5jdGlvbikgI29wdGlvbmFsIGNhbGxiYWNrIGZ1bmN0aW9uLiBXaWxsIGJlIGNhbGxlZCBhdCB0aGUgZW5kIG9mIGFuaW1hdGlvbi5cbiAgICAgKipcbiAgICAgPSAob2JqZWN0KSBAQW5pbWF0aW9uXG4gICAgXFwqL1xuICAgIFIuYW5pbWF0aW9uID0gZnVuY3Rpb24gKHBhcmFtcywgbXMsIGVhc2luZywgY2FsbGJhY2spIHtcbiAgICAgICAgaWYgKHBhcmFtcyBpbnN0YW5jZW9mIEFuaW1hdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuIHBhcmFtcztcbiAgICAgICAgfVxuICAgICAgICBpZiAoUi5pcyhlYXNpbmcsIFwiZnVuY3Rpb25cIikgfHwgIWVhc2luZykge1xuICAgICAgICAgICAgY2FsbGJhY2sgPSBjYWxsYmFjayB8fCBlYXNpbmcgfHwgbnVsbDtcbiAgICAgICAgICAgIGVhc2luZyA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcGFyYW1zID0gT2JqZWN0KHBhcmFtcyk7XG4gICAgICAgIG1zID0gK21zIHx8IDA7XG4gICAgICAgIHZhciBwID0ge30sXG4gICAgICAgICAgICBqc29uLFxuICAgICAgICAgICAgYXR0cjtcbiAgICAgICAgZm9yIChhdHRyIGluIHBhcmFtcykgaWYgKHBhcmFtc1toYXNdKGF0dHIpICYmIHRvRmxvYXQoYXR0cikgIT0gYXR0ciAmJiB0b0Zsb2F0KGF0dHIpICsgXCIlXCIgIT0gYXR0cikge1xuICAgICAgICAgICAganNvbiA9IHRydWU7XG4gICAgICAgICAgICBwW2F0dHJdID0gcGFyYW1zW2F0dHJdO1xuICAgICAgICB9XG4gICAgICAgIGlmICghanNvbikge1xuICAgICAgICAgICAgLy8gaWYgcGVyY2VudC1saWtlIHN5bnRheCBpcyB1c2VkIGFuZCBlbmQtb2YtYWxsIGFuaW1hdGlvbiBjYWxsYmFjayB1c2VkXG4gICAgICAgICAgICBpZihjYWxsYmFjayl7XG4gICAgICAgICAgICAgICAgLy8gZmluZCB0aGUgbGFzdCBvbmVcbiAgICAgICAgICAgICAgICB2YXIgbGFzdEtleSA9IDA7XG4gICAgICAgICAgICAgICAgZm9yKHZhciBpIGluIHBhcmFtcyl7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwZXJjZW50ID0gdG9JbnQoaSk7XG4gICAgICAgICAgICAgICAgICAgIGlmKHBhcmFtc1toYXNdKGkpICYmIHBlcmNlbnQgPiBsYXN0S2V5KXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RLZXkgPSBwZXJjZW50O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGxhc3RLZXkgKz0gJyUnO1xuICAgICAgICAgICAgICAgIC8vIGlmIGFscmVhZHkgZGVmaW5lZCBjYWxsYmFjayBpbiB0aGUgbGFzdCBrZXlmcmFtZSwgc2tpcFxuICAgICAgICAgICAgICAgICFwYXJhbXNbbGFzdEtleV0uY2FsbGJhY2sgJiYgKHBhcmFtc1tsYXN0S2V5XS5jYWxsYmFjayA9IGNhbGxiYWNrKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gbmV3IEFuaW1hdGlvbihwYXJhbXMsIG1zKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGVhc2luZyAmJiAocC5lYXNpbmcgPSBlYXNpbmcpO1xuICAgICAgICAgICAgY2FsbGJhY2sgJiYgKHAuY2FsbGJhY2sgPSBjYWxsYmFjayk7XG4gICAgICAgICAgICByZXR1cm4gbmV3IEFuaW1hdGlvbih7MTAwOiBwfSwgbXMpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKlxcXG4gICAgICogRWxlbWVudC5hbmltYXRlXG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBDcmVhdGVzIGFuZCBzdGFydHMgYW5pbWF0aW9uIGZvciBnaXZlbiBlbGVtZW50LlxuICAgICAqKlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgKipcbiAgICAgLSBwYXJhbXMgKG9iamVjdCkgZmluYWwgYXR0cmlidXRlcyBmb3IgdGhlIGVsZW1lbnQsIHNlZSBhbHNvIEBFbGVtZW50LmF0dHJcbiAgICAgLSBtcyAobnVtYmVyKSBudW1iZXIgb2YgbWlsbGlzZWNvbmRzIGZvciBhbmltYXRpb24gdG8gcnVuXG4gICAgIC0gZWFzaW5nIChzdHJpbmcpICNvcHRpb25hbCBlYXNpbmcgdHlwZS4gQWNjZXB0IG9uZSBvZiBAUmFwaGFlbC5lYXNpbmdfZm9ybXVsYXMgb3IgQ1NTIGZvcm1hdDogYGN1YmljJiN4MjAxMDtiZXppZXIoWFgsJiMxNjA7WFgsJiMxNjA7WFgsJiMxNjA7WFgpYFxuICAgICAtIGNhbGxiYWNrIChmdW5jdGlvbikgI29wdGlvbmFsIGNhbGxiYWNrIGZ1bmN0aW9uLiBXaWxsIGJlIGNhbGxlZCBhdCB0aGUgZW5kIG9mIGFuaW1hdGlvbi5cbiAgICAgKiBvclxuICAgICAtIGFuaW1hdGlvbiAob2JqZWN0KSBhbmltYXRpb24gb2JqZWN0LCBzZWUgQFJhcGhhZWwuYW5pbWF0aW9uXG4gICAgICoqXG4gICAgID0gKG9iamVjdCkgb3JpZ2luYWwgZWxlbWVudFxuICAgIFxcKi9cbiAgICBlbHByb3RvLmFuaW1hdGUgPSBmdW5jdGlvbiAocGFyYW1zLCBtcywgZWFzaW5nLCBjYWxsYmFjaykge1xuICAgICAgICB2YXIgZWxlbWVudCA9IHRoaXM7XG4gICAgICAgIGlmIChlbGVtZW50LnJlbW92ZWQpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrICYmIGNhbGxiYWNrLmNhbGwoZWxlbWVudCk7XG4gICAgICAgICAgICByZXR1cm4gZWxlbWVudDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYW5pbSA9IHBhcmFtcyBpbnN0YW5jZW9mIEFuaW1hdGlvbiA/IHBhcmFtcyA6IFIuYW5pbWF0aW9uKHBhcmFtcywgbXMsIGVhc2luZywgY2FsbGJhY2spO1xuICAgICAgICBydW5BbmltYXRpb24oYW5pbSwgZWxlbWVudCwgYW5pbS5wZXJjZW50c1swXSwgbnVsbCwgZWxlbWVudC5hdHRyKCkpO1xuICAgICAgICByZXR1cm4gZWxlbWVudDtcbiAgICB9O1xuICAgIC8qXFxcbiAgICAgKiBFbGVtZW50LnNldFRpbWVcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIFNldHMgdGhlIHN0YXR1cyBvZiBhbmltYXRpb24gb2YgdGhlIGVsZW1lbnQgaW4gbWlsbGlzZWNvbmRzLiBTaW1pbGFyIHRvIEBFbGVtZW50LnN0YXR1cyBtZXRob2QuXG4gICAgICoqXG4gICAgID4gUGFyYW1ldGVyc1xuICAgICAqKlxuICAgICAtIGFuaW0gKG9iamVjdCkgYW5pbWF0aW9uIG9iamVjdFxuICAgICAtIHZhbHVlIChudW1iZXIpIG51bWJlciBvZiBtaWxsaXNlY29uZHMgZnJvbSB0aGUgYmVnaW5uaW5nIG9mIHRoZSBhbmltYXRpb25cbiAgICAgKipcbiAgICAgPSAob2JqZWN0KSBvcmlnaW5hbCBlbGVtZW50IGlmIGB2YWx1ZWAgaXMgc3BlY2lmaWVkXG4gICAgICogTm90ZSwgdGhhdCBkdXJpbmcgYW5pbWF0aW9uIGZvbGxvd2luZyBldmVudHMgYXJlIHRyaWdnZXJlZDpcbiAgICAgKlxuICAgICAqIE9uIGVhY2ggYW5pbWF0aW9uIGZyYW1lIGV2ZW50IGBhbmltLmZyYW1lLjxpZD5gLCBvbiBzdGFydCBgYW5pbS5zdGFydC48aWQ+YCBhbmQgb24gZW5kIGBhbmltLmZpbmlzaC48aWQ+YC5cbiAgICBcXCovXG4gICAgZWxwcm90by5zZXRUaW1lID0gZnVuY3Rpb24gKGFuaW0sIHZhbHVlKSB7XG4gICAgICAgIGlmIChhbmltICYmIHZhbHVlICE9IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuc3RhdHVzKGFuaW0sIG1taW4odmFsdWUsIGFuaW0ubXMpIC8gYW5pbS5tcyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICAvKlxcXG4gICAgICogRWxlbWVudC5zdGF0dXNcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIEdldHMgb3Igc2V0cyB0aGUgc3RhdHVzIG9mIGFuaW1hdGlvbiBvZiB0aGUgZWxlbWVudC5cbiAgICAgKipcbiAgICAgPiBQYXJhbWV0ZXJzXG4gICAgICoqXG4gICAgIC0gYW5pbSAob2JqZWN0KSAjb3B0aW9uYWwgYW5pbWF0aW9uIG9iamVjdFxuICAgICAtIHZhbHVlIChudW1iZXIpICNvcHRpb25hbCAwIOKAkyAxLiBJZiBzcGVjaWZpZWQsIG1ldGhvZCB3b3JrcyBsaWtlIGEgc2V0dGVyIGFuZCBzZXRzIHRoZSBzdGF0dXMgb2YgYSBnaXZlbiBhbmltYXRpb24gdG8gdGhlIHZhbHVlLiBUaGlzIHdpbGwgY2F1c2UgYW5pbWF0aW9uIHRvIGp1bXAgdG8gdGhlIGdpdmVuIHBvc2l0aW9uLlxuICAgICAqKlxuICAgICA9IChudW1iZXIpIHN0YXR1c1xuICAgICAqIG9yXG4gICAgID0gKGFycmF5KSBzdGF0dXMgaWYgYGFuaW1gIGlzIG5vdCBzcGVjaWZpZWQuIEFycmF5IG9mIG9iamVjdHMgaW4gZm9ybWF0OlxuICAgICBvIHtcbiAgICAgbyAgICAgYW5pbTogKG9iamVjdCkgYW5pbWF0aW9uIG9iamVjdFxuICAgICBvICAgICBzdGF0dXM6IChudW1iZXIpIHN0YXR1c1xuICAgICBvIH1cbiAgICAgKiBvclxuICAgICA9IChvYmplY3QpIG9yaWdpbmFsIGVsZW1lbnQgaWYgYHZhbHVlYCBpcyBzcGVjaWZpZWRcbiAgICBcXCovXG4gICAgZWxwcm90by5zdGF0dXMgPSBmdW5jdGlvbiAoYW5pbSwgdmFsdWUpIHtcbiAgICAgICAgdmFyIG91dCA9IFtdLFxuICAgICAgICAgICAgaSA9IDAsXG4gICAgICAgICAgICBsZW4sXG4gICAgICAgICAgICBlO1xuICAgICAgICBpZiAodmFsdWUgIT0gbnVsbCkge1xuICAgICAgICAgICAgcnVuQW5pbWF0aW9uKGFuaW0sIHRoaXMsIC0xLCBtbWluKHZhbHVlLCAxKSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxlbiA9IGFuaW1hdGlvbkVsZW1lbnRzLmxlbmd0aDtcbiAgICAgICAgICAgIGZvciAoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICBlID0gYW5pbWF0aW9uRWxlbWVudHNbaV07XG4gICAgICAgICAgICAgICAgaWYgKGUuZWwuaWQgPT0gdGhpcy5pZCAmJiAoIWFuaW0gfHwgZS5hbmltID09IGFuaW0pKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhbmltKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZS5zdGF0dXM7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgb3V0LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgYW5pbTogZS5hbmltLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiBlLnN0YXR1c1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYW5pbSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG91dDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLypcXFxuICAgICAqIEVsZW1lbnQucGF1c2VcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIFN0b3BzIGFuaW1hdGlvbiBvZiB0aGUgZWxlbWVudCB3aXRoIGFiaWxpdHkgdG8gcmVzdW1lIGl0IGxhdGVyIG9uLlxuICAgICAqKlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgKipcbiAgICAgLSBhbmltIChvYmplY3QpICNvcHRpb25hbCBhbmltYXRpb24gb2JqZWN0XG4gICAgICoqXG4gICAgID0gKG9iamVjdCkgb3JpZ2luYWwgZWxlbWVudFxuICAgIFxcKi9cbiAgICBlbHByb3RvLnBhdXNlID0gZnVuY3Rpb24gKGFuaW0pIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhbmltYXRpb25FbGVtZW50cy5sZW5ndGg7IGkrKykgaWYgKGFuaW1hdGlvbkVsZW1lbnRzW2ldLmVsLmlkID09IHRoaXMuaWQgJiYgKCFhbmltIHx8IGFuaW1hdGlvbkVsZW1lbnRzW2ldLmFuaW0gPT0gYW5pbSkpIHtcbiAgICAgICAgICAgIGlmIChldmUoXCJyYXBoYWVsLmFuaW0ucGF1c2UuXCIgKyB0aGlzLmlkLCB0aGlzLCBhbmltYXRpb25FbGVtZW50c1tpXS5hbmltKSAhPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICBhbmltYXRpb25FbGVtZW50c1tpXS5wYXVzZWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIEVsZW1lbnQucmVzdW1lXG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBSZXN1bWVzIGFuaW1hdGlvbiBpZiBpdCB3YXMgcGF1c2VkIHdpdGggQEVsZW1lbnQucGF1c2UgbWV0aG9kLlxuICAgICAqKlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgKipcbiAgICAgLSBhbmltIChvYmplY3QpICNvcHRpb25hbCBhbmltYXRpb24gb2JqZWN0XG4gICAgICoqXG4gICAgID0gKG9iamVjdCkgb3JpZ2luYWwgZWxlbWVudFxuICAgIFxcKi9cbiAgICBlbHByb3RvLnJlc3VtZSA9IGZ1bmN0aW9uIChhbmltKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYW5pbWF0aW9uRWxlbWVudHMubGVuZ3RoOyBpKyspIGlmIChhbmltYXRpb25FbGVtZW50c1tpXS5lbC5pZCA9PSB0aGlzLmlkICYmICghYW5pbSB8fCBhbmltYXRpb25FbGVtZW50c1tpXS5hbmltID09IGFuaW0pKSB7XG4gICAgICAgICAgICB2YXIgZSA9IGFuaW1hdGlvbkVsZW1lbnRzW2ldO1xuICAgICAgICAgICAgaWYgKGV2ZShcInJhcGhhZWwuYW5pbS5yZXN1bWUuXCIgKyB0aGlzLmlkLCB0aGlzLCBlLmFuaW0pICE9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBlLnBhdXNlZDtcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXR1cyhlLmFuaW0sIGUuc3RhdHVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIC8qXFxcbiAgICAgKiBFbGVtZW50LnN0b3BcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIFN0b3BzIGFuaW1hdGlvbiBvZiB0aGUgZWxlbWVudC5cbiAgICAgKipcbiAgICAgPiBQYXJhbWV0ZXJzXG4gICAgICoqXG4gICAgIC0gYW5pbSAob2JqZWN0KSAjb3B0aW9uYWwgYW5pbWF0aW9uIG9iamVjdFxuICAgICAqKlxuICAgICA9IChvYmplY3QpIG9yaWdpbmFsIGVsZW1lbnRcbiAgICBcXCovXG4gICAgZWxwcm90by5zdG9wID0gZnVuY3Rpb24gKGFuaW0pIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhbmltYXRpb25FbGVtZW50cy5sZW5ndGg7IGkrKykgaWYgKGFuaW1hdGlvbkVsZW1lbnRzW2ldLmVsLmlkID09IHRoaXMuaWQgJiYgKCFhbmltIHx8IGFuaW1hdGlvbkVsZW1lbnRzW2ldLmFuaW0gPT0gYW5pbSkpIHtcbiAgICAgICAgICAgIGlmIChldmUoXCJyYXBoYWVsLmFuaW0uc3RvcC5cIiArIHRoaXMuaWQsIHRoaXMsIGFuaW1hdGlvbkVsZW1lbnRzW2ldLmFuaW0pICE9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbkVsZW1lbnRzLnNwbGljZShpLS0sIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgZnVuY3Rpb24gc3RvcEFuaW1hdGlvbihwYXBlcikge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFuaW1hdGlvbkVsZW1lbnRzLmxlbmd0aDsgaSsrKSBpZiAoYW5pbWF0aW9uRWxlbWVudHNbaV0uZWwucGFwZXIgPT0gcGFwZXIpIHtcbiAgICAgICAgICAgIGFuaW1hdGlvbkVsZW1lbnRzLnNwbGljZShpLS0sIDEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGV2ZS5vbihcInJhcGhhZWwucmVtb3ZlXCIsIHN0b3BBbmltYXRpb24pO1xuICAgIGV2ZS5vbihcInJhcGhhZWwuY2xlYXJcIiwgc3RvcEFuaW1hdGlvbik7XG4gICAgZWxwcm90by50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFwiUmFwaGFcXHhlYmxcXHUyMDE5cyBvYmplY3RcIjtcbiAgICB9O1xuXG4gICAgLy8gU2V0XG4gICAgdmFyIFNldCA9IGZ1bmN0aW9uIChpdGVtcykge1xuICAgICAgICB0aGlzLml0ZW1zID0gW107XG4gICAgICAgIHRoaXMubGVuZ3RoID0gMDtcbiAgICAgICAgdGhpcy50eXBlID0gXCJzZXRcIjtcbiAgICAgICAgaWYgKGl0ZW1zKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBpdGVtcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGl0ZW1zW2ldICYmIChpdGVtc1tpXS5jb25zdHJ1Y3RvciA9PSBlbHByb3RvLmNvbnN0cnVjdG9yIHx8IGl0ZW1zW2ldLmNvbnN0cnVjdG9yID09IFNldCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1t0aGlzLml0ZW1zLmxlbmd0aF0gPSB0aGlzLml0ZW1zW3RoaXMuaXRlbXMubGVuZ3RoXSA9IGl0ZW1zW2ldO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmxlbmd0aCsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG4gICAgc2V0cHJvdG8gPSBTZXQucHJvdG90eXBlO1xuICAgIC8qXFxcbiAgICAgKiBTZXQucHVzaFxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogQWRkcyBlYWNoIGFyZ3VtZW50IHRvIHRoZSBjdXJyZW50IHNldC5cbiAgICAgPSAob2JqZWN0KSBvcmlnaW5hbCBlbGVtZW50XG4gICAgXFwqL1xuICAgIHNldHByb3RvLnB1c2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBpdGVtLFxuICAgICAgICAgICAgbGVuO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuICAgICAgICAgICAgaXRlbSA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgICAgIGlmIChpdGVtICYmIChpdGVtLmNvbnN0cnVjdG9yID09IGVscHJvdG8uY29uc3RydWN0b3IgfHwgaXRlbS5jb25zdHJ1Y3RvciA9PSBTZXQpKSB7XG4gICAgICAgICAgICAgICAgbGVuID0gdGhpcy5pdGVtcy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgdGhpc1tsZW5dID0gdGhpcy5pdGVtc1tsZW5dID0gaXRlbTtcbiAgICAgICAgICAgICAgICB0aGlzLmxlbmd0aCsrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIFNldC5wb3BcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIFJlbW92ZXMgbGFzdCBlbGVtZW50IGFuZCByZXR1cm5zIGl0LlxuICAgICA9IChvYmplY3QpIGVsZW1lbnRcbiAgICBcXCovXG4gICAgc2V0cHJvdG8ucG9wID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmxlbmd0aCAmJiBkZWxldGUgdGhpc1t0aGlzLmxlbmd0aC0tXTtcbiAgICAgICAgcmV0dXJuIHRoaXMuaXRlbXMucG9wKCk7XG4gICAgfTtcbiAgICAvKlxcXG4gICAgICogU2V0LmZvckVhY2hcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIEV4ZWN1dGVzIGdpdmVuIGZ1bmN0aW9uIGZvciBlYWNoIGVsZW1lbnQgaW4gdGhlIHNldC5cbiAgICAgKlxuICAgICAqIElmIGZ1bmN0aW9uIHJldHVybnMgYGZhbHNlYCBpdCB3aWxsIHN0b3AgbG9vcCBydW5uaW5nLlxuICAgICAqKlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgKipcbiAgICAgLSBjYWxsYmFjayAoZnVuY3Rpb24pIGZ1bmN0aW9uIHRvIHJ1blxuICAgICAtIHRoaXNBcmcgKG9iamVjdCkgY29udGV4dCBvYmplY3QgZm9yIHRoZSBjYWxsYmFja1xuICAgICA9IChvYmplY3QpIFNldCBvYmplY3RcbiAgICBcXCovXG4gICAgc2V0cHJvdG8uZm9yRWFjaCA9IGZ1bmN0aW9uIChjYWxsYmFjaywgdGhpc0FyZykge1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSB0aGlzLml0ZW1zLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChjYWxsYmFjay5jYWxsKHRoaXNBcmcsIHRoaXMuaXRlbXNbaV0sIGkpID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgZm9yICh2YXIgbWV0aG9kIGluIGVscHJvdG8pIGlmIChlbHByb3RvW2hhc10obWV0aG9kKSkge1xuICAgICAgICBzZXRwcm90b1ttZXRob2RdID0gKGZ1bmN0aW9uIChtZXRob2RuYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBhcmcgPSBhcmd1bWVudHM7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZm9yRWFjaChmdW5jdGlvbiAoZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgZWxbbWV0aG9kbmFtZV1bYXBwbHldKGVsLCBhcmcpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSkobWV0aG9kKTtcbiAgICB9XG4gICAgc2V0cHJvdG8uYXR0ciA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xuICAgICAgICBpZiAobmFtZSAmJiBSLmlzKG5hbWUsIGFycmF5KSAmJiBSLmlzKG5hbWVbMF0sIFwib2JqZWN0XCIpKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMCwgamogPSBuYW1lLmxlbmd0aDsgaiA8IGpqOyBqKyspIHtcbiAgICAgICAgICAgICAgICB0aGlzLml0ZW1zW2pdLmF0dHIobmFtZVtqXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSB0aGlzLml0ZW1zLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcbiAgICAgICAgICAgICAgICB0aGlzLml0ZW1zW2ldLmF0dHIobmFtZSwgdmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIFNldC5jbGVhclxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogUmVtb3ZlcyBhbGwgZWxlbWVudHMgZnJvbSB0aGUgc2V0XG4gICAgXFwqL1xuICAgIHNldHByb3RvLmNsZWFyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB3aGlsZSAodGhpcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMucG9wKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qXFxcbiAgICAgKiBTZXQuc3BsaWNlXG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBSZW1vdmVzIGdpdmVuIGVsZW1lbnQgZnJvbSB0aGUgc2V0XG4gICAgICoqXG4gICAgID4gUGFyYW1ldGVyc1xuICAgICAqKlxuICAgICAtIGluZGV4IChudW1iZXIpIHBvc2l0aW9uIG9mIHRoZSBkZWxldGlvblxuICAgICAtIGNvdW50IChudW1iZXIpIG51bWJlciBvZiBlbGVtZW50IHRvIHJlbW92ZVxuICAgICAtIGluc2VydGlvbuKApiAob2JqZWN0KSAjb3B0aW9uYWwgZWxlbWVudHMgdG8gaW5zZXJ0XG4gICAgID0gKG9iamVjdCkgc2V0IGVsZW1lbnRzIHRoYXQgd2VyZSBkZWxldGVkXG4gICAgXFwqL1xuICAgIHNldHByb3RvLnNwbGljZSA9IGZ1bmN0aW9uIChpbmRleCwgY291bnQsIGluc2VydGlvbikge1xuICAgICAgICBpbmRleCA9IGluZGV4IDwgMCA/IG1tYXgodGhpcy5sZW5ndGggKyBpbmRleCwgMCkgOiBpbmRleDtcbiAgICAgICAgY291bnQgPSBtbWF4KDAsIG1taW4odGhpcy5sZW5ndGggLSBpbmRleCwgY291bnQpKTtcbiAgICAgICAgdmFyIHRhaWwgPSBbXSxcbiAgICAgICAgICAgIHRvZGVsID0gW10sXG4gICAgICAgICAgICBhcmdzID0gW10sXG4gICAgICAgICAgICBpO1xuICAgICAgICBmb3IgKGkgPSAyOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBhcmdzLnB1c2goYXJndW1lbnRzW2ldKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgY291bnQ7IGkrKykge1xuICAgICAgICAgICAgdG9kZWwucHVzaCh0aGlzW2luZGV4ICsgaV0pO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoOyBpIDwgdGhpcy5sZW5ndGggLSBpbmRleDsgaSsrKSB7XG4gICAgICAgICAgICB0YWlsLnB1c2godGhpc1tpbmRleCArIGldKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYXJnbGVuID0gYXJncy5sZW5ndGg7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBhcmdsZW4gKyB0YWlsLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB0aGlzLml0ZW1zW2luZGV4ICsgaV0gPSB0aGlzW2luZGV4ICsgaV0gPSBpIDwgYXJnbGVuID8gYXJnc1tpXSA6IHRhaWxbaSAtIGFyZ2xlbl07XG4gICAgICAgIH1cbiAgICAgICAgaSA9IHRoaXMuaXRlbXMubGVuZ3RoID0gdGhpcy5sZW5ndGggLT0gY291bnQgLSBhcmdsZW47XG4gICAgICAgIHdoaWxlICh0aGlzW2ldKSB7XG4gICAgICAgICAgICBkZWxldGUgdGhpc1tpKytdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgU2V0KHRvZGVsKTtcbiAgICB9O1xuICAgIC8qXFxcbiAgICAgKiBTZXQuZXhjbHVkZVxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogUmVtb3ZlcyBnaXZlbiBlbGVtZW50IGZyb20gdGhlIHNldFxuICAgICAqKlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgKipcbiAgICAgLSBlbGVtZW50IChvYmplY3QpIGVsZW1lbnQgdG8gcmVtb3ZlXG4gICAgID0gKGJvb2xlYW4pIGB0cnVlYCBpZiBvYmplY3Qgd2FzIGZvdW5kICYgcmVtb3ZlZCBmcm9tIHRoZSBzZXRcbiAgICBcXCovXG4gICAgc2V0cHJvdG8uZXhjbHVkZSA9IGZ1bmN0aW9uIChlbCkge1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSB0aGlzLmxlbmd0aDsgaSA8IGlpOyBpKyspIGlmICh0aGlzW2ldID09IGVsKSB7XG4gICAgICAgICAgICB0aGlzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBzZXRwcm90by5hbmltYXRlID0gZnVuY3Rpb24gKHBhcmFtcywgbXMsIGVhc2luZywgY2FsbGJhY2spIHtcbiAgICAgICAgKFIuaXMoZWFzaW5nLCBcImZ1bmN0aW9uXCIpIHx8ICFlYXNpbmcpICYmIChjYWxsYmFjayA9IGVhc2luZyB8fCBudWxsKTtcbiAgICAgICAgdmFyIGxlbiA9IHRoaXMuaXRlbXMubGVuZ3RoLFxuICAgICAgICAgICAgaSA9IGxlbixcbiAgICAgICAgICAgIGl0ZW0sXG4gICAgICAgICAgICBzZXQgPSB0aGlzLFxuICAgICAgICAgICAgY29sbGVjdG9yO1xuICAgICAgICBpZiAoIWxlbikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgY2FsbGJhY2sgJiYgKGNvbGxlY3RvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICEtLWxlbiAmJiBjYWxsYmFjay5jYWxsKHNldCk7XG4gICAgICAgIH0pO1xuICAgICAgICBlYXNpbmcgPSBSLmlzKGVhc2luZywgc3RyaW5nKSA/IGVhc2luZyA6IGNvbGxlY3RvcjtcbiAgICAgICAgdmFyIGFuaW0gPSBSLmFuaW1hdGlvbihwYXJhbXMsIG1zLCBlYXNpbmcsIGNvbGxlY3Rvcik7XG4gICAgICAgIGl0ZW0gPSB0aGlzLml0ZW1zWy0taV0uYW5pbWF0ZShhbmltKTtcbiAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgdGhpcy5pdGVtc1tpXSAmJiAhdGhpcy5pdGVtc1tpXS5yZW1vdmVkICYmIHRoaXMuaXRlbXNbaV0uYW5pbWF0ZVdpdGgoaXRlbSwgYW5pbSwgYW5pbSk7XG4gICAgICAgICAgICAodGhpcy5pdGVtc1tpXSAmJiAhdGhpcy5pdGVtc1tpXS5yZW1vdmVkKSB8fCBsZW4tLTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIHNldHByb3RvLmluc2VydEFmdGVyID0gZnVuY3Rpb24gKGVsKSB7XG4gICAgICAgIHZhciBpID0gdGhpcy5pdGVtcy5sZW5ndGg7XG4gICAgICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgICAgIHRoaXMuaXRlbXNbaV0uaW5zZXJ0QWZ0ZXIoZWwpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgc2V0cHJvdG8uZ2V0QkJveCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHggPSBbXSxcbiAgICAgICAgICAgIHkgPSBbXSxcbiAgICAgICAgICAgIHgyID0gW10sXG4gICAgICAgICAgICB5MiA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gdGhpcy5pdGVtcy5sZW5ndGg7IGktLTspIGlmICghdGhpcy5pdGVtc1tpXS5yZW1vdmVkKSB7XG4gICAgICAgICAgICB2YXIgYm94ID0gdGhpcy5pdGVtc1tpXS5nZXRCQm94KCk7XG4gICAgICAgICAgICB4LnB1c2goYm94LngpO1xuICAgICAgICAgICAgeS5wdXNoKGJveC55KTtcbiAgICAgICAgICAgIHgyLnB1c2goYm94LnggKyBib3gud2lkdGgpO1xuICAgICAgICAgICAgeTIucHVzaChib3gueSArIGJveC5oZWlnaHQpO1xuICAgICAgICB9XG4gICAgICAgIHggPSBtbWluW2FwcGx5XSgwLCB4KTtcbiAgICAgICAgeSA9IG1taW5bYXBwbHldKDAsIHkpO1xuICAgICAgICB4MiA9IG1tYXhbYXBwbHldKDAsIHgyKTtcbiAgICAgICAgeTIgPSBtbWF4W2FwcGx5XSgwLCB5Mik7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB4OiB4LFxuICAgICAgICAgICAgeTogeSxcbiAgICAgICAgICAgIHgyOiB4MixcbiAgICAgICAgICAgIHkyOiB5MixcbiAgICAgICAgICAgIHdpZHRoOiB4MiAtIHgsXG4gICAgICAgICAgICBoZWlnaHQ6IHkyIC0geVxuICAgICAgICB9O1xuICAgIH07XG4gICAgc2V0cHJvdG8uY2xvbmUgPSBmdW5jdGlvbiAocykge1xuICAgICAgICBzID0gdGhpcy5wYXBlci5zZXQoKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gdGhpcy5pdGVtcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG4gICAgICAgICAgICBzLnB1c2godGhpcy5pdGVtc1tpXS5jbG9uZSgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcztcbiAgICB9O1xuICAgIHNldHByb3RvLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gXCJSYXBoYVxceGVibFxcdTIwMThzIHNldFwiO1xuICAgIH07XG5cbiAgICBzZXRwcm90by5nbG93ID0gZnVuY3Rpb24oZ2xvd0NvbmZpZykge1xuICAgICAgICB2YXIgcmV0ID0gdGhpcy5wYXBlci5zZXQoKTtcbiAgICAgICAgdGhpcy5mb3JFYWNoKGZ1bmN0aW9uKHNoYXBlLCBpbmRleCl7XG4gICAgICAgICAgICB2YXIgZyA9IHNoYXBlLmdsb3coZ2xvd0NvbmZpZyk7XG4gICAgICAgICAgICBpZihnICE9IG51bGwpe1xuICAgICAgICAgICAgICAgIGcuZm9yRWFjaChmdW5jdGlvbihzaGFwZTIsIGluZGV4Mil7XG4gICAgICAgICAgICAgICAgICAgIHJldC5wdXNoKHNoYXBlMik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcmV0O1xuICAgIH07XG5cblxuICAgIC8qXFxcbiAgICAgKiBTZXQuaXNQb2ludEluc2lkZVxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogRGV0ZXJtaW5lIGlmIGdpdmVuIHBvaW50IGlzIGluc2lkZSB0aGlzIHNldOKAmXMgZWxlbWVudHNcbiAgICAgKipcbiAgICAgPiBQYXJhbWV0ZXJzXG4gICAgICoqXG4gICAgIC0geCAobnVtYmVyKSB4IGNvb3JkaW5hdGUgb2YgdGhlIHBvaW50XG4gICAgIC0geSAobnVtYmVyKSB5IGNvb3JkaW5hdGUgb2YgdGhlIHBvaW50XG4gICAgID0gKGJvb2xlYW4pIGB0cnVlYCBpZiBwb2ludCBpcyBpbnNpZGUgYW55IG9mIHRoZSBzZXQncyBlbGVtZW50c1xuICAgICBcXCovXG4gICAgc2V0cHJvdG8uaXNQb2ludEluc2lkZSA9IGZ1bmN0aW9uICh4LCB5KSB7XG4gICAgICAgIHZhciBpc1BvaW50SW5zaWRlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZm9yRWFjaChmdW5jdGlvbiAoZWwpIHtcbiAgICAgICAgICAgIGlmIChlbC5pc1BvaW50SW5zaWRlKHgsIHkpKSB7XG4gICAgICAgICAgICAgICAgaXNQb2ludEluc2lkZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOyAvLyBzdG9wIGxvb3BcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBpc1BvaW50SW5zaWRlO1xuICAgIH07XG5cbiAgICAvKlxcXG4gICAgICogUmFwaGFlbC5yZWdpc3RlckZvbnRcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIEFkZHMgZ2l2ZW4gZm9udCB0byB0aGUgcmVnaXN0ZXJlZCBzZXQgb2YgZm9udHMgZm9yIFJhcGhhw6tsLiBTaG91bGQgYmUgdXNlZCBhcyBhbiBpbnRlcm5hbCBjYWxsIGZyb20gd2l0aGluIEN1ZsOzbuKAmXMgZm9udCBmaWxlLlxuICAgICAqIFJldHVybnMgb3JpZ2luYWwgcGFyYW1ldGVyLCBzbyBpdCBjb3VsZCBiZSB1c2VkIHdpdGggY2hhaW5pbmcuXG4gICAgICMgPGEgaHJlZj1cImh0dHA6Ly93aWtpLmdpdGh1Yi5jb20vc29yY2N1L2N1Zm9uL2Fib3V0XCI+TW9yZSBhYm91dCBDdWbDs24gYW5kIGhvdyB0byBjb252ZXJ0IHlvdXIgZm9udCBmb3JtIFRURiwgT1RGLCBldGMgdG8gSmF2YVNjcmlwdCBmaWxlLjwvYT5cbiAgICAgKipcbiAgICAgPiBQYXJhbWV0ZXJzXG4gICAgICoqXG4gICAgIC0gZm9udCAob2JqZWN0KSB0aGUgZm9udCB0byByZWdpc3RlclxuICAgICA9IChvYmplY3QpIHRoZSBmb250IHlvdSBwYXNzZWQgaW5cbiAgICAgPiBVc2FnZVxuICAgICB8IEN1Zm9uLnJlZ2lzdGVyRm9udChSYXBoYWVsLnJlZ2lzdGVyRm9udCh74oCmfSkpO1xuICAgIFxcKi9cbiAgICBSLnJlZ2lzdGVyRm9udCA9IGZ1bmN0aW9uIChmb250KSB7XG4gICAgICAgIGlmICghZm9udC5mYWNlKSB7XG4gICAgICAgICAgICByZXR1cm4gZm9udDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmZvbnRzID0gdGhpcy5mb250cyB8fCB7fTtcbiAgICAgICAgdmFyIGZvbnRjb3B5ID0ge1xuICAgICAgICAgICAgICAgIHc6IGZvbnQudyxcbiAgICAgICAgICAgICAgICBmYWNlOiB7fSxcbiAgICAgICAgICAgICAgICBnbHlwaHM6IHt9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZmFtaWx5ID0gZm9udC5mYWNlW1wiZm9udC1mYW1pbHlcIl07XG4gICAgICAgIGZvciAodmFyIHByb3AgaW4gZm9udC5mYWNlKSBpZiAoZm9udC5mYWNlW2hhc10ocHJvcCkpIHtcbiAgICAgICAgICAgIGZvbnRjb3B5LmZhY2VbcHJvcF0gPSBmb250LmZhY2VbcHJvcF07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZm9udHNbZmFtaWx5XSkge1xuICAgICAgICAgICAgdGhpcy5mb250c1tmYW1pbHldLnB1c2goZm9udGNvcHkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5mb250c1tmYW1pbHldID0gW2ZvbnRjb3B5XTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWZvbnQuc3ZnKSB7XG4gICAgICAgICAgICBmb250Y29weS5mYWNlW1widW5pdHMtcGVyLWVtXCJdID0gdG9JbnQoZm9udC5mYWNlW1widW5pdHMtcGVyLWVtXCJdLCAxMCk7XG4gICAgICAgICAgICBmb3IgKHZhciBnbHlwaCBpbiBmb250LmdseXBocykgaWYgKGZvbnQuZ2x5cGhzW2hhc10oZ2x5cGgpKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBhdGggPSBmb250LmdseXBoc1tnbHlwaF07XG4gICAgICAgICAgICAgICAgZm9udGNvcHkuZ2x5cGhzW2dseXBoXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgdzogcGF0aC53LFxuICAgICAgICAgICAgICAgICAgICBrOiB7fSxcbiAgICAgICAgICAgICAgICAgICAgZDogcGF0aC5kICYmIFwiTVwiICsgcGF0aC5kLnJlcGxhY2UoL1ttbGN4dHJ2XS9nLCBmdW5jdGlvbiAoY29tbWFuZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7bDogXCJMXCIsIGM6IFwiQ1wiLCB4OiBcInpcIiwgdDogXCJtXCIsIHI6IFwibFwiLCB2OiBcImNcIn1bY29tbWFuZF0gfHwgXCJNXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KSArIFwielwiXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBpZiAocGF0aC5rKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGsgaW4gcGF0aC5rKSBpZiAocGF0aFtoYXNdKGspKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb250Y29weS5nbHlwaHNbZ2x5cGhdLmtba10gPSBwYXRoLmtba107XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZvbnQ7XG4gICAgfTtcbiAgICAvKlxcXG4gICAgICogUGFwZXIuZ2V0Rm9udFxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogRmluZHMgZm9udCBvYmplY3QgaW4gdGhlIHJlZ2lzdGVyZWQgZm9udHMgYnkgZ2l2ZW4gcGFyYW1ldGVycy4gWW91IGNvdWxkIHNwZWNpZnkgb25seSBvbmUgd29yZCBmcm9tIHRoZSBmb250IG5hbWUsIGxpa2Ug4oCcTXlyaWFk4oCdIGZvciDigJxNeXJpYWQgUHJv4oCdLlxuICAgICAqKlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgKipcbiAgICAgLSBmYW1pbHkgKHN0cmluZykgZm9udCBmYW1pbHkgbmFtZSBvciBhbnkgd29yZCBmcm9tIGl0XG4gICAgIC0gd2VpZ2h0IChzdHJpbmcpICNvcHRpb25hbCBmb250IHdlaWdodFxuICAgICAtIHN0eWxlIChzdHJpbmcpICNvcHRpb25hbCBmb250IHN0eWxlXG4gICAgIC0gc3RyZXRjaCAoc3RyaW5nKSAjb3B0aW9uYWwgZm9udCBzdHJldGNoXG4gICAgID0gKG9iamVjdCkgdGhlIGZvbnQgb2JqZWN0XG4gICAgID4gVXNhZ2VcbiAgICAgfCBwYXBlci5wcmludCgxMDAsIDEwMCwgXCJUZXN0IHN0cmluZ1wiLCBwYXBlci5nZXRGb250KFwiVGltZXNcIiwgODAwKSwgMzApO1xuICAgIFxcKi9cbiAgICBwYXBlcnByb3RvLmdldEZvbnQgPSBmdW5jdGlvbiAoZmFtaWx5LCB3ZWlnaHQsIHN0eWxlLCBzdHJldGNoKSB7XG4gICAgICAgIHN0cmV0Y2ggPSBzdHJldGNoIHx8IFwibm9ybWFsXCI7XG4gICAgICAgIHN0eWxlID0gc3R5bGUgfHwgXCJub3JtYWxcIjtcbiAgICAgICAgd2VpZ2h0ID0gK3dlaWdodCB8fCB7bm9ybWFsOiA0MDAsIGJvbGQ6IDcwMCwgbGlnaHRlcjogMzAwLCBib2xkZXI6IDgwMH1bd2VpZ2h0XSB8fCA0MDA7XG4gICAgICAgIGlmICghUi5mb250cykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBmb250ID0gUi5mb250c1tmYW1pbHldO1xuICAgICAgICBpZiAoIWZvbnQpIHtcbiAgICAgICAgICAgIHZhciBuYW1lID0gbmV3IFJlZ0V4cChcIihefFxcXFxzKVwiICsgZmFtaWx5LnJlcGxhY2UoL1teXFx3XFxkXFxzKyF+LjpfLV0vZywgRSkgKyBcIihcXFxcc3wkKVwiLCBcImlcIik7XG4gICAgICAgICAgICBmb3IgKHZhciBmb250TmFtZSBpbiBSLmZvbnRzKSBpZiAoUi5mb250c1toYXNdKGZvbnROYW1lKSkge1xuICAgICAgICAgICAgICAgIGlmIChuYW1lLnRlc3QoZm9udE5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvbnQgPSBSLmZvbnRzW2ZvbnROYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciB0aGVmb250O1xuICAgICAgICBpZiAoZm9udCkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gZm9udC5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGhlZm9udCA9IGZvbnRbaV07XG4gICAgICAgICAgICAgICAgaWYgKHRoZWZvbnQuZmFjZVtcImZvbnQtd2VpZ2h0XCJdID09IHdlaWdodCAmJiAodGhlZm9udC5mYWNlW1wiZm9udC1zdHlsZVwiXSA9PSBzdHlsZSB8fCAhdGhlZm9udC5mYWNlW1wiZm9udC1zdHlsZVwiXSkgJiYgdGhlZm9udC5mYWNlW1wiZm9udC1zdHJldGNoXCJdID09IHN0cmV0Y2gpIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGVmb250O1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIFBhcGVyLnByaW50XG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBDcmVhdGVzIHBhdGggdGhhdCByZXByZXNlbnQgZ2l2ZW4gdGV4dCB3cml0dGVuIHVzaW5nIGdpdmVuIGZvbnQgYXQgZ2l2ZW4gcG9zaXRpb24gd2l0aCBnaXZlbiBzaXplLlxuICAgICAqIFJlc3VsdCBvZiB0aGUgbWV0aG9kIGlzIHBhdGggZWxlbWVudCB0aGF0IGNvbnRhaW5zIHdob2xlIHRleHQgYXMgYSBzZXBhcmF0ZSBwYXRoLlxuICAgICAqKlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgKipcbiAgICAgLSB4IChudW1iZXIpIHggcG9zaXRpb24gb2YgdGhlIHRleHRcbiAgICAgLSB5IChudW1iZXIpIHkgcG9zaXRpb24gb2YgdGhlIHRleHRcbiAgICAgLSBzdHJpbmcgKHN0cmluZykgdGV4dCB0byBwcmludFxuICAgICAtIGZvbnQgKG9iamVjdCkgZm9udCBvYmplY3QsIHNlZSBAUGFwZXIuZ2V0Rm9udFxuICAgICAtIHNpemUgKG51bWJlcikgI29wdGlvbmFsIHNpemUgb2YgdGhlIGZvbnQsIGRlZmF1bHQgaXMgYDE2YFxuICAgICAtIG9yaWdpbiAoc3RyaW5nKSAjb3B0aW9uYWwgY291bGQgYmUgYFwiYmFzZWxpbmVcImAgb3IgYFwibWlkZGxlXCJgLCBkZWZhdWx0IGlzIGBcIm1pZGRsZVwiYFxuICAgICAtIGxldHRlcl9zcGFjaW5nIChudW1iZXIpICNvcHRpb25hbCBudW1iZXIgaW4gcmFuZ2UgYC0xLi4xYCwgZGVmYXVsdCBpcyBgMGBcbiAgICAgLSBsaW5lX3NwYWNpbmcgKG51bWJlcikgI29wdGlvbmFsIG51bWJlciBpbiByYW5nZSBgMS4uM2AsIGRlZmF1bHQgaXMgYDFgXG4gICAgID0gKG9iamVjdCkgcmVzdWx0aW5nIHBhdGggZWxlbWVudCwgd2hpY2ggY29uc2lzdCBvZiBhbGwgbGV0dGVyc1xuICAgICA+IFVzYWdlXG4gICAgIHwgdmFyIHR4dCA9IHIucHJpbnQoMTAsIDUwLCBcInByaW50XCIsIHIuZ2V0Rm9udChcIk11c2VvXCIpLCAzMCkuYXR0cih7ZmlsbDogXCIjZmZmXCJ9KTtcbiAgICBcXCovXG4gICAgcGFwZXJwcm90by5wcmludCA9IGZ1bmN0aW9uICh4LCB5LCBzdHJpbmcsIGZvbnQsIHNpemUsIG9yaWdpbiwgbGV0dGVyX3NwYWNpbmcsIGxpbmVfc3BhY2luZykge1xuICAgICAgICBvcmlnaW4gPSBvcmlnaW4gfHwgXCJtaWRkbGVcIjsgLy8gYmFzZWxpbmV8bWlkZGxlXG4gICAgICAgIGxldHRlcl9zcGFjaW5nID0gbW1heChtbWluKGxldHRlcl9zcGFjaW5nIHx8IDAsIDEpLCAtMSk7XG4gICAgICAgIGxpbmVfc3BhY2luZyA9IG1tYXgobW1pbihsaW5lX3NwYWNpbmcgfHwgMSwgMyksIDEpO1xuICAgICAgICB2YXIgbGV0dGVycyA9IFN0cihzdHJpbmcpW3NwbGl0XShFKSxcbiAgICAgICAgICAgIHNoaWZ0ID0gMCxcbiAgICAgICAgICAgIG5vdGZpcnN0ID0gMCxcbiAgICAgICAgICAgIHBhdGggPSBFLFxuICAgICAgICAgICAgc2NhbGU7XG4gICAgICAgIFIuaXMoZm9udCwgXCJzdHJpbmdcIikgJiYgKGZvbnQgPSB0aGlzLmdldEZvbnQoZm9udCkpO1xuICAgICAgICBpZiAoZm9udCkge1xuICAgICAgICAgICAgc2NhbGUgPSAoc2l6ZSB8fCAxNikgLyBmb250LmZhY2VbXCJ1bml0cy1wZXItZW1cIl07XG4gICAgICAgICAgICB2YXIgYmIgPSBmb250LmZhY2UuYmJveFtzcGxpdF0oc2VwYXJhdG9yKSxcbiAgICAgICAgICAgICAgICB0b3AgPSArYmJbMF0sXG4gICAgICAgICAgICAgICAgbGluZUhlaWdodCA9IGJiWzNdIC0gYmJbMV0sXG4gICAgICAgICAgICAgICAgc2hpZnR5ID0gMCxcbiAgICAgICAgICAgICAgICBoZWlnaHQgPSArYmJbMV0gKyAob3JpZ2luID09IFwiYmFzZWxpbmVcIiA/IGxpbmVIZWlnaHQgKyAoK2ZvbnQuZmFjZS5kZXNjZW50KSA6IGxpbmVIZWlnaHQgLyAyKTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IGxldHRlcnMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChsZXR0ZXJzW2ldID09IFwiXFxuXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgc2hpZnQgPSAwO1xuICAgICAgICAgICAgICAgICAgICBjdXJyID0gMDtcbiAgICAgICAgICAgICAgICAgICAgbm90Zmlyc3QgPSAwO1xuICAgICAgICAgICAgICAgICAgICBzaGlmdHkgKz0gbGluZUhlaWdodCAqIGxpbmVfc3BhY2luZztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcHJldiA9IG5vdGZpcnN0ICYmIGZvbnQuZ2x5cGhzW2xldHRlcnNbaSAtIDFdXSB8fCB7fSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnIgPSBmb250LmdseXBoc1tsZXR0ZXJzW2ldXTtcbiAgICAgICAgICAgICAgICAgICAgc2hpZnQgKz0gbm90Zmlyc3QgPyAocHJldi53IHx8IGZvbnQudykgKyAocHJldi5rICYmIHByZXYua1tsZXR0ZXJzW2ldXSB8fCAwKSArIChmb250LncgKiBsZXR0ZXJfc3BhY2luZykgOiAwO1xuICAgICAgICAgICAgICAgICAgICBub3RmaXJzdCA9IDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChjdXJyICYmIGN1cnIuZCkge1xuICAgICAgICAgICAgICAgICAgICBwYXRoICs9IFIudHJhbnNmb3JtUGF0aChjdXJyLmQsIFtcInRcIiwgc2hpZnQgKiBzY2FsZSwgc2hpZnR5ICogc2NhbGUsIFwic1wiLCBzY2FsZSwgc2NhbGUsIHRvcCwgaGVpZ2h0LCBcInRcIiwgKHggLSB0b3ApIC8gc2NhbGUsICh5IC0gaGVpZ2h0KSAvIHNjYWxlXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnBhdGgocGF0aCkuYXR0cih7XG4gICAgICAgICAgICBmaWxsOiBcIiMwMDBcIixcbiAgICAgICAgICAgIHN0cm9rZTogXCJub25lXCJcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIC8qXFxcbiAgICAgKiBQYXBlci5hZGRcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIEltcG9ydHMgZWxlbWVudHMgaW4gSlNPTiBhcnJheSBpbiBmb3JtYXQgYHt0eXBlOiB0eXBlLCA8YXR0cmlidXRlcz59YFxuICAgICAqKlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgKipcbiAgICAgLSBqc29uIChhcnJheSlcbiAgICAgPSAob2JqZWN0KSByZXN1bHRpbmcgc2V0IG9mIGltcG9ydGVkIGVsZW1lbnRzXG4gICAgID4gVXNhZ2VcbiAgICAgfCBwYXBlci5hZGQoW1xuICAgICB8ICAgICB7XG4gICAgIHwgICAgICAgICB0eXBlOiBcImNpcmNsZVwiLFxuICAgICB8ICAgICAgICAgY3g6IDEwLFxuICAgICB8ICAgICAgICAgY3k6IDEwLFxuICAgICB8ICAgICAgICAgcjogNVxuICAgICB8ICAgICB9LFxuICAgICB8ICAgICB7XG4gICAgIHwgICAgICAgICB0eXBlOiBcInJlY3RcIixcbiAgICAgfCAgICAgICAgIHg6IDEwLFxuICAgICB8ICAgICAgICAgeTogMTAsXG4gICAgIHwgICAgICAgICB3aWR0aDogMTAsXG4gICAgIHwgICAgICAgICBoZWlnaHQ6IDEwLFxuICAgICB8ICAgICAgICAgZmlsbDogXCIjZmMwXCJcbiAgICAgfCAgICAgfVxuICAgICB8IF0pO1xuICAgIFxcKi9cbiAgICBwYXBlcnByb3RvLmFkZCA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAgICAgIGlmIChSLmlzKGpzb24sIFwiYXJyYXlcIikpIHtcbiAgICAgICAgICAgIHZhciByZXMgPSB0aGlzLnNldCgpLFxuICAgICAgICAgICAgICAgIGkgPSAwLFxuICAgICAgICAgICAgICAgIGlpID0ganNvbi5sZW5ndGgsXG4gICAgICAgICAgICAgICAgajtcbiAgICAgICAgICAgIGZvciAoOyBpIDwgaWk7IGkrKykge1xuICAgICAgICAgICAgICAgIGogPSBqc29uW2ldIHx8IHt9O1xuICAgICAgICAgICAgICAgIGVsZW1lbnRzW2hhc10oai50eXBlKSAmJiByZXMucHVzaCh0aGlzW2oudHlwZV0oKS5hdHRyKGopKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH07XG5cbiAgICAvKlxcXG4gICAgICogUmFwaGFlbC5mb3JtYXRcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIFNpbXBsZSBmb3JtYXQgZnVuY3Rpb24uIFJlcGxhY2VzIGNvbnN0cnVjdGlvbiBvZiB0eXBlIOKAnGB7PG51bWJlcj59YOKAnSB0byB0aGUgY29ycmVzcG9uZGluZyBhcmd1bWVudC5cbiAgICAgKipcbiAgICAgPiBQYXJhbWV0ZXJzXG4gICAgICoqXG4gICAgIC0gdG9rZW4gKHN0cmluZykgc3RyaW5nIHRvIGZvcm1hdFxuICAgICAtIOKApiAoc3RyaW5nKSByZXN0IG9mIGFyZ3VtZW50cyB3aWxsIGJlIHRyZWF0ZWQgYXMgcGFyYW1ldGVycyBmb3IgcmVwbGFjZW1lbnRcbiAgICAgPSAoc3RyaW5nKSBmb3JtYXRlZCBzdHJpbmdcbiAgICAgPiBVc2FnZVxuICAgICB8IHZhciB4ID0gMTAsXG4gICAgIHwgICAgIHkgPSAyMCxcbiAgICAgfCAgICAgd2lkdGggPSA0MCxcbiAgICAgfCAgICAgaGVpZ2h0ID0gNTA7XG4gICAgIHwgLy8gdGhpcyB3aWxsIGRyYXcgYSByZWN0YW5ndWxhciBzaGFwZSBlcXVpdmFsZW50IHRvIFwiTTEwLDIwaDQwdjUwaC00MHpcIlxuICAgICB8IHBhcGVyLnBhdGgoUmFwaGFlbC5mb3JtYXQoXCJNezB9LHsxfWh7Mn12ezN9aHs0fXpcIiwgeCwgeSwgd2lkdGgsIGhlaWdodCwgLXdpZHRoKSk7XG4gICAgXFwqL1xuICAgIFIuZm9ybWF0ID0gZnVuY3Rpb24gKHRva2VuLCBwYXJhbXMpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBSLmlzKHBhcmFtcywgYXJyYXkpID8gWzBdW2NvbmNhdF0ocGFyYW1zKSA6IGFyZ3VtZW50cztcbiAgICAgICAgdG9rZW4gJiYgUi5pcyh0b2tlbiwgc3RyaW5nKSAmJiBhcmdzLmxlbmd0aCAtIDEgJiYgKHRva2VuID0gdG9rZW4ucmVwbGFjZShmb3JtYXRyZywgZnVuY3Rpb24gKHN0ciwgaSkge1xuICAgICAgICAgICAgcmV0dXJuIGFyZ3NbKytpXSA9PSBudWxsID8gRSA6IGFyZ3NbaV07XG4gICAgICAgIH0pKTtcbiAgICAgICAgcmV0dXJuIHRva2VuIHx8IEU7XG4gICAgfTtcbiAgICAvKlxcXG4gICAgICogUmFwaGFlbC5mdWxsZmlsbFxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogQSBsaXR0bGUgYml0IG1vcmUgYWR2YW5jZWQgZm9ybWF0IGZ1bmN0aW9uIHRoYW4gQFJhcGhhZWwuZm9ybWF0LiBSZXBsYWNlcyBjb25zdHJ1Y3Rpb24gb2YgdHlwZSDigJxgezxuYW1lPn1g4oCdIHRvIHRoZSBjb3JyZXNwb25kaW5nIGFyZ3VtZW50LlxuICAgICAqKlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgKipcbiAgICAgLSB0b2tlbiAoc3RyaW5nKSBzdHJpbmcgdG8gZm9ybWF0XG4gICAgIC0ganNvbiAob2JqZWN0KSBvYmplY3Qgd2hpY2ggcHJvcGVydGllcyB3aWxsIGJlIHVzZWQgYXMgYSByZXBsYWNlbWVudFxuICAgICA9IChzdHJpbmcpIGZvcm1hdGVkIHN0cmluZ1xuICAgICA+IFVzYWdlXG4gICAgIHwgLy8gdGhpcyB3aWxsIGRyYXcgYSByZWN0YW5ndWxhciBzaGFwZSBlcXVpdmFsZW50IHRvIFwiTTEwLDIwaDQwdjUwaC00MHpcIlxuICAgICB8IHBhcGVyLnBhdGgoUmFwaGFlbC5mdWxsZmlsbChcIk17eH0se3l9aHtkaW0ud2lkdGh9dntkaW0uaGVpZ2h0fWh7ZGltWyduZWdhdGl2ZSB3aWR0aCddfXpcIiwge1xuICAgICB8ICAgICB4OiAxMCxcbiAgICAgfCAgICAgeTogMjAsXG4gICAgIHwgICAgIGRpbToge1xuICAgICB8ICAgICAgICAgd2lkdGg6IDQwLFxuICAgICB8ICAgICAgICAgaGVpZ2h0OiA1MCxcbiAgICAgfCAgICAgICAgIFwibmVnYXRpdmUgd2lkdGhcIjogLTQwXG4gICAgIHwgICAgIH1cbiAgICAgfCB9KSk7XG4gICAgXFwqL1xuICAgIFIuZnVsbGZpbGwgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG9rZW5SZWdleCA9IC9cXHsoW15cXH1dKylcXH0vZyxcbiAgICAgICAgICAgIG9iak5vdGF0aW9uUmVnZXggPSAvKD86KD86XnxcXC4pKC4rPykoPz1cXFt8XFwufCR8XFwoKXxcXFsoJ3xcIikoLis/KVxcMlxcXSkoXFwoXFwpKT8vZywgLy8gbWF0Y2hlcyAueHh4eHggb3IgW1wieHh4eHhcIl0gdG8gcnVuIG92ZXIgb2JqZWN0IHByb3BlcnRpZXNcbiAgICAgICAgICAgIHJlcGxhY2VyID0gZnVuY3Rpb24gKGFsbCwga2V5LCBvYmopIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVzID0gb2JqO1xuICAgICAgICAgICAgICAgIGtleS5yZXBsYWNlKG9iak5vdGF0aW9uUmVnZXgsIGZ1bmN0aW9uIChhbGwsIG5hbWUsIHF1b3RlLCBxdW90ZWROYW1lLCBpc0Z1bmMpIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZSA9IG5hbWUgfHwgcXVvdGVkTmFtZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5hbWUgaW4gcmVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gcmVzW25hbWVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZW9mIHJlcyA9PSBcImZ1bmN0aW9uXCIgJiYgaXNGdW5jICYmIChyZXMgPSByZXMoKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXMgPSAocmVzID09IG51bGwgfHwgcmVzID09IG9iaiA/IGFsbCA6IHJlcykgKyBcIlwiO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgICAgICB9O1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHN0ciwgb2JqKSB7XG4gICAgICAgICAgICByZXR1cm4gU3RyaW5nKHN0cikucmVwbGFjZSh0b2tlblJlZ2V4LCBmdW5jdGlvbiAoYWxsLCBrZXkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVwbGFjZXIoYWxsLCBrZXksIG9iaik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICB9KSgpO1xuICAgIC8qXFxcbiAgICAgKiBSYXBoYWVsLm5pbmphXG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBJZiB5b3Ugd2FudCB0byBsZWF2ZSBubyB0cmFjZSBvZiBSYXBoYcOrbCAoV2VsbCwgUmFwaGHDq2wgY3JlYXRlcyBvbmx5IG9uZSBnbG9iYWwgdmFyaWFibGUgYFJhcGhhZWxgLCBidXQgYW55d2F5LikgWW91IGNhbiB1c2UgYG5pbmphYCBtZXRob2QuXG4gICAgICogQmV3YXJlLCB0aGF0IGluIHRoaXMgY2FzZSBwbHVnaW5zIGNvdWxkIHN0b3Agd29ya2luZywgYmVjYXVzZSB0aGV5IGFyZSBkZXBlbmRpbmcgb24gZ2xvYmFsIHZhcmlhYmxlIGV4aXN0ZW5jZS5cbiAgICAgKipcbiAgICAgPSAob2JqZWN0KSBSYXBoYWVsIG9iamVjdFxuICAgICA+IFVzYWdlXG4gICAgIHwgKGZ1bmN0aW9uIChsb2NhbF9yYXBoYWVsKSB7XG4gICAgIHwgICAgIHZhciBwYXBlciA9IGxvY2FsX3JhcGhhZWwoMTAsIDEwLCAzMjAsIDIwMCk7XG4gICAgIHwgICAgIOKAplxuICAgICB8IH0pKFJhcGhhZWwubmluamEoKSk7XG4gICAgXFwqL1xuICAgIFIubmluamEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChvbGRSYXBoYWVsLndhcykge1xuICAgICAgICAgICAgZy53aW4uUmFwaGFlbCA9IG9sZFJhcGhhZWwuaXM7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBJRTggcmFpc2VzIGFuIGVycm9yIHdoZW4gZGVsZXRpbmcgd2luZG93IHByb3BlcnR5XG4gICAgICAgICAgICB3aW5kb3cuUmFwaGFlbCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHdpbmRvdy5SYXBoYWVsO1xuICAgICAgICAgICAgfSBjYXRjaChlKSB7fVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBSO1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIFJhcGhhZWwuc3RcbiAgICAgWyBwcm9wZXJ0eSAob2JqZWN0KSBdXG4gICAgICoqXG4gICAgICogWW91IGNhbiBhZGQgeW91ciBvd24gbWV0aG9kIHRvIGVsZW1lbnRzIGFuZCBzZXRzLiBJdCBpcyB3aXNlIHRvIGFkZCBhIHNldCBtZXRob2QgZm9yIGVhY2ggZWxlbWVudCBtZXRob2RcbiAgICAgKiB5b3UgYWRkZWQsIHNvIHlvdSB3aWxsIGJlIGFibGUgdG8gY2FsbCB0aGUgc2FtZSBtZXRob2Qgb24gc2V0cyB0b28uXG4gICAgICoqXG4gICAgICogU2VlIGFsc28gQFJhcGhhZWwuZWwuXG4gICAgID4gVXNhZ2VcbiAgICAgfCBSYXBoYWVsLmVsLnJlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgfCAgICAgdGhpcy5hdHRyKHtmaWxsOiBcIiNmMDBcIn0pO1xuICAgICB8IH07XG4gICAgIHwgUmFwaGFlbC5zdC5yZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgIHwgICAgIHRoaXMuZm9yRWFjaChmdW5jdGlvbiAoZWwpIHtcbiAgICAgfCAgICAgICAgIGVsLnJlZCgpO1xuICAgICB8ICAgICB9KTtcbiAgICAgfCB9O1xuICAgICB8IC8vIHRoZW4gdXNlIGl0XG4gICAgIHwgcGFwZXIuc2V0KHBhcGVyLmNpcmNsZSgxMDAsIDEwMCwgMjApLCBwYXBlci5jaXJjbGUoMTEwLCAxMDAsIDIwKSkucmVkKCk7XG4gICAgXFwqL1xuICAgIFIuc3QgPSBzZXRwcm90bztcblxuICAgIGV2ZS5vbihcInJhcGhhZWwuRE9NbG9hZFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGxvYWRlZCA9IHRydWU7XG4gICAgfSk7XG5cbiAgICAvLyBGaXJlZm94IDwzLjYgZml4OiBodHRwOi8vd2VicmVmbGVjdGlvbi5ibG9nc3BvdC5jb20vMjAwOS8xMS8xOTUtY2hhcnMtdG8taGVscC1sYXp5LWxvYWRpbmcuaHRtbFxuICAgIChmdW5jdGlvbiAoZG9jLCBsb2FkZWQsIGYpIHtcbiAgICAgICAgaWYgKGRvYy5yZWFkeVN0YXRlID09IG51bGwgJiYgZG9jLmFkZEV2ZW50TGlzdGVuZXIpe1xuICAgICAgICAgICAgZG9jLmFkZEV2ZW50TGlzdGVuZXIobG9hZGVkLCBmID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGRvYy5yZW1vdmVFdmVudExpc3RlbmVyKGxvYWRlZCwgZiwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIGRvYy5yZWFkeVN0YXRlID0gXCJjb21wbGV0ZVwiO1xuICAgICAgICAgICAgfSwgZmFsc2UpO1xuICAgICAgICAgICAgZG9jLnJlYWR5U3RhdGUgPSBcImxvYWRpbmdcIjtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBpc0xvYWRlZCgpIHtcbiAgICAgICAgICAgICgvaW4vKS50ZXN0KGRvYy5yZWFkeVN0YXRlKSA/IHNldFRpbWVvdXQoaXNMb2FkZWQsIDkpIDogUi5ldmUoXCJyYXBoYWVsLkRPTWxvYWRcIik7XG4gICAgICAgIH1cbiAgICAgICAgaXNMb2FkZWQoKTtcbiAgICB9KShkb2N1bWVudCwgXCJET01Db250ZW50TG9hZGVkXCIpO1xuXG4gICAgcmV0dXJuIFI7XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./dev/raphael.core.js\n')},"./dev/raphael.svg.js":function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(/*! ./raphael.core */ "./dev/raphael.core.js")], __WEBPACK_AMD_DEFINE_RESULT__ = (function(R) {\n    if (R && !R.svg) {\n        return;\n    }\n\n    var has = "hasOwnProperty",\n        Str = String,\n        toFloat = parseFloat,\n        toInt = parseInt,\n        math = Math,\n        mmax = math.max,\n        abs = math.abs,\n        pow = math.pow,\n        separator = /[, ]+/,\n        eve = R.eve,\n        E = "",\n        S = " ";\n    var xlink = "http://www.w3.org/1999/xlink",\n        markers = {\n            block: "M5,0 0,2.5 5,5z",\n            classic: "M5,0 0,2.5 5,5 3.5,3 3.5,2z",\n            diamond: "M2.5,0 5,2.5 2.5,5 0,2.5z",\n            open: "M6,1 1,3.5 6,6",\n            oval: "M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"\n        },\n        markerCounter = {};\n    R.toString = function () {\n        return  "Your browser supports SVG.\\nYou are running Rapha\\xebl " + this.version;\n    };\n    var $ = function (el, attr) {\n        if (attr) {\n            if (typeof el == "string") {\n                el = $(el);\n            }\n            for (var key in attr) if (attr[has](key)) {\n                if (key.substring(0, 6) == "xlink:") {\n                    el.setAttributeNS(xlink, key.substring(6), Str(attr[key]));\n                } else {\n                    el.setAttribute(key, Str(attr[key]));\n                }\n            }\n        } else {\n            el = R._g.doc.createElementNS("http://www.w3.org/2000/svg", el);\n            el.style && (el.style.webkitTapHighlightColor = "rgba(0,0,0,0)");\n        }\n        return el;\n    },\n    addGradientFill = function (element, gradient) {\n        var type = "linear",\n            id = element.id + gradient,\n            fx = .5, fy = .5,\n            o = element.node,\n            SVG = element.paper,\n            s = o.style,\n            el = R._g.doc.getElementById(id);\n        if (!el) {\n            gradient = Str(gradient).replace(R._radial_gradient, function (all, _fx, _fy) {\n                type = "radial";\n                if (_fx && _fy) {\n                    fx = toFloat(_fx);\n                    fy = toFloat(_fy);\n                    var dir = ((fy > .5) * 2 - 1);\n                    pow(fx - .5, 2) + pow(fy - .5, 2) > .25 &&\n                        (fy = math.sqrt(.25 - pow(fx - .5, 2)) * dir + .5) &&\n                        fy != .5 &&\n                        (fy = fy.toFixed(5) - 1e-5 * dir);\n                }\n                return E;\n            });\n            gradient = gradient.split(/\\s*\\-\\s*/);\n            if (type == "linear") {\n                var angle = gradient.shift();\n                angle = -toFloat(angle);\n                if (isNaN(angle)) {\n                    return null;\n                }\n                var vector = [0, 0, math.cos(R.rad(angle)), math.sin(R.rad(angle))],\n                    max = 1 / (mmax(abs(vector[2]), abs(vector[3])) || 1);\n                vector[2] *= max;\n                vector[3] *= max;\n                if (vector[2] < 0) {\n                    vector[0] = -vector[2];\n                    vector[2] = 0;\n                }\n                if (vector[3] < 0) {\n                    vector[1] = -vector[3];\n                    vector[3] = 0;\n                }\n            }\n            var dots = R._parseDots(gradient);\n            if (!dots) {\n                return null;\n            }\n            id = id.replace(/[\\(\\)\\s,\\xb0#]/g, "_");\n\n            if (element.gradient && id != element.gradient.id) {\n                SVG.defs.removeChild(element.gradient);\n                delete element.gradient;\n            }\n\n            if (!element.gradient) {\n                el = $(type + "Gradient", {id: id});\n                element.gradient = el;\n                $(el, type == "radial" ? {\n                    fx: fx,\n                    fy: fy\n                } : {\n                    x1: vector[0],\n                    y1: vector[1],\n                    x2: vector[2],\n                    y2: vector[3],\n                    gradientTransform: element.matrix.invert()\n                });\n                SVG.defs.appendChild(el);\n                for (var i = 0, ii = dots.length; i < ii; i++) {\n                    el.appendChild($("stop", {\n                        offset: dots[i].offset ? dots[i].offset : i ? "100%" : "0%",\n                        "stop-color": dots[i].color || "#fff",\n                        "stop-opacity": isFinite(dots[i].opacity) ? dots[i].opacity : 1\n                    }));\n                }\n            }\n        }\n        $(o, {\n            fill: fillurl(id),\n            opacity: 1,\n            "fill-opacity": 1\n        });\n        s.fill = E;\n        s.opacity = 1;\n        s.fillOpacity = 1;\n        return 1;\n    },\n    isIE9or10 = function () {\n      var mode = document.documentMode;\n      return mode && (mode === 9 || mode === 10);\n    },\n    fillurl = function (id) {\n      if (isIE9or10()) {\n          return "url(\'#" + id + "\')";\n      }\n      var location = document.location;\n      var locationString = (\n          location.protocol + \'//\' +\n          location.host +\n          location.pathname +\n          location.search\n      );\n      return "url(\'" + locationString + "#" + id + "\')";\n    },\n    updatePosition = function (o) {\n        var bbox = o.getBBox(1);\n        $(o.pattern, {patternTransform: o.matrix.invert() + " translate(" + bbox.x + "," + bbox.y + ")"});\n    },\n    addArrow = function (o, value, isEnd) {\n        if (o.type == "path") {\n            var values = Str(value).toLowerCase().split("-"),\n                p = o.paper,\n                se = isEnd ? "end" : "start",\n                node = o.node,\n                attrs = o.attrs,\n                stroke = attrs["stroke-width"],\n                i = values.length,\n                type = "classic",\n                from,\n                to,\n                dx,\n                refX,\n                attr,\n                w = 3,\n                h = 3,\n                t = 5;\n            while (i--) {\n                switch (values[i]) {\n                    case "block":\n                    case "classic":\n                    case "oval":\n                    case "diamond":\n                    case "open":\n                    case "none":\n                        type = values[i];\n                        break;\n                    case "wide": h = 5; break;\n                    case "narrow": h = 2; break;\n                    case "long": w = 5; break;\n                    case "short": w = 2; break;\n                }\n            }\n            if (type == "open") {\n                w += 2;\n                h += 2;\n                t += 2;\n                dx = 1;\n                refX = isEnd ? 4 : 1;\n                attr = {\n                    fill: "none",\n                    stroke: attrs.stroke\n                };\n            } else {\n                refX = dx = w / 2;\n                attr = {\n                    fill: attrs.stroke,\n                    stroke: "none"\n                };\n            }\n            if (o._.arrows) {\n                if (isEnd) {\n                    o._.arrows.endPath && markerCounter[o._.arrows.endPath]--;\n                    o._.arrows.endMarker && markerCounter[o._.arrows.endMarker]--;\n                } else {\n                    o._.arrows.startPath && markerCounter[o._.arrows.startPath]--;\n                    o._.arrows.startMarker && markerCounter[o._.arrows.startMarker]--;\n                }\n            } else {\n                o._.arrows = {};\n            }\n            if (type != "none") {\n                var pathId = "raphael-marker-" + type,\n                    markerId = "raphael-marker-" + se + type + w + h + "-obj" + o.id;\n                if (!R._g.doc.getElementById(pathId)) {\n                    p.defs.appendChild($($("path"), {\n                        "stroke-linecap": "round",\n                        d: markers[type],\n                        id: pathId\n                    }));\n                    markerCounter[pathId] = 1;\n                } else {\n                    markerCounter[pathId]++;\n                }\n                var marker = R._g.doc.getElementById(markerId),\n                    use;\n                if (!marker) {\n                    marker = $($("marker"), {\n                        id: markerId,\n                        markerHeight: h,\n                        markerWidth: w,\n                        orient: "auto",\n                        refX: refX,\n                        refY: h / 2\n                    });\n                    use = $($("use"), {\n                        "xlink:href": "#" + pathId,\n                        transform: (isEnd ? "rotate(180 " + w / 2 + " " + h / 2 + ") " : E) + "scale(" + w / t + "," + h / t + ")",\n                        "stroke-width": (1 / ((w / t + h / t) / 2)).toFixed(4)\n                    });\n                    marker.appendChild(use);\n                    p.defs.appendChild(marker);\n                    markerCounter[markerId] = 1;\n                } else {\n                    markerCounter[markerId]++;\n                    use = marker.getElementsByTagName("use")[0];\n                }\n                $(use, attr);\n                var delta = dx * (type != "diamond" && type != "oval");\n                if (isEnd) {\n                    from = o._.arrows.startdx * stroke || 0;\n                    to = R.getTotalLength(attrs.path) - delta * stroke;\n                } else {\n                    from = delta * stroke;\n                    to = R.getTotalLength(attrs.path) - (o._.arrows.enddx * stroke || 0);\n                }\n                attr = {};\n                attr["marker-" + se] = "url(#" + markerId + ")";\n                if (to || from) {\n                    attr.d = R.getSubpath(attrs.path, from, to);\n                }\n                $(node, attr);\n                o._.arrows[se + "Path"] = pathId;\n                o._.arrows[se + "Marker"] = markerId;\n                o._.arrows[se + "dx"] = delta;\n                o._.arrows[se + "Type"] = type;\n                o._.arrows[se + "String"] = value;\n            } else {\n                if (isEnd) {\n                    from = o._.arrows.startdx * stroke || 0;\n                    to = R.getTotalLength(attrs.path) - from;\n                } else {\n                    from = 0;\n                    to = R.getTotalLength(attrs.path) - (o._.arrows.enddx * stroke || 0);\n                }\n                o._.arrows[se + "Path"] && $(node, {d: R.getSubpath(attrs.path, from, to)});\n                delete o._.arrows[se + "Path"];\n                delete o._.arrows[se + "Marker"];\n                delete o._.arrows[se + "dx"];\n                delete o._.arrows[se + "Type"];\n                delete o._.arrows[se + "String"];\n            }\n            for (attr in markerCounter) if (markerCounter[has](attr) && !markerCounter[attr]) {\n                var item = R._g.doc.getElementById(attr);\n                item && item.parentNode.removeChild(item);\n            }\n        }\n    },\n    dasharray = {\n        "-": [3, 1],\n        ".": [1, 1],\n        "-.": [3, 1, 1, 1],\n        "-..": [3, 1, 1, 1, 1, 1],\n        ". ": [1, 3],\n        "- ": [4, 3],\n        "--": [8, 3],\n        "- .": [4, 3, 1, 3],\n        "--.": [8, 3, 1, 3],\n        "--..": [8, 3, 1, 3, 1, 3]\n    },\n    addDashes = function (o, value, params) {\n        value = dasharray[Str(value).toLowerCase()];\n        if (value) {\n            var width = o.attrs["stroke-width"] || "1",\n                butt = {round: width, square: width, butt: 0}[o.attrs["stroke-linecap"] || params["stroke-linecap"]] || 0,\n                dashes = [],\n                i = value.length;\n            while (i--) {\n                dashes[i] = value[i] * width + ((i % 2) ? 1 : -1) * butt;\n            }\n            $(o.node, {"stroke-dasharray": dashes.join(",")});\n        }\n        else {\n          $(o.node, {"stroke-dasharray": "none"});\n        }\n    },\n    setFillAndStroke = function (o, params) {\n        var node = o.node,\n            attrs = o.attrs,\n            vis = node.style.visibility;\n        node.style.visibility = "hidden";\n        for (var att in params) {\n            if (params[has](att)) {\n                if (!R._availableAttrs[has](att)) {\n                    continue;\n                }\n                var value = params[att];\n                attrs[att] = value;\n                switch (att) {\n                    case "blur":\n                        o.blur(value);\n                        break;\n                    case "title":\n                        var title = node.getElementsByTagName("title");\n\n                        // Use the existing <title>.\n                        if (title.length && (title = title[0])) {\n                          title.firstChild.nodeValue = value;\n                        } else {\n                          title = $("title");\n                          var val = R._g.doc.createTextNode(value);\n                          title.appendChild(val);\n                          node.appendChild(title);\n                        }\n                        break;\n                    case "href":\n                    case "target":\n                        var pn = node.parentNode;\n                        if (pn.tagName.toLowerCase() != "a") {\n                            var hl = $("a");\n                            pn.insertBefore(hl, node);\n                            hl.appendChild(node);\n                            pn = hl;\n                        }\n                        if (att == "target") {\n                            pn.setAttributeNS(xlink, "show", value == "blank" ? "new" : value);\n                        } else {\n                            pn.setAttributeNS(xlink, att, value);\n                        }\n                        break;\n                    case "cursor":\n                        node.style.cursor = value;\n                        break;\n                    case "transform":\n                        o.transform(value);\n                        break;\n                    case "arrow-start":\n                        addArrow(o, value);\n                        break;\n                    case "arrow-end":\n                        addArrow(o, value, 1);\n                        break;\n                    case "clip-rect":\n                        var rect = Str(value).split(separator);\n                        if (rect.length == 4) {\n                            o.clip && o.clip.parentNode.parentNode.removeChild(o.clip.parentNode);\n                            var el = $("clipPath"),\n                                rc = $("rect");\n                            el.id = R.createUUID();\n                            $(rc, {\n                                x: rect[0],\n                                y: rect[1],\n                                width: rect[2],\n                                height: rect[3]\n                            });\n                            el.appendChild(rc);\n                            o.paper.defs.appendChild(el);\n                            $(node, {"clip-path": "url(#" + el.id + ")"});\n                            o.clip = rc;\n                        }\n                        if (!value) {\n                            var path = node.getAttribute("clip-path");\n                            if (path) {\n                                var clip = R._g.doc.getElementById(path.replace(/(^url\\(#|\\)$)/g, E));\n                                clip && clip.parentNode.removeChild(clip);\n                                $(node, {"clip-path": E});\n                                delete o.clip;\n                            }\n                        }\n                    break;\n                    case "path":\n                        if (o.type == "path") {\n                            $(node, {d: value ? attrs.path = R._pathToAbsolute(value) : "M0,0"});\n                            o._.dirty = 1;\n                            if (o._.arrows) {\n                                "startString" in o._.arrows && addArrow(o, o._.arrows.startString);\n                                "endString" in o._.arrows && addArrow(o, o._.arrows.endString, 1);\n                            }\n                        }\n                        break;\n                    case "width":\n                        node.setAttribute(att, value);\n                        o._.dirty = 1;\n                        if (attrs.fx) {\n                            att = "x";\n                            value = attrs.x;\n                        } else {\n                            break;\n                        }\n                    case "x":\n                        if (attrs.fx) {\n                            value = -attrs.x - (attrs.width || 0);\n                        }\n                    case "rx":\n                        if (att == "rx" && o.type == "rect") {\n                            break;\n                        }\n                    case "cx":\n                        node.setAttribute(att, value);\n                        o.pattern && updatePosition(o);\n                        o._.dirty = 1;\n                        break;\n                    case "height":\n                        node.setAttribute(att, value);\n                        o._.dirty = 1;\n                        if (attrs.fy) {\n                            att = "y";\n                            value = attrs.y;\n                        } else {\n                            break;\n                        }\n                    case "y":\n                        if (attrs.fy) {\n                            value = -attrs.y - (attrs.height || 0);\n                        }\n                    case "ry":\n                        if (att == "ry" && o.type == "rect") {\n                            break;\n                        }\n                    case "cy":\n                        node.setAttribute(att, value);\n                        o.pattern && updatePosition(o);\n                        o._.dirty = 1;\n                        break;\n                    case "r":\n                        if (o.type == "rect") {\n                            $(node, {rx: value, ry: value});\n                        } else {\n                            node.setAttribute(att, value);\n                        }\n                        o._.dirty = 1;\n                        break;\n                    case "src":\n                        if (o.type == "image") {\n                            node.setAttributeNS(xlink, "href", value);\n                        }\n                        break;\n                    case "stroke-width":\n                        if (o._.sx != 1 || o._.sy != 1) {\n                            value /= mmax(abs(o._.sx), abs(o._.sy)) || 1;\n                        }\n                        node.setAttribute(att, value);\n                        if (attrs["stroke-dasharray"]) {\n                            addDashes(o, attrs["stroke-dasharray"], params);\n                        }\n                        if (o._.arrows) {\n                            "startString" in o._.arrows && addArrow(o, o._.arrows.startString);\n                            "endString" in o._.arrows && addArrow(o, o._.arrows.endString, 1);\n                        }\n                        break;\n                    case "stroke-dasharray":\n                        addDashes(o, value, params);\n                        break;\n                    case "fill":\n                        var isURL = Str(value).match(R._ISURL);\n                        if (isURL) {\n                            el = $("pattern");\n                            var ig = $("image");\n                            el.id = R.createUUID();\n                            $(el, {x: 0, y: 0, patternUnits: "userSpaceOnUse", height: 1, width: 1});\n                            $(ig, {x: 0, y: 0, "xlink:href": isURL[1]});\n                            el.appendChild(ig);\n\n                            (function (el) {\n                                R._preload(isURL[1], function () {\n                                    var w = this.offsetWidth,\n                                        h = this.offsetHeight;\n                                    $(el, {width: w, height: h});\n                                    $(ig, {width: w, height: h});\n                                });\n                            })(el);\n                            o.paper.defs.appendChild(el);\n                            $(node, {fill: "url(#" + el.id + ")"});\n                            o.pattern = el;\n                            o.pattern && updatePosition(o);\n                            break;\n                        }\n                        var clr = R.getRGB(value);\n                        if (!clr.error) {\n                            delete params.gradient;\n                            delete attrs.gradient;\n                            !R.is(attrs.opacity, "undefined") &&\n                                R.is(params.opacity, "undefined") &&\n                                $(node, {opacity: attrs.opacity});\n                            !R.is(attrs["fill-opacity"], "undefined") &&\n                                R.is(params["fill-opacity"], "undefined") &&\n                                $(node, {"fill-opacity": attrs["fill-opacity"]});\n                        } else if ((o.type == "circle" || o.type == "ellipse" || Str(value).charAt() != "r") && addGradientFill(o, value)) {\n                            if ("opacity" in attrs || "fill-opacity" in attrs) {\n                                var gradient = R._g.doc.getElementById(node.getAttribute("fill").replace(/^url\\(#|\\)$/g, E));\n                                if (gradient) {\n                                    var stops = gradient.getElementsByTagName("stop");\n                                    $(stops[stops.length - 1], {"stop-opacity": ("opacity" in attrs ? attrs.opacity : 1) * ("fill-opacity" in attrs ? attrs["fill-opacity"] : 1)});\n                                }\n                            }\n                            attrs.gradient = value;\n                            attrs.fill = "none";\n                            break;\n                        }\n                        clr[has]("opacity") && $(node, {"fill-opacity": clr.opacity > 1 ? clr.opacity / 100 : clr.opacity});\n                    case "stroke":\n                        clr = R.getRGB(value);\n                        node.setAttribute(att, clr.hex);\n                        att == "stroke" && clr[has]("opacity") && $(node, {"stroke-opacity": clr.opacity > 1 ? clr.opacity / 100 : clr.opacity});\n                        if (att == "stroke" && o._.arrows) {\n                            "startString" in o._.arrows && addArrow(o, o._.arrows.startString);\n                            "endString" in o._.arrows && addArrow(o, o._.arrows.endString, 1);\n                        }\n                        break;\n                    case "gradient":\n                        (o.type == "circle" || o.type == "ellipse" || Str(value).charAt() != "r") && addGradientFill(o, value);\n                        break;\n                    case "opacity":\n                        if (attrs.gradient && !attrs[has]("stroke-opacity")) {\n                            $(node, {"stroke-opacity": value > 1 ? value / 100 : value});\n                        }\n                        // fall\n                    case "fill-opacity":\n                        if (attrs.gradient) {\n                            gradient = R._g.doc.getElementById(node.getAttribute("fill").replace(/^url\\(#|\\)$/g, E));\n                            if (gradient) {\n                                stops = gradient.getElementsByTagName("stop");\n                                $(stops[stops.length - 1], {"stop-opacity": value});\n                            }\n                            break;\n                        }\n                    default:\n                        att == "font-size" && (value = toInt(value, 10) + "px");\n                        var cssrule = att.replace(/(\\-.)/g, function (w) {\n                            return w.substring(1).toUpperCase();\n                        });\n                        node.style[cssrule] = value;\n                        o._.dirty = 1;\n                        node.setAttribute(att, value);\n                        break;\n                }\n            }\n        }\n\n        tuneText(o, params);\n        node.style.visibility = vis;\n    },\n    leading = 1.2,\n    tuneText = function (el, params) {\n        if (el.type != "text" || !(params[has]("text") || params[has]("font") || params[has]("font-size") || params[has]("x") || params[has]("y"))) {\n            return;\n        }\n        var a = el.attrs,\n            node = el.node,\n            fontSize = node.firstChild ? toInt(R._g.doc.defaultView.getComputedStyle(node.firstChild, E).getPropertyValue("font-size"), 10) : 10;\n\n        if (params[has]("text")) {\n            a.text = params.text;\n            while (node.firstChild) {\n                node.removeChild(node.firstChild);\n            }\n            var texts = Str(params.text).split("\\n"),\n                tspans = [],\n                tspan;\n            for (var i = 0, ii = texts.length; i < ii; i++) {\n                tspan = $("tspan");\n                i && $(tspan, {dy: fontSize * leading, x: a.x});\n                tspan.appendChild(R._g.doc.createTextNode(texts[i]));\n                node.appendChild(tspan);\n                tspans[i] = tspan;\n            }\n        } else {\n            tspans = node.getElementsByTagName("tspan");\n            for (i = 0, ii = tspans.length; i < ii; i++) if (i) {\n                $(tspans[i], {dy: fontSize * leading, x: a.x});\n            } else {\n                $(tspans[0], {dy: 0});\n            }\n        }\n        $(node, {x: a.x, y: a.y});\n        el._.dirty = 1;\n        var bb = el._getBBox(),\n            dif = a.y - (bb.y + bb.height / 2);\n        dif && R.is(dif, "finite") && $(tspans[0], {dy: dif});\n    },\n    getRealNode = function (node) {\n        if (node.parentNode && node.parentNode.tagName.toLowerCase() === "a") {\n            return node.parentNode;\n        } else {\n            return node;\n        }\n    },\n    Element = function (node, svg) {\n        var X = 0,\n            Y = 0;\n        /*\\\n         * Element.node\n         [ property (object) ]\n         **\n         * Gives you a reference to the DOM object, so you can assign event handlers or just mess around.\n         **\n         * Note: Don’t mess with it.\n         > Usage\n         | // draw a circle at coordinate 10,10 with radius of 10\n         | var c = paper.circle(10, 10, 10);\n         | c.node.onclick = function () {\n         |     c.attr("fill", "red");\n         | };\n        \\*/\n        this[0] = this.node = node;\n        /*\\\n         * Element.raphael\n         [ property (object) ]\n         **\n         * Internal reference to @Raphael object. In case it is not available.\n         > Usage\n         | Raphael.el.red = function () {\n         |     var hsb = this.paper.raphael.rgb2hsb(this.attr("fill"));\n         |     hsb.h = 1;\n         |     this.attr({fill: this.paper.raphael.hsb2rgb(hsb).hex});\n         | }\n        \\*/\n        node.raphael = true;\n        /*\\\n         * Element.id\n         [ property (number) ]\n         **\n         * Unique id of the element. Especially useful when you want to listen to events of the element,\n         * because all events are fired in format `<module>.<action>.<id>`. Also useful for @Paper.getById method.\n        \\*/\n        this.id = guid();\n        node.raphaelid = this.id;\n\n        /**\n        * Method that returns a 5 letter/digit id, enough for 36^5 = 60466176 elements\n        * @returns {string} id\n        */\n        function guid() {\n            return ("0000" + (Math.random()*Math.pow(36,5) << 0).toString(36)).slice(-5);\n        }\n\n        this.matrix = R.matrix();\n        this.realPath = null;\n        /*\\\n         * Element.paper\n         [ property (object) ]\n         **\n         * Internal reference to “paper” where object drawn. Mainly for use in plugins and element extensions.\n         > Usage\n         | Raphael.el.cross = function () {\n         |     this.attr({fill: "red"});\n         |     this.paper.path("M10,10L50,50M50,10L10,50")\n         |         .attr({stroke: "red"});\n         | }\n        \\*/\n        this.paper = svg;\n        this.attrs = this.attrs || {};\n        this._ = {\n            transform: [],\n            sx: 1,\n            sy: 1,\n            deg: 0,\n            dx: 0,\n            dy: 0,\n            dirty: 1\n        };\n        !svg.bottom && (svg.bottom = this);\n        /*\\\n         * Element.prev\n         [ property (object) ]\n         **\n         * Reference to the previous element in the hierarchy.\n        \\*/\n        this.prev = svg.top;\n        svg.top && (svg.top.next = this);\n        svg.top = this;\n        /*\\\n         * Element.next\n         [ property (object) ]\n         **\n         * Reference to the next element in the hierarchy.\n        \\*/\n        this.next = null;\n    },\n    elproto = R.el;\n\n    Element.prototype = elproto;\n    elproto.constructor = Element;\n\n    R._engine.path = function (pathString, SVG) {\n        var el = $("path");\n        SVG.canvas && SVG.canvas.appendChild(el);\n        var p = new Element(el, SVG);\n        p.type = "path";\n        setFillAndStroke(p, {\n            fill: "none",\n            stroke: "#000",\n            path: pathString\n        });\n        return p;\n    };\n    /*\\\n     * Element.rotate\n     [ method ]\n     **\n     * Deprecated! Use @Element.transform instead.\n     * Adds rotation by given angle around given point to the list of\n     * transformations of the element.\n     > Parameters\n     - deg (number) angle in degrees\n     - cx (number) #optional x coordinate of the centre of rotation\n     - cy (number) #optional y coordinate of the centre of rotation\n     * If cx & cy aren’t specified centre of the shape is used as a point of rotation.\n     = (object) @Element\n    \\*/\n    elproto.rotate = function (deg, cx, cy) {\n        if (this.removed) {\n            return this;\n        }\n        deg = Str(deg).split(separator);\n        if (deg.length - 1) {\n            cx = toFloat(deg[1]);\n            cy = toFloat(deg[2]);\n        }\n        deg = toFloat(deg[0]);\n        (cy == null) && (cx = cy);\n        if (cx == null || cy == null) {\n            var bbox = this.getBBox(1);\n            cx = bbox.x + bbox.width / 2;\n            cy = bbox.y + bbox.height / 2;\n        }\n        this.transform(this._.transform.concat([["r", deg, cx, cy]]));\n        return this;\n    };\n    /*\\\n     * Element.scale\n     [ method ]\n     **\n     * Deprecated! Use @Element.transform instead.\n     * Adds scale by given amount relative to given point to the list of\n     * transformations of the element.\n     > Parameters\n     - sx (number) horisontal scale amount\n     - sy (number) vertical scale amount\n     - cx (number) #optional x coordinate of the centre of scale\n     - cy (number) #optional y coordinate of the centre of scale\n     * If cx & cy aren’t specified centre of the shape is used instead.\n     = (object) @Element\n    \\*/\n    elproto.scale = function (sx, sy, cx, cy) {\n        if (this.removed) {\n            return this;\n        }\n        sx = Str(sx).split(separator);\n        if (sx.length - 1) {\n            sy = toFloat(sx[1]);\n            cx = toFloat(sx[2]);\n            cy = toFloat(sx[3]);\n        }\n        sx = toFloat(sx[0]);\n        (sy == null) && (sy = sx);\n        (cy == null) && (cx = cy);\n        if (cx == null || cy == null) {\n            var bbox = this.getBBox(1);\n        }\n        cx = cx == null ? bbox.x + bbox.width / 2 : cx;\n        cy = cy == null ? bbox.y + bbox.height / 2 : cy;\n        this.transform(this._.transform.concat([["s", sx, sy, cx, cy]]));\n        return this;\n    };\n    /*\\\n     * Element.translate\n     [ method ]\n     **\n     * Deprecated! Use @Element.transform instead.\n     * Adds translation by given amount to the list of transformations of the element.\n     > Parameters\n     - dx (number) horisontal shift\n     - dy (number) vertical shift\n     = (object) @Element\n    \\*/\n    elproto.translate = function (dx, dy) {\n        if (this.removed) {\n            return this;\n        }\n        dx = Str(dx).split(separator);\n        if (dx.length - 1) {\n            dy = toFloat(dx[1]);\n        }\n        dx = toFloat(dx[0]) || 0;\n        dy = +dy || 0;\n        this.transform(this._.transform.concat([["t", dx, dy]]));\n        return this;\n    };\n    /*\\\n     * Element.transform\n     [ method ]\n     **\n     * Adds transformation to the element which is separate to other attributes,\n     * i.e. translation doesn’t change `x` or `y` of the rectange. The format\n     * of transformation string is similar to the path string syntax:\n     | "t100,100r30,100,100s2,2,100,100r45s1.5"\n     * Each letter is a command. There are four commands: `t` is for translate, `r` is for rotate, `s` is for\n     * scale and `m` is for matrix.\n     *\n     * There are also alternative “absolute” translation, rotation and scale: `T`, `R` and `S`. They will not take previous transformation into account. For example, `...T100,0` will always move element 100 px horisontally, while `...t100,0` could move it vertically if there is `r90` before. Just compare results of `r90t100,0` and `r90T100,0`.\n     *\n     * So, the example line above could be read like “translate by 100, 100; rotate 30° around 100, 100; scale twice around 100, 100;\n     * rotate 45° around centre; scale 1.5 times relative to centre”. As you can see rotate and scale commands have origin\n     * coordinates as optional parameters, the default is the centre point of the element.\n     * Matrix accepts six parameters.\n     > Usage\n     | var el = paper.rect(10, 20, 300, 200);\n     | // translate 100, 100, rotate 45°, translate -100, 0\n     | el.transform("t100,100r45t-100,0");\n     | // if you want you can append or prepend transformations\n     | el.transform("...t50,50");\n     | el.transform("s2...");\n     | // or even wrap\n     | el.transform("t50,50...t-50-50");\n     | // to reset transformation call method with empty string\n     | el.transform("");\n     | // to get current value call it without parameters\n     | console.log(el.transform());\n     > Parameters\n     - tstr (string) #optional transformation string\n     * If tstr isn’t specified\n     = (string) current transformation string\n     * else\n     = (object) @Element\n    \\*/\n    elproto.transform = function (tstr) {\n        var _ = this._;\n        if (tstr == null) {\n            return _.transform;\n        }\n        R._extractTransform(this, tstr);\n\n        this.clip && $(this.clip, {transform: this.matrix.invert()});\n        this.pattern && updatePosition(this);\n        this.node && $(this.node, {transform: this.matrix});\n\n        if (_.sx != 1 || _.sy != 1) {\n            var sw = this.attrs[has]("stroke-width") ? this.attrs["stroke-width"] : 1;\n            this.attr({"stroke-width": sw});\n        }\n\n        return this;\n    };\n    /*\\\n     * Element.hide\n     [ method ]\n     **\n     * Makes element invisible. See @Element.show.\n     = (object) @Element\n    \\*/\n    elproto.hide = function () {\n        if(!this.removed) this.node.style.display = "none";\n        return this;\n    };\n    /*\\\n     * Element.show\n     [ method ]\n     **\n     * Makes element visible. See @Element.hide.\n     = (object) @Element\n    \\*/\n    elproto.show = function () {\n        if(!this.removed) this.node.style.display = "";\n        return this;\n    };\n    /*\\\n     * Element.remove\n     [ method ]\n     **\n     * Removes element from the paper.\n    \\*/\n    elproto.remove = function () {\n        var node = getRealNode(this.node);\n        if (this.removed || !node.parentNode) {\n            return;\n        }\n        var paper = this.paper;\n        paper.__set__ && paper.__set__.exclude(this);\n        eve.unbind("raphael.*.*." + this.id);\n        if (this.gradient) {\n            paper.defs.removeChild(this.gradient);\n        }\n        R._tear(this, paper);\n\n        node.parentNode.removeChild(node);\n\n        // Remove custom data for element\n        this.removeData();\n\n        for (var i in this) {\n            this[i] = typeof this[i] == "function" ? R._removedFactory(i) : null;\n        }\n        this.removed = true;\n    };\n    elproto._getBBox = function () {\n        if (this.node.style.display == "none") {\n            this.show();\n            var hide = true;\n        }\n        var canvasHidden = false,\n            containerStyle;\n        if (this.paper.canvas.parentElement) {\n          containerStyle = this.paper.canvas.parentElement.style;\n        } //IE10+ can\'t find parentElement\n        else if (this.paper.canvas.parentNode) {\n          containerStyle = this.paper.canvas.parentNode.style;\n        }\n\n        if(containerStyle && containerStyle.display == "none") {\n          canvasHidden = true;\n          containerStyle.display = "";\n        }\n        var bbox = {};\n        try {\n            bbox = this.node.getBBox();\n        } catch(e) {\n            // Firefox 3.0.x, 25.0.1 (probably more versions affected) play badly here - possible fix\n            bbox = {\n                x: this.node.clientLeft,\n                y: this.node.clientTop,\n                width: this.node.clientWidth,\n                height: this.node.clientHeight\n            }\n        } finally {\n            bbox = bbox || {};\n            if(canvasHidden){\n              containerStyle.display = "none";\n            }\n        }\n        hide && this.hide();\n        return bbox;\n    };\n    /*\\\n     * Element.attr\n     [ method ]\n     **\n     * Sets the attributes of the element.\n     > Parameters\n     - attrName (string) attribute’s name\n     - value (string) value\n     * or\n     - params (object) object of name/value pairs\n     * or\n     - attrName (string) attribute’s name\n     * or\n     - attrNames (array) in this case method returns array of current values for given attribute names\n     = (object) @Element if attrsName & value or params are passed in.\n     = (...) value of the attribute if only attrsName is passed in.\n     = (array) array of values of the attribute if attrsNames is passed in.\n     = (object) object of attributes if nothing is passed in.\n     > Possible parameters\n     # <p>Please refer to the <a href="http://www.w3.org/TR/SVG/" title="The W3C Recommendation for the SVG language describes these properties in detail.">SVG specification</a> for an explanation of these parameters.</p>\n     o arrow-end (string) arrowhead on the end of the path. The format for string is `<type>[-<width>[-<length>]]`. Possible types: `classic`, `block`, `open`, `oval`, `diamond`, `none`, width: `wide`, `narrow`, `medium`, length: `long`, `short`, `midium`.\n     o clip-rect (string) comma or space separated values: x, y, width and height\n     o cursor (string) CSS type of the cursor\n     o cx (number) the x-axis coordinate of the center of the circle, or ellipse\n     o cy (number) the y-axis coordinate of the center of the circle, or ellipse\n     o fill (string) colour, gradient or image\n     o fill-opacity (number)\n     o font (string)\n     o font-family (string)\n     o font-size (number) font size in pixels\n     o font-weight (string)\n     o height (number)\n     o href (string) URL, if specified element behaves as hyperlink\n     o opacity (number)\n     o path (string) SVG path string format\n     o r (number) radius of the circle, ellipse or rounded corner on the rect\n     o rx (number) horisontal radius of the ellipse\n     o ry (number) vertical radius of the ellipse\n     o src (string) image URL, only works for @Element.image element\n     o stroke (string) stroke colour\n     o stroke-dasharray (string) [“”, “none”, “`-`”, “`.`”, “`-.`”, “`-..`”, “`. `”, “`- `”, “`--`”, “`- .`”, “`--.`”, “`--..`”]\n     o stroke-linecap (string) [“`butt`”, “`square`”, “`round`”]\n     o stroke-linejoin (string) [“`bevel`”, “`round`”, “`miter`”]\n     o stroke-miterlimit (number)\n     o stroke-opacity (number)\n     o stroke-width (number) stroke width in pixels, default is \'1\'\n     o target (string) used with href\n     o text (string) contents of the text element. Use `\\n` for multiline text\n     o text-anchor (string) [“`start`”, “`middle`”, “`end`”], default is “`middle`”\n     o title (string) will create tooltip with a given text\n     o transform (string) see @Element.transform\n     o width (number)\n     o x (number)\n     o y (number)\n     > Gradients\n     * Linear gradient format: “`‹angle›-‹colour›[-‹colour›[:‹offset›]]*-‹colour›`”, example: “`90-#fff-#000`” – 90°\n     * gradient from white to black or “`0-#fff-#f00:20-#000`” – 0° gradient from white via red (at 20%) to black.\n     *\n     * radial gradient: “`r[(‹fx›, ‹fy›)]‹colour›[-‹colour›[:‹offset›]]*-‹colour›`”, example: “`r#fff-#000`” –\n     * gradient from white to black or “`r(0.25, 0.75)#fff-#000`” – gradient from white to black with focus point\n     * at 0.25, 0.75. Focus point coordinates are in 0..1 range. Radial gradients can only be applied to circles and ellipses.\n     > Path String\n     # <p>Please refer to <a href="http://www.w3.org/TR/SVG/paths.html#PathData" title="Details of a path’s data attribute’s format are described in the SVG specification.">SVG documentation regarding path string</a>. Raphaël fully supports it.</p>\n     > Colour Parsing\n     # <ul>\n     #     <li>Colour name (“<code>red</code>”, “<code>green</code>”, “<code>cornflowerblue</code>”, etc)</li>\n     #     <li>#••• — shortened HTML colour: (“<code>#000</code>”, “<code>#fc0</code>”, etc)</li>\n     #     <li>#•••••• — full length HTML colour: (“<code>#000000</code>”, “<code>#bd2300</code>”)</li>\n     #     <li>rgb(•••, •••, •••) — red, green and blue channels’ values: (“<code>rgb(200,&nbsp;100,&nbsp;0)</code>”)</li>\n     #     <li>rgb(•••%, •••%, •••%) — same as above, but in %: (“<code>rgb(100%,&nbsp;175%,&nbsp;0%)</code>”)</li>\n     #     <li>rgba(•••, •••, •••, •••) — red, green and blue channels’ values: (“<code>rgba(200,&nbsp;100,&nbsp;0, .5)</code>”)</li>\n     #     <li>rgba(•••%, •••%, •••%, •••%) — same as above, but in %: (“<code>rgba(100%,&nbsp;175%,&nbsp;0%, 50%)</code>”)</li>\n     #     <li>hsb(•••, •••, •••) — hue, saturation and brightness values: (“<code>hsb(0.5,&nbsp;0.25,&nbsp;1)</code>”)</li>\n     #     <li>hsb(•••%, •••%, •••%) — same as above, but in %</li>\n     #     <li>hsba(•••, •••, •••, •••) — same as above, but with opacity</li>\n     #     <li>hsl(•••, •••, •••) — almost the same as hsb, see <a href="http://en.wikipedia.org/wiki/HSL_and_HSV" title="HSL and HSV - Wikipedia, the free encyclopedia">Wikipedia page</a></li>\n     #     <li>hsl(•••%, •••%, •••%) — same as above, but in %</li>\n     #     <li>hsla(•••, •••, •••, •••) — same as above, but with opacity</li>\n     #     <li>Optionally for hsb and hsl you could specify hue as a degree: “<code>hsl(240deg,&nbsp;1,&nbsp;.5)</code>” or, if you want to go fancy, “<code>hsl(240°,&nbsp;1,&nbsp;.5)</code>”</li>\n     # </ul>\n    \\*/\n    elproto.attr = function (name, value) {\n        if (this.removed) {\n            return this;\n        }\n        if (name == null) {\n            var res = {};\n            for (var a in this.attrs) if (this.attrs[has](a)) {\n                res[a] = this.attrs[a];\n            }\n            res.gradient && res.fill == "none" && (res.fill = res.gradient) && delete res.gradient;\n            res.transform = this._.transform;\n            return res;\n        }\n        if (value == null && R.is(name, "string")) {\n            if (name == "fill" && this.attrs.fill == "none" && this.attrs.gradient) {\n                return this.attrs.gradient;\n            }\n            if (name == "transform") {\n                return this._.transform;\n            }\n            var names = name.split(separator),\n                out = {};\n            for (var i = 0, ii = names.length; i < ii; i++) {\n                name = names[i];\n                if (name in this.attrs) {\n                    out[name] = this.attrs[name];\n                } else if (R.is(this.paper.customAttributes[name], "function")) {\n                    out[name] = this.paper.customAttributes[name].def;\n                } else {\n                    out[name] = R._availableAttrs[name];\n                }\n            }\n            return ii - 1 ? out : out[names[0]];\n        }\n        if (value == null && R.is(name, "array")) {\n            out = {};\n            for (i = 0, ii = name.length; i < ii; i++) {\n                out[name[i]] = this.attr(name[i]);\n            }\n            return out;\n        }\n        if (value != null) {\n            var params = {};\n            params[name] = value;\n        } else if (name != null && R.is(name, "object")) {\n            params = name;\n        }\n        for (var key in params) {\n            eve("raphael.attr." + key + "." + this.id, this, params[key]);\n        }\n        for (key in this.paper.customAttributes) if (this.paper.customAttributes[has](key) && params[has](key) && R.is(this.paper.customAttributes[key], "function")) {\n            var par = this.paper.customAttributes[key].apply(this, [].concat(params[key]));\n            this.attrs[key] = params[key];\n            for (var subkey in par) if (par[has](subkey)) {\n                params[subkey] = par[subkey];\n            }\n        }\n        setFillAndStroke(this, params);\n        return this;\n    };\n    /*\\\n     * Element.toFront\n     [ method ]\n     **\n     * Moves the element so it is the closest to the viewer’s eyes, on top of other elements.\n     = (object) @Element\n    \\*/\n    elproto.toFront = function () {\n        if (this.removed) {\n            return this;\n        }\n        var node = getRealNode(this.node);\n        node.parentNode.appendChild(node);\n        var svg = this.paper;\n        svg.top != this && R._tofront(this, svg);\n        return this;\n    };\n    /*\\\n     * Element.toBack\n     [ method ]\n     **\n     * Moves the element so it is the furthest from the viewer’s eyes, behind other elements.\n     = (object) @Element\n    \\*/\n    elproto.toBack = function () {\n        if (this.removed) {\n            return this;\n        }\n        var node = getRealNode(this.node);\n        var parentNode = node.parentNode;\n        parentNode.insertBefore(node, parentNode.firstChild);\n        R._toback(this, this.paper);\n        var svg = this.paper;\n        return this;\n    };\n    /*\\\n     * Element.insertAfter\n     [ method ]\n     **\n     * Inserts current object after the given one.\n     = (object) @Element\n    \\*/\n    elproto.insertAfter = function (element) {\n        if (this.removed || !element) {\n            return this;\n        }\n\n        var node = getRealNode(this.node);\n        var afterNode = getRealNode(element.node || element[element.length - 1].node);\n        if (afterNode.nextSibling) {\n            afterNode.parentNode.insertBefore(node, afterNode.nextSibling);\n        } else {\n            afterNode.parentNode.appendChild(node);\n        }\n        R._insertafter(this, element, this.paper);\n        return this;\n    };\n    /*\\\n     * Element.insertBefore\n     [ method ]\n     **\n     * Inserts current object before the given one.\n     = (object) @Element\n    \\*/\n    elproto.insertBefore = function (element) {\n        if (this.removed || !element) {\n            return this;\n        }\n\n        var node = getRealNode(this.node);\n        var beforeNode = getRealNode(element.node || element[0].node);\n        beforeNode.parentNode.insertBefore(node, beforeNode);\n        R._insertbefore(this, element, this.paper);\n        return this;\n    };\n    elproto.blur = function (size) {\n        // Experimental. No Safari support. Use it on your own risk.\n        var t = this;\n        if (+size !== 0) {\n            var fltr = $("filter"),\n                blur = $("feGaussianBlur");\n            t.attrs.blur = size;\n            fltr.id = R.createUUID();\n            $(blur, {stdDeviation: +size || 1.5});\n            fltr.appendChild(blur);\n            t.paper.defs.appendChild(fltr);\n            t._blur = fltr;\n            $(t.node, {filter: "url(#" + fltr.id + ")"});\n        } else {\n            if (t._blur) {\n                t._blur.parentNode.removeChild(t._blur);\n                delete t._blur;\n                delete t.attrs.blur;\n            }\n            t.node.removeAttribute("filter");\n        }\n        return t;\n    };\n    R._engine.circle = function (svg, x, y, r) {\n        var el = $("circle");\n        svg.canvas && svg.canvas.appendChild(el);\n        var res = new Element(el, svg);\n        res.attrs = {cx: x, cy: y, r: r, fill: "none", stroke: "#000"};\n        res.type = "circle";\n        $(el, res.attrs);\n        return res;\n    };\n    R._engine.rect = function (svg, x, y, w, h, r) {\n        var el = $("rect");\n        svg.canvas && svg.canvas.appendChild(el);\n        var res = new Element(el, svg);\n        res.attrs = {x: x, y: y, width: w, height: h, rx: r || 0, ry: r || 0, fill: "none", stroke: "#000"};\n        res.type = "rect";\n        $(el, res.attrs);\n        return res;\n    };\n    R._engine.ellipse = function (svg, x, y, rx, ry) {\n        var el = $("ellipse");\n        svg.canvas && svg.canvas.appendChild(el);\n        var res = new Element(el, svg);\n        res.attrs = {cx: x, cy: y, rx: rx, ry: ry, fill: "none", stroke: "#000"};\n        res.type = "ellipse";\n        $(el, res.attrs);\n        return res;\n    };\n    R._engine.image = function (svg, src, x, y, w, h) {\n        var el = $("image");\n        $(el, {x: x, y: y, width: w, height: h, preserveAspectRatio: "none"});\n        el.setAttributeNS(xlink, "href", src);\n        svg.canvas && svg.canvas.appendChild(el);\n        var res = new Element(el, svg);\n        res.attrs = {x: x, y: y, width: w, height: h, src: src};\n        res.type = "image";\n        return res;\n    };\n    R._engine.text = function (svg, x, y, text) {\n        var el = $("text");\n        svg.canvas && svg.canvas.appendChild(el);\n        var res = new Element(el, svg);\n        res.attrs = {\n            x: x,\n            y: y,\n            "text-anchor": "middle",\n            text: text,\n            "font-family": R._availableAttrs["font-family"],\n            "font-size": R._availableAttrs["font-size"],\n            stroke: "none",\n            fill: "#000"\n        };\n        res.type = "text";\n        setFillAndStroke(res, res.attrs);\n        return res;\n    };\n    R._engine.setSize = function (width, height) {\n        this.width = width || this.width;\n        this.height = height || this.height;\n        this.canvas.setAttribute("width", this.width);\n        this.canvas.setAttribute("height", this.height);\n        if (this._viewBox) {\n            this.setViewBox.apply(this, this._viewBox);\n        }\n        return this;\n    };\n    R._engine.create = function () {\n        var con = R._getContainer.apply(0, arguments),\n            container = con && con.container;\n        if (!container) {\n            throw new Error("SVG container not found.");\n        }\n        var x = con.x,\n            y = con.y,\n            width = con.width,\n            height = con.height,\n            cnvs = $("svg"),\n            css = "overflow:hidden;",\n            isFloating;\n        x = x || 0;\n        y = y || 0;\n        width = width || 512;\n        height = height || 342;\n        $(cnvs, {\n            height: height,\n            version: 1.1,\n            width: width,\n            xmlns: "http://www.w3.org/2000/svg",\n            "xmlns:xlink": "http://www.w3.org/1999/xlink"\n        });\n        if (container == 1) {\n            cnvs.style.cssText = css + "position:absolute;left:" + x + "px;top:" + y + "px";\n            R._g.doc.body.appendChild(cnvs);\n            isFloating = 1;\n        } else {\n            cnvs.style.cssText = css + "position:relative";\n            if (container.firstChild) {\n                container.insertBefore(cnvs, container.firstChild);\n            } else {\n                container.appendChild(cnvs);\n            }\n        }\n        container = new R._Paper;\n        container.width = width;\n        container.height = height;\n        container.canvas = cnvs;\n        container.clear();\n        container._left = container._top = 0;\n        isFloating && (container.renderfix = function () {});\n        container.renderfix();\n        return container;\n    };\n    R._engine.setViewBox = function (x, y, w, h, fit) {\n        eve("raphael.setViewBox", this, this._viewBox, [x, y, w, h, fit]);\n        var paperSize = this.getSize(),\n            size = mmax(w / paperSize.width, h / paperSize.height),\n            top = this.top,\n            aspectRatio = fit ? "xMidYMid meet" : "xMinYMin",\n            vb,\n            sw;\n        if (x == null) {\n            if (this._vbSize) {\n                size = 1;\n            }\n            delete this._vbSize;\n            vb = "0 0 " + this.width + S + this.height;\n        } else {\n            this._vbSize = size;\n            vb = x + S + y + S + w + S + h;\n        }\n        $(this.canvas, {\n            viewBox: vb,\n            preserveAspectRatio: aspectRatio\n        });\n        while (size && top) {\n            sw = "stroke-width" in top.attrs ? top.attrs["stroke-width"] : 1;\n            top.attr({"stroke-width": sw});\n            top._.dirty = 1;\n            top._.dirtyT = 1;\n            top = top.prev;\n        }\n        this._viewBox = [x, y, w, h, !!fit];\n        return this;\n    };\n    /*\\\n     * Paper.renderfix\n     [ method ]\n     **\n     * Fixes the issue of Firefox and IE9 regarding subpixel rendering. If paper is dependent\n     * on other elements after reflow it could shift half pixel which cause for lines to lost their crispness.\n     * This method fixes the issue.\n     **\n       Special thanks to Mariusz Nowak (http://www.medikoo.com/) for this method.\n    \\*/\n    R.prototype.renderfix = function () {\n        var cnvs = this.canvas,\n            s = cnvs.style,\n            pos;\n        try {\n            pos = cnvs.getScreenCTM() || cnvs.createSVGMatrix();\n        } catch (e) {\n            pos = cnvs.createSVGMatrix();\n        }\n        var left = -pos.e % 1,\n            top = -pos.f % 1;\n        if (left || top) {\n            if (left) {\n                this._left = (this._left + left) % 1;\n                s.left = this._left + "px";\n            }\n            if (top) {\n                this._top = (this._top + top) % 1;\n                s.top = this._top + "px";\n            }\n        }\n    };\n    /*\\\n     * Paper.clear\n     [ method ]\n     **\n     * Clears the paper, i.e. removes all the elements.\n    \\*/\n    R.prototype.clear = function () {\n        R.eve("raphael.clear", this);\n        var c = this.canvas;\n        while (c.firstChild) {\n            c.removeChild(c.firstChild);\n        }\n        this.bottom = this.top = null;\n        (this.desc = $("desc")).appendChild(R._g.doc.createTextNode("Created with Rapha\\xebl " + R.version));\n        c.appendChild(this.desc);\n        c.appendChild(this.defs = $("defs"));\n    };\n    /*\\\n     * Paper.remove\n     [ method ]\n     **\n     * Removes the paper from the DOM.\n    \\*/\n    R.prototype.remove = function () {\n        eve("raphael.remove", this);\n        this.canvas.parentNode && this.canvas.parentNode.removeChild(this.canvas);\n        for (var i in this) {\n            this[i] = typeof this[i] == "function" ? R._removedFactory(i) : null;\n        }\n    };\n    var setproto = R.st;\n    for (var method in elproto) if (elproto[has](method) && !setproto[has](method)) {\n        setproto[method] = (function (methodname) {\n            return function () {\n                var arg = arguments;\n                return this.forEach(function (el) {\n                    el[methodname].apply(el, arg);\n                });\n            };\n        })(method);\n    }\n}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9kZXYvcmFwaGFlbC5zdmcuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9SYXBoYWVsLy4vZGV2L3JhcGhhZWwuc3ZnLmpzP2Q4YzciXSwic291cmNlc0NvbnRlbnQiOlsiZGVmaW5lKFtcIi4vcmFwaGFlbC5jb3JlXCJdLCBmdW5jdGlvbihSKSB7XG4gICAgaWYgKFIgJiYgIVIuc3ZnKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgaGFzID0gXCJoYXNPd25Qcm9wZXJ0eVwiLFxuICAgICAgICBTdHIgPSBTdHJpbmcsXG4gICAgICAgIHRvRmxvYXQgPSBwYXJzZUZsb2F0LFxuICAgICAgICB0b0ludCA9IHBhcnNlSW50LFxuICAgICAgICBtYXRoID0gTWF0aCxcbiAgICAgICAgbW1heCA9IG1hdGgubWF4LFxuICAgICAgICBhYnMgPSBtYXRoLmFicyxcbiAgICAgICAgcG93ID0gbWF0aC5wb3csXG4gICAgICAgIHNlcGFyYXRvciA9IC9bLCBdKy8sXG4gICAgICAgIGV2ZSA9IFIuZXZlLFxuICAgICAgICBFID0gXCJcIixcbiAgICAgICAgUyA9IFwiIFwiO1xuICAgIHZhciB4bGluayA9IFwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGlua1wiLFxuICAgICAgICBtYXJrZXJzID0ge1xuICAgICAgICAgICAgYmxvY2s6IFwiTTUsMCAwLDIuNSA1LDV6XCIsXG4gICAgICAgICAgICBjbGFzc2ljOiBcIk01LDAgMCwyLjUgNSw1IDMuNSwzIDMuNSwyelwiLFxuICAgICAgICAgICAgZGlhbW9uZDogXCJNMi41LDAgNSwyLjUgMi41LDUgMCwyLjV6XCIsXG4gICAgICAgICAgICBvcGVuOiBcIk02LDEgMSwzLjUgNiw2XCIsXG4gICAgICAgICAgICBvdmFsOiBcIk0yLjUsMEEyLjUsMi41LDAsMCwxLDIuNSw1IDIuNSwyLjUsMCwwLDEsMi41LDB6XCJcbiAgICAgICAgfSxcbiAgICAgICAgbWFya2VyQ291bnRlciA9IHt9O1xuICAgIFIudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAgXCJZb3VyIGJyb3dzZXIgc3VwcG9ydHMgU1ZHLlxcbllvdSBhcmUgcnVubmluZyBSYXBoYVxceGVibCBcIiArIHRoaXMudmVyc2lvbjtcbiAgICB9O1xuICAgIHZhciAkID0gZnVuY3Rpb24gKGVsLCBhdHRyKSB7XG4gICAgICAgIGlmIChhdHRyKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGVsID09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICBlbCA9ICQoZWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIGF0dHIpIGlmIChhdHRyW2hhc10oa2V5KSkge1xuICAgICAgICAgICAgICAgIGlmIChrZXkuc3Vic3RyaW5nKDAsIDYpID09IFwieGxpbms6XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgZWwuc2V0QXR0cmlidXRlTlMoeGxpbmssIGtleS5zdWJzdHJpbmcoNiksIFN0cihhdHRyW2tleV0pKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBlbC5zZXRBdHRyaWJ1dGUoa2V5LCBTdHIoYXR0cltrZXldKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZWwgPSBSLl9nLmRvYy5jcmVhdGVFbGVtZW50TlMoXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiLCBlbCk7XG4gICAgICAgICAgICBlbC5zdHlsZSAmJiAoZWwuc3R5bGUud2Via2l0VGFwSGlnaGxpZ2h0Q29sb3IgPSBcInJnYmEoMCwwLDAsMClcIik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGVsO1xuICAgIH0sXG4gICAgYWRkR3JhZGllbnRGaWxsID0gZnVuY3Rpb24gKGVsZW1lbnQsIGdyYWRpZW50KSB7XG4gICAgICAgIHZhciB0eXBlID0gXCJsaW5lYXJcIixcbiAgICAgICAgICAgIGlkID0gZWxlbWVudC5pZCArIGdyYWRpZW50LFxuICAgICAgICAgICAgZnggPSAuNSwgZnkgPSAuNSxcbiAgICAgICAgICAgIG8gPSBlbGVtZW50Lm5vZGUsXG4gICAgICAgICAgICBTVkcgPSBlbGVtZW50LnBhcGVyLFxuICAgICAgICAgICAgcyA9IG8uc3R5bGUsXG4gICAgICAgICAgICBlbCA9IFIuX2cuZG9jLmdldEVsZW1lbnRCeUlkKGlkKTtcbiAgICAgICAgaWYgKCFlbCkge1xuICAgICAgICAgICAgZ3JhZGllbnQgPSBTdHIoZ3JhZGllbnQpLnJlcGxhY2UoUi5fcmFkaWFsX2dyYWRpZW50LCBmdW5jdGlvbiAoYWxsLCBfZngsIF9meSkge1xuICAgICAgICAgICAgICAgIHR5cGUgPSBcInJhZGlhbFwiO1xuICAgICAgICAgICAgICAgIGlmIChfZnggJiYgX2Z5KSB7XG4gICAgICAgICAgICAgICAgICAgIGZ4ID0gdG9GbG9hdChfZngpO1xuICAgICAgICAgICAgICAgICAgICBmeSA9IHRvRmxvYXQoX2Z5KTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRpciA9ICgoZnkgPiAuNSkgKiAyIC0gMSk7XG4gICAgICAgICAgICAgICAgICAgIHBvdyhmeCAtIC41LCAyKSArIHBvdyhmeSAtIC41LCAyKSA+IC4yNSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgKGZ5ID0gbWF0aC5zcXJ0KC4yNSAtIHBvdyhmeCAtIC41LCAyKSkgKiBkaXIgKyAuNSkgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ5ICE9IC41ICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAoZnkgPSBmeS50b0ZpeGVkKDUpIC0gMWUtNSAqIGRpcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBFO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBncmFkaWVudCA9IGdyYWRpZW50LnNwbGl0KC9cXHMqXFwtXFxzKi8pO1xuICAgICAgICAgICAgaWYgKHR5cGUgPT0gXCJsaW5lYXJcIikge1xuICAgICAgICAgICAgICAgIHZhciBhbmdsZSA9IGdyYWRpZW50LnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgYW5nbGUgPSAtdG9GbG9hdChhbmdsZSk7XG4gICAgICAgICAgICAgICAgaWYgKGlzTmFOKGFuZ2xlKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHZlY3RvciA9IFswLCAwLCBtYXRoLmNvcyhSLnJhZChhbmdsZSkpLCBtYXRoLnNpbihSLnJhZChhbmdsZSkpXSxcbiAgICAgICAgICAgICAgICAgICAgbWF4ID0gMSAvIChtbWF4KGFicyh2ZWN0b3JbMl0pLCBhYnModmVjdG9yWzNdKSkgfHwgMSk7XG4gICAgICAgICAgICAgICAgdmVjdG9yWzJdICo9IG1heDtcbiAgICAgICAgICAgICAgICB2ZWN0b3JbM10gKj0gbWF4O1xuICAgICAgICAgICAgICAgIGlmICh2ZWN0b3JbMl0gPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHZlY3RvclswXSA9IC12ZWN0b3JbMl07XG4gICAgICAgICAgICAgICAgICAgIHZlY3RvclsyXSA9IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh2ZWN0b3JbM10gPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHZlY3RvclsxXSA9IC12ZWN0b3JbM107XG4gICAgICAgICAgICAgICAgICAgIHZlY3RvclszXSA9IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGRvdHMgPSBSLl9wYXJzZURvdHMoZ3JhZGllbnQpO1xuICAgICAgICAgICAgaWYgKCFkb3RzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZCA9IGlkLnJlcGxhY2UoL1tcXChcXClcXHMsXFx4YjAjXS9nLCBcIl9cIik7XG5cbiAgICAgICAgICAgIGlmIChlbGVtZW50LmdyYWRpZW50ICYmIGlkICE9IGVsZW1lbnQuZ3JhZGllbnQuaWQpIHtcbiAgICAgICAgICAgICAgICBTVkcuZGVmcy5yZW1vdmVDaGlsZChlbGVtZW50LmdyYWRpZW50KTtcbiAgICAgICAgICAgICAgICBkZWxldGUgZWxlbWVudC5ncmFkaWVudDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCFlbGVtZW50LmdyYWRpZW50KSB7XG4gICAgICAgICAgICAgICAgZWwgPSAkKHR5cGUgKyBcIkdyYWRpZW50XCIsIHtpZDogaWR9KTtcbiAgICAgICAgICAgICAgICBlbGVtZW50LmdyYWRpZW50ID0gZWw7XG4gICAgICAgICAgICAgICAgJChlbCwgdHlwZSA9PSBcInJhZGlhbFwiID8ge1xuICAgICAgICAgICAgICAgICAgICBmeDogZngsXG4gICAgICAgICAgICAgICAgICAgIGZ5OiBmeVxuICAgICAgICAgICAgICAgIH0gOiB7XG4gICAgICAgICAgICAgICAgICAgIHgxOiB2ZWN0b3JbMF0sXG4gICAgICAgICAgICAgICAgICAgIHkxOiB2ZWN0b3JbMV0sXG4gICAgICAgICAgICAgICAgICAgIHgyOiB2ZWN0b3JbMl0sXG4gICAgICAgICAgICAgICAgICAgIHkyOiB2ZWN0b3JbM10sXG4gICAgICAgICAgICAgICAgICAgIGdyYWRpZW50VHJhbnNmb3JtOiBlbGVtZW50Lm1hdHJpeC5pbnZlcnQoKVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIFNWRy5kZWZzLmFwcGVuZENoaWxkKGVsKTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBkb3RzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgZWwuYXBwZW5kQ2hpbGQoJChcInN0b3BcIiwge1xuICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0OiBkb3RzW2ldLm9mZnNldCA/IGRvdHNbaV0ub2Zmc2V0IDogaSA/IFwiMTAwJVwiIDogXCIwJVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzdG9wLWNvbG9yXCI6IGRvdHNbaV0uY29sb3IgfHwgXCIjZmZmXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInN0b3Atb3BhY2l0eVwiOiBpc0Zpbml0ZShkb3RzW2ldLm9wYWNpdHkpID8gZG90c1tpXS5vcGFjaXR5IDogMVxuICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgICQobywge1xuICAgICAgICAgICAgZmlsbDogZmlsbHVybChpZCksXG4gICAgICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICAgICAgXCJmaWxsLW9wYWNpdHlcIjogMVxuICAgICAgICB9KTtcbiAgICAgICAgcy5maWxsID0gRTtcbiAgICAgICAgcy5vcGFjaXR5ID0gMTtcbiAgICAgICAgcy5maWxsT3BhY2l0eSA9IDE7XG4gICAgICAgIHJldHVybiAxO1xuICAgIH0sXG4gICAgaXNJRTlvcjEwID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIG1vZGUgPSBkb2N1bWVudC5kb2N1bWVudE1vZGU7XG4gICAgICByZXR1cm4gbW9kZSAmJiAobW9kZSA9PT0gOSB8fCBtb2RlID09PSAxMCk7XG4gICAgfSxcbiAgICBmaWxsdXJsID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICBpZiAoaXNJRTlvcjEwKCkpIHtcbiAgICAgICAgICByZXR1cm4gXCJ1cmwoJyNcIiArIGlkICsgXCInKVwiO1xuICAgICAgfVxuICAgICAgdmFyIGxvY2F0aW9uID0gZG9jdW1lbnQubG9jYXRpb247XG4gICAgICB2YXIgbG9jYXRpb25TdHJpbmcgPSAoXG4gICAgICAgICAgbG9jYXRpb24ucHJvdG9jb2wgKyAnLy8nICtcbiAgICAgICAgICBsb2NhdGlvbi5ob3N0ICtcbiAgICAgICAgICBsb2NhdGlvbi5wYXRobmFtZSArXG4gICAgICAgICAgbG9jYXRpb24uc2VhcmNoXG4gICAgICApO1xuICAgICAgcmV0dXJuIFwidXJsKCdcIiArIGxvY2F0aW9uU3RyaW5nICsgXCIjXCIgKyBpZCArIFwiJylcIjtcbiAgICB9LFxuICAgIHVwZGF0ZVBvc2l0aW9uID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgICAgdmFyIGJib3ggPSBvLmdldEJCb3goMSk7XG4gICAgICAgICQoby5wYXR0ZXJuLCB7cGF0dGVyblRyYW5zZm9ybTogby5tYXRyaXguaW52ZXJ0KCkgKyBcIiB0cmFuc2xhdGUoXCIgKyBiYm94LnggKyBcIixcIiArIGJib3gueSArIFwiKVwifSk7XG4gICAgfSxcbiAgICBhZGRBcnJvdyA9IGZ1bmN0aW9uIChvLCB2YWx1ZSwgaXNFbmQpIHtcbiAgICAgICAgaWYgKG8udHlwZSA9PSBcInBhdGhcIikge1xuICAgICAgICAgICAgdmFyIHZhbHVlcyA9IFN0cih2YWx1ZSkudG9Mb3dlckNhc2UoKS5zcGxpdChcIi1cIiksXG4gICAgICAgICAgICAgICAgcCA9IG8ucGFwZXIsXG4gICAgICAgICAgICAgICAgc2UgPSBpc0VuZCA/IFwiZW5kXCIgOiBcInN0YXJ0XCIsXG4gICAgICAgICAgICAgICAgbm9kZSA9IG8ubm9kZSxcbiAgICAgICAgICAgICAgICBhdHRycyA9IG8uYXR0cnMsXG4gICAgICAgICAgICAgICAgc3Ryb2tlID0gYXR0cnNbXCJzdHJva2Utd2lkdGhcIl0sXG4gICAgICAgICAgICAgICAgaSA9IHZhbHVlcy5sZW5ndGgsXG4gICAgICAgICAgICAgICAgdHlwZSA9IFwiY2xhc3NpY1wiLFxuICAgICAgICAgICAgICAgIGZyb20sXG4gICAgICAgICAgICAgICAgdG8sXG4gICAgICAgICAgICAgICAgZHgsXG4gICAgICAgICAgICAgICAgcmVmWCxcbiAgICAgICAgICAgICAgICBhdHRyLFxuICAgICAgICAgICAgICAgIHcgPSAzLFxuICAgICAgICAgICAgICAgIGggPSAzLFxuICAgICAgICAgICAgICAgIHQgPSA1O1xuICAgICAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAodmFsdWVzW2ldKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJibG9ja1wiOlxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiY2xhc3NpY1wiOlxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwib3ZhbFwiOlxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZGlhbW9uZFwiOlxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwib3BlblwiOlxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwibm9uZVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9IHZhbHVlc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwid2lkZVwiOiBoID0gNTsgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJuYXJyb3dcIjogaCA9IDI7IGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwibG9uZ1wiOiB3ID0gNTsgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJzaG9ydFwiOiB3ID0gMjsgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGUgPT0gXCJvcGVuXCIpIHtcbiAgICAgICAgICAgICAgICB3ICs9IDI7XG4gICAgICAgICAgICAgICAgaCArPSAyO1xuICAgICAgICAgICAgICAgIHQgKz0gMjtcbiAgICAgICAgICAgICAgICBkeCA9IDE7XG4gICAgICAgICAgICAgICAgcmVmWCA9IGlzRW5kID8gNCA6IDE7XG4gICAgICAgICAgICAgICAgYXR0ciA9IHtcbiAgICAgICAgICAgICAgICAgICAgZmlsbDogXCJub25lXCIsXG4gICAgICAgICAgICAgICAgICAgIHN0cm9rZTogYXR0cnMuc3Ryb2tlXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVmWCA9IGR4ID0gdyAvIDI7XG4gICAgICAgICAgICAgICAgYXR0ciA9IHtcbiAgICAgICAgICAgICAgICAgICAgZmlsbDogYXR0cnMuc3Ryb2tlLFxuICAgICAgICAgICAgICAgICAgICBzdHJva2U6IFwibm9uZVwiXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvLl8uYXJyb3dzKSB7XG4gICAgICAgICAgICAgICAgaWYgKGlzRW5kKSB7XG4gICAgICAgICAgICAgICAgICAgIG8uXy5hcnJvd3MuZW5kUGF0aCAmJiBtYXJrZXJDb3VudGVyW28uXy5hcnJvd3MuZW5kUGF0aF0tLTtcbiAgICAgICAgICAgICAgICAgICAgby5fLmFycm93cy5lbmRNYXJrZXIgJiYgbWFya2VyQ291bnRlcltvLl8uYXJyb3dzLmVuZE1hcmtlcl0tLTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBvLl8uYXJyb3dzLnN0YXJ0UGF0aCAmJiBtYXJrZXJDb3VudGVyW28uXy5hcnJvd3Muc3RhcnRQYXRoXS0tO1xuICAgICAgICAgICAgICAgICAgICBvLl8uYXJyb3dzLnN0YXJ0TWFya2VyICYmIG1hcmtlckNvdW50ZXJbby5fLmFycm93cy5zdGFydE1hcmtlcl0tLTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG8uXy5hcnJvd3MgPSB7fTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0eXBlICE9IFwibm9uZVwiKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBhdGhJZCA9IFwicmFwaGFlbC1tYXJrZXItXCIgKyB0eXBlLFxuICAgICAgICAgICAgICAgICAgICBtYXJrZXJJZCA9IFwicmFwaGFlbC1tYXJrZXItXCIgKyBzZSArIHR5cGUgKyB3ICsgaCArIFwiLW9ialwiICsgby5pZDtcbiAgICAgICAgICAgICAgICBpZiAoIVIuX2cuZG9jLmdldEVsZW1lbnRCeUlkKHBhdGhJZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcC5kZWZzLmFwcGVuZENoaWxkKCQoJChcInBhdGhcIiksIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3Ryb2tlLWxpbmVjYXBcIjogXCJyb3VuZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgZDogbWFya2Vyc1t0eXBlXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBwYXRoSWRcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgICAgICBtYXJrZXJDb3VudGVyW3BhdGhJZF0gPSAxO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG1hcmtlckNvdW50ZXJbcGF0aElkXSsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgbWFya2VyID0gUi5fZy5kb2MuZ2V0RWxlbWVudEJ5SWQobWFya2VySWQpLFxuICAgICAgICAgICAgICAgICAgICB1c2U7XG4gICAgICAgICAgICAgICAgaWYgKCFtYXJrZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgbWFya2VyID0gJCgkKFwibWFya2VyXCIpLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogbWFya2VySWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXJIZWlnaHQ6IGgsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXJXaWR0aDogdyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yaWVudDogXCJhdXRvXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICByZWZYOiByZWZYLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVmWTogaCAvIDJcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHVzZSA9ICQoJChcInVzZVwiKSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJ4bGluazpocmVmXCI6IFwiI1wiICsgcGF0aElkLFxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNmb3JtOiAoaXNFbmQgPyBcInJvdGF0ZSgxODAgXCIgKyB3IC8gMiArIFwiIFwiICsgaCAvIDIgKyBcIikgXCIgOiBFKSArIFwic2NhbGUoXCIgKyB3IC8gdCArIFwiLFwiICsgaCAvIHQgKyBcIilcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3Ryb2tlLXdpZHRoXCI6ICgxIC8gKCh3IC8gdCArIGggLyB0KSAvIDIpKS50b0ZpeGVkKDQpXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBtYXJrZXIuYXBwZW5kQ2hpbGQodXNlKTtcbiAgICAgICAgICAgICAgICAgICAgcC5kZWZzLmFwcGVuZENoaWxkKG1hcmtlcik7XG4gICAgICAgICAgICAgICAgICAgIG1hcmtlckNvdW50ZXJbbWFya2VySWRdID0gMTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBtYXJrZXJDb3VudGVyW21hcmtlcklkXSsrO1xuICAgICAgICAgICAgICAgICAgICB1c2UgPSBtYXJrZXIuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJ1c2VcIilbMF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICQodXNlLCBhdHRyKTtcbiAgICAgICAgICAgICAgICB2YXIgZGVsdGEgPSBkeCAqICh0eXBlICE9IFwiZGlhbW9uZFwiICYmIHR5cGUgIT0gXCJvdmFsXCIpO1xuICAgICAgICAgICAgICAgIGlmIChpc0VuZCkge1xuICAgICAgICAgICAgICAgICAgICBmcm9tID0gby5fLmFycm93cy5zdGFydGR4ICogc3Ryb2tlIHx8IDA7XG4gICAgICAgICAgICAgICAgICAgIHRvID0gUi5nZXRUb3RhbExlbmd0aChhdHRycy5wYXRoKSAtIGRlbHRhICogc3Ryb2tlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGZyb20gPSBkZWx0YSAqIHN0cm9rZTtcbiAgICAgICAgICAgICAgICAgICAgdG8gPSBSLmdldFRvdGFsTGVuZ3RoKGF0dHJzLnBhdGgpIC0gKG8uXy5hcnJvd3MuZW5kZHggKiBzdHJva2UgfHwgMCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGF0dHIgPSB7fTtcbiAgICAgICAgICAgICAgICBhdHRyW1wibWFya2VyLVwiICsgc2VdID0gXCJ1cmwoI1wiICsgbWFya2VySWQgKyBcIilcIjtcbiAgICAgICAgICAgICAgICBpZiAodG8gfHwgZnJvbSkge1xuICAgICAgICAgICAgICAgICAgICBhdHRyLmQgPSBSLmdldFN1YnBhdGgoYXR0cnMucGF0aCwgZnJvbSwgdG8pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkKG5vZGUsIGF0dHIpO1xuICAgICAgICAgICAgICAgIG8uXy5hcnJvd3Nbc2UgKyBcIlBhdGhcIl0gPSBwYXRoSWQ7XG4gICAgICAgICAgICAgICAgby5fLmFycm93c1tzZSArIFwiTWFya2VyXCJdID0gbWFya2VySWQ7XG4gICAgICAgICAgICAgICAgby5fLmFycm93c1tzZSArIFwiZHhcIl0gPSBkZWx0YTtcbiAgICAgICAgICAgICAgICBvLl8uYXJyb3dzW3NlICsgXCJUeXBlXCJdID0gdHlwZTtcbiAgICAgICAgICAgICAgICBvLl8uYXJyb3dzW3NlICsgXCJTdHJpbmdcIl0gPSB2YWx1ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGlzRW5kKSB7XG4gICAgICAgICAgICAgICAgICAgIGZyb20gPSBvLl8uYXJyb3dzLnN0YXJ0ZHggKiBzdHJva2UgfHwgMDtcbiAgICAgICAgICAgICAgICAgICAgdG8gPSBSLmdldFRvdGFsTGVuZ3RoKGF0dHJzLnBhdGgpIC0gZnJvbTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBmcm9tID0gMDtcbiAgICAgICAgICAgICAgICAgICAgdG8gPSBSLmdldFRvdGFsTGVuZ3RoKGF0dHJzLnBhdGgpIC0gKG8uXy5hcnJvd3MuZW5kZHggKiBzdHJva2UgfHwgMCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG8uXy5hcnJvd3Nbc2UgKyBcIlBhdGhcIl0gJiYgJChub2RlLCB7ZDogUi5nZXRTdWJwYXRoKGF0dHJzLnBhdGgsIGZyb20sIHRvKX0pO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBvLl8uYXJyb3dzW3NlICsgXCJQYXRoXCJdO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBvLl8uYXJyb3dzW3NlICsgXCJNYXJrZXJcIl07XG4gICAgICAgICAgICAgICAgZGVsZXRlIG8uXy5hcnJvd3Nbc2UgKyBcImR4XCJdO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBvLl8uYXJyb3dzW3NlICsgXCJUeXBlXCJdO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBvLl8uYXJyb3dzW3NlICsgXCJTdHJpbmdcIl07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGF0dHIgaW4gbWFya2VyQ291bnRlcikgaWYgKG1hcmtlckNvdW50ZXJbaGFzXShhdHRyKSAmJiAhbWFya2VyQ291bnRlclthdHRyXSkge1xuICAgICAgICAgICAgICAgIHZhciBpdGVtID0gUi5fZy5kb2MuZ2V0RWxlbWVudEJ5SWQoYXR0cik7XG4gICAgICAgICAgICAgICAgaXRlbSAmJiBpdGVtLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoaXRlbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuICAgIGRhc2hhcnJheSA9IHtcbiAgICAgICAgXCItXCI6IFszLCAxXSxcbiAgICAgICAgXCIuXCI6IFsxLCAxXSxcbiAgICAgICAgXCItLlwiOiBbMywgMSwgMSwgMV0sXG4gICAgICAgIFwiLS4uXCI6IFszLCAxLCAxLCAxLCAxLCAxXSxcbiAgICAgICAgXCIuIFwiOiBbMSwgM10sXG4gICAgICAgIFwiLSBcIjogWzQsIDNdLFxuICAgICAgICBcIi0tXCI6IFs4LCAzXSxcbiAgICAgICAgXCItIC5cIjogWzQsIDMsIDEsIDNdLFxuICAgICAgICBcIi0tLlwiOiBbOCwgMywgMSwgM10sXG4gICAgICAgIFwiLS0uLlwiOiBbOCwgMywgMSwgMywgMSwgM11cbiAgICB9LFxuICAgIGFkZERhc2hlcyA9IGZ1bmN0aW9uIChvLCB2YWx1ZSwgcGFyYW1zKSB7XG4gICAgICAgIHZhbHVlID0gZGFzaGFycmF5W1N0cih2YWx1ZSkudG9Mb3dlckNhc2UoKV07XG4gICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgdmFyIHdpZHRoID0gby5hdHRyc1tcInN0cm9rZS13aWR0aFwiXSB8fCBcIjFcIixcbiAgICAgICAgICAgICAgICBidXR0ID0ge3JvdW5kOiB3aWR0aCwgc3F1YXJlOiB3aWR0aCwgYnV0dDogMH1bby5hdHRyc1tcInN0cm9rZS1saW5lY2FwXCJdIHx8IHBhcmFtc1tcInN0cm9rZS1saW5lY2FwXCJdXSB8fCAwLFxuICAgICAgICAgICAgICAgIGRhc2hlcyA9IFtdLFxuICAgICAgICAgICAgICAgIGkgPSB2YWx1ZS5sZW5ndGg7XG4gICAgICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgICAgICAgZGFzaGVzW2ldID0gdmFsdWVbaV0gKiB3aWR0aCArICgoaSAlIDIpID8gMSA6IC0xKSAqIGJ1dHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkKG8ubm9kZSwge1wic3Ryb2tlLWRhc2hhcnJheVwiOiBkYXNoZXMuam9pbihcIixcIil9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAkKG8ubm9kZSwge1wic3Ryb2tlLWRhc2hhcnJheVwiOiBcIm5vbmVcIn0pO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBzZXRGaWxsQW5kU3Ryb2tlID0gZnVuY3Rpb24gKG8sIHBhcmFtcykge1xuICAgICAgICB2YXIgbm9kZSA9IG8ubm9kZSxcbiAgICAgICAgICAgIGF0dHJzID0gby5hdHRycyxcbiAgICAgICAgICAgIHZpcyA9IG5vZGUuc3R5bGUudmlzaWJpbGl0eTtcbiAgICAgICAgbm9kZS5zdHlsZS52aXNpYmlsaXR5ID0gXCJoaWRkZW5cIjtcbiAgICAgICAgZm9yICh2YXIgYXR0IGluIHBhcmFtcykge1xuICAgICAgICAgICAgaWYgKHBhcmFtc1toYXNdKGF0dCkpIHtcbiAgICAgICAgICAgICAgICBpZiAoIVIuX2F2YWlsYWJsZUF0dHJzW2hhc10oYXR0KSkge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gcGFyYW1zW2F0dF07XG4gICAgICAgICAgICAgICAgYXR0cnNbYXR0XSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoYXR0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJibHVyXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICBvLmJsdXIodmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJ0aXRsZVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRpdGxlID0gbm9kZS5nZXRFbGVtZW50c0J5VGFnTmFtZShcInRpdGxlXCIpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBVc2UgdGhlIGV4aXN0aW5nIDx0aXRsZT4uXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGl0bGUubGVuZ3RoICYmICh0aXRsZSA9IHRpdGxlWzBdKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZS5maXJzdENoaWxkLm5vZGVWYWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGUgPSAkKFwidGl0bGVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWwgPSBSLl9nLmRvYy5jcmVhdGVUZXh0Tm9kZSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlLmFwcGVuZENoaWxkKHZhbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuYXBwZW5kQ2hpbGQodGl0bGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJocmVmXCI6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJ0YXJnZXRcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwbiA9IG5vZGUucGFyZW50Tm9kZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwbi50YWdOYW1lLnRvTG93ZXJDYXNlKCkgIT0gXCJhXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGwgPSAkKFwiYVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbi5pbnNlcnRCZWZvcmUoaGwsIG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhsLmFwcGVuZENoaWxkKG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBuID0gaGw7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXR0ID09IFwidGFyZ2V0XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbi5zZXRBdHRyaWJ1dGVOUyh4bGluaywgXCJzaG93XCIsIHZhbHVlID09IFwiYmxhbmtcIiA/IFwibmV3XCIgOiB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBuLnNldEF0dHJpYnV0ZU5TKHhsaW5rLCBhdHQsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiY3Vyc29yXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlLnN0eWxlLmN1cnNvciA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJ0cmFuc2Zvcm1cIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIG8udHJhbnNmb3JtKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiYXJyb3ctc3RhcnRcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZEFycm93KG8sIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiYXJyb3ctZW5kXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRBcnJvdyhvLCB2YWx1ZSwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImNsaXAtcmVjdFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlY3QgPSBTdHIodmFsdWUpLnNwbGl0KHNlcGFyYXRvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVjdC5sZW5ndGggPT0gNCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8uY2xpcCAmJiBvLmNsaXAucGFyZW50Tm9kZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG8uY2xpcC5wYXJlbnROb2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWwgPSAkKFwiY2xpcFBhdGhcIiksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJjID0gJChcInJlY3RcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWwuaWQgPSBSLmNyZWF0ZVVVSUQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKHJjLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHg6IHJlY3RbMF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHk6IHJlY3RbMV0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiByZWN0WzJdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IHJlY3RbM11cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbC5hcHBlbmRDaGlsZChyYyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgby5wYXBlci5kZWZzLmFwcGVuZENoaWxkKGVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKG5vZGUsIHtcImNsaXAtcGF0aFwiOiBcInVybCgjXCIgKyBlbC5pZCArIFwiKVwifSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgby5jbGlwID0gcmM7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhdGggPSBub2RlLmdldEF0dHJpYnV0ZShcImNsaXAtcGF0aFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGF0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2xpcCA9IFIuX2cuZG9jLmdldEVsZW1lbnRCeUlkKHBhdGgucmVwbGFjZSgvKF51cmxcXCgjfFxcKSQpL2csIEUpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpcCAmJiBjbGlwLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoY2xpcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQobm9kZSwge1wiY2xpcC1wYXRoXCI6IEV9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG8uY2xpcDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwicGF0aFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG8udHlwZSA9PSBcInBhdGhcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQobm9kZSwge2Q6IHZhbHVlID8gYXR0cnMucGF0aCA9IFIuX3BhdGhUb0Fic29sdXRlKHZhbHVlKSA6IFwiTTAsMFwifSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgby5fLmRpcnR5ID0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoby5fLmFycm93cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN0YXJ0U3RyaW5nXCIgaW4gby5fLmFycm93cyAmJiBhZGRBcnJvdyhvLCBvLl8uYXJyb3dzLnN0YXJ0U3RyaW5nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJlbmRTdHJpbmdcIiBpbiBvLl8uYXJyb3dzICYmIGFkZEFycm93KG8sIG8uXy5hcnJvd3MuZW5kU3RyaW5nLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIndpZHRoXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlLnNldEF0dHJpYnV0ZShhdHQsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG8uXy5kaXJ0eSA9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXR0cnMuZngpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHQgPSBcInhcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGF0dHJzLng7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwieFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJzLmZ4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSAtYXR0cnMueCAtIChhdHRycy53aWR0aCB8fCAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcInJ4XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXR0ID09IFwicnhcIiAmJiBvLnR5cGUgPT0gXCJyZWN0XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImN4XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlLnNldEF0dHJpYnV0ZShhdHQsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG8ucGF0dGVybiAmJiB1cGRhdGVQb3NpdGlvbihvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG8uXy5kaXJ0eSA9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImhlaWdodFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5zZXRBdHRyaWJ1dGUoYXR0LCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBvLl8uZGlydHkgPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJzLmZ5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0ID0gXCJ5XCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBhdHRycy55O1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcInlcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdHRycy5meSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gLWF0dHJzLnkgLSAoYXR0cnMuaGVpZ2h0IHx8IDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwicnlcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdHQgPT0gXCJyeVwiICYmIG8udHlwZSA9PSBcInJlY3RcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiY3lcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKGF0dCwgdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgby5wYXR0ZXJuICYmIHVwZGF0ZVBvc2l0aW9uKG8pO1xuICAgICAgICAgICAgICAgICAgICAgICAgby5fLmRpcnR5ID0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiclwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG8udHlwZSA9PSBcInJlY3RcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQobm9kZSwge3J4OiB2YWx1ZSwgcnk6IHZhbHVlfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKGF0dCwgdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgby5fLmRpcnR5ID0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwic3JjXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoby50eXBlID09IFwiaW1hZ2VcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuc2V0QXR0cmlidXRlTlMoeGxpbmssIFwiaHJlZlwiLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcInN0cm9rZS13aWR0aFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG8uXy5zeCAhPSAxIHx8IG8uXy5zeSAhPSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgLz0gbW1heChhYnMoby5fLnN4KSwgYWJzKG8uXy5zeSkpIHx8IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlLnNldEF0dHJpYnV0ZShhdHQsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdHRyc1tcInN0cm9rZS1kYXNoYXJyYXlcIl0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGREYXNoZXMobywgYXR0cnNbXCJzdHJva2UtZGFzaGFycmF5XCJdLCBwYXJhbXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG8uXy5hcnJvd3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN0YXJ0U3RyaW5nXCIgaW4gby5fLmFycm93cyAmJiBhZGRBcnJvdyhvLCBvLl8uYXJyb3dzLnN0YXJ0U3RyaW5nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImVuZFN0cmluZ1wiIGluIG8uXy5hcnJvd3MgJiYgYWRkQXJyb3cobywgby5fLmFycm93cy5lbmRTdHJpbmcsIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJzdHJva2UtZGFzaGFycmF5XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICBhZGREYXNoZXMobywgdmFsdWUsIHBhcmFtcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImZpbGxcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpc1VSTCA9IFN0cih2YWx1ZSkubWF0Y2goUi5fSVNVUkwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzVVJMKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWwgPSAkKFwicGF0dGVyblwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWcgPSAkKFwiaW1hZ2VcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWwuaWQgPSBSLmNyZWF0ZVVVSUQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKGVsLCB7eDogMCwgeTogMCwgcGF0dGVyblVuaXRzOiBcInVzZXJTcGFjZU9uVXNlXCIsIGhlaWdodDogMSwgd2lkdGg6IDF9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKGlnLCB7eDogMCwgeTogMCwgXCJ4bGluazpocmVmXCI6IGlzVVJMWzFdfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWwuYXBwZW5kQ2hpbGQoaWcpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKGZ1bmN0aW9uIChlbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSLl9wcmVsb2FkKGlzVVJMWzFdLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdyA9IHRoaXMub2Zmc2V0V2lkdGgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaCA9IHRoaXMub2Zmc2V0SGVpZ2h0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJChlbCwge3dpZHRoOiB3LCBoZWlnaHQ6IGh9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoaWcsIHt3aWR0aDogdywgaGVpZ2h0OiBofSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKGVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvLnBhcGVyLmRlZnMuYXBwZW5kQ2hpbGQoZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQobm9kZSwge2ZpbGw6IFwidXJsKCNcIiArIGVsLmlkICsgXCIpXCJ9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvLnBhdHRlcm4gPSBlbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvLnBhdHRlcm4gJiYgdXBkYXRlUG9zaXRpb24obyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2xyID0gUi5nZXRSR0IodmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFjbHIuZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgcGFyYW1zLmdyYWRpZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBhdHRycy5ncmFkaWVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhUi5pcyhhdHRycy5vcGFjaXR5LCBcInVuZGVmaW5lZFwiKSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSLmlzKHBhcmFtcy5vcGFjaXR5LCBcInVuZGVmaW5lZFwiKSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKG5vZGUsIHtvcGFjaXR5OiBhdHRycy5vcGFjaXR5fSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIVIuaXMoYXR0cnNbXCJmaWxsLW9wYWNpdHlcIl0sIFwidW5kZWZpbmVkXCIpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFIuaXMocGFyYW1zW1wiZmlsbC1vcGFjaXR5XCJdLCBcInVuZGVmaW5lZFwiKSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKG5vZGUsIHtcImZpbGwtb3BhY2l0eVwiOiBhdHRyc1tcImZpbGwtb3BhY2l0eVwiXX0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoby50eXBlID09IFwiY2lyY2xlXCIgfHwgby50eXBlID09IFwiZWxsaXBzZVwiIHx8IFN0cih2YWx1ZSkuY2hhckF0KCkgIT0gXCJyXCIpICYmIGFkZEdyYWRpZW50RmlsbChvLCB2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoXCJvcGFjaXR5XCIgaW4gYXR0cnMgfHwgXCJmaWxsLW9wYWNpdHlcIiBpbiBhdHRycykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ3JhZGllbnQgPSBSLl9nLmRvYy5nZXRFbGVtZW50QnlJZChub2RlLmdldEF0dHJpYnV0ZShcImZpbGxcIikucmVwbGFjZSgvXnVybFxcKCN8XFwpJC9nLCBFKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChncmFkaWVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0b3BzID0gZ3JhZGllbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzdG9wXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJChzdG9wc1tzdG9wcy5sZW5ndGggLSAxXSwge1wic3RvcC1vcGFjaXR5XCI6IChcIm9wYWNpdHlcIiBpbiBhdHRycyA/IGF0dHJzLm9wYWNpdHkgOiAxKSAqIChcImZpbGwtb3BhY2l0eVwiIGluIGF0dHJzID8gYXR0cnNbXCJmaWxsLW9wYWNpdHlcIl0gOiAxKX0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJzLmdyYWRpZW50ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cnMuZmlsbCA9IFwibm9uZVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2xyW2hhc10oXCJvcGFjaXR5XCIpICYmICQobm9kZSwge1wiZmlsbC1vcGFjaXR5XCI6IGNsci5vcGFjaXR5ID4gMSA/IGNsci5vcGFjaXR5IC8gMTAwIDogY2xyLm9wYWNpdHl9KTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcInN0cm9rZVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgY2xyID0gUi5nZXRSR0IodmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5zZXRBdHRyaWJ1dGUoYXR0LCBjbHIuaGV4KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0dCA9PSBcInN0cm9rZVwiICYmIGNscltoYXNdKFwib3BhY2l0eVwiKSAmJiAkKG5vZGUsIHtcInN0cm9rZS1vcGFjaXR5XCI6IGNsci5vcGFjaXR5ID4gMSA/IGNsci5vcGFjaXR5IC8gMTAwIDogY2xyLm9wYWNpdHl9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdHQgPT0gXCJzdHJva2VcIiAmJiBvLl8uYXJyb3dzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdGFydFN0cmluZ1wiIGluIG8uXy5hcnJvd3MgJiYgYWRkQXJyb3cobywgby5fLmFycm93cy5zdGFydFN0cmluZyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJlbmRTdHJpbmdcIiBpbiBvLl8uYXJyb3dzICYmIGFkZEFycm93KG8sIG8uXy5hcnJvd3MuZW5kU3RyaW5nLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZ3JhZGllbnRcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIChvLnR5cGUgPT0gXCJjaXJjbGVcIiB8fCBvLnR5cGUgPT0gXCJlbGxpcHNlXCIgfHwgU3RyKHZhbHVlKS5jaGFyQXQoKSAhPSBcInJcIikgJiYgYWRkR3JhZGllbnRGaWxsKG8sIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwib3BhY2l0eVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJzLmdyYWRpZW50ICYmICFhdHRyc1toYXNdKFwic3Ryb2tlLW9wYWNpdHlcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKG5vZGUsIHtcInN0cm9rZS1vcGFjaXR5XCI6IHZhbHVlID4gMSA/IHZhbHVlIC8gMTAwIDogdmFsdWV9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZhbGxcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImZpbGwtb3BhY2l0eVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJzLmdyYWRpZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JhZGllbnQgPSBSLl9nLmRvYy5nZXRFbGVtZW50QnlJZChub2RlLmdldEF0dHJpYnV0ZShcImZpbGxcIikucmVwbGFjZSgvXnVybFxcKCN8XFwpJC9nLCBFKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdyYWRpZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0b3BzID0gZ3JhZGllbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzdG9wXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKHN0b3BzW3N0b3BzLmxlbmd0aCAtIDFdLCB7XCJzdG9wLW9wYWNpdHlcIjogdmFsdWV9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBhdHQgPT0gXCJmb250LXNpemVcIiAmJiAodmFsdWUgPSB0b0ludCh2YWx1ZSwgMTApICsgXCJweFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjc3NydWxlID0gYXR0LnJlcGxhY2UoLyhcXC0uKS9nLCBmdW5jdGlvbiAodykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB3LnN1YnN0cmluZygxKS50b1VwcGVyQ2FzZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlLnN0eWxlW2Nzc3J1bGVdID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBvLl8uZGlydHkgPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5zZXRBdHRyaWJ1dGUoYXR0LCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0dW5lVGV4dChvLCBwYXJhbXMpO1xuICAgICAgICBub2RlLnN0eWxlLnZpc2liaWxpdHkgPSB2aXM7XG4gICAgfSxcbiAgICBsZWFkaW5nID0gMS4yLFxuICAgIHR1bmVUZXh0ID0gZnVuY3Rpb24gKGVsLCBwYXJhbXMpIHtcbiAgICAgICAgaWYgKGVsLnR5cGUgIT0gXCJ0ZXh0XCIgfHwgIShwYXJhbXNbaGFzXShcInRleHRcIikgfHwgcGFyYW1zW2hhc10oXCJmb250XCIpIHx8IHBhcmFtc1toYXNdKFwiZm9udC1zaXplXCIpIHx8IHBhcmFtc1toYXNdKFwieFwiKSB8fCBwYXJhbXNbaGFzXShcInlcIikpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGEgPSBlbC5hdHRycyxcbiAgICAgICAgICAgIG5vZGUgPSBlbC5ub2RlLFxuICAgICAgICAgICAgZm9udFNpemUgPSBub2RlLmZpcnN0Q2hpbGQgPyB0b0ludChSLl9nLmRvYy5kZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlKG5vZGUuZmlyc3RDaGlsZCwgRSkuZ2V0UHJvcGVydHlWYWx1ZShcImZvbnQtc2l6ZVwiKSwgMTApIDogMTA7XG5cbiAgICAgICAgaWYgKHBhcmFtc1toYXNdKFwidGV4dFwiKSkge1xuICAgICAgICAgICAgYS50ZXh0ID0gcGFyYW1zLnRleHQ7XG4gICAgICAgICAgICB3aGlsZSAobm9kZS5maXJzdENoaWxkKSB7XG4gICAgICAgICAgICAgICAgbm9kZS5yZW1vdmVDaGlsZChub2RlLmZpcnN0Q2hpbGQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHRleHRzID0gU3RyKHBhcmFtcy50ZXh0KS5zcGxpdChcIlxcblwiKSxcbiAgICAgICAgICAgICAgICB0c3BhbnMgPSBbXSxcbiAgICAgICAgICAgICAgICB0c3BhbjtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IHRleHRzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcbiAgICAgICAgICAgICAgICB0c3BhbiA9ICQoXCJ0c3BhblwiKTtcbiAgICAgICAgICAgICAgICBpICYmICQodHNwYW4sIHtkeTogZm9udFNpemUgKiBsZWFkaW5nLCB4OiBhLnh9KTtcbiAgICAgICAgICAgICAgICB0c3Bhbi5hcHBlbmRDaGlsZChSLl9nLmRvYy5jcmVhdGVUZXh0Tm9kZSh0ZXh0c1tpXSkpO1xuICAgICAgICAgICAgICAgIG5vZGUuYXBwZW5kQ2hpbGQodHNwYW4pO1xuICAgICAgICAgICAgICAgIHRzcGFuc1tpXSA9IHRzcGFuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdHNwYW5zID0gbm9kZS5nZXRFbGVtZW50c0J5VGFnTmFtZShcInRzcGFuXCIpO1xuICAgICAgICAgICAgZm9yIChpID0gMCwgaWkgPSB0c3BhbnMubGVuZ3RoOyBpIDwgaWk7IGkrKykgaWYgKGkpIHtcbiAgICAgICAgICAgICAgICAkKHRzcGFuc1tpXSwge2R5OiBmb250U2l6ZSAqIGxlYWRpbmcsIHg6IGEueH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkKHRzcGFuc1swXSwge2R5OiAwfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgJChub2RlLCB7eDogYS54LCB5OiBhLnl9KTtcbiAgICAgICAgZWwuXy5kaXJ0eSA9IDE7XG4gICAgICAgIHZhciBiYiA9IGVsLl9nZXRCQm94KCksXG4gICAgICAgICAgICBkaWYgPSBhLnkgLSAoYmIueSArIGJiLmhlaWdodCAvIDIpO1xuICAgICAgICBkaWYgJiYgUi5pcyhkaWYsIFwiZmluaXRlXCIpICYmICQodHNwYW5zWzBdLCB7ZHk6IGRpZn0pO1xuICAgIH0sXG4gICAgZ2V0UmVhbE5vZGUgPSBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICBpZiAobm9kZS5wYXJlbnROb2RlICYmIG5vZGUucGFyZW50Tm9kZS50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09IFwiYVwiKSB7XG4gICAgICAgICAgICByZXR1cm4gbm9kZS5wYXJlbnROb2RlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIEVsZW1lbnQgPSBmdW5jdGlvbiAobm9kZSwgc3ZnKSB7XG4gICAgICAgIHZhciBYID0gMCxcbiAgICAgICAgICAgIFkgPSAwO1xuICAgICAgICAvKlxcXG4gICAgICAgICAqIEVsZW1lbnQubm9kZVxuICAgICAgICAgWyBwcm9wZXJ0eSAob2JqZWN0KSBdXG4gICAgICAgICAqKlxuICAgICAgICAgKiBHaXZlcyB5b3UgYSByZWZlcmVuY2UgdG8gdGhlIERPTSBvYmplY3QsIHNvIHlvdSBjYW4gYXNzaWduIGV2ZW50IGhhbmRsZXJzIG9yIGp1c3QgbWVzcyBhcm91bmQuXG4gICAgICAgICAqKlxuICAgICAgICAgKiBOb3RlOiBEb27igJl0IG1lc3Mgd2l0aCBpdC5cbiAgICAgICAgID4gVXNhZ2VcbiAgICAgICAgIHwgLy8gZHJhdyBhIGNpcmNsZSBhdCBjb29yZGluYXRlIDEwLDEwIHdpdGggcmFkaXVzIG9mIDEwXG4gICAgICAgICB8IHZhciBjID0gcGFwZXIuY2lyY2xlKDEwLCAxMCwgMTApO1xuICAgICAgICAgfCBjLm5vZGUub25jbGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgIHwgICAgIGMuYXR0cihcImZpbGxcIiwgXCJyZWRcIik7XG4gICAgICAgICB8IH07XG4gICAgICAgIFxcKi9cbiAgICAgICAgdGhpc1swXSA9IHRoaXMubm9kZSA9IG5vZGU7XG4gICAgICAgIC8qXFxcbiAgICAgICAgICogRWxlbWVudC5yYXBoYWVsXG4gICAgICAgICBbIHByb3BlcnR5IChvYmplY3QpIF1cbiAgICAgICAgICoqXG4gICAgICAgICAqIEludGVybmFsIHJlZmVyZW5jZSB0byBAUmFwaGFlbCBvYmplY3QuIEluIGNhc2UgaXQgaXMgbm90IGF2YWlsYWJsZS5cbiAgICAgICAgID4gVXNhZ2VcbiAgICAgICAgIHwgUmFwaGFlbC5lbC5yZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICB8ICAgICB2YXIgaHNiID0gdGhpcy5wYXBlci5yYXBoYWVsLnJnYjJoc2IodGhpcy5hdHRyKFwiZmlsbFwiKSk7XG4gICAgICAgICB8ICAgICBoc2IuaCA9IDE7XG4gICAgICAgICB8ICAgICB0aGlzLmF0dHIoe2ZpbGw6IHRoaXMucGFwZXIucmFwaGFlbC5oc2IycmdiKGhzYikuaGV4fSk7XG4gICAgICAgICB8IH1cbiAgICAgICAgXFwqL1xuICAgICAgICBub2RlLnJhcGhhZWwgPSB0cnVlO1xuICAgICAgICAvKlxcXG4gICAgICAgICAqIEVsZW1lbnQuaWRcbiAgICAgICAgIFsgcHJvcGVydHkgKG51bWJlcikgXVxuICAgICAgICAgKipcbiAgICAgICAgICogVW5pcXVlIGlkIG9mIHRoZSBlbGVtZW50LiBFc3BlY2lhbGx5IHVzZWZ1bCB3aGVuIHlvdSB3YW50IHRvIGxpc3RlbiB0byBldmVudHMgb2YgdGhlIGVsZW1lbnQsXG4gICAgICAgICAqIGJlY2F1c2UgYWxsIGV2ZW50cyBhcmUgZmlyZWQgaW4gZm9ybWF0IGA8bW9kdWxlPi48YWN0aW9uPi48aWQ+YC4gQWxzbyB1c2VmdWwgZm9yIEBQYXBlci5nZXRCeUlkIG1ldGhvZC5cbiAgICAgICAgXFwqL1xuICAgICAgICB0aGlzLmlkID0gZ3VpZCgpO1xuICAgICAgICBub2RlLnJhcGhhZWxpZCA9IHRoaXMuaWQ7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICogTWV0aG9kIHRoYXQgcmV0dXJucyBhIDUgbGV0dGVyL2RpZ2l0IGlkLCBlbm91Z2ggZm9yIDM2XjUgPSA2MDQ2NjE3NiBlbGVtZW50c1xuICAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IGlkXG4gICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGd1aWQoKSB7XG4gICAgICAgICAgICByZXR1cm4gKFwiMDAwMFwiICsgKE1hdGgucmFuZG9tKCkqTWF0aC5wb3coMzYsNSkgPDwgMCkudG9TdHJpbmcoMzYpKS5zbGljZSgtNSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLm1hdHJpeCA9IFIubWF0cml4KCk7XG4gICAgICAgIHRoaXMucmVhbFBhdGggPSBudWxsO1xuICAgICAgICAvKlxcXG4gICAgICAgICAqIEVsZW1lbnQucGFwZXJcbiAgICAgICAgIFsgcHJvcGVydHkgKG9iamVjdCkgXVxuICAgICAgICAgKipcbiAgICAgICAgICogSW50ZXJuYWwgcmVmZXJlbmNlIHRvIOKAnHBhcGVy4oCdIHdoZXJlIG9iamVjdCBkcmF3bi4gTWFpbmx5IGZvciB1c2UgaW4gcGx1Z2lucyBhbmQgZWxlbWVudCBleHRlbnNpb25zLlxuICAgICAgICAgPiBVc2FnZVxuICAgICAgICAgfCBSYXBoYWVsLmVsLmNyb3NzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgfCAgICAgdGhpcy5hdHRyKHtmaWxsOiBcInJlZFwifSk7XG4gICAgICAgICB8ICAgICB0aGlzLnBhcGVyLnBhdGgoXCJNMTAsMTBMNTAsNTBNNTAsMTBMMTAsNTBcIilcbiAgICAgICAgIHwgICAgICAgICAuYXR0cih7c3Ryb2tlOiBcInJlZFwifSk7XG4gICAgICAgICB8IH1cbiAgICAgICAgXFwqL1xuICAgICAgICB0aGlzLnBhcGVyID0gc3ZnO1xuICAgICAgICB0aGlzLmF0dHJzID0gdGhpcy5hdHRycyB8fCB7fTtcbiAgICAgICAgdGhpcy5fID0ge1xuICAgICAgICAgICAgdHJhbnNmb3JtOiBbXSxcbiAgICAgICAgICAgIHN4OiAxLFxuICAgICAgICAgICAgc3k6IDEsXG4gICAgICAgICAgICBkZWc6IDAsXG4gICAgICAgICAgICBkeDogMCxcbiAgICAgICAgICAgIGR5OiAwLFxuICAgICAgICAgICAgZGlydHk6IDFcbiAgICAgICAgfTtcbiAgICAgICAgIXN2Zy5ib3R0b20gJiYgKHN2Zy5ib3R0b20gPSB0aGlzKTtcbiAgICAgICAgLypcXFxuICAgICAgICAgKiBFbGVtZW50LnByZXZcbiAgICAgICAgIFsgcHJvcGVydHkgKG9iamVjdCkgXVxuICAgICAgICAgKipcbiAgICAgICAgICogUmVmZXJlbmNlIHRvIHRoZSBwcmV2aW91cyBlbGVtZW50IGluIHRoZSBoaWVyYXJjaHkuXG4gICAgICAgIFxcKi9cbiAgICAgICAgdGhpcy5wcmV2ID0gc3ZnLnRvcDtcbiAgICAgICAgc3ZnLnRvcCAmJiAoc3ZnLnRvcC5uZXh0ID0gdGhpcyk7XG4gICAgICAgIHN2Zy50b3AgPSB0aGlzO1xuICAgICAgICAvKlxcXG4gICAgICAgICAqIEVsZW1lbnQubmV4dFxuICAgICAgICAgWyBwcm9wZXJ0eSAob2JqZWN0KSBdXG4gICAgICAgICAqKlxuICAgICAgICAgKiBSZWZlcmVuY2UgdG8gdGhlIG5leHQgZWxlbWVudCBpbiB0aGUgaGllcmFyY2h5LlxuICAgICAgICBcXCovXG4gICAgICAgIHRoaXMubmV4dCA9IG51bGw7XG4gICAgfSxcbiAgICBlbHByb3RvID0gUi5lbDtcblxuICAgIEVsZW1lbnQucHJvdG90eXBlID0gZWxwcm90bztcbiAgICBlbHByb3RvLmNvbnN0cnVjdG9yID0gRWxlbWVudDtcblxuICAgIFIuX2VuZ2luZS5wYXRoID0gZnVuY3Rpb24gKHBhdGhTdHJpbmcsIFNWRykge1xuICAgICAgICB2YXIgZWwgPSAkKFwicGF0aFwiKTtcbiAgICAgICAgU1ZHLmNhbnZhcyAmJiBTVkcuY2FudmFzLmFwcGVuZENoaWxkKGVsKTtcbiAgICAgICAgdmFyIHAgPSBuZXcgRWxlbWVudChlbCwgU1ZHKTtcbiAgICAgICAgcC50eXBlID0gXCJwYXRoXCI7XG4gICAgICAgIHNldEZpbGxBbmRTdHJva2UocCwge1xuICAgICAgICAgICAgZmlsbDogXCJub25lXCIsXG4gICAgICAgICAgICBzdHJva2U6IFwiIzAwMFwiLFxuICAgICAgICAgICAgcGF0aDogcGF0aFN0cmluZ1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHA7XG4gICAgfTtcbiAgICAvKlxcXG4gICAgICogRWxlbWVudC5yb3RhdGVcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIERlcHJlY2F0ZWQhIFVzZSBARWxlbWVudC50cmFuc2Zvcm0gaW5zdGVhZC5cbiAgICAgKiBBZGRzIHJvdGF0aW9uIGJ5IGdpdmVuIGFuZ2xlIGFyb3VuZCBnaXZlbiBwb2ludCB0byB0aGUgbGlzdCBvZlxuICAgICAqIHRyYW5zZm9ybWF0aW9ucyBvZiB0aGUgZWxlbWVudC5cbiAgICAgPiBQYXJhbWV0ZXJzXG4gICAgIC0gZGVnIChudW1iZXIpIGFuZ2xlIGluIGRlZ3JlZXNcbiAgICAgLSBjeCAobnVtYmVyKSAjb3B0aW9uYWwgeCBjb29yZGluYXRlIG9mIHRoZSBjZW50cmUgb2Ygcm90YXRpb25cbiAgICAgLSBjeSAobnVtYmVyKSAjb3B0aW9uYWwgeSBjb29yZGluYXRlIG9mIHRoZSBjZW50cmUgb2Ygcm90YXRpb25cbiAgICAgKiBJZiBjeCAmIGN5IGFyZW7igJl0IHNwZWNpZmllZCBjZW50cmUgb2YgdGhlIHNoYXBlIGlzIHVzZWQgYXMgYSBwb2ludCBvZiByb3RhdGlvbi5cbiAgICAgPSAob2JqZWN0KSBARWxlbWVudFxuICAgIFxcKi9cbiAgICBlbHByb3RvLnJvdGF0ZSA9IGZ1bmN0aW9uIChkZWcsIGN4LCBjeSkge1xuICAgICAgICBpZiAodGhpcy5yZW1vdmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgICAgICBkZWcgPSBTdHIoZGVnKS5zcGxpdChzZXBhcmF0b3IpO1xuICAgICAgICBpZiAoZGVnLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgIGN4ID0gdG9GbG9hdChkZWdbMV0pO1xuICAgICAgICAgICAgY3kgPSB0b0Zsb2F0KGRlZ1syXSk7XG4gICAgICAgIH1cbiAgICAgICAgZGVnID0gdG9GbG9hdChkZWdbMF0pO1xuICAgICAgICAoY3kgPT0gbnVsbCkgJiYgKGN4ID0gY3kpO1xuICAgICAgICBpZiAoY3ggPT0gbnVsbCB8fCBjeSA9PSBudWxsKSB7XG4gICAgICAgICAgICB2YXIgYmJveCA9IHRoaXMuZ2V0QkJveCgxKTtcbiAgICAgICAgICAgIGN4ID0gYmJveC54ICsgYmJveC53aWR0aCAvIDI7XG4gICAgICAgICAgICBjeSA9IGJib3gueSArIGJib3guaGVpZ2h0IC8gMjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnRyYW5zZm9ybSh0aGlzLl8udHJhbnNmb3JtLmNvbmNhdChbW1wiclwiLCBkZWcsIGN4LCBjeV1dKSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIEVsZW1lbnQuc2NhbGVcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIERlcHJlY2F0ZWQhIFVzZSBARWxlbWVudC50cmFuc2Zvcm0gaW5zdGVhZC5cbiAgICAgKiBBZGRzIHNjYWxlIGJ5IGdpdmVuIGFtb3VudCByZWxhdGl2ZSB0byBnaXZlbiBwb2ludCB0byB0aGUgbGlzdCBvZlxuICAgICAqIHRyYW5zZm9ybWF0aW9ucyBvZiB0aGUgZWxlbWVudC5cbiAgICAgPiBQYXJhbWV0ZXJzXG4gICAgIC0gc3ggKG51bWJlcikgaG9yaXNvbnRhbCBzY2FsZSBhbW91bnRcbiAgICAgLSBzeSAobnVtYmVyKSB2ZXJ0aWNhbCBzY2FsZSBhbW91bnRcbiAgICAgLSBjeCAobnVtYmVyKSAjb3B0aW9uYWwgeCBjb29yZGluYXRlIG9mIHRoZSBjZW50cmUgb2Ygc2NhbGVcbiAgICAgLSBjeSAobnVtYmVyKSAjb3B0aW9uYWwgeSBjb29yZGluYXRlIG9mIHRoZSBjZW50cmUgb2Ygc2NhbGVcbiAgICAgKiBJZiBjeCAmIGN5IGFyZW7igJl0IHNwZWNpZmllZCBjZW50cmUgb2YgdGhlIHNoYXBlIGlzIHVzZWQgaW5zdGVhZC5cbiAgICAgPSAob2JqZWN0KSBARWxlbWVudFxuICAgIFxcKi9cbiAgICBlbHByb3RvLnNjYWxlID0gZnVuY3Rpb24gKHN4LCBzeSwgY3gsIGN5KSB7XG4gICAgICAgIGlmICh0aGlzLnJlbW92ZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIHN4ID0gU3RyKHN4KS5zcGxpdChzZXBhcmF0b3IpO1xuICAgICAgICBpZiAoc3gubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgc3kgPSB0b0Zsb2F0KHN4WzFdKTtcbiAgICAgICAgICAgIGN4ID0gdG9GbG9hdChzeFsyXSk7XG4gICAgICAgICAgICBjeSA9IHRvRmxvYXQoc3hbM10pO1xuICAgICAgICB9XG4gICAgICAgIHN4ID0gdG9GbG9hdChzeFswXSk7XG4gICAgICAgIChzeSA9PSBudWxsKSAmJiAoc3kgPSBzeCk7XG4gICAgICAgIChjeSA9PSBudWxsKSAmJiAoY3ggPSBjeSk7XG4gICAgICAgIGlmIChjeCA9PSBudWxsIHx8IGN5ID09IG51bGwpIHtcbiAgICAgICAgICAgIHZhciBiYm94ID0gdGhpcy5nZXRCQm94KDEpO1xuICAgICAgICB9XG4gICAgICAgIGN4ID0gY3ggPT0gbnVsbCA/IGJib3gueCArIGJib3gud2lkdGggLyAyIDogY3g7XG4gICAgICAgIGN5ID0gY3kgPT0gbnVsbCA/IGJib3gueSArIGJib3guaGVpZ2h0IC8gMiA6IGN5O1xuICAgICAgICB0aGlzLnRyYW5zZm9ybSh0aGlzLl8udHJhbnNmb3JtLmNvbmNhdChbW1wic1wiLCBzeCwgc3ksIGN4LCBjeV1dKSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIEVsZW1lbnQudHJhbnNsYXRlXG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBEZXByZWNhdGVkISBVc2UgQEVsZW1lbnQudHJhbnNmb3JtIGluc3RlYWQuXG4gICAgICogQWRkcyB0cmFuc2xhdGlvbiBieSBnaXZlbiBhbW91bnQgdG8gdGhlIGxpc3Qgb2YgdHJhbnNmb3JtYXRpb25zIG9mIHRoZSBlbGVtZW50LlxuICAgICA+IFBhcmFtZXRlcnNcbiAgICAgLSBkeCAobnVtYmVyKSBob3Jpc29udGFsIHNoaWZ0XG4gICAgIC0gZHkgKG51bWJlcikgdmVydGljYWwgc2hpZnRcbiAgICAgPSAob2JqZWN0KSBARWxlbWVudFxuICAgIFxcKi9cbiAgICBlbHByb3RvLnRyYW5zbGF0ZSA9IGZ1bmN0aW9uIChkeCwgZHkpIHtcbiAgICAgICAgaWYgKHRoaXMucmVtb3ZlZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgZHggPSBTdHIoZHgpLnNwbGl0KHNlcGFyYXRvcik7XG4gICAgICAgIGlmIChkeC5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICBkeSA9IHRvRmxvYXQoZHhbMV0pO1xuICAgICAgICB9XG4gICAgICAgIGR4ID0gdG9GbG9hdChkeFswXSkgfHwgMDtcbiAgICAgICAgZHkgPSArZHkgfHwgMDtcbiAgICAgICAgdGhpcy50cmFuc2Zvcm0odGhpcy5fLnRyYW5zZm9ybS5jb25jYXQoW1tcInRcIiwgZHgsIGR5XV0pKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICAvKlxcXG4gICAgICogRWxlbWVudC50cmFuc2Zvcm1cbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIEFkZHMgdHJhbnNmb3JtYXRpb24gdG8gdGhlIGVsZW1lbnQgd2hpY2ggaXMgc2VwYXJhdGUgdG8gb3RoZXIgYXR0cmlidXRlcyxcbiAgICAgKiBpLmUuIHRyYW5zbGF0aW9uIGRvZXNu4oCZdCBjaGFuZ2UgYHhgIG9yIGB5YCBvZiB0aGUgcmVjdGFuZ2UuIFRoZSBmb3JtYXRcbiAgICAgKiBvZiB0cmFuc2Zvcm1hdGlvbiBzdHJpbmcgaXMgc2ltaWxhciB0byB0aGUgcGF0aCBzdHJpbmcgc3ludGF4OlxuICAgICB8IFwidDEwMCwxMDByMzAsMTAwLDEwMHMyLDIsMTAwLDEwMHI0NXMxLjVcIlxuICAgICAqIEVhY2ggbGV0dGVyIGlzIGEgY29tbWFuZC4gVGhlcmUgYXJlIGZvdXIgY29tbWFuZHM6IGB0YCBpcyBmb3IgdHJhbnNsYXRlLCBgcmAgaXMgZm9yIHJvdGF0ZSwgYHNgIGlzIGZvclxuICAgICAqIHNjYWxlIGFuZCBgbWAgaXMgZm9yIG1hdHJpeC5cbiAgICAgKlxuICAgICAqIFRoZXJlIGFyZSBhbHNvIGFsdGVybmF0aXZlIOKAnGFic29sdXRl4oCdIHRyYW5zbGF0aW9uLCByb3RhdGlvbiBhbmQgc2NhbGU6IGBUYCwgYFJgIGFuZCBgU2AuIFRoZXkgd2lsbCBub3QgdGFrZSBwcmV2aW91cyB0cmFuc2Zvcm1hdGlvbiBpbnRvIGFjY291bnQuIEZvciBleGFtcGxlLCBgLi4uVDEwMCwwYCB3aWxsIGFsd2F5cyBtb3ZlIGVsZW1lbnQgMTAwIHB4IGhvcmlzb250YWxseSwgd2hpbGUgYC4uLnQxMDAsMGAgY291bGQgbW92ZSBpdCB2ZXJ0aWNhbGx5IGlmIHRoZXJlIGlzIGByOTBgIGJlZm9yZS4gSnVzdCBjb21wYXJlIHJlc3VsdHMgb2YgYHI5MHQxMDAsMGAgYW5kIGByOTBUMTAwLDBgLlxuICAgICAqXG4gICAgICogU28sIHRoZSBleGFtcGxlIGxpbmUgYWJvdmUgY291bGQgYmUgcmVhZCBsaWtlIOKAnHRyYW5zbGF0ZSBieSAxMDAsIDEwMDsgcm90YXRlIDMwwrAgYXJvdW5kIDEwMCwgMTAwOyBzY2FsZSB0d2ljZSBhcm91bmQgMTAwLCAxMDA7XG4gICAgICogcm90YXRlIDQ1wrAgYXJvdW5kIGNlbnRyZTsgc2NhbGUgMS41IHRpbWVzIHJlbGF0aXZlIHRvIGNlbnRyZeKAnS4gQXMgeW91IGNhbiBzZWUgcm90YXRlIGFuZCBzY2FsZSBjb21tYW5kcyBoYXZlIG9yaWdpblxuICAgICAqIGNvb3JkaW5hdGVzIGFzIG9wdGlvbmFsIHBhcmFtZXRlcnMsIHRoZSBkZWZhdWx0IGlzIHRoZSBjZW50cmUgcG9pbnQgb2YgdGhlIGVsZW1lbnQuXG4gICAgICogTWF0cml4IGFjY2VwdHMgc2l4IHBhcmFtZXRlcnMuXG4gICAgID4gVXNhZ2VcbiAgICAgfCB2YXIgZWwgPSBwYXBlci5yZWN0KDEwLCAyMCwgMzAwLCAyMDApO1xuICAgICB8IC8vIHRyYW5zbGF0ZSAxMDAsIDEwMCwgcm90YXRlIDQ1wrAsIHRyYW5zbGF0ZSAtMTAwLCAwXG4gICAgIHwgZWwudHJhbnNmb3JtKFwidDEwMCwxMDByNDV0LTEwMCwwXCIpO1xuICAgICB8IC8vIGlmIHlvdSB3YW50IHlvdSBjYW4gYXBwZW5kIG9yIHByZXBlbmQgdHJhbnNmb3JtYXRpb25zXG4gICAgIHwgZWwudHJhbnNmb3JtKFwiLi4udDUwLDUwXCIpO1xuICAgICB8IGVsLnRyYW5zZm9ybShcInMyLi4uXCIpO1xuICAgICB8IC8vIG9yIGV2ZW4gd3JhcFxuICAgICB8IGVsLnRyYW5zZm9ybShcInQ1MCw1MC4uLnQtNTAtNTBcIik7XG4gICAgIHwgLy8gdG8gcmVzZXQgdHJhbnNmb3JtYXRpb24gY2FsbCBtZXRob2Qgd2l0aCBlbXB0eSBzdHJpbmdcbiAgICAgfCBlbC50cmFuc2Zvcm0oXCJcIik7XG4gICAgIHwgLy8gdG8gZ2V0IGN1cnJlbnQgdmFsdWUgY2FsbCBpdCB3aXRob3V0IHBhcmFtZXRlcnNcbiAgICAgfCBjb25zb2xlLmxvZyhlbC50cmFuc2Zvcm0oKSk7XG4gICAgID4gUGFyYW1ldGVyc1xuICAgICAtIHRzdHIgKHN0cmluZykgI29wdGlvbmFsIHRyYW5zZm9ybWF0aW9uIHN0cmluZ1xuICAgICAqIElmIHRzdHIgaXNu4oCZdCBzcGVjaWZpZWRcbiAgICAgPSAoc3RyaW5nKSBjdXJyZW50IHRyYW5zZm9ybWF0aW9uIHN0cmluZ1xuICAgICAqIGVsc2VcbiAgICAgPSAob2JqZWN0KSBARWxlbWVudFxuICAgIFxcKi9cbiAgICBlbHByb3RvLnRyYW5zZm9ybSA9IGZ1bmN0aW9uICh0c3RyKSB7XG4gICAgICAgIHZhciBfID0gdGhpcy5fO1xuICAgICAgICBpZiAodHN0ciA9PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4gXy50cmFuc2Zvcm07XG4gICAgICAgIH1cbiAgICAgICAgUi5fZXh0cmFjdFRyYW5zZm9ybSh0aGlzLCB0c3RyKTtcblxuICAgICAgICB0aGlzLmNsaXAgJiYgJCh0aGlzLmNsaXAsIHt0cmFuc2Zvcm06IHRoaXMubWF0cml4LmludmVydCgpfSk7XG4gICAgICAgIHRoaXMucGF0dGVybiAmJiB1cGRhdGVQb3NpdGlvbih0aGlzKTtcbiAgICAgICAgdGhpcy5ub2RlICYmICQodGhpcy5ub2RlLCB7dHJhbnNmb3JtOiB0aGlzLm1hdHJpeH0pO1xuXG4gICAgICAgIGlmIChfLnN4ICE9IDEgfHwgXy5zeSAhPSAxKSB7XG4gICAgICAgICAgICB2YXIgc3cgPSB0aGlzLmF0dHJzW2hhc10oXCJzdHJva2Utd2lkdGhcIikgPyB0aGlzLmF0dHJzW1wic3Ryb2tlLXdpZHRoXCJdIDogMTtcbiAgICAgICAgICAgIHRoaXMuYXR0cih7XCJzdHJva2Utd2lkdGhcIjogc3d9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIEVsZW1lbnQuaGlkZVxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogTWFrZXMgZWxlbWVudCBpbnZpc2libGUuIFNlZSBARWxlbWVudC5zaG93LlxuICAgICA9IChvYmplY3QpIEBFbGVtZW50XG4gICAgXFwqL1xuICAgIGVscHJvdG8uaGlkZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYoIXRoaXMucmVtb3ZlZCkgdGhpcy5ub2RlLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICAvKlxcXG4gICAgICogRWxlbWVudC5zaG93XG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBNYWtlcyBlbGVtZW50IHZpc2libGUuIFNlZSBARWxlbWVudC5oaWRlLlxuICAgICA9IChvYmplY3QpIEBFbGVtZW50XG4gICAgXFwqL1xuICAgIGVscHJvdG8uc2hvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYoIXRoaXMucmVtb3ZlZCkgdGhpcy5ub2RlLnN0eWxlLmRpc3BsYXkgPSBcIlwiO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIC8qXFxcbiAgICAgKiBFbGVtZW50LnJlbW92ZVxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogUmVtb3ZlcyBlbGVtZW50IGZyb20gdGhlIHBhcGVyLlxuICAgIFxcKi9cbiAgICBlbHByb3RvLnJlbW92ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG5vZGUgPSBnZXRSZWFsTm9kZSh0aGlzLm5vZGUpO1xuICAgICAgICBpZiAodGhpcy5yZW1vdmVkIHx8ICFub2RlLnBhcmVudE5vZGUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcGFwZXIgPSB0aGlzLnBhcGVyO1xuICAgICAgICBwYXBlci5fX3NldF9fICYmIHBhcGVyLl9fc2V0X18uZXhjbHVkZSh0aGlzKTtcbiAgICAgICAgZXZlLnVuYmluZChcInJhcGhhZWwuKi4qLlwiICsgdGhpcy5pZCk7XG4gICAgICAgIGlmICh0aGlzLmdyYWRpZW50KSB7XG4gICAgICAgICAgICBwYXBlci5kZWZzLnJlbW92ZUNoaWxkKHRoaXMuZ3JhZGllbnQpO1xuICAgICAgICB9XG4gICAgICAgIFIuX3RlYXIodGhpcywgcGFwZXIpO1xuXG4gICAgICAgIG5vZGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChub2RlKTtcblxuICAgICAgICAvLyBSZW1vdmUgY3VzdG9tIGRhdGEgZm9yIGVsZW1lbnRcbiAgICAgICAgdGhpcy5yZW1vdmVEYXRhKCk7XG5cbiAgICAgICAgZm9yICh2YXIgaSBpbiB0aGlzKSB7XG4gICAgICAgICAgICB0aGlzW2ldID0gdHlwZW9mIHRoaXNbaV0gPT0gXCJmdW5jdGlvblwiID8gUi5fcmVtb3ZlZEZhY3RvcnkoaSkgOiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVtb3ZlZCA9IHRydWU7XG4gICAgfTtcbiAgICBlbHByb3RvLl9nZXRCQm94ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5ub2RlLnN0eWxlLmRpc3BsYXkgPT0gXCJub25lXCIpIHtcbiAgICAgICAgICAgIHRoaXMuc2hvdygpO1xuICAgICAgICAgICAgdmFyIGhpZGUgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjYW52YXNIaWRkZW4gPSBmYWxzZSxcbiAgICAgICAgICAgIGNvbnRhaW5lclN0eWxlO1xuICAgICAgICBpZiAodGhpcy5wYXBlci5jYW52YXMucGFyZW50RWxlbWVudCkge1xuICAgICAgICAgIGNvbnRhaW5lclN0eWxlID0gdGhpcy5wYXBlci5jYW52YXMucGFyZW50RWxlbWVudC5zdHlsZTtcbiAgICAgICAgfSAvL0lFMTArIGNhbid0IGZpbmQgcGFyZW50RWxlbWVudFxuICAgICAgICBlbHNlIGlmICh0aGlzLnBhcGVyLmNhbnZhcy5wYXJlbnROb2RlKSB7XG4gICAgICAgICAgY29udGFpbmVyU3R5bGUgPSB0aGlzLnBhcGVyLmNhbnZhcy5wYXJlbnROb2RlLnN0eWxlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYoY29udGFpbmVyU3R5bGUgJiYgY29udGFpbmVyU3R5bGUuZGlzcGxheSA9PSBcIm5vbmVcIikge1xuICAgICAgICAgIGNhbnZhc0hpZGRlbiA9IHRydWU7XG4gICAgICAgICAgY29udGFpbmVyU3R5bGUuZGlzcGxheSA9IFwiXCI7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGJib3ggPSB7fTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGJib3ggPSB0aGlzLm5vZGUuZ2V0QkJveCgpO1xuICAgICAgICB9IGNhdGNoKGUpIHtcbiAgICAgICAgICAgIC8vIEZpcmVmb3ggMy4wLngsIDI1LjAuMSAocHJvYmFibHkgbW9yZSB2ZXJzaW9ucyBhZmZlY3RlZCkgcGxheSBiYWRseSBoZXJlIC0gcG9zc2libGUgZml4XG4gICAgICAgICAgICBiYm94ID0ge1xuICAgICAgICAgICAgICAgIHg6IHRoaXMubm9kZS5jbGllbnRMZWZ0LFxuICAgICAgICAgICAgICAgIHk6IHRoaXMubm9kZS5jbGllbnRUb3AsXG4gICAgICAgICAgICAgICAgd2lkdGg6IHRoaXMubm9kZS5jbGllbnRXaWR0aCxcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IHRoaXMubm9kZS5jbGllbnRIZWlnaHRcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgIGJib3ggPSBiYm94IHx8IHt9O1xuICAgICAgICAgICAgaWYoY2FudmFzSGlkZGVuKXtcbiAgICAgICAgICAgICAgY29udGFpbmVyU3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGhpZGUgJiYgdGhpcy5oaWRlKCk7XG4gICAgICAgIHJldHVybiBiYm94O1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIEVsZW1lbnQuYXR0clxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogU2V0cyB0aGUgYXR0cmlidXRlcyBvZiB0aGUgZWxlbWVudC5cbiAgICAgPiBQYXJhbWV0ZXJzXG4gICAgIC0gYXR0ck5hbWUgKHN0cmluZykgYXR0cmlidXRl4oCZcyBuYW1lXG4gICAgIC0gdmFsdWUgKHN0cmluZykgdmFsdWVcbiAgICAgKiBvclxuICAgICAtIHBhcmFtcyAob2JqZWN0KSBvYmplY3Qgb2YgbmFtZS92YWx1ZSBwYWlyc1xuICAgICAqIG9yXG4gICAgIC0gYXR0ck5hbWUgKHN0cmluZykgYXR0cmlidXRl4oCZcyBuYW1lXG4gICAgICogb3JcbiAgICAgLSBhdHRyTmFtZXMgKGFycmF5KSBpbiB0aGlzIGNhc2UgbWV0aG9kIHJldHVybnMgYXJyYXkgb2YgY3VycmVudCB2YWx1ZXMgZm9yIGdpdmVuIGF0dHJpYnV0ZSBuYW1lc1xuICAgICA9IChvYmplY3QpIEBFbGVtZW50IGlmIGF0dHJzTmFtZSAmIHZhbHVlIG9yIHBhcmFtcyBhcmUgcGFzc2VkIGluLlxuICAgICA9ICguLi4pIHZhbHVlIG9mIHRoZSBhdHRyaWJ1dGUgaWYgb25seSBhdHRyc05hbWUgaXMgcGFzc2VkIGluLlxuICAgICA9IChhcnJheSkgYXJyYXkgb2YgdmFsdWVzIG9mIHRoZSBhdHRyaWJ1dGUgaWYgYXR0cnNOYW1lcyBpcyBwYXNzZWQgaW4uXG4gICAgID0gKG9iamVjdCkgb2JqZWN0IG9mIGF0dHJpYnV0ZXMgaWYgbm90aGluZyBpcyBwYXNzZWQgaW4uXG4gICAgID4gUG9zc2libGUgcGFyYW1ldGVyc1xuICAgICAjIDxwPlBsZWFzZSByZWZlciB0byB0aGUgPGEgaHJlZj1cImh0dHA6Ly93d3cudzMub3JnL1RSL1NWRy9cIiB0aXRsZT1cIlRoZSBXM0MgUmVjb21tZW5kYXRpb24gZm9yIHRoZSBTVkcgbGFuZ3VhZ2UgZGVzY3JpYmVzIHRoZXNlIHByb3BlcnRpZXMgaW4gZGV0YWlsLlwiPlNWRyBzcGVjaWZpY2F0aW9uPC9hPiBmb3IgYW4gZXhwbGFuYXRpb24gb2YgdGhlc2UgcGFyYW1ldGVycy48L3A+XG4gICAgIG8gYXJyb3ctZW5kIChzdHJpbmcpIGFycm93aGVhZCBvbiB0aGUgZW5kIG9mIHRoZSBwYXRoLiBUaGUgZm9ybWF0IGZvciBzdHJpbmcgaXMgYDx0eXBlPlstPHdpZHRoPlstPGxlbmd0aD5dXWAuIFBvc3NpYmxlIHR5cGVzOiBgY2xhc3NpY2AsIGBibG9ja2AsIGBvcGVuYCwgYG92YWxgLCBgZGlhbW9uZGAsIGBub25lYCwgd2lkdGg6IGB3aWRlYCwgYG5hcnJvd2AsIGBtZWRpdW1gLCBsZW5ndGg6IGBsb25nYCwgYHNob3J0YCwgYG1pZGl1bWAuXG4gICAgIG8gY2xpcC1yZWN0IChzdHJpbmcpIGNvbW1hIG9yIHNwYWNlIHNlcGFyYXRlZCB2YWx1ZXM6IHgsIHksIHdpZHRoIGFuZCBoZWlnaHRcbiAgICAgbyBjdXJzb3IgKHN0cmluZykgQ1NTIHR5cGUgb2YgdGhlIGN1cnNvclxuICAgICBvIGN4IChudW1iZXIpIHRoZSB4LWF4aXMgY29vcmRpbmF0ZSBvZiB0aGUgY2VudGVyIG9mIHRoZSBjaXJjbGUsIG9yIGVsbGlwc2VcbiAgICAgbyBjeSAobnVtYmVyKSB0aGUgeS1heGlzIGNvb3JkaW5hdGUgb2YgdGhlIGNlbnRlciBvZiB0aGUgY2lyY2xlLCBvciBlbGxpcHNlXG4gICAgIG8gZmlsbCAoc3RyaW5nKSBjb2xvdXIsIGdyYWRpZW50IG9yIGltYWdlXG4gICAgIG8gZmlsbC1vcGFjaXR5IChudW1iZXIpXG4gICAgIG8gZm9udCAoc3RyaW5nKVxuICAgICBvIGZvbnQtZmFtaWx5IChzdHJpbmcpXG4gICAgIG8gZm9udC1zaXplIChudW1iZXIpIGZvbnQgc2l6ZSBpbiBwaXhlbHNcbiAgICAgbyBmb250LXdlaWdodCAoc3RyaW5nKVxuICAgICBvIGhlaWdodCAobnVtYmVyKVxuICAgICBvIGhyZWYgKHN0cmluZykgVVJMLCBpZiBzcGVjaWZpZWQgZWxlbWVudCBiZWhhdmVzIGFzIGh5cGVybGlua1xuICAgICBvIG9wYWNpdHkgKG51bWJlcilcbiAgICAgbyBwYXRoIChzdHJpbmcpIFNWRyBwYXRoIHN0cmluZyBmb3JtYXRcbiAgICAgbyByIChudW1iZXIpIHJhZGl1cyBvZiB0aGUgY2lyY2xlLCBlbGxpcHNlIG9yIHJvdW5kZWQgY29ybmVyIG9uIHRoZSByZWN0XG4gICAgIG8gcnggKG51bWJlcikgaG9yaXNvbnRhbCByYWRpdXMgb2YgdGhlIGVsbGlwc2VcbiAgICAgbyByeSAobnVtYmVyKSB2ZXJ0aWNhbCByYWRpdXMgb2YgdGhlIGVsbGlwc2VcbiAgICAgbyBzcmMgKHN0cmluZykgaW1hZ2UgVVJMLCBvbmx5IHdvcmtzIGZvciBARWxlbWVudC5pbWFnZSBlbGVtZW50XG4gICAgIG8gc3Ryb2tlIChzdHJpbmcpIHN0cm9rZSBjb2xvdXJcbiAgICAgbyBzdHJva2UtZGFzaGFycmF5IChzdHJpbmcpIFvigJzigJ0sIOKAnG5vbmXigJ0sIOKAnGAtYOKAnSwg4oCcYC5g4oCdLCDigJxgLS5g4oCdLCDigJxgLS4uYOKAnSwg4oCcYC4gYOKAnSwg4oCcYC0gYOKAnSwg4oCcYC0tYOKAnSwg4oCcYC0gLmDigJ0sIOKAnGAtLS5g4oCdLCDigJxgLS0uLmDigJ1dXG4gICAgIG8gc3Ryb2tlLWxpbmVjYXAgKHN0cmluZykgW+KAnGBidXR0YOKAnSwg4oCcYHNxdWFyZWDigJ0sIOKAnGByb3VuZGDigJ1dXG4gICAgIG8gc3Ryb2tlLWxpbmVqb2luIChzdHJpbmcpIFvigJxgYmV2ZWxg4oCdLCDigJxgcm91bmRg4oCdLCDigJxgbWl0ZXJg4oCdXVxuICAgICBvIHN0cm9rZS1taXRlcmxpbWl0IChudW1iZXIpXG4gICAgIG8gc3Ryb2tlLW9wYWNpdHkgKG51bWJlcilcbiAgICAgbyBzdHJva2Utd2lkdGggKG51bWJlcikgc3Ryb2tlIHdpZHRoIGluIHBpeGVscywgZGVmYXVsdCBpcyAnMSdcbiAgICAgbyB0YXJnZXQgKHN0cmluZykgdXNlZCB3aXRoIGhyZWZcbiAgICAgbyB0ZXh0IChzdHJpbmcpIGNvbnRlbnRzIG9mIHRoZSB0ZXh0IGVsZW1lbnQuIFVzZSBgXFxuYCBmb3IgbXVsdGlsaW5lIHRleHRcbiAgICAgbyB0ZXh0LWFuY2hvciAoc3RyaW5nKSBb4oCcYHN0YXJ0YOKAnSwg4oCcYG1pZGRsZWDigJ0sIOKAnGBlbmRg4oCdXSwgZGVmYXVsdCBpcyDigJxgbWlkZGxlYOKAnVxuICAgICBvIHRpdGxlIChzdHJpbmcpIHdpbGwgY3JlYXRlIHRvb2x0aXAgd2l0aCBhIGdpdmVuIHRleHRcbiAgICAgbyB0cmFuc2Zvcm0gKHN0cmluZykgc2VlIEBFbGVtZW50LnRyYW5zZm9ybVxuICAgICBvIHdpZHRoIChudW1iZXIpXG4gICAgIG8geCAobnVtYmVyKVxuICAgICBvIHkgKG51bWJlcilcbiAgICAgPiBHcmFkaWVudHNcbiAgICAgKiBMaW5lYXIgZ3JhZGllbnQgZm9ybWF0OiDigJxg4oC5YW5nbGXigLot4oC5Y29sb3Vy4oC6Wy3igLljb2xvdXLigLpbOuKAuW9mZnNldOKAul1dKi3igLljb2xvdXLigLpg4oCdLCBleGFtcGxlOiDigJxgOTAtI2ZmZi0jMDAwYOKAnSDigJMgOTDCsFxuICAgICAqIGdyYWRpZW50IGZyb20gd2hpdGUgdG8gYmxhY2sgb3Ig4oCcYDAtI2ZmZi0jZjAwOjIwLSMwMDBg4oCdIOKAkyAwwrAgZ3JhZGllbnQgZnJvbSB3aGl0ZSB2aWEgcmVkIChhdCAyMCUpIHRvIGJsYWNrLlxuICAgICAqXG4gICAgICogcmFkaWFsIGdyYWRpZW50OiDigJxgclso4oC5ZnjigLosIOKAuWZ54oC6KV3igLljb2xvdXLigLpbLeKAuWNvbG91cuKAuls64oC5b2Zmc2V04oC6XV0qLeKAuWNvbG91cuKAumDigJ0sIGV4YW1wbGU6IOKAnGByI2ZmZi0jMDAwYOKAnSDigJNcbiAgICAgKiBncmFkaWVudCBmcm9tIHdoaXRlIHRvIGJsYWNrIG9yIOKAnGByKDAuMjUsIDAuNzUpI2ZmZi0jMDAwYOKAnSDigJMgZ3JhZGllbnQgZnJvbSB3aGl0ZSB0byBibGFjayB3aXRoIGZvY3VzIHBvaW50XG4gICAgICogYXQgMC4yNSwgMC43NS4gRm9jdXMgcG9pbnQgY29vcmRpbmF0ZXMgYXJlIGluIDAuLjEgcmFuZ2UuIFJhZGlhbCBncmFkaWVudHMgY2FuIG9ubHkgYmUgYXBwbGllZCB0byBjaXJjbGVzIGFuZCBlbGxpcHNlcy5cbiAgICAgPiBQYXRoIFN0cmluZ1xuICAgICAjIDxwPlBsZWFzZSByZWZlciB0byA8YSBocmVmPVwiaHR0cDovL3d3dy53My5vcmcvVFIvU1ZHL3BhdGhzLmh0bWwjUGF0aERhdGFcIiB0aXRsZT1cIkRldGFpbHMgb2YgYSBwYXRo4oCZcyBkYXRhIGF0dHJpYnV0ZeKAmXMgZm9ybWF0IGFyZSBkZXNjcmliZWQgaW4gdGhlIFNWRyBzcGVjaWZpY2F0aW9uLlwiPlNWRyBkb2N1bWVudGF0aW9uIHJlZ2FyZGluZyBwYXRoIHN0cmluZzwvYT4uIFJhcGhhw6tsIGZ1bGx5IHN1cHBvcnRzIGl0LjwvcD5cbiAgICAgPiBDb2xvdXIgUGFyc2luZ1xuICAgICAjIDx1bD5cbiAgICAgIyAgICAgPGxpPkNvbG91ciBuYW1lICjigJw8Y29kZT5yZWQ8L2NvZGU+4oCdLCDigJw8Y29kZT5ncmVlbjwvY29kZT7igJ0sIOKAnDxjb2RlPmNvcm5mbG93ZXJibHVlPC9jb2RlPuKAnSwgZXRjKTwvbGk+XG4gICAgICMgICAgIDxsaT4j4oCi4oCi4oCiIOKAlCBzaG9ydGVuZWQgSFRNTCBjb2xvdXI6ICjigJw8Y29kZT4jMDAwPC9jb2RlPuKAnSwg4oCcPGNvZGU+I2ZjMDwvY29kZT7igJ0sIGV0Yyk8L2xpPlxuICAgICAjICAgICA8bGk+I+KAouKAouKAouKAouKAouKAoiDigJQgZnVsbCBsZW5ndGggSFRNTCBjb2xvdXI6ICjigJw8Y29kZT4jMDAwMDAwPC9jb2RlPuKAnSwg4oCcPGNvZGU+I2JkMjMwMDwvY29kZT7igJ0pPC9saT5cbiAgICAgIyAgICAgPGxpPnJnYijigKLigKLigKIsIOKAouKAouKAoiwg4oCi4oCi4oCiKSDigJQgcmVkLCBncmVlbiBhbmQgYmx1ZSBjaGFubmVsc+KAmSB2YWx1ZXM6ICjigJw8Y29kZT5yZ2IoMjAwLCZuYnNwOzEwMCwmbmJzcDswKTwvY29kZT7igJ0pPC9saT5cbiAgICAgIyAgICAgPGxpPnJnYijigKLigKLigKIlLCDigKLigKLigKIlLCDigKLigKLigKIlKSDigJQgc2FtZSBhcyBhYm92ZSwgYnV0IGluICU6ICjigJw8Y29kZT5yZ2IoMTAwJSwmbmJzcDsxNzUlLCZuYnNwOzAlKTwvY29kZT7igJ0pPC9saT5cbiAgICAgIyAgICAgPGxpPnJnYmEo4oCi4oCi4oCiLCDigKLigKLigKIsIOKAouKAouKAoiwg4oCi4oCi4oCiKSDigJQgcmVkLCBncmVlbiBhbmQgYmx1ZSBjaGFubmVsc+KAmSB2YWx1ZXM6ICjigJw8Y29kZT5yZ2JhKDIwMCwmbmJzcDsxMDAsJm5ic3A7MCwgLjUpPC9jb2RlPuKAnSk8L2xpPlxuICAgICAjICAgICA8bGk+cmdiYSjigKLigKLigKIlLCDigKLigKLigKIlLCDigKLigKLigKIlLCDigKLigKLigKIlKSDigJQgc2FtZSBhcyBhYm92ZSwgYnV0IGluICU6ICjigJw8Y29kZT5yZ2JhKDEwMCUsJm5ic3A7MTc1JSwmbmJzcDswJSwgNTAlKTwvY29kZT7igJ0pPC9saT5cbiAgICAgIyAgICAgPGxpPmhzYijigKLigKLigKIsIOKAouKAouKAoiwg4oCi4oCi4oCiKSDigJQgaHVlLCBzYXR1cmF0aW9uIGFuZCBicmlnaHRuZXNzIHZhbHVlczogKOKAnDxjb2RlPmhzYigwLjUsJm5ic3A7MC4yNSwmbmJzcDsxKTwvY29kZT7igJ0pPC9saT5cbiAgICAgIyAgICAgPGxpPmhzYijigKLigKLigKIlLCDigKLigKLigKIlLCDigKLigKLigKIlKSDigJQgc2FtZSBhcyBhYm92ZSwgYnV0IGluICU8L2xpPlxuICAgICAjICAgICA8bGk+aHNiYSjigKLigKLigKIsIOKAouKAouKAoiwg4oCi4oCi4oCiLCDigKLigKLigKIpIOKAlCBzYW1lIGFzIGFib3ZlLCBidXQgd2l0aCBvcGFjaXR5PC9saT5cbiAgICAgIyAgICAgPGxpPmhzbCjigKLigKLigKIsIOKAouKAouKAoiwg4oCi4oCi4oCiKSDigJQgYWxtb3N0IHRoZSBzYW1lIGFzIGhzYiwgc2VlIDxhIGhyZWY9XCJodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0hTTF9hbmRfSFNWXCIgdGl0bGU9XCJIU0wgYW5kIEhTViAtIFdpa2lwZWRpYSwgdGhlIGZyZWUgZW5jeWNsb3BlZGlhXCI+V2lraXBlZGlhIHBhZ2U8L2E+PC9saT5cbiAgICAgIyAgICAgPGxpPmhzbCjigKLigKLigKIlLCDigKLigKLigKIlLCDigKLigKLigKIlKSDigJQgc2FtZSBhcyBhYm92ZSwgYnV0IGluICU8L2xpPlxuICAgICAjICAgICA8bGk+aHNsYSjigKLigKLigKIsIOKAouKAouKAoiwg4oCi4oCi4oCiLCDigKLigKLigKIpIOKAlCBzYW1lIGFzIGFib3ZlLCBidXQgd2l0aCBvcGFjaXR5PC9saT5cbiAgICAgIyAgICAgPGxpPk9wdGlvbmFsbHkgZm9yIGhzYiBhbmQgaHNsIHlvdSBjb3VsZCBzcGVjaWZ5IGh1ZSBhcyBhIGRlZ3JlZTog4oCcPGNvZGU+aHNsKDI0MGRlZywmbmJzcDsxLCZuYnNwOy41KTwvY29kZT7igJ0gb3IsIGlmIHlvdSB3YW50IHRvIGdvIGZhbmN5LCDigJw8Y29kZT5oc2woMjQwwrAsJm5ic3A7MSwmbmJzcDsuNSk8L2NvZGU+4oCdPC9saT5cbiAgICAgIyA8L3VsPlxuICAgIFxcKi9cbiAgICBlbHByb3RvLmF0dHIgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMucmVtb3ZlZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5hbWUgPT0gbnVsbCkge1xuICAgICAgICAgICAgdmFyIHJlcyA9IHt9O1xuICAgICAgICAgICAgZm9yICh2YXIgYSBpbiB0aGlzLmF0dHJzKSBpZiAodGhpcy5hdHRyc1toYXNdKGEpKSB7XG4gICAgICAgICAgICAgICAgcmVzW2FdID0gdGhpcy5hdHRyc1thXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlcy5ncmFkaWVudCAmJiByZXMuZmlsbCA9PSBcIm5vbmVcIiAmJiAocmVzLmZpbGwgPSByZXMuZ3JhZGllbnQpICYmIGRlbGV0ZSByZXMuZ3JhZGllbnQ7XG4gICAgICAgICAgICByZXMudHJhbnNmb3JtID0gdGhpcy5fLnRyYW5zZm9ybTtcbiAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZhbHVlID09IG51bGwgJiYgUi5pcyhuYW1lLCBcInN0cmluZ1wiKSkge1xuICAgICAgICAgICAgaWYgKG5hbWUgPT0gXCJmaWxsXCIgJiYgdGhpcy5hdHRycy5maWxsID09IFwibm9uZVwiICYmIHRoaXMuYXR0cnMuZ3JhZGllbnQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hdHRycy5ncmFkaWVudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChuYW1lID09IFwidHJhbnNmb3JtXCIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fLnRyYW5zZm9ybTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBuYW1lcyA9IG5hbWUuc3BsaXQoc2VwYXJhdG9yKSxcbiAgICAgICAgICAgICAgICBvdXQgPSB7fTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IG5hbWVzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcbiAgICAgICAgICAgICAgICBuYW1lID0gbmFtZXNbaV07XG4gICAgICAgICAgICAgICAgaWYgKG5hbWUgaW4gdGhpcy5hdHRycykge1xuICAgICAgICAgICAgICAgICAgICBvdXRbbmFtZV0gPSB0aGlzLmF0dHJzW25hbWVdO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoUi5pcyh0aGlzLnBhcGVyLmN1c3RvbUF0dHJpYnV0ZXNbbmFtZV0sIFwiZnVuY3Rpb25cIikpIHtcbiAgICAgICAgICAgICAgICAgICAgb3V0W25hbWVdID0gdGhpcy5wYXBlci5jdXN0b21BdHRyaWJ1dGVzW25hbWVdLmRlZjtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBvdXRbbmFtZV0gPSBSLl9hdmFpbGFibGVBdHRyc1tuYW1lXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gaWkgLSAxID8gb3V0IDogb3V0W25hbWVzWzBdXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodmFsdWUgPT0gbnVsbCAmJiBSLmlzKG5hbWUsIFwiYXJyYXlcIikpIHtcbiAgICAgICAgICAgIG91dCA9IHt9O1xuICAgICAgICAgICAgZm9yIChpID0gMCwgaWkgPSBuYW1lLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcbiAgICAgICAgICAgICAgICBvdXRbbmFtZVtpXV0gPSB0aGlzLmF0dHIobmFtZVtpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gb3V0O1xuICAgICAgICB9XG4gICAgICAgIGlmICh2YWx1ZSAhPSBudWxsKSB7XG4gICAgICAgICAgICB2YXIgcGFyYW1zID0ge307XG4gICAgICAgICAgICBwYXJhbXNbbmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgfSBlbHNlIGlmIChuYW1lICE9IG51bGwgJiYgUi5pcyhuYW1lLCBcIm9iamVjdFwiKSkge1xuICAgICAgICAgICAgcGFyYW1zID0gbmFtZTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBrZXkgaW4gcGFyYW1zKSB7XG4gICAgICAgICAgICBldmUoXCJyYXBoYWVsLmF0dHIuXCIgKyBrZXkgKyBcIi5cIiArIHRoaXMuaWQsIHRoaXMsIHBhcmFtc1trZXldKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGtleSBpbiB0aGlzLnBhcGVyLmN1c3RvbUF0dHJpYnV0ZXMpIGlmICh0aGlzLnBhcGVyLmN1c3RvbUF0dHJpYnV0ZXNbaGFzXShrZXkpICYmIHBhcmFtc1toYXNdKGtleSkgJiYgUi5pcyh0aGlzLnBhcGVyLmN1c3RvbUF0dHJpYnV0ZXNba2V5XSwgXCJmdW5jdGlvblwiKSkge1xuICAgICAgICAgICAgdmFyIHBhciA9IHRoaXMucGFwZXIuY3VzdG9tQXR0cmlidXRlc1trZXldLmFwcGx5KHRoaXMsIFtdLmNvbmNhdChwYXJhbXNba2V5XSkpO1xuICAgICAgICAgICAgdGhpcy5hdHRyc1trZXldID0gcGFyYW1zW2tleV07XG4gICAgICAgICAgICBmb3IgKHZhciBzdWJrZXkgaW4gcGFyKSBpZiAocGFyW2hhc10oc3Via2V5KSkge1xuICAgICAgICAgICAgICAgIHBhcmFtc1tzdWJrZXldID0gcGFyW3N1YmtleV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgc2V0RmlsbEFuZFN0cm9rZSh0aGlzLCBwYXJhbXMpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIC8qXFxcbiAgICAgKiBFbGVtZW50LnRvRnJvbnRcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIE1vdmVzIHRoZSBlbGVtZW50IHNvIGl0IGlzIHRoZSBjbG9zZXN0IHRvIHRoZSB2aWV3ZXLigJlzIGV5ZXMsIG9uIHRvcCBvZiBvdGhlciBlbGVtZW50cy5cbiAgICAgPSAob2JqZWN0KSBARWxlbWVudFxuICAgIFxcKi9cbiAgICBlbHByb3RvLnRvRnJvbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnJlbW92ZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIHZhciBub2RlID0gZ2V0UmVhbE5vZGUodGhpcy5ub2RlKTtcbiAgICAgICAgbm9kZS5wYXJlbnROb2RlLmFwcGVuZENoaWxkKG5vZGUpO1xuICAgICAgICB2YXIgc3ZnID0gdGhpcy5wYXBlcjtcbiAgICAgICAgc3ZnLnRvcCAhPSB0aGlzICYmIFIuX3RvZnJvbnQodGhpcywgc3ZnKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICAvKlxcXG4gICAgICogRWxlbWVudC50b0JhY2tcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIE1vdmVzIHRoZSBlbGVtZW50IHNvIGl0IGlzIHRoZSBmdXJ0aGVzdCBmcm9tIHRoZSB2aWV3ZXLigJlzIGV5ZXMsIGJlaGluZCBvdGhlciBlbGVtZW50cy5cbiAgICAgPSAob2JqZWN0KSBARWxlbWVudFxuICAgIFxcKi9cbiAgICBlbHByb3RvLnRvQmFjayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMucmVtb3ZlZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG5vZGUgPSBnZXRSZWFsTm9kZSh0aGlzLm5vZGUpO1xuICAgICAgICB2YXIgcGFyZW50Tm9kZSA9IG5vZGUucGFyZW50Tm9kZTtcbiAgICAgICAgcGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUobm9kZSwgcGFyZW50Tm9kZS5maXJzdENoaWxkKTtcbiAgICAgICAgUi5fdG9iYWNrKHRoaXMsIHRoaXMucGFwZXIpO1xuICAgICAgICB2YXIgc3ZnID0gdGhpcy5wYXBlcjtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICAvKlxcXG4gICAgICogRWxlbWVudC5pbnNlcnRBZnRlclxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogSW5zZXJ0cyBjdXJyZW50IG9iamVjdCBhZnRlciB0aGUgZ2l2ZW4gb25lLlxuICAgICA9IChvYmplY3QpIEBFbGVtZW50XG4gICAgXFwqL1xuICAgIGVscHJvdG8uaW5zZXJ0QWZ0ZXIgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICBpZiAodGhpcy5yZW1vdmVkIHx8ICFlbGVtZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBub2RlID0gZ2V0UmVhbE5vZGUodGhpcy5ub2RlKTtcbiAgICAgICAgdmFyIGFmdGVyTm9kZSA9IGdldFJlYWxOb2RlKGVsZW1lbnQubm9kZSB8fCBlbGVtZW50W2VsZW1lbnQubGVuZ3RoIC0gMV0ubm9kZSk7XG4gICAgICAgIGlmIChhZnRlck5vZGUubmV4dFNpYmxpbmcpIHtcbiAgICAgICAgICAgIGFmdGVyTm9kZS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShub2RlLCBhZnRlck5vZGUubmV4dFNpYmxpbmcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYWZ0ZXJOb2RlLnBhcmVudE5vZGUuYXBwZW5kQ2hpbGQobm9kZSk7XG4gICAgICAgIH1cbiAgICAgICAgUi5faW5zZXJ0YWZ0ZXIodGhpcywgZWxlbWVudCwgdGhpcy5wYXBlcik7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIEVsZW1lbnQuaW5zZXJ0QmVmb3JlXG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBJbnNlcnRzIGN1cnJlbnQgb2JqZWN0IGJlZm9yZSB0aGUgZ2l2ZW4gb25lLlxuICAgICA9IChvYmplY3QpIEBFbGVtZW50XG4gICAgXFwqL1xuICAgIGVscHJvdG8uaW5zZXJ0QmVmb3JlID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgaWYgKHRoaXMucmVtb3ZlZCB8fCAhZWxlbWVudCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgbm9kZSA9IGdldFJlYWxOb2RlKHRoaXMubm9kZSk7XG4gICAgICAgIHZhciBiZWZvcmVOb2RlID0gZ2V0UmVhbE5vZGUoZWxlbWVudC5ub2RlIHx8IGVsZW1lbnRbMF0ubm9kZSk7XG4gICAgICAgIGJlZm9yZU5vZGUucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUobm9kZSwgYmVmb3JlTm9kZSk7XG4gICAgICAgIFIuX2luc2VydGJlZm9yZSh0aGlzLCBlbGVtZW50LCB0aGlzLnBhcGVyKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBlbHByb3RvLmJsdXIgPSBmdW5jdGlvbiAoc2l6ZSkge1xuICAgICAgICAvLyBFeHBlcmltZW50YWwuIE5vIFNhZmFyaSBzdXBwb3J0LiBVc2UgaXQgb24geW91ciBvd24gcmlzay5cbiAgICAgICAgdmFyIHQgPSB0aGlzO1xuICAgICAgICBpZiAoK3NpemUgIT09IDApIHtcbiAgICAgICAgICAgIHZhciBmbHRyID0gJChcImZpbHRlclwiKSxcbiAgICAgICAgICAgICAgICBibHVyID0gJChcImZlR2F1c3NpYW5CbHVyXCIpO1xuICAgICAgICAgICAgdC5hdHRycy5ibHVyID0gc2l6ZTtcbiAgICAgICAgICAgIGZsdHIuaWQgPSBSLmNyZWF0ZVVVSUQoKTtcbiAgICAgICAgICAgICQoYmx1ciwge3N0ZERldmlhdGlvbjogK3NpemUgfHwgMS41fSk7XG4gICAgICAgICAgICBmbHRyLmFwcGVuZENoaWxkKGJsdXIpO1xuICAgICAgICAgICAgdC5wYXBlci5kZWZzLmFwcGVuZENoaWxkKGZsdHIpO1xuICAgICAgICAgICAgdC5fYmx1ciA9IGZsdHI7XG4gICAgICAgICAgICAkKHQubm9kZSwge2ZpbHRlcjogXCJ1cmwoI1wiICsgZmx0ci5pZCArIFwiKVwifSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAodC5fYmx1cikge1xuICAgICAgICAgICAgICAgIHQuX2JsdXIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0Ll9ibHVyKTtcbiAgICAgICAgICAgICAgICBkZWxldGUgdC5fYmx1cjtcbiAgICAgICAgICAgICAgICBkZWxldGUgdC5hdHRycy5ibHVyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdC5ub2RlLnJlbW92ZUF0dHJpYnV0ZShcImZpbHRlclwiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdDtcbiAgICB9O1xuICAgIFIuX2VuZ2luZS5jaXJjbGUgPSBmdW5jdGlvbiAoc3ZnLCB4LCB5LCByKSB7XG4gICAgICAgIHZhciBlbCA9ICQoXCJjaXJjbGVcIik7XG4gICAgICAgIHN2Zy5jYW52YXMgJiYgc3ZnLmNhbnZhcy5hcHBlbmRDaGlsZChlbCk7XG4gICAgICAgIHZhciByZXMgPSBuZXcgRWxlbWVudChlbCwgc3ZnKTtcbiAgICAgICAgcmVzLmF0dHJzID0ge2N4OiB4LCBjeTogeSwgcjogciwgZmlsbDogXCJub25lXCIsIHN0cm9rZTogXCIjMDAwXCJ9O1xuICAgICAgICByZXMudHlwZSA9IFwiY2lyY2xlXCI7XG4gICAgICAgICQoZWwsIHJlcy5hdHRycyk7XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfTtcbiAgICBSLl9lbmdpbmUucmVjdCA9IGZ1bmN0aW9uIChzdmcsIHgsIHksIHcsIGgsIHIpIHtcbiAgICAgICAgdmFyIGVsID0gJChcInJlY3RcIik7XG4gICAgICAgIHN2Zy5jYW52YXMgJiYgc3ZnLmNhbnZhcy5hcHBlbmRDaGlsZChlbCk7XG4gICAgICAgIHZhciByZXMgPSBuZXcgRWxlbWVudChlbCwgc3ZnKTtcbiAgICAgICAgcmVzLmF0dHJzID0ge3g6IHgsIHk6IHksIHdpZHRoOiB3LCBoZWlnaHQ6IGgsIHJ4OiByIHx8IDAsIHJ5OiByIHx8IDAsIGZpbGw6IFwibm9uZVwiLCBzdHJva2U6IFwiIzAwMFwifTtcbiAgICAgICAgcmVzLnR5cGUgPSBcInJlY3RcIjtcbiAgICAgICAgJChlbCwgcmVzLmF0dHJzKTtcbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9O1xuICAgIFIuX2VuZ2luZS5lbGxpcHNlID0gZnVuY3Rpb24gKHN2ZywgeCwgeSwgcngsIHJ5KSB7XG4gICAgICAgIHZhciBlbCA9ICQoXCJlbGxpcHNlXCIpO1xuICAgICAgICBzdmcuY2FudmFzICYmIHN2Zy5jYW52YXMuYXBwZW5kQ2hpbGQoZWwpO1xuICAgICAgICB2YXIgcmVzID0gbmV3IEVsZW1lbnQoZWwsIHN2Zyk7XG4gICAgICAgIHJlcy5hdHRycyA9IHtjeDogeCwgY3k6IHksIHJ4OiByeCwgcnk6IHJ5LCBmaWxsOiBcIm5vbmVcIiwgc3Ryb2tlOiBcIiMwMDBcIn07XG4gICAgICAgIHJlcy50eXBlID0gXCJlbGxpcHNlXCI7XG4gICAgICAgICQoZWwsIHJlcy5hdHRycyk7XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfTtcbiAgICBSLl9lbmdpbmUuaW1hZ2UgPSBmdW5jdGlvbiAoc3ZnLCBzcmMsIHgsIHksIHcsIGgpIHtcbiAgICAgICAgdmFyIGVsID0gJChcImltYWdlXCIpO1xuICAgICAgICAkKGVsLCB7eDogeCwgeTogeSwgd2lkdGg6IHcsIGhlaWdodDogaCwgcHJlc2VydmVBc3BlY3RSYXRpbzogXCJub25lXCJ9KTtcbiAgICAgICAgZWwuc2V0QXR0cmlidXRlTlMoeGxpbmssIFwiaHJlZlwiLCBzcmMpO1xuICAgICAgICBzdmcuY2FudmFzICYmIHN2Zy5jYW52YXMuYXBwZW5kQ2hpbGQoZWwpO1xuICAgICAgICB2YXIgcmVzID0gbmV3IEVsZW1lbnQoZWwsIHN2Zyk7XG4gICAgICAgIHJlcy5hdHRycyA9IHt4OiB4LCB5OiB5LCB3aWR0aDogdywgaGVpZ2h0OiBoLCBzcmM6IHNyY307XG4gICAgICAgIHJlcy50eXBlID0gXCJpbWFnZVwiO1xuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH07XG4gICAgUi5fZW5naW5lLnRleHQgPSBmdW5jdGlvbiAoc3ZnLCB4LCB5LCB0ZXh0KSB7XG4gICAgICAgIHZhciBlbCA9ICQoXCJ0ZXh0XCIpO1xuICAgICAgICBzdmcuY2FudmFzICYmIHN2Zy5jYW52YXMuYXBwZW5kQ2hpbGQoZWwpO1xuICAgICAgICB2YXIgcmVzID0gbmV3IEVsZW1lbnQoZWwsIHN2Zyk7XG4gICAgICAgIHJlcy5hdHRycyA9IHtcbiAgICAgICAgICAgIHg6IHgsXG4gICAgICAgICAgICB5OiB5LFxuICAgICAgICAgICAgXCJ0ZXh0LWFuY2hvclwiOiBcIm1pZGRsZVwiLFxuICAgICAgICAgICAgdGV4dDogdGV4dCxcbiAgICAgICAgICAgIFwiZm9udC1mYW1pbHlcIjogUi5fYXZhaWxhYmxlQXR0cnNbXCJmb250LWZhbWlseVwiXSxcbiAgICAgICAgICAgIFwiZm9udC1zaXplXCI6IFIuX2F2YWlsYWJsZUF0dHJzW1wiZm9udC1zaXplXCJdLFxuICAgICAgICAgICAgc3Ryb2tlOiBcIm5vbmVcIixcbiAgICAgICAgICAgIGZpbGw6IFwiIzAwMFwiXG4gICAgICAgIH07XG4gICAgICAgIHJlcy50eXBlID0gXCJ0ZXh0XCI7XG4gICAgICAgIHNldEZpbGxBbmRTdHJva2UocmVzLCByZXMuYXR0cnMpO1xuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH07XG4gICAgUi5fZW5naW5lLnNldFNpemUgPSBmdW5jdGlvbiAod2lkdGgsIGhlaWdodCkge1xuICAgICAgICB0aGlzLndpZHRoID0gd2lkdGggfHwgdGhpcy53aWR0aDtcbiAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQgfHwgdGhpcy5oZWlnaHQ7XG4gICAgICAgIHRoaXMuY2FudmFzLnNldEF0dHJpYnV0ZShcIndpZHRoXCIsIHRoaXMud2lkdGgpO1xuICAgICAgICB0aGlzLmNhbnZhcy5zZXRBdHRyaWJ1dGUoXCJoZWlnaHRcIiwgdGhpcy5oZWlnaHQpO1xuICAgICAgICBpZiAodGhpcy5fdmlld0JveCkge1xuICAgICAgICAgICAgdGhpcy5zZXRWaWV3Qm94LmFwcGx5KHRoaXMsIHRoaXMuX3ZpZXdCb3gpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgUi5fZW5naW5lLmNyZWF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNvbiA9IFIuX2dldENvbnRhaW5lci5hcHBseSgwLCBhcmd1bWVudHMpLFxuICAgICAgICAgICAgY29udGFpbmVyID0gY29uICYmIGNvbi5jb250YWluZXI7XG4gICAgICAgIGlmICghY29udGFpbmVyKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJTVkcgY29udGFpbmVyIG5vdCBmb3VuZC5cIik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHggPSBjb24ueCxcbiAgICAgICAgICAgIHkgPSBjb24ueSxcbiAgICAgICAgICAgIHdpZHRoID0gY29uLndpZHRoLFxuICAgICAgICAgICAgaGVpZ2h0ID0gY29uLmhlaWdodCxcbiAgICAgICAgICAgIGNudnMgPSAkKFwic3ZnXCIpLFxuICAgICAgICAgICAgY3NzID0gXCJvdmVyZmxvdzpoaWRkZW47XCIsXG4gICAgICAgICAgICBpc0Zsb2F0aW5nO1xuICAgICAgICB4ID0geCB8fCAwO1xuICAgICAgICB5ID0geSB8fCAwO1xuICAgICAgICB3aWR0aCA9IHdpZHRoIHx8IDUxMjtcbiAgICAgICAgaGVpZ2h0ID0gaGVpZ2h0IHx8IDM0MjtcbiAgICAgICAgJChjbnZzLCB7XG4gICAgICAgICAgICBoZWlnaHQ6IGhlaWdodCxcbiAgICAgICAgICAgIHZlcnNpb246IDEuMSxcbiAgICAgICAgICAgIHdpZHRoOiB3aWR0aCxcbiAgICAgICAgICAgIHhtbG5zOiBcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIsXG4gICAgICAgICAgICBcInhtbG5zOnhsaW5rXCI6IFwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGlua1wiXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoY29udGFpbmVyID09IDEpIHtcbiAgICAgICAgICAgIGNudnMuc3R5bGUuY3NzVGV4dCA9IGNzcyArIFwicG9zaXRpb246YWJzb2x1dGU7bGVmdDpcIiArIHggKyBcInB4O3RvcDpcIiArIHkgKyBcInB4XCI7XG4gICAgICAgICAgICBSLl9nLmRvYy5ib2R5LmFwcGVuZENoaWxkKGNudnMpO1xuICAgICAgICAgICAgaXNGbG9hdGluZyA9IDE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjbnZzLnN0eWxlLmNzc1RleHQgPSBjc3MgKyBcInBvc2l0aW9uOnJlbGF0aXZlXCI7XG4gICAgICAgICAgICBpZiAoY29udGFpbmVyLmZpcnN0Q2hpbGQpIHtcbiAgICAgICAgICAgICAgICBjb250YWluZXIuaW5zZXJ0QmVmb3JlKGNudnMsIGNvbnRhaW5lci5maXJzdENoaWxkKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGNudnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnRhaW5lciA9IG5ldyBSLl9QYXBlcjtcbiAgICAgICAgY29udGFpbmVyLndpZHRoID0gd2lkdGg7XG4gICAgICAgIGNvbnRhaW5lci5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgICAgIGNvbnRhaW5lci5jYW52YXMgPSBjbnZzO1xuICAgICAgICBjb250YWluZXIuY2xlYXIoKTtcbiAgICAgICAgY29udGFpbmVyLl9sZWZ0ID0gY29udGFpbmVyLl90b3AgPSAwO1xuICAgICAgICBpc0Zsb2F0aW5nICYmIChjb250YWluZXIucmVuZGVyZml4ID0gZnVuY3Rpb24gKCkge30pO1xuICAgICAgICBjb250YWluZXIucmVuZGVyZml4KCk7XG4gICAgICAgIHJldHVybiBjb250YWluZXI7XG4gICAgfTtcbiAgICBSLl9lbmdpbmUuc2V0Vmlld0JveCA9IGZ1bmN0aW9uICh4LCB5LCB3LCBoLCBmaXQpIHtcbiAgICAgICAgZXZlKFwicmFwaGFlbC5zZXRWaWV3Qm94XCIsIHRoaXMsIHRoaXMuX3ZpZXdCb3gsIFt4LCB5LCB3LCBoLCBmaXRdKTtcbiAgICAgICAgdmFyIHBhcGVyU2l6ZSA9IHRoaXMuZ2V0U2l6ZSgpLFxuICAgICAgICAgICAgc2l6ZSA9IG1tYXgodyAvIHBhcGVyU2l6ZS53aWR0aCwgaCAvIHBhcGVyU2l6ZS5oZWlnaHQpLFxuICAgICAgICAgICAgdG9wID0gdGhpcy50b3AsXG4gICAgICAgICAgICBhc3BlY3RSYXRpbyA9IGZpdCA/IFwieE1pZFlNaWQgbWVldFwiIDogXCJ4TWluWU1pblwiLFxuICAgICAgICAgICAgdmIsXG4gICAgICAgICAgICBzdztcbiAgICAgICAgaWYgKHggPT0gbnVsbCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3ZiU2l6ZSkge1xuICAgICAgICAgICAgICAgIHNpemUgPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVsZXRlIHRoaXMuX3ZiU2l6ZTtcbiAgICAgICAgICAgIHZiID0gXCIwIDAgXCIgKyB0aGlzLndpZHRoICsgUyArIHRoaXMuaGVpZ2h0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fdmJTaXplID0gc2l6ZTtcbiAgICAgICAgICAgIHZiID0geCArIFMgKyB5ICsgUyArIHcgKyBTICsgaDtcbiAgICAgICAgfVxuICAgICAgICAkKHRoaXMuY2FudmFzLCB7XG4gICAgICAgICAgICB2aWV3Qm94OiB2YixcbiAgICAgICAgICAgIHByZXNlcnZlQXNwZWN0UmF0aW86IGFzcGVjdFJhdGlvXG4gICAgICAgIH0pO1xuICAgICAgICB3aGlsZSAoc2l6ZSAmJiB0b3ApIHtcbiAgICAgICAgICAgIHN3ID0gXCJzdHJva2Utd2lkdGhcIiBpbiB0b3AuYXR0cnMgPyB0b3AuYXR0cnNbXCJzdHJva2Utd2lkdGhcIl0gOiAxO1xuICAgICAgICAgICAgdG9wLmF0dHIoe1wic3Ryb2tlLXdpZHRoXCI6IHN3fSk7XG4gICAgICAgICAgICB0b3AuXy5kaXJ0eSA9IDE7XG4gICAgICAgICAgICB0b3AuXy5kaXJ0eVQgPSAxO1xuICAgICAgICAgICAgdG9wID0gdG9wLnByZXY7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fdmlld0JveCA9IFt4LCB5LCB3LCBoLCAhIWZpdF07XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIFBhcGVyLnJlbmRlcmZpeFxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogRml4ZXMgdGhlIGlzc3VlIG9mIEZpcmVmb3ggYW5kIElFOSByZWdhcmRpbmcgc3VicGl4ZWwgcmVuZGVyaW5nLiBJZiBwYXBlciBpcyBkZXBlbmRlbnRcbiAgICAgKiBvbiBvdGhlciBlbGVtZW50cyBhZnRlciByZWZsb3cgaXQgY291bGQgc2hpZnQgaGFsZiBwaXhlbCB3aGljaCBjYXVzZSBmb3IgbGluZXMgdG8gbG9zdCB0aGVpciBjcmlzcG5lc3MuXG4gICAgICogVGhpcyBtZXRob2QgZml4ZXMgdGhlIGlzc3VlLlxuICAgICAqKlxuICAgICAgIFNwZWNpYWwgdGhhbmtzIHRvIE1hcml1c3ogTm93YWsgKGh0dHA6Ly93d3cubWVkaWtvby5jb20vKSBmb3IgdGhpcyBtZXRob2QuXG4gICAgXFwqL1xuICAgIFIucHJvdG90eXBlLnJlbmRlcmZpeCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNudnMgPSB0aGlzLmNhbnZhcyxcbiAgICAgICAgICAgIHMgPSBjbnZzLnN0eWxlLFxuICAgICAgICAgICAgcG9zO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcG9zID0gY252cy5nZXRTY3JlZW5DVE0oKSB8fCBjbnZzLmNyZWF0ZVNWR01hdHJpeCgpO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBwb3MgPSBjbnZzLmNyZWF0ZVNWR01hdHJpeCgpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBsZWZ0ID0gLXBvcy5lICUgMSxcbiAgICAgICAgICAgIHRvcCA9IC1wb3MuZiAlIDE7XG4gICAgICAgIGlmIChsZWZ0IHx8IHRvcCkge1xuICAgICAgICAgICAgaWYgKGxlZnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9sZWZ0ID0gKHRoaXMuX2xlZnQgKyBsZWZ0KSAlIDE7XG4gICAgICAgICAgICAgICAgcy5sZWZ0ID0gdGhpcy5fbGVmdCArIFwicHhcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0b3ApIHtcbiAgICAgICAgICAgICAgICB0aGlzLl90b3AgPSAodGhpcy5fdG9wICsgdG9wKSAlIDE7XG4gICAgICAgICAgICAgICAgcy50b3AgPSB0aGlzLl90b3AgKyBcInB4XCI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qXFxcbiAgICAgKiBQYXBlci5jbGVhclxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogQ2xlYXJzIHRoZSBwYXBlciwgaS5lLiByZW1vdmVzIGFsbCB0aGUgZWxlbWVudHMuXG4gICAgXFwqL1xuICAgIFIucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBSLmV2ZShcInJhcGhhZWwuY2xlYXJcIiwgdGhpcyk7XG4gICAgICAgIHZhciBjID0gdGhpcy5jYW52YXM7XG4gICAgICAgIHdoaWxlIChjLmZpcnN0Q2hpbGQpIHtcbiAgICAgICAgICAgIGMucmVtb3ZlQ2hpbGQoYy5maXJzdENoaWxkKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmJvdHRvbSA9IHRoaXMudG9wID0gbnVsbDtcbiAgICAgICAgKHRoaXMuZGVzYyA9ICQoXCJkZXNjXCIpKS5hcHBlbmRDaGlsZChSLl9nLmRvYy5jcmVhdGVUZXh0Tm9kZShcIkNyZWF0ZWQgd2l0aCBSYXBoYVxceGVibCBcIiArIFIudmVyc2lvbikpO1xuICAgICAgICBjLmFwcGVuZENoaWxkKHRoaXMuZGVzYyk7XG4gICAgICAgIGMuYXBwZW5kQ2hpbGQodGhpcy5kZWZzID0gJChcImRlZnNcIikpO1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIFBhcGVyLnJlbW92ZVxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogUmVtb3ZlcyB0aGUgcGFwZXIgZnJvbSB0aGUgRE9NLlxuICAgIFxcKi9cbiAgICBSLnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGV2ZShcInJhcGhhZWwucmVtb3ZlXCIsIHRoaXMpO1xuICAgICAgICB0aGlzLmNhbnZhcy5wYXJlbnROb2RlICYmIHRoaXMuY2FudmFzLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5jYW52YXMpO1xuICAgICAgICBmb3IgKHZhciBpIGluIHRoaXMpIHtcbiAgICAgICAgICAgIHRoaXNbaV0gPSB0eXBlb2YgdGhpc1tpXSA9PSBcImZ1bmN0aW9uXCIgPyBSLl9yZW1vdmVkRmFjdG9yeShpKSA6IG51bGw7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHZhciBzZXRwcm90byA9IFIuc3Q7XG4gICAgZm9yICh2YXIgbWV0aG9kIGluIGVscHJvdG8pIGlmIChlbHByb3RvW2hhc10obWV0aG9kKSAmJiAhc2V0cHJvdG9baGFzXShtZXRob2QpKSB7XG4gICAgICAgIHNldHByb3RvW21ldGhvZF0gPSAoZnVuY3Rpb24gKG1ldGhvZG5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGFyZyA9IGFyZ3VtZW50cztcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5mb3JFYWNoKGZ1bmN0aW9uIChlbCkge1xuICAgICAgICAgICAgICAgICAgICBlbFttZXRob2RuYW1lXS5hcHBseShlbCwgYXJnKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pKG1ldGhvZCk7XG4gICAgfVxufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./dev/raphael.svg.js\n')},"./dev/raphael.vml.js":function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(/*! ./raphael.core */ "./dev/raphael.core.js")], __WEBPACK_AMD_DEFINE_RESULT__ = (function(R) {\n    if (R && !R.vml) {\n        return;\n    }\n\n    var has = "hasOwnProperty",\n        Str = String,\n        toFloat = parseFloat,\n        math = Math,\n        round = math.round,\n        mmax = math.max,\n        mmin = math.min,\n        abs = math.abs,\n        fillString = "fill",\n        separator = /[, ]+/,\n        eve = R.eve,\n        ms = " progid:DXImageTransform.Microsoft",\n        S = " ",\n        E = "",\n        map = {M: "m", L: "l", C: "c", Z: "x", m: "t", l: "r", c: "v", z: "x"},\n        bites = /([clmz]),?([^clmz]*)/gi,\n        blurregexp = / progid:\\S+Blur\\([^\\)]+\\)/g,\n        val = /-?[^,\\s-]+/g,\n        cssDot = "position:absolute;left:0;top:0;width:1px;height:1px;behavior:url(#default#VML)",\n        zoom = 21600,\n        pathTypes = {path: 1, rect: 1, image: 1},\n        ovalTypes = {circle: 1, ellipse: 1},\n        path2vml = function (path) {\n            var total =  /[ahqstv]/ig,\n                command = R._pathToAbsolute;\n            Str(path).match(total) && (command = R._path2curve);\n            total = /[clmz]/g;\n            if (command == R._pathToAbsolute && !Str(path).match(total)) {\n                var res = Str(path).replace(bites, function (all, command, args) {\n                    var vals = [],\n                        isMove = command.toLowerCase() == "m",\n                        res = map[command];\n                    args.replace(val, function (value) {\n                        if (isMove && vals.length == 2) {\n                            res += vals + map[command == "m" ? "l" : "L"];\n                            vals = [];\n                        }\n                        vals.push(round(value * zoom));\n                    });\n                    return res + vals;\n                });\n                return res;\n            }\n            var pa = command(path), p, r;\n            res = [];\n            for (var i = 0, ii = pa.length; i < ii; i++) {\n                p = pa[i];\n                r = pa[i][0].toLowerCase();\n                r == "z" && (r = "x");\n                for (var j = 1, jj = p.length; j < jj; j++) {\n                    r += round(p[j] * zoom) + (j != jj - 1 ? "," : E);\n                }\n                res.push(r);\n            }\n            return res.join(S);\n        },\n        compensation = function (deg, dx, dy) {\n            var m = R.matrix();\n            m.rotate(-deg, .5, .5);\n            return {\n                dx: m.x(dx, dy),\n                dy: m.y(dx, dy)\n            };\n        },\n        setCoords = function (p, sx, sy, dx, dy, deg) {\n            var _ = p._,\n                m = p.matrix,\n                fillpos = _.fillpos,\n                o = p.node,\n                s = o.style,\n                y = 1,\n                flip = "",\n                dxdy,\n                kx = zoom / sx,\n                ky = zoom / sy;\n            s.visibility = "hidden";\n            if (!sx || !sy) {\n                return;\n            }\n            o.coordsize = abs(kx) + S + abs(ky);\n            s.rotation = deg * (sx * sy < 0 ? -1 : 1);\n            if (deg) {\n                var c = compensation(deg, dx, dy);\n                dx = c.dx;\n                dy = c.dy;\n            }\n            sx < 0 && (flip += "x");\n            sy < 0 && (flip += " y") && (y = -1);\n            s.flip = flip;\n            o.coordorigin = (dx * -kx) + S + (dy * -ky);\n            if (fillpos || _.fillsize) {\n                var fill = o.getElementsByTagName(fillString);\n                fill = fill && fill[0];\n                o.removeChild(fill);\n                if (fillpos) {\n                    c = compensation(deg, m.x(fillpos[0], fillpos[1]), m.y(fillpos[0], fillpos[1]));\n                    fill.position = c.dx * y + S + c.dy * y;\n                }\n                if (_.fillsize) {\n                    fill.size = _.fillsize[0] * abs(sx) + S + _.fillsize[1] * abs(sy);\n                }\n                o.appendChild(fill);\n            }\n            s.visibility = "visible";\n        };\n    R.toString = function () {\n        return  "Your browser doesn\\u2019t support SVG. Falling down to VML.\\nYou are running Rapha\\xebl " + this.version;\n    };\n    var addArrow = function (o, value, isEnd) {\n        var values = Str(value).toLowerCase().split("-"),\n            se = isEnd ? "end" : "start",\n            i = values.length,\n            type = "classic",\n            w = "medium",\n            h = "medium";\n        while (i--) {\n            switch (values[i]) {\n                case "block":\n                case "classic":\n                case "oval":\n                case "diamond":\n                case "open":\n                case "none":\n                    type = values[i];\n                    break;\n                case "wide":\n                case "narrow": h = values[i]; break;\n                case "long":\n                case "short": w = values[i]; break;\n            }\n        }\n        var stroke = o.node.getElementsByTagName("stroke")[0];\n        stroke[se + "arrow"] = type;\n        stroke[se + "arrowlength"] = w;\n        stroke[se + "arrowwidth"] = h;\n    },\n    setFillAndStroke = function (o, params) {\n        // o.paper.canvas.style.display = "none";\n        o.attrs = o.attrs || {};\n        var node = o.node,\n            a = o.attrs,\n            s = node.style,\n            xy,\n            newpath = pathTypes[o.type] && (params.x != a.x || params.y != a.y || params.width != a.width || params.height != a.height || params.cx != a.cx || params.cy != a.cy || params.rx != a.rx || params.ry != a.ry || params.r != a.r),\n            isOval = ovalTypes[o.type] && (a.cx != params.cx || a.cy != params.cy || a.r != params.r || a.rx != params.rx || a.ry != params.ry),\n            res = o;\n\n\n        for (var par in params) if (params[has](par)) {\n            a[par] = params[par];\n        }\n        if (newpath) {\n            a.path = R._getPath[o.type](o);\n            o._.dirty = 1;\n        }\n        params.href && (node.href = params.href);\n        params.title && (node.title = params.title);\n        params.target && (node.target = params.target);\n        params.cursor && (s.cursor = params.cursor);\n        "blur" in params && o.blur(params.blur);\n        if (params.path && o.type == "path" || newpath) {\n            node.path = path2vml(~Str(a.path).toLowerCase().indexOf("r") ? R._pathToAbsolute(a.path) : a.path);\n            o._.dirty = 1;\n            if (o.type == "image") {\n                o._.fillpos = [a.x, a.y];\n                o._.fillsize = [a.width, a.height];\n                setCoords(o, 1, 1, 0, 0, 0);\n            }\n        }\n        "transform" in params && o.transform(params.transform);\n        if (isOval) {\n            var cx = +a.cx,\n                cy = +a.cy,\n                rx = +a.rx || +a.r || 0,\n                ry = +a.ry || +a.r || 0;\n            node.path = R.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x", round((cx - rx) * zoom), round((cy - ry) * zoom), round((cx + rx) * zoom), round((cy + ry) * zoom), round(cx * zoom));\n            o._.dirty = 1;\n        }\n        if ("clip-rect" in params) {\n            var rect = Str(params["clip-rect"]).split(separator);\n            if (rect.length == 4) {\n                rect[2] = +rect[2] + (+rect[0]);\n                rect[3] = +rect[3] + (+rect[1]);\n                var div = node.clipRect || R._g.doc.createElement("div"),\n                    dstyle = div.style;\n                dstyle.clip = R.format("rect({1}px {2}px {3}px {0}px)", rect);\n                if (!node.clipRect) {\n                    dstyle.position = "absolute";\n                    dstyle.top = 0;\n                    dstyle.left = 0;\n                    dstyle.width = o.paper.width + "px";\n                    dstyle.height = o.paper.height + "px";\n                    node.parentNode.insertBefore(div, node);\n                    div.appendChild(node);\n                    node.clipRect = div;\n                }\n            }\n            if (!params["clip-rect"]) {\n                node.clipRect && (node.clipRect.style.clip = "auto");\n            }\n        }\n        if (o.textpath) {\n            var textpathStyle = o.textpath.style;\n            params.font && (textpathStyle.font = params.font);\n            params["font-family"] && (textpathStyle.fontFamily = \'"\' + params["font-family"].split(",")[0].replace(/^[\'"]+|[\'"]+$/g, E) + \'"\');\n            params["font-size"] && (textpathStyle.fontSize = params["font-size"]);\n            params["font-weight"] && (textpathStyle.fontWeight = params["font-weight"]);\n            params["font-style"] && (textpathStyle.fontStyle = params["font-style"]);\n        }\n        if ("arrow-start" in params) {\n            addArrow(res, params["arrow-start"]);\n        }\n        if ("arrow-end" in params) {\n            addArrow(res, params["arrow-end"], 1);\n        }\n        if (params.opacity != null ||\n            params.fill != null ||\n            params.src != null ||\n            params.stroke != null ||\n            params["stroke-width"] != null ||\n            params["stroke-opacity"] != null ||\n            params["fill-opacity"] != null ||\n            params["stroke-dasharray"] != null ||\n            params["stroke-miterlimit"] != null ||\n            params["stroke-linejoin"] != null ||\n            params["stroke-linecap"] != null) {\n            var fill = node.getElementsByTagName(fillString),\n                newfill = false;\n            fill = fill && fill[0];\n            !fill && (newfill = fill = createNode(fillString));\n            if (o.type == "image" && params.src) {\n                fill.src = params.src;\n            }\n            params.fill && (fill.on = true);\n            if (fill.on == null || params.fill == "none" || params.fill === null) {\n                fill.on = false;\n            }\n            if (fill.on && params.fill) {\n                var isURL = Str(params.fill).match(R._ISURL);\n                if (isURL) {\n                    fill.parentNode == node && node.removeChild(fill);\n                    fill.rotate = true;\n                    fill.src = isURL[1];\n                    fill.type = "tile";\n                    var bbox = o.getBBox(1);\n                    fill.position = bbox.x + S + bbox.y;\n                    o._.fillpos = [bbox.x, bbox.y];\n\n                    R._preload(isURL[1], function () {\n                        o._.fillsize = [this.offsetWidth, this.offsetHeight];\n                    });\n                } else {\n                    fill.color = R.getRGB(params.fill).hex;\n                    fill.src = E;\n                    fill.type = "solid";\n                    if (R.getRGB(params.fill).error && (res.type in {circle: 1, ellipse: 1} || Str(params.fill).charAt() != "r") && addGradientFill(res, params.fill, fill)) {\n                        a.fill = "none";\n                        a.gradient = params.fill;\n                        fill.rotate = false;\n                    }\n                }\n            }\n            if ("fill-opacity" in params || "opacity" in params) {\n                var opacity = ((+a["fill-opacity"] + 1 || 2) - 1) * ((+a.opacity + 1 || 2) - 1) * ((+R.getRGB(params.fill).o + 1 || 2) - 1);\n                opacity = mmin(mmax(opacity, 0), 1);\n                fill.opacity = opacity;\n                if (fill.src) {\n                    fill.color = "none";\n                }\n            }\n            node.appendChild(fill);\n            var stroke = (node.getElementsByTagName("stroke") && node.getElementsByTagName("stroke")[0]),\n            newstroke = false;\n            !stroke && (newstroke = stroke = createNode("stroke"));\n            if ((params.stroke && params.stroke != "none") ||\n                params["stroke-width"] ||\n                params["stroke-opacity"] != null ||\n                params["stroke-dasharray"] ||\n                params["stroke-miterlimit"] ||\n                params["stroke-linejoin"] ||\n                params["stroke-linecap"]) {\n                stroke.on = true;\n            }\n            (params.stroke == "none" || params.stroke === null || stroke.on == null || params.stroke == 0 || params["stroke-width"] == 0) && (stroke.on = false);\n            var strokeColor = R.getRGB(params.stroke);\n            stroke.on && params.stroke && (stroke.color = strokeColor.hex);\n            opacity = ((+a["stroke-opacity"] + 1 || 2) - 1) * ((+a.opacity + 1 || 2) - 1) * ((+strokeColor.o + 1 || 2) - 1);\n            var width = (toFloat(params["stroke-width"]) || 1) * .75;\n            opacity = mmin(mmax(opacity, 0), 1);\n            params["stroke-width"] == null && (width = a["stroke-width"]);\n            params["stroke-width"] && (stroke.weight = width);\n            width && width < 1 && (opacity *= width) && (stroke.weight = 1);\n            stroke.opacity = opacity;\n\n            params["stroke-linejoin"] && (stroke.joinstyle = params["stroke-linejoin"] || "miter");\n            stroke.miterlimit = params["stroke-miterlimit"] || 8;\n            params["stroke-linecap"] && (stroke.endcap = params["stroke-linecap"] == "butt" ? "flat" : params["stroke-linecap"] == "square" ? "square" : "round");\n            if ("stroke-dasharray" in params) {\n                var dasharray = {\n                    "-": "shortdash",\n                    ".": "shortdot",\n                    "-.": "shortdashdot",\n                    "-..": "shortdashdotdot",\n                    ". ": "dot",\n                    "- ": "dash",\n                    "--": "longdash",\n                    "- .": "dashdot",\n                    "--.": "longdashdot",\n                    "--..": "longdashdotdot"\n                };\n                stroke.dashstyle = dasharray[has](params["stroke-dasharray"]) ? dasharray[params["stroke-dasharray"]] : E;\n            }\n            newstroke && node.appendChild(stroke);\n        }\n        if (res.type == "text") {\n            res.paper.canvas.style.display = E;\n            var span = res.paper.span,\n                m = 100,\n                fontSize = a.font && a.font.match(/\\d+(?:\\.\\d*)?(?=px)/);\n            s = span.style;\n            a.font && (s.font = a.font);\n            a["font-family"] && (s.fontFamily = a["font-family"]);\n            a["font-weight"] && (s.fontWeight = a["font-weight"]);\n            a["font-style"] && (s.fontStyle = a["font-style"]);\n            fontSize = toFloat(a["font-size"] || fontSize && fontSize[0]) || 10;\n            s.fontSize = fontSize * m + "px";\n            res.textpath.string && (span.innerHTML = Str(res.textpath.string).replace(/</g, "&#60;").replace(/&/g, "&#38;").replace(/\\n/g, "<br>"));\n            var brect = span.getBoundingClientRect();\n            res.W = a.w = (brect.right - brect.left) / m;\n            res.H = a.h = (brect.bottom - brect.top) / m;\n            // res.paper.canvas.style.display = "none";\n            res.X = a.x;\n            res.Y = a.y + res.H / 2;\n\n            ("x" in params || "y" in params) && (res.path.v = R.format("m{0},{1}l{2},{1}", round(a.x * zoom), round(a.y * zoom), round(a.x * zoom) + 1));\n            var dirtyattrs = ["x", "y", "text", "font", "font-family", "font-weight", "font-style", "font-size"];\n            for (var d = 0, dd = dirtyattrs.length; d < dd; d++) if (dirtyattrs[d] in params) {\n                res._.dirty = 1;\n                break;\n            }\n\n            // text-anchor emulation\n            switch (a["text-anchor"]) {\n                case "start":\n                    res.textpath.style["v-text-align"] = "left";\n                    res.bbx = res.W / 2;\n                break;\n                case "end":\n                    res.textpath.style["v-text-align"] = "right";\n                    res.bbx = -res.W / 2;\n                break;\n                default:\n                    res.textpath.style["v-text-align"] = "center";\n                    res.bbx = 0;\n                break;\n            }\n            res.textpath.style["v-text-kern"] = true;\n        }\n        // res.paper.canvas.style.display = E;\n    },\n    addGradientFill = function (o, gradient, fill) {\n        o.attrs = o.attrs || {};\n        var attrs = o.attrs,\n            pow = Math.pow,\n            opacity,\n            oindex,\n            type = "linear",\n            fxfy = ".5 .5";\n        o.attrs.gradient = gradient;\n        gradient = Str(gradient).replace(R._radial_gradient, function (all, fx, fy) {\n            type = "radial";\n            if (fx && fy) {\n                fx = toFloat(fx);\n                fy = toFloat(fy);\n                pow(fx - .5, 2) + pow(fy - .5, 2) > .25 && (fy = math.sqrt(.25 - pow(fx - .5, 2)) * ((fy > .5) * 2 - 1) + .5);\n                fxfy = fx + S + fy;\n            }\n            return E;\n        });\n        gradient = gradient.split(/\\s*\\-\\s*/);\n        if (type == "linear") {\n            var angle = gradient.shift();\n            angle = -toFloat(angle);\n            if (isNaN(angle)) {\n                return null;\n            }\n        }\n        var dots = R._parseDots(gradient);\n        if (!dots) {\n            return null;\n        }\n        o = o.shape || o.node;\n        if (dots.length) {\n            o.removeChild(fill);\n            fill.on = true;\n            fill.method = "none";\n            fill.color = dots[0].color;\n            fill.color2 = dots[dots.length - 1].color;\n            var clrs = [];\n            for (var i = 0, ii = dots.length; i < ii; i++) {\n                dots[i].offset && clrs.push(dots[i].offset + S + dots[i].color);\n            }\n            fill.colors = clrs.length ? clrs.join() : "0% " + fill.color;\n            if (type == "radial") {\n                fill.type = "gradientTitle";\n                fill.focus = "100%";\n                fill.focussize = "0 0";\n                fill.focusposition = fxfy;\n                fill.angle = 0;\n            } else {\n                // fill.rotate= true;\n                fill.type = "gradient";\n                fill.angle = (270 - angle) % 360;\n            }\n            o.appendChild(fill);\n        }\n        return 1;\n    },\n    Element = function (node, vml) {\n        this[0] = this.node = node;\n        node.raphael = true;\n        this.id = R._oid++;\n        node.raphaelid = this.id;\n        this.X = 0;\n        this.Y = 0;\n        this.attrs = {};\n        this.paper = vml;\n        this.matrix = R.matrix();\n        this._ = {\n            transform: [],\n            sx: 1,\n            sy: 1,\n            dx: 0,\n            dy: 0,\n            deg: 0,\n            dirty: 1,\n            dirtyT: 1\n        };\n        !vml.bottom && (vml.bottom = this);\n        this.prev = vml.top;\n        vml.top && (vml.top.next = this);\n        vml.top = this;\n        this.next = null;\n    };\n    var elproto = R.el;\n\n    Element.prototype = elproto;\n    elproto.constructor = Element;\n    elproto.transform = function (tstr) {\n        if (tstr == null) {\n            return this._.transform;\n        }\n        var vbs = this.paper._viewBoxShift,\n            vbt = vbs ? "s" + [vbs.scale, vbs.scale] + "-1-1t" + [vbs.dx, vbs.dy] : E,\n            oldt;\n        if (vbs) {\n            oldt = tstr = Str(tstr).replace(/\\.{3}|\\u2026/g, this._.transform || E);\n        }\n        R._extractTransform(this, vbt + tstr);\n        var matrix = this.matrix.clone(),\n            skew = this.skew,\n            o = this.node,\n            split,\n            isGrad = ~Str(this.attrs.fill).indexOf("-"),\n            isPatt = !Str(this.attrs.fill).indexOf("url(");\n        matrix.translate(1, 1);\n        if (isPatt || isGrad || this.type == "image") {\n            skew.matrix = "1 0 0 1";\n            skew.offset = "0 0";\n            split = matrix.split();\n            if ((isGrad && split.noRotation) || !split.isSimple) {\n                o.style.filter = matrix.toFilter();\n                var bb = this.getBBox(),\n                    bbt = this.getBBox(1),\n                    dx = bb.x - bbt.x,\n                    dy = bb.y - bbt.y;\n                o.coordorigin = (dx * -zoom) + S + (dy * -zoom);\n                setCoords(this, 1, 1, dx, dy, 0);\n            } else {\n                o.style.filter = E;\n                setCoords(this, split.scalex, split.scaley, split.dx, split.dy, split.rotate);\n            }\n        } else {\n            o.style.filter = E;\n            skew.matrix = Str(matrix);\n            skew.offset = matrix.offset();\n        }\n        if (oldt !== null) { // empty string value is true as well\n            this._.transform = oldt;\n            R._extractTransform(this, oldt);\n        }\n        return this;\n    };\n    elproto.rotate = function (deg, cx, cy) {\n        if (this.removed) {\n            return this;\n        }\n        if (deg == null) {\n            return;\n        }\n        deg = Str(deg).split(separator);\n        if (deg.length - 1) {\n            cx = toFloat(deg[1]);\n            cy = toFloat(deg[2]);\n        }\n        deg = toFloat(deg[0]);\n        (cy == null) && (cx = cy);\n        if (cx == null || cy == null) {\n            var bbox = this.getBBox(1);\n            cx = bbox.x + bbox.width / 2;\n            cy = bbox.y + bbox.height / 2;\n        }\n        this._.dirtyT = 1;\n        this.transform(this._.transform.concat([["r", deg, cx, cy]]));\n        return this;\n    };\n    elproto.translate = function (dx, dy) {\n        if (this.removed) {\n            return this;\n        }\n        dx = Str(dx).split(separator);\n        if (dx.length - 1) {\n            dy = toFloat(dx[1]);\n        }\n        dx = toFloat(dx[0]) || 0;\n        dy = +dy || 0;\n        if (this._.bbox) {\n            this._.bbox.x += dx;\n            this._.bbox.y += dy;\n        }\n        this.transform(this._.transform.concat([["t", dx, dy]]));\n        return this;\n    };\n    elproto.scale = function (sx, sy, cx, cy) {\n        if (this.removed) {\n            return this;\n        }\n        sx = Str(sx).split(separator);\n        if (sx.length - 1) {\n            sy = toFloat(sx[1]);\n            cx = toFloat(sx[2]);\n            cy = toFloat(sx[3]);\n            isNaN(cx) && (cx = null);\n            isNaN(cy) && (cy = null);\n        }\n        sx = toFloat(sx[0]);\n        (sy == null) && (sy = sx);\n        (cy == null) && (cx = cy);\n        if (cx == null || cy == null) {\n            var bbox = this.getBBox(1);\n        }\n        cx = cx == null ? bbox.x + bbox.width / 2 : cx;\n        cy = cy == null ? bbox.y + bbox.height / 2 : cy;\n\n        this.transform(this._.transform.concat([["s", sx, sy, cx, cy]]));\n        this._.dirtyT = 1;\n        return this;\n    };\n    elproto.hide = function () {\n        !this.removed && (this.node.style.display = "none");\n        return this;\n    };\n    elproto.show = function () {\n        !this.removed && (this.node.style.display = E);\n        return this;\n    };\n    // Needed to fix the vml setViewBox issues\n    elproto.auxGetBBox = R.el.getBBox;\n    elproto.getBBox = function(){\n      var b = this.auxGetBBox();\n      if (this.paper && this.paper._viewBoxShift)\n      {\n        var c = {};\n        var z = 1/this.paper._viewBoxShift.scale;\n        c.x = b.x - this.paper._viewBoxShift.dx;\n        c.x *= z;\n        c.y = b.y - this.paper._viewBoxShift.dy;\n        c.y *= z;\n        c.width  = b.width  * z;\n        c.height = b.height * z;\n        c.x2 = c.x + c.width;\n        c.y2 = c.y + c.height;\n        return c;\n      }\n      return b;\n    };\n    elproto._getBBox = function () {\n        if (this.removed) {\n            return {};\n        }\n        return {\n            x: this.X + (this.bbx || 0) - this.W / 2,\n            y: this.Y - this.H,\n            width: this.W,\n            height: this.H\n        };\n    };\n    elproto.remove = function () {\n        if (this.removed || !this.node.parentNode) {\n            return;\n        }\n        this.paper.__set__ && this.paper.__set__.exclude(this);\n        R.eve.unbind("raphael.*.*." + this.id);\n        R._tear(this, this.paper);\n        this.node.parentNode.removeChild(this.node);\n        this.shape && this.shape.parentNode.removeChild(this.shape);\n        for (var i in this) {\n            this[i] = typeof this[i] == "function" ? R._removedFactory(i) : null;\n        }\n        this.removed = true;\n    };\n    elproto.attr = function (name, value) {\n        if (this.removed) {\n            return this;\n        }\n        if (name == null) {\n            var res = {};\n            for (var a in this.attrs) if (this.attrs[has](a)) {\n                res[a] = this.attrs[a];\n            }\n            res.gradient && res.fill == "none" && (res.fill = res.gradient) && delete res.gradient;\n            res.transform = this._.transform;\n            return res;\n        }\n        if (value == null && R.is(name, "string")) {\n            if (name == fillString && this.attrs.fill == "none" && this.attrs.gradient) {\n                return this.attrs.gradient;\n            }\n            var names = name.split(separator),\n                out = {};\n            for (var i = 0, ii = names.length; i < ii; i++) {\n                name = names[i];\n                if (name in this.attrs) {\n                    out[name] = this.attrs[name];\n                } else if (R.is(this.paper.customAttributes[name], "function")) {\n                    out[name] = this.paper.customAttributes[name].def;\n                } else {\n                    out[name] = R._availableAttrs[name];\n                }\n            }\n            return ii - 1 ? out : out[names[0]];\n        }\n        if (this.attrs && value == null && R.is(name, "array")) {\n            out = {};\n            for (i = 0, ii = name.length; i < ii; i++) {\n                out[name[i]] = this.attr(name[i]);\n            }\n            return out;\n        }\n        var params;\n        if (value != null) {\n            params = {};\n            params[name] = value;\n        }\n        value == null && R.is(name, "object") && (params = name);\n        for (var key in params) {\n            eve("raphael.attr." + key + "." + this.id, this, params[key]);\n        }\n        if (params) {\n            for (key in this.paper.customAttributes) if (this.paper.customAttributes[has](key) && params[has](key) && R.is(this.paper.customAttributes[key], "function")) {\n                var par = this.paper.customAttributes[key].apply(this, [].concat(params[key]));\n                this.attrs[key] = params[key];\n                for (var subkey in par) if (par[has](subkey)) {\n                    params[subkey] = par[subkey];\n                }\n            }\n            // this.paper.canvas.style.display = "none";\n            if (params.text && this.type == "text") {\n                this.textpath.string = params.text;\n            }\n            setFillAndStroke(this, params);\n            // this.paper.canvas.style.display = E;\n        }\n        return this;\n    };\n    elproto.toFront = function () {\n        !this.removed && this.node.parentNode.appendChild(this.node);\n        this.paper && this.paper.top != this && R._tofront(this, this.paper);\n        return this;\n    };\n    elproto.toBack = function () {\n        if (this.removed) {\n            return this;\n        }\n        if (this.node.parentNode.firstChild != this.node) {\n            this.node.parentNode.insertBefore(this.node, this.node.parentNode.firstChild);\n            R._toback(this, this.paper);\n        }\n        return this;\n    };\n    elproto.insertAfter = function (element) {\n        if (this.removed) {\n            return this;\n        }\n        if (element.constructor == R.st.constructor) {\n            element = element[element.length - 1];\n        }\n        if (element.node.nextSibling) {\n            element.node.parentNode.insertBefore(this.node, element.node.nextSibling);\n        } else {\n            element.node.parentNode.appendChild(this.node);\n        }\n        R._insertafter(this, element, this.paper);\n        return this;\n    };\n    elproto.insertBefore = function (element) {\n        if (this.removed) {\n            return this;\n        }\n        if (element.constructor == R.st.constructor) {\n            element = element[0];\n        }\n        element.node.parentNode.insertBefore(this.node, element.node);\n        R._insertbefore(this, element, this.paper);\n        return this;\n    };\n    elproto.blur = function (size) {\n        var s = this.node.runtimeStyle,\n            f = s.filter;\n        f = f.replace(blurregexp, E);\n        if (+size !== 0) {\n            this.attrs.blur = size;\n            s.filter = f + S + ms + ".Blur(pixelradius=" + (+size || 1.5) + ")";\n            s.margin = R.format("-{0}px 0 0 -{0}px", round(+size || 1.5));\n        } else {\n            s.filter = f;\n            s.margin = 0;\n            delete this.attrs.blur;\n        }\n        return this;\n    };\n\n    R._engine.path = function (pathString, vml) {\n        var el = createNode("shape");\n        el.style.cssText = cssDot;\n        el.coordsize = zoom + S + zoom;\n        el.coordorigin = vml.coordorigin;\n        var p = new Element(el, vml),\n            attr = {fill: "none", stroke: "#000"};\n        pathString && (attr.path = pathString);\n        p.type = "path";\n        p.path = [];\n        p.Path = E;\n        setFillAndStroke(p, attr);\n        vml.canvas && vml.canvas.appendChild(el);\n        var skew = createNode("skew");\n        skew.on = true;\n        el.appendChild(skew);\n        p.skew = skew;\n        p.transform(E);\n        return p;\n    };\n    R._engine.rect = function (vml, x, y, w, h, r) {\n        var path = R._rectPath(x, y, w, h, r),\n            res = vml.path(path),\n            a = res.attrs;\n        res.X = a.x = x;\n        res.Y = a.y = y;\n        res.W = a.width = w;\n        res.H = a.height = h;\n        a.r = r;\n        a.path = path;\n        res.type = "rect";\n        return res;\n    };\n    R._engine.ellipse = function (vml, x, y, rx, ry) {\n        var res = vml.path(),\n            a = res.attrs;\n        res.X = x - rx;\n        res.Y = y - ry;\n        res.W = rx * 2;\n        res.H = ry * 2;\n        res.type = "ellipse";\n        setFillAndStroke(res, {\n            cx: x,\n            cy: y,\n            rx: rx,\n            ry: ry\n        });\n        return res;\n    };\n    R._engine.circle = function (vml, x, y, r) {\n        var res = vml.path(),\n            a = res.attrs;\n        res.X = x - r;\n        res.Y = y - r;\n        res.W = res.H = r * 2;\n        res.type = "circle";\n        setFillAndStroke(res, {\n            cx: x,\n            cy: y,\n            r: r\n        });\n        return res;\n    };\n    R._engine.image = function (vml, src, x, y, w, h) {\n        var path = R._rectPath(x, y, w, h),\n            res = vml.path(path).attr({stroke: "none"}),\n            a = res.attrs,\n            node = res.node,\n            fill = node.getElementsByTagName(fillString)[0];\n        a.src = src;\n        res.X = a.x = x;\n        res.Y = a.y = y;\n        res.W = a.width = w;\n        res.H = a.height = h;\n        a.path = path;\n        res.type = "image";\n        fill.parentNode == node && node.removeChild(fill);\n        fill.rotate = true;\n        fill.src = src;\n        fill.type = "tile";\n        res._.fillpos = [x, y];\n        res._.fillsize = [w, h];\n        node.appendChild(fill);\n        setCoords(res, 1, 1, 0, 0, 0);\n        return res;\n    };\n    R._engine.text = function (vml, x, y, text) {\n        var el = createNode("shape"),\n            path = createNode("path"),\n            o = createNode("textpath");\n        x = x || 0;\n        y = y || 0;\n        text = text || "";\n        path.v = R.format("m{0},{1}l{2},{1}", round(x * zoom), round(y * zoom), round(x * zoom) + 1);\n        path.textpathok = true;\n        o.string = Str(text);\n        o.on = true;\n        el.style.cssText = cssDot;\n        el.coordsize = zoom + S + zoom;\n        el.coordorigin = "0 0";\n        var p = new Element(el, vml),\n            attr = {\n                fill: "#000",\n                stroke: "none",\n                font: R._availableAttrs.font,\n                text: text\n            };\n        p.shape = el;\n        p.path = path;\n        p.textpath = o;\n        p.type = "text";\n        p.attrs.text = Str(text);\n        p.attrs.x = x;\n        p.attrs.y = y;\n        p.attrs.w = 1;\n        p.attrs.h = 1;\n        setFillAndStroke(p, attr);\n        el.appendChild(o);\n        el.appendChild(path);\n        vml.canvas.appendChild(el);\n        var skew = createNode("skew");\n        skew.on = true;\n        el.appendChild(skew);\n        p.skew = skew;\n        p.transform(E);\n        return p;\n    };\n    R._engine.setSize = function (width, height) {\n        var cs = this.canvas.style;\n        this.width = width;\n        this.height = height;\n        width == +width && (width += "px");\n        height == +height && (height += "px");\n        cs.width = width;\n        cs.height = height;\n        cs.clip = "rect(0 " + width + " " + height + " 0)";\n        if (this._viewBox) {\n            R._engine.setViewBox.apply(this, this._viewBox);\n        }\n        return this;\n    };\n    R._engine.setViewBox = function (x, y, w, h, fit) {\n        R.eve("raphael.setViewBox", this, this._viewBox, [x, y, w, h, fit]);\n        var paperSize = this.getSize(),\n            width = paperSize.width,\n            height = paperSize.height,\n            H, W;\n        if (fit) {\n            H = height / h;\n            W = width / w;\n            if (w * H < width) {\n                x -= (width - w * H) / 2 / H;\n            }\n            if (h * W < height) {\n                y -= (height - h * W) / 2 / W;\n            }\n        }\n        this._viewBox = [x, y, w, h, !!fit];\n        this._viewBoxShift = {\n            dx: -x,\n            dy: -y,\n            scale: paperSize\n        };\n        this.forEach(function (el) {\n            el.transform("...");\n        });\n        return this;\n    };\n    var createNode;\n    R._engine.initWin = function (win) {\n            var doc = win.document;\n            if (doc.styleSheets.length < 31) {\n                doc.createStyleSheet().addRule(".rvml", "behavior:url(#default#VML)");\n            } else {\n                // no more room, add to the existing one\n                // http://msdn.microsoft.com/en-us/library/ms531194%28VS.85%29.aspx\n                doc.styleSheets[0].addRule(".rvml", "behavior:url(#default#VML)");\n            }\n            try {\n                !doc.namespaces.rvml && doc.namespaces.add("rvml", "urn:schemas-microsoft-com:vml");\n                createNode = function (tagName) {\n                    return doc.createElement(\'<rvml:\' + tagName + \' class="rvml">\');\n                };\n            } catch (e) {\n                createNode = function (tagName) {\n                    return doc.createElement(\'<\' + tagName + \' xmlns="urn:schemas-microsoft.com:vml" class="rvml">\');\n                };\n            }\n        };\n    R._engine.initWin(R._g.win);\n    R._engine.create = function () {\n        var con = R._getContainer.apply(0, arguments),\n            container = con.container,\n            height = con.height,\n            s,\n            width = con.width,\n            x = con.x,\n            y = con.y;\n        if (!container) {\n            throw new Error("VML container not found.");\n        }\n        var res = new R._Paper,\n            c = res.canvas = R._g.doc.createElement("div"),\n            cs = c.style;\n        x = x || 0;\n        y = y || 0;\n        width = width || 512;\n        height = height || 342;\n        res.width = width;\n        res.height = height;\n        width == +width && (width += "px");\n        height == +height && (height += "px");\n        res.coordsize = zoom * 1e3 + S + zoom * 1e3;\n        res.coordorigin = "0 0";\n        res.span = R._g.doc.createElement("span");\n        res.span.style.cssText = "position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;";\n        c.appendChild(res.span);\n        cs.cssText = R.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden", width, height);\n        if (container == 1) {\n            R._g.doc.body.appendChild(c);\n            cs.left = x + "px";\n            cs.top = y + "px";\n            cs.position = "absolute";\n        } else {\n            if (container.firstChild) {\n                container.insertBefore(c, container.firstChild);\n            } else {\n                container.appendChild(c);\n            }\n        }\n        res.renderfix = function () {};\n        return res;\n    };\n    R.prototype.clear = function () {\n        R.eve("raphael.clear", this);\n        this.canvas.innerHTML = E;\n        this.span = R._g.doc.createElement("span");\n        this.span.style.cssText = "position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";\n        this.canvas.appendChild(this.span);\n        this.bottom = this.top = null;\n    };\n    R.prototype.remove = function () {\n        R.eve("raphael.remove", this);\n        this.canvas.parentNode.removeChild(this.canvas);\n        for (var i in this) {\n            this[i] = typeof this[i] == "function" ? R._removedFactory(i) : null;\n        }\n        return true;\n    };\n\n    var setproto = R.st;\n    for (var method in elproto) if (elproto[has](method) && !setproto[has](method)) {\n        setproto[method] = (function (methodname) {\n            return function () {\n                var arg = arguments;\n                return this.forEach(function (el) {\n                    el[methodname].apply(el, arg);\n                });\n            };\n        })(method);\n    }\n}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9kZXYvcmFwaGFlbC52bWwuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9SYXBoYWVsLy4vZGV2L3JhcGhhZWwudm1sLmpzP2JhZjAiXSwic291cmNlc0NvbnRlbnQiOlsiZGVmaW5lKFtcIi4vcmFwaGFlbC5jb3JlXCJdLCBmdW5jdGlvbihSKSB7XG4gICAgaWYgKFIgJiYgIVIudm1sKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgaGFzID0gXCJoYXNPd25Qcm9wZXJ0eVwiLFxuICAgICAgICBTdHIgPSBTdHJpbmcsXG4gICAgICAgIHRvRmxvYXQgPSBwYXJzZUZsb2F0LFxuICAgICAgICBtYXRoID0gTWF0aCxcbiAgICAgICAgcm91bmQgPSBtYXRoLnJvdW5kLFxuICAgICAgICBtbWF4ID0gbWF0aC5tYXgsXG4gICAgICAgIG1taW4gPSBtYXRoLm1pbixcbiAgICAgICAgYWJzID0gbWF0aC5hYnMsXG4gICAgICAgIGZpbGxTdHJpbmcgPSBcImZpbGxcIixcbiAgICAgICAgc2VwYXJhdG9yID0gL1ssIF0rLyxcbiAgICAgICAgZXZlID0gUi5ldmUsXG4gICAgICAgIG1zID0gXCIgcHJvZ2lkOkRYSW1hZ2VUcmFuc2Zvcm0uTWljcm9zb2Z0XCIsXG4gICAgICAgIFMgPSBcIiBcIixcbiAgICAgICAgRSA9IFwiXCIsXG4gICAgICAgIG1hcCA9IHtNOiBcIm1cIiwgTDogXCJsXCIsIEM6IFwiY1wiLCBaOiBcInhcIiwgbTogXCJ0XCIsIGw6IFwiclwiLCBjOiBcInZcIiwgejogXCJ4XCJ9LFxuICAgICAgICBiaXRlcyA9IC8oW2NsbXpdKSw/KFteY2xtel0qKS9naSxcbiAgICAgICAgYmx1cnJlZ2V4cCA9IC8gcHJvZ2lkOlxcUytCbHVyXFwoW15cXCldK1xcKS9nLFxuICAgICAgICB2YWwgPSAvLT9bXixcXHMtXSsvZyxcbiAgICAgICAgY3NzRG90ID0gXCJwb3NpdGlvbjphYnNvbHV0ZTtsZWZ0OjA7dG9wOjA7d2lkdGg6MXB4O2hlaWdodDoxcHg7YmVoYXZpb3I6dXJsKCNkZWZhdWx0I1ZNTClcIixcbiAgICAgICAgem9vbSA9IDIxNjAwLFxuICAgICAgICBwYXRoVHlwZXMgPSB7cGF0aDogMSwgcmVjdDogMSwgaW1hZ2U6IDF9LFxuICAgICAgICBvdmFsVHlwZXMgPSB7Y2lyY2xlOiAxLCBlbGxpcHNlOiAxfSxcbiAgICAgICAgcGF0aDJ2bWwgPSBmdW5jdGlvbiAocGF0aCkge1xuICAgICAgICAgICAgdmFyIHRvdGFsID0gIC9bYWhxc3R2XS9pZyxcbiAgICAgICAgICAgICAgICBjb21tYW5kID0gUi5fcGF0aFRvQWJzb2x1dGU7XG4gICAgICAgICAgICBTdHIocGF0aCkubWF0Y2godG90YWwpICYmIChjb21tYW5kID0gUi5fcGF0aDJjdXJ2ZSk7XG4gICAgICAgICAgICB0b3RhbCA9IC9bY2xtel0vZztcbiAgICAgICAgICAgIGlmIChjb21tYW5kID09IFIuX3BhdGhUb0Fic29sdXRlICYmICFTdHIocGF0aCkubWF0Y2godG90YWwpKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlcyA9IFN0cihwYXRoKS5yZXBsYWNlKGJpdGVzLCBmdW5jdGlvbiAoYWxsLCBjb21tYW5kLCBhcmdzKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB2YWxzID0gW10sXG4gICAgICAgICAgICAgICAgICAgICAgICBpc01vdmUgPSBjb21tYW5kLnRvTG93ZXJDYXNlKCkgPT0gXCJtXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXMgPSBtYXBbY29tbWFuZF07XG4gICAgICAgICAgICAgICAgICAgIGFyZ3MucmVwbGFjZSh2YWwsIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzTW92ZSAmJiB2YWxzLmxlbmd0aCA9PSAyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzICs9IHZhbHMgKyBtYXBbY29tbWFuZCA9PSBcIm1cIiA/IFwibFwiIDogXCJMXCJdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHMucHVzaChyb3VuZCh2YWx1ZSAqIHpvb20pKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMgKyB2YWxzO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcGEgPSBjb21tYW5kKHBhdGgpLCBwLCByO1xuICAgICAgICAgICAgcmVzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBwYS5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgcCA9IHBhW2ldO1xuICAgICAgICAgICAgICAgIHIgPSBwYVtpXVswXS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgICAgIHIgPT0gXCJ6XCIgJiYgKHIgPSBcInhcIik7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDEsIGpqID0gcC5sZW5ndGg7IGogPCBqajsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIHIgKz0gcm91bmQocFtqXSAqIHpvb20pICsgKGogIT0gamogLSAxID8gXCIsXCIgOiBFKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmVzLnB1c2gocik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzLmpvaW4oUyk7XG4gICAgICAgIH0sXG4gICAgICAgIGNvbXBlbnNhdGlvbiA9IGZ1bmN0aW9uIChkZWcsIGR4LCBkeSkge1xuICAgICAgICAgICAgdmFyIG0gPSBSLm1hdHJpeCgpO1xuICAgICAgICAgICAgbS5yb3RhdGUoLWRlZywgLjUsIC41KTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZHg6IG0ueChkeCwgZHkpLFxuICAgICAgICAgICAgICAgIGR5OiBtLnkoZHgsIGR5KVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0Q29vcmRzID0gZnVuY3Rpb24gKHAsIHN4LCBzeSwgZHgsIGR5LCBkZWcpIHtcbiAgICAgICAgICAgIHZhciBfID0gcC5fLFxuICAgICAgICAgICAgICAgIG0gPSBwLm1hdHJpeCxcbiAgICAgICAgICAgICAgICBmaWxscG9zID0gXy5maWxscG9zLFxuICAgICAgICAgICAgICAgIG8gPSBwLm5vZGUsXG4gICAgICAgICAgICAgICAgcyA9IG8uc3R5bGUsXG4gICAgICAgICAgICAgICAgeSA9IDEsXG4gICAgICAgICAgICAgICAgZmxpcCA9IFwiXCIsXG4gICAgICAgICAgICAgICAgZHhkeSxcbiAgICAgICAgICAgICAgICBreCA9IHpvb20gLyBzeCxcbiAgICAgICAgICAgICAgICBreSA9IHpvb20gLyBzeTtcbiAgICAgICAgICAgIHMudmlzaWJpbGl0eSA9IFwiaGlkZGVuXCI7XG4gICAgICAgICAgICBpZiAoIXN4IHx8ICFzeSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG8uY29vcmRzaXplID0gYWJzKGt4KSArIFMgKyBhYnMoa3kpO1xuICAgICAgICAgICAgcy5yb3RhdGlvbiA9IGRlZyAqIChzeCAqIHN5IDwgMCA/IC0xIDogMSk7XG4gICAgICAgICAgICBpZiAoZGVnKSB7XG4gICAgICAgICAgICAgICAgdmFyIGMgPSBjb21wZW5zYXRpb24oZGVnLCBkeCwgZHkpO1xuICAgICAgICAgICAgICAgIGR4ID0gYy5keDtcbiAgICAgICAgICAgICAgICBkeSA9IGMuZHk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzeCA8IDAgJiYgKGZsaXAgKz0gXCJ4XCIpO1xuICAgICAgICAgICAgc3kgPCAwICYmIChmbGlwICs9IFwiIHlcIikgJiYgKHkgPSAtMSk7XG4gICAgICAgICAgICBzLmZsaXAgPSBmbGlwO1xuICAgICAgICAgICAgby5jb29yZG9yaWdpbiA9IChkeCAqIC1reCkgKyBTICsgKGR5ICogLWt5KTtcbiAgICAgICAgICAgIGlmIChmaWxscG9zIHx8IF8uZmlsbHNpemUpIHtcbiAgICAgICAgICAgICAgICB2YXIgZmlsbCA9IG8uZ2V0RWxlbWVudHNCeVRhZ05hbWUoZmlsbFN0cmluZyk7XG4gICAgICAgICAgICAgICAgZmlsbCA9IGZpbGwgJiYgZmlsbFswXTtcbiAgICAgICAgICAgICAgICBvLnJlbW92ZUNoaWxkKGZpbGwpO1xuICAgICAgICAgICAgICAgIGlmIChmaWxscG9zKSB7XG4gICAgICAgICAgICAgICAgICAgIGMgPSBjb21wZW5zYXRpb24oZGVnLCBtLngoZmlsbHBvc1swXSwgZmlsbHBvc1sxXSksIG0ueShmaWxscG9zWzBdLCBmaWxscG9zWzFdKSk7XG4gICAgICAgICAgICAgICAgICAgIGZpbGwucG9zaXRpb24gPSBjLmR4ICogeSArIFMgKyBjLmR5ICogeTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKF8uZmlsbHNpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgZmlsbC5zaXplID0gXy5maWxsc2l6ZVswXSAqIGFicyhzeCkgKyBTICsgXy5maWxsc2l6ZVsxXSAqIGFicyhzeSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG8uYXBwZW5kQ2hpbGQoZmlsbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzLnZpc2liaWxpdHkgPSBcInZpc2libGVcIjtcbiAgICAgICAgfTtcbiAgICBSLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gIFwiWW91ciBicm93c2VyIGRvZXNuXFx1MjAxOXQgc3VwcG9ydCBTVkcuIEZhbGxpbmcgZG93biB0byBWTUwuXFxuWW91IGFyZSBydW5uaW5nIFJhcGhhXFx4ZWJsIFwiICsgdGhpcy52ZXJzaW9uO1xuICAgIH07XG4gICAgdmFyIGFkZEFycm93ID0gZnVuY3Rpb24gKG8sIHZhbHVlLCBpc0VuZCkge1xuICAgICAgICB2YXIgdmFsdWVzID0gU3RyKHZhbHVlKS50b0xvd2VyQ2FzZSgpLnNwbGl0KFwiLVwiKSxcbiAgICAgICAgICAgIHNlID0gaXNFbmQgPyBcImVuZFwiIDogXCJzdGFydFwiLFxuICAgICAgICAgICAgaSA9IHZhbHVlcy5sZW5ndGgsXG4gICAgICAgICAgICB0eXBlID0gXCJjbGFzc2ljXCIsXG4gICAgICAgICAgICB3ID0gXCJtZWRpdW1cIixcbiAgICAgICAgICAgIGggPSBcIm1lZGl1bVwiO1xuICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKHZhbHVlc1tpXSkge1xuICAgICAgICAgICAgICAgIGNhc2UgXCJibG9ja1wiOlxuICAgICAgICAgICAgICAgIGNhc2UgXCJjbGFzc2ljXCI6XG4gICAgICAgICAgICAgICAgY2FzZSBcIm92YWxcIjpcbiAgICAgICAgICAgICAgICBjYXNlIFwiZGlhbW9uZFwiOlxuICAgICAgICAgICAgICAgIGNhc2UgXCJvcGVuXCI6XG4gICAgICAgICAgICAgICAgY2FzZSBcIm5vbmVcIjpcbiAgICAgICAgICAgICAgICAgICAgdHlwZSA9IHZhbHVlc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcIndpZGVcIjpcbiAgICAgICAgICAgICAgICBjYXNlIFwibmFycm93XCI6IGggPSB2YWx1ZXNbaV07IGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJsb25nXCI6XG4gICAgICAgICAgICAgICAgY2FzZSBcInNob3J0XCI6IHcgPSB2YWx1ZXNbaV07IGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBzdHJva2UgPSBvLm5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzdHJva2VcIilbMF07XG4gICAgICAgIHN0cm9rZVtzZSArIFwiYXJyb3dcIl0gPSB0eXBlO1xuICAgICAgICBzdHJva2Vbc2UgKyBcImFycm93bGVuZ3RoXCJdID0gdztcbiAgICAgICAgc3Ryb2tlW3NlICsgXCJhcnJvd3dpZHRoXCJdID0gaDtcbiAgICB9LFxuICAgIHNldEZpbGxBbmRTdHJva2UgPSBmdW5jdGlvbiAobywgcGFyYW1zKSB7XG4gICAgICAgIC8vIG8ucGFwZXIuY2FudmFzLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICAgICAgby5hdHRycyA9IG8uYXR0cnMgfHwge307XG4gICAgICAgIHZhciBub2RlID0gby5ub2RlLFxuICAgICAgICAgICAgYSA9IG8uYXR0cnMsXG4gICAgICAgICAgICBzID0gbm9kZS5zdHlsZSxcbiAgICAgICAgICAgIHh5LFxuICAgICAgICAgICAgbmV3cGF0aCA9IHBhdGhUeXBlc1tvLnR5cGVdICYmIChwYXJhbXMueCAhPSBhLnggfHwgcGFyYW1zLnkgIT0gYS55IHx8IHBhcmFtcy53aWR0aCAhPSBhLndpZHRoIHx8IHBhcmFtcy5oZWlnaHQgIT0gYS5oZWlnaHQgfHwgcGFyYW1zLmN4ICE9IGEuY3ggfHwgcGFyYW1zLmN5ICE9IGEuY3kgfHwgcGFyYW1zLnJ4ICE9IGEucnggfHwgcGFyYW1zLnJ5ICE9IGEucnkgfHwgcGFyYW1zLnIgIT0gYS5yKSxcbiAgICAgICAgICAgIGlzT3ZhbCA9IG92YWxUeXBlc1tvLnR5cGVdICYmIChhLmN4ICE9IHBhcmFtcy5jeCB8fCBhLmN5ICE9IHBhcmFtcy5jeSB8fCBhLnIgIT0gcGFyYW1zLnIgfHwgYS5yeCAhPSBwYXJhbXMucnggfHwgYS5yeSAhPSBwYXJhbXMucnkpLFxuICAgICAgICAgICAgcmVzID0gbztcblxuXG4gICAgICAgIGZvciAodmFyIHBhciBpbiBwYXJhbXMpIGlmIChwYXJhbXNbaGFzXShwYXIpKSB7XG4gICAgICAgICAgICBhW3Bhcl0gPSBwYXJhbXNbcGFyXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobmV3cGF0aCkge1xuICAgICAgICAgICAgYS5wYXRoID0gUi5fZ2V0UGF0aFtvLnR5cGVdKG8pO1xuICAgICAgICAgICAgby5fLmRpcnR5ID0gMTtcbiAgICAgICAgfVxuICAgICAgICBwYXJhbXMuaHJlZiAmJiAobm9kZS5ocmVmID0gcGFyYW1zLmhyZWYpO1xuICAgICAgICBwYXJhbXMudGl0bGUgJiYgKG5vZGUudGl0bGUgPSBwYXJhbXMudGl0bGUpO1xuICAgICAgICBwYXJhbXMudGFyZ2V0ICYmIChub2RlLnRhcmdldCA9IHBhcmFtcy50YXJnZXQpO1xuICAgICAgICBwYXJhbXMuY3Vyc29yICYmIChzLmN1cnNvciA9IHBhcmFtcy5jdXJzb3IpO1xuICAgICAgICBcImJsdXJcIiBpbiBwYXJhbXMgJiYgby5ibHVyKHBhcmFtcy5ibHVyKTtcbiAgICAgICAgaWYgKHBhcmFtcy5wYXRoICYmIG8udHlwZSA9PSBcInBhdGhcIiB8fCBuZXdwYXRoKSB7XG4gICAgICAgICAgICBub2RlLnBhdGggPSBwYXRoMnZtbCh+U3RyKGEucGF0aCkudG9Mb3dlckNhc2UoKS5pbmRleE9mKFwiclwiKSA/IFIuX3BhdGhUb0Fic29sdXRlKGEucGF0aCkgOiBhLnBhdGgpO1xuICAgICAgICAgICAgby5fLmRpcnR5ID0gMTtcbiAgICAgICAgICAgIGlmIChvLnR5cGUgPT0gXCJpbWFnZVwiKSB7XG4gICAgICAgICAgICAgICAgby5fLmZpbGxwb3MgPSBbYS54LCBhLnldO1xuICAgICAgICAgICAgICAgIG8uXy5maWxsc2l6ZSA9IFthLndpZHRoLCBhLmhlaWdodF07XG4gICAgICAgICAgICAgICAgc2V0Q29vcmRzKG8sIDEsIDEsIDAsIDAsIDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFwidHJhbnNmb3JtXCIgaW4gcGFyYW1zICYmIG8udHJhbnNmb3JtKHBhcmFtcy50cmFuc2Zvcm0pO1xuICAgICAgICBpZiAoaXNPdmFsKSB7XG4gICAgICAgICAgICB2YXIgY3ggPSArYS5jeCxcbiAgICAgICAgICAgICAgICBjeSA9ICthLmN5LFxuICAgICAgICAgICAgICAgIHJ4ID0gK2EucnggfHwgK2EuciB8fCAwLFxuICAgICAgICAgICAgICAgIHJ5ID0gK2EucnkgfHwgK2EuciB8fCAwO1xuICAgICAgICAgICAgbm9kZS5wYXRoID0gUi5mb3JtYXQoXCJhcnswfSx7MX0sezJ9LHszfSx7NH0sezF9LHs0fSx7MX14XCIsIHJvdW5kKChjeCAtIHJ4KSAqIHpvb20pLCByb3VuZCgoY3kgLSByeSkgKiB6b29tKSwgcm91bmQoKGN4ICsgcngpICogem9vbSksIHJvdW5kKChjeSArIHJ5KSAqIHpvb20pLCByb3VuZChjeCAqIHpvb20pKTtcbiAgICAgICAgICAgIG8uXy5kaXJ0eSA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFwiY2xpcC1yZWN0XCIgaW4gcGFyYW1zKSB7XG4gICAgICAgICAgICB2YXIgcmVjdCA9IFN0cihwYXJhbXNbXCJjbGlwLXJlY3RcIl0pLnNwbGl0KHNlcGFyYXRvcik7XG4gICAgICAgICAgICBpZiAocmVjdC5sZW5ndGggPT0gNCkge1xuICAgICAgICAgICAgICAgIHJlY3RbMl0gPSArcmVjdFsyXSArICgrcmVjdFswXSk7XG4gICAgICAgICAgICAgICAgcmVjdFszXSA9ICtyZWN0WzNdICsgKCtyZWN0WzFdKTtcbiAgICAgICAgICAgICAgICB2YXIgZGl2ID0gbm9kZS5jbGlwUmVjdCB8fCBSLl9nLmRvYy5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLFxuICAgICAgICAgICAgICAgICAgICBkc3R5bGUgPSBkaXYuc3R5bGU7XG4gICAgICAgICAgICAgICAgZHN0eWxlLmNsaXAgPSBSLmZvcm1hdChcInJlY3QoezF9cHggezJ9cHggezN9cHggezB9cHgpXCIsIHJlY3QpO1xuICAgICAgICAgICAgICAgIGlmICghbm9kZS5jbGlwUmVjdCkge1xuICAgICAgICAgICAgICAgICAgICBkc3R5bGUucG9zaXRpb24gPSBcImFic29sdXRlXCI7XG4gICAgICAgICAgICAgICAgICAgIGRzdHlsZS50b3AgPSAwO1xuICAgICAgICAgICAgICAgICAgICBkc3R5bGUubGVmdCA9IDA7XG4gICAgICAgICAgICAgICAgICAgIGRzdHlsZS53aWR0aCA9IG8ucGFwZXIud2lkdGggKyBcInB4XCI7XG4gICAgICAgICAgICAgICAgICAgIGRzdHlsZS5oZWlnaHQgPSBvLnBhcGVyLmhlaWdodCArIFwicHhcIjtcbiAgICAgICAgICAgICAgICAgICAgbm9kZS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShkaXYsIG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICBkaXYuYXBwZW5kQ2hpbGQobm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIG5vZGUuY2xpcFJlY3QgPSBkaXY7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFwYXJhbXNbXCJjbGlwLXJlY3RcIl0pIHtcbiAgICAgICAgICAgICAgICBub2RlLmNsaXBSZWN0ICYmIChub2RlLmNsaXBSZWN0LnN0eWxlLmNsaXAgPSBcImF1dG9cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG8udGV4dHBhdGgpIHtcbiAgICAgICAgICAgIHZhciB0ZXh0cGF0aFN0eWxlID0gby50ZXh0cGF0aC5zdHlsZTtcbiAgICAgICAgICAgIHBhcmFtcy5mb250ICYmICh0ZXh0cGF0aFN0eWxlLmZvbnQgPSBwYXJhbXMuZm9udCk7XG4gICAgICAgICAgICBwYXJhbXNbXCJmb250LWZhbWlseVwiXSAmJiAodGV4dHBhdGhTdHlsZS5mb250RmFtaWx5ID0gJ1wiJyArIHBhcmFtc1tcImZvbnQtZmFtaWx5XCJdLnNwbGl0KFwiLFwiKVswXS5yZXBsYWNlKC9eWydcIl0rfFsnXCJdKyQvZywgRSkgKyAnXCInKTtcbiAgICAgICAgICAgIHBhcmFtc1tcImZvbnQtc2l6ZVwiXSAmJiAodGV4dHBhdGhTdHlsZS5mb250U2l6ZSA9IHBhcmFtc1tcImZvbnQtc2l6ZVwiXSk7XG4gICAgICAgICAgICBwYXJhbXNbXCJmb250LXdlaWdodFwiXSAmJiAodGV4dHBhdGhTdHlsZS5mb250V2VpZ2h0ID0gcGFyYW1zW1wiZm9udC13ZWlnaHRcIl0pO1xuICAgICAgICAgICAgcGFyYW1zW1wiZm9udC1zdHlsZVwiXSAmJiAodGV4dHBhdGhTdHlsZS5mb250U3R5bGUgPSBwYXJhbXNbXCJmb250LXN0eWxlXCJdKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoXCJhcnJvdy1zdGFydFwiIGluIHBhcmFtcykge1xuICAgICAgICAgICAgYWRkQXJyb3cocmVzLCBwYXJhbXNbXCJhcnJvdy1zdGFydFwiXSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFwiYXJyb3ctZW5kXCIgaW4gcGFyYW1zKSB7XG4gICAgICAgICAgICBhZGRBcnJvdyhyZXMsIHBhcmFtc1tcImFycm93LWVuZFwiXSwgMSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmFtcy5vcGFjaXR5ICE9IG51bGwgfHxcbiAgICAgICAgICAgIHBhcmFtcy5maWxsICE9IG51bGwgfHxcbiAgICAgICAgICAgIHBhcmFtcy5zcmMgIT0gbnVsbCB8fFxuICAgICAgICAgICAgcGFyYW1zLnN0cm9rZSAhPSBudWxsIHx8XG4gICAgICAgICAgICBwYXJhbXNbXCJzdHJva2Utd2lkdGhcIl0gIT0gbnVsbCB8fFxuICAgICAgICAgICAgcGFyYW1zW1wic3Ryb2tlLW9wYWNpdHlcIl0gIT0gbnVsbCB8fFxuICAgICAgICAgICAgcGFyYW1zW1wiZmlsbC1vcGFjaXR5XCJdICE9IG51bGwgfHxcbiAgICAgICAgICAgIHBhcmFtc1tcInN0cm9rZS1kYXNoYXJyYXlcIl0gIT0gbnVsbCB8fFxuICAgICAgICAgICAgcGFyYW1zW1wic3Ryb2tlLW1pdGVybGltaXRcIl0gIT0gbnVsbCB8fFxuICAgICAgICAgICAgcGFyYW1zW1wic3Ryb2tlLWxpbmVqb2luXCJdICE9IG51bGwgfHxcbiAgICAgICAgICAgIHBhcmFtc1tcInN0cm9rZS1saW5lY2FwXCJdICE9IG51bGwpIHtcbiAgICAgICAgICAgIHZhciBmaWxsID0gbm9kZS5nZXRFbGVtZW50c0J5VGFnTmFtZShmaWxsU3RyaW5nKSxcbiAgICAgICAgICAgICAgICBuZXdmaWxsID0gZmFsc2U7XG4gICAgICAgICAgICBmaWxsID0gZmlsbCAmJiBmaWxsWzBdO1xuICAgICAgICAgICAgIWZpbGwgJiYgKG5ld2ZpbGwgPSBmaWxsID0gY3JlYXRlTm9kZShmaWxsU3RyaW5nKSk7XG4gICAgICAgICAgICBpZiAoby50eXBlID09IFwiaW1hZ2VcIiAmJiBwYXJhbXMuc3JjKSB7XG4gICAgICAgICAgICAgICAgZmlsbC5zcmMgPSBwYXJhbXMuc3JjO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcGFyYW1zLmZpbGwgJiYgKGZpbGwub24gPSB0cnVlKTtcbiAgICAgICAgICAgIGlmIChmaWxsLm9uID09IG51bGwgfHwgcGFyYW1zLmZpbGwgPT0gXCJub25lXCIgfHwgcGFyYW1zLmZpbGwgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBmaWxsLm9uID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZmlsbC5vbiAmJiBwYXJhbXMuZmlsbCkge1xuICAgICAgICAgICAgICAgIHZhciBpc1VSTCA9IFN0cihwYXJhbXMuZmlsbCkubWF0Y2goUi5fSVNVUkwpO1xuICAgICAgICAgICAgICAgIGlmIChpc1VSTCkge1xuICAgICAgICAgICAgICAgICAgICBmaWxsLnBhcmVudE5vZGUgPT0gbm9kZSAmJiBub2RlLnJlbW92ZUNoaWxkKGZpbGwpO1xuICAgICAgICAgICAgICAgICAgICBmaWxsLnJvdGF0ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGZpbGwuc3JjID0gaXNVUkxbMV07XG4gICAgICAgICAgICAgICAgICAgIGZpbGwudHlwZSA9IFwidGlsZVwiO1xuICAgICAgICAgICAgICAgICAgICB2YXIgYmJveCA9IG8uZ2V0QkJveCgxKTtcbiAgICAgICAgICAgICAgICAgICAgZmlsbC5wb3NpdGlvbiA9IGJib3gueCArIFMgKyBiYm94Lnk7XG4gICAgICAgICAgICAgICAgICAgIG8uXy5maWxscG9zID0gW2Jib3gueCwgYmJveC55XTtcblxuICAgICAgICAgICAgICAgICAgICBSLl9wcmVsb2FkKGlzVVJMWzFdLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvLl8uZmlsbHNpemUgPSBbdGhpcy5vZmZzZXRXaWR0aCwgdGhpcy5vZmZzZXRIZWlnaHRdO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBmaWxsLmNvbG9yID0gUi5nZXRSR0IocGFyYW1zLmZpbGwpLmhleDtcbiAgICAgICAgICAgICAgICAgICAgZmlsbC5zcmMgPSBFO1xuICAgICAgICAgICAgICAgICAgICBmaWxsLnR5cGUgPSBcInNvbGlkXCI7XG4gICAgICAgICAgICAgICAgICAgIGlmIChSLmdldFJHQihwYXJhbXMuZmlsbCkuZXJyb3IgJiYgKHJlcy50eXBlIGluIHtjaXJjbGU6IDEsIGVsbGlwc2U6IDF9IHx8IFN0cihwYXJhbXMuZmlsbCkuY2hhckF0KCkgIT0gXCJyXCIpICYmIGFkZEdyYWRpZW50RmlsbChyZXMsIHBhcmFtcy5maWxsLCBmaWxsKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYS5maWxsID0gXCJub25lXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBhLmdyYWRpZW50ID0gcGFyYW1zLmZpbGw7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWxsLnJvdGF0ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKFwiZmlsbC1vcGFjaXR5XCIgaW4gcGFyYW1zIHx8IFwib3BhY2l0eVwiIGluIHBhcmFtcykge1xuICAgICAgICAgICAgICAgIHZhciBvcGFjaXR5ID0gKCgrYVtcImZpbGwtb3BhY2l0eVwiXSArIDEgfHwgMikgLSAxKSAqICgoK2Eub3BhY2l0eSArIDEgfHwgMikgLSAxKSAqICgoK1IuZ2V0UkdCKHBhcmFtcy5maWxsKS5vICsgMSB8fCAyKSAtIDEpO1xuICAgICAgICAgICAgICAgIG9wYWNpdHkgPSBtbWluKG1tYXgob3BhY2l0eSwgMCksIDEpO1xuICAgICAgICAgICAgICAgIGZpbGwub3BhY2l0eSA9IG9wYWNpdHk7XG4gICAgICAgICAgICAgICAgaWYgKGZpbGwuc3JjKSB7XG4gICAgICAgICAgICAgICAgICAgIGZpbGwuY29sb3IgPSBcIm5vbmVcIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBub2RlLmFwcGVuZENoaWxkKGZpbGwpO1xuICAgICAgICAgICAgdmFyIHN0cm9rZSA9IChub2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwic3Ryb2tlXCIpICYmIG5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzdHJva2VcIilbMF0pLFxuICAgICAgICAgICAgbmV3c3Ryb2tlID0gZmFsc2U7XG4gICAgICAgICAgICAhc3Ryb2tlICYmIChuZXdzdHJva2UgPSBzdHJva2UgPSBjcmVhdGVOb2RlKFwic3Ryb2tlXCIpKTtcbiAgICAgICAgICAgIGlmICgocGFyYW1zLnN0cm9rZSAmJiBwYXJhbXMuc3Ryb2tlICE9IFwibm9uZVwiKSB8fFxuICAgICAgICAgICAgICAgIHBhcmFtc1tcInN0cm9rZS13aWR0aFwiXSB8fFxuICAgICAgICAgICAgICAgIHBhcmFtc1tcInN0cm9rZS1vcGFjaXR5XCJdICE9IG51bGwgfHxcbiAgICAgICAgICAgICAgICBwYXJhbXNbXCJzdHJva2UtZGFzaGFycmF5XCJdIHx8XG4gICAgICAgICAgICAgICAgcGFyYW1zW1wic3Ryb2tlLW1pdGVybGltaXRcIl0gfHxcbiAgICAgICAgICAgICAgICBwYXJhbXNbXCJzdHJva2UtbGluZWpvaW5cIl0gfHxcbiAgICAgICAgICAgICAgICBwYXJhbXNbXCJzdHJva2UtbGluZWNhcFwiXSkge1xuICAgICAgICAgICAgICAgIHN0cm9rZS5vbiA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAocGFyYW1zLnN0cm9rZSA9PSBcIm5vbmVcIiB8fCBwYXJhbXMuc3Ryb2tlID09PSBudWxsIHx8IHN0cm9rZS5vbiA9PSBudWxsIHx8IHBhcmFtcy5zdHJva2UgPT0gMCB8fCBwYXJhbXNbXCJzdHJva2Utd2lkdGhcIl0gPT0gMCkgJiYgKHN0cm9rZS5vbiA9IGZhbHNlKTtcbiAgICAgICAgICAgIHZhciBzdHJva2VDb2xvciA9IFIuZ2V0UkdCKHBhcmFtcy5zdHJva2UpO1xuICAgICAgICAgICAgc3Ryb2tlLm9uICYmIHBhcmFtcy5zdHJva2UgJiYgKHN0cm9rZS5jb2xvciA9IHN0cm9rZUNvbG9yLmhleCk7XG4gICAgICAgICAgICBvcGFjaXR5ID0gKCgrYVtcInN0cm9rZS1vcGFjaXR5XCJdICsgMSB8fCAyKSAtIDEpICogKCgrYS5vcGFjaXR5ICsgMSB8fCAyKSAtIDEpICogKCgrc3Ryb2tlQ29sb3IubyArIDEgfHwgMikgLSAxKTtcbiAgICAgICAgICAgIHZhciB3aWR0aCA9ICh0b0Zsb2F0KHBhcmFtc1tcInN0cm9rZS13aWR0aFwiXSkgfHwgMSkgKiAuNzU7XG4gICAgICAgICAgICBvcGFjaXR5ID0gbW1pbihtbWF4KG9wYWNpdHksIDApLCAxKTtcbiAgICAgICAgICAgIHBhcmFtc1tcInN0cm9rZS13aWR0aFwiXSA9PSBudWxsICYmICh3aWR0aCA9IGFbXCJzdHJva2Utd2lkdGhcIl0pO1xuICAgICAgICAgICAgcGFyYW1zW1wic3Ryb2tlLXdpZHRoXCJdICYmIChzdHJva2Uud2VpZ2h0ID0gd2lkdGgpO1xuICAgICAgICAgICAgd2lkdGggJiYgd2lkdGggPCAxICYmIChvcGFjaXR5ICo9IHdpZHRoKSAmJiAoc3Ryb2tlLndlaWdodCA9IDEpO1xuICAgICAgICAgICAgc3Ryb2tlLm9wYWNpdHkgPSBvcGFjaXR5O1xuXG4gICAgICAgICAgICBwYXJhbXNbXCJzdHJva2UtbGluZWpvaW5cIl0gJiYgKHN0cm9rZS5qb2luc3R5bGUgPSBwYXJhbXNbXCJzdHJva2UtbGluZWpvaW5cIl0gfHwgXCJtaXRlclwiKTtcbiAgICAgICAgICAgIHN0cm9rZS5taXRlcmxpbWl0ID0gcGFyYW1zW1wic3Ryb2tlLW1pdGVybGltaXRcIl0gfHwgODtcbiAgICAgICAgICAgIHBhcmFtc1tcInN0cm9rZS1saW5lY2FwXCJdICYmIChzdHJva2UuZW5kY2FwID0gcGFyYW1zW1wic3Ryb2tlLWxpbmVjYXBcIl0gPT0gXCJidXR0XCIgPyBcImZsYXRcIiA6IHBhcmFtc1tcInN0cm9rZS1saW5lY2FwXCJdID09IFwic3F1YXJlXCIgPyBcInNxdWFyZVwiIDogXCJyb3VuZFwiKTtcbiAgICAgICAgICAgIGlmIChcInN0cm9rZS1kYXNoYXJyYXlcIiBpbiBwYXJhbXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGFzaGFycmF5ID0ge1xuICAgICAgICAgICAgICAgICAgICBcIi1cIjogXCJzaG9ydGRhc2hcIixcbiAgICAgICAgICAgICAgICAgICAgXCIuXCI6IFwic2hvcnRkb3RcIixcbiAgICAgICAgICAgICAgICAgICAgXCItLlwiOiBcInNob3J0ZGFzaGRvdFwiLFxuICAgICAgICAgICAgICAgICAgICBcIi0uLlwiOiBcInNob3J0ZGFzaGRvdGRvdFwiLFxuICAgICAgICAgICAgICAgICAgICBcIi4gXCI6IFwiZG90XCIsXG4gICAgICAgICAgICAgICAgICAgIFwiLSBcIjogXCJkYXNoXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiLS1cIjogXCJsb25nZGFzaFwiLFxuICAgICAgICAgICAgICAgICAgICBcIi0gLlwiOiBcImRhc2hkb3RcIixcbiAgICAgICAgICAgICAgICAgICAgXCItLS5cIjogXCJsb25nZGFzaGRvdFwiLFxuICAgICAgICAgICAgICAgICAgICBcIi0tLi5cIjogXCJsb25nZGFzaGRvdGRvdFwiXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBzdHJva2UuZGFzaHN0eWxlID0gZGFzaGFycmF5W2hhc10ocGFyYW1zW1wic3Ryb2tlLWRhc2hhcnJheVwiXSkgPyBkYXNoYXJyYXlbcGFyYW1zW1wic3Ryb2tlLWRhc2hhcnJheVwiXV0gOiBFO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbmV3c3Ryb2tlICYmIG5vZGUuYXBwZW5kQ2hpbGQoc3Ryb2tlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVzLnR5cGUgPT0gXCJ0ZXh0XCIpIHtcbiAgICAgICAgICAgIHJlcy5wYXBlci5jYW52YXMuc3R5bGUuZGlzcGxheSA9IEU7XG4gICAgICAgICAgICB2YXIgc3BhbiA9IHJlcy5wYXBlci5zcGFuLFxuICAgICAgICAgICAgICAgIG0gPSAxMDAsXG4gICAgICAgICAgICAgICAgZm9udFNpemUgPSBhLmZvbnQgJiYgYS5mb250Lm1hdGNoKC9cXGQrKD86XFwuXFxkKik/KD89cHgpLyk7XG4gICAgICAgICAgICBzID0gc3Bhbi5zdHlsZTtcbiAgICAgICAgICAgIGEuZm9udCAmJiAocy5mb250ID0gYS5mb250KTtcbiAgICAgICAgICAgIGFbXCJmb250LWZhbWlseVwiXSAmJiAocy5mb250RmFtaWx5ID0gYVtcImZvbnQtZmFtaWx5XCJdKTtcbiAgICAgICAgICAgIGFbXCJmb250LXdlaWdodFwiXSAmJiAocy5mb250V2VpZ2h0ID0gYVtcImZvbnQtd2VpZ2h0XCJdKTtcbiAgICAgICAgICAgIGFbXCJmb250LXN0eWxlXCJdICYmIChzLmZvbnRTdHlsZSA9IGFbXCJmb250LXN0eWxlXCJdKTtcbiAgICAgICAgICAgIGZvbnRTaXplID0gdG9GbG9hdChhW1wiZm9udC1zaXplXCJdIHx8IGZvbnRTaXplICYmIGZvbnRTaXplWzBdKSB8fCAxMDtcbiAgICAgICAgICAgIHMuZm9udFNpemUgPSBmb250U2l6ZSAqIG0gKyBcInB4XCI7XG4gICAgICAgICAgICByZXMudGV4dHBhdGguc3RyaW5nICYmIChzcGFuLmlubmVySFRNTCA9IFN0cihyZXMudGV4dHBhdGguc3RyaW5nKS5yZXBsYWNlKC88L2csIFwiJiM2MDtcIikucmVwbGFjZSgvJi9nLCBcIiYjMzg7XCIpLnJlcGxhY2UoL1xcbi9nLCBcIjxicj5cIikpO1xuICAgICAgICAgICAgdmFyIGJyZWN0ID0gc3Bhbi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgICAgIHJlcy5XID0gYS53ID0gKGJyZWN0LnJpZ2h0IC0gYnJlY3QubGVmdCkgLyBtO1xuICAgICAgICAgICAgcmVzLkggPSBhLmggPSAoYnJlY3QuYm90dG9tIC0gYnJlY3QudG9wKSAvIG07XG4gICAgICAgICAgICAvLyByZXMucGFwZXIuY2FudmFzLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICAgICAgICAgIHJlcy5YID0gYS54O1xuICAgICAgICAgICAgcmVzLlkgPSBhLnkgKyByZXMuSCAvIDI7XG5cbiAgICAgICAgICAgIChcInhcIiBpbiBwYXJhbXMgfHwgXCJ5XCIgaW4gcGFyYW1zKSAmJiAocmVzLnBhdGgudiA9IFIuZm9ybWF0KFwibXswfSx7MX1sezJ9LHsxfVwiLCByb3VuZChhLnggKiB6b29tKSwgcm91bmQoYS55ICogem9vbSksIHJvdW5kKGEueCAqIHpvb20pICsgMSkpO1xuICAgICAgICAgICAgdmFyIGRpcnR5YXR0cnMgPSBbXCJ4XCIsIFwieVwiLCBcInRleHRcIiwgXCJmb250XCIsIFwiZm9udC1mYW1pbHlcIiwgXCJmb250LXdlaWdodFwiLCBcImZvbnQtc3R5bGVcIiwgXCJmb250LXNpemVcIl07XG4gICAgICAgICAgICBmb3IgKHZhciBkID0gMCwgZGQgPSBkaXJ0eWF0dHJzLmxlbmd0aDsgZCA8IGRkOyBkKyspIGlmIChkaXJ0eWF0dHJzW2RdIGluIHBhcmFtcykge1xuICAgICAgICAgICAgICAgIHJlcy5fLmRpcnR5ID0gMTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gdGV4dC1hbmNob3IgZW11bGF0aW9uXG4gICAgICAgICAgICBzd2l0Y2ggKGFbXCJ0ZXh0LWFuY2hvclwiXSkge1xuICAgICAgICAgICAgICAgIGNhc2UgXCJzdGFydFwiOlxuICAgICAgICAgICAgICAgICAgICByZXMudGV4dHBhdGguc3R5bGVbXCJ2LXRleHQtYWxpZ25cIl0gPSBcImxlZnRcIjtcbiAgICAgICAgICAgICAgICAgICAgcmVzLmJieCA9IHJlcy5XIC8gMjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgICAgICAgIHJlcy50ZXh0cGF0aC5zdHlsZVtcInYtdGV4dC1hbGlnblwiXSA9IFwicmlnaHRcIjtcbiAgICAgICAgICAgICAgICAgICAgcmVzLmJieCA9IC1yZXMuVyAvIDI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgcmVzLnRleHRwYXRoLnN0eWxlW1widi10ZXh0LWFsaWduXCJdID0gXCJjZW50ZXJcIjtcbiAgICAgICAgICAgICAgICAgICAgcmVzLmJieCA9IDA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXMudGV4dHBhdGguc3R5bGVbXCJ2LXRleHQta2VyblwiXSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgLy8gcmVzLnBhcGVyLmNhbnZhcy5zdHlsZS5kaXNwbGF5ID0gRTtcbiAgICB9LFxuICAgIGFkZEdyYWRpZW50RmlsbCA9IGZ1bmN0aW9uIChvLCBncmFkaWVudCwgZmlsbCkge1xuICAgICAgICBvLmF0dHJzID0gby5hdHRycyB8fCB7fTtcbiAgICAgICAgdmFyIGF0dHJzID0gby5hdHRycyxcbiAgICAgICAgICAgIHBvdyA9IE1hdGgucG93LFxuICAgICAgICAgICAgb3BhY2l0eSxcbiAgICAgICAgICAgIG9pbmRleCxcbiAgICAgICAgICAgIHR5cGUgPSBcImxpbmVhclwiLFxuICAgICAgICAgICAgZnhmeSA9IFwiLjUgLjVcIjtcbiAgICAgICAgby5hdHRycy5ncmFkaWVudCA9IGdyYWRpZW50O1xuICAgICAgICBncmFkaWVudCA9IFN0cihncmFkaWVudCkucmVwbGFjZShSLl9yYWRpYWxfZ3JhZGllbnQsIGZ1bmN0aW9uIChhbGwsIGZ4LCBmeSkge1xuICAgICAgICAgICAgdHlwZSA9IFwicmFkaWFsXCI7XG4gICAgICAgICAgICBpZiAoZnggJiYgZnkpIHtcbiAgICAgICAgICAgICAgICBmeCA9IHRvRmxvYXQoZngpO1xuICAgICAgICAgICAgICAgIGZ5ID0gdG9GbG9hdChmeSk7XG4gICAgICAgICAgICAgICAgcG93KGZ4IC0gLjUsIDIpICsgcG93KGZ5IC0gLjUsIDIpID4gLjI1ICYmIChmeSA9IG1hdGguc3FydCguMjUgLSBwb3coZnggLSAuNSwgMikpICogKChmeSA+IC41KSAqIDIgLSAxKSArIC41KTtcbiAgICAgICAgICAgICAgICBmeGZ5ID0gZnggKyBTICsgZnk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gRTtcbiAgICAgICAgfSk7XG4gICAgICAgIGdyYWRpZW50ID0gZ3JhZGllbnQuc3BsaXQoL1xccypcXC1cXHMqLyk7XG4gICAgICAgIGlmICh0eXBlID09IFwibGluZWFyXCIpIHtcbiAgICAgICAgICAgIHZhciBhbmdsZSA9IGdyYWRpZW50LnNoaWZ0KCk7XG4gICAgICAgICAgICBhbmdsZSA9IC10b0Zsb2F0KGFuZ2xlKTtcbiAgICAgICAgICAgIGlmIChpc05hTihhbmdsZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgZG90cyA9IFIuX3BhcnNlRG90cyhncmFkaWVudCk7XG4gICAgICAgIGlmICghZG90cykge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgbyA9IG8uc2hhcGUgfHwgby5ub2RlO1xuICAgICAgICBpZiAoZG90cy5sZW5ndGgpIHtcbiAgICAgICAgICAgIG8ucmVtb3ZlQ2hpbGQoZmlsbCk7XG4gICAgICAgICAgICBmaWxsLm9uID0gdHJ1ZTtcbiAgICAgICAgICAgIGZpbGwubWV0aG9kID0gXCJub25lXCI7XG4gICAgICAgICAgICBmaWxsLmNvbG9yID0gZG90c1swXS5jb2xvcjtcbiAgICAgICAgICAgIGZpbGwuY29sb3IyID0gZG90c1tkb3RzLmxlbmd0aCAtIDFdLmNvbG9yO1xuICAgICAgICAgICAgdmFyIGNscnMgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IGRvdHMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuICAgICAgICAgICAgICAgIGRvdHNbaV0ub2Zmc2V0ICYmIGNscnMucHVzaChkb3RzW2ldLm9mZnNldCArIFMgKyBkb3RzW2ldLmNvbG9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZpbGwuY29sb3JzID0gY2xycy5sZW5ndGggPyBjbHJzLmpvaW4oKSA6IFwiMCUgXCIgKyBmaWxsLmNvbG9yO1xuICAgICAgICAgICAgaWYgKHR5cGUgPT0gXCJyYWRpYWxcIikge1xuICAgICAgICAgICAgICAgIGZpbGwudHlwZSA9IFwiZ3JhZGllbnRUaXRsZVwiO1xuICAgICAgICAgICAgICAgIGZpbGwuZm9jdXMgPSBcIjEwMCVcIjtcbiAgICAgICAgICAgICAgICBmaWxsLmZvY3Vzc2l6ZSA9IFwiMCAwXCI7XG4gICAgICAgICAgICAgICAgZmlsbC5mb2N1c3Bvc2l0aW9uID0gZnhmeTtcbiAgICAgICAgICAgICAgICBmaWxsLmFuZ2xlID0gMDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gZmlsbC5yb3RhdGU9IHRydWU7XG4gICAgICAgICAgICAgICAgZmlsbC50eXBlID0gXCJncmFkaWVudFwiO1xuICAgICAgICAgICAgICAgIGZpbGwuYW5nbGUgPSAoMjcwIC0gYW5nbGUpICUgMzYwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgby5hcHBlbmRDaGlsZChmaWxsKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gMTtcbiAgICB9LFxuICAgIEVsZW1lbnQgPSBmdW5jdGlvbiAobm9kZSwgdm1sKSB7XG4gICAgICAgIHRoaXNbMF0gPSB0aGlzLm5vZGUgPSBub2RlO1xuICAgICAgICBub2RlLnJhcGhhZWwgPSB0cnVlO1xuICAgICAgICB0aGlzLmlkID0gUi5fb2lkKys7XG4gICAgICAgIG5vZGUucmFwaGFlbGlkID0gdGhpcy5pZDtcbiAgICAgICAgdGhpcy5YID0gMDtcbiAgICAgICAgdGhpcy5ZID0gMDtcbiAgICAgICAgdGhpcy5hdHRycyA9IHt9O1xuICAgICAgICB0aGlzLnBhcGVyID0gdm1sO1xuICAgICAgICB0aGlzLm1hdHJpeCA9IFIubWF0cml4KCk7XG4gICAgICAgIHRoaXMuXyA9IHtcbiAgICAgICAgICAgIHRyYW5zZm9ybTogW10sXG4gICAgICAgICAgICBzeDogMSxcbiAgICAgICAgICAgIHN5OiAxLFxuICAgICAgICAgICAgZHg6IDAsXG4gICAgICAgICAgICBkeTogMCxcbiAgICAgICAgICAgIGRlZzogMCxcbiAgICAgICAgICAgIGRpcnR5OiAxLFxuICAgICAgICAgICAgZGlydHlUOiAxXG4gICAgICAgIH07XG4gICAgICAgICF2bWwuYm90dG9tICYmICh2bWwuYm90dG9tID0gdGhpcyk7XG4gICAgICAgIHRoaXMucHJldiA9IHZtbC50b3A7XG4gICAgICAgIHZtbC50b3AgJiYgKHZtbC50b3AubmV4dCA9IHRoaXMpO1xuICAgICAgICB2bWwudG9wID0gdGhpcztcbiAgICAgICAgdGhpcy5uZXh0ID0gbnVsbDtcbiAgICB9O1xuICAgIHZhciBlbHByb3RvID0gUi5lbDtcblxuICAgIEVsZW1lbnQucHJvdG90eXBlID0gZWxwcm90bztcbiAgICBlbHByb3RvLmNvbnN0cnVjdG9yID0gRWxlbWVudDtcbiAgICBlbHByb3RvLnRyYW5zZm9ybSA9IGZ1bmN0aW9uICh0c3RyKSB7XG4gICAgICAgIGlmICh0c3RyID09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl8udHJhbnNmb3JtO1xuICAgICAgICB9XG4gICAgICAgIHZhciB2YnMgPSB0aGlzLnBhcGVyLl92aWV3Qm94U2hpZnQsXG4gICAgICAgICAgICB2YnQgPSB2YnMgPyBcInNcIiArIFt2YnMuc2NhbGUsIHZicy5zY2FsZV0gKyBcIi0xLTF0XCIgKyBbdmJzLmR4LCB2YnMuZHldIDogRSxcbiAgICAgICAgICAgIG9sZHQ7XG4gICAgICAgIGlmICh2YnMpIHtcbiAgICAgICAgICAgIG9sZHQgPSB0c3RyID0gU3RyKHRzdHIpLnJlcGxhY2UoL1xcLnszfXxcXHUyMDI2L2csIHRoaXMuXy50cmFuc2Zvcm0gfHwgRSk7XG4gICAgICAgIH1cbiAgICAgICAgUi5fZXh0cmFjdFRyYW5zZm9ybSh0aGlzLCB2YnQgKyB0c3RyKTtcbiAgICAgICAgdmFyIG1hdHJpeCA9IHRoaXMubWF0cml4LmNsb25lKCksXG4gICAgICAgICAgICBza2V3ID0gdGhpcy5za2V3LFxuICAgICAgICAgICAgbyA9IHRoaXMubm9kZSxcbiAgICAgICAgICAgIHNwbGl0LFxuICAgICAgICAgICAgaXNHcmFkID0gflN0cih0aGlzLmF0dHJzLmZpbGwpLmluZGV4T2YoXCItXCIpLFxuICAgICAgICAgICAgaXNQYXR0ID0gIVN0cih0aGlzLmF0dHJzLmZpbGwpLmluZGV4T2YoXCJ1cmwoXCIpO1xuICAgICAgICBtYXRyaXgudHJhbnNsYXRlKDEsIDEpO1xuICAgICAgICBpZiAoaXNQYXR0IHx8IGlzR3JhZCB8fCB0aGlzLnR5cGUgPT0gXCJpbWFnZVwiKSB7XG4gICAgICAgICAgICBza2V3Lm1hdHJpeCA9IFwiMSAwIDAgMVwiO1xuICAgICAgICAgICAgc2tldy5vZmZzZXQgPSBcIjAgMFwiO1xuICAgICAgICAgICAgc3BsaXQgPSBtYXRyaXguc3BsaXQoKTtcbiAgICAgICAgICAgIGlmICgoaXNHcmFkICYmIHNwbGl0Lm5vUm90YXRpb24pIHx8ICFzcGxpdC5pc1NpbXBsZSkge1xuICAgICAgICAgICAgICAgIG8uc3R5bGUuZmlsdGVyID0gbWF0cml4LnRvRmlsdGVyKCk7XG4gICAgICAgICAgICAgICAgdmFyIGJiID0gdGhpcy5nZXRCQm94KCksXG4gICAgICAgICAgICAgICAgICAgIGJidCA9IHRoaXMuZ2V0QkJveCgxKSxcbiAgICAgICAgICAgICAgICAgICAgZHggPSBiYi54IC0gYmJ0LngsXG4gICAgICAgICAgICAgICAgICAgIGR5ID0gYmIueSAtIGJidC55O1xuICAgICAgICAgICAgICAgIG8uY29vcmRvcmlnaW4gPSAoZHggKiAtem9vbSkgKyBTICsgKGR5ICogLXpvb20pO1xuICAgICAgICAgICAgICAgIHNldENvb3Jkcyh0aGlzLCAxLCAxLCBkeCwgZHksIDApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBvLnN0eWxlLmZpbHRlciA9IEU7XG4gICAgICAgICAgICAgICAgc2V0Q29vcmRzKHRoaXMsIHNwbGl0LnNjYWxleCwgc3BsaXQuc2NhbGV5LCBzcGxpdC5keCwgc3BsaXQuZHksIHNwbGl0LnJvdGF0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBvLnN0eWxlLmZpbHRlciA9IEU7XG4gICAgICAgICAgICBza2V3Lm1hdHJpeCA9IFN0cihtYXRyaXgpO1xuICAgICAgICAgICAgc2tldy5vZmZzZXQgPSBtYXRyaXgub2Zmc2V0KCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9sZHQgIT09IG51bGwpIHsgLy8gZW1wdHkgc3RyaW5nIHZhbHVlIGlzIHRydWUgYXMgd2VsbFxuICAgICAgICAgICAgdGhpcy5fLnRyYW5zZm9ybSA9IG9sZHQ7XG4gICAgICAgICAgICBSLl9leHRyYWN0VHJhbnNmb3JtKHRoaXMsIG9sZHQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgZWxwcm90by5yb3RhdGUgPSBmdW5jdGlvbiAoZGVnLCBjeCwgY3kpIHtcbiAgICAgICAgaWYgKHRoaXMucmVtb3ZlZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRlZyA9PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZGVnID0gU3RyKGRlZykuc3BsaXQoc2VwYXJhdG9yKTtcbiAgICAgICAgaWYgKGRlZy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICBjeCA9IHRvRmxvYXQoZGVnWzFdKTtcbiAgICAgICAgICAgIGN5ID0gdG9GbG9hdChkZWdbMl0pO1xuICAgICAgICB9XG4gICAgICAgIGRlZyA9IHRvRmxvYXQoZGVnWzBdKTtcbiAgICAgICAgKGN5ID09IG51bGwpICYmIChjeCA9IGN5KTtcbiAgICAgICAgaWYgKGN4ID09IG51bGwgfHwgY3kgPT0gbnVsbCkge1xuICAgICAgICAgICAgdmFyIGJib3ggPSB0aGlzLmdldEJCb3goMSk7XG4gICAgICAgICAgICBjeCA9IGJib3gueCArIGJib3gud2lkdGggLyAyO1xuICAgICAgICAgICAgY3kgPSBiYm94LnkgKyBiYm94LmhlaWdodCAvIDI7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fLmRpcnR5VCA9IDE7XG4gICAgICAgIHRoaXMudHJhbnNmb3JtKHRoaXMuXy50cmFuc2Zvcm0uY29uY2F0KFtbXCJyXCIsIGRlZywgY3gsIGN5XV0pKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBlbHByb3RvLnRyYW5zbGF0ZSA9IGZ1bmN0aW9uIChkeCwgZHkpIHtcbiAgICAgICAgaWYgKHRoaXMucmVtb3ZlZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgZHggPSBTdHIoZHgpLnNwbGl0KHNlcGFyYXRvcik7XG4gICAgICAgIGlmIChkeC5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICBkeSA9IHRvRmxvYXQoZHhbMV0pO1xuICAgICAgICB9XG4gICAgICAgIGR4ID0gdG9GbG9hdChkeFswXSkgfHwgMDtcbiAgICAgICAgZHkgPSArZHkgfHwgMDtcbiAgICAgICAgaWYgKHRoaXMuXy5iYm94KSB7XG4gICAgICAgICAgICB0aGlzLl8uYmJveC54ICs9IGR4O1xuICAgICAgICAgICAgdGhpcy5fLmJib3gueSArPSBkeTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnRyYW5zZm9ybSh0aGlzLl8udHJhbnNmb3JtLmNvbmNhdChbW1widFwiLCBkeCwgZHldXSkpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIGVscHJvdG8uc2NhbGUgPSBmdW5jdGlvbiAoc3gsIHN5LCBjeCwgY3kpIHtcbiAgICAgICAgaWYgKHRoaXMucmVtb3ZlZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgc3ggPSBTdHIoc3gpLnNwbGl0KHNlcGFyYXRvcik7XG4gICAgICAgIGlmIChzeC5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICBzeSA9IHRvRmxvYXQoc3hbMV0pO1xuICAgICAgICAgICAgY3ggPSB0b0Zsb2F0KHN4WzJdKTtcbiAgICAgICAgICAgIGN5ID0gdG9GbG9hdChzeFszXSk7XG4gICAgICAgICAgICBpc05hTihjeCkgJiYgKGN4ID0gbnVsbCk7XG4gICAgICAgICAgICBpc05hTihjeSkgJiYgKGN5ID0gbnVsbCk7XG4gICAgICAgIH1cbiAgICAgICAgc3ggPSB0b0Zsb2F0KHN4WzBdKTtcbiAgICAgICAgKHN5ID09IG51bGwpICYmIChzeSA9IHN4KTtcbiAgICAgICAgKGN5ID09IG51bGwpICYmIChjeCA9IGN5KTtcbiAgICAgICAgaWYgKGN4ID09IG51bGwgfHwgY3kgPT0gbnVsbCkge1xuICAgICAgICAgICAgdmFyIGJib3ggPSB0aGlzLmdldEJCb3goMSk7XG4gICAgICAgIH1cbiAgICAgICAgY3ggPSBjeCA9PSBudWxsID8gYmJveC54ICsgYmJveC53aWR0aCAvIDIgOiBjeDtcbiAgICAgICAgY3kgPSBjeSA9PSBudWxsID8gYmJveC55ICsgYmJveC5oZWlnaHQgLyAyIDogY3k7XG5cbiAgICAgICAgdGhpcy50cmFuc2Zvcm0odGhpcy5fLnRyYW5zZm9ybS5jb25jYXQoW1tcInNcIiwgc3gsIHN5LCBjeCwgY3ldXSkpO1xuICAgICAgICB0aGlzLl8uZGlydHlUID0gMTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBlbHByb3RvLmhpZGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICF0aGlzLnJlbW92ZWQgJiYgKHRoaXMubm9kZS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCIpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIGVscHJvdG8uc2hvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgIXRoaXMucmVtb3ZlZCAmJiAodGhpcy5ub2RlLnN0eWxlLmRpc3BsYXkgPSBFKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICAvLyBOZWVkZWQgdG8gZml4IHRoZSB2bWwgc2V0Vmlld0JveCBpc3N1ZXNcbiAgICBlbHByb3RvLmF1eEdldEJCb3ggPSBSLmVsLmdldEJCb3g7XG4gICAgZWxwcm90by5nZXRCQm94ID0gZnVuY3Rpb24oKXtcbiAgICAgIHZhciBiID0gdGhpcy5hdXhHZXRCQm94KCk7XG4gICAgICBpZiAodGhpcy5wYXBlciAmJiB0aGlzLnBhcGVyLl92aWV3Qm94U2hpZnQpXG4gICAgICB7XG4gICAgICAgIHZhciBjID0ge307XG4gICAgICAgIHZhciB6ID0gMS90aGlzLnBhcGVyLl92aWV3Qm94U2hpZnQuc2NhbGU7XG4gICAgICAgIGMueCA9IGIueCAtIHRoaXMucGFwZXIuX3ZpZXdCb3hTaGlmdC5keDtcbiAgICAgICAgYy54ICo9IHo7XG4gICAgICAgIGMueSA9IGIueSAtIHRoaXMucGFwZXIuX3ZpZXdCb3hTaGlmdC5keTtcbiAgICAgICAgYy55ICo9IHo7XG4gICAgICAgIGMud2lkdGggID0gYi53aWR0aCAgKiB6O1xuICAgICAgICBjLmhlaWdodCA9IGIuaGVpZ2h0ICogejtcbiAgICAgICAgYy54MiA9IGMueCArIGMud2lkdGg7XG4gICAgICAgIGMueTIgPSBjLnkgKyBjLmhlaWdodDtcbiAgICAgICAgcmV0dXJuIGM7XG4gICAgICB9XG4gICAgICByZXR1cm4gYjtcbiAgICB9O1xuICAgIGVscHJvdG8uX2dldEJCb3ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnJlbW92ZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgeDogdGhpcy5YICsgKHRoaXMuYmJ4IHx8IDApIC0gdGhpcy5XIC8gMixcbiAgICAgICAgICAgIHk6IHRoaXMuWSAtIHRoaXMuSCxcbiAgICAgICAgICAgIHdpZHRoOiB0aGlzLlcsXG4gICAgICAgICAgICBoZWlnaHQ6IHRoaXMuSFxuICAgICAgICB9O1xuICAgIH07XG4gICAgZWxwcm90by5yZW1vdmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnJlbW92ZWQgfHwgIXRoaXMubm9kZS5wYXJlbnROb2RlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wYXBlci5fX3NldF9fICYmIHRoaXMucGFwZXIuX19zZXRfXy5leGNsdWRlKHRoaXMpO1xuICAgICAgICBSLmV2ZS51bmJpbmQoXCJyYXBoYWVsLiouKi5cIiArIHRoaXMuaWQpO1xuICAgICAgICBSLl90ZWFyKHRoaXMsIHRoaXMucGFwZXIpO1xuICAgICAgICB0aGlzLm5vZGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLm5vZGUpO1xuICAgICAgICB0aGlzLnNoYXBlICYmIHRoaXMuc2hhcGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLnNoYXBlKTtcbiAgICAgICAgZm9yICh2YXIgaSBpbiB0aGlzKSB7XG4gICAgICAgICAgICB0aGlzW2ldID0gdHlwZW9mIHRoaXNbaV0gPT0gXCJmdW5jdGlvblwiID8gUi5fcmVtb3ZlZEZhY3RvcnkoaSkgOiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVtb3ZlZCA9IHRydWU7XG4gICAgfTtcbiAgICBlbHByb3RvLmF0dHIgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMucmVtb3ZlZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5hbWUgPT0gbnVsbCkge1xuICAgICAgICAgICAgdmFyIHJlcyA9IHt9O1xuICAgICAgICAgICAgZm9yICh2YXIgYSBpbiB0aGlzLmF0dHJzKSBpZiAodGhpcy5hdHRyc1toYXNdKGEpKSB7XG4gICAgICAgICAgICAgICAgcmVzW2FdID0gdGhpcy5hdHRyc1thXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlcy5ncmFkaWVudCAmJiByZXMuZmlsbCA9PSBcIm5vbmVcIiAmJiAocmVzLmZpbGwgPSByZXMuZ3JhZGllbnQpICYmIGRlbGV0ZSByZXMuZ3JhZGllbnQ7XG4gICAgICAgICAgICByZXMudHJhbnNmb3JtID0gdGhpcy5fLnRyYW5zZm9ybTtcbiAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZhbHVlID09IG51bGwgJiYgUi5pcyhuYW1lLCBcInN0cmluZ1wiKSkge1xuICAgICAgICAgICAgaWYgKG5hbWUgPT0gZmlsbFN0cmluZyAmJiB0aGlzLmF0dHJzLmZpbGwgPT0gXCJub25lXCIgJiYgdGhpcy5hdHRycy5ncmFkaWVudCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmF0dHJzLmdyYWRpZW50O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG5hbWVzID0gbmFtZS5zcGxpdChzZXBhcmF0b3IpLFxuICAgICAgICAgICAgICAgIG91dCA9IHt9O1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gbmFtZXMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuICAgICAgICAgICAgICAgIG5hbWUgPSBuYW1lc1tpXTtcbiAgICAgICAgICAgICAgICBpZiAobmFtZSBpbiB0aGlzLmF0dHJzKSB7XG4gICAgICAgICAgICAgICAgICAgIG91dFtuYW1lXSA9IHRoaXMuYXR0cnNbbmFtZV07XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChSLmlzKHRoaXMucGFwZXIuY3VzdG9tQXR0cmlidXRlc1tuYW1lXSwgXCJmdW5jdGlvblwiKSkge1xuICAgICAgICAgICAgICAgICAgICBvdXRbbmFtZV0gPSB0aGlzLnBhcGVyLmN1c3RvbUF0dHJpYnV0ZXNbbmFtZV0uZGVmO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG91dFtuYW1lXSA9IFIuX2F2YWlsYWJsZUF0dHJzW25hbWVdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBpaSAtIDEgPyBvdXQgOiBvdXRbbmFtZXNbMF1dO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmF0dHJzICYmIHZhbHVlID09IG51bGwgJiYgUi5pcyhuYW1lLCBcImFycmF5XCIpKSB7XG4gICAgICAgICAgICBvdXQgPSB7fTtcbiAgICAgICAgICAgIGZvciAoaSA9IDAsIGlpID0gbmFtZS5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgb3V0W25hbWVbaV1dID0gdGhpcy5hdHRyKG5hbWVbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG91dDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcGFyYW1zO1xuICAgICAgICBpZiAodmFsdWUgIT0gbnVsbCkge1xuICAgICAgICAgICAgcGFyYW1zID0ge307XG4gICAgICAgICAgICBwYXJhbXNbbmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICB2YWx1ZSA9PSBudWxsICYmIFIuaXMobmFtZSwgXCJvYmplY3RcIikgJiYgKHBhcmFtcyA9IG5hbWUpO1xuICAgICAgICBmb3IgKHZhciBrZXkgaW4gcGFyYW1zKSB7XG4gICAgICAgICAgICBldmUoXCJyYXBoYWVsLmF0dHIuXCIgKyBrZXkgKyBcIi5cIiArIHRoaXMuaWQsIHRoaXMsIHBhcmFtc1trZXldKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyYW1zKSB7XG4gICAgICAgICAgICBmb3IgKGtleSBpbiB0aGlzLnBhcGVyLmN1c3RvbUF0dHJpYnV0ZXMpIGlmICh0aGlzLnBhcGVyLmN1c3RvbUF0dHJpYnV0ZXNbaGFzXShrZXkpICYmIHBhcmFtc1toYXNdKGtleSkgJiYgUi5pcyh0aGlzLnBhcGVyLmN1c3RvbUF0dHJpYnV0ZXNba2V5XSwgXCJmdW5jdGlvblwiKSkge1xuICAgICAgICAgICAgICAgIHZhciBwYXIgPSB0aGlzLnBhcGVyLmN1c3RvbUF0dHJpYnV0ZXNba2V5XS5hcHBseSh0aGlzLCBbXS5jb25jYXQocGFyYW1zW2tleV0pKTtcbiAgICAgICAgICAgICAgICB0aGlzLmF0dHJzW2tleV0gPSBwYXJhbXNba2V5XTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBzdWJrZXkgaW4gcGFyKSBpZiAocGFyW2hhc10oc3Via2V5KSkge1xuICAgICAgICAgICAgICAgICAgICBwYXJhbXNbc3Via2V5XSA9IHBhcltzdWJrZXldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIHRoaXMucGFwZXIuY2FudmFzLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICAgICAgICAgIGlmIChwYXJhbXMudGV4dCAmJiB0aGlzLnR5cGUgPT0gXCJ0ZXh0XCIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRleHRwYXRoLnN0cmluZyA9IHBhcmFtcy50ZXh0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2V0RmlsbEFuZFN0cm9rZSh0aGlzLCBwYXJhbXMpO1xuICAgICAgICAgICAgLy8gdGhpcy5wYXBlci5jYW52YXMuc3R5bGUuZGlzcGxheSA9IEU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBlbHByb3RvLnRvRnJvbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICF0aGlzLnJlbW92ZWQgJiYgdGhpcy5ub2RlLnBhcmVudE5vZGUuYXBwZW5kQ2hpbGQodGhpcy5ub2RlKTtcbiAgICAgICAgdGhpcy5wYXBlciAmJiB0aGlzLnBhcGVyLnRvcCAhPSB0aGlzICYmIFIuX3RvZnJvbnQodGhpcywgdGhpcy5wYXBlcik7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgZWxwcm90by50b0JhY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnJlbW92ZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm5vZGUucGFyZW50Tm9kZS5maXJzdENoaWxkICE9IHRoaXMubm9kZSkge1xuICAgICAgICAgICAgdGhpcy5ub2RlLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHRoaXMubm9kZSwgdGhpcy5ub2RlLnBhcmVudE5vZGUuZmlyc3RDaGlsZCk7XG4gICAgICAgICAgICBSLl90b2JhY2sodGhpcywgdGhpcy5wYXBlcik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBlbHByb3RvLmluc2VydEFmdGVyID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgaWYgKHRoaXMucmVtb3ZlZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGVsZW1lbnQuY29uc3RydWN0b3IgPT0gUi5zdC5jb25zdHJ1Y3Rvcikge1xuICAgICAgICAgICAgZWxlbWVudCA9IGVsZW1lbnRbZWxlbWVudC5sZW5ndGggLSAxXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZWxlbWVudC5ub2RlLm5leHRTaWJsaW5nKSB7XG4gICAgICAgICAgICBlbGVtZW50Lm5vZGUucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUodGhpcy5ub2RlLCBlbGVtZW50Lm5vZGUubmV4dFNpYmxpbmcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZWxlbWVudC5ub2RlLnBhcmVudE5vZGUuYXBwZW5kQ2hpbGQodGhpcy5ub2RlKTtcbiAgICAgICAgfVxuICAgICAgICBSLl9pbnNlcnRhZnRlcih0aGlzLCBlbGVtZW50LCB0aGlzLnBhcGVyKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBlbHByb3RvLmluc2VydEJlZm9yZSA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgIGlmICh0aGlzLnJlbW92ZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChlbGVtZW50LmNvbnN0cnVjdG9yID09IFIuc3QuY29uc3RydWN0b3IpIHtcbiAgICAgICAgICAgIGVsZW1lbnQgPSBlbGVtZW50WzBdO1xuICAgICAgICB9XG4gICAgICAgIGVsZW1lbnQubm9kZS5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh0aGlzLm5vZGUsIGVsZW1lbnQubm9kZSk7XG4gICAgICAgIFIuX2luc2VydGJlZm9yZSh0aGlzLCBlbGVtZW50LCB0aGlzLnBhcGVyKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBlbHByb3RvLmJsdXIgPSBmdW5jdGlvbiAoc2l6ZSkge1xuICAgICAgICB2YXIgcyA9IHRoaXMubm9kZS5ydW50aW1lU3R5bGUsXG4gICAgICAgICAgICBmID0gcy5maWx0ZXI7XG4gICAgICAgIGYgPSBmLnJlcGxhY2UoYmx1cnJlZ2V4cCwgRSk7XG4gICAgICAgIGlmICgrc2l6ZSAhPT0gMCkge1xuICAgICAgICAgICAgdGhpcy5hdHRycy5ibHVyID0gc2l6ZTtcbiAgICAgICAgICAgIHMuZmlsdGVyID0gZiArIFMgKyBtcyArIFwiLkJsdXIocGl4ZWxyYWRpdXM9XCIgKyAoK3NpemUgfHwgMS41KSArIFwiKVwiO1xuICAgICAgICAgICAgcy5tYXJnaW4gPSBSLmZvcm1hdChcIi17MH1weCAwIDAgLXswfXB4XCIsIHJvdW5kKCtzaXplIHx8IDEuNSkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcy5maWx0ZXIgPSBmO1xuICAgICAgICAgICAgcy5tYXJnaW4gPSAwO1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMuYXR0cnMuYmx1cjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuXG4gICAgUi5fZW5naW5lLnBhdGggPSBmdW5jdGlvbiAocGF0aFN0cmluZywgdm1sKSB7XG4gICAgICAgIHZhciBlbCA9IGNyZWF0ZU5vZGUoXCJzaGFwZVwiKTtcbiAgICAgICAgZWwuc3R5bGUuY3NzVGV4dCA9IGNzc0RvdDtcbiAgICAgICAgZWwuY29vcmRzaXplID0gem9vbSArIFMgKyB6b29tO1xuICAgICAgICBlbC5jb29yZG9yaWdpbiA9IHZtbC5jb29yZG9yaWdpbjtcbiAgICAgICAgdmFyIHAgPSBuZXcgRWxlbWVudChlbCwgdm1sKSxcbiAgICAgICAgICAgIGF0dHIgPSB7ZmlsbDogXCJub25lXCIsIHN0cm9rZTogXCIjMDAwXCJ9O1xuICAgICAgICBwYXRoU3RyaW5nICYmIChhdHRyLnBhdGggPSBwYXRoU3RyaW5nKTtcbiAgICAgICAgcC50eXBlID0gXCJwYXRoXCI7XG4gICAgICAgIHAucGF0aCA9IFtdO1xuICAgICAgICBwLlBhdGggPSBFO1xuICAgICAgICBzZXRGaWxsQW5kU3Ryb2tlKHAsIGF0dHIpO1xuICAgICAgICB2bWwuY2FudmFzICYmIHZtbC5jYW52YXMuYXBwZW5kQ2hpbGQoZWwpO1xuICAgICAgICB2YXIgc2tldyA9IGNyZWF0ZU5vZGUoXCJza2V3XCIpO1xuICAgICAgICBza2V3Lm9uID0gdHJ1ZTtcbiAgICAgICAgZWwuYXBwZW5kQ2hpbGQoc2tldyk7XG4gICAgICAgIHAuc2tldyA9IHNrZXc7XG4gICAgICAgIHAudHJhbnNmb3JtKEUpO1xuICAgICAgICByZXR1cm4gcDtcbiAgICB9O1xuICAgIFIuX2VuZ2luZS5yZWN0ID0gZnVuY3Rpb24gKHZtbCwgeCwgeSwgdywgaCwgcikge1xuICAgICAgICB2YXIgcGF0aCA9IFIuX3JlY3RQYXRoKHgsIHksIHcsIGgsIHIpLFxuICAgICAgICAgICAgcmVzID0gdm1sLnBhdGgocGF0aCksXG4gICAgICAgICAgICBhID0gcmVzLmF0dHJzO1xuICAgICAgICByZXMuWCA9IGEueCA9IHg7XG4gICAgICAgIHJlcy5ZID0gYS55ID0geTtcbiAgICAgICAgcmVzLlcgPSBhLndpZHRoID0gdztcbiAgICAgICAgcmVzLkggPSBhLmhlaWdodCA9IGg7XG4gICAgICAgIGEuciA9IHI7XG4gICAgICAgIGEucGF0aCA9IHBhdGg7XG4gICAgICAgIHJlcy50eXBlID0gXCJyZWN0XCI7XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfTtcbiAgICBSLl9lbmdpbmUuZWxsaXBzZSA9IGZ1bmN0aW9uICh2bWwsIHgsIHksIHJ4LCByeSkge1xuICAgICAgICB2YXIgcmVzID0gdm1sLnBhdGgoKSxcbiAgICAgICAgICAgIGEgPSByZXMuYXR0cnM7XG4gICAgICAgIHJlcy5YID0geCAtIHJ4O1xuICAgICAgICByZXMuWSA9IHkgLSByeTtcbiAgICAgICAgcmVzLlcgPSByeCAqIDI7XG4gICAgICAgIHJlcy5IID0gcnkgKiAyO1xuICAgICAgICByZXMudHlwZSA9IFwiZWxsaXBzZVwiO1xuICAgICAgICBzZXRGaWxsQW5kU3Ryb2tlKHJlcywge1xuICAgICAgICAgICAgY3g6IHgsXG4gICAgICAgICAgICBjeTogeSxcbiAgICAgICAgICAgIHJ4OiByeCxcbiAgICAgICAgICAgIHJ5OiByeVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9O1xuICAgIFIuX2VuZ2luZS5jaXJjbGUgPSBmdW5jdGlvbiAodm1sLCB4LCB5LCByKSB7XG4gICAgICAgIHZhciByZXMgPSB2bWwucGF0aCgpLFxuICAgICAgICAgICAgYSA9IHJlcy5hdHRycztcbiAgICAgICAgcmVzLlggPSB4IC0gcjtcbiAgICAgICAgcmVzLlkgPSB5IC0gcjtcbiAgICAgICAgcmVzLlcgPSByZXMuSCA9IHIgKiAyO1xuICAgICAgICByZXMudHlwZSA9IFwiY2lyY2xlXCI7XG4gICAgICAgIHNldEZpbGxBbmRTdHJva2UocmVzLCB7XG4gICAgICAgICAgICBjeDogeCxcbiAgICAgICAgICAgIGN5OiB5LFxuICAgICAgICAgICAgcjogclxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9O1xuICAgIFIuX2VuZ2luZS5pbWFnZSA9IGZ1bmN0aW9uICh2bWwsIHNyYywgeCwgeSwgdywgaCkge1xuICAgICAgICB2YXIgcGF0aCA9IFIuX3JlY3RQYXRoKHgsIHksIHcsIGgpLFxuICAgICAgICAgICAgcmVzID0gdm1sLnBhdGgocGF0aCkuYXR0cih7c3Ryb2tlOiBcIm5vbmVcIn0pLFxuICAgICAgICAgICAgYSA9IHJlcy5hdHRycyxcbiAgICAgICAgICAgIG5vZGUgPSByZXMubm9kZSxcbiAgICAgICAgICAgIGZpbGwgPSBub2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKGZpbGxTdHJpbmcpWzBdO1xuICAgICAgICBhLnNyYyA9IHNyYztcbiAgICAgICAgcmVzLlggPSBhLnggPSB4O1xuICAgICAgICByZXMuWSA9IGEueSA9IHk7XG4gICAgICAgIHJlcy5XID0gYS53aWR0aCA9IHc7XG4gICAgICAgIHJlcy5IID0gYS5oZWlnaHQgPSBoO1xuICAgICAgICBhLnBhdGggPSBwYXRoO1xuICAgICAgICByZXMudHlwZSA9IFwiaW1hZ2VcIjtcbiAgICAgICAgZmlsbC5wYXJlbnROb2RlID09IG5vZGUgJiYgbm9kZS5yZW1vdmVDaGlsZChmaWxsKTtcbiAgICAgICAgZmlsbC5yb3RhdGUgPSB0cnVlO1xuICAgICAgICBmaWxsLnNyYyA9IHNyYztcbiAgICAgICAgZmlsbC50eXBlID0gXCJ0aWxlXCI7XG4gICAgICAgIHJlcy5fLmZpbGxwb3MgPSBbeCwgeV07XG4gICAgICAgIHJlcy5fLmZpbGxzaXplID0gW3csIGhdO1xuICAgICAgICBub2RlLmFwcGVuZENoaWxkKGZpbGwpO1xuICAgICAgICBzZXRDb29yZHMocmVzLCAxLCAxLCAwLCAwLCAwKTtcbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9O1xuICAgIFIuX2VuZ2luZS50ZXh0ID0gZnVuY3Rpb24gKHZtbCwgeCwgeSwgdGV4dCkge1xuICAgICAgICB2YXIgZWwgPSBjcmVhdGVOb2RlKFwic2hhcGVcIiksXG4gICAgICAgICAgICBwYXRoID0gY3JlYXRlTm9kZShcInBhdGhcIiksXG4gICAgICAgICAgICBvID0gY3JlYXRlTm9kZShcInRleHRwYXRoXCIpO1xuICAgICAgICB4ID0geCB8fCAwO1xuICAgICAgICB5ID0geSB8fCAwO1xuICAgICAgICB0ZXh0ID0gdGV4dCB8fCBcIlwiO1xuICAgICAgICBwYXRoLnYgPSBSLmZvcm1hdChcIm17MH0sezF9bHsyfSx7MX1cIiwgcm91bmQoeCAqIHpvb20pLCByb3VuZCh5ICogem9vbSksIHJvdW5kKHggKiB6b29tKSArIDEpO1xuICAgICAgICBwYXRoLnRleHRwYXRob2sgPSB0cnVlO1xuICAgICAgICBvLnN0cmluZyA9IFN0cih0ZXh0KTtcbiAgICAgICAgby5vbiA9IHRydWU7XG4gICAgICAgIGVsLnN0eWxlLmNzc1RleHQgPSBjc3NEb3Q7XG4gICAgICAgIGVsLmNvb3Jkc2l6ZSA9IHpvb20gKyBTICsgem9vbTtcbiAgICAgICAgZWwuY29vcmRvcmlnaW4gPSBcIjAgMFwiO1xuICAgICAgICB2YXIgcCA9IG5ldyBFbGVtZW50KGVsLCB2bWwpLFxuICAgICAgICAgICAgYXR0ciA9IHtcbiAgICAgICAgICAgICAgICBmaWxsOiBcIiMwMDBcIixcbiAgICAgICAgICAgICAgICBzdHJva2U6IFwibm9uZVwiLFxuICAgICAgICAgICAgICAgIGZvbnQ6IFIuX2F2YWlsYWJsZUF0dHJzLmZvbnQsXG4gICAgICAgICAgICAgICAgdGV4dDogdGV4dFxuICAgICAgICAgICAgfTtcbiAgICAgICAgcC5zaGFwZSA9IGVsO1xuICAgICAgICBwLnBhdGggPSBwYXRoO1xuICAgICAgICBwLnRleHRwYXRoID0gbztcbiAgICAgICAgcC50eXBlID0gXCJ0ZXh0XCI7XG4gICAgICAgIHAuYXR0cnMudGV4dCA9IFN0cih0ZXh0KTtcbiAgICAgICAgcC5hdHRycy54ID0geDtcbiAgICAgICAgcC5hdHRycy55ID0geTtcbiAgICAgICAgcC5hdHRycy53ID0gMTtcbiAgICAgICAgcC5hdHRycy5oID0gMTtcbiAgICAgICAgc2V0RmlsbEFuZFN0cm9rZShwLCBhdHRyKTtcbiAgICAgICAgZWwuYXBwZW5kQ2hpbGQobyk7XG4gICAgICAgIGVsLmFwcGVuZENoaWxkKHBhdGgpO1xuICAgICAgICB2bWwuY2FudmFzLmFwcGVuZENoaWxkKGVsKTtcbiAgICAgICAgdmFyIHNrZXcgPSBjcmVhdGVOb2RlKFwic2tld1wiKTtcbiAgICAgICAgc2tldy5vbiA9IHRydWU7XG4gICAgICAgIGVsLmFwcGVuZENoaWxkKHNrZXcpO1xuICAgICAgICBwLnNrZXcgPSBza2V3O1xuICAgICAgICBwLnRyYW5zZm9ybShFKTtcbiAgICAgICAgcmV0dXJuIHA7XG4gICAgfTtcbiAgICBSLl9lbmdpbmUuc2V0U2l6ZSA9IGZ1bmN0aW9uICh3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgIHZhciBjcyA9IHRoaXMuY2FudmFzLnN0eWxlO1xuICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7XG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgICAgICB3aWR0aCA9PSArd2lkdGggJiYgKHdpZHRoICs9IFwicHhcIik7XG4gICAgICAgIGhlaWdodCA9PSAraGVpZ2h0ICYmIChoZWlnaHQgKz0gXCJweFwiKTtcbiAgICAgICAgY3Mud2lkdGggPSB3aWR0aDtcbiAgICAgICAgY3MuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgICAgICBjcy5jbGlwID0gXCJyZWN0KDAgXCIgKyB3aWR0aCArIFwiIFwiICsgaGVpZ2h0ICsgXCIgMClcIjtcbiAgICAgICAgaWYgKHRoaXMuX3ZpZXdCb3gpIHtcbiAgICAgICAgICAgIFIuX2VuZ2luZS5zZXRWaWV3Qm94LmFwcGx5KHRoaXMsIHRoaXMuX3ZpZXdCb3gpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgUi5fZW5naW5lLnNldFZpZXdCb3ggPSBmdW5jdGlvbiAoeCwgeSwgdywgaCwgZml0KSB7XG4gICAgICAgIFIuZXZlKFwicmFwaGFlbC5zZXRWaWV3Qm94XCIsIHRoaXMsIHRoaXMuX3ZpZXdCb3gsIFt4LCB5LCB3LCBoLCBmaXRdKTtcbiAgICAgICAgdmFyIHBhcGVyU2l6ZSA9IHRoaXMuZ2V0U2l6ZSgpLFxuICAgICAgICAgICAgd2lkdGggPSBwYXBlclNpemUud2lkdGgsXG4gICAgICAgICAgICBoZWlnaHQgPSBwYXBlclNpemUuaGVpZ2h0LFxuICAgICAgICAgICAgSCwgVztcbiAgICAgICAgaWYgKGZpdCkge1xuICAgICAgICAgICAgSCA9IGhlaWdodCAvIGg7XG4gICAgICAgICAgICBXID0gd2lkdGggLyB3O1xuICAgICAgICAgICAgaWYgKHcgKiBIIDwgd2lkdGgpIHtcbiAgICAgICAgICAgICAgICB4IC09ICh3aWR0aCAtIHcgKiBIKSAvIDIgLyBIO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGggKiBXIDwgaGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgeSAtPSAoaGVpZ2h0IC0gaCAqIFcpIC8gMiAvIFc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fdmlld0JveCA9IFt4LCB5LCB3LCBoLCAhIWZpdF07XG4gICAgICAgIHRoaXMuX3ZpZXdCb3hTaGlmdCA9IHtcbiAgICAgICAgICAgIGR4OiAteCxcbiAgICAgICAgICAgIGR5OiAteSxcbiAgICAgICAgICAgIHNjYWxlOiBwYXBlclNpemVcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5mb3JFYWNoKGZ1bmN0aW9uIChlbCkge1xuICAgICAgICAgICAgZWwudHJhbnNmb3JtKFwiLi4uXCIpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICB2YXIgY3JlYXRlTm9kZTtcbiAgICBSLl9lbmdpbmUuaW5pdFdpbiA9IGZ1bmN0aW9uICh3aW4pIHtcbiAgICAgICAgICAgIHZhciBkb2MgPSB3aW4uZG9jdW1lbnQ7XG4gICAgICAgICAgICBpZiAoZG9jLnN0eWxlU2hlZXRzLmxlbmd0aCA8IDMxKSB7XG4gICAgICAgICAgICAgICAgZG9jLmNyZWF0ZVN0eWxlU2hlZXQoKS5hZGRSdWxlKFwiLnJ2bWxcIiwgXCJiZWhhdmlvcjp1cmwoI2RlZmF1bHQjVk1MKVwiKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gbm8gbW9yZSByb29tLCBhZGQgdG8gdGhlIGV4aXN0aW5nIG9uZVxuICAgICAgICAgICAgICAgIC8vIGh0dHA6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS9tczUzMTE5NCUyOFZTLjg1JTI5LmFzcHhcbiAgICAgICAgICAgICAgICBkb2Muc3R5bGVTaGVldHNbMF0uYWRkUnVsZShcIi5ydm1sXCIsIFwiYmVoYXZpb3I6dXJsKCNkZWZhdWx0I1ZNTClcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICFkb2MubmFtZXNwYWNlcy5ydm1sICYmIGRvYy5uYW1lc3BhY2VzLmFkZChcInJ2bWxcIiwgXCJ1cm46c2NoZW1hcy1taWNyb3NvZnQtY29tOnZtbFwiKTtcbiAgICAgICAgICAgICAgICBjcmVhdGVOb2RlID0gZnVuY3Rpb24gKHRhZ05hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRvYy5jcmVhdGVFbGVtZW50KCc8cnZtbDonICsgdGFnTmFtZSArICcgY2xhc3M9XCJydm1sXCI+Jyk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBjcmVhdGVOb2RlID0gZnVuY3Rpb24gKHRhZ05hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRvYy5jcmVhdGVFbGVtZW50KCc8JyArIHRhZ05hbWUgKyAnIHhtbG5zPVwidXJuOnNjaGVtYXMtbWljcm9zb2Z0LmNvbTp2bWxcIiBjbGFzcz1cInJ2bWxcIj4nKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIFIuX2VuZ2luZS5pbml0V2luKFIuX2cud2luKTtcbiAgICBSLl9lbmdpbmUuY3JlYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY29uID0gUi5fZ2V0Q29udGFpbmVyLmFwcGx5KDAsIGFyZ3VtZW50cyksXG4gICAgICAgICAgICBjb250YWluZXIgPSBjb24uY29udGFpbmVyLFxuICAgICAgICAgICAgaGVpZ2h0ID0gY29uLmhlaWdodCxcbiAgICAgICAgICAgIHMsXG4gICAgICAgICAgICB3aWR0aCA9IGNvbi53aWR0aCxcbiAgICAgICAgICAgIHggPSBjb24ueCxcbiAgICAgICAgICAgIHkgPSBjb24ueTtcbiAgICAgICAgaWYgKCFjb250YWluZXIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlZNTCBjb250YWluZXIgbm90IGZvdW5kLlwiKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcmVzID0gbmV3IFIuX1BhcGVyLFxuICAgICAgICAgICAgYyA9IHJlcy5jYW52YXMgPSBSLl9nLmRvYy5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLFxuICAgICAgICAgICAgY3MgPSBjLnN0eWxlO1xuICAgICAgICB4ID0geCB8fCAwO1xuICAgICAgICB5ID0geSB8fCAwO1xuICAgICAgICB3aWR0aCA9IHdpZHRoIHx8IDUxMjtcbiAgICAgICAgaGVpZ2h0ID0gaGVpZ2h0IHx8IDM0MjtcbiAgICAgICAgcmVzLndpZHRoID0gd2lkdGg7XG4gICAgICAgIHJlcy5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgICAgIHdpZHRoID09ICt3aWR0aCAmJiAod2lkdGggKz0gXCJweFwiKTtcbiAgICAgICAgaGVpZ2h0ID09ICtoZWlnaHQgJiYgKGhlaWdodCArPSBcInB4XCIpO1xuICAgICAgICByZXMuY29vcmRzaXplID0gem9vbSAqIDFlMyArIFMgKyB6b29tICogMWUzO1xuICAgICAgICByZXMuY29vcmRvcmlnaW4gPSBcIjAgMFwiO1xuICAgICAgICByZXMuc3BhbiA9IFIuX2cuZG9jLmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xuICAgICAgICByZXMuc3Bhbi5zdHlsZS5jc3NUZXh0ID0gXCJwb3NpdGlvbjphYnNvbHV0ZTtsZWZ0Oi05OTk5ZW07dG9wOi05OTk5ZW07cGFkZGluZzowO21hcmdpbjowO2xpbmUtaGVpZ2h0OjE7XCI7XG4gICAgICAgIGMuYXBwZW5kQ2hpbGQocmVzLnNwYW4pO1xuICAgICAgICBjcy5jc3NUZXh0ID0gUi5mb3JtYXQoXCJ0b3A6MDtsZWZ0OjA7d2lkdGg6ezB9O2hlaWdodDp7MX07ZGlzcGxheTppbmxpbmUtYmxvY2s7cG9zaXRpb246cmVsYXRpdmU7Y2xpcDpyZWN0KDAgezB9IHsxfSAwKTtvdmVyZmxvdzpoaWRkZW5cIiwgd2lkdGgsIGhlaWdodCk7XG4gICAgICAgIGlmIChjb250YWluZXIgPT0gMSkge1xuICAgICAgICAgICAgUi5fZy5kb2MuYm9keS5hcHBlbmRDaGlsZChjKTtcbiAgICAgICAgICAgIGNzLmxlZnQgPSB4ICsgXCJweFwiO1xuICAgICAgICAgICAgY3MudG9wID0geSArIFwicHhcIjtcbiAgICAgICAgICAgIGNzLnBvc2l0aW9uID0gXCJhYnNvbHV0ZVwiO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKGNvbnRhaW5lci5maXJzdENoaWxkKSB7XG4gICAgICAgICAgICAgICAgY29udGFpbmVyLmluc2VydEJlZm9yZShjLCBjb250YWluZXIuZmlyc3RDaGlsZCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChjKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXMucmVuZGVyZml4ID0gZnVuY3Rpb24gKCkge307XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfTtcbiAgICBSLnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgUi5ldmUoXCJyYXBoYWVsLmNsZWFyXCIsIHRoaXMpO1xuICAgICAgICB0aGlzLmNhbnZhcy5pbm5lckhUTUwgPSBFO1xuICAgICAgICB0aGlzLnNwYW4gPSBSLl9nLmRvYy5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcbiAgICAgICAgdGhpcy5zcGFuLnN0eWxlLmNzc1RleHQgPSBcInBvc2l0aW9uOmFic29sdXRlO2xlZnQ6LTk5OTllbTt0b3A6LTk5OTllbTtwYWRkaW5nOjA7bWFyZ2luOjA7bGluZS1oZWlnaHQ6MTtkaXNwbGF5OmlubGluZTtcIjtcbiAgICAgICAgdGhpcy5jYW52YXMuYXBwZW5kQ2hpbGQodGhpcy5zcGFuKTtcbiAgICAgICAgdGhpcy5ib3R0b20gPSB0aGlzLnRvcCA9IG51bGw7XG4gICAgfTtcbiAgICBSLnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIFIuZXZlKFwicmFwaGFlbC5yZW1vdmVcIiwgdGhpcyk7XG4gICAgICAgIHRoaXMuY2FudmFzLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5jYW52YXMpO1xuICAgICAgICBmb3IgKHZhciBpIGluIHRoaXMpIHtcbiAgICAgICAgICAgIHRoaXNbaV0gPSB0eXBlb2YgdGhpc1tpXSA9PSBcImZ1bmN0aW9uXCIgPyBSLl9yZW1vdmVkRmFjdG9yeShpKSA6IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcblxuICAgIHZhciBzZXRwcm90byA9IFIuc3Q7XG4gICAgZm9yICh2YXIgbWV0aG9kIGluIGVscHJvdG8pIGlmIChlbHByb3RvW2hhc10obWV0aG9kKSAmJiAhc2V0cHJvdG9baGFzXShtZXRob2QpKSB7XG4gICAgICAgIHNldHByb3RvW21ldGhvZF0gPSAoZnVuY3Rpb24gKG1ldGhvZG5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGFyZyA9IGFyZ3VtZW50cztcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5mb3JFYWNoKGZ1bmN0aW9uIChlbCkge1xuICAgICAgICAgICAgICAgICAgICBlbFttZXRob2RuYW1lXS5hcHBseShlbCwgYXJnKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pKG1ldGhvZCk7XG4gICAgfVxufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./dev/raphael.vml.js\n')},"./node_modules/eve-raphael/eve.js":function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// Copyright (c) 2013 Adobe Systems Incorporated. All rights reserved.\n// \n// Licensed under the Apache License, Version 2.0 (the "License");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n// \n// http://www.apache.org/licenses/LICENSE-2.0\n// \n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an "AS IS" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n// ┌────────────────────────────────────────────────────────────┐ \\\\\n// │ Eve 0.5.0 - JavaScript Events Library                      │ \\\\\n// ├────────────────────────────────────────────────────────────┤ \\\\\n// │ Author Dmitry Baranovskiy (http://dmitry.baranovskiy.com/) │ \\\\\n// └────────────────────────────────────────────────────────────┘ \\\\\n\n(function (glob) {\n    var version = "0.5.0",\n        has = "hasOwnProperty",\n        separator = /[\\.\\/]/,\n        comaseparator = /\\s*,\\s*/,\n        wildcard = "*",\n        fun = function () {},\n        numsort = function (a, b) {\n            return a - b;\n        },\n        current_event,\n        stop,\n        events = {n: {}},\n        firstDefined = function () {\n            for (var i = 0, ii = this.length; i < ii; i++) {\n                if (typeof this[i] != "undefined") {\n                    return this[i];\n                }\n            }\n        },\n        lastDefined = function () {\n            var i = this.length;\n            while (--i) {\n                if (typeof this[i] != "undefined") {\n                    return this[i];\n                }\n            }\n        },\n        objtos = Object.prototype.toString,\n        Str = String,\n        isArray = Array.isArray || function (ar) {\n            return ar instanceof Array || objtos.call(ar) == "[object Array]";\n        };\n    /*\\\n     * eve\n     [ method ]\n\n     * Fires event with given `name`, given scope and other parameters.\n\n     > Arguments\n\n     - name (string) name of the *event*, dot (`.`) or slash (`/`) separated\n     - scope (object) context for the event handlers\n     - varargs (...) the rest of arguments will be sent to event handlers\n\n     = (object) array of returned values from the listeners. Array has two methods `.firstDefined()` and `.lastDefined()` to get first or last not `undefined` value.\n    \\*/\n        var eve = function (name, scope) {\n            var e = events,\n                oldstop = stop,\n                args = Array.prototype.slice.call(arguments, 2),\n                listeners = eve.listeners(name),\n                z = 0,\n                f = false,\n                l,\n                indexed = [],\n                queue = {},\n                out = [],\n                ce = current_event,\n                errors = [];\n            out.firstDefined = firstDefined;\n            out.lastDefined = lastDefined;\n            current_event = name;\n            stop = 0;\n            for (var i = 0, ii = listeners.length; i < ii; i++) if ("zIndex" in listeners[i]) {\n                indexed.push(listeners[i].zIndex);\n                if (listeners[i].zIndex < 0) {\n                    queue[listeners[i].zIndex] = listeners[i];\n                }\n            }\n            indexed.sort(numsort);\n            while (indexed[z] < 0) {\n                l = queue[indexed[z++]];\n                out.push(l.apply(scope, args));\n                if (stop) {\n                    stop = oldstop;\n                    return out;\n                }\n            }\n            for (i = 0; i < ii; i++) {\n                l = listeners[i];\n                if ("zIndex" in l) {\n                    if (l.zIndex == indexed[z]) {\n                        out.push(l.apply(scope, args));\n                        if (stop) {\n                            break;\n                        }\n                        do {\n                            z++;\n                            l = queue[indexed[z]];\n                            l && out.push(l.apply(scope, args));\n                            if (stop) {\n                                break;\n                            }\n                        } while (l)\n                    } else {\n                        queue[l.zIndex] = l;\n                    }\n                } else {\n                    out.push(l.apply(scope, args));\n                    if (stop) {\n                        break;\n                    }\n                }\n            }\n            stop = oldstop;\n            current_event = ce;\n            return out;\n        };\n        // Undocumented. Debug only.\n        eve._events = events;\n    /*\\\n     * eve.listeners\n     [ method ]\n\n     * Internal method which gives you array of all event handlers that will be triggered by the given `name`.\n\n     > Arguments\n\n     - name (string) name of the event, dot (`.`) or slash (`/`) separated\n\n     = (array) array of event handlers\n    \\*/\n    eve.listeners = function (name) {\n        var names = isArray(name) ? name : name.split(separator),\n            e = events,\n            item,\n            items,\n            k,\n            i,\n            ii,\n            j,\n            jj,\n            nes,\n            es = [e],\n            out = [];\n        for (i = 0, ii = names.length; i < ii; i++) {\n            nes = [];\n            for (j = 0, jj = es.length; j < jj; j++) {\n                e = es[j].n;\n                items = [e[names[i]], e[wildcard]];\n                k = 2;\n                while (k--) {\n                    item = items[k];\n                    if (item) {\n                        nes.push(item);\n                        out = out.concat(item.f || []);\n                    }\n                }\n            }\n            es = nes;\n        }\n        return out;\n    };\n    /*\\\n     * eve.separator\n     [ method ]\n\n     * If for some reasons you don’t like default separators (`.` or `/`) you can specify yours\n     * here. Be aware that if you pass a string longer than one character it will be treated as\n     * a list of characters.\n\n     - separator (string) new separator. Empty string resets to default: `.` or `/`.\n    \\*/\n    eve.separator = function (sep) {\n        if (sep) {\n            sep = Str(sep).replace(/(?=[\\.\\^\\]\\[\\-])/g, "\\\\");\n            sep = "[" + sep + "]";\n            separator = new RegExp(sep);\n        } else {\n            separator = /[\\.\\/]/;\n        }\n    };\n    /*\\\n     * eve.on\n     [ method ]\n     **\n     * Binds given event handler with a given name. You can use wildcards “`*`” for the names:\n     | eve.on("*.under.*", f);\n     | eve("mouse.under.floor"); // triggers f\n     * Use @eve to trigger the listener.\n     **\n     - name (string) name of the event, dot (`.`) or slash (`/`) separated, with optional wildcards\n     - f (function) event handler function\n     **\n     - name (array) if you don’t want to use separators, you can use array of strings\n     - f (function) event handler function\n     **\n     = (function) returned function accepts a single numeric parameter that represents z-index of the handler. It is an optional feature and only used when you need to ensure that some subset of handlers will be invoked in a given order, despite of the order of assignment. \n     > Example:\n     | eve.on("mouse", eatIt)(2);\n     | eve.on("mouse", scream);\n     | eve.on("mouse", catchIt)(1);\n     * This will ensure that `catchIt` function will be called before `eatIt`.\n     *\n     * If you want to put your handler before non-indexed handlers, specify a negative value.\n     * Note: I assume most of the time you don’t need to worry about z-index, but it’s nice to have this feature “just in case”.\n    \\*/\n    eve.on = function (name, f) {\n        if (typeof f != "function") {\n            return function () {};\n        }\n        var names = isArray(name) ? (isArray(name[0]) ? name : [name]) : Str(name).split(comaseparator);\n        for (var i = 0, ii = names.length; i < ii; i++) {\n            (function (name) {\n                var names = isArray(name) ? name : Str(name).split(separator),\n                    e = events,\n                    exist;\n                for (var i = 0, ii = names.length; i < ii; i++) {\n                    e = e.n;\n                    e = e.hasOwnProperty(names[i]) && e[names[i]] || (e[names[i]] = {n: {}});\n                }\n                e.f = e.f || [];\n                for (i = 0, ii = e.f.length; i < ii; i++) if (e.f[i] == f) {\n                    exist = true;\n                    break;\n                }\n                !exist && e.f.push(f);\n            }(names[i]));\n        }\n        return function (zIndex) {\n            if (+zIndex == +zIndex) {\n                f.zIndex = +zIndex;\n            }\n        };\n    };\n    /*\\\n     * eve.f\n     [ method ]\n     **\n     * Returns function that will fire given event with optional arguments.\n     * Arguments that will be passed to the result function will be also\n     * concated to the list of final arguments.\n     | el.onclick = eve.f("click", 1, 2);\n     | eve.on("click", function (a, b, c) {\n     |     console.log(a, b, c); // 1, 2, [event object]\n     | });\n     > Arguments\n     - event (string) event name\n     - varargs (…) and any other arguments\n     = (function) possible event handler function\n    \\*/\n    eve.f = function (event) {\n        var attrs = [].slice.call(arguments, 1);\n        return function () {\n            eve.apply(null, [event, null].concat(attrs).concat([].slice.call(arguments, 0)));\n        };\n    };\n    /*\\\n     * eve.stop\n     [ method ]\n     **\n     * Is used inside an event handler to stop the event, preventing any subsequent listeners from firing.\n    \\*/\n    eve.stop = function () {\n        stop = 1;\n    };\n    /*\\\n     * eve.nt\n     [ method ]\n     **\n     * Could be used inside event handler to figure out actual name of the event.\n     **\n     > Arguments\n     **\n     - subname (string) #optional subname of the event\n     **\n     = (string) name of the event, if `subname` is not specified\n     * or\n     = (boolean) `true`, if current event’s name contains `subname`\n    \\*/\n    eve.nt = function (subname) {\n        var cur = isArray(current_event) ? current_event.join(".") : current_event;\n        if (subname) {\n            return new RegExp("(?:\\\\.|\\\\/|^)" + subname + "(?:\\\\.|\\\\/|$)").test(cur);\n        }\n        return cur;\n    };\n    /*\\\n     * eve.nts\n     [ method ]\n     **\n     * Could be used inside event handler to figure out actual name of the event.\n     **\n     **\n     = (array) names of the event\n    \\*/\n    eve.nts = function () {\n        return isArray(current_event) ? current_event : current_event.split(separator);\n    };\n    /*\\\n     * eve.off\n     [ method ]\n     **\n     * Removes given function from the list of event listeners assigned to given name.\n     * If no arguments specified all the events will be cleared.\n     **\n     > Arguments\n     **\n     - name (string) name of the event, dot (`.`) or slash (`/`) separated, with optional wildcards\n     - f (function) event handler function\n    \\*/\n    /*\\\n     * eve.unbind\n     [ method ]\n     **\n     * See @eve.off\n    \\*/\n    eve.off = eve.unbind = function (name, f) {\n        if (!name) {\n            eve._events = events = {n: {}};\n            return;\n        }\n        var names = isArray(name) ? (isArray(name[0]) ? name : [name]) : Str(name).split(comaseparator);\n        if (names.length > 1) {\n            for (var i = 0, ii = names.length; i < ii; i++) {\n                eve.off(names[i], f);\n            }\n            return;\n        }\n        names = isArray(name) ? name : Str(name).split(separator);\n        var e,\n            key,\n            splice,\n            i, ii, j, jj,\n            cur = [events];\n        for (i = 0, ii = names.length; i < ii; i++) {\n            for (j = 0; j < cur.length; j += splice.length - 2) {\n                splice = [j, 1];\n                e = cur[j].n;\n                if (names[i] != wildcard) {\n                    if (e[names[i]]) {\n                        splice.push(e[names[i]]);\n                    }\n                } else {\n                    for (key in e) if (e[has](key)) {\n                        splice.push(e[key]);\n                    }\n                }\n                cur.splice.apply(cur, splice);\n            }\n        }\n        for (i = 0, ii = cur.length; i < ii; i++) {\n            e = cur[i];\n            while (e.n) {\n                if (f) {\n                    if (e.f) {\n                        for (j = 0, jj = e.f.length; j < jj; j++) if (e.f[j] == f) {\n                            e.f.splice(j, 1);\n                            break;\n                        }\n                        !e.f.length && delete e.f;\n                    }\n                    for (key in e.n) if (e.n[has](key) && e.n[key].f) {\n                        var funcs = e.n[key].f;\n                        for (j = 0, jj = funcs.length; j < jj; j++) if (funcs[j] == f) {\n                            funcs.splice(j, 1);\n                            break;\n                        }\n                        !funcs.length && delete e.n[key].f;\n                    }\n                } else {\n                    delete e.f;\n                    for (key in e.n) if (e.n[has](key) && e.n[key].f) {\n                        delete e.n[key].f;\n                    }\n                }\n                e = e.n;\n            }\n        }\n    };\n    /*\\\n     * eve.once\n     [ method ]\n     **\n     * Binds given event handler with a given name to only run once then unbind itself.\n     | eve.once("login", f);\n     | eve("login"); // triggers f\n     | eve("login"); // no listeners\n     * Use @eve to trigger the listener.\n     **\n     > Arguments\n     **\n     - name (string) name of the event, dot (`.`) or slash (`/`) separated, with optional wildcards\n     - f (function) event handler function\n     **\n     = (function) same return function as @eve.on\n    \\*/\n    eve.once = function (name, f) {\n        var f2 = function () {\n            eve.off(name, f2);\n            return f.apply(this, arguments);\n        };\n        return eve.on(name, f2);\n    };\n    /*\\\n     * eve.version\n     [ property (string) ]\n     **\n     * Current version of the library.\n    \\*/\n    eve.version = version;\n    eve.toString = function () {\n        return "You are running Eve " + version;\n    };\n    ( true && module.exports) ? (module.exports = eve) : ( true ? (!(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_RESULT__ = (function() { return eve; }).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__))) : (undefined));\n})(this);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvZXZlLXJhcGhhZWwvZXZlLmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vUmFwaGFlbC8uL25vZGVfbW9kdWxlcy9ldmUtcmFwaGFlbC9ldmUuanM/ZDJiNCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgKGMpIDIwMTMgQWRvYmUgU3lzdGVtcyBJbmNvcnBvcmF0ZWQuIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBcbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4vLyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4vLyBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbi8vIFxuLy8gaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4vLyBcbi8vIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbi8vIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbi8vIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuLy8gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuLy8gbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4vLyDilIzilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilJAgXFxcXFxuLy8g4pSCIEV2ZSAwLjUuMCAtIEphdmFTY3JpcHQgRXZlbnRzIExpYnJhcnkgICAgICAgICAgICAgICAgICAgICAg4pSCIFxcXFxcbi8vIOKUnOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUpCBcXFxcXG4vLyDilIIgQXV0aG9yIERtaXRyeSBCYXJhbm92c2tpeSAoaHR0cDovL2RtaXRyeS5iYXJhbm92c2tpeS5jb20vKSDilIIgXFxcXFxuLy8g4pSU4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSYIFxcXFxcblxuKGZ1bmN0aW9uIChnbG9iKSB7XG4gICAgdmFyIHZlcnNpb24gPSBcIjAuNS4wXCIsXG4gICAgICAgIGhhcyA9IFwiaGFzT3duUHJvcGVydHlcIixcbiAgICAgICAgc2VwYXJhdG9yID0gL1tcXC5cXC9dLyxcbiAgICAgICAgY29tYXNlcGFyYXRvciA9IC9cXHMqLFxccyovLFxuICAgICAgICB3aWxkY2FyZCA9IFwiKlwiLFxuICAgICAgICBmdW4gPSBmdW5jdGlvbiAoKSB7fSxcbiAgICAgICAgbnVtc29ydCA9IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICByZXR1cm4gYSAtIGI7XG4gICAgICAgIH0sXG4gICAgICAgIGN1cnJlbnRfZXZlbnQsXG4gICAgICAgIHN0b3AsXG4gICAgICAgIGV2ZW50cyA9IHtuOiB7fX0sXG4gICAgICAgIGZpcnN0RGVmaW5lZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IHRoaXMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdGhpc1tpXSAhPSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzW2ldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgbGFzdERlZmluZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgaSA9IHRoaXMubGVuZ3RoO1xuICAgICAgICAgICAgd2hpbGUgKC0taSkge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdGhpc1tpXSAhPSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzW2ldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgb2JqdG9zID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZyxcbiAgICAgICAgU3RyID0gU3RyaW5nLFxuICAgICAgICBpc0FycmF5ID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbiAoYXIpIHtcbiAgICAgICAgICAgIHJldHVybiBhciBpbnN0YW5jZW9mIEFycmF5IHx8IG9ianRvcy5jYWxsKGFyKSA9PSBcIltvYmplY3QgQXJyYXldXCI7XG4gICAgICAgIH07XG4gICAgLypcXFxuICAgICAqIGV2ZVxuICAgICBbIG1ldGhvZCBdXG5cbiAgICAgKiBGaXJlcyBldmVudCB3aXRoIGdpdmVuIGBuYW1lYCwgZ2l2ZW4gc2NvcGUgYW5kIG90aGVyIHBhcmFtZXRlcnMuXG5cbiAgICAgPiBBcmd1bWVudHNcblxuICAgICAtIG5hbWUgKHN0cmluZykgbmFtZSBvZiB0aGUgKmV2ZW50KiwgZG90IChgLmApIG9yIHNsYXNoIChgL2ApIHNlcGFyYXRlZFxuICAgICAtIHNjb3BlIChvYmplY3QpIGNvbnRleHQgZm9yIHRoZSBldmVudCBoYW5kbGVyc1xuICAgICAtIHZhcmFyZ3MgKC4uLikgdGhlIHJlc3Qgb2YgYXJndW1lbnRzIHdpbGwgYmUgc2VudCB0byBldmVudCBoYW5kbGVyc1xuXG4gICAgID0gKG9iamVjdCkgYXJyYXkgb2YgcmV0dXJuZWQgdmFsdWVzIGZyb20gdGhlIGxpc3RlbmVycy4gQXJyYXkgaGFzIHR3byBtZXRob2RzIGAuZmlyc3REZWZpbmVkKClgIGFuZCBgLmxhc3REZWZpbmVkKClgIHRvIGdldCBmaXJzdCBvciBsYXN0IG5vdCBgdW5kZWZpbmVkYCB2YWx1ZS5cbiAgICBcXCovXG4gICAgICAgIHZhciBldmUgPSBmdW5jdGlvbiAobmFtZSwgc2NvcGUpIHtcbiAgICAgICAgICAgIHZhciBlID0gZXZlbnRzLFxuICAgICAgICAgICAgICAgIG9sZHN0b3AgPSBzdG9wLFxuICAgICAgICAgICAgICAgIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpLFxuICAgICAgICAgICAgICAgIGxpc3RlbmVycyA9IGV2ZS5saXN0ZW5lcnMobmFtZSksXG4gICAgICAgICAgICAgICAgeiA9IDAsXG4gICAgICAgICAgICAgICAgZiA9IGZhbHNlLFxuICAgICAgICAgICAgICAgIGwsXG4gICAgICAgICAgICAgICAgaW5kZXhlZCA9IFtdLFxuICAgICAgICAgICAgICAgIHF1ZXVlID0ge30sXG4gICAgICAgICAgICAgICAgb3V0ID0gW10sXG4gICAgICAgICAgICAgICAgY2UgPSBjdXJyZW50X2V2ZW50LFxuICAgICAgICAgICAgICAgIGVycm9ycyA9IFtdO1xuICAgICAgICAgICAgb3V0LmZpcnN0RGVmaW5lZCA9IGZpcnN0RGVmaW5lZDtcbiAgICAgICAgICAgIG91dC5sYXN0RGVmaW5lZCA9IGxhc3REZWZpbmVkO1xuICAgICAgICAgICAgY3VycmVudF9ldmVudCA9IG5hbWU7XG4gICAgICAgICAgICBzdG9wID0gMDtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IGxpc3RlbmVycy5sZW5ndGg7IGkgPCBpaTsgaSsrKSBpZiAoXCJ6SW5kZXhcIiBpbiBsaXN0ZW5lcnNbaV0pIHtcbiAgICAgICAgICAgICAgICBpbmRleGVkLnB1c2gobGlzdGVuZXJzW2ldLnpJbmRleCk7XG4gICAgICAgICAgICAgICAgaWYgKGxpc3RlbmVyc1tpXS56SW5kZXggPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHF1ZXVlW2xpc3RlbmVyc1tpXS56SW5kZXhdID0gbGlzdGVuZXJzW2ldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGluZGV4ZWQuc29ydChudW1zb3J0KTtcbiAgICAgICAgICAgIHdoaWxlIChpbmRleGVkW3pdIDwgMCkge1xuICAgICAgICAgICAgICAgIGwgPSBxdWV1ZVtpbmRleGVkW3orK11dO1xuICAgICAgICAgICAgICAgIG91dC5wdXNoKGwuYXBwbHkoc2NvcGUsIGFyZ3MpKTtcbiAgICAgICAgICAgICAgICBpZiAoc3RvcCkge1xuICAgICAgICAgICAgICAgICAgICBzdG9wID0gb2xkc3RvcDtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG91dDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgaWk7IGkrKykge1xuICAgICAgICAgICAgICAgIGwgPSBsaXN0ZW5lcnNbaV07XG4gICAgICAgICAgICAgICAgaWYgKFwiekluZGV4XCIgaW4gbCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobC56SW5kZXggPT0gaW5kZXhlZFt6XSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3V0LnB1c2gobC5hcHBseShzY29wZSwgYXJncykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0b3ApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB6Kys7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbCA9IHF1ZXVlW2luZGV4ZWRbel1dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGwgJiYgb3V0LnB1c2gobC5hcHBseShzY29wZSwgYXJncykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdG9wKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gd2hpbGUgKGwpXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBxdWV1ZVtsLnpJbmRleF0gPSBsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgb3V0LnB1c2gobC5hcHBseShzY29wZSwgYXJncykpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3RvcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzdG9wID0gb2xkc3RvcDtcbiAgICAgICAgICAgIGN1cnJlbnRfZXZlbnQgPSBjZTtcbiAgICAgICAgICAgIHJldHVybiBvdXQ7XG4gICAgICAgIH07XG4gICAgICAgIC8vIFVuZG9jdW1lbnRlZC4gRGVidWcgb25seS5cbiAgICAgICAgZXZlLl9ldmVudHMgPSBldmVudHM7XG4gICAgLypcXFxuICAgICAqIGV2ZS5saXN0ZW5lcnNcbiAgICAgWyBtZXRob2QgXVxuXG4gICAgICogSW50ZXJuYWwgbWV0aG9kIHdoaWNoIGdpdmVzIHlvdSBhcnJheSBvZiBhbGwgZXZlbnQgaGFuZGxlcnMgdGhhdCB3aWxsIGJlIHRyaWdnZXJlZCBieSB0aGUgZ2l2ZW4gYG5hbWVgLlxuXG4gICAgID4gQXJndW1lbnRzXG5cbiAgICAgLSBuYW1lIChzdHJpbmcpIG5hbWUgb2YgdGhlIGV2ZW50LCBkb3QgKGAuYCkgb3Igc2xhc2ggKGAvYCkgc2VwYXJhdGVkXG5cbiAgICAgPSAoYXJyYXkpIGFycmF5IG9mIGV2ZW50IGhhbmRsZXJzXG4gICAgXFwqL1xuICAgIGV2ZS5saXN0ZW5lcnMgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICB2YXIgbmFtZXMgPSBpc0FycmF5KG5hbWUpID8gbmFtZSA6IG5hbWUuc3BsaXQoc2VwYXJhdG9yKSxcbiAgICAgICAgICAgIGUgPSBldmVudHMsXG4gICAgICAgICAgICBpdGVtLFxuICAgICAgICAgICAgaXRlbXMsXG4gICAgICAgICAgICBrLFxuICAgICAgICAgICAgaSxcbiAgICAgICAgICAgIGlpLFxuICAgICAgICAgICAgaixcbiAgICAgICAgICAgIGpqLFxuICAgICAgICAgICAgbmVzLFxuICAgICAgICAgICAgZXMgPSBbZV0sXG4gICAgICAgICAgICBvdXQgPSBbXTtcbiAgICAgICAgZm9yIChpID0gMCwgaWkgPSBuYW1lcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG4gICAgICAgICAgICBuZXMgPSBbXTtcbiAgICAgICAgICAgIGZvciAoaiA9IDAsIGpqID0gZXMubGVuZ3RoOyBqIDwgamo7IGorKykge1xuICAgICAgICAgICAgICAgIGUgPSBlc1tqXS5uO1xuICAgICAgICAgICAgICAgIGl0ZW1zID0gW2VbbmFtZXNbaV1dLCBlW3dpbGRjYXJkXV07XG4gICAgICAgICAgICAgICAgayA9IDI7XG4gICAgICAgICAgICAgICAgd2hpbGUgKGstLSkge1xuICAgICAgICAgICAgICAgICAgICBpdGVtID0gaXRlbXNba107XG4gICAgICAgICAgICAgICAgICAgIGlmIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXMucHVzaChpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG91dCA9IG91dC5jb25jYXQoaXRlbS5mIHx8IFtdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVzID0gbmVzO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbiAgICAvKlxcXG4gICAgICogZXZlLnNlcGFyYXRvclxuICAgICBbIG1ldGhvZCBdXG5cbiAgICAgKiBJZiBmb3Igc29tZSByZWFzb25zIHlvdSBkb27igJl0IGxpa2UgZGVmYXVsdCBzZXBhcmF0b3JzIChgLmAgb3IgYC9gKSB5b3UgY2FuIHNwZWNpZnkgeW91cnNcbiAgICAgKiBoZXJlLiBCZSBhd2FyZSB0aGF0IGlmIHlvdSBwYXNzIGEgc3RyaW5nIGxvbmdlciB0aGFuIG9uZSBjaGFyYWN0ZXIgaXQgd2lsbCBiZSB0cmVhdGVkIGFzXG4gICAgICogYSBsaXN0IG9mIGNoYXJhY3RlcnMuXG5cbiAgICAgLSBzZXBhcmF0b3IgKHN0cmluZykgbmV3IHNlcGFyYXRvci4gRW1wdHkgc3RyaW5nIHJlc2V0cyB0byBkZWZhdWx0OiBgLmAgb3IgYC9gLlxuICAgIFxcKi9cbiAgICBldmUuc2VwYXJhdG9yID0gZnVuY3Rpb24gKHNlcCkge1xuICAgICAgICBpZiAoc2VwKSB7XG4gICAgICAgICAgICBzZXAgPSBTdHIoc2VwKS5yZXBsYWNlKC8oPz1bXFwuXFxeXFxdXFxbXFwtXSkvZywgXCJcXFxcXCIpO1xuICAgICAgICAgICAgc2VwID0gXCJbXCIgKyBzZXAgKyBcIl1cIjtcbiAgICAgICAgICAgIHNlcGFyYXRvciA9IG5ldyBSZWdFeHAoc2VwKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNlcGFyYXRvciA9IC9bXFwuXFwvXS87XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qXFxcbiAgICAgKiBldmUub25cbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIEJpbmRzIGdpdmVuIGV2ZW50IGhhbmRsZXIgd2l0aCBhIGdpdmVuIG5hbWUuIFlvdSBjYW4gdXNlIHdpbGRjYXJkcyDigJxgKmDigJ0gZm9yIHRoZSBuYW1lczpcbiAgICAgfCBldmUub24oXCIqLnVuZGVyLipcIiwgZik7XG4gICAgIHwgZXZlKFwibW91c2UudW5kZXIuZmxvb3JcIik7IC8vIHRyaWdnZXJzIGZcbiAgICAgKiBVc2UgQGV2ZSB0byB0cmlnZ2VyIHRoZSBsaXN0ZW5lci5cbiAgICAgKipcbiAgICAgLSBuYW1lIChzdHJpbmcpIG5hbWUgb2YgdGhlIGV2ZW50LCBkb3QgKGAuYCkgb3Igc2xhc2ggKGAvYCkgc2VwYXJhdGVkLCB3aXRoIG9wdGlvbmFsIHdpbGRjYXJkc1xuICAgICAtIGYgKGZ1bmN0aW9uKSBldmVudCBoYW5kbGVyIGZ1bmN0aW9uXG4gICAgICoqXG4gICAgIC0gbmFtZSAoYXJyYXkpIGlmIHlvdSBkb27igJl0IHdhbnQgdG8gdXNlIHNlcGFyYXRvcnMsIHlvdSBjYW4gdXNlIGFycmF5IG9mIHN0cmluZ3NcbiAgICAgLSBmIChmdW5jdGlvbikgZXZlbnQgaGFuZGxlciBmdW5jdGlvblxuICAgICAqKlxuICAgICA9IChmdW5jdGlvbikgcmV0dXJuZWQgZnVuY3Rpb24gYWNjZXB0cyBhIHNpbmdsZSBudW1lcmljIHBhcmFtZXRlciB0aGF0IHJlcHJlc2VudHMgei1pbmRleCBvZiB0aGUgaGFuZGxlci4gSXQgaXMgYW4gb3B0aW9uYWwgZmVhdHVyZSBhbmQgb25seSB1c2VkIHdoZW4geW91IG5lZWQgdG8gZW5zdXJlIHRoYXQgc29tZSBzdWJzZXQgb2YgaGFuZGxlcnMgd2lsbCBiZSBpbnZva2VkIGluIGEgZ2l2ZW4gb3JkZXIsIGRlc3BpdGUgb2YgdGhlIG9yZGVyIG9mIGFzc2lnbm1lbnQuIFxuICAgICA+IEV4YW1wbGU6XG4gICAgIHwgZXZlLm9uKFwibW91c2VcIiwgZWF0SXQpKDIpO1xuICAgICB8IGV2ZS5vbihcIm1vdXNlXCIsIHNjcmVhbSk7XG4gICAgIHwgZXZlLm9uKFwibW91c2VcIiwgY2F0Y2hJdCkoMSk7XG4gICAgICogVGhpcyB3aWxsIGVuc3VyZSB0aGF0IGBjYXRjaEl0YCBmdW5jdGlvbiB3aWxsIGJlIGNhbGxlZCBiZWZvcmUgYGVhdEl0YC5cbiAgICAgKlxuICAgICAqIElmIHlvdSB3YW50IHRvIHB1dCB5b3VyIGhhbmRsZXIgYmVmb3JlIG5vbi1pbmRleGVkIGhhbmRsZXJzLCBzcGVjaWZ5IGEgbmVnYXRpdmUgdmFsdWUuXG4gICAgICogTm90ZTogSSBhc3N1bWUgbW9zdCBvZiB0aGUgdGltZSB5b3UgZG9u4oCZdCBuZWVkIHRvIHdvcnJ5IGFib3V0IHotaW5kZXgsIGJ1dCBpdOKAmXMgbmljZSB0byBoYXZlIHRoaXMgZmVhdHVyZSDigJxqdXN0IGluIGNhc2XigJ0uXG4gICAgXFwqL1xuICAgIGV2ZS5vbiA9IGZ1bmN0aW9uIChuYW1lLCBmKSB7XG4gICAgICAgIGlmICh0eXBlb2YgZiAhPSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7fTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbmFtZXMgPSBpc0FycmF5KG5hbWUpID8gKGlzQXJyYXkobmFtZVswXSkgPyBuYW1lIDogW25hbWVdKSA6IFN0cihuYW1lKS5zcGxpdChjb21hc2VwYXJhdG9yKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gbmFtZXMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuICAgICAgICAgICAgKGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5hbWVzID0gaXNBcnJheShuYW1lKSA/IG5hbWUgOiBTdHIobmFtZSkuc3BsaXQoc2VwYXJhdG9yKSxcbiAgICAgICAgICAgICAgICAgICAgZSA9IGV2ZW50cyxcbiAgICAgICAgICAgICAgICAgICAgZXhpc3Q7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gbmFtZXMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBlID0gZS5uO1xuICAgICAgICAgICAgICAgICAgICBlID0gZS5oYXNPd25Qcm9wZXJ0eShuYW1lc1tpXSkgJiYgZVtuYW1lc1tpXV0gfHwgKGVbbmFtZXNbaV1dID0ge246IHt9fSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGUuZiA9IGUuZiB8fCBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwLCBpaSA9IGUuZi5sZW5ndGg7IGkgPCBpaTsgaSsrKSBpZiAoZS5mW2ldID09IGYpIHtcbiAgICAgICAgICAgICAgICAgICAgZXhpc3QgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgIWV4aXN0ICYmIGUuZi5wdXNoKGYpO1xuICAgICAgICAgICAgfShuYW1lc1tpXSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoekluZGV4KSB7XG4gICAgICAgICAgICBpZiAoK3pJbmRleCA9PSArekluZGV4KSB7XG4gICAgICAgICAgICAgICAgZi56SW5kZXggPSArekluZGV4O1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIGV2ZS5mXG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBSZXR1cm5zIGZ1bmN0aW9uIHRoYXQgd2lsbCBmaXJlIGdpdmVuIGV2ZW50IHdpdGggb3B0aW9uYWwgYXJndW1lbnRzLlxuICAgICAqIEFyZ3VtZW50cyB0aGF0IHdpbGwgYmUgcGFzc2VkIHRvIHRoZSByZXN1bHQgZnVuY3Rpb24gd2lsbCBiZSBhbHNvXG4gICAgICogY29uY2F0ZWQgdG8gdGhlIGxpc3Qgb2YgZmluYWwgYXJndW1lbnRzLlxuICAgICB8IGVsLm9uY2xpY2sgPSBldmUuZihcImNsaWNrXCIsIDEsIDIpO1xuICAgICB8IGV2ZS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uIChhLCBiLCBjKSB7XG4gICAgIHwgICAgIGNvbnNvbGUubG9nKGEsIGIsIGMpOyAvLyAxLCAyLCBbZXZlbnQgb2JqZWN0XVxuICAgICB8IH0pO1xuICAgICA+IEFyZ3VtZW50c1xuICAgICAtIGV2ZW50IChzdHJpbmcpIGV2ZW50IG5hbWVcbiAgICAgLSB2YXJhcmdzICjigKYpIGFuZCBhbnkgb3RoZXIgYXJndW1lbnRzXG4gICAgID0gKGZ1bmN0aW9uKSBwb3NzaWJsZSBldmVudCBoYW5kbGVyIGZ1bmN0aW9uXG4gICAgXFwqL1xuICAgIGV2ZS5mID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHZhciBhdHRycyA9IFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGV2ZS5hcHBseShudWxsLCBbZXZlbnQsIG51bGxdLmNvbmNhdChhdHRycykuY29uY2F0KFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAwKSkpO1xuICAgICAgICB9O1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIGV2ZS5zdG9wXG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBJcyB1c2VkIGluc2lkZSBhbiBldmVudCBoYW5kbGVyIHRvIHN0b3AgdGhlIGV2ZW50LCBwcmV2ZW50aW5nIGFueSBzdWJzZXF1ZW50IGxpc3RlbmVycyBmcm9tIGZpcmluZy5cbiAgICBcXCovXG4gICAgZXZlLnN0b3AgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHN0b3AgPSAxO1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIGV2ZS5udFxuICAgICBbIG1ldGhvZCBdXG4gICAgICoqXG4gICAgICogQ291bGQgYmUgdXNlZCBpbnNpZGUgZXZlbnQgaGFuZGxlciB0byBmaWd1cmUgb3V0IGFjdHVhbCBuYW1lIG9mIHRoZSBldmVudC5cbiAgICAgKipcbiAgICAgPiBBcmd1bWVudHNcbiAgICAgKipcbiAgICAgLSBzdWJuYW1lIChzdHJpbmcpICNvcHRpb25hbCBzdWJuYW1lIG9mIHRoZSBldmVudFxuICAgICAqKlxuICAgICA9IChzdHJpbmcpIG5hbWUgb2YgdGhlIGV2ZW50LCBpZiBgc3VibmFtZWAgaXMgbm90IHNwZWNpZmllZFxuICAgICAqIG9yXG4gICAgID0gKGJvb2xlYW4pIGB0cnVlYCwgaWYgY3VycmVudCBldmVudOKAmXMgbmFtZSBjb250YWlucyBgc3VibmFtZWBcbiAgICBcXCovXG4gICAgZXZlLm50ID0gZnVuY3Rpb24gKHN1Ym5hbWUpIHtcbiAgICAgICAgdmFyIGN1ciA9IGlzQXJyYXkoY3VycmVudF9ldmVudCkgPyBjdXJyZW50X2V2ZW50LmpvaW4oXCIuXCIpIDogY3VycmVudF9ldmVudDtcbiAgICAgICAgaWYgKHN1Ym5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgUmVnRXhwKFwiKD86XFxcXC58XFxcXC98XilcIiArIHN1Ym5hbWUgKyBcIig/OlxcXFwufFxcXFwvfCQpXCIpLnRlc3QoY3VyKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY3VyO1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIGV2ZS5udHNcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIENvdWxkIGJlIHVzZWQgaW5zaWRlIGV2ZW50IGhhbmRsZXIgdG8gZmlndXJlIG91dCBhY3R1YWwgbmFtZSBvZiB0aGUgZXZlbnQuXG4gICAgICoqXG4gICAgICoqXG4gICAgID0gKGFycmF5KSBuYW1lcyBvZiB0aGUgZXZlbnRcbiAgICBcXCovXG4gICAgZXZlLm50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIGlzQXJyYXkoY3VycmVudF9ldmVudCkgPyBjdXJyZW50X2V2ZW50IDogY3VycmVudF9ldmVudC5zcGxpdChzZXBhcmF0b3IpO1xuICAgIH07XG4gICAgLypcXFxuICAgICAqIGV2ZS5vZmZcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIFJlbW92ZXMgZ2l2ZW4gZnVuY3Rpb24gZnJvbSB0aGUgbGlzdCBvZiBldmVudCBsaXN0ZW5lcnMgYXNzaWduZWQgdG8gZ2l2ZW4gbmFtZS5cbiAgICAgKiBJZiBubyBhcmd1bWVudHMgc3BlY2lmaWVkIGFsbCB0aGUgZXZlbnRzIHdpbGwgYmUgY2xlYXJlZC5cbiAgICAgKipcbiAgICAgPiBBcmd1bWVudHNcbiAgICAgKipcbiAgICAgLSBuYW1lIChzdHJpbmcpIG5hbWUgb2YgdGhlIGV2ZW50LCBkb3QgKGAuYCkgb3Igc2xhc2ggKGAvYCkgc2VwYXJhdGVkLCB3aXRoIG9wdGlvbmFsIHdpbGRjYXJkc1xuICAgICAtIGYgKGZ1bmN0aW9uKSBldmVudCBoYW5kbGVyIGZ1bmN0aW9uXG4gICAgXFwqL1xuICAgIC8qXFxcbiAgICAgKiBldmUudW5iaW5kXG4gICAgIFsgbWV0aG9kIF1cbiAgICAgKipcbiAgICAgKiBTZWUgQGV2ZS5vZmZcbiAgICBcXCovXG4gICAgZXZlLm9mZiA9IGV2ZS51bmJpbmQgPSBmdW5jdGlvbiAobmFtZSwgZikge1xuICAgICAgICBpZiAoIW5hbWUpIHtcbiAgICAgICAgICAgIGV2ZS5fZXZlbnRzID0gZXZlbnRzID0ge246IHt9fTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbmFtZXMgPSBpc0FycmF5KG5hbWUpID8gKGlzQXJyYXkobmFtZVswXSkgPyBuYW1lIDogW25hbWVdKSA6IFN0cihuYW1lKS5zcGxpdChjb21hc2VwYXJhdG9yKTtcbiAgICAgICAgaWYgKG5hbWVzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IG5hbWVzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcbiAgICAgICAgICAgICAgICBldmUub2ZmKG5hbWVzW2ldLCBmKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBuYW1lcyA9IGlzQXJyYXkobmFtZSkgPyBuYW1lIDogU3RyKG5hbWUpLnNwbGl0KHNlcGFyYXRvcik7XG4gICAgICAgIHZhciBlLFxuICAgICAgICAgICAga2V5LFxuICAgICAgICAgICAgc3BsaWNlLFxuICAgICAgICAgICAgaSwgaWksIGosIGpqLFxuICAgICAgICAgICAgY3VyID0gW2V2ZW50c107XG4gICAgICAgIGZvciAoaSA9IDAsIGlpID0gbmFtZXMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuICAgICAgICAgICAgZm9yIChqID0gMDsgaiA8IGN1ci5sZW5ndGg7IGogKz0gc3BsaWNlLmxlbmd0aCAtIDIpIHtcbiAgICAgICAgICAgICAgICBzcGxpY2UgPSBbaiwgMV07XG4gICAgICAgICAgICAgICAgZSA9IGN1cltqXS5uO1xuICAgICAgICAgICAgICAgIGlmIChuYW1lc1tpXSAhPSB3aWxkY2FyZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZVtuYW1lc1tpXV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNwbGljZS5wdXNoKGVbbmFtZXNbaV1dKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoa2V5IGluIGUpIGlmIChlW2hhc10oa2V5KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3BsaWNlLnB1c2goZVtrZXldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjdXIuc3BsaWNlLmFwcGx5KGN1ciwgc3BsaWNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKGkgPSAwLCBpaSA9IGN1ci5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG4gICAgICAgICAgICBlID0gY3VyW2ldO1xuICAgICAgICAgICAgd2hpbGUgKGUubikge1xuICAgICAgICAgICAgICAgIGlmIChmKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlLmYpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaiA9IDAsIGpqID0gZS5mLmxlbmd0aDsgaiA8IGpqOyBqKyspIGlmIChlLmZbal0gPT0gZikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUuZi5zcGxpY2UoaiwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAhZS5mLmxlbmd0aCAmJiBkZWxldGUgZS5mO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGZvciAoa2V5IGluIGUubikgaWYgKGUubltoYXNdKGtleSkgJiYgZS5uW2tleV0uZikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZ1bmNzID0gZS5uW2tleV0uZjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaiA9IDAsIGpqID0gZnVuY3MubGVuZ3RoOyBqIDwgamo7IGorKykgaWYgKGZ1bmNzW2pdID09IGYpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jcy5zcGxpY2UoaiwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAhZnVuY3MubGVuZ3RoICYmIGRlbGV0ZSBlLm5ba2V5XS5mO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGUuZjtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChrZXkgaW4gZS5uKSBpZiAoZS5uW2hhc10oa2V5KSAmJiBlLm5ba2V5XS5mKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgZS5uW2tleV0uZjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlID0gZS5uO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICAvKlxcXG4gICAgICogZXZlLm9uY2VcbiAgICAgWyBtZXRob2QgXVxuICAgICAqKlxuICAgICAqIEJpbmRzIGdpdmVuIGV2ZW50IGhhbmRsZXIgd2l0aCBhIGdpdmVuIG5hbWUgdG8gb25seSBydW4gb25jZSB0aGVuIHVuYmluZCBpdHNlbGYuXG4gICAgIHwgZXZlLm9uY2UoXCJsb2dpblwiLCBmKTtcbiAgICAgfCBldmUoXCJsb2dpblwiKTsgLy8gdHJpZ2dlcnMgZlxuICAgICB8IGV2ZShcImxvZ2luXCIpOyAvLyBubyBsaXN0ZW5lcnNcbiAgICAgKiBVc2UgQGV2ZSB0byB0cmlnZ2VyIHRoZSBsaXN0ZW5lci5cbiAgICAgKipcbiAgICAgPiBBcmd1bWVudHNcbiAgICAgKipcbiAgICAgLSBuYW1lIChzdHJpbmcpIG5hbWUgb2YgdGhlIGV2ZW50LCBkb3QgKGAuYCkgb3Igc2xhc2ggKGAvYCkgc2VwYXJhdGVkLCB3aXRoIG9wdGlvbmFsIHdpbGRjYXJkc1xuICAgICAtIGYgKGZ1bmN0aW9uKSBldmVudCBoYW5kbGVyIGZ1bmN0aW9uXG4gICAgICoqXG4gICAgID0gKGZ1bmN0aW9uKSBzYW1lIHJldHVybiBmdW5jdGlvbiBhcyBAZXZlLm9uXG4gICAgXFwqL1xuICAgIGV2ZS5vbmNlID0gZnVuY3Rpb24gKG5hbWUsIGYpIHtcbiAgICAgICAgdmFyIGYyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZXZlLm9mZihuYW1lLCBmMik7XG4gICAgICAgICAgICByZXR1cm4gZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gZXZlLm9uKG5hbWUsIGYyKTtcbiAgICB9O1xuICAgIC8qXFxcbiAgICAgKiBldmUudmVyc2lvblxuICAgICBbIHByb3BlcnR5IChzdHJpbmcpIF1cbiAgICAgKipcbiAgICAgKiBDdXJyZW50IHZlcnNpb24gb2YgdGhlIGxpYnJhcnkuXG4gICAgXFwqL1xuICAgIGV2ZS52ZXJzaW9uID0gdmVyc2lvbjtcbiAgICBldmUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBcIllvdSBhcmUgcnVubmluZyBFdmUgXCIgKyB2ZXJzaW9uO1xuICAgIH07XG4gICAgKHR5cGVvZiBtb2R1bGUgIT0gXCJ1bmRlZmluZWRcIiAmJiBtb2R1bGUuZXhwb3J0cykgPyAobW9kdWxlLmV4cG9ydHMgPSBldmUpIDogKHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kID8gKGRlZmluZShcImV2ZVwiLCBbXSwgZnVuY3Rpb24oKSB7IHJldHVybiBldmU7IH0pKSA6IChnbG9iLmV2ZSA9IGV2ZSkpO1xufSkodGhpcyk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/eve-raphael/eve.js\n')}},e={},f.m=d,f.c=e,f.d=function(g,I,C){f.o(g,I)||Object.defineProperty(g,I,{enumerable:!0,get:C})},f.r=function(g){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(g,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(g,"__esModule",{value:!0})},f.t=function(I,g){if(1&g&&(I=f(I)),8&g)return I;if(4&g&&"object"==typeof I&&I&&I.__esModule)return I;var C=Object.create(null);if(f.r(C),Object.defineProperty(C,"default",{enumerable:!0,value:I}),2&g&&"string"!=typeof I)for(var A in I)f.d(C,A,function(g){return I[g]}.bind(null,A));return C},f.n=function(g){var I=g&&g.__esModule?function(){return g.default}:function(){return g};return f.d(I,"a",I),I},f.o=function(g,I){return Object.prototype.hasOwnProperty.call(g,I)},f.p="",f(f.s="./dev/raphael.amd.js");function f(g){if(e[g])return e[g].exports;var I=e[g]={i:g,l:!1,exports:{}};return d[g].call(I.exports,I,I.exports,f),I.l=!0,I.exports}var d,e});
!function(m){function x(t){if("number"==typeof t)return t.toString();var r={"<":"lt",">":"gt",'"':"quot","'":"apos"};for(var a in r)t=t.replace(new RegExp(a,"g"),"&"+r[a]+";");return t}function n(t,r){var a=[];if(void 0!==t.unshift)for(var e,n=t.length,i=0;i<n;i++){void 0!==t[i]&&null!==(e=r.call(this,t[i],i))&&a.push(e)}else for(i in t){t.hasOwnProperty(i)&&null!==(e=r.call(this,t[i],i))&&a.push(e)}return a}function p(t,r,a){for(var e in t)t.hasOwnProperty(e)&&(a=r.call(this,a,t[e],e));return a}function g(t,r,a,e){return null==e&&(e=""),"object"==typeof r&&(r=n(r,function(t,r){switch(r){case"transform":return;case"fill":var a;!t.match(/^hsb/)||3===(a=t.replace(/^hsb\(|\)$/g,"").split(",")).length&&(t=m.hsb2rgb(a[0],a[1],a[2]).toString())}return r+'="'+x(t)+'"'}).join(" ")),"<"+t+(a?' transform="matrix('+a.toString().replace(/^matrix\(|\)$/g,"")+')" ':" ")+r+">"+e+"</"+t+">"}function w(t){return/^[0-9A-F]{6}$/i.test(t)&&(t="#"+t),t}var y={text:function(l){var t,f={font:{family:(t=l).attrs.font.replace(/^.*?"(\w+)".*$/,"$1"),size:void 0===t.attrs["font-size"]?null:parseInt(t.attrs["font-size"]),style:void 0===t.attrs["font-style"]?null:t.attrs["font-style"],weight:void 0===t.attrs["font-weight"]?null:t.attrs["font-weight"]},anchor:void 0===t.attrs["text-anchor"]?null:t.attrs["text-anchor"]},c=new Array,r=l.attrs.text.toString().split("\n"),h=r.length;return n(r,function(t,r){var a,e,n,i,s,o=p(l.attrs,function(t,r,a){return"text"!==a&&"w"!==a&&"h"!==a&&("font-size"===a&&(r=parseInt(r)+"px"),"stroke"===a&&(r=w(r)),t[a]=x(r.toString())),t},{style:(e="normal",n="text-anchor: "+((a=f).anchor||"middle")+"; ",i=a.font,n+["font:",i.style||e,e,i.weight||e,(i.size?i.size+"px":"10px")+"/normal",i.family].join(" ")+";")});""!=l.node.className.baseVal&&(o.class=l.node.className.baseVal),c.push(g("text",o,l.matrix,g("tspan",{dy:(null===(s=f.font.size)&&(s=10),4.5*s/13*(r+1-.2-h/2)*3.5)},null,t.replace(/&/g,"&amp;"))))}),c},path:function(t){1===t.matrix.a&&1===t.matrix.d||t.matrix.toString();return g("path",p(t.attrs,function(t,r,a){return"path"===a&&(a="d"),"stroke"===a&&(r=w(r)),t[a]=r.toString(),t},{}),t.matrix)}};m.fn.toSVG=function(){var t={svg:m.svg,vml:m.vml},r='<svg style="overflow: hidden; position: relative;" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+this.width+'" version="1.1" height="'+this.height+'">';m.svg=!0,m.vml=!1;for(var a=this.bottom;null!=a;a=a.next)if("none"!==a.node.style.display){var e="";if("function"!=typeof y[a.type]){switch(a.type){case"image":e+=' preserveAspectRatio="none"'}for(i in a.attrs){var n=i,s="";switch(i){case"r":if("rect"!=a.type)break;s=a.attrs.r,a.attrs.rx=s,a.attrs.ry=s;continue;case"src":n="xlink:href";break;case"transform":n="";break;case"fill":if(a.attrs.gradient)continue;break;case"gradient":var o=a.id,l=a.attrs.gradient,f=.5,c=.5;if(l=(l=String(l).replace(m._radial_gradient,function(t,r,a){var e;return type="radial",r&&a&&(f=parseFloat(r),e=2*(.5<(c=parseFloat(a)))-1,.25<Math.pow(f-.5,2)+Math.pow(c-.5,2)&&(c=Math.sqrt(.25-Math.pow(f-.5,2))*e+.5)&&.5!=c&&(c=c.toFixed(5)-1e-5*e)),""})).split(/\s*\-\s*/),a.attrs.gradient.match(/^r/g)){if(!(g=m._parseDots(l)))continue;r+="<defs>",r+='        <radialGradient id="radialgradient'+o+'" fx="'+f+'" fy="'+c+'" >';for(var h=0;h<g.length;h++){var p=h/(g.length-1)*100+"%";g[h].offset&&(p=g[h].offset),r+='<stop stop-color="'+g[h].color+'" offset="'+p+'"/>'}r+="    </radialGradient>",r+="</defs>",n="fill",s="url(#radialgradient"+o+")"}else{var g,u=l.shift(),u=-1*parseFloat(u);if(isNaN(u))continue;if(!(g=m._parseDots(l)))continue;var d=[0,0,Math.cos(m.rad(u)),Math.sin(m.rad(u))],v=1/(Math.max(Math.abs(d[2]),Math.abs(d[3]))||1);d[2]*=v,d[3]*=v,d[2]<0&&(d[0]=-d[2],d[2]=0),d[3]<0&&(d[1]=-d[3],d[3]=0),r+="<defs>",r+='        <linearGradient id="lineargradient'+o+'" x1="'+d[0]+'" y1="'+d[1]+'" x2="'+d[2]+'" y2="'+d[3]+'">';for(h=0;h<g.length;h++){p=h/(g.length-1)*100+"%";g[h].offset&&(p=g[h].offset),r+='<stop stop-color="'+g[h].color+'" offset="'+p+'"/>'}r+="    </linearGradient>",r+="</defs>",n="fill",s="url(#lineargradient"+o+")"}break;case"stroke":s=w(s||a.attrs[i].toString())}n&&(e+=s?" "+n+'="'+x(s)+'"':" "+n+'="'+x(a.attrs[i].toString())+'"')}""!=a.node.className.baseVal&&(e+=' class="'+a.node.className.baseVal+'"'),r+="<"+a.type+' transform="matrix('+a.matrix.toString().replace(/^matrix\(|\)$/g,"")+')"'+e+"></"+a.type+">"}else r+=y[a.type](a)}return r+="</svg>",m.svg=t.svg,m.vml=t.vml,r}}(window.Raphael);
Raphael.el.popup=function(t,h,e,a){var i,r,s,n,l=this.paper||this[0].paper;if(l){switch(this.type){case"text":case"circle":case"ellipse":r=!0;break;default:r=!1}t=null==t?"up":t,h=h||5,i=this.getBBox(),e="number"==typeof e?e:r?i.x+i.width/2:i.x,a="number"==typeof a?a:r?i.y+i.height/2:i.y,s=Math.max(i.width/2-h,0),n=Math.max(i.height/2-h,0),this.translate(e-i.x-(r?i.width/2:0),a-i.y-(r?i.height/2:0));var o={up:["M",e,a,"l",-h,-h,-s,0,"a",h,h,0,0,1,-h,-h,"l",0,-(i=this.getBBox()).height,"a",h,h,0,0,1,h,-h,"l",2*h+2*s,0,"a",h,h,0,0,1,h,h,"l",0,i.height,"a",h,h,0,0,1,-h,h,"l",-s,0,"z"].join(","),down:["M",e,a,"l",h,h,s,0,"a",h,h,0,0,1,h,h,"l",0,i.height,"a",h,h,0,0,1,-h,h,"l",-(2*h+2*s),0,"a",h,h,0,0,1,-h,-h,"l",0,-i.height,"a",h,h,0,0,1,h,-h,"l",s,0,"z"].join(","),left:["M",e,a,"l",-h,h,0,n,"a",h,h,0,0,1,-h,h,"l",-i.width,0,"a",h,h,0,0,1,-h,-h,"l",0,-(2*h+2*n),"a",h,h,0,0,1,h,-h,"l",i.width,0,"a",h,h,0,0,1,h,h,"l",0,n,"z"].join(","),right:["M",e,a,"l",h,-h,0,-n,"a",h,h,0,0,1,h,-h,"l",i.width,0,"a",h,h,0,0,1,h,h,"l",0,2*h+2*n,"a",h,h,0,0,1,-h,h,"l",-i.width,0,"a",h,h,0,0,1,-h,-h,"l",0,-n,"z"].join(",")},p={up:{x:-!r*(i.width/2),y:2*-h-(r?i.height/2:i.height)},down:{x:-!r*(i.width/2),y:2*h+(r?i.height/2:i.height)},left:{x:2*-h-(r?i.width/2:i.width),y:-!r*(i.height/2)},right:{x:2*h+(r?i.width/2:i.width),y:-!r*(i.height/2)}}[t];return this.translate(p.x,p.y),l.path(o[t]).attr({fill:"#000",stroke:"none"}).insertBefore(this.node?this:this[0])}},Raphael.el.tag=function(t,h,e,a){var i=this.paper||this[0].paper;if(i){var r,s,n,l=i.path().attr({fill:"#000",stroke:"#000"}),o=this.getBBox();switch(this.type){case"text":case"circle":case"ellipse":n=!0;break;default:n=!1}return t=t||0,e="number"==typeof e?e:n?o.x+o.width/2:o.x,a="number"==typeof a?a:n?o.y+o.height/2:o.y,s=.5522*(h=null==h?5:h),o.height>=2*h?l.attr({path:["M",e,a+h,"a",h,h,0,1,1,0,2*-h,h,h,0,1,1,0,2*h,"m",0,2*-h-3,"a",h+3,h+3,0,1,0,0,2*(h+3),"L",e+h+3,a+o.height/2+3,"l",o.width+6,0,0,-o.height-6,-o.width-6,0,"L",e,a-h-3].join(",")}):(r=Math.sqrt(Math.pow(h+3,2)-Math.pow(o.height/2+3,2)),l.attr({path:["M",e,a+h,"c",-s,0,-h,s-h,-h,-h,0,-s,h-s,-h,h,-h,s,0,h,h-s,h,h,0,s,s-h,h,-h,h,"M",e+r,a-o.height/2-3,"a",h+3,h+3,0,1,0,0,o.height+6,"l",h+3-r+o.width+6,0,0,-o.height-6,"L",e+r,a-o.height/2-3].join(",")})),t=360-t,l.rotate(t,e,a),this.attrs?(this.attr(this.attrs.x?"x":"cx",e+h+3+(n?o.width/2:"text"==this.type?o.width:0)).attr("y",n?a:a-o.height/2),this.rotate(t,e,a),90<t&&t<270&&this.attr(this.attrs.x?"x":"cx",e-h-3-(n?o.width/2:o.width)).rotate(180,e,a)):90<t&&t<270?(this.translate(e-o.x-o.width-h-3,a-o.y-o.height/2),this.rotate(t-180,o.x+o.width+h+3,o.y+o.height/2)):(this.translate(e-o.x+h+3,a-o.y-o.height/2),this.rotate(t,o.x-h-3,o.y+o.height/2)),l.insertBefore(this.node?this:this[0])}},Raphael.el.drop=function(t,h,e){var a,i,r,s,n,l=this.getBBox(),o=this.paper||this[0].paper;if(o){switch(this.type){case"text":case"circle":case"ellipse":a=!0;break;default:a=!1}return t=t||0,h="number"==typeof h?h:a?l.x+l.width/2:l.x,e="number"==typeof e?e:a?l.y+l.height/2:l.y,i=Math.max(l.width,l.height)+Math.min(l.width,l.height),r=o.path(["M",h,e,"l",i,0,"A",.4*i,.4*i,0,1,0,h+.7*i,e-.7*i,"z"]).attr({fill:"#000",stroke:"none"}).rotate(22.5-t,h,e),t=(t+90)*Math.PI/180,s=h+i*Math.sin(t)-(a?0:l.width/2),n=e+i*Math.cos(t)-(a?0:l.height/2),this.attrs?this.attr(this.attrs.x?"x":"cx",s).attr(this.attrs.y?"y":"cy",n):this.translate(s-l.x,n-l.y),r.insertBefore(this.node?this:this[0])}},Raphael.el.flag=function(t,h,e){var a=this.paper||this[0].paper;if(a){var i,r=a.path().attr({fill:"#000",stroke:"#000"}),s=this.getBBox(),n=s.height/2;switch(this.type){case"text":case"circle":case"ellipse":i=!0;break;default:i=!1}return t=t||0,h="number"==typeof h?h:i?s.x+s.width/2:s.x,e="number"==typeof e?e:i?s.y+s.height/2:s.y,r.attr({path:["M",h,e,"l",3+n,-n-3,s.width+6,0,0,s.height+6,-s.width-6,0,"z"].join(",")}),t=360-t,r.rotate(t,h,e),this.attrs?(this.attr(this.attrs.x?"x":"cx",h+n+3+(i?s.width/2:"text"==this.type?s.width:0)).attr("y",i?e:e-s.height/2),this.rotate(t,h,e),90<t&&t<270&&this.attr(this.attrs.x?"x":"cx",h-n-3-(i?s.width/2:s.width)).rotate(180,h,e)):90<t&&t<270?(this.translate(h-s.x-s.width-n-3,e-s.y-s.height/2),this.rotate(t-180,s.x+s.width+n+3,s.y+s.height/2)):(this.translate(h-s.x+n+3,e-s.y-s.height/2),this.rotate(t,s.x-n-3,s.y+s.height/2)),r.insertBefore(this.node?this:this[0])}},Raphael.el.label=function(){var t=this.getBBox(),h=this.paper||this[0].paper,e=Math.min(20,t.width+10,t.height+10)/2;if(h)return h.rect(t.x-e/2,t.y-e/2,t.width+e,t.height+e,e).attr({stroke:"none",fill:"#000"}).insertBefore(this.node?this:this[0])},Raphael.el.blob=function(t,h,e){var a,i,r,s=this.getBBox(),n=Math.PI/180,l=this.paper||this[0].paper;if(l){switch(this.type){case"text":case"circle":case"ellipse":i=!0;break;default:i=!1}a=l.path().attr({fill:"#000",stroke:"none"}),t=(+t+1?t:45)+90,r=Math.min(s.height,s.width),h="number"==typeof h?h:i?s.x+s.width/2:s.x,e="number"==typeof e?e:i?s.y+s.height/2:s.y;var o=Math.max(s.width+r,25*r/12),p=Math.max(s.height+r,25*r/12),f=h+r*Math.sin((t-22.5)*n),x=e+r*Math.cos((t-22.5)*n),u=h+r*Math.sin((t+22.5)*n),g=e+r*Math.cos((t+22.5)*n),c=(u-f)/2,d=(g-x)/2,w=o/2,M=p/2,b=-Math.sqrt(Math.abs(w*w*M*M-w*w*d*d-M*M*c*c)/(w*w*d*d+M*M*c*c)),y=b*w*d/M+(u+f)/2,R=b*-M*c/w+(g+x)/2;return a.attr({x:y,y:R,path:["M",h,e,"L",u,g,"A",w,M,0,1,1,f,x,"z"].join(",")}),this.translate(y-s.x-s.width/2,R-s.y-s.height/2),a.insertBefore(this.node?this:this[0])}},Raphael.fn.label=function(t,h,e){var a=this.set();return e=this.text(t,h,e).attr(Raphael.g.txtattr),a.push(e.label(),e)},Raphael.fn.popup=function(t,h,e,a,i){var r=this.set();return e=this.text(t,h,e).attr(Raphael.g.txtattr),r.push(e.popup(a,i),e)},Raphael.fn.tag=function(t,h,e,a,i){var r=this.set();return e=this.text(t,h,e).attr(Raphael.g.txtattr),r.push(e.tag(a,i),e)},Raphael.fn.flag=function(t,h,e,a){var i=this.set();return e=this.text(t,h,e).attr(Raphael.g.txtattr),i.push(e.flag(a),e)},Raphael.fn.drop=function(t,h,e,a){var i=this.set();return e=this.text(t,h,e).attr(Raphael.g.txtattr),i.push(e.drop(a),e)},Raphael.fn.blob=function(t,h,e,a){var i=this.set();return e=this.text(t,h,e).attr(Raphael.g.txtattr),i.push(e.blob(a),e)},Raphael.el.lighter=function(t){t=t||2;var h=[this.attrs.fill,this.attrs.stroke];return this.fs=this.fs||[h[0],h[1]],h[0]=Raphael.rgb2hsb(Raphael.getRGB(h[0]).hex),h[1]=Raphael.rgb2hsb(Raphael.getRGB(h[1]).hex),h[0].b=Math.min(h[0].b*t,1),h[0].s=h[0].s/t,h[1].b=Math.min(h[1].b*t,1),h[1].s=h[1].s/t,this.attr({fill:"hsb("+[h[0].h,h[0].s,h[0].b]+")",stroke:"hsb("+[h[1].h,h[1].s,h[1].b]+")"}),this},Raphael.el.darker=function(t){t=t||2;var h=[this.attrs.fill,this.attrs.stroke];return this.fs=this.fs||[h[0],h[1]],h[0]=Raphael.rgb2hsb(Raphael.getRGB(h[0]).hex),h[1]=Raphael.rgb2hsb(Raphael.getRGB(h[1]).hex),h[0].s=Math.min(h[0].s*t,1),h[0].b=h[0].b/t,h[1].s=Math.min(h[1].s*t,1),h[1].b=h[1].b/t,this.attr({fill:"hsb("+[h[0].h,h[0].s,h[0].b]+")",stroke:"hsb("+[h[1].h,h[1].s,h[1].b]+")"}),this},Raphael.el.resetBrightness=function(){return this.fs&&(this.attr({fill:this.fs[0],stroke:this.fs[1]}),delete this.fs),this},function(){var t=["lighter","darker","resetBrightness"],h=["popup","tag","flag","label","drop","blob"];for(var e in h)!function(t){Raphael.st[t]=function(){return Raphael.el[t].apply(this,arguments)}}(h[e]);for(var e in t)!function(h){Raphael.st[h]=function(){for(var t=0;t<this.length;t++)this[t][h].apply(this[t],arguments);return this}}(t[e])}(),Raphael.g={shim:{stroke:"none",fill:"#000","fill-opacity":0},txtattr:{font:"12px Arial, sans-serif",fill:"#fff"},colors:function(){for(var t=[.6,.2,.05,.1333,.75,0],h=[],e=0;e<10;e++)e<t.length?h.push("hsb("+t[e]+",.75, .75)"):h.push("hsb("+t[e-t.length]+", 1, .5)");return h}(),snapEnds:function(t,h,e){var a=t,i=h;if(a==i)return{from:a,to:i,power:0};function r(t){return Math.abs(t-.5)<.25?.5+~~t:Math.round(t)}var s=(i-a)/e,n=~~s,l=n,o=0;if(n){for(;l;)o--,l=~~(s*Math.pow(10,o))/Math.pow(10,o);o++}else{if(0!=s&&isFinite(s))for(;!n;)o=o||1,n=~~(s*Math.pow(10,o))/Math.pow(10,o),o++;else o=1;o&&o--}return(i=r(h*Math.pow(10,o))/Math.pow(10,o))<h&&(i=r((h+.5)*Math.pow(10,o))/Math.pow(10,o)),{from:a=r((t-(0<o?0:.5))*Math.pow(10,o))/Math.pow(10,o),to:i,power:o}},axis:function(t,h,e,a,i,r,s,n,l,o,p){o=null==o?2:o,r=r||10,p=arguments[arguments.length-1];var f="|"==(l=l||"t")||" "==l?["M",t+.5,h,"l",0,.001]:1==s||3==s?["M",t+.5,h,"l",0,-e]:["M",t,h+.5,"l",e,0],x=this.snapEnds(a,i,r),u=x.from,g=x.to,c=x.power,d=0,w={font:"11px 'Fontin Sans', Fontin-Sans, sans-serif"},M=p.set(),b=(g-u)/r,y=u,R=0<c?c:0,v=e/r;if(1==+s||3==+s){for(var m=h,B=(s-1?1:-1)*(o+3+!!(s-1));h-e<=m;)"-"!=l&&" "!=l&&(f=f.concat(["M",t-("+"==l||"|"==l?o:!(s-1)*o*2),m+.5,"l",2*o+1,0])),M.push(p.text(t+B,m,n&&n[d++]||(Math.round(y)==y?y:+y.toFixed(R))).attr(w).attr({"text-anchor":s-1?"start":"end"})),y+=b,m-=v;Math.round(m+v-(h-e))&&("-"!=l&&" "!=l&&(f=f.concat(["M",t-("+"==l||"|"==l?o:!(s-1)*o*2),h-e+.5,"l",2*o+1,0])),M.push(p.text(t+B,h-e,n&&n[d]||(Math.round(y)==y?y:+y.toFixed(R))).attr(w).attr({"text-anchor":s-1?"start":"end"})))}else{y=u,R=(0<c)*c,B=(s?-1:1)*(o+9+!s);for(var k=t,v=e/r,F=0,j=0;k<=t+e;){"-"!=l&&" "!=l&&(f=f.concat(["M",k+.5,h-("+"==l?o:!!s*o*2),"l",0,2*o+1])),M.push(F=p.text(k,h+B,n&&n[d++]||(Math.round(y)==y?y:+y.toFixed(R))).attr(w));var z=F.getBBox();j>=z.x-5?M.pop(M.length-1).remove():j=z.x+z.width,y+=b,k+=v}Math.round(k-v-t-e)&&("-"!=l&&" "!=l&&(f=f.concat(["M",t+e+.5,h-("+"==l?o:!!s*o*2),"l",0,2*o+1])),M.push(p.text(t+e,h+B,n&&n[d]||(Math.round(y)==y?y:+y.toFixed(R))).attr(w)))}var G=p.path(f);return G.text=M,G.all=p.set([G,M]),G.remove=function(){this.text.remove(),this.constructor.prototype.remove.call(this)},G},labelise:function(t,a,i){return t?(t+"").replace(/(##+(?:\.#+)?)|(%%+(?:\.%+)?)/g,function(t,h,e){return h?(+a).toFixed(h.replace(/^#+\.?/g,"").length):e?(100*a/i).toFixed(e.replace(/^%+\.?/g,"").length)+"%":void 0}):(+a).toFixed(0)}};
!function(){function J(a,t,e,l){var r=function(a,t,e){var l,r,h,o,s,n,i,f;switch(a&&void 0===t&&void 0===e&&(t=a.s,e=a.v,a=a.h),n=e*(1-t),i=e*(1-(s=6*a-(o=Math.floor(6*a)))*t),f=e*(1-(1-s)*t),o%6){case 0:l=e,r=f,h=n;break;case 1:l=i,r=e,h=n;break;case 2:l=n,r=e,h=f;break;case 3:l=n,r=i,h=e;break;case 4:l=f,r=n,h=e;break;case 5:l=e,r=n,h=i}return{r:Math.floor(255*l),g:Math.floor(255*r),b:Math.floor(255*h)}}(Math.min(.4*(1-a/t),1),e||.75,l||.75);return"rgb("+r.r+","+r.g+","+r.b+")"}function n(e,t,l,r,h,a,o,s,n){function i(a){+a[0]&&(a[0]=f.axis(t+x,l+x,r-2*x,c,u,n.axisxstep||Math.floor((r-2*x)/20),2,n.axisxlabels||null,n.axisxtype||"t",null,e)),+a[1]&&(a[1]=f.axis(t+r-x,l+h-x,h-2*x,y,v,n.axisystep||Math.floor((h-2*x)/20),3,n.axisylabels||null,n.axisytype||"t",null,e)),+a[2]&&(a[2]=f.axis(t+x,l+h-40,r-2*x,c,u,n.axisxstep||Math.floor((r-2*x)/20),0,n.axisxlabels||null,n.axisxtype||"t",null,e)),+a[3]&&(a[3]=f.axis(t+x-I,l+h-60,h-80,y,v,n.axisystep||Math.floor((h-2*x)/20),1,n.axisylabels||null,n.axisytype||"t",null,e))}n=n||{};for(var f=this,p=f.snapEnds(Math.min.apply(Math,a),Math.max.apply(Math,a),a.length-1),c=p.from,u=p.to,x=n.gutter||10,M=f.snapEnds(Math.min.apply(Math,o),Math.max.apply(Math,o),o.length-1),y=M.from,v=M.to,g=Math.max(a.length,o.length,s.length),m=e[n.symbol]||"circle",b=e.set(),d=e.set(),k=n.max||100,w=Math.max.apply(Math,s),F=[],q=2*Math.sqrt(w/Math.PI)/k,B=0;B<g;B++)F[B]=Math.min(2*Math.sqrt(s[B]/Math.PI)/q,k);x=Math.max.apply(Math,F.concat(x));var E=e.set(),I=Math.max.apply(Math,F);if(n.axis){var P=(n.axis+"").split(/[,\s]+/);i.call(f,P);for(var R=[],X=[],B=0,Y=P.length;B<Y;B++){var j=P[B].all?P[B].all.getBBox()[["height","width"][B%2]]:0;R[B]=j+x,X[B]=j}x=Math.max.apply(Math,R.concat(x));for(B=0,Y=P.length;B<Y;B++)P[B].all&&(P[B].remove(),P[B]=1);i.call(f,P);for(B=0,Y=P.length;B<Y;B++)P[B].all&&E.push(P[B].all);b.axis=E}for(var z=(r-2*x)/(u-c||1),A=(h-80)/(v-y||1),B=0,Y=o.length;B<Y;B++){var C=e.raphael.is(m,"array")?m[B]:m,D=t+x+(a[B]-c)*z,G=l+h-60-(o[B]-y)*A;C&&F[B]&&d.push(e[C](D,G,F[B]).attr({fill:n.heat?J(F[B],I):f.colors[0],"fill-opacity":n.opacity?F[B]/k:1,stroke:"none"}))}for(var H=e.set(),B=0,Y=o.length;B<Y;B++){D=t+x+(a[B]-c)*z,G=l+h-60-(o[B]-y)*A;H.push(e.circle(D,G,I).attr(f.shim)),n.href&&n.href[B]&&H[B].attr({href:n.href[B]}),H[B].r=+F[B].toFixed(3),H[B].x=+D.toFixed(3),H[B].y=+G.toFixed(3),H[B].X=a[B],H[B].Y=o[B],H[B].value=s[B]||0,H[B].dot=d[B]}return b.covers=H,b.series=d,b.push(d,E,H),b.hover=function(a,t){return H.mouseover(a).mouseout(t),this},b.click=function(a){return H.click(a),this},b.each=function(a){if(!e.raphael.is(a,"function"))return this;for(var t=H.length;t--;)a.call(H[t]);return this},b.href=function(a){for(var t,e=H.length;e--;)(t=H[e]).X==a.x&&t.Y==a.y&&t.value==a.value&&t.attr({href:a.href})},b}function a(){}a.prototype=Raphael.g,n.prototype=new a,Raphael.fn.dotchart=function(a,t,e,l,r,h,o,s){return new n(this,a,t,e,l,r,h,o,s)}}();
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.echarts={})}(this,function(t){"use strict";var e;"undefined"!=typeof window?e=window.__DEV__:"undefined"!=typeof global&&(e=global.__DEV__),void 0===e&&(e=!0);var D=e,n=2311,i=function(){return n++},v="object"==typeof wx&&"function"==typeof wx.getSystemInfoSync?{browser:{},os:{},node:!1,wxa:!0,canvasSupported:!0,svgSupported:!1,touchEventsSupported:!0,domSupported:!1}:"undefined"==typeof document&&"undefined"!=typeof self?{browser:{},os:{},node:!1,worker:!0,canvasSupported:!0,domSupported:!1}:"undefined"==typeof navigator?{browser:{},os:{},node:!0,worker:!1,canvasSupported:!0,svgSupported:!0,domSupported:!1}:function(t){var e={},n=t.match(/Firefox\/([\d.]+)/),i=t.match(/MSIE\s([\d.]+)/)||t.match(/Trident\/.+?rv:(([\d.]+))/),o=t.match(/Edge\/([\d.]+)/),a=/micromessenger/i.test(t);n&&(e.firefox=!0,e.version=n[1]);i&&(e.ie=!0,e.version=i[1]);o&&(e.edge=!0,e.version=o[1]);a&&(e.weChat=!0);return{browser:e,os:{},node:!1,canvasSupported:!!document.createElement("canvas").getContext,svgSupported:"undefined"!=typeof SVGRect,touchEventsSupported:"ontouchstart"in window&&!e.ie&&!e.edge,pointerEventsSupported:"onpointerdown"in window&&(e.edge||e.ie&&11<=e.version),domSupported:"undefined"!=typeof document}}(navigator.userAgent);var s={"[object Function]":1,"[object RegExp]":1,"[object Date]":1,"[object Error]":1,"[object CanvasGradient]":1,"[object CanvasPattern]":1,"[object Image]":1,"[object Canvas]":1},l={"[object Int8Array]":1,"[object Uint8Array]":1,"[object Uint8ClampedArray]":1,"[object Int16Array]":1,"[object Uint16Array]":1,"[object Int32Array]":1,"[object Uint32Array]":1,"[object Float32Array]":1,"[object Float64Array]":1},h=Object.prototype.toString,o=Array.prototype,r=o.forEach,u=o.filter,a=o.slice,c=o.map,d=o.reduce,p={};function g(t,e){"createCanvas"===t&&(x=null),p[t]=e}function C(t){if(null==t||"object"!=typeof t)return t;var e=t,n=h.call(t);if("[object Array]"===n){if(!Q(t)){e=[];for(var i=0,o=t.length;i<o;i++)e[i]=C(t[i])}}else if(l[n]){if(!Q(t)){var a=t.constructor;if(t.constructor.from)e=a.from(t);else{e=new a(t.length);for(i=0,o=t.length;i<o;i++)e[i]=C(t[i])}}}else if(!s[n]&&!Q(t)&&!W(t))for(var r in e={},t)t.hasOwnProperty(r)&&(e[r]=C(t[r]));return e}function m(t,e,n){if(!V(e)||!V(t))return n?C(e):t;for(var i in e){var o,a;e.hasOwnProperty(i)&&(o=t[i],!V(a=e[i])||!V(o)||R(a)||R(o)||W(a)||W(o)||G(a)||G(o)||Q(a)||Q(o)?!n&&i in t||(t[i]=C(e[i])):m(o,a,n))}return t}function f(t,e){for(var n=t[0],i=1,o=t.length;i<o;i++)n=m(n,t[i],e);return n}function k(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function L(t,e,n){for(var i in e)e.hasOwnProperty(i)&&(n?null!=e[i]:null==t[i])&&(t[i]=e[i]);return t}function y(){return p.createCanvas()}var x;function _(){return x=x||y().getContext("2d")}function M(t,e){if(t){if(t.indexOf)return t.indexOf(e);for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n}return-1}function w(t,e){var n=t.prototype;function i(){}for(var o in i.prototype=e.prototype,t.prototype=new i,n)n.hasOwnProperty(o)&&(t.prototype[o]=n[o]);(t.prototype.constructor=t).superClass=e}function b(t,e,n){L(t="prototype"in t?t.prototype:t,e="prototype"in e?e.prototype:e,n)}function O(t){if(t)return"string"!=typeof t&&"number"==typeof t.length}function P(t,e,n){if(t&&e)if(t.forEach&&t.forEach===r)t.forEach(e,n);else if(t.length===+t.length)for(var i=0,o=t.length;i<o;i++)e.call(n,t[i],i,t);else for(var a in t)t.hasOwnProperty(a)&&e.call(n,t[a],a,t)}function N(t,e,n){if(t&&e){if(t.map&&t.map===c)return t.map(e,n);for(var i=[],o=0,a=t.length;o<a;o++)i.push(e.call(n,t[o],o,t));return i}}function S(t,e,n,i){if(t&&e){if(t.reduce&&t.reduce===d)return t.reduce(e,n,i);for(var o=0,a=t.length;o<a;o++)n=e.call(i,n,t[o],o,t);return n}}function I(t,e,n){if(t&&e){if(t.filter&&t.filter===u)return t.filter(e,n);for(var i=[],o=0,a=t.length;o<a;o++)e.call(n,t[o],o,t)&&i.push(t[o]);return i}}function T(t,e,n){if(t&&e)for(var i=0,o=t.length;i<o;i++)if(e.call(n,t[i],i,t))return t[i]}function E(t,e){var n=a.call(arguments,2);return function(){return t.apply(e,n.concat(a.call(arguments)))}}function z(t){var e=a.call(arguments,1);return function(){return t.apply(this,e.concat(a.call(arguments)))}}function R(t){return"[object Array]"===h.call(t)}function A(t){return"function"==typeof t}function B(t){return"[object String]"===h.call(t)}function V(t){var e=typeof t;return"function"==e||!!t&&"object"==e}function G(t){return!!s[h.call(t)]}function F(t){return!!l[h.call(t)]}function W(t){return"object"==typeof t&&"number"==typeof t.nodeType&&"object"==typeof t.ownerDocument}function H(t){return t!=t}function Z(t){for(var e=0,n=arguments.length;e<n;e++)if(null!=arguments[e])return arguments[e]}function U(t,e){return null!=t?t:e}function X(t,e,n){return null!=t?t:null!=e?e:n}function Y(){return Function.call.apply(a,arguments)}function j(t){if("number"==typeof t)return[t,t,t,t];var e=t.length;return 2===e?[t[0],t[1],t[0],t[1]]:3===e?[t[0],t[1],t[2],t[1]]:t}function q(t,e){if(!t)throw new Error(e)}function K(t){return null==t?null:"function"==typeof t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}p.createCanvas=function(){return document.createElement("canvas")};var $="__ec_primitive__";function J(t){t[$]=!0}function Q(t){return t[$]}function tt(t){var n=R(t);this.data={};var i=this;function e(t,e){n?i.set(t,e):i.set(e,t)}t instanceof tt?t.each(e):t&&P(t,e)}function et(t){return new tt(t)}function nt(t,e){for(var n=new t.constructor(t.length+e.length),i=0;i<t.length;i++)n[i]=t[i];for(var o=t.length,i=0;i<e.length;i++)n[i+o]=e[i];return n}function it(){}tt.prototype={constructor:tt,get:function(t){return this.data.hasOwnProperty(t)?this.data[t]:null},set:function(t,e){return this.data[t]=e},each:function(t,e){for(var n in void 0!==e&&(t=E(t,e)),this.data)this.data.hasOwnProperty(n)&&t(this.data[n],n)},removeKey:function(t){delete this.data[t]}};var ot=(Object.freeze||Object)({$override:g,clone:C,merge:m,mergeAll:f,extend:k,defaults:L,createCanvas:y,getContext:_,indexOf:M,inherits:w,mixin:b,isArrayLike:O,each:P,map:N,reduce:S,filter:I,find:T,bind:E,curry:z,isArray:R,isFunction:A,isString:B,isObject:V,isBuiltInObject:G,isTypedArray:F,isDom:W,eqNaN:H,retrieve:Z,retrieve2:U,retrieve3:X,slice:Y,normalizeCssArray:j,assert:q,trim:K,setAsPrimitive:J,isPrimitive:Q,createHashMap:et,concatArray:nt,noop:it}),at="undefined"==typeof Float32Array?Array:Float32Array;function rt(t,e){var n=new at(2);return null==t&&(t=0),null==e&&(e=0),n[0]=t,n[1]=e,n}function st(t,e){return t[0]=e[0],t[1]=e[1],t}function lt(t){var e=new at(2);return e[0]=t[0],e[1]=t[1],e}function ht(t,e,n){return t[0]=e,t[1]=n,t}function ut(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function ct(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t}function dt(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function pt(t){return Math.sqrt(gt(t))}function gt(t){return t[0]*t[0]+t[1]*t[1]}function ft(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function mt(t,e){var n=pt(e);return 0===n?(t[0]=0,t[1]=0):(t[0]=e[0]/n,t[1]=e[1]/n),t}function vt(t,e){return Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]))}var yt=vt;function xt(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])}var _t=xt;function wt(t,e,n,i){return t[0]=e[0]+i*(n[0]-e[0]),t[1]=e[1]+i*(n[1]-e[1]),t}function bt(t,e,n){var i=e[0],o=e[1];return t[0]=n[0]*i+n[2]*o+n[4],t[1]=n[1]*i+n[3]*o+n[5],t}function St(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}function Mt(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}var It=(Object.freeze||Object)({create:rt,copy:st,clone:lt,set:ht,add:ut,scaleAndAdd:ct,sub:dt,len:pt,length:pt,lenSquare:gt,lengthSquare:gt,mul:function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t},div:function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t},dot:function(t,e){return t[0]*e[0]+t[1]*e[1]},scale:ft,normalize:mt,distance:vt,dist:yt,distanceSquare:xt,distSquare:_t,negate:function(t,e){return t[0]=-e[0],t[1]=-e[1],t},lerp:wt,applyTransform:bt,min:St,max:Mt});function Tt(){this.on("mousedown",this._dragStart,this),this.on("mousemove",this._drag,this),this.on("mouseup",this._dragEnd,this)}function At(t,e){return{target:t,topTarget:e&&e.topTarget}}Tt.prototype={constructor:Tt,_dragStart:function(t){var e=t.target;e&&e.draggable&&((this._draggingTarget=e).dragging=!0,this._x=t.offsetX,this._y=t.offsetY,this.dispatchToElement(At(e,t),"dragstart",t.event))},_drag:function(t){var e,n,i,o,a,r,s=this._draggingTarget;s&&(e=t.offsetX,n=t.offsetY,i=e-this._x,o=n-this._y,this._x=e,this._y=n,s.drift(i,o,t),this.dispatchToElement(At(s,t),"drag",t.event),a=this.findHover(e,n,s).target,r=this._dropTarget,s!==(this._dropTarget=a)&&(r&&a!==r&&this.dispatchToElement(At(r,t),"dragleave",t.event),a&&a!==r&&this.dispatchToElement(At(a,t),"dragenter",t.event)))},_dragEnd:function(t){var e=this._draggingTarget;e&&(e.dragging=!1),this.dispatchToElement(At(e,t),"dragend",t.event),this._dropTarget&&this.dispatchToElement(At(this._dropTarget,t),"drop",t.event),this._draggingTarget=null,this._dropTarget=null}};var Dt=Array.prototype.slice,Ct=function(t){this._$handlers={},this._$eventProcessor=t};function Lt(t,e,n,i,o,a){var r,s,l=t._$handlers;if("function"==typeof n&&(o=i,i=n,n=null),!i||!e)return t;r=n,s=t._$eventProcessor,null!=r&&s&&s.normalizeQuery&&(r=s.normalizeQuery(r)),n=r,l[e]||(l[e]=[]);for(var h=0;h<l[e].length;h++)if(l[e][h].h===i)return t;var u={h:i,one:a,query:n,ctx:o||t,callAtLast:i.zrEventfulCallAtLast},c=l[e].length-1,d=l[e][c];return d&&d.callAtLast?l[e].splice(c,0,u):l[e].push(u),t}Ct.prototype={constructor:Ct,one:function(t,e,n,i){return Lt(this,t,e,n,i,!0)},on:function(t,e,n,i){return Lt(this,t,e,n,i,!1)},isSilent:function(t){var e=this._$handlers;return!e[t]||!e[t].length},off:function(t,e){var n=this._$handlers;if(!t)return this._$handlers={},this;if(e){if(n[t]){for(var i=[],o=0,a=n[t].length;o<a;o++)n[t][o].h!==e&&i.push(n[t][o]);n[t]=i}n[t]&&0===n[t].length&&delete n[t]}else delete n[t];return this},trigger:function(t){var e=this._$handlers[t],n=this._$eventProcessor;if(e){var i=arguments,o=i.length;3<o&&(i=Dt.call(i,1));for(var a=e.length,r=0;r<a;){var s=e[r];if(n&&n.filter&&null!=s.query&&!n.filter(t,s.query))r++;else{switch(o){case 1:s.h.call(s.ctx);break;case 2:s.h.call(s.ctx,i[1]);break;case 3:s.h.call(s.ctx,i[1],i[2]);break;default:s.h.apply(s.ctx,i)}s.one?(e.splice(r,1),a--):r++}}}return n&&n.afterTrigger&&n.afterTrigger(t),this},triggerWithContext:function(t){var e=this._$handlers[t],n=this._$eventProcessor;if(e){var i=arguments,o=i.length;4<o&&(i=Dt.call(i,1,i.length-1));for(var a=i[i.length-1],r=e.length,s=0;s<r;){var l=e[s];if(n&&n.filter&&null!=l.query&&!n.filter(t,l.query))s++;else{switch(o){case 1:l.h.call(a);break;case 2:l.h.call(a,i[1]);break;case 3:l.h.call(a,i[1],i[2]);break;default:l.h.apply(a,i)}l.one?(e.splice(s,1),r--):s++}}}return n&&n.afterTrigger&&n.afterTrigger(t),this}};var kt=Math.log(2);function Pt(t,e,n,i,o,a){var r=i+"-"+o,s=t.length;if(a.hasOwnProperty(r))return a[r];if(1===e){var l=Math.round(Math.log((1<<s)-1&~o)/kt);return t[n][l]}for(var h=i|1<<n,u=n+1;i&1<<u;)u++;for(var c=0,d=0,p=0;d<s;d++){var g=1<<d;g&o||(c+=(p%2?-1:1)*t[n][d]*Pt(t,e-1,u,h,o|g,a),p++)}return a[r]=c}var Nt="undefined"!=typeof window&&!!window.addEventListener,Ot=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Et="___zrEVENTSAVED",zt=[];function Rt(t,e,n,i){return n=n||{},i||!v.canvasSupported?Bt(t,e,n):v.browser.firefox&&null!=e.layerX&&e.layerX!==e.offsetX?(n.zrX=e.layerX,n.zrY=e.layerY):null!=e.offsetX?(n.zrX=e.offsetX,n.zrY=e.offsetY):Bt(t,e,n),n}function Bt(t,e,n){if(t.getBoundingClientRect&&v.domSupported){var i=e.clientX,o=e.clientY;if("CANVAS"===t.nodeName.toUpperCase()){var a=t.getBoundingClientRect();return n.zrX=i-a.left,void(n.zrY=o-a.top)}var r=t[Et]||(t[Et]={}),s=function(t,e){for(var n=e.transformer,i=e.srcCoords,o=!0,a=[],r=[],s=0;s<4;s++){var l=t[s].getBoundingClientRect(),h=2*s,u=l.left,c=l.top;a.push(u,c),o&=i&&u===i[h]&&c===i[1+h],r.push(t[s].offsetLeft,t[s].offsetTop)}return o?n:(e.srcCoords=a,e.transformer=function(t,e){var n=[[t[0],t[1],1,0,0,0,-e[0]*t[0],-e[0]*t[1]],[0,0,0,t[0],t[1],1,-e[1]*t[0],-e[1]*t[1]],[t[2],t[3],1,0,0,0,-e[2]*t[2],-e[2]*t[3]],[0,0,0,t[2],t[3],1,-e[3]*t[2],-e[3]*t[3]],[t[4],t[5],1,0,0,0,-e[4]*t[4],-e[4]*t[5]],[0,0,0,t[4],t[5],1,-e[5]*t[4],-e[5]*t[5]],[t[6],t[7],1,0,0,0,-e[6]*t[6],-e[6]*t[7]],[0,0,0,t[6],t[7],1,-e[7]*t[6],-e[7]*t[7]]],i={},o=Pt(n,8,0,0,0,i);if(0!==o){for(var a=[],r=0;r<8;r++)for(var s=0;s<8;s++)null==a[s]&&(a[s]=0),a[s]+=((r+s)%2?-1:1)*Pt(n,7,0===r?1:0,1<<r,1<<s,i)/o*e[r];return function(t,e,n){var i=e*a[6]+n*a[7]+1;t[0]=(e*a[0]+n*a[1]+a[2])/i,t[1]=(e*a[3]+n*a[4]+a[5])/i}}}(a,r))}(function(t,e){var n=e.markers;if(n)return n;n=e.markers=[];for(var i=["left","right"],o=["top","bottom"],a=0;a<4;a++){var r=document.createElement("div"),s=r.style,l=a%2,h=(a>>1)%2;s.cssText=["position:absolute","visibility: hidden","padding: 0","margin: 0","border-width: 0","width:0","height:0",i[l]+":0",o[h]+":0",i[1-l]+":auto",o[1-h]+":auto",""].join("!important;"),t.appendChild(r),n.push(r)}return n}(t,r),r);if(s)return s(zt,i,o),n.zrX=zt[0],void(n.zrY=zt[1])}n.zrX=n.zrY=0}function Vt(t){return t||window.event}function Gt(t,e,n){if(null!=(e=Vt(e)).zrX)return e;var i,o=e.type;o&&0<=o.indexOf("touch")?(i="touchend"!==o?e.targetTouches[0]:e.changedTouches[0])&&Rt(t,i,e,n):(Rt(t,e,e,n),e.zrDelta=e.wheelDelta?e.wheelDelta/120:-(e.detail||0)/3);var a=e.button;return null==e.which&&void 0!==a&&Ot.test(e.type)&&(e.which=1&a?1:2&a?3:4&a?2:0),e}function Ft(t,e,n,i){Nt?t.addEventListener(e,n,i):t.attachEvent("on"+e,n)}var Wt=Nt?function(t){t.preventDefault(),t.stopPropagation(),t.cancelBubble=!0}:function(t){t.returnValue=!1,t.cancelBubble=!0};function Ht(t){return 2===t.which||3===t.which}function Zt(){this._track=[]}function Ut(t){var e=t[1][0]-t[0][0],n=t[1][1]-t[0][1];return Math.sqrt(e*e+n*n)}Zt.prototype={constructor:Zt,recognize:function(t,e,n){return this._doTrack(t,e,n),this._recognize(t)},clear:function(){return this._track.length=0,this},_doTrack:function(t,e,n){var i=t.touches;if(i){for(var o={points:[],touches:[],target:e,event:t},a=0,r=i.length;a<r;a++){var s=i[a],l=Rt(n,s,{});o.points.push([l.zrX,l.zrY]),o.touches.push(s)}this._track.push(o)}},_recognize:function(t){for(var e in Xt)if(Xt.hasOwnProperty(e)){var n=Xt[e](this._track,t);if(n)return n}}};var Xt={pinch:function(t,e){var n=t.length;if(n){var i,o=(t[n-1]||{}).points,a=(t[n-2]||{}).points||o;if(a&&1<a.length&&o&&1<o.length){var r=Ut(o)/Ut(a);isFinite(r)||(r=1),e.pinchScale=r;var s=[((i=o)[0][0]+i[1][0])/2,(i[0][1]+i[1][1])/2];return e.pinchX=s[0],e.pinchY=s[1],{type:"pinch",target:t[0].target,event:e}}}}},Yt="silent";function jt(){Wt(this.event)}function qt(){}qt.prototype.dispose=function(){};function Kt(t,e,n,i){Ct.call(this),this.storage=t,this.painter=e,this.painterRoot=i,n=n||new qt,this.proxy=null,this._hovered={},this._lastTouchMoment,this._lastX,this._lastY,this._gestureMgr,Tt.call(this),this.setHandlerProxy(n)}var $t=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"];function Jt(t,e,n){if(t[t.rectHover?"rectContain":"contain"](e,n)){for(var i,o=t;o;){if(o.clipPath&&!o.clipPath.contain(e,n))return!1;o.silent&&(i=!0),o=o.parent}return!i||Yt}return!1}function Qt(t,e,n){var i=t.painter;return e<0||e>i.getWidth()||n<0||n>i.getHeight()}Kt.prototype={constructor:Kt,setHandlerProxy:function(e){this.proxy&&this.proxy.dispose(),e&&(P($t,function(t){e.on&&e.on(t,this[t],this)},this),e.handler=this),this.proxy=e},mousemove:function(t){var e=t.zrX,n=t.zrY,i=Qt(this,e,n),o=this._hovered,a=o.target;a&&!a.__zr&&(a=(o=this.findHover(o.x,o.y)).target);var r=this._hovered=i?{x:e,y:n}:this.findHover(e,n),s=r.target,l=this.proxy;l.setCursor&&l.setCursor(s?s.cursor:"default"),a&&s!==a&&this.dispatchToElement(o,"mouseout",t),this.dispatchToElement(r,"mousemove",t),s&&s!==a&&this.dispatchToElement(r,"mouseover",t)},mouseout:function(t){var e=t.zrEventControl,n=t.zrIsToLocalDOM;"only_globalout"!==e&&this.dispatchToElement(this._hovered,"mouseout",t),"no_globalout"!==e&&(n||this.trigger("globalout",{type:"globalout",event:t}))},resize:function(t){this._hovered={}},dispatch:function(t,e){var n=this[t];n&&n.call(this,e)},dispose:function(){this.proxy.dispose(),this.storage=this.proxy=this.painter=null},setCursorStyle:function(t){var e=this.proxy;e.setCursor&&e.setCursor(t)},dispatchToElement:function(t,e,n){var i=(t=t||{}).target;if(!i||!i.silent){for(var o,a,r="on"+e,s={type:e,event:a=n,target:(o=t).target,topTarget:o.topTarget,cancelBubble:!1,offsetX:a.zrX,offsetY:a.zrY,gestureEvent:a.gestureEvent,pinchX:a.pinchX,pinchY:a.pinchY,pinchScale:a.pinchScale,wheelDelta:a.zrDelta,zrByTouch:a.zrByTouch,which:a.which,stop:jt};i&&(i[r]&&(s.cancelBubble=i[r].call(i,s)),i.trigger(e,s),i=i.parent,!s.cancelBubble););s.cancelBubble||(this.trigger(e,s),this.painter&&this.painter.eachOtherLayer(function(t){"function"==typeof t[r]&&t[r].call(t,s),t.trigger&&t.trigger(e,s)}))}},findHover:function(t,e,n){for(var i,o=this.storage.getDisplayList(),a={x:t,y:e},r=o.length-1;0<=r;r--){if(o[r]!==n&&!o[r].ignore&&(i=Jt(o[r],t,e))&&(a.topTarget||(a.topTarget=o[r]),i!==Yt)){a.target=o[r];break}}return a},processGesture:function(t,e){this._gestureMgr||(this._gestureMgr=new Zt);var n=this._gestureMgr;"start"===e&&n.clear();var i,o=n.recognize(t,this.findHover(t.zrX,t.zrY,null).target,this.proxy.dom);"end"===e&&n.clear(),o&&(i=o.type,t.gestureEvent=i,this.dispatchToElement({target:o.target},i,o.event))}},P(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(r){Kt.prototype[r]=function(t){var e,n,i=t.zrX,o=t.zrY,a=Qt(this,i,o);if("mouseup"===r&&a||(n=(e=this.findHover(i,o)).target),"mousedown"===r)this._downEl=n,this._downPoint=[t.zrX,t.zrY],this._upEl=n;else if("mouseup"===r)this._upEl=n;else if("click"===r){if(this._downEl!==this._upEl||!this._downPoint||4<yt(this._downPoint,[t.zrX,t.zrY]))return;this._downPoint=null}this.dispatchToElement(e,r,t)}}),b(Kt,Ct),b(Kt,Tt);var te="undefined"==typeof Float32Array?Array:Float32Array;function ee(){var t=new te(6);return ne(t),t}function ne(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function ie(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function oe(t,e,n){var i=e[0]*n[0]+e[2]*n[1],o=e[1]*n[0]+e[3]*n[1],a=e[0]*n[2]+e[2]*n[3],r=e[1]*n[2]+e[3]*n[3],s=e[0]*n[4]+e[2]*n[5]+e[4],l=e[1]*n[4]+e[3]*n[5]+e[5];return t[0]=i,t[1]=o,t[2]=a,t[3]=r,t[4]=s,t[5]=l,t}function ae(t,e,n){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4]+n[0],t[5]=e[5]+n[1],t}function re(t,e,n){var i=e[0],o=e[2],a=e[4],r=e[1],s=e[3],l=e[5],h=Math.sin(n),u=Math.cos(n);return t[0]=i*u+r*h,t[1]=-i*h+r*u,t[2]=o*u+s*h,t[3]=-o*h+u*s,t[4]=u*a+h*l,t[5]=u*l-h*a,t}function se(t,e,n){var i=n[0],o=n[1];return t[0]=e[0]*i,t[1]=e[1]*o,t[2]=e[2]*i,t[3]=e[3]*o,t[4]=e[4]*i,t[5]=e[5]*o,t}function le(t,e){var n=e[0],i=e[2],o=e[4],a=e[1],r=e[3],s=e[5],l=n*r-a*i;return l?(l=1/l,t[0]=r*l,t[1]=-a*l,t[2]=-i*l,t[3]=n*l,t[4]=(i*s-r*o)*l,t[5]=(a*o-n*s)*l,t):null}function he(t){var e=ee();return ie(e,t),e}var ue=(Object.freeze||Object)({create:ee,identity:ne,copy:ie,mul:oe,translate:ae,rotate:re,scale:se,invert:le,clone:he}),ce=ne;function de(t){return 5e-5<t||t<-5e-5}var pe=function(t){(t=t||{}).position||(this.position=[0,0]),null==t.rotation&&(this.rotation=0),t.scale||(this.scale=[1,1]),this.origin=this.origin||null},ge=pe.prototype;ge.transform=null,ge.needLocalTransform=function(){return de(this.rotation)||de(this.position[0])||de(this.position[1])||de(this.scale[0]-1)||de(this.scale[1]-1)};var fe=[];ge.updateTransform=function(){var t,e,n,i,o,a=this.parent,r=a&&a.transform,s=this.needLocalTransform(),l=this.transform;s||r?(l=l||ee(),s?this.getLocalTransform(l):ce(l),r&&(s?oe(l,a.transform,l):ie(l,a.transform)),this.transform=l,null!=(t=this.globalScaleRatio)&&1!==t&&(this.getGlobalScale(fe),i=((fe[0]-(e=fe[0]<0?-1:1))*t+e)/fe[0]||0,o=((fe[1]-(n=fe[1]<0?-1:1))*t+n)/fe[1]||0,l[0]*=i,l[1]*=i,l[2]*=o,l[3]*=o),this.invTransform=this.invTransform||ee(),le(this.invTransform,l)):l&&ce(l)},ge.getLocalTransform=function(t){return pe.getLocalTransform(this,t)},ge.setTransform=function(t){var e=this.transform,n=t.dpr||1;e?t.setTransform(n*e[0],n*e[1],n*e[2],n*e[3],n*e[4],n*e[5]):t.setTransform(n,0,0,n,0,0)},ge.restoreTransform=function(t){var e=t.dpr||1;t.setTransform(e,0,0,e,0,0)};var me=[],ve=ee();ge.setLocalTransform=function(t){var e,n,i,o;t&&(e=t[0]*t[0]+t[1]*t[1],n=t[2]*t[2]+t[3]*t[3],i=this.position,o=this.scale,de(e-1)&&(e=Math.sqrt(e)),de(n-1)&&(n=Math.sqrt(n)),t[0]<0&&(e=-e),t[3]<0&&(n=-n),i[0]=t[4],i[1]=t[5],o[0]=e,o[1]=n,this.rotation=Math.atan2(-t[1]/n,t[0]/e))},ge.decomposeTransform=function(){var t,e,n;this.transform&&(t=this.parent,e=this.transform,t&&t.transform&&(oe(me,t.invTransform,e),e=me),(n=this.origin)&&(n[0]||n[1])&&(ve[4]=n[0],ve[5]=n[1],oe(me,e,ve),me[4]-=n[0],me[5]-=n[1],e=me),this.setLocalTransform(e))},ge.getGlobalScale=function(t){var e=this.transform;return t=t||[],e?(t[0]=Math.sqrt(e[0]*e[0]+e[1]*e[1]),t[1]=Math.sqrt(e[2]*e[2]+e[3]*e[3]),e[0]<0&&(t[0]=-t[0]),e[3]<0&&(t[1]=-t[1])):(t[0]=1,t[1]=1),t},ge.transformCoordToLocal=function(t,e){var n=[t,e],i=this.invTransform;return i&&bt(n,n,i),n},ge.transformCoordToGlobal=function(t,e){var n=[t,e],i=this.transform;return i&&bt(n,n,i),n},pe.getLocalTransform=function(t,e){ce(e=e||[]);var n=t.origin,i=t.scale||[1,1],o=t.rotation||0,a=t.position||[0,0];return n&&(e[4]-=n[0],e[5]-=n[1]),se(e,e,i),o&&re(e,e,o),n&&(e[4]+=n[0],e[5]+=n[1]),e[4]+=a[0],e[5]+=a[1],e};var ye={linear:function(t){return t},quadraticIn:function(t){return t*t},quadraticOut:function(t){return t*(2-t)},quadraticInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},cubicIn:function(t){return t*t*t},cubicOut:function(t){return--t*t*t+1},cubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},quarticIn:function(t){return t*t*t*t},quarticOut:function(t){return 1- --t*t*t*t},quarticInOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},quinticIn:function(t){return t*t*t*t*t},quinticOut:function(t){return--t*t*t*t*t+1},quinticInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},sinusoidalIn:function(t){return 1-Math.cos(t*Math.PI/2)},sinusoidalOut:function(t){return Math.sin(t*Math.PI/2)},sinusoidalInOut:function(t){return.5*(1-Math.cos(Math.PI*t))},exponentialIn:function(t){return 0===t?0:Math.pow(1024,t-1)},exponentialOut:function(t){return 1===t?1:1-Math.pow(2,-10*t)},exponentialInOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))},circularIn:function(t){return 1-Math.sqrt(1-t*t)},circularOut:function(t){return Math.sqrt(1- --t*t)},circularInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},elasticIn:function(t){var e,n=.1;return 0===t?0:1===t?1:(e=!n||n<1?(n=1,.1):.4*Math.asin(1/n)/(2*Math.PI),-(n*Math.pow(2,10*--t)*Math.sin((t-e)*(2*Math.PI)/.4)))},elasticOut:function(t){var e,n=.1;return 0===t?0:1===t?1:(e=!n||n<1?(n=1,.1):.4*Math.asin(1/n)/(2*Math.PI),n*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/.4)+1)},elasticInOut:function(t){var e,n=.1;return 0===t?0:1===t?1:(e=!n||n<1?(n=1,.1):.4*Math.asin(1/n)/(2*Math.PI),(t*=2)<1?n*Math.pow(2,10*--t)*Math.sin((t-e)*(2*Math.PI)/.4)*-.5:n*Math.pow(2,-10*--t)*Math.sin((t-e)*(2*Math.PI)/.4)*.5+1)},backIn:function(t){return t*t*(2.70158*t-1.70158)},backOut:function(t){return--t*t*(2.70158*t+1.70158)+1},backInOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((1+e)*t-e)*.5:.5*((t-=2)*t*((1+e)*t+e)+2)},bounceIn:function(t){return 1-ye.bounceOut(1-t)},bounceOut:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},bounceInOut:function(t){return t<.5?.5*ye.bounceIn(2*t):.5*ye.bounceOut(2*t-1)+.5}};function xe(t){this._target=t.target,this._life=t.life||1e3,this._delay=t.delay||0,this._initialized=!1,this.loop=null!=t.loop&&t.loop,this.gap=t.gap||0,this.easing=t.easing||"Linear",this.onframe=t.onframe,this.ondestroy=t.ondestroy,this.onrestart=t.onrestart,this._pausedTime=0,this._paused=!1}xe.prototype={constructor:xe,step:function(t,e){if(this._initialized||(this._startTime=t+this._delay,this._initialized=!0),this._paused)this._pausedTime+=e;else{var n=(t-this._startTime-this._pausedTime)/this._life;if(!(n<0)){n=Math.min(n,1);var i=this.easing,o="string"==typeof i?ye[i]:i,a="function"==typeof o?o(n):n;return this.fire("frame",a),1===n?this.loop?(this.restart(t),"restart"):(this._needsRemove=!0,"destroy"):null}}},restart:function(t){var e=(t-this._startTime-this._pausedTime)%this._life;this._startTime=t-e+this.gap,this._pausedTime=0,this._needsRemove=!1},fire:function(t,e){this[t="on"+t]&&this[t](this._target,e)},pause:function(){this._paused=!0},resume:function(){this._paused=!1}};function _e(){this.head=null,this.tail=null,this._len=0}var we=_e.prototype;we.insert=function(t){var e=new Se(t);return this.insertEntry(e),e},we.insertEntry=function(t){this.head?((this.tail.next=t).prev=this.tail,t.next=null,this.tail=t):this.head=this.tail=t,this._len++},we.remove=function(t){var e=t.prev,n=t.next;e?e.next=n:this.head=n,n?n.prev=e:this.tail=e,t.next=t.prev=null,this._len--},we.len=function(){return this._len},we.clear=function(){this.head=this.tail=null,this._len=0};function be(t){this._list=new _e,this._map={},this._maxSize=t||10,this._lastRemovedEntry=null}var Se=function(t){this.value=t,this.next,this.prev},Me=be.prototype;Me.put=function(t,e){var n,i,o,a=this._list,r=this._map,s=null;return null==r[t]&&(n=a.len(),i=this._lastRemovedEntry,n>=this._maxSize&&0<n&&(o=a.head,a.remove(o),delete r[o.key],s=o.value,this._lastRemovedEntry=o),i?i.value=e:i=new Se(e),i.key=t,a.insertEntry(i),r[t]=i),s},Me.get=function(t){var e=this._map[t],n=this._list;if(null!=e)return e!==n.tail&&(n.remove(e),n.insertEntry(e)),e.value},Me.clear=function(){this._list.clear(),this._map={}};var Ie={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Te(t){return(t=Math.round(t))<0?0:255<t?255:t}function Ae(t){return t<0?0:1<t?1:t}function De(t){return t.length&&"%"===t.charAt(t.length-1)?Te(parseFloat(t)/100*255):Te(parseInt(t,10))}function Ce(t){return t.length&&"%"===t.charAt(t.length-1)?Ae(parseFloat(t)/100):Ae(parseFloat(t))}function Le(t,e,n){return n<0?n+=1:1<n&&--n,6*n<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}function ke(t,e,n){return t+(e-t)*n}function Pe(t,e,n,i,o){return t[0]=e,t[1]=n,t[2]=i,t[3]=o,t}function Ne(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}var Oe=new be(20),Ee=null;function ze(t,e){Ee&&Ne(Ee,e),Ee=Oe.put(t,Ee||e.slice())}function Re(t,e){if(t){e=e||[];var n=Oe.get(t);if(n)return Ne(e,n);var i,o=(t+="").replace(/ /g,"").toLowerCase();if(o in Ie)return Ne(e,Ie[o]),ze(t,e),e;if("#"===o.charAt(0))return 4===o.length?0<=(i=parseInt(o.substr(1),16))&&i<=4095?(Pe(e,(3840&i)>>4|(3840&i)>>8,240&i|(240&i)>>4,15&i|(15&i)<<4,1),ze(t,e),e):void Pe(e,0,0,0,1):7===o.length?0<=(i=parseInt(o.substr(1),16))&&i<=16777215?(Pe(e,(16711680&i)>>16,(65280&i)>>8,255&i,1),ze(t,e),e):void Pe(e,0,0,0,1):void 0;var a=o.indexOf("("),r=o.indexOf(")");if(-1!==a&&r+1===o.length){var s=o.substr(0,a),l=o.substr(a+1,r-(a+1)).split(","),h=1;switch(s){case"rgba":if(4!==l.length)return void Pe(e,0,0,0,1);h=Ce(l.pop());case"rgb":return 3!==l.length?void Pe(e,0,0,0,1):(Pe(e,De(l[0]),De(l[1]),De(l[2]),h),ze(t,e),e);case"hsla":return 4!==l.length?void Pe(e,0,0,0,1):(l[3]=Ce(l[3]),Be(l,e),ze(t,e),e);case"hsl":return 3!==l.length?void Pe(e,0,0,0,1):(Be(l,e),ze(t,e),e);default:return}}Pe(e,0,0,0,1)}}function Be(t,e){var n=(parseFloat(t[0])%360+360)%360/360,i=Ce(t[1]),o=Ce(t[2]),a=o<=.5?o*(i+1):o+i-o*i,r=2*o-a;return Pe(e=e||[],Te(255*Le(r,a,n+1/3)),Te(255*Le(r,a,n)),Te(255*Le(r,a,n-1/3)),1),4===t.length&&(e[3]=t[3]),e}function Ve(t,e){var n=Re(t);if(n){for(var i=0;i<3;i++)n[i]=e<0?n[i]*(1-e)|0:(255-n[i])*e+n[i]|0,255<n[i]?n[i]=255:t[i]<0&&(n[i]=0);return Ue(n,4===n.length?"rgba":"rgb")}}function Ge(t){var e=Re(t);if(e)return((1<<24)+(e[0]<<16)+(e[1]<<8)+ +e[2]).toString(16).slice(1)}function Fe(t,e,n){if(e&&e.length&&0<=t&&t<=1){n=n||[];var i=t*(e.length-1),o=Math.floor(i),a=Math.ceil(i),r=e[o],s=e[a],l=i-o;return n[0]=Te(ke(r[0],s[0],l)),n[1]=Te(ke(r[1],s[1],l)),n[2]=Te(ke(r[2],s[2],l)),n[3]=Ae(ke(r[3],s[3],l)),n}}function We(t,e,n){if(e&&e.length&&0<=t&&t<=1){var i=t*(e.length-1),o=Math.floor(i),a=Math.ceil(i),r=Re(e[o]),s=Re(e[a]),l=i-o,h=Ue([Te(ke(r[0],s[0],l)),Te(ke(r[1],s[1],l)),Te(ke(r[2],s[2],l)),Ae(ke(r[3],s[3],l))],"rgba");return n?{color:h,leftIndex:o,rightIndex:a,value:i}:h}}function He(t,e,n,i){if(t=Re(t))return t=function(t){if(t){var e,n,i,o,a,r=t[0]/255,s=t[1]/255,l=t[2]/255,h=Math.min(r,s,l),u=Math.max(r,s,l),c=u-h,d=(u+h)/2;0==c?n=e=0:(n=d<.5?c/(u+h):c/(2-u-h),i=((u-r)/6+c/2)/c,o=((u-s)/6+c/2)/c,a=((u-l)/6+c/2)/c,r===u?e=a-o:s===u?e=1/3+i-a:l===u&&(e=2/3+o-i),e<0&&(e+=1),1<e&&--e);var p=[360*e,n,d];return null!=t[3]&&p.push(t[3]),p}}(t),null!=e&&(t[0]=(o=e,(o=Math.round(o))<0?0:360<o?360:o)),null!=n&&(t[1]=Ce(n)),null!=i&&(t[2]=Ce(i)),Ue(Be(t),"rgba");var o}function Ze(t,e){if((t=Re(t))&&null!=e)return t[3]=Ae(e),Ue(t,"rgba")}function Ue(t,e){if(t&&t.length){var n=t[0]+","+t[1]+","+t[2];return"rgba"!==e&&"hsva"!==e&&"hsla"!==e||(n+=","+t[3]),e+"("+n+")"}}var Xe=(Object.freeze||Object)({parse:Re,lift:Ve,toHex:Ge,fastLerp:Fe,fastMapToColor:Fe,lerp:We,mapToColor:We,modifyHSL:He,modifyAlpha:Ze,stringify:Ue}),Ye=Array.prototype.slice;function je(t,e){return t[e]}function qe(t,e,n){t[e]=n}function Ke(t,e,n){return(e-t)*n+t}function $e(t,e,n){return.5<n?e:t}function Je(t,e,n,i,o){var a=t.length;if(1===o)for(var r=0;r<a;r++)i[r]=Ke(t[r],e[r],n);else for(var s=a&&t[0].length,r=0;r<a;r++)for(var l=0;l<s;l++)i[r][l]=Ke(t[r][l],e[r][l],n)}function Qe(t,e,n){var i=t.length,o=e.length;if(i!==o)if(o<i)t.length=o;else for(var a=i;a<o;a++)t.push(1===n?e[a]:Ye.call(e[a]));for(var r=t[0]&&t[0].length,a=0;a<t.length;a++)if(1===n)isNaN(t[a])&&(t[a]=e[a]);else for(var s=0;s<r;s++)isNaN(t[a][s])&&(t[a][s]=e[a][s])}function tn(t,e,n){if(t===e)return 1;var i=t.length;if(i===e.length){if(1===n){for(var o=0;o<i;o++)if(t[o]!==e[o])return}else for(var a=t[0].length,o=0;o<i;o++)for(var r=0;r<a;r++)if(t[o][r]!==e[o][r])return;return 1}}function en(t,e,n,i,o,a,r,s,l){var h=t.length;if(1===l)for(var u=0;u<h;u++)s[u]=nn(t[u],e[u],n[u],i[u],o,a,r);else for(var c=t[0].length,u=0;u<h;u++)for(var d=0;d<c;d++)s[u][d]=nn(t[u][d],e[u][d],n[u][d],i[u][d],o,a,r)}function nn(t,e,n,i,o,a,r){var s=.5*(n-t),l=.5*(i-e);return(2*(e-n)+s+l)*r+(-3*(e-n)-2*s-l)*a+s*o+e}function on(t){if(O(t)){var e=t.length;if(O(t[0])){for(var n=[],i=0;i<e;i++)n.push(Ye.call(t[i]));return n}return Ye.call(t)}return t}function an(t){return t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.floor(t[2]),"rgba("+t.join(",")+")"}function rn(t,e,n,i,a,o){var r=t._getter,s=t._setter,l="spline"===e,h=i.length;if(h){var u,c,d,p=O(i[0].value),g=!1,f=!1,m=p?O((c=(u=i)[u.length-1].value)&&c[0])?2:1:0;i.sort(function(t,e){return t.time-e.time}),d=i[h-1].time;for(var v=[],y=[],x=i[0].value,_=!0,w=0;w<h;w++){v.push(i[w].time/d);var b,S=i[w].value;p&&tn(S,x,m)||!p&&S===x||(_=!1),"string"==typeof(x=S)&&((b=Re(S))?(S=b,g=!0):f=!0),y.push(S)}if(o||!_){for(var M=y[h-1],w=0;w<h-1;w++)p?Qe(y[w],M,m):!isNaN(y[w])||isNaN(M)||f||g||(y[w]=M);p&&Qe(r(t._target,a),M,m);var I,T,A,D,C,L,k=0,P=0;g&&(L=[0,0,0,0]);var N=new xe({target:t._target,life:d,loop:t._loop,delay:t._delay,onframe:function(t,e){var n;if(e<0)n=0;else if(e<P){for(n=Math.min(k+1,h-1);0<=n&&!(v[n]<=e);n--);n=Math.min(n,h-2)}else{for(n=k;n<h&&!(v[n]>e);n++);n=Math.min(n-1,h-2)}P=e;var i,o=v[(k=n)+1]-v[n];if(0!=o)if(I=(e-v[n])/o,l)if(A=y[n],T=y[0===n?n:n-1],D=y[h-2<n?h-1:n+1],C=y[h-3<n?h-1:n+2],p)en(T,A,D,C,I,I*I,I*I*I,r(t,a),m);else{if(g)i=en(T,A,D,C,I,I*I,I*I*I,L,1),i=an(L);else{if(f)return.5<I?D:A;i=nn(T,A,D,C,I,I*I,I*I*I)}s(t,a,i)}else if(p)Je(y[n],y[n+1],I,r(t,a),m);else{if(g)Je(y[n],y[n+1],I,L,1),i=an(L);else{if(f)return $e(y[n],y[n+1],I);i=Ke(y[n],y[n+1],I)}s(t,a,i)}},ondestroy:n});return e&&"spline"!==e&&(N.easing=e),N}}}function sn(t,e,n,i){this._tracks={},this._target=t,this._loop=e||!1,this._getter=n||je,this._setter=i||qe,this._clipCount=0,this._delay=0,this._doneList=[],this._onframeList=[],this._clipList=[]}sn.prototype={when:function(t,e){var n=this._tracks;for(var i in e)if(e.hasOwnProperty(i)){if(!n[i]){n[i]=[];var o=this._getter(this._target,i);if(null==o)continue;0!==t&&n[i].push({time:0,value:on(o)})}n[i].push({time:t,value:e[i]})}return this},during:function(t){return this._onframeList.push(t),this},pause:function(){for(var t=0;t<this._clipList.length;t++)this._clipList[t].pause();this._paused=!0},resume:function(){for(var t=0;t<this._clipList.length;t++)this._clipList[t].resume();this._paused=!1},isPaused:function(){return!!this._paused},_doneCallback:function(){this._tracks={},this._clipList.length=0;for(var t=this._doneList,e=t.length,n=0;n<e;n++)t[n].call(this)},start:function(t,e){function n(){--s||r._doneCallback()}var i,o,a,r=this,s=0;for(var l in this._tracks){this._tracks.hasOwnProperty(l)&&((o=rn(this,t,n,this._tracks[l],l,e))&&(this._clipList.push(o),s++,this.animation&&this.animation.addClip(o),i=o))}return i&&(a=i.onframe,i.onframe=function(t,e){a(t,e);for(var n=0;n<r._onframeList.length;n++)r._onframeList[n](t,e)}),s||this._doneCallback(),this},stop:function(t){for(var e=this._clipList,n=this.animation,i=0;i<e.length;i++){var o=e[i];t&&o.onframe(this._target,1),n&&n.removeClip(o)}e.length=0},delay:function(t){return this._delay=t,this},done:function(t){return t&&this._doneList.push(t),this},getClips:function(){return this._clipList}};var ln=1;"undefined"!=typeof window&&(ln=Math.max(window.devicePixelRatio||1,1));var hn=ln,un=function(){};function cn(){this.animators=[]}var dn=un;function pn(t,e,n,i,o,a,r,s){B(i)?(a=o,o=i,i=0):A(o)?(a=o,o="linear",i=0):A(i)?(a=i,i=0):n=A(n)?(a=n,500):n||500,t.stopAnimation(),function t(e,n,i,o,a,r,s){var l={};var h=0;for(var u in o)o.hasOwnProperty(u)&&(null!=i[u]?V(o[u])&&!O(o[u])?t(e,n?n+"."+u:u,i[u],o[u],a,r,s):(s?(l[u]=i[u],gn(e,n,u,o[u])):l[u]=o[u],h++):null==o[u]||s||gn(e,n,u,o[u]));0<h&&e.animate(n,!1).when(null==a?500:a,l).delay(r||0)}(t,"",t,e,n,i,s);var l=t.animators.slice(),h=l.length;function u(){--h||a&&a()}h||a&&a();for(var c=0;c<l.length;c++)l[c].done(u).start(o,r)}function gn(t,e,n,i){var o;e?((o={})[e]={},o[e][n]=i,t.attr(o)):t.attr(n,i)}cn.prototype={constructor:cn,animate:function(t,e){var n,i=!1,o=this,a=this.__zr;if(t){for(var r=t.split("."),s=o,i="shape"===r[0],l=0,h=r.length;l<h;l++)s=s&&s[r[l]];s&&(n=s)}else n=o;if(n){var u=o.animators,c=new sn(n,e);return c.during(function(t){o.dirty(i)}).done(function(){u.splice(M(u,c),1)}),u.push(c),a&&a.animation.addAnimator(c),c}dn('Property "'+t+'" is not existed in element '+o.id)},stopAnimation:function(t){for(var e=this.animators,n=e.length,i=0;i<n;i++)e[i].stop(t);return e.length=0,this},animateTo:function(t,e,n,i,o,a){pn(this,t,e,n,i,o,a)},animateFrom:function(t,e,n,i,o,a){pn(this,t,e,n,i,o,a,!0)}};var fn=function(t){pe.call(this,t),Ct.call(this,t),cn.call(this,t),this.id=t.id||i()};fn.prototype={type:"element",name:"",__zr:null,ignore:!1,clipPath:null,isGroup:!1,drift:function(t,e){switch(this.draggable){case"horizontal":e=0;break;case"vertical":t=0}var n=this.transform;(n=n||(this.transform=[1,0,0,1,0,0]))[4]+=t,n[5]+=e,this.decomposeTransform(),this.dirty(!1)},beforeUpdate:function(){},afterUpdate:function(){},update:function(){this.updateTransform()},traverse:function(t,e){},attrKV:function(t,e){var n;"position"===t||"scale"===t||"origin"===t?e&&((n=(n=this[t])||(this[t]=[]))[0]=e[0],n[1]=e[1]):this[t]=e},hide:function(){this.ignore=!0,this.__zr&&this.__zr.refresh()},show:function(){this.ignore=!1,this.__zr&&this.__zr.refresh()},attr:function(t,e){if("string"==typeof t)this.attrKV(t,e);else if(V(t))for(var n in t)t.hasOwnProperty(n)&&this.attrKV(n,t[n]);return this.dirty(!1),this},setClipPath:function(t){var e=this.__zr;e&&t.addSelfToZr(e),this.clipPath&&this.clipPath!==t&&this.removeClipPath(),(this.clipPath=t).__zr=e,(t.__clipTarget=this).dirty(!1)},removeClipPath:function(){var t=this.clipPath;t&&(t.__zr&&t.removeSelfFromZr(t.__zr),t.__zr=null,t.__clipTarget=null,this.clipPath=null,this.dirty(!1))},addSelfToZr:function(t){this.__zr=t;var e=this.animators;if(e)for(var n=0;n<e.length;n++)t.animation.addAnimator(e[n]);this.clipPath&&this.clipPath.addSelfToZr(t)},removeSelfFromZr:function(t){this.__zr=null;var e=this.animators;if(e)for(var n=0;n<e.length;n++)t.animation.removeAnimator(e[n]);this.clipPath&&this.clipPath.removeSelfFromZr(t)}},b(fn,cn),b(fn,pe),b(fn,Ct);var mn,vn,yn,xn,_n=bt,wn=Math.min,bn=Math.max;function Sn(t,e,n,i){n<0&&(t+=n,n=-n),i<0&&(e+=i,i=-i),this.x=t,this.y=e,this.width=n,this.height=i}Sn.prototype={constructor:Sn,union:function(t){var e=wn(t.x,this.x),n=wn(t.y,this.y);this.width=bn(t.x+t.width,this.x+this.width)-e,this.height=bn(t.y+t.height,this.y+this.height)-n,this.x=e,this.y=n},applyTransform:(mn=[],vn=[],yn=[],xn=[],function(t){var e,n;t&&(mn[0]=yn[0]=this.x,mn[1]=xn[1]=this.y,vn[0]=xn[0]=this.x+this.width,vn[1]=yn[1]=this.y+this.height,_n(mn,mn,t),_n(vn,vn,t),_n(yn,yn,t),_n(xn,xn,t),this.x=wn(mn[0],vn[0],yn[0],xn[0]),this.y=wn(mn[1],vn[1],yn[1],xn[1]),e=bn(mn[0],vn[0],yn[0],xn[0]),n=bn(mn[1],vn[1],yn[1],xn[1]),this.width=e-this.x,this.height=n-this.y)}),calculateTransform:function(t){var e=t.width/this.width,n=t.height/this.height,i=ee();return ae(i,i,[-this.x,-this.y]),se(i,i,[e,n]),ae(i,i,[t.x,t.y]),i},intersect:function(t){if(!t)return!1;t instanceof Sn||(t=Sn.create(t));var e=this,n=e.x,i=e.x+e.width,o=e.y,a=e.y+e.height,r=t.x,s=t.x+t.width,l=t.y,h=t.y+t.height;return!(i<r||s<n||a<l||h<o)},contain:function(t,e){var n=this;return t>=n.x&&t<=n.x+n.width&&e>=n.y&&e<=n.y+n.height},clone:function(){return new Sn(this.x,this.y,this.width,this.height)},copy:function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height},plain:function(){return{x:this.x,y:this.y,width:this.width,height:this.height}}},Sn.create=function(t){return new Sn(t.x,t.y,t.width,t.height)};var Mn=function(t){for(var e in t=t||{},fn.call(this,t),t)t.hasOwnProperty(e)&&(this[e]=t[e]);this._children=[],this.__storage=null,this.__dirty=!0};Mn.prototype={constructor:Mn,isGroup:!0,type:"group",silent:!1,children:function(){return this._children.slice()},childAt:function(t){return this._children[t]},childOfName:function(t){for(var e=this._children,n=0;n<e.length;n++)if(e[n].name===t)return e[n]},childCount:function(){return this._children.length},add:function(t){return t&&t!==this&&t.parent!==this&&(this._children.push(t),this._doAdd(t)),this},addBefore:function(t,e){var n,i;return t&&t!==this&&t.parent!==this&&e&&e.parent===this&&(0<=(i=(n=this._children).indexOf(e))&&(n.splice(i,0,t),this._doAdd(t))),this},_doAdd:function(t){t.parent&&t.parent.remove(t);var e=(t.parent=this).__storage,n=this.__zr;e&&e!==t.__storage&&(e.addToStorage(t),t instanceof Mn&&t.addChildrenToStorage(e)),n&&n.refresh()},remove:function(t){var e=this.__zr,n=this.__storage,i=this._children,o=M(i,t);return o<0||(i.splice(o,1),t.parent=null,n&&(n.delFromStorage(t),t instanceof Mn&&t.delChildrenFromStorage(n)),e&&e.refresh()),this},removeAll:function(){for(var t,e=this._children,n=this.__storage,i=0;i<e.length;i++)t=e[i],n&&(n.delFromStorage(t),t instanceof Mn&&t.delChildrenFromStorage(n)),t.parent=null;return e.length=0,this},eachChild:function(t,e){for(var n=this._children,i=0;i<n.length;i++){var o=n[i];t.call(e,o,i)}return this},traverse:function(t,e){for(var n=0;n<this._children.length;n++){var i=this._children[n];t.call(e,i),"group"===i.type&&i.traverse(t,e)}return this},addChildrenToStorage:function(t){for(var e=0;e<this._children.length;e++){var n=this._children[e];t.addToStorage(n),n instanceof Mn&&n.addChildrenToStorage(t)}},delChildrenFromStorage:function(t){for(var e=0;e<this._children.length;e++){var n=this._children[e];t.delFromStorage(n),n instanceof Mn&&n.delChildrenFromStorage(t)}},dirty:function(){return this.__dirty=!0,this.__zr&&this.__zr.refresh(),this},getBoundingRect:function(t){for(var e=null,n=new Sn(0,0,0,0),i=t||this._children,o=[],a=0;a<i.length;a++){var r,s,l=i[a];l.ignore||l.invisible||(r=l.getBoundingRect(),(s=l.getLocalTransform(o))?(n.copy(r),n.applyTransform(s),(e=e||n.clone()).union(n)):(e=e||r.clone()).union(r))}return e||n}},w(Mn,fn);var In=32,Tn=7;function An(t,e,n,i){var o=e+1;if(o===n)return 1;if(i(t[o++],t[e])<0){for(;o<n&&i(t[o],t[o-1])<0;)o++;!function(t,e,n){n--;for(;e<n;){var i=t[e];t[e++]=t[n],t[n--]=i}}(t,e,o)}else for(;o<n&&0<=i(t[o],t[o-1]);)o++;return o-e}function Dn(t,e,n,i,o){for(i===e&&i++;i<n;i++){for(var a,r=t[i],s=e,l=i;s<l;)o(r,t[a=s+l>>>1])<0?l=a:s=1+a;var h=i-s;switch(h){case 3:t[s+3]=t[s+2];case 2:t[s+2]=t[s+1];case 1:t[s+1]=t[s];break;default:for(;0<h;)t[s+h]=t[s+h-1],h--}t[s]=r}}function Cn(t,e,n,i,o,a){var r=0,s=0,l=1;if(0<a(t,e[n+o])){for(s=i-o;l<s&&0<a(t,e[n+o+l]);)(l=1+((r=l)<<1))<=0&&(l=s);s<l&&(l=s),r+=o,l+=o}else{for(s=o+1;l<s&&a(t,e[n+o-l])<=0;)(l=1+((r=l)<<1))<=0&&(l=s);s<l&&(l=s);var h=r,r=o-l,l=o-h}for(r++;r<l;){var u=r+(l-r>>>1);0<a(t,e[n+u])?r=u+1:l=u}return l}function Ln(t,e,n,i,o,a){var r=0,s=0,l=1;if(a(t,e[n+o])<0){for(s=o+1;l<s&&a(t,e[n+o-l])<0;)(l=1+((r=l)<<1))<=0&&(l=s);s<l&&(l=s);var h=r,r=o-l,l=o-h}else{for(s=i-o;l<s&&0<=a(t,e[n+o+l]);)(l=1+((r=l)<<1))<=0&&(l=s);s<l&&(l=s),r+=o,l+=o}for(r++;r<l;){var u=r+(l-r>>>1);a(t,e[n+u])<0?l=u:r=u+1}return l}function kn(g,f){var r,s,m=Tn,l=0,v=[];function e(t){var e=r[t],n=s[t],i=r[t+1],o=s[t+1];s[t]=n+o,t===l-3&&(r[t+1]=r[t+2],s[t+1]=s[t+2]),l--;var a=Ln(g[i],g,e,n,0,f);e+=a,0!==(n-=a)&&0!==(o=Cn(g[e+n-1],g,i,o,o-1,f))&&(n<=o?function(t,e,n,i){var o=0;for(o=0;o<e;o++)v[o]=g[t+o];var a=0,r=n,s=t;if(g[s++]=g[r++],0==--i){for(o=0;o<e;o++)g[s+o]=v[a+o];return}if(1===e){for(o=0;o<i;o++)g[s+o]=g[r+o];return g[s+i]=v[a]}var l,h,u,c=m;for(;;){h=l=0,u=!1;do{if(f(g[r],v[a])<0){if(g[s++]=g[r++],h++,(l=0)==--i){u=!0;break}}else if(g[s++]=v[a++],l++,h=0,1==--e){u=!0;break}}while((l|h)<c);if(u)break;do{if(0!==(l=Ln(g[r],v,a,e,0,f))){for(o=0;o<l;o++)g[s+o]=v[a+o];if(s+=l,a+=l,(e-=l)<=1){u=!0;break}}if(g[s++]=g[r++],0==--i){u=!0;break}if(0!==(h=Cn(v[a],g,r,i,0,f))){for(o=0;o<h;o++)g[s+o]=g[r+o];if(s+=h,r+=h,0===(i-=h)){u=!0;break}}if(g[s++]=v[a++],1==--e){u=!0;break}c--}while(Tn<=l||Tn<=h);if(u)break;c<0&&(c=0),c+=2}if((m=c)<1&&(m=1),1===e){for(o=0;o<i;o++)g[s+o]=g[r+o];g[s+i]=v[a]}else{if(0===e)throw new Error;for(o=0;o<e;o++)g[s+o]=v[a+o]}}:function(t,e,n,i){var o=0;for(o=0;o<i;o++)v[o]=g[n+o];var a=t+e-1,r=i-1,s=n+i-1,l=0,h=0;if(g[s--]=g[a--],0==--e){for(l=s-(i-1),o=0;o<i;o++)g[l+o]=v[o];return}if(1===i){for(h=(s-=e)+1,l=(a-=e)+1,o=e-1;0<=o;o--)g[h+o]=g[l+o];return g[s]=v[r]}var u=m;for(;;){var c=0,d=0,p=!1;do{if(f(v[r],g[a])<0){if(g[s--]=g[a--],c++,(d=0)==--e){p=!0;break}}else if(g[s--]=v[r--],d++,c=0,1==--i){p=!0;break}}while((c|d)<u);if(p)break;do{if(0!==(c=e-Ln(v[r],g,t,e,e-1,f))){for(e-=c,h=(s-=c)+1,l=(a-=c)+1,o=c-1;0<=o;o--)g[h+o]=g[l+o];if(0===e){p=!0;break}}if(g[s--]=v[r--],1==--i){p=!0;break}if(0!==(d=i-Cn(g[a],v,0,i,i-1,f))){for(i-=d,h=(s-=d)+1,l=(r-=d)+1,o=0;o<d;o++)g[h+o]=v[l+o];if(i<=1){p=!0;break}}if(g[s--]=g[a--],0==--e){p=!0;break}u--}while(Tn<=c||Tn<=d);if(p)break;u<0&&(u=0),u+=2}(m=u)<1&&(m=1);if(1===i){for(h=(s-=e)+1,l=(a-=e)+1,o=e-1;0<=o;o--)g[h+o]=g[l+o];g[s]=v[r]}else{if(0===i)throw new Error;for(l=s-(i-1),o=0;o<i;o++)g[l+o]=v[o]}})(e,n,i,o)}r=[],s=[],this.mergeRuns=function(){for(;1<l;){var t=l-2;if(1<=t&&s[t-1]<=s[t]+s[t+1]||2<=t&&s[t-2]<=s[t]+s[t-1])s[t-1]<s[t+1]&&t--;else if(s[t]>s[t+1])break;e(t)}},this.forceMergeRuns=function(){for(;1<l;){var t=l-2;0<t&&s[t-1]<s[t+1]&&t--,e(t)}},this.pushRun=function(t,e){r[l]=t,s[l]=e,l+=1}}function Pn(t,e,n,i){n=n||0;var o=(i=i||t.length)-n;if(!(o<2)){var a=0;if(o<In)Dn(t,n,i,n+(a=An(t,n,i,e)),e);else{var r,s=new kn(t,e),l=function(t){for(var e=0;In<=t;)e|=1&t,t>>=1;return t+e}(o);do{(a=An(t,n,i,e))<l&&(l<(r=o)&&(r=l),Dn(t,n,n+r,n+a,e),a=r),s.pushRun(n,a),s.mergeRuns(),o-=a,n+=a}while(0!==o);s.forceMergeRuns()}}}function Nn(t,e){return t.zlevel===e.zlevel?t.z===e.z?t.z2-e.z2:t.z-e.z:t.zlevel-e.zlevel}function On(){this._roots=[],this._displayList=[],this._displayListLen=0}On.prototype={constructor:On,traverse:function(t,e){for(var n=0;n<this._roots.length;n++)this._roots[n].traverse(t,e)},getDisplayList:function(t,e){return e=e||!1,t&&this.updateDisplayList(e),this._displayList},updateDisplayList:function(t){this._displayListLen=0;for(var e=this._roots,n=this._displayList,i=0,o=e.length;i<o;i++)this._updateAndAddDisplayable(e[i],null,t);n.length=this._displayListLen,v.canvasSupported&&Pn(n,Nn)},_updateAndAddDisplayable:function(t,e,n){if(!t.ignore||n){t.beforeUpdate(),t.__dirty&&t.update(),t.afterUpdate();var i=t.clipPath;if(i){e=e?e.slice():[];for(var o=i,a=t;o;)o.parent=a,o.updateTransform(),e.push(o),o=(a=o).clipPath}if(t.isGroup){for(var r=t._children,s=0;s<r.length;s++){var l=r[s];t.__dirty&&(l.__dirty=!0),this._updateAndAddDisplayable(l,e,n)}t.__dirty=!1}else t.__clipPaths=e,this._displayList[this._displayListLen++]=t}},addRoot:function(t){t.__storage!==this&&(t instanceof Mn&&t.addChildrenToStorage(this),this.addToStorage(t),this._roots.push(t))},delRoot:function(t){if(null==t){for(var e=0;e<this._roots.length;e++){var n=this._roots[e];n instanceof Mn&&n.delChildrenFromStorage(this)}return this._roots=[],this._displayList=[],void(this._displayListLen=0)}if(t instanceof Array)for(var e=0,i=t.length;e<i;e++)this.delRoot(t[e]);else{var o=M(this._roots,t);0<=o&&(this.delFromStorage(t),this._roots.splice(o,1),t instanceof Mn&&t.delChildrenFromStorage(this))}},addToStorage:function(t){return t&&(t.__storage=this,t.dirty(!1)),this},delFromStorage:function(t){return t&&(t.__storage=null),this},dispose:function(){this._renderList=this._roots=null},displayableSortFunc:Nn};var En={shadowBlur:1,shadowOffsetX:1,shadowOffsetY:1,textShadowBlur:1,textShadowOffsetX:1,textShadowOffsetY:1,textBoxShadowBlur:1,textBoxShadowOffsetX:1,textBoxShadowOffsetY:1},zn=function(t,e,n){return En.hasOwnProperty(e)?n*t.dpr:n},Rn={NONE:0,STYLE_BIND:1,PLAIN_TEXT:2},Bn=9,Vn=[["shadowBlur",0],["shadowOffsetX",0],["shadowOffsetY",0],["shadowColor","#000"],["lineCap","butt"],["lineJoin","miter"],["miterLimit",10]],Gn=function(t){this.extendFrom(t,!1)};function Fn(t,e,n){var i=null==e.x?0:e.x,o=null==e.x2?1:e.x2,a=null==e.y?0:e.y,r=null==e.y2?0:e.y2;return e.global||(i=i*n.width+n.x,o=o*n.width+n.x,a=a*n.height+n.y,r=r*n.height+n.y),i=isNaN(i)?0:i,o=isNaN(o)?1:o,a=isNaN(a)?0:a,r=isNaN(r)?0:r,t.createLinearGradient(i,a,o,r)}function Wn(t,e,n){var i=n.width,o=n.height,a=Math.min(i,o),r=null==e.x?.5:e.x,s=null==e.y?.5:e.y,l=null==e.r?.5:e.r;return e.global||(r=r*i+n.x,s=s*o+n.y,l*=a),t.createRadialGradient(r,s,0,r,s,l)}Gn.prototype={constructor:Gn,fill:"#000",stroke:null,opacity:1,fillOpacity:null,strokeOpacity:null,lineDash:null,lineDashOffset:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,lineWidth:1,strokeNoScale:!1,text:null,font:null,textFont:null,fontStyle:null,fontWeight:null,fontSize:null,fontFamily:null,textTag:null,textFill:"#000",textStroke:null,textWidth:null,textHeight:null,textStrokeWidth:0,textLineHeight:null,textPosition:"inside",textRect:null,textOffset:null,textAlign:null,textVerticalAlign:null,textDistance:5,textShadowColor:"transparent",textShadowBlur:0,textShadowOffsetX:0,textShadowOffsetY:0,textBoxShadowColor:"transparent",textBoxShadowBlur:0,textBoxShadowOffsetX:0,textBoxShadowOffsetY:0,transformText:!1,textRotation:0,textOrigin:null,textBackgroundColor:null,textBorderColor:null,textBorderWidth:0,textBorderRadius:0,textPadding:null,rich:null,truncate:null,blend:null,bind:function(t,e,n){var i=this,o=n&&n.style,a=!o||t.__attrCachedBy!==Rn.STYLE_BIND;t.__attrCachedBy=Rn.STYLE_BIND;for(var r,s=0;s<Vn.length;s++){var l=Vn[s],h=l[0];!a&&i[h]===o[h]||(t[h]=zn(t,h,i[h]||l[1]))}!a&&i.fill===o.fill||(t.fillStyle=i.fill),!a&&i.stroke===o.stroke||(t.strokeStyle=i.stroke),!a&&i.opacity===o.opacity||(t.globalAlpha=null==i.opacity?1:i.opacity),!a&&i.blend===o.blend||(t.globalCompositeOperation=i.blend||"source-over"),this.hasStroke()&&(r=i.lineWidth,t.lineWidth=r/(this.strokeNoScale&&e&&e.getLineScale?e.getLineScale():1))},hasFill:function(){var t=this.fill;return null!=t&&"none"!==t},hasStroke:function(){var t=this.stroke;return null!=t&&"none"!==t&&0<this.lineWidth},extendFrom:function(t,e){if(t)for(var n in t)!t.hasOwnProperty(n)||!0!==e&&(!1===e?this.hasOwnProperty(n):null==t[n])||(this[n]=t[n])},set:function(t,e){"string"==typeof t?this[t]=e:this.extendFrom(t,!0)},clone:function(){var t=new this.constructor;return t.extendFrom(this,!0),t},getGradient:function(t,e,n){for(var i=("radial"===e.type?Wn:Fn)(t,e,n),o=e.colorStops,a=0;a<o.length;a++)i.addColorStop(o[a].offset,o[a].color);return i}};for(var Hn=Gn.prototype,Zn=0;Zn<Vn.length;Zn++){var Un=Vn[Zn];Un[0]in Hn||(Hn[Un[0]]=Un[1])}Gn.getGradient=Hn.getGradient;function Xn(t,e){this.image=t,this.repeat=e,this.type="pattern"}function Yn(){return!1}function jn(t,e,n){var i=y(),o=e.getWidth(),a=e.getHeight(),r=i.style;return r&&(r.position="absolute",r.left=0,r.top=0,r.width=o+"px",r.height=a+"px",i.setAttribute("data-zr-dom-id",t)),i.width=o*n,i.height=a*n,i}function qn(t,e,n){var i;n=n||hn,"string"==typeof t?i=jn(t,e,n):V(t)&&(t=(i=t).id),this.id=t;var o=(this.dom=i).style;o&&(i.onselectstart=Yn,o["-webkit-user-select"]="none",o["user-select"]="none",o["-webkit-touch-callout"]="none",o["-webkit-tap-highlight-color"]="rgba(0,0,0,0)",o.padding=0,o.margin=0,o["border-width"]=0),this.domBack=null,this.ctxBack=null,this.painter=e,this.config=null,this.clearColor=0,this.motionBlur=!1,this.lastFrameAlpha=.7,this.dpr=n}qn.prototype={constructor:qn,__dirty:!0,__used:!(Xn.prototype.getCanvasPattern=function(t){return t.createPattern(this.image,this.repeat||"repeat")}),__drawIndex:0,__startIndex:0,__endIndex:0,incremental:!1,getElementCount:function(){return this.__endIndex-this.__startIndex},initContext:function(){this.ctx=this.dom.getContext("2d"),this.ctx.dpr=this.dpr},createBackBuffer:function(){var t=this.dpr;this.domBack=jn("back-"+this.id,this.painter,t),this.ctxBack=this.domBack.getContext("2d"),1!==t&&this.ctxBack.scale(t,t)},resize:function(t,e){var n=this.dpr,i=this.dom,o=i.style,a=this.domBack;o&&(o.width=t+"px",o.height=e+"px"),i.width=t*n,i.height=e*n,a&&(a.width=t*n,a.height=e*n,1!==n&&this.ctxBack.scale(n,n))},clear:function(t,e){var n,i,o=this.dom,a=this.ctx,r=o.width,s=o.height,e=e||this.clearColor,l=this.motionBlur&&!t,h=this.lastFrameAlpha,u=this.dpr;l&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(o,0,0,r/u,s/u)),a.clearRect(0,0,r,s),e&&"transparent"!==e&&(e.colorStops?(n=e.__canvasGradient||Gn.getGradient(a,e,{x:0,y:0,width:r,height:s}),e.__canvasGradient=n):e.image&&(n=Xn.prototype.getCanvasPattern.call(e,a)),a.save(),a.fillStyle=n||e,a.fillRect(0,0,r,s),a.restore()),l&&(i=this.domBack,a.save(),a.globalAlpha=h,a.drawImage(i,0,0,r,s),a.restore())}};var Kn="undefined"!=typeof window&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(t){setTimeout(t,16)},$n=new be(50);function Jn(t){if("string"!=typeof t)return t;var e=$n.get(t);return e&&e.image}function Qn(t,e,n,i,o){if(t){if("string"!=typeof t)return t;if(e&&e.__zrImageSrc===t||!n)return e;var a=$n.get(t),r={hostEl:n,cb:i,cbPayload:o};return a?ei(e=a.image)||a.pending.push(r):((e=new Image).onload=e.onerror=ti,$n.put(t,e.__cachedImgObj={image:e,pending:[r]}),e.src=e.__zrImageSrc=t),e}return e}function ti(){var t=this.__cachedImgObj;this.onload=this.onerror=this.__cachedImgObj=null;for(var e=0;e<t.pending.length;e++){var n=t.pending[e],i=n.cb;i&&i(this,n.cbPayload),n.hostEl.dirty()}t.pending.length=0}function ei(t){return t&&t.width&&t.height}var ni={},ii=0,oi=5e3,ai=/\{([a-zA-Z0-9_]+)\|([^}]*)\}/g,ri="12px sans-serif",si={};function li(t,e){var n=t+":"+(e=e||ri);if(ni[n])return ni[n];for(var i,o,a=(t+"").split("\n"),r=0,s=0,l=a.length;s<l;s++)r=Math.max((i=a[s],o=e,si.measureText(i,o)).width,r);return oi<ii&&(ii=0,ni={}),ii++,ni[n]=r}function hi(t,e,n,i,o,a,r,s){return r?(h=i,u=xi(t,{rich:r,truncate:s,font:e,textAlign:l=n,textPadding:o,textLineHeight:a}),c=u.outerWidth,d=u.outerHeight,p=ui(0,c,l),g=ci(0,d,h),new Sn(p,g,c,d)):function(t,e,n,i,o,a,r){var s=yi(t,e,o,a,r),l=li(t,e);o&&(l+=o[1]+o[3]);var h=s.outerHeight,u=ui(0,l,n),c=ci(0,h,i),d=new Sn(u,c,l,h);return d.lineHeight=s.lineHeight,d}(t,e,n,i,o,a,s);var l,h,u,c,d,p,g}function ui(t,e,n){return"right"===n?t-=e:"center"===n&&(t-=e/2),t}function ci(t,e,n){return"middle"===n?t-=e/2:"bottom"===n&&(t-=e),t}function di(t,e,n){var i=e.textPosition,o=e.textDistance,a=n.x,r=n.y,o=o||0,s=n.height,l=n.width,h=s/2,u="left",c="top";switch(i){case"left":a-=o,r+=h,u="right",c="middle";break;case"right":a+=o+l,r+=h,c="middle";break;case"top":a+=l/2,r-=o,u="center",c="bottom";break;case"bottom":a+=l/2,r+=s+o,u="center";break;case"inside":a+=l/2,r+=h,u="center",c="middle";break;case"insideLeft":a+=o,r+=h,c="middle";break;case"insideRight":a+=l-o,r+=h,u="right",c="middle";break;case"insideTop":a+=l/2,r+=o,u="center";break;case"insideBottom":a+=l/2,r+=s-o,u="center",c="bottom";break;case"insideTopLeft":a+=o,r+=o;break;case"insideTopRight":a+=l-o,r+=o,u="right";break;case"insideBottomLeft":a+=o,r+=s-o,c="bottom";break;case"insideBottomRight":a+=l-o,r+=s-o,u="right",c="bottom"}return(t=t||{}).x=a,t.y=r,t.textAlign=u,t.textVerticalAlign=c,t}function pi(t,e,n,i,o){if(!e)return"";var a=(t+"").split("\n");o=gi(e,n,i,o);for(var r=0,s=a.length;r<s;r++)a[r]=fi(a[r],o);return a.join("\n")}function gi(t,e,n,i){(i=k({},i)).font=e;n=U(n,"...");i.maxIterations=U(i.maxIterations,2);var o=i.minChar=U(i.minChar,0);i.cnCharWidth=li("国",e);var a=i.ascCharWidth=li("a",e);i.placeholder=U(i.placeholder,"");for(var r=t=Math.max(0,t-1),s=0;s<o&&a<=r;s++)r-=a;var l=li(n,e);return r<l&&(n="",l=0),r=t-l,i.ellipsis=n,i.ellipsisWidth=l,i.contentWidth=r,i.containerWidth=t,i}function fi(t,e){var n=e.containerWidth,i=e.font,o=e.contentWidth;if(!n)return"";if((s=li(t,i))<=n)return t;for(var a=0;;a++){if(s<=o||a>=e.maxIterations){t+=e.ellipsis;break}var r=0===a?mi(t,o,e.ascCharWidth,e.cnCharWidth):0<s?Math.floor(t.length*o/s):0,s=li(t=t.substr(0,r),i)}return""===t&&(t=e.placeholder),t}function mi(t,e,n,i){for(var o=0,a=0,r=t.length;a<r&&o<e;a++){var s=t.charCodeAt(a);o+=0<=s&&s<=127?n:i}return a}function vi(t){return li("国",t)}function yi(t,e,n,i,o){null!=t&&(t+="");var a=U(i,vi(e)),r=t?t.split("\n"):[],s=r.length*a,l=s,h=!0;if(n&&(l+=n[0]+n[2]),t&&o){h=!1;var u=o.outerHeight,c=o.outerWidth;if(null!=u&&u<l)t="",r=[];else if(null!=c)for(var d=gi(c-(n?n[1]+n[3]:0),e,o.ellipsis,{minChar:o.minChar,placeholder:o.placeholder}),p=0,g=r.length;p<g;p++)r[p]=fi(r[p],d)}return{lines:r,height:s,outerHeight:l,lineHeight:a,canCacheByTextString:h}}function xi(t,e){var n={lines:[],width:0,height:0};if(null!=t&&(t+=""),!t)return n;for(var i,o=ai.lastIndex=0;null!=(i=ai.exec(t));){var a=i.index;o<a&&_i(n,t.substring(o,a)),_i(n,i[2],i[1]),o=ai.lastIndex}o<t.length&&_i(n,t.substring(o,t.length));var r=n.lines,s=0,l=0,h=[],u=e.textPadding,c=e.truncate,d=c&&c.outerWidth,p=c&&c.outerHeight;u&&(null!=d&&(d-=u[1]+u[3]),null!=p&&(p-=u[0]+u[2]));for(var g=0;g<r.length;g++){for(var f=r[g],m=0,v=0,y=0;y<f.tokens.length;y++){var x=(C=f.tokens[y]).styleName&&e.rich[C.styleName]||{},_=C.textPadding=x.textPadding,w=C.font=x.font||e.font,b=C.textHeight=U(x.textHeight,vi(w));if(_&&(b+=_[0]+_[2]),C.height=b,C.lineHeight=X(x.textLineHeight,e.textLineHeight,b),C.textAlign=x&&x.textAlign||e.textAlign,C.textVerticalAlign=x&&x.textVerticalAlign||"middle",null!=p&&s+C.lineHeight>p)return{lines:[],width:0,height:0};C.textWidth=li(C.text,w);var S,M,I,T,A=x.textWidth,D=null==A||"auto"===A;"string"==typeof A&&"%"===A.charAt(A.length-1)?(C.percentWidth=A,h.push(C),A=0):(D&&(A=C.textWidth,(M=(S=x.textBackgroundColor)&&S.image)&&ei(M=Jn(M))&&(A=Math.max(A,M.width*b/M.height))),A+=I=_?_[1]+_[3]:0,null!=(T=null!=d?d-v:null)&&T<A&&(!D||T<I?(C.text="",C.textWidth=A=0):(C.text=pi(C.text,T-I,w,c.ellipsis,{minChar:c.minChar}),C.textWidth=li(C.text,w),A=C.textWidth+I))),v+=C.width=A,x&&(m=Math.max(m,C.lineHeight))}f.width=v,s+=f.lineHeight=m,l=Math.max(l,v)}n.outerWidth=n.width=U(e.textWidth,l),n.outerHeight=n.height=U(e.textHeight,s),u&&(n.outerWidth+=u[1]+u[3],n.outerHeight+=u[0]+u[2]);for(g=0;g<h.length;g++){var C,L=(C=h[g]).percentWidth;C.width=parseInt(L,10)/100*l}return n}function _i(t,e,n){for(var i=""===e,o=e.split("\n"),a=t.lines,r=0;r<o.length;r++){var s,l,h=o[r],u={styleName:n,text:h,isLineHolder:!h&&!i};r?a.push({tokens:[u]}):1===(l=(s=(a[a.length-1]||(a[0]={tokens:[]})).tokens).length)&&s[0].isLineHolder?s[0]=u:!h&&l&&!i||s.push(u)}}function wi(t){var e=(t.fontSize||t.fontFamily)&&[t.fontStyle,t.fontWeight,(t.fontSize||12)+"px",t.fontFamily||"sans-serif"].join(" ");return e&&K(e)||t.textFont||t.font}function bi(t,e){var n,i,o,a,r,s=e.x,l=e.y,h=e.width,u=e.height,c=e.r;h<0&&(s+=h,h=-h),u<0&&(l+=u,u=-u),"number"==typeof c?n=i=o=a=c:c instanceof Array?1===c.length?n=i=o=a=c[0]:2===c.length?(n=o=c[0],i=a=c[1]):3===c.length?(n=c[0],i=a=c[1],o=c[2]):(n=c[0],i=c[1],o=c[2],a=c[3]):n=i=o=a=0,h<n+i&&(n*=h/(r=n+i),i*=h/r),h<o+a&&(o*=h/(r=o+a),a*=h/r),u<i+o&&(i*=u/(r=i+o),o*=u/r),u<n+a&&(n*=u/(r=n+a),a*=u/r),t.moveTo(s+n,l),t.lineTo(s+h-i,l),0!==i&&t.arc(s+h-i,l+i,i,-Math.PI/2,0),t.lineTo(s+h,l+u-o),0!==o&&t.arc(s+h-o,l+u-o,o,0,Math.PI/2),t.lineTo(s+a,l+u),0!==a&&t.arc(s+a,l+u-a,a,Math.PI/2,Math.PI),t.lineTo(s,l+n),0!==n&&t.arc(s+n,l+n,n,Math.PI,1.5*Math.PI)}si.measureText=function(t,e){var n=_();return n.font=e||ri,n.measureText(t)};var Si=ri,Mi={left:1,right:1,center:1},Ii={top:1,bottom:1,middle:1},Ti=[["textShadowBlur","shadowBlur",0],["textShadowOffsetX","shadowOffsetX",0],["textShadowOffsetY","shadowOffsetY",0],["textShadowColor","shadowColor","transparent"]],Ai={},Di={};function Ci(t){return Li(t),P(t.rich,Li),t}function Li(t){var e,n;t&&(t.font=wi(t),"middle"===(e=t.textAlign)&&(e="center"),t.textAlign=null==e||Mi[e]?e:"left","center"===(n=t.textVerticalAlign||t.textBaseline)&&(n="middle"),t.textVerticalAlign=null==n||Ii[n]?n:"top",t.textPadding&&(t.textPadding=j(t.textPadding)))}function ki(t,e,n,i,o,a){(i.rich?function(t,e,n,i,o,a){a!==Bn&&(e.__attrCachedBy=Rn.NONE);var r=t.__textCotentBlock;r&&!t.__dirtyText||(r=t.__textCotentBlock=xi(n,i));!function(t,e,n,i,o){var a=n.width,r=n.outerWidth,s=n.outerHeight,l=i.textPadding,h=Ri(Di,t,i,o),u=h.baseX,c=h.baseY,d=h.textAlign,p=h.textVerticalAlign;Pi(e,i,o,u,c);var g=ui(u,r,d),f=ci(c,s,p),m=g,v=f;l&&(m+=l[3],v+=l[0]);var y=m+a;Oi(i)&&Ei(t,e,i,g,f,r,s);for(var x,_=0;_<n.lines.length;_++){for(var w=n.lines[_],b=w.tokens,S=b.length,M=w.lineHeight,I=w.width,T=0,A=m,D=y,C=S-1;T<S&&(!(x=b[T]).textAlign||"left"===x.textAlign);)Ni(t,e,x,i,M,v,A,"left"),I-=x.width,A+=x.width,T++;for(;0<=C&&"right"===(x=b[C]).textAlign;)Ni(t,e,x,i,M,v,D,"right"),I-=x.width,D-=x.width,C--;for(A+=(a-(A-m)-(y-D)-I)/2;T<=C;)x=b[T],Ni(t,e,x,i,M,v,A+x.width/2,"center"),A+=x.width,T++;v+=M}}(t,e,r,i,o)}:function(t,e,n,i,o,a){var r,s=Oi(i),l=!1,h=e.__attrCachedBy===Rn.PLAIN_TEXT;a!==Bn?(a&&(r=a.style,l=!s&&h&&r),e.__attrCachedBy=s?Rn.NONE:Rn.PLAIN_TEXT):h&&(e.__attrCachedBy=Rn.NONE);var u=i.font||Si;l&&u===(r.font||Si)||(e.font=u);var c=t.__computedFont;t.__styleFont!==u&&(t.__styleFont=u,c=t.__computedFont=e.font);var d=i.textPadding,p=i.textLineHeight,g=t.__textCotentBlock;g&&!t.__dirtyText||(g=t.__textCotentBlock=yi(n,c,d,p,i.truncate));var f=g.outerHeight,m=g.lines,v=g.lineHeight,y=Ri(Di,t,i,o),x=y.baseX,_=y.baseY,w=y.textAlign||"left",b=y.textVerticalAlign;Pi(e,i,o,x,_);var S=ci(_,f,b),M=x,I=S;{var T,A;(s||d)&&(T=li(n,c),d&&(T+=d[1]+d[3]),A=ui(x,T,w),s&&Ei(t,e,i,A,S,T,f),d&&(M=Wi(x,w,d),I+=d[0]))}e.textAlign=w,e.textBaseline="middle",e.globalAlpha=i.opacity||1;for(var D=0;D<Ti.length;D++){var C=Ti[D],L=C[0],k=C[1],P=i[L];l&&P===r[L]||(e[k]=zn(e,k,P||C[2]))}I+=v/2;var N=i.textStrokeWidth,O=l?r.textStrokeWidth:null,E=!l||N!==O,z=!l||E||i.textStroke!==r.textStroke,R=Vi(i.textStroke,N),B=Gi(i.textFill);R&&(E&&(e.lineWidth=N),z&&(e.strokeStyle=R));B&&(l&&i.textFill===r.textFill||(e.fillStyle=B));if(1===m.length)R&&e.strokeText(m[0],M,I),B&&e.fillText(m[0],M,I);else for(D=0;D<m.length;D++)R&&e.strokeText(m[D],M,I),B&&e.fillText(m[D],M,I),I+=v})(t,e,n,i,o,a)}function Pi(t,e,n,i,o){var a;n&&e.textRotation&&("center"===(a=e.textOrigin)?(i=n.width/2+n.x,o=n.height/2+n.y):a&&(i=a[0]+n.x,o=a[1]+n.y),t.translate(i,o),t.rotate(-e.textRotation),t.translate(-i,-o))}function Ni(t,e,n,i,o,a,r,s){var l=i.rich[n.styleName]||{};l.text=n.text;var h=n.textVerticalAlign,u=a+o/2;"top"===h?u=a+n.height/2:"bottom"===h&&(u=a+o-n.height/2),!n.isLineHolder&&Oi(l)&&Ei(t,e,l,"right"===s?r-n.width:"center"===s?r-n.width/2:r,u-n.height/2,n.width,n.height);var c=n.textPadding;c&&(r=Wi(r,s,c),u-=n.height/2-c[2]-n.textHeight/2),Bi(e,"shadowBlur",X(l.textShadowBlur,i.textShadowBlur,0)),Bi(e,"shadowColor",l.textShadowColor||i.textShadowColor||"transparent"),Bi(e,"shadowOffsetX",X(l.textShadowOffsetX,i.textShadowOffsetX,0)),Bi(e,"shadowOffsetY",X(l.textShadowOffsetY,i.textShadowOffsetY,0)),Bi(e,"textAlign",s),Bi(e,"textBaseline","middle"),Bi(e,"font",n.font||Si);var d=Vi(l.textStroke||i.textStroke,g),p=Gi(l.textFill||i.textFill),g=U(l.textStrokeWidth,i.textStrokeWidth);d&&(Bi(e,"lineWidth",g),Bi(e,"strokeStyle",d),e.strokeText(n.text,r,u)),p&&(Bi(e,"fillStyle",p),e.fillText(n.text,r,u))}function Oi(t){return!!(t.textBackgroundColor||t.textBorderWidth&&t.textBorderColor)}function Ei(t,e,n,i,o,a,r){var s,l,h,u=n.textBackgroundColor,c=n.textBorderWidth,d=n.textBorderColor,p=B(u);Bi(e,"shadowBlur",n.textBoxShadowBlur||0),Bi(e,"shadowColor",n.textBoxShadowColor||"transparent"),Bi(e,"shadowOffsetX",n.textBoxShadowOffsetX||0),Bi(e,"shadowOffsetY",n.textBoxShadowOffsetY||0),(p||c&&d)&&(e.beginPath(),(s=n.textBorderRadius)?bi(e,{x:i,y:o,width:a,height:r,r:s}):e.rect(i,o,a,r),e.closePath()),p?(Bi(e,"fillStyle",u),null!=n.fillOpacity?(h=e.globalAlpha,e.globalAlpha=n.fillOpacity*n.opacity,e.fill(),e.globalAlpha=h):e.fill()):!V(u)||(l=Qn(l=u.image,null,t,zi,u))&&ei(l)&&e.drawImage(l,i,o,a,r),c&&d&&(Bi(e,"lineWidth",c),Bi(e,"strokeStyle",d),null!=n.strokeOpacity?(h=e.globalAlpha,e.globalAlpha=n.strokeOpacity*n.opacity,e.stroke(),e.globalAlpha=h):e.stroke())}function zi(t,e){e.image=t}function Ri(t,e,n,i){var o,a,r,s=n.x||0,l=n.y||0,h=n.textAlign,u=n.textVerticalAlign;return i&&((o=n.textPosition)instanceof Array?(s=i.x+Fi(o[0],i.width),l=i.y+Fi(o[1],i.height)):(s=(a=e&&e.calculateTextPosition?e.calculateTextPosition(Ai,n,i):di(Ai,n,i)).x,l=a.y,h=h||a.textAlign,u=u||a.textVerticalAlign),(r=n.textOffset)&&(s+=r[0],l+=r[1])),(t=t||{}).baseX=s,t.baseY=l,t.textAlign=h,t.textVerticalAlign=u,t}function Bi(t,e,n){return t[e]=zn(t,e,n),t[e]}function Vi(t,e){return null==t||e<=0||"transparent"===t||"none"===t?null:t.image||t.colorStops?"#000":t}function Gi(t){return null==t||"none"===t?null:t.image||t.colorStops?"#000":t}function Fi(t,e){return"string"==typeof t?0<=t.lastIndexOf("%")?parseFloat(t)/100*e:parseFloat(t):t}function Wi(t,e,n){return"right"===e?t-n[1]:"center"===e?t+n[3]/2-n[1]/2:t+n[3]}function Hi(t,e){return null!=t&&(t||e.textBackgroundColor||e.textBorderWidth&&e.textBorderColor||e.textPadding)}function Zi(){}var Ui=new Sn;function Xi(t){for(var e in t=t||{},fn.call(this,t),t)t.hasOwnProperty(e)&&"style"!==e&&(this[e]=t[e]);this.style=new Gn(t.style,this),this._rect=null,this.__clipPaths=null}function Yi(t){Xi.call(this,t)}Xi.prototype={constructor:Xi,type:"displayable",__dirty:!0,invisible:!(Zi.prototype={constructor:Zi,drawRectText:function(t,e){var n=this.style;e=n.textRect||e,this.__dirty&&Ci(n);var i,o=n.text;null!=o&&(o+=""),Hi(o,n)&&(t.save(),i=this.transform,n.transformText?this.setTransform(t):i&&(Ui.copy(e),Ui.applyTransform(i),e=Ui),ki(this,t,o,n,e,Bn),t.restore())}}),z:0,z2:0,zlevel:0,draggable:!1,dragging:!1,silent:!1,culling:!1,cursor:"pointer",rectHover:!1,progressive:!1,incremental:!1,globalScaleRatio:1,beforeBrush:function(t){},afterBrush:function(t){},brush:function(t,e){},getBoundingRect:function(){},contain:function(t,e){return this.rectContain(t,e)},traverse:function(t,e){t.call(e,this)},rectContain:function(t,e){var n=this.transformCoordToLocal(t,e);return this.getBoundingRect().contain(n[0],n[1])},dirty:function(){this.__dirty=this.__dirtyText=!0,this._rect=null,this.__zr&&this.__zr.refresh()},animateStyle:function(t){return this.animate("style",t)},attrKV:function(t,e){"style"!==t?fn.prototype.attrKV.call(this,t,e):this.style.set(e)},setStyle:function(t,e){return this.style.set(t,e),this.dirty(!1),this},useStyle:function(t){return this.style=new Gn(t,this),this.dirty(!1),this},calculateTextPosition:null},w(Xi,fn),b(Xi,Zi),Yi.prototype={constructor:Yi,type:"image",brush:function(t,e){var n=this.style,i=n.image;n.bind(t,this,e);var o,a,r,s,l,h,u,c,d,p=this._image=Qn(i,this._image,this,this.onload);p&&ei(p)&&(o=n.x||0,a=n.y||0,r=n.width,s=n.height,l=p.width/p.height,null==r&&null!=s?r=s*l:null==s&&null!=r?s=r/l:null==r&&null==s&&(r=p.width,s=p.height),this.setTransform(t),n.sWidth&&n.sHeight?(h=n.sx||0,u=n.sy||0,t.drawImage(p,h,u,n.sWidth,n.sHeight,o,a,r,s)):n.sx&&n.sy?(c=r-(h=n.sx),d=s-(u=n.sy),t.drawImage(p,h,u,c,d,o,a,r,s)):t.drawImage(p,o,a,r,s),null!=n.text&&(this.restoreTransform(t),this.drawRectText(t,this.getBoundingRect())))},getBoundingRect:function(){var t=this.style;return this._rect||(this._rect=new Sn(t.x||0,t.y||0,t.width||0,t.height||0)),this._rect}},w(Yi,Xi);var ji=314159;function qi(t){return parseInt(t,10)}var Ki=new Sn(0,0,0,0),$i=new Sn(0,0,0,0);function Ji(t,e,n){this.type="canvas";var i=!t.nodeName||"CANVAS"===t.nodeName.toUpperCase();this._opts=n=k({},n||{}),this.dpr=n.devicePixelRatio||hn,this._singleCanvas=i;var o=(this.root=t).style;o&&(o["-webkit-tap-highlight-color"]="transparent",o["-webkit-user-select"]=o["user-select"]=o["-webkit-touch-callout"]="none",t.innerHTML=""),this.storage=e;var a,r,s,l,h,u,c,d=this._zlevelList=[],p=this._layers={};this._layerConfig={},this._needsManuallyCompositing=!1,i?(a=t.width,r=t.height,null!=n.width&&(a=n.width),null!=n.height&&(r=n.height),this.dpr=n.devicePixelRatio||1,t.width=a*this.dpr,t.height=r*this.dpr,this._width=a,this._height=r,(s=new qn(t,this,this.dpr)).__builtin__=!0,s.initContext(),(p[ji]=s).zlevel=ji,d.push(ji),this._domRoot=t):(this._width=this._getSize(0),this._height=this._getSize(1),l=this._domRoot=(h=this._width,u=this._height,(c=document.createElement("div")).style.cssText=["position:relative","width:"+h+"px","height:"+u+"px","padding:0","margin:0","border-width:0"].join(";")+";",c),t.appendChild(l)),this._hoverlayer=null,this._hoverElements=[]}Ji.prototype={constructor:Ji,getType:function(){return"canvas"},isSingleCanvas:function(){return this._singleCanvas},getViewportRoot:function(){return this._domRoot},getViewportRootOffset:function(){var t=this.getViewportRoot();if(t)return{offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0}},refresh:function(t){var e=this.storage.getDisplayList(!0),n=this._zlevelList;this._redrawId=Math.random(),this._paintList(e,t,this._redrawId);for(var i=0;i<n.length;i++){var o,a=n[i],r=this._layers[a];!r.__builtin__&&r.refresh&&(o=0===i?this._backgroundColor:null,r.refresh(o))}return this.refreshHover(),this},addHover:function(t,e){if(!t.__hoverMir){var n=new t.constructor({style:t.style,shape:t.shape,z:t.z,z2:t.z2,silent:t.silent});return(n.__from=t).__hoverMir=n,e&&n.setStyle(e),this._hoverElements.push(n),n}},removeHover:function(t){var e=t.__hoverMir,n=this._hoverElements,i=M(n,e);0<=i&&n.splice(i,1),t.__hoverMir=null},clearHover:function(t){for(var e=this._hoverElements,n=0;n<e.length;n++){var i=e[n].__from;i&&(i.__hoverMir=null)}e.length=0},refreshHover:function(){var t=this._hoverElements,e=t.length,n=this._hoverlayer;if(n&&n.clear(),e){Pn(t,this.storage.displayableSortFunc);var i={};(n=n||(this._hoverlayer=this.getLayer(1e5))).ctx.save();for(var o=0;o<e;){var a=t[o],r=a.__from;r&&r.__zr?(o++,r.invisible||(a.transform=r.transform,a.invTransform=r.invTransform,a.__clipPaths=r.__clipPaths,this._doPaintEl(a,n,!0,i))):(t.splice(o,1),r.__hoverMir=null,e--)}n.ctx.restore()}},getHoverLayer:function(){return this.getLayer(1e5)},_paintList:function(t,e,n){var i,o;this._redrawId===n&&(e=e||!1,this._updateLayerStatus(t),i=this._doPaintList(t,e),this._needsManuallyCompositing&&this._compositeManually(),i||(o=this,Kn(function(){o._paintList(t,e,n)})))},_compositeManually:function(){var e=this.getLayer(ji).ctx,n=this._domRoot.width,i=this._domRoot.height;e.clearRect(0,0,n,i),this.eachBuiltinLayer(function(t){t.virtual&&e.drawImage(t.dom,0,0,n,i)})},_doPaintList:function(t,e){for(var n=[],i=0;i<this._zlevelList.length;i++){var o=this._zlevelList[i];(s=this._layers[o]).__builtin__&&s!==this._hoverlayer&&(s.__dirty||e)&&n.push(s)}for(var a=!0,r=0;r<n.length;r++){var s,l=(s=n[r]).ctx,h={};l.save();var u,c=e?s.__startIndex:s.__drawIndex,d=!e&&s.incremental&&Date.now,p=d&&Date.now(),g=s.zlevel===this._zlevelList[0]?this._backgroundColor:null;s.__startIndex===s.__endIndex?s.clear(!1,g):c===s.__startIndex&&((u=t[c]).incremental&&u.notClear&&!e||s.clear(!1,g)),-1===c&&(console.error("For some unknown reason. drawIndex is -1"),c=s.__startIndex);for(var f=c;f<s.__endIndex;f++){var m=t[f];if(this._doPaintEl(m,s,e,h),m.__dirty=m.__dirtyText=!1,d)if(15<Date.now()-p)break}s.__drawIndex=f,s.__drawIndex<s.__endIndex&&(a=!1),h.prevElClipPaths&&l.restore(),l.restore()}return v.wxa&&P(this._layers,function(t){t&&t.ctx&&t.ctx.draw&&t.ctx.draw()}),a},_doPaintEl:function(t,e,n,i){var o,a,r,s,l,h=e.ctx,u=t.transform;!e.__dirty&&!n||t.invisible||0===t.style.opacity||u&&!u[0]&&!u[3]||t.culling&&(r=t,s=this._width,l=this._height,Ki.copy(r.getBoundingRect()),r.transform&&Ki.applyTransform(r.transform),$i.width=s,$i.height=l,!Ki.intersect($i))||(o=t.__clipPaths,(a=i.prevElClipPaths)&&!function(t,e){if(t!==e){if(!t||!e||t.length!==e.length)return 1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return 1}}(o,a)||(a&&(h.restore(),i.prevElClipPaths=null,i.prevEl=null),o&&(h.save(),function(t,e){for(var n=0;n<t.length;n++){var i=t[n];i.setTransform(e),e.beginPath(),i.buildPath(e,i.shape),e.clip(),i.restoreTransform(e)}}(o,h),i.prevElClipPaths=o)),t.beforeBrush&&t.beforeBrush(h),t.brush(h,i.prevEl||null),(i.prevEl=t).afterBrush&&t.afterBrush(h))},getLayer:function(t,e){this._singleCanvas&&!this._needsManuallyCompositing&&(t=ji);var n=this._layers[t];return n||((n=new qn("zr_"+t,this,this.dpr)).zlevel=t,n.__builtin__=!0,this._layerConfig[t]&&m(n,this._layerConfig[t],!0),e&&(n.virtual=e),this.insertLayer(t,n),n.initContext()),n},insertLayer:function(t,e){var n,i=this._layers,o=this._zlevelList,a=o.length,r=null,s=-1,l=this._domRoot;if(i[t])dn("ZLevel "+t+" has been used already");else if(function(t){if(t){if(t.__builtin__)return 1;if("function"==typeof t.resize&&"function"==typeof t.refresh)return 1}}(e)){if(0<a&&t>o[0]){for(s=0;s<a-1&&!(o[s]<t&&o[s+1]>t);s++);r=i[o[s]]}o.splice(s+1,0,t),(i[t]=e).virtual||(r?(n=r.dom).nextSibling?l.insertBefore(e.dom,n.nextSibling):l.appendChild(e.dom):l.firstChild?l.insertBefore(e.dom,l.firstChild):l.appendChild(e.dom))}else dn("Layer of zlevel "+t+" is not valid")},eachLayer:function(t,e){for(var n,i=this._zlevelList,o=0;o<i.length;o++)n=i[o],t.call(e,this._layers[n],n)},eachBuiltinLayer:function(t,e){for(var n,i,o=this._zlevelList,a=0;a<o.length;a++)i=o[a],(n=this._layers[i]).__builtin__&&t.call(e,n,i)},eachOtherLayer:function(t,e){for(var n,i,o=this._zlevelList,a=0;a<o.length;a++)i=o[a],(n=this._layers[i]).__builtin__||t.call(e,n,i)},getLayers:function(){return this._layers},_updateLayerStatus:function(t){function e(t){i&&(i.__endIndex!==t&&(i.__dirty=!0),i.__endIndex=t)}if(this.eachBuiltinLayer(function(t,e){t.__dirty=t.__used=!1}),this._singleCanvas)for(var n=1;n<t.length;n++){if((a=t[n]).zlevel!==t[n-1].zlevel||a.incremental){this._needsManuallyCompositing=!0;break}}for(var i=null,o=0,n=0;n<t.length;n++){var a,r,s=(a=t[n]).zlevel;a.incremental?((r=this.getLayer(s+.001,this._needsManuallyCompositing)).incremental=!0,o=1):r=this.getLayer(s+(0<o?.01:0),this._needsManuallyCompositing),r.__builtin__||dn("ZLevel "+s+" has been used by unkown layer "+r.id),r!==i&&(r.__used=!0,r.__startIndex!==n&&(r.__dirty=!0),r.__startIndex=n,r.incremental?r.__drawIndex=-1:r.__drawIndex=n,e(n),i=r),a.__dirty&&(r.__dirty=!0,r.incremental&&r.__drawIndex<0&&(r.__drawIndex=n))}e(n),this.eachBuiltinLayer(function(t,e){!t.__used&&0<t.getElementCount()&&(t.__dirty=!0,t.__startIndex=t.__endIndex=t.__drawIndex=0),t.__dirty&&t.__drawIndex<0&&(t.__drawIndex=t.__startIndex)})},clear:function(){return this.eachBuiltinLayer(this._clearLayer),this},_clearLayer:function(t){t.clear()},setBackgroundColor:function(t){this._backgroundColor=t},configLayer:function(t,e){if(e){var n=this._layerConfig;n[t]?m(n[t],e,!0):n[t]=e;for(var i=0;i<this._zlevelList.length;i++){var o=this._zlevelList[i];o!==t&&o!==t+.01||m(this._layers[o],n[t],!0)}}},delLayer:function(t){var e=this._layers,n=this._zlevelList,i=e[t];i&&(i.dom.parentNode.removeChild(i.dom),delete e[t],n.splice(M(n,t),1))},resize:function(e,n){if(this._domRoot.style){var t=this._domRoot;t.style.display="none";var i=this._opts;if(null!=e&&(i.width=e),null!=n&&(i.height=n),e=this._getSize(0),n=this._getSize(1),t.style.display="",this._width!==e||n!==this._height){for(var o in t.style.width=e+"px",t.style.height=n+"px",this._layers)this._layers.hasOwnProperty(o)&&this._layers[o].resize(e,n);P(this._progressiveLayers,function(t){t.resize(e,n)}),this.refresh(!0)}this._width=e,this._height=n}else{if(null==e||null==n)return;this._width=e,this._height=n,this.getLayer(ji).resize(e,n)}return this},clearLayer:function(t){var e=this._layers[t];e&&e.clear()},dispose:function(){this.root.innerHTML="",this.root=this.storage=this._domRoot=this._layers=null},getRenderedCanvas:function(t){if(t=t||{},this._singleCanvas&&!this._compositeManually)return this._layers[ji].dom;var e=new qn("image",this,t.pixelRatio||this.dpr);if(e.initContext(),e.clear(!1,t.backgroundColor||this._backgroundColor),t.pixelRatio<=this.dpr){this.refresh();var n=e.dom.width,i=e.dom.height,o=e.ctx;this.eachLayer(function(t){t.__builtin__?o.drawImage(t.dom,0,0,n,i):t.renderToCanvas&&(e.ctx.save(),t.renderToCanvas(e.ctx),e.ctx.restore())})}else for(var a={},r=this.storage.getDisplayList(!0),s=0;s<r.length;s++){var l=r[s];this._doPaintEl(l,e,!0,a)}return e.dom},getWidth:function(){return this._width},getHeight:function(){return this._height},_getSize:function(t){var e=this._opts,n=["width","height"][t],i=["clientWidth","clientHeight"][t],o=["paddingLeft","paddingTop"][t],a=["paddingRight","paddingBottom"][t];if(null!=e[n]&&"auto"!==e[n])return parseFloat(e[n]);var r=this.root,s=document.defaultView.getComputedStyle(r);return(r[i]||qi(s[n])||qi(r.style[n]))-(qi(s[o])||0)-(qi(s[a])||0)|0},pathToImage:function(t,e){e=e||this.dpr;var n=document.createElement("canvas"),i=n.getContext("2d"),o=t.getBoundingRect(),a=t.style,r=a.shadowBlur*e,s=a.shadowOffsetX*e,l=a.shadowOffsetY*e,h=a.hasStroke()?a.lineWidth:0,u=Math.max(h/2,r-s),c=Math.max(h/2,s+r),d=Math.max(h/2,r-l),p=Math.max(h/2,l+r),g=o.width+u+c,f=o.height+d+p;n.width=g*e,n.height=f*e,i.scale(e,e),i.clearRect(0,0,g,f),i.dpr=e;var m={position:t.position,rotation:t.rotation,scale:t.scale};t.position=[u-o.x,d-o.y],t.rotation=0,t.scale=[1,1],t.updateTransform(),t&&t.brush(i);var v=new Yi({style:{x:0,y:0,image:n}});return null!=m.position&&(v.position=t.position=m.position),null!=m.rotation&&(v.rotation=t.rotation=m.rotation),null!=m.scale&&(v.scale=t.scale=m.scale),v}};function Qi(t){t=t||{},this.stage=t.stage||{},this.onframe=t.onframe||function(){},this._clips=[],this._running=!1,this._time,this._pausedTime,this._pauseStart,this._paused=!1,Ct.call(this)}Qi.prototype={constructor:Qi,addClip:function(t){this._clips.push(t)},addAnimator:function(t){t.animation=this;for(var e=t.getClips(),n=0;n<e.length;n++)this.addClip(e[n])},removeClip:function(t){var e=M(this._clips,t);0<=e&&this._clips.splice(e,1)},removeAnimator:function(t){for(var e=t.getClips(),n=0;n<e.length;n++)this.removeClip(e[n]);t.animation=null},_update:function(){for(var t=(new Date).getTime()-this._pausedTime,e=t-this._time,n=this._clips,i=n.length,o=[],a=[],r=0;r<i;r++){var s=n[r],l=s.step(t,e);l&&(o.push(l),a.push(s))}for(r=0;r<i;)n[r]._needsRemove?(n[r]=n[i-1],n.pop(),i--):r++;i=o.length;for(r=0;r<i;r++)a[r].fire(o[r]);this._time=t,this.onframe(e),this.trigger("frame",e),this.stage.update&&this.stage.update()},_startLoop:function(){var e=this;this._running=!0,Kn(function t(){e._running&&(Kn(t),e._paused||e._update())})},start:function(){this._time=(new Date).getTime(),this._pausedTime=0,this._startLoop()},stop:function(){this._running=!1},pause:function(){this._paused||(this._pauseStart=(new Date).getTime(),this._paused=!0)},resume:function(){this._paused&&(this._pausedTime+=(new Date).getTime()-this._pauseStart,this._paused=!1)},clear:function(){this._clips=[]},isFinished:function(){return!this._clips.length},animate:function(t,e){var n=new sn(t,(e=e||{}).loop,e.getter,e.setter);return this.addAnimator(n),n}},b(Qi,Ct);var to,eo,no=v.domSupported,io=(eo={pointerdown:1,pointerup:1,pointermove:1,pointerout:1},{mouse:to=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],touch:["touchstart","touchend","touchmove"],pointer:N(to,function(t){var e=t.replace("mouse","pointer");return eo.hasOwnProperty(e)?e:t})}),oo={mouse:["mousemove","mouseup"],pointer:["pointermove","pointerup"]};function ao(t){return"mousewheel"===t&&v.browser.firefox?"DOMMouseScroll":t}function ro(t){var e=t.pointerType;return"pen"===e||"touch"===e}function so(t){t&&(t.zrByTouch=!0)}function lo(t,e){for(var n=!1;(e=e&&e.parentNode)&&9!==e.nodeType&&!(n=e===t.painterRoot););return n}function ho(t,e){this.type=e.type,this.target=this.currentTarget=t.dom,this.pointerType=e.pointerType,this.clientX=e.clientX,this.clientY=e.clientY}var uo=ho.prototype;uo.stopPropagation=uo.stopImmediatePropagation=uo.preventDefault=it;var co={mousedown:function(t){t=Gt(this.dom,t),this._mayPointerCapture=[t.zrX,t.zrY],this.trigger("mousedown",t)},mousemove:function(t){t=Gt(this.dom,t);var e=this._mayPointerCapture;!e||t.zrX===e[0]&&t.zrY===e[1]||yo(this,!0),this.trigger("mousemove",t)},mouseup:function(t){t=Gt(this.dom,t),yo(this,!1),this.trigger("mouseup",t)},mouseout:function(t){t=Gt(this.dom,t),this._pointerCapturing&&(t.zrEventControl="no_globalout");var e=t.toElement||t.relatedTarget;t.zrIsToLocalDOM=lo(this,e),this.trigger("mouseout",t)},touchstart:function(t){so(t=Gt(this.dom,t)),this._lastTouchMoment=new Date,this.handler.processGesture(t,"start"),co.mousemove.call(this,t),co.mousedown.call(this,t)},touchmove:function(t){so(t=Gt(this.dom,t)),this.handler.processGesture(t,"change"),co.mousemove.call(this,t)},touchend:function(t){so(t=Gt(this.dom,t)),this.handler.processGesture(t,"end"),co.mouseup.call(this,t),new Date-this._lastTouchMoment<300&&co.click.call(this,t)},pointerdown:function(t){co.mousedown.call(this,t)},pointermove:function(t){ro(t)||co.mousemove.call(this,t)},pointerup:function(t){co.mouseup.call(this,t)},pointerout:function(t){ro(t)||co.mouseout.call(this,t)}};P(["click","mousewheel","dblclick","contextmenu"],function(e){co[e]=function(t){t=Gt(this.dom,t),this.trigger(e,t)}});var po={pointermove:function(t){ro(t)||po.mousemove.call(this,t)},pointerup:function(t){po.mouseup.call(this,t)},mousemove:function(t){this.trigger("mousemove",t)},mouseup:function(t){var e=this._pointerCapturing;yo(this,!1),this.trigger("mouseup",t),e&&(t.zrEventControl="only_globalout",this.trigger("mouseout",t))}};function go(i,o){var a=o.domHandlers;v.pointerEventsSupported?P(io.pointer,function(e){mo(o,e,function(t){a[e].call(i,t)})}):(v.touchEventsSupported&&P(io.touch,function(n){mo(o,n,function(t){var e;a[n].call(i,t),(e=o).touching=!0,null!=e.touchTimer&&(clearTimeout(e.touchTimer),e.touchTimer=null),e.touchTimer=setTimeout(function(){e.touching=!1,e.touchTimer=null},700)})}),P(io.mouse,function(e){mo(o,e,function(t){t=Vt(t),o.touching||a[e].call(i,t)})}))}function fo(o,a){function t(i){mo(a,i,function(t){var e,n;t=Vt(t),lo(o,t.target)||(n=t,t=Gt((e=o).dom,new ho(e,n),!0),a.domHandlers[i].call(o,t))},{capture:!0})}v.pointerEventsSupported?P(oo.pointer,t):v.touchEventsSupported||P(oo.mouse,t)}function mo(t,e,n,i){t.mounted[e]=n,t.listenerOpts[e]=i,Ft(t.domTarget,ao(e),n,i)}function vo(t){var e,n,i,o,a=t.mounted;for(var r in a)a.hasOwnProperty(r)&&(e=t.domTarget,n=ao(r),i=a[r],o=t.listenerOpts[r],Nt?e.removeEventListener(n,i,o):e.detachEvent("on"+n,i));t.mounted={}}function yo(t,e){var n;t._mayPointerCapture=null,no&&t._pointerCapturing^e&&(t._pointerCapturing=e,n=t._globalHandlerScope,e?fo(t,n):vo(n))}function xo(t,e){this.domTarget=t,this.domHandlers=e,this.mounted={},this.listenerOpts={},this.touchTimer=null,this.touching=!1}function _o(t,e){Ct.call(this),this.dom=t,this.painterRoot=e,this._localHandlerScope=new xo(t,co),no&&(this._globalHandlerScope=new xo(document,po)),this._pointerCapturing=!1,this._mayPointerCapture=null,go(this,this._localHandlerScope)}var wo=_o.prototype;wo.dispose=function(){vo(this._localHandlerScope),no&&vo(this._globalHandlerScope)},wo.setCursor=function(t){this.dom.style&&(this.dom.style.cursor=t||"default")},b(_o,Ct);var bo=!v.canvasSupported,So={canvas:Ji},Mo={},Io="4.2.0";function To(t,e){var n=new Do(i(),t,e);return Mo[n.id]=n}function Ao(t,e){So[t]=e}var Do=function(t,e,n){n=n||{},this.dom=e,this.id=t;var i=this,o=new On,a=n.renderer;if(bo){if(!So.vml)throw new Error("You need to require 'zrender/vml/vml' to support IE8");a="vml"}else a&&So[a]||(a="canvas");var r=new So[a](e,o,n,t);this.storage=o,this.painter=r;var s=v.node||v.worker?null:new _o(r.getViewportRoot(),r.root);this.handler=new Kt(o,r,s,r.root),this.animation=new Qi({stage:{update:E(this.flush,this)}}),this.animation.start(),this._needsRefresh;var l=o.delFromStorage,h=o.addToStorage;o.delFromStorage=function(t){l.call(o,t),t&&t.removeSelfFromZr(i)},o.addToStorage=function(t){h.call(o,t),t.addSelfToZr(i)}};Do.prototype={constructor:Do,getId:function(){return this.id},add:function(t){this.storage.addRoot(t),this._needsRefresh=!0},remove:function(t){this.storage.delRoot(t),this._needsRefresh=!0},configLayer:function(t,e){this.painter.configLayer&&this.painter.configLayer(t,e),this._needsRefresh=!0},setBackgroundColor:function(t){this.painter.setBackgroundColor&&this.painter.setBackgroundColor(t),this._needsRefresh=!0},refreshImmediately:function(){this._needsRefresh=this._needsRefreshHover=!1,this.painter.refresh(),this._needsRefresh=this._needsRefreshHover=!1},refresh:function(){this._needsRefresh=!0},flush:function(){var t;this._needsRefresh&&(t=!0,this.refreshImmediately()),this._needsRefreshHover&&(t=!0,this.refreshHoverImmediately()),t&&this.trigger("rendered")},addHover:function(t,e){if(this.painter.addHover){var n=this.painter.addHover(t,e);return this.refreshHover(),n}},removeHover:function(t){this.painter.removeHover&&(this.painter.removeHover(t),this.refreshHover())},clearHover:function(){this.painter.clearHover&&(this.painter.clearHover(),this.refreshHover())},refreshHover:function(){this._needsRefreshHover=!0},refreshHoverImmediately:function(){this._needsRefreshHover=!1,this.painter.refreshHover&&this.painter.refreshHover()},resize:function(t){t=t||{},this.painter.resize(t.width,t.height),this.handler.resize()},clearAnimation:function(){this.animation.clear()},getWidth:function(){return this.painter.getWidth()},getHeight:function(){return this.painter.getHeight()},pathToImage:function(t,e){return this.painter.pathToImage(t,e)},setCursorStyle:function(t){this.handler.setCursorStyle(t)},findHover:function(t,e){return this.handler.findHover(t,e)},on:function(t,e,n){this.handler.on(t,e,n)},off:function(t,e){this.handler.off(t,e)},trigger:function(t,e){this.handler.trigger(t,e)},clear:function(){this.storage.delRoot(),this.painter.clear()},dispose:function(){var t;this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,t=this.id,delete Mo[t]}};var Co=(Object.freeze||Object)({version:Io,init:To,dispose:function(t){if(t)t.dispose();else{for(var e in Mo)Mo.hasOwnProperty(e)&&Mo[e].dispose();Mo={}}return this},getInstance:function(t){return Mo[t]},registerPainter:Ao}),Lo=P,ko=V,Po=R,No="series\0";function Oo(t){return t instanceof Array?t:null==t?[]:[t]}function Eo(t,e,n){if(t){t[e]=t[e]||{},t.emphasis=t.emphasis||{},t.emphasis[e]=t.emphasis[e]||{};for(var i=0,o=n.length;i<o;i++){var a=n[i];!t.emphasis[e].hasOwnProperty(a)&&t[e].hasOwnProperty(a)&&(t.emphasis[e][a]=t[e][a])}}}var zo=["fontStyle","fontWeight","fontSize","fontFamily","rich","tag","color","textBorderColor","textBorderWidth","width","height","lineHeight","align","verticalAlign","baseline","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY","backgroundColor","borderColor","borderWidth","borderRadius","padding"];function Ro(t){return!ko(t)||Po(t)||t instanceof Date?t:t.value}function Bo(t,o){o=(o||[]).slice();var a=N(t||[],function(t,e){return{exist:t}});return Lo(o,function(t,e){if(ko(t)){for(var n=0;n<a.length;n++)if(!a[n].option&&null!=t.id&&a[n].exist.id===t.id+"")return a[n].option=t,void(o[e]=null);for(n=0;n<a.length;n++){var i=a[n].exist;if(!(a[n].option||null!=i.id&&null!=t.id||null==t.name||Fo(t)||Fo(i)||i.name!==t.name+""))return a[n].option=t,void(o[e]=null)}}}),Lo(o,function(t,e){if(ko(t)){for(var n=0;n<a.length;n++){var i=a[n].exist;if(!a[n].option&&!Fo(i)&&null==t.id){a[n].option=t;break}}n>=a.length&&a.push({option:t})}}),a}function Vo(t){var r=et();Lo(t,function(t,e){var n=t.exist;n&&r.set(n.id,t)}),Lo(t,function(t,e){var n=t.option;q(!n||null==n.id||!r.get(n.id)||r.get(n.id)===t,"id duplicates: "+(n&&n.id)),n&&null!=n.id&&r.set(n.id,t),t.keyInfo||(t.keyInfo={})}),Lo(t,function(t,e){var n=t.exist,i=t.option,o=t.keyInfo;if(ko(i)){if(o.name=null!=i.name?i.name+"":n?n.name:No+e,n)o.id=n.id;else if(null!=i.id)o.id=i.id+"";else for(var a=0;o.id="\0"+o.name+"\0"+a++,r.get(o.id););r.set(o.id,t)}})}function Go(t){var e=t.name;return e&&e.indexOf(No)}function Fo(t){return ko(t)&&t.id&&0===(t.id+"").indexOf("\0_ec_\0")}function Wo(e,t){return null!=t.dataIndexInside?t.dataIndexInside:null!=t.dataIndex?R(t.dataIndex)?N(t.dataIndex,function(t){return e.indexOfRawIndex(t)}):e.indexOfRawIndex(t.dataIndex):null!=t.name?R(t.name)?N(t.name,function(t){return e.indexOfName(t)}):e.indexOfName(t.name):void 0}function Ho(){var e="__\0ec_inner_"+Zo+++"_"+Math.random().toFixed(5);return function(t){return t[e]||(t[e]={})}}var Zo=0;function Uo(s,l,h){var t;B(l)&&((t={})[l+"Index"]=0,l=t);var e=h&&h.defaultMainType;!e||Xo(l,e+"Index")||Xo(l,e+"Id")||Xo(l,e+"Name")||(l[e+"Index"]=0);var u={};return Lo(l,function(t,e){var n,i,o,a,r,t=l[e];"dataIndex"!==e&&"dataIndexInside"!==e?(i=(n=e.match(/^(\w+)(Index|Id|Name)$/)||[])[1],o=(n[2]||"").toLowerCase(),!i||!o||null==t||"index"===o&&"none"===t||h&&h.includeMainTypes&&M(h.includeMainTypes,i)<0||(a={mainType:i},"index"===o&&"all"===t||(a[o]=t),r=s.queryComponents(a),u[i+"Models"]=r,u[i+"Model"]=r[0])):u[e]=t}),u}function Xo(t,e){return t&&t.hasOwnProperty(e)}function Yo(t,e,n){t.setAttribute?t.setAttribute(e,n):t[e]=n}function jo(t){return"auto"===t?v.domSupported?"html":"richText":t||"html"}function qo(t,n){var i=et(),o=[];return P(t,function(t){var e=n(t);(i.get(e)||(o.push(e),i.set(e,[]))).push(t)}),{keys:o,buckets:i}}var Ko=".",$o="___EC__COMPONENT__CONTAINER___";function Jo(t){var e={main:"",sub:""};return t&&(t=t.split(Ko),e.main=t[0]||"",e.sub=t[1]||""),e}function Qo(t,i){(t.$constructor=t).extend=function(e){D&&P(i,function(t){e[t]||console.warn("Method `"+t+"` should be implemented"+(e.type?" in "+e.type:"")+".")});function t(){e.$constructor?e.$constructor.apply(this,arguments):n.apply(this,arguments)}var n=this;return k(t.prototype,e),t.extend=this.extend,t.superCall=na,t.superApply=ia,w(t,this),t.superClass=n,t}}var ta=0;function ea(t){var e=["__\0is_clz",ta++,Math.random().toFixed(3)].join("_");t.prototype[e]=!0,D&&q(!t.isInstance,'The method "is" can not be defined.'),t.isInstance=function(t){return!(!t||!t[e])}}function na(t,e){var n=Y(arguments,2);return this.superClass.prototype[e].apply(t,n)}function ia(t,e,n){return this.superClass.prototype[e].apply(t,n)}function oa(n,t){t=t||{};var i,o={};return n.registerClass=function(t,e){var n;return e&&(q(/^[a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)?$/.test(n=e),'componentType "'+n+'" illegal'),(e=Jo(e)).sub?e.sub!==$o&&(function(t){var e=o[t.main];e&&e[$o]||((e=o[t.main]={})[$o]=!0);return e}(e)[e.sub]=t):(D&&o[e.main]&&console.warn(e.main+" exists."),o[e.main]=t)),t},n.getClass=function(t,e,n){var i=o[t];if(i&&i[$o]&&(i=e?i[e]:null),n&&!i)throw new Error(e?"Component "+t+"."+(e||"")+" not exists. Load it first.":t+".type should be specified.");return i},n.getClassesByMainType=function(t){t=Jo(t);var n=[],e=o[t.main];return e&&e[$o]?P(e,function(t,e){e!==$o&&n.push(t)}):n.push(e),n},n.hasClass=function(t){return t=Jo(t),!!o[t.main]},n.getAllClassMainTypes=function(){var n=[];return P(o,function(t,e){n.push(e)}),n},n.hasSubTypes=function(t){t=Jo(t);var e=o[t.main];return e&&e[$o]},n.parseClassType=Jo,!t.registerWhenExtend||(i=n.extend)&&(n.extend=function(t){var e=i.call(this,t);return n.registerClass(e,t.type)}),n}function aa(s){for(var t=0;t<s.length;t++)s[t][1]||(s[t][1]=s[t][0]);return function(t,e,n){for(var i={},o=0;o<s.length;o++){var a,r=s[o][1];e&&0<=M(e,r)||n&&M(n,r)<0||null!=(a=t.getShallow(r))&&(i[s[o][0]]=a)}return i}}var ra=aa([["lineWidth","width"],["stroke","color"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"]]),sa={getLineStyle:function(t){var e=ra(this,t);return e.lineDash=this.getLineDash(e.lineWidth),e},getLineDash:function(t){null==t&&(t=1);var e=this.get("type"),n=Math.max(t,2),i=4*t;return"solid"!==e&&null!=e&&("dashed"===e?[i,i]:[n,n])}},la=aa([["fill","color"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["opacity"],["shadowColor"]]),ha={getAreaStyle:function(t,e){return la(this,t,e)}},ua=Math.pow,ca=Math.sqrt,da=1e-8,pa=1e-4,ga=ca(3),fa=1/3,ma=rt(),va=rt(),ya=rt();function xa(t){return-da<t&&t<da}function _a(t){return da<t||t<-da}function wa(t,e,n,i,o){var a=1-o;return a*a*(a*t+3*o*e)+o*o*(o*i+3*a*n)}function ba(t,e,n,i,o){var a=1-o;return 3*(((e-t)*a+2*(n-e)*o)*a+(i-n)*o*o)}function Sa(t,e,n,i,o){var a,r,s,l,h=6*n-12*e+6*t,u=9*e+3*i-3*t-9*n,c=3*e-3*t,d=0;return xa(u)?_a(h)&&0<=(s=-c/h)&&s<=1&&(o[d++]=s):xa(a=h*h-4*u*c)?o[0]=-h/(2*u):0<a&&(l=(-h-(r=ca(a)))/(2*u),0<=(s=(-h+r)/(2*u))&&s<=1&&(o[d++]=s),0<=l&&l<=1&&(o[d++]=l)),d}function Ma(t,e,n,i,o,a){var r=(e-t)*o+t,s=(n-e)*o+e,l=(i-n)*o+n,h=(s-r)*o+r,u=(l-s)*o+s,c=(u-h)*o+h;a[0]=t,a[1]=r,a[2]=h,a[3]=c,a[4]=c,a[5]=u,a[6]=l,a[7]=i}function Ia(t,e,n,i){var o=1-i;return o*(o*t+2*i*e)+i*i*n}function Ta(t,e,n,i){return 2*((1-i)*(e-t)+i*(n-e))}function Aa(t,e,n){var i=t+n-2*e;return 0==i?.5:(t-e)/i}function Da(t,e,n,i,o){var a=(e-t)*i+t,r=(n-e)*i+e,s=(r-a)*i+a;o[0]=t,o[1]=a,o[2]=s,o[3]=s,o[4]=r,o[5]=n}var Ca=Math.min,La=Math.max,ka=Math.sin,Pa=Math.cos,Na=2*Math.PI,Oa=rt(),Ea=rt(),za=rt();function Ra(t,e,n){if(0!==t.length){for(var i=t[0],o=i[0],a=i[0],r=i[1],s=i[1],l=1;l<t.length;l++)i=t[l],o=Ca(o,i[0]),a=La(a,i[0]),r=Ca(r,i[1]),s=La(s,i[1]);e[0]=o,e[1]=r,n[0]=a,n[1]=s}}function Ba(t,e,n,i,o,a){o[0]=Ca(t,n),o[1]=Ca(e,i),a[0]=La(t,n),a[1]=La(e,i)}var Va=[],Ga=[];function Fa(t,e,n,i,o,a,r,s,l,h){var u,c=Sa,d=wa,p=c(t,n,o,r,Va);for(l[0]=1/0,l[1]=1/0,h[0]=-1/0,h[1]=-1/0,u=0;u<p;u++){var g=d(t,n,o,r,Va[u]);l[0]=Ca(g,l[0]),h[0]=La(g,h[0])}for(p=c(e,i,a,s,Ga),u=0;u<p;u++){var f=d(e,i,a,s,Ga[u]);l[1]=Ca(f,l[1]),h[1]=La(f,h[1])}l[0]=Ca(t,l[0]),h[0]=La(t,h[0]),l[0]=Ca(r,l[0]),h[0]=La(r,h[0]),l[1]=Ca(e,l[1]),h[1]=La(e,h[1]),l[1]=Ca(s,l[1]),h[1]=La(s,h[1])}function Wa(t,e,n,i,o,a,r,s,l){var h,u=St,c=Mt,d=Math.abs(o-a);if(d%Na<1e-4&&1e-4<d)return s[0]=t-n,s[1]=e-i,l[0]=t+n,void(l[1]=e+i);Oa[0]=Pa(o)*n+t,Oa[1]=ka(o)*i+e,Ea[0]=Pa(a)*n+t,Ea[1]=ka(a)*i+e,u(s,Oa,Ea),c(l,Oa,Ea),(o%=Na)<0&&(o+=Na),(a%=Na)<0&&(a+=Na),a<o&&!r?a+=Na:o<a&&r&&(o+=Na),r&&(h=a,a=o,o=h);for(var p=0;p<a;p+=Math.PI/2)o<p&&(za[0]=Pa(p)*n+t,za[1]=ka(p)*i+e,u(s,za,s),c(l,za,l))}var Ha={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},Za=[],Ua=[],Xa=[],Ya=[],ja=Math.min,qa=Math.max,Ka=Math.cos,$a=Math.sin,Ja=Math.sqrt,Qa=Math.abs,tr="undefined"!=typeof Float32Array,er=function(t){this._saveData=!t,this._saveData&&(this.data=[]),this._ctx=null};function nr(t,e,n,i,o,a,r){if(0!==o){var s=o,l=0;if(!(e+s<r&&i+s<r||r<e-s&&r<i-s||t+s<a&&n+s<a||a<t-s&&a<n-s)){if(t===n)return Math.abs(a-t)<=s/2;var h=(l=(e-i)/(t-n))*a-r+(t*i-n*e)/(t-n);return h*h/(l*l+1)<=s/2*s/2}}}function ir(t,e,n,i,o,a,r,s,l,h,u){if(0!==l){var c=l;if(!(e+c<u&&i+c<u&&a+c<u&&s+c<u||u<e-c&&u<i-c&&u<a-c&&u<s-c||t+c<h&&n+c<h&&o+c<h&&r+c<h||h<t-c&&h<n-c&&h<o-c&&h<r-c))return function(t,e,n,i,o,a,r,s,l,h,u){var c,d,p,g,f,m=.005,v=1/0;ma[0]=l,ma[1]=h;for(var y=0;y<1;y+=.05)va[0]=wa(t,n,o,r,y),va[1]=wa(e,i,a,s,y),(g=_t(ma,va))<v&&(c=y,v=g);v=1/0;for(var x=0;x<32&&!(m<pa);x++)d=c-m,p=c+m,va[0]=wa(t,n,o,r,d),va[1]=wa(e,i,a,s,d),g=_t(va,ma),0<=d&&g<v?(c=d,v=g):(ya[0]=wa(t,n,o,r,p),ya[1]=wa(e,i,a,s,p),f=_t(ya,ma),p<=1&&f<v?(c=p,v=f):m*=.5);return u&&(u[0]=wa(t,n,o,r,c),u[1]=wa(e,i,a,s,c)),ca(v)}(t,e,n,i,o,a,r,s,h,u,null)<=c/2}}function or(t,e,n,i,o,a,r,s,l){if(0!==r){var h=r;if(!(e+h<l&&i+h<l&&a+h<l||l<e-h&&l<i-h&&l<a-h||t+h<s&&n+h<s&&o+h<s||s<t-h&&s<n-h&&s<o-h))return function(t,e,n,i,o,a,r,s,l){var h,u=.005,c=1/0;ma[0]=r,ma[1]=s;for(var d=0;d<1;d+=.05){va[0]=Ia(t,n,o,d),va[1]=Ia(e,i,a,d),(v=_t(ma,va))<c&&(h=d,c=v)}c=1/0;for(var p=0;p<32&&!(u<pa);p++){var g=h-u,f=h+u;va[0]=Ia(t,n,o,g),va[1]=Ia(e,i,a,g);var m,v=_t(va,ma);0<=g&&v<c?(h=g,c=v):(ya[0]=Ia(t,n,o,f),ya[1]=Ia(e,i,a,f),m=_t(ya,ma),f<=1&&m<c?(h=f,c=m):u*=.5)}return l&&(l[0]=Ia(t,n,o,h),l[1]=Ia(e,i,a,h)),ca(c)}(t,e,n,i,o,a,s,l,null)<=h/2}}er.prototype={constructor:er,_xi:0,_yi:0,_x0:0,_y0:0,_ux:0,_uy:0,_len:0,_lineDash:null,_dashOffset:0,_dashIdx:0,_dashSum:0,setScale:function(t,e,n){n=n||0,this._ux=Qa(n/hn/t)||0,this._uy=Qa(n/hn/e)||0},getContext:function(){return this._ctx},beginPath:function(t){return(this._ctx=t)&&t.beginPath(),t&&(this.dpr=t.dpr),this._saveData&&(this._len=0),this._lineDash&&(this._lineDash=null,this._dashOffset=0),this},moveTo:function(t,e){return this.addData(Ha.M,t,e),this._ctx&&this._ctx.moveTo(t,e),this._x0=t,this._y0=e,this._xi=t,this._yi=e,this},lineTo:function(t,e){var n=Qa(t-this._xi)>this._ux||Qa(e-this._yi)>this._uy||this._len<5;return this.addData(Ha.L,t,e),this._ctx&&n&&(this._needsDash()?this._dashedLineTo(t,e):this._ctx.lineTo(t,e)),n&&(this._xi=t,this._yi=e),this},bezierCurveTo:function(t,e,n,i,o,a){return this.addData(Ha.C,t,e,n,i,o,a),this._ctx&&(this._needsDash()?this._dashedBezierTo(t,e,n,i,o,a):this._ctx.bezierCurveTo(t,e,n,i,o,a)),this._xi=o,this._yi=a,this},quadraticCurveTo:function(t,e,n,i){return this.addData(Ha.Q,t,e,n,i),this._ctx&&(this._needsDash()?this._dashedQuadraticTo(t,e,n,i):this._ctx.quadraticCurveTo(t,e,n,i)),this._xi=n,this._yi=i,this},arc:function(t,e,n,i,o,a){return this.addData(Ha.A,t,e,n,n,i,o-i,0,a?0:1),this._ctx&&this._ctx.arc(t,e,n,i,o,a),this._xi=Ka(o)*n+t,this._yi=$a(o)*n+e,this},arcTo:function(t,e,n,i,o){return this._ctx&&this._ctx.arcTo(t,e,n,i,o),this},rect:function(t,e,n,i){return this._ctx&&this._ctx.rect(t,e,n,i),this.addData(Ha.R,t,e,n,i),this},closePath:function(){this.addData(Ha.Z);var t=this._ctx,e=this._x0,n=this._y0;return t&&(this._needsDash()&&this._dashedLineTo(e,n),t.closePath()),this._xi=e,this._yi=n,this},fill:function(t){t&&t.fill(),this.toStatic()},stroke:function(t){t&&t.stroke(),this.toStatic()},setLineDash:function(t){if(t instanceof Array){this._lineDash=t;for(var e=this._dashIdx=0,n=0;n<t.length;n++)e+=t[n];this._dashSum=e}return this},setLineDashOffset:function(t){return this._dashOffset=t,this},len:function(){return this._len},setData:function(t){var e=t.length;this.data&&this.data.length===e||!tr||(this.data=new Float32Array(e));for(var n=0;n<e;n++)this.data[n]=t[n];this._len=e},appendPath:function(t){t instanceof Array||(t=[t]);for(var e=t.length,n=0,i=this._len,o=0;o<e;o++)n+=t[o].len();tr&&this.data instanceof Float32Array&&(this.data=new Float32Array(i+n));for(o=0;o<e;o++)for(var a=t[o].data,r=0;r<a.length;r++)this.data[i++]=a[r];this._len=i},addData:function(t){if(this._saveData){var e=this.data;this._len+arguments.length>e.length&&(this._expandData(),e=this.data);for(var n=0;n<arguments.length;n++)e[this._len++]=arguments[n];this._prevCmd=t}},_expandData:function(){if(!(this.data instanceof Array)){for(var t=[],e=0;e<this._len;e++)t[e]=this.data[e];this.data=t}},_needsDash:function(){return this._lineDash},_dashedLineTo:function(t,e){var n,i,o=this._dashSum,a=this._dashOffset,r=this._lineDash,s=this._ctx,l=this._xi,h=this._yi,u=t-l,c=e-h,d=Ja(u*u+c*c),p=l,g=h,f=r.length;for(a<0&&(a=o+a),p-=(a%=o)*(u/=d),g-=a*(c/=d);0<u&&p<=t||u<0&&t<=p||0===u&&(0<c&&g<=e||c<0&&e<=g);)p+=u*(n=r[i=this._dashIdx]),g+=c*n,this._dashIdx=(i+1)%f,0<u&&p<l||u<0&&l<p||0<c&&g<h||c<0&&h<g||s[i%2?"moveTo":"lineTo"]((0<=u?ja:qa)(p,t),(0<=c?ja:qa)(g,e));u=p-t,c=g-e,this._dashOffset=-Ja(u*u+c*c)},_dashedBezierTo:function(t,e,n,i,o,a){var r,s,l,h,u,c=this._dashSum,d=this._dashOffset,p=this._lineDash,g=this._ctx,f=this._xi,m=this._yi,v=wa,y=0,x=this._dashIdx,_=p.length,w=0;for(d<0&&(d=c+d),d%=c,r=0;r<1;r+=.1)s=v(f,t,n,o,r+.1)-v(f,t,n,o,r),l=v(m,e,i,a,r+.1)-v(m,e,i,a,r),y+=Ja(s*s+l*l);for(;x<_&&!(d<(w+=p[x]));x++);for(r=(w-d)/y;r<=1;)h=v(f,t,n,o,r),u=v(m,e,i,a,r),x%2?g.moveTo(h,u):g.lineTo(h,u),r+=p[x]/y,x=(x+1)%_;x%2!=0&&g.lineTo(o,a),s=o-h,l=a-u,this._dashOffset=-Ja(s*s+l*l)},_dashedQuadraticTo:function(t,e,n,i){var o=n,a=i;n=(n+2*t)/3,i=(i+2*e)/3,t=(this._xi+2*t)/3,e=(this._yi+2*e)/3,this._dashedBezierTo(t,e,n,i,o,a)},toStatic:function(){var t=this.data;t instanceof Array&&(t.length=this._len,tr&&(this.data=new Float32Array(t)))},getBoundingRect:function(){Za[0]=Za[1]=Xa[0]=Xa[1]=Number.MAX_VALUE,Ua[0]=Ua[1]=Ya[0]=Ya[1]=-Number.MAX_VALUE;for(var t,e,n,i,o,a,r,s,l,h,u,c,d,p,g=this.data,f=0,m=0,v=0,y=0,x=0;x<g.length;){var _=g[x++];switch(1===x&&(v=f=g[x],y=m=g[x+1]),_){case Ha.M:f=v=g[x++],m=y=g[x++],Xa[0]=v,Xa[1]=y,Ya[0]=v,Ya[1]=y;break;case Ha.L:Ba(f,m,g[x],g[x+1],Xa,Ya),f=g[x++],m=g[x++];break;case Ha.C:Fa(f,m,g[x++],g[x++],g[x++],g[x++],g[x],g[x+1],Xa,Ya),f=g[x++],m=g[x++];break;case Ha.Q:t=f,e=m,n=g[x++],i=g[x++],o=g[x],a=g[x+1],r=Xa,s=Ya,h=l=void 0,h=Ia,u=La(Ca((l=Aa)(t,n,o),1),0),c=La(Ca(l(e,i,a),1),0),d=h(t,n,o,u),p=h(e,i,a,c),r[0]=Ca(t,o,d),r[1]=Ca(e,a,p),s[0]=La(t,o,d),s[1]=La(e,a,p),f=g[x++],m=g[x++];break;case Ha.A:var w=g[x++],b=g[x++],S=g[x++],M=g[x++],I=g[x++],T=g[x++]+I;x+=1;var A=1-g[x++];1===x&&(v=Ka(I)*S+w,y=$a(I)*M+b),Wa(w,b,S,M,I,T,A,Xa,Ya),f=Ka(T)*S+w,m=$a(T)*M+b;break;case Ha.R:Ba(v=f=g[x++],y=m=g[x++],v+g[x++],y+g[x++],Xa,Ya);break;case Ha.Z:f=v,m=y}St(Za,Za,Xa),Mt(Ua,Ua,Ya)}return 0===x&&(Za[0]=Za[1]=Ua[0]=Ua[1]=0),new Sn(Za[0],Za[1],Ua[0]-Za[0],Ua[1]-Za[1])},rebuildPath:function(t){for(var e,n,i,o,a,r,s=this.data,l=this._ux,h=this._uy,u=this._len,c=0;c<u;){var d=s[c++];switch(1===c&&(e=i=s[c],n=o=s[c+1]),d){case Ha.M:e=i=s[c++],n=o=s[c++],t.moveTo(i,o);break;case Ha.L:a=s[c++],r=s[c++],(Qa(a-i)>l||Qa(r-o)>h||c===u-1)&&(t.lineTo(a,r),i=a,o=r);break;case Ha.C:t.bezierCurveTo(s[c++],s[c++],s[c++],s[c++],s[c++],s[c++]),i=s[c-2],o=s[c-1];break;case Ha.Q:t.quadraticCurveTo(s[c++],s[c++],s[c++],s[c++]),i=s[c-2],o=s[c-1];break;case Ha.A:var p=s[c++],g=s[c++],f=s[c++],m=s[c++],v=s[c++],y=s[c++],x=s[c++],_=s[c++],w=m<f?f:m,b=m<f?1:f/m,S=m<f?m/f:1,M=v+y;.001<Math.abs(f-m)?(t.translate(p,g),t.rotate(x),t.scale(b,S),t.arc(0,0,w,v,M,1-_),t.scale(1/b,1/S),t.rotate(-x),t.translate(-p,-g)):t.arc(p,g,w,v,M,1-_),1===c&&(e=Ka(v)*f+p,n=$a(v)*m+g),i=Ka(M)*f+p,o=$a(M)*m+g;break;case Ha.R:e=i=s[c],n=o=s[c+1],t.rect(s[c++],s[c++],s[c++],s[c++]);break;case Ha.Z:t.closePath(),i=e,o=n}}}},er.CMD=Ha;var ar=2*Math.PI;function rr(t){return(t%=ar)<0&&(t+=ar),t}var sr=2*Math.PI;function lr(t,e,n,i,o,a,r,s,l){if(0!==r){var h=r;s-=t,l-=e;var u,c=Math.sqrt(s*s+l*l);if(!(n<c-h||c+h<n)){if(Math.abs(i-o)%sr<1e-4)return 1;(o=a?(u=i,i=rr(o),rr(u)):(i=rr(i),rr(o)))<i&&(o+=sr);var d=Math.atan2(l,s);return d<0&&(d+=sr),i<=d&&d<=o||i<=d+sr&&d+sr<=o}}}function hr(t,e,n,i,o,a){if(e<a&&i<a||a<e&&a<i)return 0;if(i===e)return 0;var r=i<e?1:-1,s=(a-e)/(i-e);1!=s&&0!=s||(r=i<e?.5:-.5);var l=s*(n-t)+t;return l===o?1/0:o<l?r:0}var ur=er.CMD,cr=2*Math.PI,dr=1e-4;var pr=[-1,-1,-1],gr=[-1,-1];function fr(t,e,n,i,o,a,r,s,l,h){if(e<h&&i<h&&a<h&&s<h||h<e&&h<i&&h<a&&h<s)return 0;var u,c,d,p,g,f,m,v,y,x,_,w,b,S,M,I,T,A,D,C,L,k,P,N,O=(p=pr,k=(A=3*((d=a)-2*(c=i)+(u=e)))*(D=3*(c-u))-9*(T=s+3*(c-d)-u)*(C=u-h),P=D*D-3*A*C,N=0,xa(L=A*A-3*T*D)&&xa(k)?xa(A)?p[0]=0:0<=(S=-D/A)&&S<=1&&(p[N++]=S):xa(g=k*k-4*L*P)?(M=-(f=k/L)/2,0<=(S=-A/T+f)&&S<=1&&(p[N++]=S),0<=M&&M<=1&&(p[N++]=M)):0<g?(y=L*A+1.5*T*(-k-(m=ca(g))),0<=(S=(-A-((v=(v=L*A+1.5*T*(-k+m))<0?-ua(-v,fa):ua(v,fa))+(y=y<0?-ua(-y,fa):ua(y,fa))))/(3*T))&&S<=1&&(p[N++]=S)):(x=(2*L*A-3*T*k)/(2*ca(L*L*L)),_=Math.acos(x)/3,S=(-A-2*(w=ca(L))*(b=Math.cos(_)))/(3*T),M=(-A+w*(b+ga*Math.sin(_)))/(3*T),I=(-A+w*(b-ga*Math.sin(_)))/(3*T),0<=S&&S<=1&&(p[N++]=S),0<=M&&M<=1&&(p[N++]=M),0<=I&&I<=1&&(p[N++]=I)),N);if(0===O)return 0;for(var E,z,R,B=0,V=-1,G=0;G<O;G++){var F=pr[G],W=0===F||1===F?.5:1;wa(t,n,o,r,F)<l||(V<0&&(V=Sa(e,i,a,s,gr),gr[1]<gr[0]&&1<V&&(R=gr[0],gr[0]=gr[1],gr[1]=R),E=wa(e,i,a,s,gr[0]),1<V&&(z=wa(e,i,a,s,gr[1]))),2===V?F<gr[0]?B+=E<e?W:-W:F<gr[1]?B+=z<E?W:-W:B+=s<z?W:-W:F<gr[0]?B+=E<e?W:-W:B+=s<E?W:-W)}return B}function mr(t,e,n,i,o,a,r,s){if(e<s&&i<s&&a<s||s<e&&s<i&&s<a)return 0;var l,h,u,c,d,p,g,f,m,v,y,x=(u=pr,m=2*((h=i)-(l=e)),v=l-s,y=0,xa(f=l-2*h+a)?_a(m)&&0<=(p=-v/m)&&p<=1&&(u[y++]=p):xa(c=m*m-4*f*v)?0<=(p=-m/(2*f))&&p<=1&&(u[y++]=p):0<c&&(g=(-m-(d=ca(c)))/(2*f),0<=(p=(-m+d)/(2*f))&&p<=1&&(u[y++]=p),0<=g&&g<=1&&(u[y++]=g)),y);if(0===x)return 0;var _=Aa(e,i,a);if(0<=_&&_<=1){for(var w=0,b=Ia(e,i,a,_),S=0;S<x;S++){var M=0===pr[S]||1===pr[S]?.5:1;Ia(t,n,o,pr[S])<r||(pr[S]<_?w+=b<e?M:-M:w+=a<b?M:-M)}return w}M=0===pr[0]||1===pr[0]?.5:1;return Ia(t,n,o,pr[0])<r?0:a<e?M:-M}function vr(t,e,n,i,o,a,r,s){if(n<(s-=e)||s<-n)return 0;var l=Math.sqrt(n*n-s*s);pr[0]=-l,pr[1]=l;var h=Math.abs(i-o);if(h<1e-4)return 0;if(h%cr<1e-4){o=cr;var u=a?1:-1;return r>=pr[i=0]+t&&r<=pr[1]+t?u:0}(o=a?(l=i,i=rr(o),rr(l)):(i=rr(i),rr(o)))<i&&(o+=cr);for(var c=0,d=0;d<2;d++){var p,g=pr[d];r<g+t&&(u=a?1:-1,(p=Math.atan2(s,g))<0&&(p=cr+p),(i<=p&&p<=o||i<=p+cr&&p+cr<=o)&&(p>Math.PI/2&&p<1.5*Math.PI&&(u=-u),c+=u))}return c}function yr(t,e,n,i,o){for(var a,r,s=0,l=0,h=0,u=0,c=0,d=0;d<t.length;){var p=t[d++];switch(p===ur.M&&1<d&&(n||(s+=hr(l,h,u,c,i,o))),1===d&&(u=l=t[d],c=h=t[d+1]),p){case ur.M:l=u=t[d++],h=c=t[d++];break;case ur.L:if(n){if(nr(l,h,t[d],t[d+1],e,i,o))return!0}else s+=hr(l,h,t[d],t[d+1],i,o)||0;l=t[d++],h=t[d++];break;case ur.C:if(n){if(ir(l,h,t[d++],t[d++],t[d++],t[d++],t[d],t[d+1],e,i,o))return!0}else s+=fr(l,h,t[d++],t[d++],t[d++],t[d++],t[d],t[d+1],i,o)||0;l=t[d++],h=t[d++];break;case ur.Q:if(n){if(or(l,h,t[d++],t[d++],t[d],t[d+1],e,i,o))return!0}else s+=mr(l,h,t[d++],t[d++],t[d],t[d+1],i,o)||0;l=t[d++],h=t[d++];break;case ur.A:var g=t[d++],f=t[d++],m=t[d++],v=t[d++],y=t[d++],x=t[d++];d+=1;var _=1-t[d++],w=Math.cos(y)*m+g,b=Math.sin(y)*v+f;1<d?s+=hr(l,h,w,b,i,o):(u=w,c=b);var S=(i-g)*v/m+g;if(n){if(lr(g,f,v,y,y+x,_,e,S,o))return!0}else s+=vr(g,f,v,y,y+x,_,S,o);l=Math.cos(y+x)*m+g,h=Math.sin(y+x)*v+f;break;case ur.R:u=l=t[d++],c=h=t[d++];w=u+t[d++],b=c+t[d++];if(n){if(nr(u,c,w,c,e,i,o)||nr(w,c,w,b,e,i,o)||nr(w,b,u,b,e,i,o)||nr(u,b,u,c,e,i,o))return!0}else s+=hr(w,c,w,b,i,o),s+=hr(u,b,u,c,i,o);break;case ur.Z:if(n){if(nr(l,h,u,c,e,i,o))return!0}else s+=hr(l,h,u,c,i,o);l=u,h=c}}return n||(a=h,r=c,Math.abs(a-r)<dr)||(s+=hr(l,h,u,c,i,o)||0),0!==s}var xr=Xn.prototype.getCanvasPattern,_r=Math.abs,wr=new er(!0);function br(t){Xi.call(this,t),this.path=null}br.prototype={constructor:br,type:"path",__dirtyPath:!0,strokeContainThreshold:5,segmentIgnoreThreshold:0,subPixelOptimize:!1,brush:function(t,e){var n,i=this.style,o=this.path||wr,a=i.hasStroke(),r=i.hasFill(),s=i.fill,l=i.stroke,h=r&&!!s.colorStops,u=a&&!!l.colorStops,c=r&&!!s.image,d=a&&!!l.image;i.bind(t,this,e),this.setTransform(t),this.__dirty&&(h&&(n=n||this.getBoundingRect(),this._fillGradient=i.getGradient(t,s,n)),u&&(n=n||this.getBoundingRect(),this._strokeGradient=i.getGradient(t,l,n))),h?t.fillStyle=this._fillGradient:c&&(t.fillStyle=xr.call(s,t)),u?t.strokeStyle=this._strokeGradient:d&&(t.strokeStyle=xr.call(l,t));var p,g=i.lineDash,f=i.lineDashOffset,m=!!t.setLineDash,v=this.getGlobalScale();o.setScale(v[0],v[1],this.segmentIgnoreThreshold),this.__dirtyPath||g&&!m&&a?(o.beginPath(t),g&&!m&&(o.setLineDash(g),o.setLineDashOffset(f)),this.buildPath(o,this.shape,!1),this.path&&(this.__dirtyPath=!1)):(t.beginPath(),this.path.rebuildPath(t)),r&&(null!=i.fillOpacity?(p=t.globalAlpha,t.globalAlpha=i.fillOpacity*i.opacity,o.fill(t),t.globalAlpha=p):o.fill(t)),g&&m&&(t.setLineDash(g),t.lineDashOffset=f),a&&(null!=i.strokeOpacity?(p=t.globalAlpha,t.globalAlpha=i.strokeOpacity*i.opacity,o.stroke(t),t.globalAlpha=p):o.stroke(t)),g&&m&&t.setLineDash([]),null!=i.text&&(this.restoreTransform(t),this.drawRectText(t,this.getBoundingRect()))},buildPath:function(t,e,n){},createPathProxy:function(){this.path=new er},getBoundingRect:function(){var t,e=this._rect,n=this.style,i=!e;if(i&&(t=(t=this.path)||(this.path=new er),this.__dirtyPath&&(t.beginPath(),this.buildPath(t,this.shape,!1)),e=t.getBoundingRect()),this._rect=e,n.hasStroke()){var o,a,r=this._rectWithStroke||(this._rectWithStroke=e.clone());return(this.__dirty||i)&&(r.copy(e),o=n.lineWidth,a=n.strokeNoScale?this.getLineScale():1,n.hasFill()||(o=Math.max(o,this.strokeContainThreshold||4)),1e-10<a&&(r.width+=o/a,r.height+=o/a,r.x-=o/a/2,r.y-=o/a/2)),r}return e},contain:function(t,e){var n=this.transformCoordToLocal(t,e),i=this.getBoundingRect(),o=this.style;if(t=n[0],e=n[1],i.contain(t,e)){var a=this.path.data;if(o.hasStroke()){var r=o.lineWidth,s=o.strokeNoScale?this.getLineScale():1;if(1e-10<s&&(o.hasFill()||(r=Math.max(r,this.strokeContainThreshold)),yr(a,r/s,!0,t,e)))return!0}if(o.hasFill())return yr(a,0,!1,t,e)}return!1},dirty:function(t){null==t&&(t=!0),t&&(this.__dirtyPath=t,this._rect=null),this.__dirty=this.__dirtyText=!0,this.__zr&&this.__zr.refresh(),this.__clipTarget&&this.__clipTarget.dirty()},animateShape:function(t){return this.animate("shape",t)},attrKV:function(t,e){"shape"===t?(this.setShape(e),this.__dirtyPath=!0,this._rect=null):Xi.prototype.attrKV.call(this,t,e)},setShape:function(t,e){var n=this.shape;if(n){if(V(t))for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);else n[t]=e;this.dirty(!0)}return this},getLineScale:function(){var t=this.transform;return t&&1e-10<_r(t[0]-1)&&1e-10<_r(t[3]-1)?Math.sqrt(_r(t[0]*t[3]-t[2]*t[1])):1}},br.extend=function(o){function t(t){br.call(this,t),o.style&&this.style.extendFrom(o.style,!1);var e=o.shape;if(e){this.shape=this.shape||{};var n=this.shape;for(var i in e)!n.hasOwnProperty(i)&&e.hasOwnProperty(i)&&(n[i]=e[i])}o.init&&o.init.call(this,t)}for(var e in w(t,br),o)"style"!==e&&"shape"!==e&&(t.prototype[e]=o[e]);return t},w(br,Xi);function Sr(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}var Mr=er.CMD,Ir=[[],[],[]],Tr=Math.sqrt,Ar=Math.atan2,Dr=function(t,e){for(var n,i,o,a,r=t.data,s=Mr.M,l=Mr.C,h=Mr.L,u=Mr.R,c=Mr.A,d=Mr.Q,p=0,g=0;p<r.length;){switch(n=r[p++],g=p,i=0,n){case s:case h:i=1;break;case l:i=3;break;case d:i=2;break;case c:var f=e[4],m=e[5],v=Tr(e[0]*e[0]+e[1]*e[1]),y=Tr(e[2]*e[2]+e[3]*e[3]),x=Ar(-e[1]/y,e[0]/v);r[p]*=v,r[p++]+=f,r[p]*=y,r[p++]+=m,r[p++]*=v,r[p++]*=y,r[p++]+=x,r[p++]+=x,g=p+=2;break;case u:a[0]=r[p++],a[1]=r[p++],bt(a,a,e),r[g++]=a[0],r[g++]=a[1],a[0]+=r[p++],a[1]+=r[p++],bt(a,a,e),r[g++]=a[0],r[g++]=a[1]}for(o=0;o<i;o++){(a=Ir[o])[0]=r[p++],a[1]=r[p++],bt(a,a,e),r[g++]=a[0],r[g++]=a[1]}}},Cr=Math.sqrt,Lr=Math.sin,kr=Math.cos,Pr=Math.PI,Nr=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(Sr(t)*Sr(e))},Or=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(Nr(t,e))};function Er(t,e,n,i,o,a,r,s,l,h,u){var c=l*(Pr/180),d=kr(c)*(t-n)/2+Lr(c)*(e-i)/2,p=-1*Lr(c)*(t-n)/2+kr(c)*(e-i)/2,g=d*d/(r*r)+p*p/(s*s);1<g&&(r*=Cr(g),s*=Cr(g));var f=(o===a?-1:1)*Cr((r*r*(s*s)-r*r*(p*p)-s*s*(d*d))/(r*r*(p*p)+s*s*(d*d)))||0,m=f*r*p/s,v=f*-s*d/r,y=(t+n)/2+kr(c)*m-Lr(c)*v,x=(e+i)/2+Lr(c)*m+kr(c)*v,_=Or([1,0],[(d-m)/r,(p-v)/s]),w=[(d-m)/r,(p-v)/s],b=[(-1*d-m)/r,(-1*p-v)/s],S=Or(w,b);Nr(w,b)<=-1&&(S=Pr),1<=Nr(w,b)&&(S=0),0===a&&0<S&&(S-=2*Pr),1===a&&S<0&&(S+=2*Pr),u.addData(h,y,x,r,s,_,S,c,a)}var zr=/([mlvhzcqtsa])([^mlvhzcqtsa]*)/gi,Rr=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;function Br(t,e){var n=function(t){if(!t)return new er;for(var e,n=0,i=0,o=n,a=i,r=new er,s=er.CMD,l=t.match(zr),h=0;h<l.length;h++){for(var u,c=l[h],d=c.charAt(0),p=c.match(Rr)||[],g=p.length,f=0;f<g;f++)p[f]=parseFloat(p[f]);for(var m=0;m<g;){var v,y,x,_,w,b,S,M=n,I=i;switch(d){case"l":n+=p[m++],i+=p[m++],u=s.L,r.addData(u,n,i);break;case"L":n=p[m++],i=p[m++],u=s.L,r.addData(u,n,i);break;case"m":n+=p[m++],i+=p[m++],u=s.M,r.addData(u,n,i),o=n,a=i,d="l";break;case"M":n=p[m++],i=p[m++],u=s.M,r.addData(u,n,i),o=n,a=i,d="L";break;case"h":n+=p[m++],u=s.L,r.addData(u,n,i);break;case"H":n=p[m++],u=s.L,r.addData(u,n,i);break;case"v":i+=p[m++],u=s.L,r.addData(u,n,i);break;case"V":i=p[m++],u=s.L,r.addData(u,n,i);break;case"C":u=s.C,r.addData(u,p[m++],p[m++],p[m++],p[m++],p[m++],p[m++]),n=p[m-2],i=p[m-1];break;case"c":u=s.C,r.addData(u,p[m++]+n,p[m++]+i,p[m++]+n,p[m++]+i,p[m++]+n,p[m++]+i),n+=p[m-2],i+=p[m-1];break;case"S":v=n,y=i;var T=r.len(),A=r.data;e===s.C&&(v+=n-A[T-4],y+=i-A[T-3]),u=s.C,M=p[m++],I=p[m++],n=p[m++],i=p[m++],r.addData(u,v,y,M,I,n,i);break;case"s":v=n,y=i;T=r.len(),A=r.data;e===s.C&&(v+=n-A[T-4],y+=i-A[T-3]),u=s.C,M=n+p[m++],I=i+p[m++],n+=p[m++],i+=p[m++],r.addData(u,v,y,M,I,n,i);break;case"Q":M=p[m++],I=p[m++],n=p[m++],i=p[m++],u=s.Q,r.addData(u,M,I,n,i);break;case"q":M=p[m++]+n,I=p[m++]+i,n+=p[m++],i+=p[m++],u=s.Q,r.addData(u,M,I,n,i);break;case"T":v=n,y=i;T=r.len(),A=r.data;e===s.Q&&(v+=n-A[T-4],y+=i-A[T-3]),n=p[m++],i=p[m++],u=s.Q,r.addData(u,v,y,n,i);break;case"t":v=n,y=i;T=r.len(),A=r.data;e===s.Q&&(v+=n-A[T-4],y+=i-A[T-3]),n+=p[m++],i+=p[m++],u=s.Q,r.addData(u,v,y,n,i);break;case"A":x=p[m++],_=p[m++],w=p[m++],b=p[m++],S=p[m++],Er(M=n,I=i,n=p[m++],i=p[m++],b,S,x,_,w,u=s.A,r);break;case"a":x=p[m++],_=p[m++],w=p[m++],b=p[m++],S=p[m++],Er(M=n,I=i,n+=p[m++],i+=p[m++],b,S,x,_,w,u=s.A,r)}}"z"!==d&&"Z"!==d||(u=s.Z,r.addData(u),n=o,i=a),e=u}return r.toStatic(),r}(t);return(e=e||{}).buildPath=function(t){var e;t.setData?(t.setData(n.data),(e=t.getContext())&&t.rebuildPath(e)):(e=t,n.rebuildPath(e))},e.applyTransform=function(t){Dr(n,t),this.dirty(!0)},e}function Vr(t,e){return new br(Br(t,e))}var Gr=function(t){Xi.call(this,t)};Gr.prototype={constructor:Gr,type:"text",brush:function(t,e){var n=this.style;this.__dirty&&Ci(n),n.fill=n.stroke=n.shadowBlur=n.shadowColor=n.shadowOffsetX=n.shadowOffsetY=null;var i=n.text;null!=i&&(i+=""),Hi(i,n)?(this.setTransform(t),ki(this,t,i,n,null,e),this.restoreTransform(t)):t.__attrCachedBy=Rn.NONE},getBoundingRect:function(){var t,e,n=this.style;return this.__dirty&&Ci(n),this._rect||(null!=n.text?0:0,(t=hi(n.text+"",n.font,n.textAlign,n.textVerticalAlign,n.textPadding,n.textLineHeight,n.rich)).x+=n.x||0,t.y+=n.y||0,Vi(n.textStroke,n.textStrokeWidth)&&(e=n.textStrokeWidth,t.x-=e/2,t.y-=e/2,t.width+=e,t.height+=e),this._rect=t),this._rect}},w(Gr,Xi);function Fr(l){return v.browser.ie&&11<=v.browser.version?function(){var t,e=this.__clipPaths,n=this.style;if(e)for(var i=0;i<e.length;i++){var o=e[i],a=o&&o.shape,r=o&&o.type;if(a&&("sector"===r&&a.startAngle===a.endAngle||"rect"===r&&(!a.width||!a.height))){for(var s=0;s<Hr.length;s++)Hr[s][2]=n[Hr[s][0]],n[Hr[s][0]]=Hr[s][1];t=!0;break}}if(l.apply(this,arguments),t)for(s=0;s<Hr.length;s++)n[Hr[s][0]]=Hr[s][2]}:l}var Wr=br.extend({type:"circle",shape:{cx:0,cy:0,r:0},buildPath:function(t,e,n){n&&t.moveTo(e.cx+e.r,e.cy),t.arc(e.cx,e.cy,e.r,0,2*Math.PI,!0)}}),Hr=[["shadowBlur",0],["shadowColor","#000"],["shadowOffsetX",0],["shadowOffsetY",0]],Zr=br.extend({type:"sector",shape:{cx:0,cy:0,r0:0,r:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0},brush:Fr(br.prototype.brush),buildPath:function(t,e){var n=e.cx,i=e.cy,o=Math.max(e.r0||0,0),a=Math.max(e.r,0),r=e.startAngle,s=e.endAngle,l=e.clockwise,h=Math.cos(r),u=Math.sin(r);t.moveTo(h*o+n,u*o+i),t.lineTo(h*a+n,u*a+i),t.arc(n,i,a,r,s,!l),t.lineTo(Math.cos(s)*o+n,Math.sin(s)*o+i),0!==o&&t.arc(n,i,o,s,r,l),t.closePath()}}),Ur=br.extend({type:"ring",shape:{cx:0,cy:0,r:0,r0:0},buildPath:function(t,e){var n=e.cx,i=e.cy,o=2*Math.PI;t.moveTo(n+e.r,i),t.arc(n,i,e.r,0,o,!1),t.moveTo(n+e.r0,i),t.arc(n,i,e.r0,0,o,!0)}});function Xr(t,e,n,i,o,a,r){var s=.5*(n-t),l=.5*(i-e);return(2*(e-n)+s+l)*r+(-3*(e-n)-2*s-l)*a+s*o+e}function Yr(t,e,n){var i=e.points,o=e.smooth;if(i&&2<=i.length){if(o&&"spline"!==o){var a=function(t,e,n,i){var o,a,r,s,l=[],h=[],u=[],c=[];if(i){r=[1/0,1/0],s=[-1/0,-1/0];for(var d=0,p=t.length;d<p;d++)St(r,r,t[d]),Mt(s,s,t[d]);St(r,r,i[0]),Mt(s,s,i[1])}for(d=0,p=t.length;d<p;d++){var g=t[d];if(n)o=t[d?d-1:p-1],a=t[(d+1)%p];else{if(0===d||d===p-1){l.push(lt(t[d]));continue}o=t[d-1],a=t[d+1]}dt(h,a,o),ft(h,h,e);var f=vt(g,o),m=vt(g,a),v=f+m;0!==v&&(f/=v,m/=v),ft(u,h,-f),ft(c,h,m);var y=ut([],g,u),x=ut([],g,c);i&&(Mt(y,y,r),St(y,y,s),Mt(x,x,r),St(x,x,s)),l.push(y),l.push(x)}return n&&l.push(l.shift()),l}(i,o,n,e.smoothConstraint);t.moveTo(i[0][0],i[0][1]);for(var r=i.length,s=0;s<(n?r:r-1);s++){var l=a[2*s],h=a[2*s+1],u=i[(s+1)%r];t.bezierCurveTo(l[0],l[1],h[0],h[1],u[0],u[1])}}else{"spline"===o&&(i=function(t,e){for(var n=t.length,i=[],o=0,a=1;a<n;a++)o+=vt(t[a-1],t[a]);for(var r=(r=o/2)<n?n:r,a=0;a<r;a++){var s,l,h=a/(r-1)*(e?n:n-1),u=Math.floor(h),c=h-u,d=t[u%n],p=e?(s=t[(u-1+n)%n],l=t[(u+1)%n],t[(u+2)%n]):(s=t[0===u?u:u-1],l=t[n-2<u?n-1:u+1],t[n-3<u?n-1:u+2]),g=c*c,f=c*g;i.push([Xr(s[0],d[0],l[0],p[0],c,g,f),Xr(s[1],d[1],l[1],p[1],c,g,f)])}return i}(i,n)),t.moveTo(i[0][0],i[0][1]);for(var s=1,c=i.length;s<c;s++)t.lineTo(i[s][0],i[s][1])}n&&t.closePath()}}var jr=br.extend({type:"polygon",shape:{points:null,smooth:!1,smoothConstraint:null},buildPath:function(t,e){Yr(t,e,!0)}}),qr=br.extend({type:"polyline",shape:{points:null,smooth:!1,smoothConstraint:null},style:{stroke:"#000",fill:null},buildPath:function(t,e){Yr(t,e,!1)}}),Kr=Math.round;function $r(t,e,n){var i,o,a,r,s=n&&n.lineWidth;e&&s&&(i=e.x1,o=e.x2,a=e.y1,r=e.y2,Kr(2*i)===Kr(2*o)?t.x1=t.x2=Qr(i,s,!0):(t.x1=i,t.x2=o),Kr(2*a)===Kr(2*r)?t.y1=t.y2=Qr(a,s,!0):(t.y1=a,t.y2=r))}function Jr(t,e,n){var i,o,a,r,s=n&&n.lineWidth;e&&s&&(i=e.x,o=e.y,a=e.width,r=e.height,t.x=Qr(i,s,!0),t.y=Qr(o,s,!0),t.width=Math.max(Qr(i+a,s,!1)-t.x,0===a?0:1),t.height=Math.max(Qr(o+r,s,!1)-t.y,0===r?0:1))}function Qr(t,e,n){var i=Kr(2*t);return(i+Kr(e))%2==0?i/2:(i+(n?1:-1))/2}var ts={},es=br.extend({type:"rect",shape:{r:0,x:0,y:0,width:0,height:0},buildPath:function(t,e){var n,i,o,a;this.subPixelOptimize?(Jr(ts,e,this.style),n=ts.x,i=ts.y,o=ts.width,a=ts.height,ts.r=e.r,e=ts):(n=e.x,i=e.y,o=e.width,a=e.height),e.r?bi(t,e):t.rect(n,i,o,a),t.closePath()}}),ns={},is=br.extend({type:"line",shape:{x1:0,y1:0,x2:0,y2:0,percent:1},style:{stroke:"#000",fill:null},buildPath:function(t,e){var n,i,o,a=this.subPixelOptimize?($r(ns,e,this.style),n=ns.x1,i=ns.y1,o=ns.x2,ns.y2):(n=e.x1,i=e.y1,o=e.x2,e.y2),r=e.percent;0!==r&&(t.moveTo(n,i),r<1&&(o=n*(1-r)+o*r,a=i*(1-r)+a*r),t.lineTo(o,a))},pointAt:function(t){var e=this.shape;return[e.x1*(1-t)+e.x2*t,e.y1*(1-t)+e.y2*t]}}),os=[];function as(t,e,n){var i=t.cpx2,o=t.cpy2;return null===i||null===o?[(n?ba:wa)(t.x1,t.cpx1,t.cpx2,t.x2,e),(n?ba:wa)(t.y1,t.cpy1,t.cpy2,t.y2,e)]:[(n?Ta:Ia)(t.x1,t.cpx1,t.x2,e),(n?Ta:Ia)(t.y1,t.cpy1,t.y2,e)]}function rs(t){this.colorStops=t||[]}var ss=br.extend({type:"bezier-curve",shape:{x1:0,y1:0,x2:0,y2:0,cpx1:0,cpy1:0,percent:1},style:{stroke:"#000",fill:null},buildPath:function(t,e){var n=e.x1,i=e.y1,o=e.x2,a=e.y2,r=e.cpx1,s=e.cpy1,l=e.cpx2,h=e.cpy2,u=e.percent;0!==u&&(t.moveTo(n,i),null==l||null==h?(u<1&&(Da(n,r,o,u,os),r=os[1],o=os[2],Da(i,s,a,u,os),s=os[1],a=os[2]),t.quadraticCurveTo(r,s,o,a)):(u<1&&(Ma(n,r,l,o,u,os),r=os[1],l=os[2],o=os[3],Ma(i,s,h,a,u,os),s=os[1],h=os[2],a=os[3]),t.bezierCurveTo(r,s,l,h,o,a)))},pointAt:function(t){return as(this.shape,t,!1)},tangentAt:function(t){var e=as(this.shape,t,!0);return mt(e,e)}}),ls=br.extend({type:"arc",shape:{cx:0,cy:0,r:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0},style:{stroke:"#000",fill:null},buildPath:function(t,e){var n=e.cx,i=e.cy,o=Math.max(e.r,0),a=e.startAngle,r=e.endAngle,s=e.clockwise,l=Math.cos(a),h=Math.sin(a);t.moveTo(l*o+n,h*o+i),t.arc(n,i,o,a,r,!s)}}),hs=br.extend({type:"compound",shape:{paths:null},_updatePathDirty:function(){for(var t=this.__dirtyPath,e=this.shape.paths,n=0;n<e.length;n++)t=t||e[n].__dirtyPath;this.__dirtyPath=t,this.__dirty=this.__dirty||t},beforeBrush:function(){this._updatePathDirty();for(var t=this.shape.paths||[],e=this.getGlobalScale(),n=0;n<t.length;n++)t[n].path||t[n].createPathProxy(),t[n].path.setScale(e[0],e[1],t[n].segmentIgnoreThreshold)},buildPath:function(t,e){for(var n=e.paths||[],i=0;i<n.length;i++)n[i].buildPath(t,n[i].shape,!0)},afterBrush:function(){for(var t=this.shape.paths||[],e=0;e<t.length;e++)t[e].__dirtyPath=!1},getBoundingRect:function(){return this._updatePathDirty(),br.prototype.getBoundingRect.call(this)}});rs.prototype={constructor:rs,addColorStop:function(t,e){this.colorStops.push({offset:t,color:e})}};function us(t,e,n,i,o,a){this.x=null==t?0:t,this.y=null==e?0:e,this.x2=null==n?1:n,this.y2=null==i?0:i,this.type="linear",this.global=a||!1,rs.call(this,o)}us.prototype={constructor:us},w(us,rs);function cs(t,e,n,i,o){this.x=null==t?.5:t,this.y=null==e?.5:e,this.r=null==n?.5:n,this.type="radial",this.global=o||!1,rs.call(this,i)}function ds(t){Xi.call(this,t),this._displayables=[],this._temporaryDisplayables=[],this._cursor=0,this.notClear=!0}cs.prototype={constructor:cs},w(cs,rs),ds.prototype.incremental=!0,ds.prototype.clearDisplaybles=function(){this._displayables=[],this._temporaryDisplayables=[],this._cursor=0,this.dirty(),this.notClear=!1},ds.prototype.addDisplayable=function(t,e){e?this._temporaryDisplayables.push(t):this._displayables.push(t),this.dirty()},ds.prototype.addDisplayables=function(t,e){e=e||!1;for(var n=0;n<t.length;n++)this.addDisplayable(t[n],e)},ds.prototype.eachPendingDisplayable=function(t){for(var e=this._cursor;e<this._displayables.length;e++)t&&t(this._displayables[e]);for(e=0;e<this._temporaryDisplayables.length;e++)t&&t(this._temporaryDisplayables[e])},ds.prototype.update=function(){this.updateTransform();for(var t=this._cursor;t<this._displayables.length;t++){(e=this._displayables[t]).parent=this,e.update(),e.parent=null}for(var e,t=0;t<this._temporaryDisplayables.length;t++){(e=this._temporaryDisplayables[t]).parent=this,e.update(),e.parent=null}},ds.prototype.brush=function(t,e){for(var n=this._cursor;n<this._displayables.length;n++){(i=this._displayables[n]).beforeBrush&&i.beforeBrush(t),i.brush(t,n===this._cursor?null:this._displayables[n-1]),i.afterBrush&&i.afterBrush(t)}this._cursor=n;for(var i,n=0;n<this._temporaryDisplayables.length;n++){(i=this._temporaryDisplayables[n]).beforeBrush&&i.beforeBrush(t),i.brush(t,0===n?null:this._temporaryDisplayables[n-1]),i.afterBrush&&i.afterBrush(t)}this._temporaryDisplayables=[],this.notClear=!0};var ps=[];ds.prototype.getBoundingRect=function(){if(!this._rect){for(var t=new Sn(1/0,1/0,-1/0,-1/0),e=0;e<this._displayables.length;e++){var n=this._displayables[e],i=n.getBoundingRect().clone();n.needLocalTransform()&&i.applyTransform(n.getLocalTransform(ps)),t.union(i)}this._rect=t}return this._rect},ds.prototype.contain=function(t,e){var n=this.transformCoordToLocal(t,e);if(this.getBoundingRect().contain(n[0],n[1]))for(var i=0;i<this._displayables.length;i++){if(this._displayables[i].contain(t,e))return!0}return!1},w(ds,Xi);var gs=Math.max,fs=Math.min,ms={},vs=1,ys={color:"textFill",textBorderColor:"textStroke",textBorderWidth:"textStrokeWidth"},xs="emphasis",_s="normal",ws=1,bs={},Ss={};function Ms(t){return br.extend(t)}function Is(t,e){Ss[t]=e}function Ts(t){if(Ss.hasOwnProperty(t))return Ss[t]}function As(t,e,n,i){var o=Vr(t,e);return n&&("center"===i&&(n=Cs(n,o.getBoundingRect())),ks(o,n)),o}function Ds(t,n,i){var o=new Yi({style:{image:t,x:n.x,y:n.y,width:n.width,height:n.height},onload:function(t){var e;"center"===i&&(e={width:t.width,height:t.height},o.setStyle(Cs(n,e)))}});return o}function Cs(t,e){var n=e.width/e.height,i=t.height*n,o=i<=t.width?t.height:(i=t.width)/n;return{x:t.x+t.width/2-i/2,y:t.y+t.height/2-o/2,width:i,height:o}}var Ls=function(t,e){for(var n=[],i=t.length,o=0;o<i;o++){var a=t[o];a.path||a.createPathProxy(),a.__dirtyPath&&a.buildPath(a.path,a.shape,!0),n.push(a.path)}var r=new br(e);return r.createPathProxy(),r.buildPath=function(t){t.appendPath(n);var e=t.getContext();e&&t.rebuildPath(e)},r};function ks(t,e){var n;t.applyTransform&&(n=t.getBoundingRect().calculateTransform(e),t.applyTransform(n))}var Ps=Qr;function Ns(t){return null!=t&&"none"!==t}var Os=et(),Es=0;function zs(t){var e,n,i,o,a=t.__hoverStl;a&&!t.__highlighted&&(e=t.__zr,n=t.useHoverLayer&&e&&"canvas"===e.painter.type,t.__highlighted=n?"layer":"plain",t.isGroup||!e&&t.useHoverLayer||(o=(i=t).style,n&&(o=(i=e.addHover(t)).style),il(o),n||function(t){if(t.__hoverStlDirty){t.__hoverStlDirty=!1;var e=t.__hoverStl;if(e){var n=t.__cachedNormalStl={};t.__cachedNormalZ2=t.z2;var i=t.style;for(var o in e)null!=e[o]&&(n[o]=i[o]);n.fill=i.fill,n.stroke=i.stroke}else t.__cachedNormalStl=t.__cachedNormalZ2=null}}(i),o.extendFrom(a),Rs(o,a,"fill"),Rs(o,a,"stroke"),nl(o),n||(t.dirty(!1),t.z2+=vs)))}function Rs(t,e,n){!Ns(e[n])&&Ns(t[n])&&(t[n]=function(t){if("string"!=typeof t)return t;var e=Os.get(t);return e||(e=Ve(t,-.1),Es<1e4&&(Os.set(t,e),Es++)),e}(t[n]))}function Bs(t){var e,n,i,o=t.__highlighted;o&&(t.__highlighted=!1,t.isGroup||("layer"===o?t.__zr&&t.__zr.removeHover(t):(e=t.style,(n=t.__cachedNormalStl)&&(il(e),t.setStyle(n),nl(e)),null!=(i=t.__cachedNormalZ2)&&t.z2-i===vs&&(t.z2=i))))}function Vs(t,e,n){var i,o=_s,a=_s;t.__highlighted&&(o=xs,i=!0),e(t,n),t.__highlighted&&(a=xs,i=!0),t.isGroup&&t.traverse(function(t){t.isGroup||e(t,n)}),i&&t.__highDownOnUpdate&&t.__highDownOnUpdate(o,a)}function Gs(t,e){e=t.__hoverStl=!1!==e&&(t.hoverStyle||e||{}),t.__hoverStlDirty=!0,t.__highlighted&&(t.__cachedNormalStl=null,Bs(t),zs(t))}function Fs(t){Us(this,t)||this.__highByOuter||Vs(this,zs)}function Ws(t){Us(this,t)||this.__highByOuter||Vs(this,Bs)}function Hs(t){this.__highByOuter|=1<<(t||0),Vs(this,zs)}function Zs(t){(this.__highByOuter&=~(1<<(t||0)))||Vs(this,Bs)}function Us(t,e){return t.__highDownSilentOnTouch&&e.zrByTouch}function Xs(t,e){Ys(t,!0),Vs(t,Gs,e)}function Ys(t,e){var n,i=!1===e;t.__highDownSilentOnTouch=t.highDownSilentOnTouch,t.__highDownOnUpdate=t.highDownOnUpdate,i&&!t.__highDownDispatcher||(t[n=i?"off":"on"]("mouseover",Fs)[n]("mouseout",Ws),t[n]("emphasis",Hs)[n]("normal",Zs),t.__highByOuter=t.__highByOuter||0,t.__highDownDispatcher=!i)}function js(t){return!(!t||!t.__highDownDispatcher)}function qs(t){var e=bs[t];return null==e&&ws<=32&&(e=bs[t]=ws++),e}function Ks(t,e,n,i,o,a,r){var s,l=(o=o||ms).labelFetcher,h=o.labelDataIndex,u=o.labelDimIndex,c=n.getShallow("show"),d=i.getShallow("show");(c||d)&&(l&&(s=l.getFormattedLabel(h,"normal",null,u)),null==s&&(s=A(o.defaultText)?o.defaultText(h,o):o.defaultText));var p=c?s:null,g=d?U(l?l.getFormattedLabel(h,"emphasis",null,u):null,s):null;null==p&&null==g||(Js(t,n,a,o),Js(e,i,r,o,!0)),t.text=p,e.text=g}function $s(t,e,n){var i=t.style;e&&(il(i),t.setStyle(e),nl(i)),i=t.__hoverStl,n&&i&&(il(i),k(i,n),nl(i))}function Js(t,e,n,i,o){return Qs(t,e,i,o),n&&k(t,n),t}function Qs(t,e,n,i){var o,a;(n=n||ms).isRectText&&(n.getTextPosition?o=n.getTextPosition(e,i):"outside"===(o=e.getShallow("position")||(i?null:"inside"))&&(o="top"),t.textPosition=o,t.textOffset=e.getShallow("offset"),null!=(a=e.getShallow("rotate"))&&(a*=Math.PI/180),t.textRotation=a,t.textDistance=U(e.getShallow("distance"),i?null:5));var r,s,l=e.ecModel,h=l&&l.option.textStyle,u=function(t){var e;for(;t&&t!==t.ecModel;){var n=(t.option||ms).rich;if(n)for(var i in e=e||{},n)n.hasOwnProperty(i)&&(e[i]=1);t=t.parentModel}return e}(e);if(u)for(var c in r={},u){u.hasOwnProperty(c)&&(s=e.getModel(["rich",c]),tl(r[c]={},s,h,n,i))}return t.rich=r,tl(t,e,h,n,i,!0),n.forceRich&&!n.textStyle&&(n.textStyle={}),t}function tl(t,e,n,i,o,a){n=!o&&n||ms,t.textFill=el(e.getShallow("color"),i)||n.color,t.textStroke=el(e.getShallow("textBorderColor"),i)||n.textBorderColor,t.textStrokeWidth=U(e.getShallow("textBorderWidth"),n.textBorderWidth),o||(a&&(t.insideRollbackOpt=i,nl(t)),null==t.textFill&&(t.textFill=i.autoColor)),t.fontStyle=e.getShallow("fontStyle")||n.fontStyle,t.fontWeight=e.getShallow("fontWeight")||n.fontWeight,t.fontSize=e.getShallow("fontSize")||n.fontSize,t.fontFamily=e.getShallow("fontFamily")||n.fontFamily,t.textAlign=e.getShallow("align"),t.textVerticalAlign=e.getShallow("verticalAlign")||e.getShallow("baseline"),t.textLineHeight=e.getShallow("lineHeight"),t.textWidth=e.getShallow("width"),t.textHeight=e.getShallow("height"),t.textTag=e.getShallow("tag"),a&&i.disableBox||(t.textBackgroundColor=el(e.getShallow("backgroundColor"),i),t.textPadding=e.getShallow("padding"),t.textBorderColor=el(e.getShallow("borderColor"),i),t.textBorderWidth=e.getShallow("borderWidth"),t.textBorderRadius=e.getShallow("borderRadius"),t.textBoxShadowColor=e.getShallow("shadowColor"),t.textBoxShadowBlur=e.getShallow("shadowBlur"),t.textBoxShadowOffsetX=e.getShallow("shadowOffsetX"),t.textBoxShadowOffsetY=e.getShallow("shadowOffsetY")),t.textShadowColor=e.getShallow("textShadowColor")||n.textShadowColor,t.textShadowBlur=e.getShallow("textShadowBlur")||n.textShadowBlur,t.textShadowOffsetX=e.getShallow("textShadowOffsetX")||n.textShadowOffsetX,t.textShadowOffsetY=e.getShallow("textShadowOffsetY")||n.textShadowOffsetY}function el(t,e){return"auto"!==t?t:e&&e.autoColor?e.autoColor:null}function nl(t){var e,n,i,o,a,r,s=t.textPosition,l=t.insideRollbackOpt;l&&null==t.textFill&&(n=l.autoColor,i=l.isRectText,r=!(a=!1!==(o=l.useInsideStyle)&&(!0===o||i&&s&&"string"==typeof s&&0<=s.indexOf("inside")))&&null!=n,(a||r)&&(e={textFill:t.textFill,textStroke:t.textStroke,textStrokeWidth:t.textStrokeWidth}),a&&(t.textFill="#fff",null==t.textStroke&&(t.textStroke=n,null==t.textStrokeWidth&&(t.textStrokeWidth=2))),r&&(t.textFill=n)),t.insideRollback=e}function il(t){var e=t.insideRollback;e&&(t.textFill=e.textFill,t.textStroke=e.textStroke,t.textStrokeWidth=e.textStrokeWidth,t.insideRollback=null)}function ol(t,e){var n=e&&e.getModel("textStyle");return K([t.fontStyle||n&&n.getShallow("fontStyle")||"",t.fontWeight||n&&n.getShallow("fontWeight")||"",(t.fontSize||n&&n.getShallow("fontSize")||12)+"px",t.fontFamily||n&&n.getShallow("fontFamily")||"sans-serif"].join(" "))}function al(t,e,n,i,o,a){var r,s,l,h;"function"==typeof o&&(a=o,o=null),i&&i.isAnimationEnabled()?(r=t?"Update":"",s=i.getShallow("animationDuration"+r),l=i.getShallow("animationEasing"+r),"function"==typeof(h=i.getShallow("animationDelay"+r))&&(h=h(o,i.getAnimationDelayParams?i.getAnimationDelayParams(e,o):null)),"function"==typeof s&&(s=s(o)),0<s?e.animateTo(n,s,h||0,l,a,!!a):(e.stopAnimation(),e.attr(n),a&&a())):(e.stopAnimation(),e.attr(n),a&&a())}function rl(t,e,n,i,o){al(!0,t,e,n,i,o)}function sl(t,e,n,i,o){al(!1,t,e,n,i,o)}function ll(t,e){for(var n=ne([]);t&&t!==e;)oe(n,t.getLocalTransform(),n),t=t.parent;return n}function hl(t,e,n){return e&&!O(e)&&(e=pe.getLocalTransform(e)),n&&(e=le([],e)),bt([],t,e)}function ul(t,e,n){var i=0===e[4]||0===e[5]||0===e[0]?1:Math.abs(2*e[4]/e[0]),o=0===e[4]||0===e[5]||0===e[2]?1:Math.abs(2*e[4]/e[2]),a=hl(a=["left"===t?-i:"right"===t?i:0,"top"===t?-o:"bottom"===t?o:0],e,n);return Math.abs(a[0])>Math.abs(a[1])?0<a[0]?"right":"left":0<a[1]?"bottom":"top"}function cl(t,e,i,n){var o,a;function r(t){var e={position:lt(t.position),rotation:t.rotation};return t.shape&&(e.shape=k({},t.shape)),e}t&&e&&(a={},t.traverse(function(t){!t.isGroup&&t.anid&&(a[t.anid]=t)}),o=a,e.traverse(function(t){var e,n;t.isGroup||!t.anid||(e=o[t.anid])&&(n=r(t),t.attr(r(e)),rl(t,n,i,t.dataIndex))}))}function dl(t,i){return N(t,function(t){var e=t[0],e=gs(e,i.x);e=fs(e,i.x+i.width);var n=t[1],n=gs(n,i.y);return[e,n=fs(n,i.y+i.height)]})}function pl(t,e,n){var i=(e=k({rectHover:!0},e)).style={strokeNoScale:!0};if(n=n||{x:-1,y:-1,width:2,height:2},t)return 0===t.indexOf("image://")?(i.image=t.slice(8),L(i,n),new Yi(e)):As(t.replace("path://",""),e,n,"center")}function gl(t,e,n,i,o){for(var a=0,r=o[o.length-1];a<o.length;a++){var s=o[a];if(fl(t,e,n,i,s[0],s[1],r[0],r[1]))return!0;r=s}}function fl(t,e,n,i,o,a,r,s){var l,h=n-t,u=i-e,c=r-o,d=s-a,p=c*u-h*d;if((l=p)<=1e-6&&-1e-6<=l)return!1;var g=t-o,f=e-a,m=(g*u-h*f)/p;if(m<0||1<m)return!1;var v=(g*d-c*f)/p;return!(v<0||1<v)}Is("circle",Wr),Is("sector",Zr),Is("ring",Ur),Is("polygon",jr),Is("polyline",qr),Is("rect",es),Is("line",is),Is("bezierCurve",ss),Is("arc",ls);var ml=(Object.freeze||Object)({Z2_EMPHASIS_LIFT:vs,CACHED_LABEL_STYLE_PROPERTIES:ys,extendShape:Ms,extendPath:function(t,e){return br.extend(Br(t,e))},registerShape:Is,getShapeClass:Ts,makePath:As,makeImage:Ds,mergePath:Ls,resizePath:ks,subPixelOptimizeLine:function(t){return $r(t.shape,t.shape,t.style),t},subPixelOptimizeRect:function(t){return Jr(t.shape,t.shape,t.style),t},subPixelOptimize:Ps,setElementHoverStyle:Gs,setHoverStyle:Xs,setAsHighDownDispatcher:Ys,isHighDownDispatcher:js,getHighlightDigit:qs,setLabelStyle:Ks,modifyLabelStyle:$s,setTextStyle:Js,setText:function(t,e,n){var i,o={isRectText:!0};!1===n?i=!0:o.autoColor=n,Qs(t,e,o,i)},getFont:ol,updateProps:rl,initProps:sl,getTransform:ll,applyTransform:hl,transformDirection:ul,groupTransition:cl,clipPointsByRect:dl,clipRectByRect:function(t,e){var n=gs(t.x,e.x),i=fs(t.x+t.width,e.x+e.width),o=gs(t.y,e.y),a=fs(t.y+t.height,e.y+e.height);if(n<=i&&o<=a)return{x:n,y:o,width:i-n,height:a-o}},createIcon:pl,linePolygonIntersect:gl,lineLineIntersect:fl,Group:Mn,Image:Yi,Text:Gr,Circle:Wr,Sector:Zr,Ring:Ur,Polygon:jr,Polyline:qr,Rect:es,Line:is,BezierCurve:ss,Arc:ls,IncrementalDisplayable:ds,CompoundPath:hs,LinearGradient:us,RadialGradient:cs,BoundingRect:Sn}),vl=["textStyle","color"],yl={getTextColor:function(t){var e=this.ecModel;return this.getShallow("color")||(!t&&e?e.get(vl):null)},getFont:function(){return ol({fontStyle:this.getShallow("fontStyle"),fontWeight:this.getShallow("fontWeight"),fontSize:this.getShallow("fontSize"),fontFamily:this.getShallow("fontFamily")},this.ecModel)},getTextRect:function(t){return hi(t,this.getFont(),this.getShallow("align"),this.getShallow("verticalAlign")||this.getShallow("baseline"),this.getShallow("padding"),this.getShallow("lineHeight"),this.getShallow("rich"),this.getShallow("truncateText"))}},xl=aa([["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["textPosition"],["textAlign"]]),_l={getItemStyle:function(t,e){var n=xl(this,t,e),i=this.getBorderLineDash();return i&&(n.lineDash=i),n},getBorderLineDash:function(){var t=this.get("borderType");return"solid"===t||null==t?null:"dashed"===t?[5,5]:[1,1]}},wl=b,bl=Ho();function Sl(t,e,n){this.parentModel=e,this.ecModel=n,this.option=t}function Ml(t,e,n){for(var i=0;i<e.length&&(!e[i]||null!=(t=t&&"object"==typeof t?t[e[i]]:null));i++);return null==t&&n&&(t=n.get(e)),t}function Il(t,e){var n=bl(t).getParent;return n?n.call(t,e):t.parentModel}Sl.prototype={constructor:Sl,init:null,mergeOption:function(t){m(this.option,t,!0)},get:function(t,e){return null==t?this.option:Ml(this.option,this.parsePath(t),!e&&Il(this,t))},getShallow:function(t,e){var n=this.option,i=null==n?n:n[t],o=!e&&Il(this,t);return null==i&&o&&(i=o.getShallow(t)),i},getModel:function(t,e){var n;return new Sl(null==t?this.option:Ml(this.option,t=this.parsePath(t)),e=e||(n=Il(this,t))&&n.getModel(t),this.ecModel)},isEmpty:function(){return null==this.option},restoreData:function(){},clone:function(){return new this.constructor(C(this.option))},setReadOnly:function(t){},parsePath:function(t){return"string"==typeof t&&(t=t.split(".")),t},customizeGetParent:function(t){bl(this).getParent=t},isAnimationEnabled:function(){if(!v.node){if(null!=this.option.animation)return!!this.option.animation;if(this.parentModel)return this.parentModel.isAnimationEnabled()}}},Qo(Sl),ea(Sl),wl(Sl,sa),wl(Sl,ha),wl(Sl,yl),wl(Sl,_l);var Tl=0;function Al(t){return[t||"",Tl++,Math.random().toFixed(5)].join("_")}var Dl=1e-4;function Cl(t,e,n,i){var o=e[1]-e[0],a=n[1]-n[0];if(0==o)return 0==a?n[0]:(n[0]+n[1])/2;if(i)if(0<o){if(t<=e[0])return n[0];if(t>=e[1])return n[1]}else{if(t>=e[0])return n[0];if(t<=e[1])return n[1]}else{if(t===e[0])return n[0];if(t===e[1])return n[1]}return(t-e[0])/o*a+n[0]}function Ll(t,e){switch(t){case"center":case"middle":t="50%";break;case"left":case"top":t="0%";break;case"right":case"bottom":t="100%"}return"string"==typeof t?t.replace(/^\s+|\s+$/g,"").match(/%$/)?parseFloat(t)/100*e:parseFloat(t):null==t?NaN:+t}function kl(t,e,n){return null==e&&(e=10),e=Math.min(Math.max(0,e),20),t=(+t).toFixed(e),n?t:+t}function Pl(t){return t.sort(function(t,e){return t-e}),t}function Nl(t){if(t=+t,isNaN(t))return 0;for(var e=1,n=0;Math.round(t*e)/e!==t;)e*=10,n++;return n}function Ol(t){var e=t.toString(),n=e.indexOf("e");if(0<n){var i=+e.slice(n+1);return i<0?-i:0}var o=e.indexOf(".");return o<0?0:e.length-1-o}function El(t,e){var n=Math.log,i=Math.LN10,o=Math.floor(n(t[1]-t[0])/i),a=Math.round(n(Math.abs(e[1]-e[0]))/i),r=Math.min(Math.max(-o+a,0),20);return isFinite(r)?r:20}function zl(t,e,n){if(!t[e])return 0;var i=S(t,function(t,e){return t+(isNaN(e)?0:e)},0);if(0===i)return 0;for(var o=Math.pow(10,n),a=N(t,function(t){return(isNaN(t)?0:t)/i*o*100}),r=100*o,s=N(a,function(t){return Math.floor(t)}),l=S(s,function(t,e){return t+e},0),h=N(a,function(t,e){return t-s[e]});l<r;){for(var u=Number.NEGATIVE_INFINITY,c=null,d=0,p=h.length;d<p;++d)h[d]>u&&(u=h[d],c=d);++s[c],h[c]=0,++l}return s[e]/o}var Rl=9007199254740991;function Bl(t){var e=2*Math.PI;return(t%e+e)%e}function Vl(t){return-Dl<t&&t<Dl}var Gl=/^(?:(\d{4})(?:[-\/](\d{1,2})(?:[-\/](\d{1,2})(?:[T ](\d{1,2})(?::(\d\d)(?::(\d\d)(?:[.,](\d+))?)?)?(Z|[\+\-]\d\d:?\d\d)?)?)?)?)?$/;function Fl(t){if(t instanceof Date)return t;if("string"!=typeof t)return null==t?new Date(NaN):new Date(Math.round(t));var e=Gl.exec(t);if(!e)return new Date(NaN);if(e[8]){var n=+e[4]||0;return"Z"!==e[8].toUpperCase()&&(n-=e[8].slice(0,3)),new Date(Date.UTC(+e[1],(e[2]||1)-1,+e[3]||1,n,+(e[5]||0),+e[6]||0,+e[7]||0))}return new Date(+e[1],(e[2]||1)-1,+e[3]||1,+e[4]||0,+(e[5]||0),+e[6]||0,+e[7]||0)}function Wl(t){return Math.pow(10,Hl(t))}function Hl(t){if(0===t)return 0;var e=Math.floor(Math.log(t)/Math.LN10);return 10<=t/Math.pow(10,e)&&e++,e}function Zl(t,e){var n=Hl(t),i=Math.pow(10,n),o=t/i,a=e?o<1.5?1:o<2.5?2:o<4?3:o<7?5:10:o<1?1:o<2?2:o<3?3:o<5?5:10;return t=a*i,-20<=n?+t.toFixed(n<0?-n:0):t}function Ul(t){t.sort(function(t,e){return function t(e,n,i){return e.interval[i]<n.interval[i]||e.interval[i]===n.interval[i]&&(e.close[i]-n.close[i]==(i?-1:1)||!i&&t(e,n,1))}(t,e,0)?-1:1});for(var e=-1/0,n=1,i=0;i<t.length;){for(var o=t[i].interval,a=t[i].close,r=0;r<2;r++)o[r]<=e&&(o[r]=e,a[r]=r?1:1-n),e=o[r],n=a[r];o[0]===o[1]&&a[0]*a[1]!=1?t.splice(i,1):i++}return t}function Xl(t){return 0<=t-parseFloat(t)}var Yl=(Object.freeze||Object)({linearMap:Cl,parsePercent:Ll,round:kl,asc:Pl,getPrecision:Nl,getPrecisionSafe:Ol,getPixelPrecision:El,getPercentWithPrecision:zl,MAX_SAFE_INTEGER:Rl,remRadian:Bl,isRadianAroundZero:Vl,parseDate:Fl,quantity:Wl,quantityExponent:Hl,nice:Zl,quantile:function(t,e){var n=(t.length-1)*e+1,i=Math.floor(n),o=+t[i-1],a=n-i;return a?o+a*(t[i]-o):o},reformIntervals:Ul,isNumeric:Xl});function jl(t){return isNaN(t)?"-":(t=(t+"").split("."))[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g,"$1,")+(1<t.length?"."+t[1]:"")}function ql(t,e){return t=(t||"").toLowerCase().replace(/-(.)/g,function(t,e){return e.toUpperCase()}),e&&t&&(t=t.charAt(0).toUpperCase()+t.slice(1)),t}var Kl=j,$l=/([&<>"'])/g,Jl={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Ql(t){return null==t?"":(t+"").replace($l,function(t,e){return Jl[e]})}function th(t,e){return"{"+t+(null==e?"":e)+"}"}var eh=["a","b","c","d","e","f","g"];function nh(t,e,n){R(e)||(e=[e]);var i=e.length;if(!i)return"";for(var o=e[0].$vars||[],a=0;a<o.length;a++){var r=eh[a];t=t.replace(th(r),th(r,0))}for(var s=0;s<i;s++)for(var l=0;l<o.length;l++){var h=e[s][o[l]];t=t.replace(th(eh[l],s),n?Ql(h):h)}return t}function ih(n,t,i){return P(t,function(t,e){n=n.replace("{"+e+"}",i?Ql(t):t)}),n}function oh(t,e){var n=(t=B(t)?{color:t,extraCssText:e}:t||{}).color,i=t.type,e=t.extraCssText,o=t.renderMode||"html",a=t.markerId||"X";return n?"html"===o?"subItem"===i?'<span style="display:inline-block;vertical-align:middle;margin-right:8px;margin-left:3px;border-radius:4px;width:4px;height:4px;background-color:'+Ql(n)+";"+(e||"")+'"></span>':'<span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:'+Ql(n)+";"+(e||"")+'"></span>':{renderMode:o,content:"{marker"+a+"|}  ",style:{color:n}}:""}function ah(t,e){return"0000".substr(0,e-(t+="").length)+t}function rh(t,e,n){"week"!==t&&"month"!==t&&"quarter"!==t&&"half-year"!==t&&"year"!==t||(t="MM-dd\nyyyy");var i=Fl(e),o=n?"UTC":"",a=i["get"+o+"FullYear"](),r=i["get"+o+"Month"]()+1,s=i["get"+o+"Date"](),l=i["get"+o+"Hours"](),h=i["get"+o+"Minutes"](),u=i["get"+o+"Seconds"](),c=i["get"+o+"Milliseconds"]();return t=t.replace("MM",ah(r,2)).replace("M",r).replace("yyyy",a).replace("yy",a%100).replace("dd",ah(s,2)).replace("d",s).replace("hh",ah(l,2)).replace("h",l).replace("mm",ah(h,2)).replace("m",h).replace("ss",ah(u,2)).replace("s",u).replace("SSS",ah(c,3))}function sh(t){return t?t.charAt(0).toUpperCase()+t.substr(1):t}var lh=pi;var hh=(Object.freeze||Object)({addCommas:jl,toCamelCase:ql,normalizeCssArray:Kl,encodeHTML:Ql,formatTpl:nh,formatTplSimple:ih,getTooltipMarker:oh,formatTime:rh,capitalFirst:sh,truncateText:lh,getTextBoundingRect:function(t){return hi(t.text,t.font,t.textAlign,t.textVerticalAlign,t.textPadding,t.textLineHeight,t.rich,t.truncate)},getTextRect:function(t,e,n,i,o,a,r,s){return hi(t,e,n,i,o,s,a,r)}}),uh=P,ch=["left","right","top","bottom","width","height"],dh=[["width","left","right"],["height","top","bottom"]];function ph(u,c,d,p,g){var f=0,m=0;null==p&&(p=1/0),null==g&&(g=1/0);var v=0;c.eachChild(function(t,e){var n,i,o,a,r=t.position,s=t.getBoundingRect(),l=c.childAt(e+1),h=l&&l.getBoundingRect();v="horizontal"===u?(n=s.width+(h?-h.x+s.x:0),p<(i=f+n)||t.newline?(f=0,i=n,m+=v+d,s.height):Math.max(v,s.height)):(o=s.height+(h?-h.y+s.y:0),g<(a=m+o)||t.newline?(f+=v+d,m=0,a=o,s.width):Math.max(v,s.width)),t.newline||(r[0]=f,r[1]=m,"horizontal"===u?f=i+d:m=a+d)})}var gh=ph;z(ph,"vertical"),z(ph,"horizontal");function fh(t,e,n){n=Kl(n||0);var i=e.width,o=e.height,a=Ll(t.left,i),r=Ll(t.top,o),s=Ll(t.right,i),l=Ll(t.bottom,o),h=Ll(t.width,i),u=Ll(t.height,o),c=n[2]+n[0],d=n[1]+n[3],p=t.aspect;switch(isNaN(h)&&(h=i-s-d-a),isNaN(u)&&(u=o-l-c-r),null!=p&&(isNaN(h)&&isNaN(u)&&(i/o<p?h=.8*i:u=.8*o),isNaN(h)&&(h=p*u),isNaN(u)&&(u=h/p)),isNaN(a)&&(a=i-s-h-d),isNaN(r)&&(r=o-l-u-c),t.left||t.right){case"center":a=i/2-h/2-n[3];break;case"right":a=i-h-d}switch(t.top||t.bottom){case"middle":case"center":r=o/2-u/2-n[0];break;case"bottom":r=o-u-c}a=a||0,r=r||0,isNaN(h)&&(h=i-d-a-(s||0)),isNaN(u)&&(u=o-c-r-(l||0));var g=new Sn(a+n[3],r+n[0],h,u);return g.margin=n,g}function mh(t,e,n,i,o){var a,r,s,l,h,u=!o||!o.hv||o.hv[0],c=!o||!o.hv||o.hv[1],d=o&&o.boundingMode||"all";(u||c)&&("raw"===d?r="group"===t.type?new Sn(0,0,+e.width||0,+e.height||0):t.getBoundingRect():(r=t.getBoundingRect(),t.needLocalTransform()&&(a=t.getLocalTransform(),(r=r.clone()).applyTransform(a))),e=fh(L({width:r.width,height:r.height},e),n,i),s=t.position,l=u?e.x-r.x:0,h=c?e.y-r.y:0,t.attr("position","raw"===d?[l,h]:[s[0]+l,s[1]+h]))}function vh(l,h,t){V(t)||(t={});var u=t.ignoreSize;R(u)||(u=[u,u]);var e=i(dh[0],0),n=i(dh[1],1);function i(t,e){var n={},i=0,o={},a=0;if(uh(t,function(t){o[t]=l[t]}),uh(t,function(t){c(h,t)&&(n[t]=o[t]=h[t]),d(n,t)&&i++,d(o,t)&&a++}),u[e])return d(h,t[1])?o[t[2]]=null:d(h,t[2])&&(o[t[1]]=null),o;if(2!==a&&i){if(2<=i)return n;for(var r=0;r<t.length;r++){var s=t[r];if(!c(n,s)&&c(l,s)){n[s]=l[s];break}}return n}return o}function c(t,e){return t.hasOwnProperty(e)}function d(t,e){return null!=t[e]&&"auto"!==t[e]}function o(t,e,n){uh(t,function(t){e[t]=n[t]})}o(dh[0],l,e),o(dh[1],l,n)}function yh(t){return xh({},t)}function xh(e,n){return n&&e&&uh(ch,function(t){n.hasOwnProperty(t)&&(e[t]=n[t])}),e}var _h,wh,bh,Sh=Ho(),Mh=Sl.extend({type:"component",id:"",name:"",mainType:"",subType:"",componentIndex:0,defaultOption:null,ecModel:null,dependentModels:[],uid:null,layoutMode:null,$constructor:function(t,e,n,i){Sl.call(this,t,e,n,i),this.uid=Al("ec_cpt_model")},init:function(t,e,n,i){this.mergeDefaultAndTheme(t,n)},mergeDefaultAndTheme:function(t,e){var n=this.layoutMode,i=n?yh(t):{};m(t,e.getTheme().get(this.mainType)),m(t,this.getDefaultOption()),n&&vh(t,i,n)},mergeOption:function(t,e){m(this.option,t,!0);var n=this.layoutMode;n&&vh(this.option,t,n)},optionUpdated:function(t,e){},getDefaultOption:function(){var t=Sh(this);if(!t.defaultOption){for(var e=[],n=this.constructor;n;){var i=n.prototype.defaultOption;i&&e.push(i),n=n.superClass}for(var o={},a=e.length-1;0<=a;a--)o=m(o,e[a],!0);t.defaultOption=o}return t.defaultOption},getReferringComponents:function(t){return this.ecModel.queryComponents({mainType:t,index:this.get(t+"Index",!0),id:this.get(t+"Id",!0)})}});function Ih(t,e){return t[e]||(t[e]={predecessor:[],successor:[]}),t[e]}oa(Mh,{registerWhenExtend:!0}),wh={},(_h=Mh).registerSubTypeDefaulter=function(t,e){t=Jo(t),wh[t.main]=e},_h.determineSubType=function(t,e){var n,i=e.type;return i||(n=Jo(t).main,_h.hasSubTypes(t)&&wh[n]&&(i=wh[n](e))),i},bh=function(t){var e=[];P(Mh.getClassesByMainType(t),function(t){e=e.concat(t.prototype.dependencies||[])}),e=N(e,function(t){return Jo(t).main}),"dataset"!==t&&M(e,"dataset")<=0&&e.unshift("dataset");return e},Mh.topologicalTravel=function(t,e,n,i){if(t.length){var r,s,l,o=(s={},l=[],P(r=e,function(n){var e,i,o=Ih(s,n),t=o.originalDeps=bh(n),a=(e=r,i=[],P(t,function(t){0<=M(e,t)&&i.push(t)}),i);o.entryCount=a.length,0===o.entryCount&&l.push(n),P(a,function(t){M(o.predecessor,t)<0&&o.predecessor.push(t);var e=Ih(s,t);M(e.successor,t)<0&&e.successor.push(n)})}),{graph:s,noEntryList:l}),a=o.graph,h=o.noEntryList,u={};for(P(t,function(t){u[t]=!0});h.length;){var c=h.pop(),d=a[c],p=!!u[c];p&&(n.call(i,c,d.originalDeps.slice()),delete u[c]),P(d.successor,p?f:g)}P(u,function(){throw new Error("Circle dependency may exists")})}function g(t){a[t].entryCount--,0===a[t].entryCount&&h.push(t)}function f(t){u[t]=!0,g(t)}},b(Mh,{getBoxLayoutParams:function(){return{left:this.get("left"),top:this.get("top"),right:this.get("right"),bottom:this.get("bottom"),width:this.get("width"),height:this.get("height")}}});var Th="";"undefined"!=typeof navigator&&(Th=navigator.platform||"");var Ah={color:["#c23531","#2f4554","#61a0a8","#d48265","#91c7ae","#749f83","#ca8622","#bda29a","#6e7074","#546570","#c4ccd3"],gradientColor:["#f6efa6","#d88273","#bf444c"],textStyle:{fontFamily:Th.match(/^Win/)?"Microsoft YaHei":"sans-serif",fontSize:12,fontStyle:"normal",fontWeight:"normal"},blendMode:null,animation:"auto",animationDuration:1e3,animationDurationUpdate:300,animationEasing:"exponentialOut",animationEasingUpdate:"cubicOut",animationThreshold:2e3,progressiveThreshold:3e3,progressive:400,hoverLayerThreshold:3e3,useUTC:!1},Dh=Ho();var Ch={clearColorPalette:function(){Dh(this).colorIdx=0,Dh(this).colorNameMap={}},getColorFromPalette:function(t,e,n){var i=Dh(e=e||this),o=i.colorIdx||0,a=i.colorNameMap=i.colorNameMap||{};if(a.hasOwnProperty(t))return a[t];var r=Oo(this.get("color",!0)),s=this.get("colorLayer",!0),l=null!=n&&s?function(t,e){for(var n=t.length,i=0;i<n;i++)if(t[i].length>e)return t[i];return t[n-1]}(s,n):r;if((l=l||r)&&l.length){var h=l[o];return t&&(a[t]=h),i.colorIdx=(o+1)%l.length,h}}},Lh="original",kh="arrayRows",Ph="objectRows",Nh="keyedColumns",Oh="unknown",Eh="typedArray",zh="column",Rh="row";function Bh(t){this.fromDataset=t.fromDataset,this.data=t.data||(t.sourceFormat===Nh?{}:[]),this.sourceFormat=t.sourceFormat||Oh,this.seriesLayoutBy=t.seriesLayoutBy||zh,this.dimensionsDefine=t.dimensionsDefine,this.encodeDefine=t.encodeDefine&&et(t.encodeDefine),this.startIndex=t.startIndex||0,this.dimensionsDetectCount=t.dimensionsDetectCount}Bh.seriesDataToSource=function(t){return new Bh({data:t,sourceFormat:F(t)?Eh:Lh,fromDataset:!1})},ea(Bh);var Vh={Must:1,Might:2,Not:3},Gh=Ho();function Fh(t){var e,n=t.option,i=n.data,o=F(i)?Eh:Lh,a=!1,r=n.seriesLayoutBy,s=n.sourceHeader,l=n.dimensions,h=Xh(t);h&&(i=(e=h.option).source,o=Gh(h).sourceFormat,a=!0,r=r||e.seriesLayoutBy,null==s&&(s=e.sourceHeader),l=l||e.dimensions);var u=function(t,e,n,i,o){if(!t)return{dimensionsDefine:Wh(o)};var a,r;{var s;e===kh?("auto"===i||null==i?Hh(function(t){null!=t&&"-"!==t&&(B(t)?null==r&&(r=1):r=0)},n,t,10):r=i?1:0,o||1!==r||(o=[],Hh(function(t,e){o[e]=null!=t?t:""},n,t)),a=o?o.length:n===Rh?t.length:t[0]?t[0].length:null):e===Ph?o=o||function(t){var e,n=0;for(;n<t.length&&!(e=t[n++]););if(e){var i=[];return P(e,function(t,e){i.push(e)}),i}}(t):e===Nh?o||(o=[],P(t,function(t,e){o.push(e)})):e===Lh?(s=Ro(t[0]),a=R(s)&&s.length||1):e===Eh&&D&&q(!!o,"dimensions must be given if data is TypedArray.")}return{startIndex:r,dimensionsDefine:Wh(o),dimensionsDetectCount:a}}(i,o,r,s,l);Gh(t).source=new Bh({data:i,fromDataset:a,seriesLayoutBy:r,sourceFormat:o,dimensionsDefine:u.dimensionsDefine,startIndex:u.startIndex,dimensionsDetectCount:u.dimensionsDetectCount,encodeDefine:n.encode})}function Wh(t){if(t){var i=et();return N(t,function(t,e){if(null==(t=k({},V(t)?t:{name:t})).name)return t;t.name+="",null==t.displayName&&(t.displayName=t.name);var n=i.get(t.name);return n?t.name+="-"+n.count++:i.set(t.name,{count:1}),t})}}function Hh(t,e,n,i){if(null==i&&(i=1/0),e===Rh)for(var o=0;o<n.length&&o<i;o++)t(n[o]?n[o][0]:null,o);else for(var a=n[0]||[],o=0;o<a.length&&o<i;o++)t(a[o],o)}function Zh(n,t,e){var a={},i=Xh(t);if(!i||!n)return a;var r,o,s=[],l=[],h=t.ecModel,u=Gh(h).datasetMap,c=i.uid+"_"+e.seriesLayoutBy;P(n=n.slice(),function(t,e){V(t)||(n[e]={name:t}),"ordinal"===t.type&&null==r&&(o=g(n[r=e])),a[t.name]=[]});var d=u.get(c)||u.set(c,{categoryWayDim:o,valueWayDim:0});function p(t,e,n){for(var i=0;i<n;i++)t.push(e+i)}function g(t){var e=t.dimsDef;return e?e.length:1}return P(n,function(t,e){var n,i=t.name,o=g(t);null==r?(n=d.valueWayDim,p(a[i],n,o),p(l,n,o),d.valueWayDim+=o):r===e?(p(a[i],0,o),p(s,0,o)):(n=d.categoryWayDim,p(a[i],n,o),p(l,n,o),d.categoryWayDim+=o)}),s.length&&(a.itemName=s),l.length&&(a.seriesName=l),a}function Uh(t,l,h){var e={};if(!Xh(t))return e;var u,c=l.sourceFormat,d=l.dimensionsDefine;c!==Ph&&c!==Nh||P(d,function(t,e){"name"===(V(t)?t.name:t)&&(u=e)});var n,i=function(){for(var t={},e={},n=[],i=0,o=Math.min(5,h);i<o;i++){var a=Yh(l.data,c,l.seriesLayoutBy,d,l.startIndex,i);n.push(a);var r=a===Vh.Not;if(r&&null==t.v&&i!==u&&(t.v=i),null!=t.n&&t.n!==t.v&&(r||n[t.n]!==Vh.Not)||(t.n=i),s(t)&&n[t.n]!==Vh.Not)return t;r||(a===Vh.Might&&null==e.v&&i!==u&&(e.v=i),null!=e.n&&e.n!==e.v||(e.n=i))}function s(t){return null!=t.v&&null!=t.n}return s(t)?t:s(e)?e:null}();return i&&(e.value=i.v,n=null!=u?u:i.n,e.itemName=[n],e.seriesName=[n]),e}function Xh(t){var e=t.option;if(!e.data)return t.ecModel.getComponent("dataset",e.datasetIndex||0)}function Yh(t,e,n,i,o,a){var r,s,l,h;if(F(t))return Vh.Not;if(i&&(V(h=i[a])?(s=h.name,l=h.type):B(h)&&(s=h)),null!=l)return"ordinal"===l?Vh.Must:Vh.Not;if(e===kh)if(n===Rh){for(var u=t[a],c=0;c<(u||[]).length&&c<5;c++)if(null!=(r=f(u[o+c])))return r}else for(c=0;c<t.length&&c<5;c++){var d=t[o+c];if(d&&null!=(r=f(d[a])))return r}else if(e===Ph){if(!s)return Vh.Not;for(c=0;c<t.length&&c<5;c++){if((p=t[c])&&null!=(r=f(p[s])))return r}}else if(e===Nh){if(!s)return Vh.Not;if(!(u=t[s])||F(u))return Vh.Not;for(c=0;c<u.length&&c<5;c++)if(null!=(r=f(u[c])))return r}else if(e===Lh)for(c=0;c<t.length&&c<5;c++){var p,g=Ro(p=t[c]);if(!R(g))return Vh.Not;if(null!=(r=f(g[a])))return r}function f(t){var e=B(t);return null!=t&&isFinite(t)&&""!==t?e?Vh.Might:Vh.Not:e&&"-"!==t?Vh.Must:void 0}return Vh.Not}var jh="\0_ec_inner",qh=Sl.extend({init:function(t,e,n,i){n=n||{},this.option=null,this._theme=new Sl(n),this._optionManager=i},setOption:function(t,e){q(!(jh in t),"please use chart.getOption()"),this._optionManager.setOption(t,e),this.resetOption(null)},resetOption:function(t){var e,n,i,o=!1,a=this._optionManager;return t&&"recreate"!==t||(e=a.mountOption("recreate"===t),this.option&&"recreate"!==t?(this.restoreData(),this.mergeOption(e)):function(t){t=t,this.option={},this.option[jh]=1,this._componentsMap=et({series:[]}),this._seriesIndices,this._seriesIndicesMap,function(n,t){var i=n.color&&!n.colorLayer;P(t,function(t,e){"colorLayer"===e&&i||Mh.hasClass(e)||("object"==typeof t?n[e]=n[e]?m(n[e],t,!1):C(t):null==n[e]&&(n[e]=t))})}(t,this._theme.option),m(t,Ah,!1),this.mergeOption(t)}.call(this,e),o=!0),"timeline"!==t&&"media"!==t||this.restoreData(),t&&"recreate"!==t&&"timeline"!==t||(n=a.getTimelineOption(this))&&(this.mergeOption(n),o=!0),t&&"recreate"!==t&&"media"!==t||(i=a.getMediaOption(this,this._api)).length&&P(i,function(t){this.mergeOption(t,o=!0)},this),o},mergeOption:function(i){var l=this.option,h=this._componentsMap,n=[];Gh(this).datasetMap=et(),P(i,function(t,e){null!=t&&(Mh.hasClass(e)?e&&n.push(e):l[e]=null==l[e]?C(t):m(l[e],t,!0))}),Mh.topologicalTravel(n,Mh.getAllClassMainTypes(),function(r,t){var e=Oo(i[r]),n=Bo(h.get(r),e);Vo(n),P(n,function(t,e){var n,i,o,a=t.option;V(a)&&(t.keyInfo.mainType=r,t.keyInfo.subType=(n=r,i=a,o=t.exist,i.type?i.type:o?o.subType:Mh.determineSubType(n,i)))});var s=function(e,t){R(t)||(t=t?[t]:[]);var n={};return P(t,function(t){n[t]=(e.get(t)||[]).slice()}),n}(h,t);l[r]=[],h.set(r,[]),P(n,function(t,e){var n,i,o=t.exist,a=t.option;q(V(a)||o,"Empty component definition"),a?(n=Mh.getClass(r,t.keyInfo.subType,!0),o&&o.constructor===n?(o.name=t.keyInfo.name,o.mergeOption(a,this),o.optionUpdated(a,!1)):(i=k({dependentModels:s,componentIndex:e},t.keyInfo),k(o=new n(a,this,this,i),i),o.init(a,this,this,i),o.optionUpdated(null,!0))):(o.mergeOption({},this),o.optionUpdated({},!1)),h.get(r)[e]=o,l[r][e]=o.option},this),"series"===r&&Kh(this,h.get("series"))},this),this._seriesIndicesMap=et(this._seriesIndices=this._seriesIndices||[])},getOption:function(){var i=C(this.option);return P(i,function(t,e){if(Mh.hasClass(e)){for(var n=(t=Oo(t)).length-1;0<=n;n--)Fo(t[n])&&t.splice(n,1);i[e]=t}}),delete i[jh],i},getTheme:function(){return this._theme},getComponent:function(t,e){var n=this._componentsMap.get(t);if(n)return n[e||0]},queryComponents:function(t){var e=t.mainType;if(!e)return[];var n,i,o=t.index,a=t.id,r=t.name,s=this._componentsMap.get(e);return s&&s.length?$h(null!=o?(R(o)||(o=[o]),I(N(o,function(t){return s[t]}),function(t){return!!t})):null!=a?(n=R(a),I(s,function(t){return n&&0<=M(a,t.id)||!n&&t.id===a})):null!=r?(i=R(r),I(s,function(t){return i&&0<=M(r,t.name)||!i&&t.name===r})):s.slice(),t):[]},findComponents:function(t){var e,n,i,o,a,r=t.query,s=t.mainType,l=(n=s+"Index",i=s+"Id",o=s+"Name",!(e=r)||null==e[n]&&null==e[i]&&null==e[o]?null:{mainType:s,index:e[n],id:e[i],name:e[o]}),h=l?this.queryComponents(l):this._componentsMap.get(s);return a=$h(h,t),t.filter?I(a,t.filter):a},eachComponent:function(t,i,o){var e=this._componentsMap;"function"==typeof t?(o=i,i=t,e.each(function(t,n){P(t,function(t,e){i.call(o,n,t,e)})})):B(t)?P(e.get(t),i,o):V(t)&&P(this.findComponents(t),i,o)},getSeriesByName:function(e){return I(this._componentsMap.get("series"),function(t){return t.name===e})},getSeriesByIndex:function(t){return this._componentsMap.get("series")[t]},getSeriesByType:function(e){return I(this._componentsMap.get("series"),function(t){return t.subType===e})},getSeries:function(){return this._componentsMap.get("series").slice()},getSeriesCount:function(){return this._componentsMap.get("series").length},eachSeries:function(n,i){Jh(this),P(this._seriesIndices,function(t){var e=this._componentsMap.get("series")[t];n.call(i,e,t)},this)},eachRawSeries:function(t,e){P(this._componentsMap.get("series"),t,e)},eachSeriesByType:function(n,i,o){Jh(this),P(this._seriesIndices,function(t){var e=this._componentsMap.get("series")[t];e.subType===n&&i.call(o,e,t)},this)},eachRawSeriesByType:function(t,e,n){return P(this.getSeriesByType(t),e,n)},isSeriesFiltered:function(t){return Jh(this),null==this._seriesIndicesMap.get(t.componentIndex)},getCurrentSeriesIndices:function(){return(this._seriesIndices||[]).slice()},filterSeries:function(t,e){Jh(this);var n=I(this._componentsMap.get("series"),t,e);Kh(this,n)},restoreData:function(n){var i=this._componentsMap;Kh(this,i.get("series"));var o=[];i.each(function(t,e){o.push(e)}),Mh.topologicalTravel(o,Mh.getAllClassMainTypes(),function(e,t){P(i.get(e),function(t){"series"===e&&function(t,e){if(e){var n=e.seiresIndex,i=e.seriesId,o=e.seriesName;return null!=n&&t.componentIndex!==n||null!=i&&t.id!==i||null!=o&&t.name!==o}}(t,n)||t.restoreData()})})}});function Kh(t,e){t._seriesIndicesMap=et(t._seriesIndices=N(e,function(t){return t.componentIndex})||[])}function $h(t,e){return e.hasOwnProperty("subType")?I(t,function(t){return t.subType===e.subType}):t}function Jh(t){if(D&&!t._seriesIndices)throw new Error("Option should contains series.")}b(qh,Ch);var Qh=["getDom","getZr","getWidth","getHeight","getDevicePixelRatio","dispatchAction","isDisposed","on","off","getDataURL","getConnectedDataURL","getModel","getOption","getViewOfComponentModel","getViewOfSeriesModel"];function tu(e){P(Qh,function(t){this[t]=E(e[t],e)},this)}var eu={};function nu(){this._coordinateSystems=[]}nu.prototype={constructor:nu,create:function(i,o){var a=[];P(eu,function(t,e){var n=t.create(i,o);a=a.concat(n||[])}),this._coordinateSystems=a},update:function(e,n){P(this._coordinateSystems,function(t){t.update&&t.update(e,n)})},getCoordinateSystems:function(){return this._coordinateSystems.slice()}},nu.register=function(t,e){eu[t]=e},nu.get=function(t){return eu[t]};var iu=P,ou=C,au=N,ru=m,su=/^(min|max)?(.+)$/;function lu(t){this._api=t,this._timelineOptions=[],this._mediaList=[],this._mediaDefault,this._currentMediaIndices=[],this._optionBackup,this._newBaseOption}function hu(t,e,n){var l={width:e,height:n,aspectratio:e/n},h=!0;return P(t,function(t,e){var n,i,o,a,r,s=e.match(su);s&&s[1]&&s[2]&&(n=s[1],i=s[2].toLowerCase(),o=l[i],a=t,("min"===(r=n)?a<=o:"max"===r?o<=a:o===a)||(h=!1))}),h}lu.prototype={constructor:lu,setOption:function(t,e){t&&P(Oo(t.series),function(t){t&&t.data&&F(t.data)&&J(t.data)}),t=ou(t);var o,n,i=this._optionBackup,a=function(t,n,i){var e,o,a=[],r=[],s=t.timeline;t.baseOption&&(o=t.baseOption);(s||t.options)&&(o=o||{},a=(t.options||[]).slice());{var l;t.media&&(o=o||{},l=t.media,iu(l,function(t){t&&t.option&&(t.query?r.push(t):e=e||t)}))}o=o||t;o.timeline||(o.timeline=s);return iu([o].concat(a).concat(N(r,function(t){return t.option})),function(e){iu(n,function(t){t(e,i)})}),{baseOption:o,timelineOptions:a,mediaDefault:e,mediaList:r}}.call(this,t,e,!i);this._newBaseOption=a.baseOption,i?(o=i.baseOption,n=a.baseOption,iu(n=n||{},function(t,e){var n,i;null!=t&&(n=o[e],Mh.hasClass(e)?(t=Oo(t),i=Bo(n=Oo(n),t),o[e]=au(i,function(t){return t.option&&t.exist?ru(t.exist,t.option,!0):t.exist||t.option})):o[e]=ru(n,t,!0))}),a.timelineOptions.length&&(i.timelineOptions=a.timelineOptions),a.mediaList.length&&(i.mediaList=a.mediaList),a.mediaDefault&&(i.mediaDefault=a.mediaDefault)):this._optionBackup=a},mountOption:function(t){var e=this._optionBackup;return this._timelineOptions=au(e.timelineOptions,ou),this._mediaList=au(e.mediaList,ou),this._mediaDefault=ou(e.mediaDefault),this._currentMediaIndices=[],ou(t?e.baseOption:this._newBaseOption)},getTimelineOption:function(t){var e,n,i=this._timelineOptions;return!i.length||(n=t.getComponent("timeline"))&&(e=ou(i[n.getCurrentIndex()],!0)),e},getMediaOption:function(t){var e=this._api.getWidth(),n=this._api.getHeight(),i=this._mediaList,o=this._mediaDefault,a=[],r=[];if(!i.length&&!o)return r;for(var s,l,h=0,u=i.length;h<u;h++)hu(i[h].query,e,n)&&a.push(h);return!a.length&&o&&(a=[-1]),a.length&&(s=a,l=this._currentMediaIndices,s.join(",")!==l.join(","))&&(r=au(a,function(t){return ou(-1===t?o.option:i[t].option)})),this._currentMediaIndices=a,r}};var uu=P,cu=V,du=["areaStyle","lineStyle","nodeStyle","linkStyle","chordStyle","label","labelLine"];function pu(t){var e=t&&t.itemStyle;if(e)for(var n=0,i=du.length;n<i;n++){var o=du[n],a=e.normal,r=e.emphasis;a&&a[o]&&(t[o]=t[o]||{},t[o].normal?m(t[o].normal,a[o]):t[o].normal=a[o],a[o]=null),r&&r[o]&&(t[o]=t[o]||{},t[o].emphasis?m(t[o].emphasis,r[o]):t[o].emphasis=r[o],r[o]=null)}}function gu(t,e,n){var i,o;t&&t[e]&&(t[e].normal||t[e].emphasis)&&(i=t[e].normal,o=t[e].emphasis,i&&(n?(t[e].normal=t[e].emphasis=null,L(t[e],i)):t[e]=i),o&&(t.emphasis=t.emphasis||{},t.emphasis[e]=o))}function fu(t){gu(t,"itemStyle"),gu(t,"lineStyle"),gu(t,"areaStyle"),gu(t,"label"),gu(t,"labelLine"),gu(t,"upperLabel"),gu(t,"edgeLabel")}function mu(t,e){var n=cu(t)&&t[e],i=cu(n)&&n.textStyle;if(i)for(var o=0,a=zo.length;o<a;o++){e=zo[o];i.hasOwnProperty(e)&&(n[e]=i[e])}}function vu(t){t&&(fu(t),mu(t,"label"),t.emphasis&&mu(t.emphasis,"label"))}function yu(t){return R(t)?t:t?[t]:[]}function xu(t){return(R(t)?t[0]:t)||{}}function _u(e,t){uu(yu(e.series),function(t){cu(t)&&function(t){if(cu(t)){pu(t),fu(t),mu(t,"label"),mu(t,"upperLabel"),mu(t,"edgeLabel"),t.emphasis&&(mu(t.emphasis,"label"),mu(t.emphasis,"upperLabel"),mu(t.emphasis,"edgeLabel"));var e=t.markPoint;e&&(pu(e),vu(e));var n=t.markLine;n&&(pu(n),vu(n));var i=t.markArea;i&&vu(i);var o=t.data;if("graph"===t.type){o=o||t.nodes;var a=t.links||t.edges;if(a&&!F(a))for(var r=0;r<a.length;r++)vu(a[r]);P(t.categories,function(t){fu(t)})}if(o&&!F(o))for(r=0;r<o.length;r++)vu(o[r]);if((e=t.markPoint)&&e.data)for(var s=e.data,r=0;r<s.length;r++)vu(s[r]);if((n=t.markLine)&&n.data)for(var l=n.data,r=0;r<l.length;r++)R(l[r])?(vu(l[r][0]),vu(l[r][1])):vu(l[r]);"gauge"===t.type?(mu(t,"axisLabel"),mu(t,"title"),mu(t,"detail")):"treemap"===t.type?(gu(t.breadcrumb,"itemStyle"),P(t.levels,function(t){fu(t)})):"tree"===t.type&&fu(t.leaves)}}(t)});var n=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","parallelAxis","radar"];t&&n.push("valueAxis","categoryAxis","logAxis","timeAxis"),uu(n,function(t){uu(yu(e[t]),function(t){t&&(mu(t,"axisLabel"),mu(t.axisPointer,"label"))})}),uu(yu(e.parallel),function(t){var e=t&&t.parallelAxisDefault;mu(e,"axisLabel"),mu(e&&e.axisPointer,"label")}),uu(yu(e.calendar),function(t){gu(t,"itemStyle"),mu(t,"dayLabel"),mu(t,"monthLabel"),mu(t,"yearLabel")}),uu(yu(e.radar),function(t){mu(t,"name")}),uu(yu(e.geo),function(t){cu(t)&&(vu(t),uu(yu(t.regions),function(t){vu(t)}))}),uu(yu(e.timeline),function(t){vu(t),gu(t,"label"),gu(t,"itemStyle"),gu(t,"controlStyle",!0);var e=t.data;R(e)&&P(e,function(t){V(t)&&(gu(t,"label"),gu(t,"itemStyle"))})}),uu(yu(e.toolbox),function(t){gu(t,"iconStyle"),uu(t.feature,function(t){gu(t,"iconStyle")})}),mu(xu(e.axisPointer),"label"),mu(xu(e.tooltip).axisPointer,"label")}function wu(e){P(bu,function(t){t[0]in e&&!(t[1]in e)&&(e[t[1]]=e[t[0]])})}var bu=[["x","left"],["y","top"],["x2","right"],["y2","bottom"]],Su=["grid","geo","parallel","legend","toolbox","title","visualMap","dataZoom","timeline"],Mu=function(n,t){_u(n,t),n.series=Oo(n.series),P(n.series,function(t){var e,n;V(t)&&("line"===(e=t.type)?null!=t.clipOverflow&&(t.clip=t.clipOverflow):"pie"===e||"gauge"===e?null!=t.clockWise&&(t.clockwise=t.clockWise):"gauge"===e&&null!=(n=function(t,e){e=e.split(",");for(var n=t,i=0;i<e.length&&null!=(n=n&&n[e[i]]);i++);return n}(t,"pointer.color"))&&function(t,e,n,i){e=e.split(",");for(var o,a=t,r=0;r<e.length-1;r++)null==a[o=e[r]]&&(a[o]={}),a=a[o];!i&&null!=a[e[r]]||(a[e[r]]=n)}(t,"itemStyle.color",n),wu(t))}),n.dataRange&&(n.visualMap=n.dataRange),P(Su,function(t){var e=n[t];e&&(R(e)||(e=[e]),P(e,function(t){wu(t)}))})};function Iu(m){P(m,function(u,c){var d=[],p=[NaN,NaN],t=[u.stackResultDimension,u.stackedOverDimension],g=u.data,f=u.isStackedByIndex,e=g.map(t,function(t,e,n){var i,o,a=g.get(u.stackedDimension,n);if(isNaN(a))return p;f?o=g.getRawIndex(n):i=g.get(u.stackedByDimension,n);for(var r=NaN,s=c-1;0<=s;s--){var l=m[s];if(f||(o=l.data.rawIndexOf(l.stackedByDimension,i)),0<=o){var h=l.data.getByRawIndex(l.stackResultDimension,o);if(0<=a&&0<h||a<=0&&h<0){a+=h,r=h;break}}}return d[0]=a,d[1]=r,d});g.hostModel.setData(e),u.data=e})}function Tu(t,e){Bh.isInstance(t)||(t=Bh.seriesDataToSource(t)),this._source=t;var n=this._data=t.data,i=t.sourceFormat;if(i===Eh){if(D&&null==e)throw new Error("Typed array data must specify dimension size");this._offset=0,this._dimSize=e,this._data=n}var o=Du[i===kh?i+"_"+t.seriesLayoutBy:i];D&&q(o,"Invalide sourceFormat: "+i),k(this,o)}var Au=Tu.prototype;Au.pure=!1;var Du={arrayRows_column:{pure:Au.persistent=!0,count:function(){return Math.max(0,this._data.length-this._source.startIndex)},getItem:function(t){return this._data[t+this._source.startIndex]},appendData:ku},arrayRows_row:{pure:!0,count:function(){var t=this._data[0];return t?Math.max(0,t.length-this._source.startIndex):0},getItem:function(t){t+=this._source.startIndex;for(var e=[],n=this._data,i=0;i<n.length;i++){var o=n[i];e.push(o?o[t]:null)}return e},appendData:function(){throw new Error('Do not support appendData when set seriesLayoutBy: "row".')}},objectRows:{pure:!0,count:Cu,getItem:Lu,appendData:ku},keyedColumns:{pure:!0,count:function(){var t=this._source.dimensionsDefine[0].name,e=this._data[t];return e?e.length:0},getItem:function(t){for(var e=[],n=this._source.dimensionsDefine,i=0;i<n.length;i++){var o=this._data[n[i].name];e.push(o?o[t]:null)}return e},appendData:function(t){var o=this._data;P(t,function(t,e){for(var n=o[e]||(o[e]=[]),i=0;i<(t||[]).length;i++)n.push(t[i])})}},original:{count:Cu,getItem:Lu,appendData:ku},typedArray:{persistent:!(Au.getSource=function(){return this._source}),pure:!0,count:function(){return this._data?this._data.length/this._dimSize:0},getItem:function(t,e){t-=this._offset,e=e||[];for(var n=this._dimSize*t,i=0;i<this._dimSize;i++)e[i]=this._data[n+i];return e},appendData:function(t){D&&q(F(t),"Added data must be TypedArray if data in initialization is TypedArray"),this._data=t},clean:function(){this._offset+=this.count(),this._data=null}}};function Cu(){return this._data.length}function Lu(t){return this._data[t]}function ku(t){for(var e=0;e<t.length;e++)this._data.push(t[e])}var Pu={arrayRows:Nu,objectRows:function(t,e,n,i){return null!=n?t[i]:t},keyedColumns:Nu,original:function(t,e,n,i){var o=Ro(t);return null!=n&&o instanceof Array?o[n]:o},typedArray:Nu};function Nu(t,e,n,i){return null!=n?t[n]:t}var Ou={arrayRows:Eu,objectRows:function(t,e,n,i){return zu(t[e],this._dimensionInfos[e])},keyedColumns:Eu,original:function(t,e,n,i){var o,a=t&&(null==t.value?t:t.value);return this._rawData.pure||(!ko(o=t)||o instanceof Array)||(this.hasItemOption=!0),zu(a instanceof Array?a[i]:a,this._dimensionInfos[e])},typedArray:function(t,e,n,i){return t[i]}};function Eu(t,e,n,i){return zu(t[i],this._dimensionInfos[e])}function zu(t,e){var n=e&&e.type;if("ordinal"!==n)return"time"===n&&"number"!=typeof t&&null!=t&&"-"!==t&&(t=+Fl(t)),null==t||""===t?NaN:+t;var i=e&&e.ordinalMeta;return i?i.parseAndCollect(t):t}function Ru(t,e,n){if(t){var i=t.getRawDataItem(e);if(null!=i){var o,a,r=t.getProvider().getSource().sourceFormat,s=t.getDimensionInfo(n);return s&&(o=s.name,a=s.index),Pu[r](i,e,a,o)}}}function Bu(t,e,n){if(t){var i=t.getProvider().getSource().sourceFormat;if(i===Lh||i===Ph){var o=t.getRawDataItem(e);return i!==Lh||V(o)||(o=null),o?o[n]:void 0}}}var Vu=/\{@(.+?)\}/g,Gu={getDataParams:function(t,e){var n=this.getData(e),i=this.getRawValue(t,e),o=n.getRawIndex(t),a=n.getName(t),r=n.getRawDataItem(t),s=n.getItemVisual(t,"color"),l=n.getItemVisual(t,"borderColor"),h=this.ecModel.getComponent("tooltip"),u=jo(h&&h.get("renderMode")),c=this.mainType,d="series"===c,p=n.userOutput;return{componentType:c,componentSubType:this.subType,componentIndex:this.componentIndex,seriesType:d?this.subType:null,seriesIndex:this.seriesIndex,seriesId:d?this.id:null,seriesName:d?this.name:null,name:a,dataIndex:o,data:r,dataType:e,value:i,color:s,borderColor:l,dimensionNames:p?p.dimensionNames:null,encode:p?p.encode:null,marker:oh({color:s,renderMode:u}),$vars:["seriesName","name","value"]}},getFormattedLabel:function(i,t,e,n,o){t=t||"normal";var a=this.getData(e),r=a.getItemModel(i),s=this.getDataParams(i,e);null!=n&&s.value instanceof Array&&(s.value=s.value[n]);var l=r.get("normal"===t?[o||"label","formatter"]:[t,o||"label","formatter"]);return"function"==typeof l?(s.status=t,s.dimensionIndex=n,l(s)):"string"==typeof l?nh(l,s).replace(Vu,function(t,e){var n=e.length;return"["===e.charAt(0)&&"]"===e.charAt(n-1)&&(e=+e.slice(1,n-1)),Ru(a,i,e)}):void 0},getRawValue:function(t,e){return Ru(this.getData(e),t)},formatTooltip:function(){}};function Fu(t){return new Wu(t)}function Wu(t){t=t||{},this._reset=t.reset,this._plan=t.plan,this._count=t.count,this._onDirty=t.onDirty,this._dirty=!0,this.context}var Hu=Wu.prototype;Hu.perform=function(t){var e,n,i=this._upstream,o=t&&t.skip;this._dirty&&i&&((e=this.context).data=e.outputData=i.context.outputData),this.__pipeline&&(this.__pipeline.currentTask=this),this._plan&&!o&&(n=this._plan(this.context));var a,r=u(this._modBy),s=this._modDataCount||0,l=u(t&&t.modBy),h=t&&t.modDataCount||0;function u(t){return 1<=t||(t=1),t}r===l&&s===h||(n="reset"),!this._dirty&&"reset"!==n||(this._dirty=!1,a=function(t,e){var n,i;t._dueIndex=t._outputDueEnd=t._dueEnd=0,t._settedOutputEnd=null,!e&&t._reset&&((n=t._reset(t.context))&&n.progress&&(i=n.forceFirstProgress,n=n.progress),R(n)&&!n.length&&(n=null));t._progress=n,t._modBy=t._modDataCount=null;var o=t._downstream;return o&&o.dirty(),i}(this,o)),this._modBy=l,this._modDataCount=h;var c=t&&t.step;if(i?(D&&q(null!=i._outputDueEnd),this._dueEnd=i._outputDueEnd):(D&&q(!this._progress||this._count),this._dueEnd=this._count?this._count(this.context):1/0),this._progress){var d=this._dueIndex,p=Math.min(null!=c?this._dueIndex+c:1/0,this._dueEnd);if(!o&&(a||d<p)){var g=this._progress;if(R(g))for(var f=0;f<g.length;f++)Qu(this,g[f],d,p,l,h);else Qu(this,g,d,p,l,h)}this._dueIndex=p;var m=null!=this._settedOutputEnd?this._settedOutputEnd:p;D&&q(m>=this._outputDueEnd),this._outputDueEnd=m}else this._dueIndex=this._outputDueEnd=null!=this._settedOutputEnd?this._settedOutputEnd:this._dueEnd;return this.unfinished()};var Zu,Uu,Xu,Yu,ju,qu,Ku=qu={reset:function(t,e,n,i){Uu=t,Zu=e,Xu=n,Yu=i,ju=Math.ceil(Yu/Xu),qu.next=1<Xu&&0<Yu?Ju:$u}};function $u(){return Uu<Zu?Uu++:null}function Ju(){var t=Uu%ju*Xu+Math.ceil(Uu/ju),e=Zu<=Uu?null:t<Yu?t:Uu;return Uu++,e}function Qu(t,e,n,i,o,a){Ku.reset(n,i,o,a),t._callingProgress=e,t._callingProgress({start:n,end:i,count:i-n,next:Ku.next},t.context)}Hu.dirty=function(){this._dirty=!0,this._onDirty&&this._onDirty(this.context)},Hu.unfinished=function(){return this._progress&&this._dueIndex<this._dueEnd},Hu.pipe=function(t){D&&q(t&&!t._disposed&&t!==this),this._downstream===t&&!this._dirty||((this._downstream=t)._upstream=this,t.dirty())},Hu.dispose=function(){this._disposed||(this._upstream&&(this._upstream._downstream=null),this._downstream&&(this._downstream._upstream=null),this._dirty=!1,this._disposed=!0)},Hu.getUpstream=function(){return this._upstream},Hu.getDownstream=function(){return this._downstream},Hu.setOutputEnd=function(t){this._outputDueEnd=this._settedOutputEnd=t};var tc=Ho(),ec=Mh.extend({type:"series.__base__",seriesIndex:0,coordinateSystem:null,defaultOption:null,legendVisualProvider:null,visualColorAccessPath:"itemStyle.color",visualBorderColorAccessPath:"itemStyle.borderColor",layoutMode:null,init:function(t,e,n,i){this.seriesIndex=this.componentIndex,this.dataTask=Fu({count:ic,reset:oc}),this.dataTask.context={model:this},this.mergeDefaultAndTheme(t,n),Fh(this);var o=this.getInitialData(t,n);rc(o,this),this.dataTask.context.data=o,D&&q(o,"getInitialData returned invalid data."),tc(this).dataBeforeProcessed=o,nc(this)},mergeDefaultAndTheme:function(t,e){var n=this.layoutMode,i=n?yh(t):{},o=this.subType;Mh.hasClass(o)&&(o+="Series"),m(t,e.getTheme().get(this.subType)),m(t,this.getDefaultOption()),Eo(t,"label",["show"]),this.fillDataTextStyle(t.data),n&&vh(t,i,n)},mergeOption:function(t,e){t=m(this.option,t,!0),this.fillDataTextStyle(t.data);var n=this.layoutMode;n&&vh(this.option,t,n),Fh(this);var i=this.getInitialData(t,e);rc(i,this),this.dataTask.dirty(),this.dataTask.context.data=i,tc(this).dataBeforeProcessed=i,nc(this)},fillDataTextStyle:function(t){if(t&&!F(t))for(var e=["show"],n=0;n<t.length;n++)t[n]&&t[n].label&&Eo(t[n],"label",e)},getInitialData:function(){},appendData:function(t){this.getRawData().appendData(t.data)},getData:function(t){var e=lc(this);if(e){var n=e.context.data;return null==t?n:n.getLinkedData(t)}return tc(this).data},setData:function(t){var e,n=lc(this);n&&((e=n.context).data!==t&&n.modifyOutputEnd&&n.setOutputEnd(t.count()),e.outputData=t,n!==this.dataTask&&(e.data=t)),tc(this).data=t},getSource:function(){return Gh(this).source},getRawData:function(){return tc(this).dataBeforeProcessed},getBaseAxis:function(){var t=this.coordinateSystem;return t&&t.getBaseAxis&&t.getBaseAxis()},formatTooltip:function(o,u,t,c){var d=this,e="html"===(c=c||"html")?"<br/>":"\n",p="richText"===c,g={},f=0;function n(t){return{renderMode:c,content:Ql(jl(t)),style:g}}var m=this.getData(),a=m.mapDimension("defaultedTooltip",!0),i=a.length,r=this.getRawValue(o),s=R(r),v=m.getItemVisual(o,"color");V(v)&&v.colorStops&&(v=(v.colorStops[0]||{}).color),v=v||"transparent";var l=(1<i||s&&!i?function(t){var l=S(t,function(t,e,n){var i=m.getDimensionInfo(n);return t|(i&&!1!==i.tooltip&&null!=i.displayName)},0),h=[];function e(t,e){var n,i,o,a,r,s=m.getDimensionInfo(e);s&&!1!==s.otherDims.tooltip&&(n=s.type,i="sub"+d.seriesIndex+"at"+f,a="string"==typeof(o=oh({color:v,type:"subItem",renderMode:c,markerId:i}))?o:o.content,(r=(l?a+Ql(s.displayName||"-")+": ":"")+Ql("ordinal"===n?t+"":"time"===n?u?"":rh("yyyy/MM/dd hh:mm:ss",t):jl(t)))&&h.push(r),p&&(g[i]=v,++f))}a.length?P(a,function(t){e(Ru(m,o,t),t)}):P(t,e);var n=l?p?"\n":"<br/>":"",i=n+h.join(n||", ");return{renderMode:c,content:i,style:g}}(r):n(i?Ru(m,o,a[0]):s?r[0]:r)).content,h=d.seriesIndex+"at"+f,y=oh({color:v,type:"item",renderMode:c,markerId:h});g[h]=v,++f;var x=m.getName(o),_=this.name;Go(this)||(_=""),_=_?Ql(_)+(u?": ":e):"";var w="string"==typeof y?y:y.content;return{html:u?w+_+l:_+w+(x?Ql(x)+": "+l:l),markers:g}},isAnimationEnabled:function(){if(v.node)return!1;var t=this.getShallow("animation");return t&&this.getData().count()>this.getShallow("animationThreshold")&&(t=!1),t},restoreData:function(){this.dataTask.dirty()},getColorFromPalette:function(t,e,n){var i=this.ecModel;return Ch.getColorFromPalette.call(this,t,e,n)||i.getColorFromPalette(t,e,n)},coordDimToDataDim:function(t){return this.getRawData().mapDimension(t,!0)},getProgressive:function(){return this.get("progressive")},getProgressiveThreshold:function(){return this.get("progressiveThreshold")},getAxisTooltipData:null,getTooltipPosition:null,pipeTask:null,preventIncremental:null,pipelineContext:null});function nc(t){var n,e,i,o=t.name;Go(t)||(t.name=(n=t.getRawData(),e=n.mapDimension("seriesName",!0),i=[],P(e,function(t){var e=n.getDimensionInfo(t);e.displayName&&i.push(e.displayName)}),i.join(" ")||o))}function ic(t){return t.model.getRawData().count()}function oc(t){var e=t.model;return e.setData(e.getRawData().cloneShallow()),ac}function ac(t,e){t.end>e.outputData.count()&&e.model.getRawData().cloneShallow(e.outputData)}function rc(e,n){P(e.CHANGABLE_METHODS,function(t){e.wrapMethod(t,z(sc,n))})}function sc(t){var e=lc(t);e&&e.setOutputEnd(this.count())}function lc(t){var e=(t.ecModel||{}).scheduler,n=e&&e.getPipeline(t.uid);if(n){var i,o=n.currentTask;return!o||(i=o.agentStubMap)&&(o=i.get(t.uid)),o}}b(ec,Gu),b(ec,Ch);var hc=function(){this.group=new Mn,this.uid=Al("viewComponent")};hc.prototype={constructor:hc,init:function(t,e){},render:function(t,e,n,i){},dispose:function(){},filterForExposedEvent:null};var uc=hc.prototype;uc.updateView=uc.updateLayout=uc.updateVisual=function(t,e,n,i){},Qo(hc),oa(hc,{registerWhenExtend:!0});function cc(){var s=Ho();return function(t){var e=s(t),n=t.pipelineContext,i=e.large,o=e.progressiveRender,a=e.large=n.large,r=e.progressiveRender=n.progressiveRender;return!!(i^a||o^r)&&"reset"}}var dc=Ho(),pc=cc();function gc(){this.group=new Mn,this.uid=Al("viewChart"),this.renderTask=Fu({plan:yc,reset:xc}),this.renderTask.context={view:this}}var fc=gc.prototype={type:"chart",init:function(t,e){},render:function(t,e,n,i){},highlight:function(t,e,n,i){vc(t.getData(),i,"emphasis")},downplay:function(t,e,n,i){vc(t.getData(),i,"normal")},remove:function(t,e){this.group.removeAll()},dispose:function(){},incrementalPrepareRender:null,incrementalRender:null,updateTransform:null,filterForExposedEvent:null};function mc(t,e,n){if(t&&(t.trigger(e,n),t.isGroup&&!js(t)))for(var i=0,o=t.childCount();i<o;i++)mc(t.childAt(i),e,n)}function vc(e,t,n){var i=Wo(e,t),o=t&&null!=t.highlightKey?qs(t.highlightKey):null;null!=i?P(Oo(i),function(t){mc(e.getItemGraphicEl(t),n,o)}):e.eachItemGraphicEl(function(t){mc(t,n,o)})}function yc(t){return pc(t.model)}function xc(t){var e=t.model,n=t.ecModel,i=t.api,o=t.payload,a=e.pipelineContext.progressiveRender,r=t.view,s=o&&dc(o).updateMethod,l=a?"incrementalPrepareRender":s&&r[s]?s:"render";return"render"!==l&&r[l](e,n,i,o),_c[l]}fc.updateView=fc.updateLayout=fc.updateVisual=function(t,e,n,i){this.render(t,e,n,i)},Qo(gc,["dispose"]),oa(gc,{registerWhenExtend:!0}),gc.markUpdateMethod=function(t,e){dc(t).updateMethod=e};var _c={incrementalPrepareRender:{progress:function(t,e){e.view.incrementalRender(t,e.model,e.ecModel,e.api,e.payload)}},render:{forceFirstProgress:!0,progress:function(t,e){e.view.render(e.model,e.ecModel,e.api,e.payload)}}},wc="\0__throttleOriginMethod",bc="\0__throttleRate",Sc="\0__throttleType";function Mc(t,n,i){var o,a,r,s,l,h=0,u=0,c=null;function d(){u=(new Date).getTime(),c=null,t.apply(r,s||[])}n=n||0;function e(){o=(new Date).getTime(),r=this,s=arguments;var t=l||n,e=l||i;l=null,a=o-(e?h:u)-t,clearTimeout(c),e?c=setTimeout(d,t):0<=a?d():c=setTimeout(d,-a),h=o}return e.clear=function(){c&&(clearTimeout(c),c=null)},e.debounceNextCall=function(t){l=t},e}function Ic(t,e,n,i){var o=t[e];if(o){var a=o[wc]||o,r=o[Sc];if(o[bc]!==n||r!==i){if(null==n||!i)return t[e]=a;(o=t[e]=Mc(a,n,"debounce"===i))[wc]=a,o[Sc]=i,o[bc]=n}return o}}function Tc(t,e){var n=t[e];n&&n[wc]&&(t[e]=n[wc])}var Ac={createOnAllSeries:!0,performRawSeries:!0,reset:function(e,t){var n=e.getData(),a=(e.visualColorAccessPath||"itemStyle.color").split("."),i=e.get(a),o=!A(i)||i instanceof rs?null:i;i&&!o||(i=e.getColorFromPalette(e.name,null,t.getSeriesCount())),n.setVisual("color",i);var r=(e.visualBorderColorAccessPath||"itemStyle.borderColor").split("."),s=e.get(r);if(n.setVisual("borderColor",s),!t.isSeriesFiltered(e)){o&&n.each(function(t){n.setItemVisual(t,"color",o(e.getDataParams(t)))});return{dataEach:n.hasItemOption?function(t,e){var n=t.getItemModel(e),i=n.get(a,!0),o=n.get(r,!0);null!=i&&t.setItemVisual(e,"color",i),null!=o&&t.setItemVisual(e,"borderColor",o)}:null}}}},Dc={legend:{selector:{all:"全选",inverse:"反选"}},toolbox:{brush:{title:{rect:"矩形选择",polygon:"圈选",lineX:"横向选择",lineY:"纵向选择",keep:"保持选择",clear:"清除选择"}},dataView:{title:"数据视图",lang:["数据视图","关闭","刷新"]},dataZoom:{title:{zoom:"区域缩放",back:"区域缩放还原"}},magicType:{title:{line:"切换为折线图",bar:"切换为柱状图",stack:"切换为堆叠",tiled:"切换为平铺"}},restore:{title:"还原"},saveAsImage:{title:"保存为图片",lang:["右键另存为图片"]}},series:{typeNames:{pie:"饼图",bar:"柱状图",line:"折线图",scatter:"散点图",effectScatter:"涟漪散点图",radar:"雷达图",tree:"树图",treemap:"矩形树图",boxplot:"箱型图",candlestick:"K线图",k:"K线图",heatmap:"热力图",map:"地图",parallel:"平行坐标图",lines:"线图",graph:"关系图",sankey:"桑基图",funnel:"漏斗图",gauge:"仪表盘图",pictorialBar:"象形柱图",themeRiver:"主题河流图",sunburst:"旭日图"}},aria:{general:{withTitle:"这是一个关于“{title}”的图表。",withoutTitle:"这是一个图表，"},series:{single:{prefix:"",withName:"图表类型是{seriesType}，表示{seriesName}。",withoutName:"图表类型是{seriesType}。"},multiple:{prefix:"它由{seriesCount}个图表系列组成。",withName:"第{seriesId}个系列是一个表示{seriesName}的{seriesType}，",withoutName:"第{seriesId}个系列是一个{seriesType}，",separator:{middle:"；",end:"。"}}},data:{allData:"其数据是——",partialData:"其中，前{displayCnt}项是——",withName:"{name}的数据是{value}",withoutName:"{value}",separator:{middle:"，",end:""}}}},Cc=function(t,e){var c,d,n,p,i,o,g,a=e.getModel("aria");function f(t,e){if("string"!=typeof t)return t;var n=t;return P(e,function(t,e){n=n.replace(new RegExp("\\{\\s*"+e+"\\s*\\}","g"),t)}),n}function m(t){var e=a.get(t);if(null!=e)return e;for(var n=t.split("."),i=Dc.aria,o=0;o<n.length;++o)i=i[n[o]];return i}a.get("show")&&(a.get("description")?t.setAttribute("aria-label",a.get("description")):(c=0,e.eachSeries(function(t,e){++c},this),d=a.get("data.maxCount")||10,n=a.get("series.maxCount")||10,p=Math.min(c,n),c<1||(o=(i=function(){var t=e.getModel("title").option;t&&t.length&&(t=t[0]);return t&&t.text}())?f(m("general.withTitle"),{title:i}):m("general.withoutTitle"),g=[],o+=f(m(1<c?"series.multiple.prefix":"series.single.prefix"),{seriesCount:c}),e.eachSeries(function(t,e){if(e<p){var n=t.get("name"),i="series."+(1<c?"multiple":"single")+".",o=m(n?i+"withName":i+"withoutName");o=f(o,{seriesId:t.seriesIndex,seriesName:t.get("name"),seriesType:(u=t.subType,Dc.series.typeNames[u]||"自定义图")});var a=t.getData();(window.data=a).count()>d?o+=f(m("data.partialData"),{displayCnt:d}):o+=m("data.allData");for(var r,s,l=[],h=0;h<a.count();h++){h<d&&(r=a.getName(h),s=Ru(a,h),l.push(f(m(r?"data.withName":"data.withoutName"),{name:r,value:s})))}o+=l.join(m("data.separator.middle"))+m("data.separator.end"),g.push(o)}var u}),o+=g.join(m("series.multiple.separator.middle"))+m("series.multiple.separator.end"),t.setAttribute("aria-label",o))))},Lc=Math.PI;function kc(t,e,n,i){this.ecInstance=t,this.api=e,this.unfinished;n=this._dataProcessorHandlers=n.slice(),i=this._visualHandlers=i.slice();this._allHandlers=n.concat(i),this._stageTaskMap=et()}var Pc=kc.prototype;function Nc(l,t,h,u,c){var d;function p(t,e){return t.setDirty&&(!t.dirtyMap||t.dirtyMap.get(e.__pipeline.id))}c=c||{},P(t,function(i,t){var e,n,o,a,r,s;c.visualType&&c.visualType!==i.visualType||(n=(e=l._stageTaskMap.get(i.uid)).seriesTaskMap,(o=e.overallTask)?((r=o.agentStubMap).each(function(t){p(c,t)&&(t.dirty(),a=!0)}),a&&o.dirty(),Oc(o,u),s=l.getPerformArgs(o,c.block),r.each(function(t){t.perform(s)}),d|=o.perform(s)):n&&n.each(function(t,e){p(c,t)&&t.dirty();var n=l.getPerformArgs(t,c.block);n.skip=!i.performRawSeries&&h.isSeriesFiltered(t.context.model),Oc(t,u),d|=t.perform(n)}))}),l.unfinished|=d}Pc.restoreData=function(t,e){t.restoreData(e),this._stageTaskMap.each(function(t){var e=t.overallTask;e&&e.dirty()})},Pc.getPerformArgs=function(t,e){if(t.__pipeline){var n=this._pipelineMap.get(t.__pipeline.id),i=n.context,o=!e&&n.progressiveEnabled&&(!i||i.progressiveRender)&&t.__idxInPipeline>n.blockIndex?n.step:null,a=i&&i.modDataCount;return{step:o,modBy:null!=a?Math.ceil(a/o):null,modDataCount:a}}},Pc.getPipeline=function(t){return this._pipelineMap.get(t)},Pc.updateStreamModes=function(t,e){var n=this._pipelineMap.get(t.uid),i=t.getData().count(),o=n.progressiveEnabled&&e.incrementalPrepareRender&&i>=n.threshold,a=t.get("large")&&i>=t.get("largeThreshold"),r="mod"===t.get("progressiveChunkMode")?i:null;t.pipelineContext=n.context={progressiveRender:o,modDataCount:r,large:a}},Pc.restorePipelines=function(t){var i=this,o=i._pipelineMap=et();t.eachSeries(function(t){var e=t.getProgressive(),n=t.uid;o.set(n,{id:n,head:null,tail:null,threshold:t.getProgressiveThreshold(),progressiveEnabled:e&&!(t.preventIncremental&&t.preventIncremental()),blockIndex:-1,step:Math.round(e||700),count:0}),Zc(i,t,t.dataTask)})},Pc.prepareStageTasks=function(){var n=this._stageTaskMap,i=this.ecInstance.getModel(),o=this.api;P(this._allHandlers,function(t){var e=n.get(t.uid)||n.set(t.uid,[]);t.reset&&function(i,o,t,a,r){var s=t.seriesTaskMap||(t.seriesTaskMap=et()),e=o.seriesType,n=o.getTargetSeries;o.createOnAllSeries?a.eachRawSeries(l):e?a.eachRawSeriesByType(e,l):n&&n(a,r).each(l);function l(t){var e=t.uid,n=s.get(e)||s.set(e,Fu({plan:Vc,reset:Gc,count:Hc}));n.context={model:t,ecModel:a,api:r,useClearVisual:o.isVisual&&!o.isLayout,plan:o.plan,reset:o.reset,scheduler:i},Zc(i,t,n)}var h=i._pipelineMap;s.each(function(t,e){h.get(e)||(t.dispose(),s.removeKey(e))})}(this,t,e,i,o),t.overallReset&&function(i,t,e,n,o){var a=e.overallTask=e.overallTask||Fu({reset:Ec});a.context={ecModel:n,api:o,overallReset:t.overallReset,scheduler:i};var r=a.agentStubMap=a.agentStubMap||et(),s=t.seriesType,l=t.getTargetSeries,h=!0,u=t.modifyOutputEnd;s?n.eachRawSeriesByType(s,c):l?l(n,o).each(c):(h=!1,P(n.getSeries(),c));function c(t){var e=t.uid,n=r.get(e);n||(n=r.set(e,Fu({reset:zc,onDirty:Bc})),a.dirty()),n.context={model:t,overallProgress:h,modifyOutputEnd:u},n.agent=a,n.__block=h,Zc(i,t,n)}var d=i._pipelineMap;r.each(function(t,e){d.get(e)||(t.dispose(),a.dirty(),r.removeKey(e))})}(this,t,e,i,o)},this)},Pc.prepareView=function(t,e,n,i){var o=t.renderTask,a=o.context;a.model=e,a.ecModel=n,a.api=i,o.__block=!t.incrementalPrepareRender,Zc(this,e,o)},Pc.performDataProcessorTasks=function(t,e){Nc(this,this._dataProcessorHandlers,t,e,{block:!0})},Pc.performVisualTasks=function(t,e,n){Nc(this,this._visualHandlers,t,e,n)},Pc.performSeriesTasks=function(t){var e;t.eachSeries(function(t){e|=t.dataTask.perform()}),this.unfinished|=e},Pc.plan=function(){this._pipelineMap.each(function(t){var e=t.tail;do{if(e.__block){t.blockIndex=e.__idxInPipeline;break}e=e.getUpstream()}while(e)})};var Oc=Pc.updatePayload=function(t,e){"remain"!==e&&(t.context.payload=e)};function Ec(t){t.overallReset(t.ecModel,t.api,t.payload)}function zc(t,e){return t.overallProgress&&Rc}function Rc(){this.agent.dirty(),this.getDownstream().dirty()}function Bc(){this.agent&&this.agent.dirty()}function Vc(t){return t.plan&&t.plan(t.model,t.ecModel,t.api,t.payload)}function Gc(t){t.useClearVisual&&t.data.clearAllVisual();var e=t.resetDefines=Oo(t.reset(t.model,t.ecModel,t.api,t.payload));return 1<e.length?N(e,function(t,e){return Wc(e)}):Fc}var Fc=Wc(0);function Wc(a){return function(t,e){var n=e.data,i=e.resetDefines[a];if(i&&i.dataEach)for(var o=t.start;o<t.end;o++)i.dataEach(n,o);else i&&i.progress&&i.progress(t,n)}}function Hc(t){return t.data.count()}function Zc(t,e,n){var i=e.uid,o=t._pipelineMap.get(i);o.head||(o.head=n),o.tail&&o.tail.pipe(n),(o.tail=n).__idxInPipeline=o.count++,n.__pipeline=o}kc.wrapStageHandler=function(t,e){return A(t)&&(t={overallReset:t,seriesType:function(t){Uc=null;try{t(Xc,Yc)}catch(t){}return Uc}(t)}),t.uid=Al("stageHandler"),e&&(t.visualType=e),t};var Uc,Xc={},Yc={};function jc(t,e){for(var n in e.prototype)t[n]=it}jc(Xc,qh),jc(Yc,tu),Xc.eachSeriesByType=Xc.eachRawSeriesByType=function(t){Uc=t},Xc.eachComponent=function(t){"series"===t.mainType&&t.subType&&(Uc=t.subType)};function qc(){return{axisLine:{lineStyle:{color:Jc}},axisTick:{lineStyle:{color:Jc}},axisLabel:{textStyle:{color:Jc}},splitLine:{lineStyle:{type:"dashed",color:"#aaa"}},splitArea:{areaStyle:{color:Jc}}}}var Kc=["#37A2DA","#32C5E9","#67E0E3","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#E062AE","#E690D1","#e7bcf3","#9d96f5","#8378EA","#96BFFF"],$c={color:Kc,colorLayer:[["#37A2DA","#ffd85c","#fd7b5f"],["#37A2DA","#67E0E3","#FFDB5C","#ff9f7f","#E062AE","#9d96f5"],["#37A2DA","#32C5E9","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#e7bcf3","#8378EA","#96BFFF"],Kc]},Jc="#eee",Qc=["#dd6b66","#759aa0","#e69d87","#8dc1a9","#ea7e53","#eedd78","#73a373","#73b9bc","#7289ab","#91ca8c","#f49f42"],td={color:Qc,backgroundColor:"#333",tooltip:{axisPointer:{lineStyle:{color:Jc},crossStyle:{color:Jc},label:{color:"#000"}}},legend:{textStyle:{color:Jc}},textStyle:{color:Jc},title:{textStyle:{color:Jc}},toolbox:{iconStyle:{normal:{borderColor:Jc}}},dataZoom:{textStyle:{color:Jc}},visualMap:{textStyle:{color:Jc}},timeline:{lineStyle:{color:Jc},itemStyle:{normal:{color:Qc[1]}},label:{normal:{textStyle:{color:Jc}}},controlStyle:{normal:{color:Jc,borderColor:Jc}}},timeAxis:qc(),logAxis:qc(),valueAxis:qc(),categoryAxis:qc(),line:{symbol:"circle"},graph:{color:Qc},gauge:{title:{textStyle:{color:Jc}}},candlestick:{itemStyle:{normal:{color:"#FD1050",color0:"#0CF49B",borderColor:"#FD1050",borderColor0:"#0CF49B"}}}};td.categoryAxis.splitLine.show=!1,Mh.extend({type:"dataset",defaultOption:{seriesLayoutBy:zh,sourceHeader:null,dimensions:null,source:null},optionUpdated:function(){!function(t){var e=t.option.source,n=Oh;if(F(e))n=Eh;else if(R(e)){0===e.length&&(n=kh);for(var i=0,o=e.length;i<o;i++){var a=e[i];if(null!=a){if(R(a)){n=kh;break}if(V(a)){n=Ph;break}}}}else if(V(e)){for(var r in e)if(e.hasOwnProperty(r)&&O(e[r])){n=Nh;break}}else if(null!=e)throw new Error("Invalid data");Gh(t).sourceFormat=n}(this)}}),hc.extend({type:"dataset"});var ed=br.extend({type:"ellipse",shape:{cx:0,cy:0,rx:0,ry:0},buildPath:function(t,e){var n=e.cx,i=e.cy,o=e.rx,a=e.ry,r=.5522848*o,s=.5522848*a;t.moveTo(n-o,i),t.bezierCurveTo(n-o,i-s,n-r,i-a,n,i-a),t.bezierCurveTo(n+r,i-a,n+o,i-s,n+o,i),t.bezierCurveTo(n+o,i+s,n+r,i+a,n,i+a),t.bezierCurveTo(n-r,i+a,n-o,i+s,n-o,i),t.closePath()}}),nd=/[\s,]+/;function id(t){for(B(t)&&(t=(new DOMParser).parseFromString(t,"text/xml")),9===t.nodeType&&(t=t.firstChild);"svg"!==t.nodeName.toLowerCase()||1!==t.nodeType;)t=t.nextSibling;return t}function od(){this._defs={},this._root=null,this._isDefine=!1,this._isText=!1}od.prototype.parse=function(t,e){e=e||{};var n=id(t);if(!n)throw new Error("Illegal svg");var i=new Mn;this._root=i;var o=n.getAttribute("viewBox")||"",a=parseFloat(n.getAttribute("width")||e.width),r=parseFloat(n.getAttribute("height")||e.height);isNaN(a)&&(a=null),isNaN(r)&&(r=null),ud(n,i,null,!0);for(var s,l,h,u,c=n.firstChild;c;)this._parseNode(c,i),c=c.nextSibling;return!o||4<=(l=K(o).split(nd)).length&&(s={x:parseFloat(l[0]||0),y:parseFloat(l[1]||0),width:parseFloat(l[2]),height:parseFloat(l[3])}),s&&null!=a&&null!=r&&(u=fd(s,a,r),e.ignoreViewBox||(h=i,(i=new Mn).add(h),h.scale=u.scale.slice(),h.position=u.position.slice())),e.ignoreRootClip||null==a||null==r||i.setClipPath(new es({shape:{x:0,y:0,width:a,height:r}})),{root:i,width:a,height:r,viewBoxRect:s,viewBoxTransform:u}},od.prototype._parseNode=function(t,e){var n,i,o,a,r=t.nodeName.toLowerCase();"defs"===r?this._isDefine=!0:"text"===r&&(this._isText=!0),this._isDefine?(a=rd[r])&&(i=a.call(this,t),(o=t.getAttribute("id"))&&(this._defs[o]=i)):(a=ad[r])&&(n=a.call(this,t,e),e.add(n));for(var s=t.firstChild;s;)1===s.nodeType&&this._parseNode(s,n),3===s.nodeType&&this._isText&&this._parseText(s,n),s=s.nextSibling;"defs"===r?this._isDefine=!1:"text"===r&&(this._isText=!1)},od.prototype._parseText=function(t,e){var n,i;1===t.nodeType&&(n=t.getAttribute("dx")||0,i=t.getAttribute("dy")||0,this._textX+=parseFloat(n),this._textY+=parseFloat(i));var o=new Gr({style:{text:t.textContent,transformText:!0},position:[this._textX||0,this._textY||0]});sd(e,o),ud(t,o,this._defs);var a=o.style.fontSize;a&&a<9&&(o.style.fontSize=9,o.scale=o.scale||[1,1],o.scale[0]*=a/9,o.scale[1]*=a/9);var r=o.getBoundingRect();return this._textX+=r.width,e.add(o),o};var ad={g:function(t,e){var n=new Mn;return sd(e,n),ud(t,n,this._defs),n},rect:function(t,e){var n=new es;return sd(e,n),ud(t,n,this._defs),n.setShape({x:parseFloat(t.getAttribute("x")||0),y:parseFloat(t.getAttribute("y")||0),width:parseFloat(t.getAttribute("width")||0),height:parseFloat(t.getAttribute("height")||0)}),n},circle:function(t,e){var n=new Wr;return sd(e,n),ud(t,n,this._defs),n.setShape({cx:parseFloat(t.getAttribute("cx")||0),cy:parseFloat(t.getAttribute("cy")||0),r:parseFloat(t.getAttribute("r")||0)}),n},line:function(t,e){var n=new is;return sd(e,n),ud(t,n,this._defs),n.setShape({x1:parseFloat(t.getAttribute("x1")||0),y1:parseFloat(t.getAttribute("y1")||0),x2:parseFloat(t.getAttribute("x2")||0),y2:parseFloat(t.getAttribute("y2")||0)}),n},ellipse:function(t,e){var n=new ed;return sd(e,n),ud(t,n,this._defs),n.setShape({cx:parseFloat(t.getAttribute("cx")||0),cy:parseFloat(t.getAttribute("cy")||0),rx:parseFloat(t.getAttribute("rx")||0),ry:parseFloat(t.getAttribute("ry")||0)}),n},polygon:function(t,e){var n=(n=t.getAttribute("points"))&&ld(n),i=new jr({shape:{points:n||[]}});return sd(e,i),ud(t,i,this._defs),i},polyline:function(t,e){var n=new br;sd(e,n),ud(t,n,this._defs);var i=(i=t.getAttribute("points"))&&ld(i);return new qr({shape:{points:i||[]}})},image:function(t,e){var n=new Yi;return sd(e,n),ud(t,n,this._defs),n.setStyle({image:t.getAttribute("xlink:href"),x:t.getAttribute("x"),y:t.getAttribute("y"),width:t.getAttribute("width"),height:t.getAttribute("height")}),n},text:function(t,e){var n=t.getAttribute("x")||0,i=t.getAttribute("y")||0,o=t.getAttribute("dx")||0,a=t.getAttribute("dy")||0;this._textX=parseFloat(n)+parseFloat(o),this._textY=parseFloat(i)+parseFloat(a);var r=new Mn;return sd(e,r),ud(t,r,this._defs),r},tspan:function(t,e){var n=t.getAttribute("x"),i=t.getAttribute("y");null!=n&&(this._textX=parseFloat(n)),null!=i&&(this._textY=parseFloat(i));var o=t.getAttribute("dx")||0,a=t.getAttribute("dy")||0,r=new Mn;return sd(e,r),ud(t,r,this._defs),this._textX+=o,this._textY+=a,r},path:function(t,e){var n=Vr(t.getAttribute("d")||"");return sd(e,n),ud(t,n,this._defs),n}},rd={lineargradient:function(t){var e=parseInt(t.getAttribute("x1")||0,10),n=parseInt(t.getAttribute("y1")||0,10),i=parseInt(t.getAttribute("x2")||10,10),o=parseInt(t.getAttribute("y2")||0,10),a=new us(e,n,i,o);return function(t,e){var n=t.firstChild;for(;n;){var i,o;1===n.nodeType&&(i=0<(i=n.getAttribute("offset")).indexOf("%")?parseInt(i,10)/100:i?parseFloat(i):0,o=n.getAttribute("stop-color")||"#000000",e.addColorStop(i,o)),n=n.nextSibling}}(t,a),a},radialgradient:function(t){}};function sd(t,e){t&&t.__inheritedStyle&&(e.__inheritedStyle||(e.__inheritedStyle={}),L(e.__inheritedStyle,t.__inheritedStyle))}function ld(t){for(var e=K(t).split(nd),n=[],i=0;i<e.length;i+=2){var o=parseFloat(e[i]),a=parseFloat(e[i+1]);n.push([o,a])}return n}var hd={fill:"fill",stroke:"stroke","stroke-width":"lineWidth",opacity:"opacity","fill-opacity":"fillOpacity","stroke-opacity":"strokeOpacity","stroke-dasharray":"lineDash","stroke-dashoffset":"lineDashOffset","stroke-linecap":"lineCap","stroke-linejoin":"lineJoin","stroke-miterlimit":"miterLimit","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","text-align":"textAlign","alignment-baseline":"textBaseline"};function ud(t,e,n,i){var o,a=e.__inheritedStyle||{},r="text"===e.type;if(1===t.nodeType&&(function(t,e){var n=t.getAttribute("transform");if(n){n=n.replace(/,/g," ");var i=null,o=[];n.replace(pd,function(t,e,n){o.push(e,n)});for(var a=o.length-1;0<a;a-=2){var r=o[a],s=o[a-1];switch(i=i||ee(),s){case"translate":r=K(r).split(nd),ae(i,i,[parseFloat(r[0]),parseFloat(r[1]||0)]);break;case"scale":r=K(r).split(nd),se(i,i,[parseFloat(r[0]),parseFloat(r[1]||r[0])]);break;case"rotate":r=K(r).split(nd),re(i,i,parseFloat(r[0]));break;case"skew":r=K(r).split(nd),console.warn("Skew transform is not supported yet");break;case"matrix":r=K(r).split(nd);i[0]=parseFloat(r[0]),i[1]=parseFloat(r[1]),i[2]=parseFloat(r[2]),i[3]=parseFloat(r[3]),i[4]=parseFloat(r[4]),i[5]=parseFloat(r[5])}}e.setLocalTransform(i)}}(t,e),k(a,function(t){var e=t.getAttribute("style"),n={};if(!e)return n;var i,o={};gd.lastIndex=0;for(;null!=(i=gd.exec(e));)o[i[1]]=i[2];for(var a in hd)hd.hasOwnProperty(a)&&null!=o[a]&&(n[hd[a]]=o[a]);return n}(t)),!i))for(var s in hd){!hd.hasOwnProperty(s)||null!=(o=t.getAttribute(s))&&(a[hd[s]]=o)}var l=r?"textFill":"fill",h=r?"textStroke":"stroke";e.style=e.style||new Gn;var u=e.style;null!=a.fill&&u.set(l,dd(a.fill,n)),null!=a.stroke&&u.set(h,dd(a.stroke,n)),P(["lineWidth","opacity","fillOpacity","strokeOpacity","miterLimit","fontSize"],function(t){var e="lineWidth"===t&&r?"textStrokeWidth":t;null!=a[t]&&u.set(e,parseFloat(a[t]))}),a.textBaseline&&"auto"!==a.textBaseline||(a.textBaseline="alphabetic"),"alphabetic"===a.textBaseline&&(a.textBaseline="bottom"),"start"===a.textAlign&&(a.textAlign="left"),"end"===a.textAlign&&(a.textAlign="right"),P(["lineDashOffset","lineCap","lineJoin","fontWeight","fontFamily","fontStyle","textAlign","textBaseline"],function(t){null!=a[t]&&u.set(t,a[t])}),a.lineDash&&(e.style.lineDash=K(a.lineDash).split(nd)),u[h]&&"none"!==u[h]&&(e[h]=!0),e.__inheritedStyle=a}var cd=/url\(\s*#(.*?)\)/;function dd(t,e){var n=e&&t&&t.match(cd);return n?e[K(n[1])]:t}var pd=/(translate|scale|rotate|skewX|skewY|matrix)\(([\-\s0-9\.e,]*)\)/g;var gd=/([^\s:;]+)\s*:\s*([^:;]+)/g;function fd(t,e,n){var i=e/t.width,o=n/t.height,a=Math.min(i,o);return{scale:[a,a],position:[-(t.x+t.width/2)*a+e/2,-(t.y+t.height/2)*a+n/2]}}var md=et(),vd={registerMap:function(t,e,n){var i=R(e)?e:e.svg?[{type:"svg",source:e.svg,specialAreas:e.specialAreas}]:(e.geoJson&&!e.features&&(n=e.specialAreas,e=e.geoJson),[{type:"geoJSON",source:e,specialAreas:n}]);return P(i,function(t){var e=t.type;"geoJson"===e&&(e=t.type="geoJSON");var n=yd[e];D&&q(n,"Illegal map type: "+e),n(t)}),md.set(t,i)},retrieveMap:function(t){return md.get(t)}},yd={geoJSON:function(t){var e=t.source;t.geoJSON=B(e)?"undefined"!=typeof JSON&&JSON.parse?JSON.parse(e):new Function("return ("+e+");")():e},svg:function(t){t.svgXML=id(t.source)}},xd=q,_d=P,wd=A,bd=V,Sd=Mh.parseClassType,Md={zrender:"4.2.0"},Id={PROCESSOR:{FILTER:1e3,SERIES_FILTER:800,STATISTIC:5e3},VISUAL:{LAYOUT:1e3,PROGRESSIVE_LAYOUT:1100,GLOBAL:2e3,CHART:3e3,POST_CHART_LAYOUT:3500,COMPONENT:4e3,BRUSH:5e3}},Td="__flagInMainProcess",Ad="__optionUpdated",Dd=/^[a-zA-Z0-9_]+$/;function Cd(i,o){return function(t,e,n){o||!this._disposed?(t=t&&t.toLowerCase(),Ct.prototype[i].call(this,t,e,n)):Yd(this.id)}}function Ld(){Ct.call(this)}function kd(t,e,n){n=n||{},"string"==typeof e&&(e=np[e]),this.id,this.group,this._dom=t;var i="canvas";D&&(i=("undefined"==typeof window?global:window).__ECHARTS__DEFAULT__RENDERER__||i);var o=this._zr=To(t,{renderer:n.renderer||i,devicePixelRatio:n.devicePixelRatio,width:n.width,height:n.height});this._throttledZrFlush=Mc(E(o.flush,o),17),(e=C(e))&&Mu(e,!0),this._theme=e,this._chartsViews=[],this._chartsMap={},this._componentsViews=[],this._componentsMap={},this._coordSysMgr=new nu;var a,r,s,l,h=this._api=(r=(a=this)._coordSysMgr,k(new tu(a),{getCoordinateSystems:E(r.getCoordinateSystems,r),getComponentByElement:function(t){for(;t;){var e=t.__ecComponentInfo;if(null!=e)return a._model.getComponent(e.mainType,e.index);t=t.parent}}}));function u(t,e){return t.__prio-e.__prio}Pn(ep,u),Pn(Jd,u),this._scheduler=new kc(this,h,Jd,ep),Ct.call(this,this._ecEventProcessor=new qd),this._messageCenter=new Ld,this._initEvents(),this.resize=E(this.resize,this),this._pendingActions=[],o.animation.on("frame",this._onframe,this),l=this,(s=o).on("rendered",function(){l.trigger("rendered"),!s.animation.isFinished()||l[Ad]||l._scheduler.unfinished||l._pendingActions.length||l.trigger("finished")}),J(this)}Ld.prototype.on=Cd("on",!0),Ld.prototype.off=Cd("off",!0),Ld.prototype.one=Cd("one",!0),b(Ld,Ct);var Pd=kd.prototype;function Nd(t,e,n){if(this._disposed)Yd(this.id);else{var i,o=this._model,a=this._coordSysMgr.getCoordinateSystems();e=Uo(o,e);for(var r=0;r<a.length;r++){var s=a[r];if(s[t]&&null!=(i=s[t](o,e,n)))return i}D&&console.warn("No coordinate system that supports "+t+" found by the given finder.")}}Pd._onframe=function(){if(!this._disposed){var t=this._scheduler;if(this[Ad]){var e=this[Ad].silent;this[Td]=!0,Ed(this),Od.update.call(this),this[Td]=!1,this[Ad]=!1,Vd.call(this,e),Gd.call(this,e)}else if(t.unfinished){var n=1,i=this._model,o=this._api;t.unfinished=!1;do{var a=+new Date;t.performSeriesTasks(i),t.performDataProcessorTasks(i),Rd(this,i),t.performVisualTasks(i),Zd(this,this._model,0,"remain"),n-=new Date-a}while(0<n&&t.unfinished);t.unfinished||this._zr.flush()}}},Pd.getDom=function(){return this._dom},Pd.getZr=function(){return this._zr},Pd.setOption=function(t,e,n){var i,o,a,r;D&&xd(!this[Td],"`setOption` should not be called during main process."),this._disposed?Yd(this.id):(bd(e)&&(n=e.lazyUpdate,i=e.silent,e=e.notMerge),this[Td]=!0,this._model&&!e||(o=new lu(this._api),a=this._theme,(r=this._model=new qh).scheduler=this._scheduler,r.init(null,null,a,o)),this._model.setOption(t,Qd),n?(this[Ad]={silent:i},this[Td]=!1):(Ed(this),Od.update.call(this),this._zr.flush(),this[Ad]=!1,this[Td]=!1,Vd.call(this,i),Gd.call(this,i)))},Pd.setTheme=function(){console.error("ECharts#setTheme() is DEPRECATED in ECharts 3.0")},Pd.getModel=function(){return this._model},Pd.getOption=function(){return this._model&&this._model.getOption()},Pd.getWidth=function(){return this._zr.getWidth()},Pd.getHeight=function(){return this._zr.getHeight()},Pd.getDevicePixelRatio=function(){return this._zr.painter.dpr||window.devicePixelRatio||1},Pd.getRenderedCanvas=function(t){if(v.canvasSupported)return(t=t||{}).pixelRatio=t.pixelRatio||1,t.backgroundColor=t.backgroundColor||this._model.get("backgroundColor"),this._zr.painter.getRenderedCanvas(t)},Pd.getSvgDataUrl=function(){if(v.svgSupported){var t=this._zr;return P(t.storage.getDisplayList(),function(t){t.stopAnimation(!0)}),t.painter.pathToDataUrl()}},Pd.getDataURL=function(t){if(!this._disposed){var e=(t=t||{}).excludeComponents,n=this._model,i=[],o=this;_d(e,function(t){n.eachComponent({mainType:t},function(t){var e=o._componentsMap[t.__viewId];e.group.ignore||(i.push(e),e.group.ignore=!0)})});var a="svg"===this._zr.painter.getType()?this.getSvgDataUrl():this.getRenderedCanvas(t).toDataURL("image/"+(t&&t.type||"png"));return _d(i,function(t){t.group.ignore=!1}),a}Yd(this.id)},Pd.getConnectedDataURL=function(o){if(this._disposed)Yd(this.id);else if(v.canvasSupported){var a=this.group,r=Math.min,s=Math.max;if(ap[a]){var l=1/0,h=1/0,u=-1/0,c=-1/0,d=[],n=o&&o.pixelRatio||1;P(op,function(t,e){var n,i;t.group===a&&(n=t.getRenderedCanvas(C(o)),i=t.getDom().getBoundingClientRect(),l=r(i.left,l),h=r(i.top,h),u=s(i.right,u),c=s(i.bottom,c),d.push({dom:n,left:i.left,top:i.top}))});var t=(u*=n)-(l*=n),e=(c*=n)-(h*=n),i=y();i.width=t,i.height=e;var p=To(i);return o.connectedBackgroundColor&&p.add(new es({shape:{x:0,y:0,width:t,height:e},style:{fill:o.connectedBackgroundColor}})),_d(d,function(t){var e=new Yi({style:{x:t.left*n-l,y:t.top*n-h,image:t.dom}});p.add(e)}),p.refreshImmediately(),i.toDataURL("image/"+(o&&o.type||"png"))}return this.getDataURL(o)}},Pd.convertToPixel=z(Nd,"convertToPixel"),Pd.convertFromPixel=z(Nd,"convertFromPixel"),Pd.containPixel=function(t,o){var a;if(!this._disposed)return P(t=Uo(this._model,t),function(t,i){0<=i.indexOf("Models")&&P(t,function(t){var e,n=t.coordinateSystem;n&&n.containPoint?a|=!!n.containPoint(o):"seriesModels"===i?(e=this._chartsMap[t.__viewId])&&e.containPoint?a|=e.containPoint(o,t):D&&console.warn(i+": "+(e?"The found component do not support containPoint.":"No view mapping to the found component.")):D&&console.warn(i+": containPoint is not supported")},this)},this),!!a;Yd(this.id)},Pd.getVisual=function(t,e){var n=(t=Uo(this._model,t,{defaultMainType:"series"})).seriesModel;D&&(n||console.warn("There is no specified seires model"));var i=n.getData(),o=t.hasOwnProperty("dataIndexInside")?t.dataIndexInside:t.hasOwnProperty("dataIndex")?i.indexOfRawIndex(t.dataIndex):null;return null!=o?i.getItemVisual(o,e):i.getVisual(e)},Pd.getViewOfComponentModel=function(t){return this._componentsMap[t.__viewId]},Pd.getViewOfSeriesModel=function(t){return this._chartsMap[t.__viewId]};var Od={prepareAndUpdate:function(t){Ed(this),Od.update.call(this,t)},update:function(t){var e,n,i=this._model,o=this._api,a=this._zr,r=this._coordSysMgr,s=this._scheduler;i&&(s.restoreData(i,t),s.performSeriesTasks(i),r.create(i,o),s.performDataProcessorTasks(i,t),Rd(this,i),r.update(i,o),Wd(i),s.performVisualTasks(i,t),Hd(this,i,o,t),n=i.get("backgroundColor")||"transparent",v.canvasSupported?a.setBackgroundColor(n):(n=Ue(e=Re(n),"rgb"),0===e[3]&&(n="transparent")),Ud(i,o))},updateTransform:function(o){var a,i,r=this._model,s=this,l=this._api;r&&(a=[],r.eachComponent(function(t,e){var n,i=s.getViewOfComponentModel(e);i&&i.__alive&&(!i.updateTransform||(n=i.updateTransform(e,r,l,o))&&n.update)&&a.push(i)}),i=et(),r.eachSeries(function(t){var e,n=s._chartsMap[t.__viewId];(!n.updateTransform||(e=n.updateTransform(t,r,l,o))&&e.update)&&i.set(t.uid,1)}),Wd(r),this._scheduler.performVisualTasks(r,o,{setDirty:!0,dirtyMap:i}),Zd(s,r,0,o,i),Ud(r,this._api))},updateView:function(t){var e=this._model;e&&(gc.markUpdateMethod(t,"updateView"),Wd(e),this._scheduler.performVisualTasks(e,t,{setDirty:!0}),Hd(this,this._model,this._api,t),Ud(e,this._api))},updateVisual:function(t){Od.update.call(this,t)},updateLayout:function(t){Od.update.call(this,t)}};function Ed(t){var e=t._model,n=t._scheduler;n.restorePipelines(e),n.prepareStageTasks(),Fd(t,"component",e,n),Fd(t,"chart",e,n),n.plan()}function zd(e,n,i,o,t){var a,r,s,l=e._model;function h(t){t&&t.__alive&&t[n]&&t[n](t.__model,l,e._api,i)}o?((a={})[o+"Id"]=i[o+"Id"],a[o+"Index"]=i[o+"Index"],a[o+"Name"]=i[o+"Name"],r={mainType:o,query:a},t&&(r.subType=t),null!=(s=i.excludeSeriesId)&&(s=et(Oo(s))),l&&l.eachComponent(r,function(t){s&&null!=s.get(t.id)||h(e["series"===o?"_chartsMap":"_componentsMap"][t.__viewId])},e)):_d(e._componentsViews.concat(e._chartsViews),h)}function Rd(t,e){var n=t._chartsMap,i=t._scheduler;e.eachSeries(function(t){i.updateStreamModes(t,n[t.__viewId])})}function Bd(e,t){var n=e.type,i=e.escapeConnect,o=Kd[n],a=o.actionInfo,r=(s=(a.update||"update").split(":")).pop(),s=null!=s[0]&&Sd(s[0]);this[Td]=!0;var l=[e],h=!1;e.batch&&(h=!0,l=N(e.batch,function(t){return(t=L(k({},t),e)).batch=null,t}));var u,c=[],d="highlight"===n||"downplay"===n;_d(l,function(t){(u=(u=o.action(t,this._model,this._api))||k({},t)).type=a.event||u.type,c.push(u),d?zd(this,r,t,"series"):s&&zd(this,r,t,s.main,s.sub)},this),"none"===r||d||s||(this[Ad]?(Ed(this),Od.update.call(this,e),this[Ad]=!1):Od[r].call(this,e)),u=h?{type:a.event||n,escapeConnect:i,batch:c}:c[0],this[Td]=!1,t||this._messageCenter.trigger(u.type,u)}function Vd(t){for(var e=this._pendingActions;e.length;){var n=e.shift();Bd.call(this,n,t)}}function Gd(t){t||this.trigger("updated")}function Fd(t,e,a,r){for(var s="component"===e,l=s?t._componentsViews:t._chartsViews,h=s?t._componentsMap:t._chartsMap,u=t._zr,c=t._api,n=0;n<l.length;n++)l[n].__alive=!1;function i(t){var e,n,i="_ec_"+t.id+"_"+t.type,o=h[i];o||(e=Sd(t.type),n=s?hc.getClass(e.main,e.sub):gc.getClass(e.sub),D&&xd(n,e.sub+" does not exist."),(o=new n).init(a,c),h[i]=o,l.push(o),u.add(o.group)),t.__viewId=o.__id=i,o.__alive=!0,o.__model=t,o.group.__ecComponentInfo={mainType:t.mainType,index:t.componentIndex},s||r.prepareView(o,t,a,c)}s?a.eachComponent(function(t,e){"series"!==t&&i(e)}):a.eachSeries(i);for(n=0;n<l.length;){var o=l[n];o.__alive?n++:(s||o.renderTask.dispose(),u.remove(o.group),o.dispose(a,c),l.splice(n,1),delete h[o.__id],o.__id=o.group.__ecComponentInfo=null)}}function Wd(t){t.clearColorPalette(),t.eachSeries(function(t){t.clearColorPalette()})}function Hd(t,e,n,i){var o,a,r,s,l;o=t,a=e,r=n,s=i,_d(l||o._componentsViews,function(t){var e=t.__model;t.render(e,a,r,s),jd(e,t)}),_d(t._chartsViews,function(t){t.__alive=!1}),Zd(t,e,0,i),_d(t._chartsViews,function(t){t.__alive||t.remove(e,n)})}function Zd(i,t,e,o,a){var r,n,s,l,h,u=i._scheduler;t.eachSeries(function(t){var e=i._chartsMap[t.__viewId];e.__alive=!0;var n=e.renderTask;u.updatePayload(n,o),a&&a.get(t.uid)&&n.dirty(),r|=n.perform(u.getPerformArgs(n)),e.group.silent=!!t.get("silent"),jd(t,e),function(t,e){var n=t.get("blendMode")||null;D&&!v.canvasSupported&&n&&"source-over"!==n&&console.warn("Only canvas support blendMode");e.group.traverse(function(t){t.isGroup||t.style.blend!==n&&t.setStyle("blend",n),t.eachPendingDisplayable&&t.eachPendingDisplayable(function(t){t.setStyle("blend",n)})})}(t,e)}),u.unfinished|=r,s=t,l=(n=i)._zr.storage,h=0,l.traverse(function(t){h++}),h>s.get("hoverLayerThreshold")&&!v.node&&s.eachSeries(function(t){var e;t.preventUsingHoverLayer||(e=n._chartsMap[t.__viewId]).__alive&&e.group.traverse(function(t){t.useHoverLayer=!0})}),Cc(i._zr.dom,t)}function Ud(e,n){_d(tp,function(t){t(e,n)})}Pd.resize=function(t){var e,n,i;D&&xd(!this[Td],"`resize` should not be called during main process."),this._disposed?Yd(this.id):(this._zr.resize(t),e=this._model,this._loadingFX&&this._loadingFX.resize(),e&&(n=e.resetOption("media"),i=t&&t.silent,this[Td]=!0,n&&Ed(this),Od.update.call(this),this[Td]=!1,Vd.call(this,i),Gd.call(this,i)))},Pd.showLoading=function(t,e){var n,i;this._disposed?Yd(this.id):(bd(t)&&(e=t,t=""),t=t||"default",this.hideLoading(),ip[t]?(n=ip[t](this._api,e),i=this._zr,this._loadingFX=n,i.add(n)):D&&console.warn("Loading effects "+t+" not exists."))},Pd.hideLoading=function(){this._disposed?Yd(this.id):(this._loadingFX&&this._zr.remove(this._loadingFX),this._loadingFX=null)},Pd.makeActionFromEvent=function(t){var e=k({},t);return e.type=$d[t.type],e},Pd.dispatchAction=function(t,e){this._disposed?Yd(this.id):(bd(e)||(e={silent:!!e}),Kd[t.type]&&this._model&&(this[Td]?this._pendingActions.push(t):(Bd.call(this,t,e.silent),e.flush?this._zr.flush(!0):!1!==e.flush&&v.browser.weChat&&this._throttledZrFlush(),Vd.call(this,e.silent),Gd.call(this,e.silent))))},Pd.appendData=function(t){var e,n;this._disposed?Yd(this.id):(e=t.seriesIndex,n=this.getModel().getSeriesByIndex(e),D&&xd(t.data&&n),n.appendData(t),this._scheduler.unfinished=!0)},Pd.on=Cd("on",!1),Pd.off=Cd("off",!1),Pd.one=Cd("one",!1);var Xd=["click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","globalout","contextmenu"];function Yd(t){D&&console.warn("Instance "+t+" has been disposed")}function jd(t,e){var n=t.get("z"),i=t.get("zlevel");e.group.traverse(function(t){"group"!==t.type&&(null!=n&&(t.z=n),null!=i&&(t.zlevel=i))})}function qd(){this.eventInfo}Pd._initEvents=function(){_d(Xd,function(u){function t(t){var e,n,i,o,a,r,s=this.getModel(),l=t.target,h="globalout"===u;h?n={}:l&&null!=l.dataIndex?n=(e=l.dataModel||s.getSeriesByIndex(l.seriesIndex))&&e.getDataParams(l.dataIndex,l.dataType,l)||{}:l&&l.eventData&&(n=k({},l.eventData)),n&&(i=n.componentType,o=n.componentIndex,"markLine"!==i&&"markPoint"!==i&&"markArea"!==i||(i="series",o=n.seriesIndex),r=(a=i&&null!=o&&s.getComponent(i,o))&&this["series"===a.mainType?"_chartsMap":"_componentsMap"][a.__viewId],D&&(h||a&&r||console.warn("model or view can not be found by params")),n.event=t,n.type=u,this._ecEventProcessor.eventInfo={targetEl:l,packedEvent:n,model:a,view:r},this.trigger(u,n))}t.zrEventfulCallAtLast=!0,this._zr.on(u,t,this)},this),_d($d,function(t,e){this._messageCenter.on(e,function(t){this.trigger(e,t)},this)},this)},Pd.isDisposed=function(){return this._disposed},Pd.clear=function(){this._disposed?Yd(this.id):this.setOption({series:[]},!0)},Pd.dispose=function(){var e,n;this._disposed?Yd(this.id):(this._disposed=!0,Yo(this.getDom(),lp,""),e=this._api,n=this._model,_d(this._componentsViews,function(t){t.dispose(n,e)}),_d(this._chartsViews,function(t){t.dispose(n,e)}),this._zr.dispose(),delete op[this.id])},b(kd,Ct),qd.prototype={constructor:qd,normalizeQuery:function(t){var e,s,l,h={},u={},c={};return B(t)?(e=Sd(t),h.mainType=e.main||null,h.subType=e.sub||null):(s=["Index","Name","Id"],l={name:1,dataIndex:1,dataType:1},P(t,function(t,e){for(var n=!1,i=0;i<s.length;i++){var o,a=s[i],r=e.lastIndexOf(a);0<r&&r===e.length-a.length&&("data"!==(o=e.slice(0,r))&&(h.mainType=o,h[a.toLowerCase()]=t,n=!0))}l.hasOwnProperty(e)&&(u[e]=t,n=!0),n||(c[e]=t)})),{cptQuery:h,dataQuery:u,otherQuery:c}},filter:function(t,e,n){var i=this.eventInfo;if(!i)return!0;var o=i.targetEl,a=i.packedEvent,r=i.model,s=i.view;if(!r||!s)return!0;var l=e.cptQuery,h=e.dataQuery;return u(l,r,"mainType")&&u(l,r,"subType")&&u(l,r,"index","componentIndex")&&u(l,r,"name")&&u(l,r,"id")&&u(h,a,"name")&&u(h,a,"dataIndex")&&u(h,a,"dataType")&&(!s.filterForExposedEvent||s.filterForExposedEvent(t,e.otherQuery,o,a));function u(t,e,n,i){return null==t[n]||e[i||n]===t[n]}},afterTrigger:function(){this.eventInfo=null}};var Kd={},$d={},Jd=[],Qd=[],tp=[],ep=[],np={},ip={},op={},ap={},rp=+new Date,sp=+new Date,lp="_echarts_instance_";function hp(t){ap[t]=!1}var up=hp;function cp(t){return op[n=lp,(e=t).getAttribute?e.getAttribute(n):e[n]];var e,n}function dp(t,e){np[t]=e}function pp(t){Qd.push(t)}function gp(t,e){xp(Jd,t,e,1e3)}function fp(t,e,n){"function"==typeof e&&(n=e,e="");var i=bd(t)?t.type:[t,t={event:e}][0];t.event=(t.event||i).toLowerCase(),e=t.event,xd(Dd.test(i)&&Dd.test(e)),Kd[i]||(Kd[i]={action:n,actionInfo:t}),$d[e]=i}function mp(t,e){nu.register(t,e)}function vp(t,e){xp(ep,t,e,1e3,"layout")}function yp(t,e){xp(ep,t,e,3e3,"visual")}function xp(t,e,n,i,o){if((wd(e)||bd(e))&&(n=e,e=i),D){if(isNaN(e)||null==e)throw new Error("Illegal priority");_d(t,function(t){xd(t.__raw!==n)})}var a=kc.wrapStageHandler(n,o);return a.__prio=e,a.__raw=n,t.push(a),a}function _p(t,e){ip[t]=e}function wp(t){return Mh.extend(t)}function bp(t){return hc.extend(t)}function Sp(t){return ec.extend(t)}function Mp(t){return gc.extend(t)}yp(2e3,Ac),pp(Mu),gp(900,function(t){var a=et();t.eachSeries(function(t){var e=t.get("stack");if(e){var n=a.get(e)||a.set(e,[]),i=t.getData(),o={stackResultDimension:i.getCalculationInfo("stackResultDimension"),stackedOverDimension:i.getCalculationInfo("stackedOverDimension"),stackedDimension:i.getCalculationInfo("stackedDimension"),stackedByDimension:i.getCalculationInfo("stackedByDimension"),isStackedByIndex:i.getCalculationInfo("isStackedByIndex"),data:i,seriesModel:t};if(!o.stackedDimension||!o.isStackedByIndex&&!o.stackedByDimension)return;n.length&&i.setCalculationInfo("stackedOnSeries",n[n.length-1].seriesModel),n.push(o)}}),a.each(Iu)}),_p("default",function(i,t){L(t=t||{},{text:"loading",color:"#c23531",textColor:"#000",maskColor:"rgba(255, 255, 255, 0.8)",zlevel:0});var o=new es({style:{fill:t.maskColor},zlevel:t.zlevel,z:1e4}),a=new ls({shape:{startAngle:-Lc/2,endAngle:-Lc/2+.1,r:10},style:{stroke:t.color,lineCap:"round",lineWidth:5},zlevel:t.zlevel,z:10001}),r=new es({style:{fill:"none",text:t.text,textPosition:"right",textDistance:10,textFill:t.textColor},zlevel:t.zlevel,z:10001});a.animateShape(!0).when(1e3,{endAngle:3*Lc/2}).start("circularInOut"),a.animateShape(!0).when(1e3,{startAngle:3*Lc/2}).delay(300).start("circularInOut");var e=new Mn;return e.add(a),e.add(r),e.add(o),e.resize=function(){var t=i.getWidth()/2,e=i.getHeight()/2;a.setShape({cx:t,cy:e});var n=a.shape.r;r.setShape({x:t-n,y:e-n,width:2*n,height:2*n}),o.setShape({x:0,y:0,width:i.getWidth(),height:i.getHeight()})},e.resize(),e}),fp({type:"highlight",event:"highlight",update:"highlight"},it),fp({type:"downplay",event:"downplay",update:"downplay"},it),dp("light",$c),dp("dark",td);function Ip(t){return t}function Tp(t,e,n,i,o){this._old=t,this._new=e,this._oldKeyGetter=n||Ip,this._newKeyGetter=i||Ip,this.context=o}function Ap(t,e,n,i,o){for(var a=0;a<t.length;a++){var r="_ec_"+o[i](t[a],a),s=e[r];null==s?(n.push(r),e[r]=a):(s.length||(e[r]=s=[s]),s.push(a))}}Tp.prototype={constructor:Tp,add:function(t){return this._add=t,this},update:function(t){return this._update=t,this},remove:function(t){return this._remove=t,this},execute:function(){var t=this._old,e=this._new,n={},i=[],o=[];for(Ap(t,{},i,"_oldKeyGetter",this),Ap(e,n,o,"_newKeyGetter",this),a=0;a<t.length;a++){null!=(r=n[s=i[a]])?((h=r.length)?(1===h&&(n[s]=null),r=r.shift()):n[s]=null,this._update&&this._update(r,a)):this._remove&&this._remove(a)}for(var a=0;a<o.length;a++){var r,s=o[a];if(n.hasOwnProperty(s)){if(null==(r=n[s]))continue;if(r.length)for(var l=0,h=r.length;l<h;l++)this._add&&this._add(r[l]);else this._add&&this._add(r)}}}};var Dp=et(["tooltip","label","itemName","itemId","seriesName"]);function Cp(a){var t={},r=t.encode={},s=et(),l=[],h=[],u=t.userOutput={dimensionNames:a.dimensions.slice(),encode:{}};P(a.dimensions,function(t){var e,n,o=a.getDimensionInfo(t),i=o.coordDim;i&&(D&&q(null==Dp.get(i)),e=o.coordDimIndex,Lp(r,i)[e]=t,o.isExtraCoord||(s.set(i,1),"ordinal"!==(n=o.type)&&"time"!==n&&(l[0]=t),Lp(u.encode,i)[e]=o.index),o.defaultTooltip&&h.push(t)),Dp.each(function(t,e){var n=Lp(r,e),i=o.otherDims[e];null!=i&&!1!==i&&(n[i]=o.name)})});var i=[],o={};s.each(function(t,e){var n=r[e];o[e]=n[0],i=i.concat(n)}),t.dataDimsOnCoord=i,t.encodeFirstDimNotExtra=o;var e=r.label;e&&e.length&&(l=e.slice());var n=r.tooltip;return n&&n.length?h=n.slice():h.length||(h=l.slice()),r.defaultedLabel=l,r.defaultedTooltip=h,t}function Lp(t,e){return t.hasOwnProperty(e)||(t[e]=[]),t[e]}function kp(t){return"category"===t?"ordinal":"time"===t?"time":"float"}function Pp(t){null!=t&&k(this,t),this.otherDims={}}var Np=V,Op="undefined",Ep={float:typeof Float64Array==Op?Array:Float64Array,int:typeof Int32Array==Op?Array:Int32Array,ordinal:Array,number:Array,time:Array},zp=typeof Uint32Array==Op?Array:Uint32Array,Rp=typeof Int32Array==Op?Array:Int32Array,Bp=typeof Uint16Array==Op?Array:Uint16Array;function Vp(t){return 65535<t._rawCount?zp:Bp}var Gp=["hasItemOption","_nameList","_idList","_invertedIndicesMap","_rawData","_chunkSize","_chunkCount","_dimValueGetter","_count","_rawCount","_nameDimIdx","_idDimIdx"],Fp=["_extent","_approximateExtent","_rawExtent"];function Wp(e,n){P(Gp.concat(n.__wrappedMethods||[]),function(t){n.hasOwnProperty(t)&&(e[t]=n[t])}),e.__wrappedMethods=n.__wrappedMethods,P(Fp,function(t){e[t]=C(n[t])}),e._calculationInfo=k(n._calculationInfo)}var Hp=function(t,e){t=t||["x","y"];for(var n={},i=[],o={},a=0;a<t.length;a++){var r=t[a];B(r)?r=new Pp({name:r}):r instanceof Pp||(r=new Pp(r));var s=r.name;r.type=r.type||"float",r.coordDim||(r.coordDim=s,r.coordDimIndex=0),r.otherDims=r.otherDims||{},i.push(s),(n[s]=r).index=a,r.createInvertedIndices&&(o[s]=[])}this.dimensions=i,this._dimensionInfos=n,this.hostModel=e,this.dataType,this._indices=null,this._count=0,this._rawCount=0,this._storage={},this._nameList=[],this._idList=[],this._optionModels=[],this._visual={},this._layout={},this._itemVisuals=[],this.hasItemVisual={},this._itemLayouts=[],this._graphicEls=[],this._chunkSize=1e5,this._chunkCount=0,this._rawData,this._rawExtent={},this._extent={},this._approximateExtent={},this._dimensionsSummary=Cp(this),this._invertedIndicesMap=o,this._calculationInfo={},this.userOutput=this._dimensionsSummary.userOutput},Zp=Hp.prototype;function Up(t,e,n,i,o){var a=Ep[e.type],r=i-1,s=e.name,l=t[s][r];if(l&&l.length<n){for(var h=new a(Math.min(o-r*n,n)),u=0;u<l.length;u++)h[u]=l[u];t[s][r]=h}for(var c=i*n;c<o;c+=n)t[s].push(new a(Math.min(o-c,n)))}function Xp(o){var a=o._invertedIndicesMap;P(a,function(t,e){var n=o._dimensionInfos[e].ordinalMeta;if(n){t=a[e]=new Rp(n.categories.length);for(var i=0;i<t.length;i++)t[i]=-1;for(i=0;i<o._count;i++)t[o.get(e,i)]=i}})}function Yp(t,e,n){var i,o,a,r,s,l,h;return null!=e&&(o=t._chunkSize,a=Math.floor(n/o),r=n%o,s=t.dimensions[e],(l=t._storage[s][a])&&(i=l[r],(h=t._dimensionInfos[s].ordinalMeta)&&h.categories.length&&(i=h.categories[i]))),i}function jp(t){return t}function qp(t){return t<this._count&&0<=t?this._indices[t]:-1}function Kp(t,e){var n=t._idList[e];return null==n&&(n=Yp(t,t._idDimIdx,e)),null==n&&(n="e\0\0"+e),n}function $p(t){return R(t)||(t=[t]),t}function Jp(t,e){for(var n=0;n<e.length;n++)t._dimensionInfos[e[n]]||console.error("Unkown dimension "+e[n])}function Qp(t,e){var n=t.dimensions,i=new Hp(N(n,t.getDimensionInfo,t),t.hostModel);Wp(i,t);for(var o=i._storage={},a=t._storage,r=0;r<n.length;r++){var s=n[r];a[s]&&(0<=M(e,s)?(o[s]=tg(a[s]),i._rawExtent[s]=eg(),i._extent[s]=null):o[s]=a[s])}return i}function tg(t){for(var e,n,i=new Array(t.length),o=0;o<t.length;o++)i[o]=(e=t[o],n=void 0,(n=e.constructor)===Array?e.slice():new n(e));return i}function eg(){return[1/0,-1/0]}Zp.type="list",Zp.hasItemOption=!0,Zp.getDimension=function(t){return"number"!=typeof t&&(isNaN(t)||this._dimensionInfos.hasOwnProperty(t))||(t=this.dimensions[t]),t},Zp.getDimensionInfo=function(t){return this._dimensionInfos[this.getDimension(t)]},Zp.getDimensionsOnCoord=function(){return this._dimensionsSummary.dataDimsOnCoord.slice()},Zp.mapDimension=function(t,e){var n=this._dimensionsSummary;if(null==e)return n.encodeFirstDimNotExtra[t];var i=n.encode[t];return!0===e?(i||[]).slice():i&&i[e]},Zp.initData=function(t,e,n){var i=Bh.isInstance(t)||O(t);if(i&&(t=new Tu(t,this.dimensions.length)),D&&!i&&("function"!=typeof t.getItem||"function"!=typeof t.count))throw new Error("Inavlid data provider.");this._rawData=t,this._storage={},this._indices=null,this._nameList=e||[],this._idList=[],this._nameRepeatCount={},n||(this.hasItemOption=!1),this.defaultDimValueGetter=Ou[this._rawData.getSource().sourceFormat],this._dimValueGetter=n=n||this.defaultDimValueGetter,this._dimValueGetterArrayRows=Ou.arrayRows,this._rawExtent={},this._initDataFromProvider(0,t.count()),t.pure&&(this.hasItemOption=!1)},Zp.getProvider=function(){return this._rawData},Zp.appendData=function(t){D&&q(!this._indices,"appendData can only be called on raw data.");var e=this._rawData,n=this.count();e.appendData(t);var i=e.count();e.persistent||(i+=n),this._initDataFromProvider(n,i)},Zp.appendValues=function(t,e){for(var n=this._chunkSize,i=this._storage,o=this.dimensions,a=o.length,r=this._rawExtent,s=this.count(),l=s+Math.max(t.length,e?e.length:0),h=this._chunkCount,u=0;u<a;u++){r[v=o[u]]||(r[v]=eg()),i[v]||(i[v]=[]),Up(i,this._dimensionInfos[v],n,h,l),this._chunkCount=i[v].length}for(var c=new Array(a),d=s;d<l;d++){for(var p=d-s,g=Math.floor(d/n),f=d%n,m=0;m<a;m++){var v=o[m],y=this._dimValueGetterArrayRows(t[p]||c,v,p,m);i[v][g][f]=y;var x=r[v];y<x[0]&&(x[0]=y),y>x[1]&&(x[1]=y)}e&&(this._nameList[d]=e[p])}this._rawCount=this._count=l,this._extent={},Xp(this)},Zp._initDataFromProvider=function(t,e){if(!(e<=t)){for(var n,i=this._chunkSize,o=this._rawData,a=this._storage,r=this.dimensions,s=r.length,l=this._dimensionInfos,h=this._nameList,u=this._idList,c=this._rawExtent,d=this._nameRepeatCount={},p=this._chunkCount,g=0;g<s;g++){c[T=r[g]]||(c[T]=eg());var f=l[T];0===f.otherDims.itemName&&(n=this._nameDimIdx=g),0===f.otherDims.itemId&&(this._idDimIdx=g),a[T]||(a[T]=[]),Up(a,f,i,p,e),this._chunkCount=a[T].length}for(var m=new Array(s),v=t;v<e;v++){m=o.getItem(v,m);for(var y,x,_,w,b,S=Math.floor(v/i),M=v%i,I=0;I<s;I++){var T,A=a[T=r[I]][S],D=this._dimValueGetter(m,T,v,I);A[M]=D;var C=c[T];D<C[0]&&(C[0]=D),D>C[1]&&(C[1]=D)}o.pure||(y=h[v],m&&null==y&&(null!=m.name?h[v]=y=m.name:null==n||(_=a[x=r[n]][S])&&(y=_[M],(w=l[x].ordinalMeta)&&w.categories.length&&(y=w.categories[y]))),null==(b=null==m?null:m.id)&&null!=y&&(d[y]=d[y]||0,0<d[b=y]&&(b+="__ec__"+d[y]),d[y]++),null!=b&&(u[v]=b))}!o.persistent&&o.clean&&o.clean(),this._rawCount=this._count=e,this._extent={},Xp(this)}},Zp.count=function(){return this._count},Zp.getIndices=function(){var t=this._indices;if(t){var e=t.constructor,n=this._count;if(e===Array){o=new e(n);for(var i=0;i<n;i++)o[i]=t[i]}else o=new e(t.buffer,0,n)}else for(var o=new(e=Vp(this))(this.count()),i=0;i<o.length;i++)o[i]=i;return o},Zp.get=function(t,e){if(!(0<=e&&e<this._count))return NaN;var n=this._storage;if(!n[t])return NaN;e=this.getRawIndex(e);var i=Math.floor(e/this._chunkSize),o=e%this._chunkSize;return n[t][i][o]},Zp.getByRawIndex=function(t,e){if(!(0<=e&&e<this._rawCount))return NaN;var n=this._storage[t];if(!n)return NaN;var i=Math.floor(e/this._chunkSize),o=e%this._chunkSize;return n[i][o]},Zp._getFast=function(t,e){var n=Math.floor(e/this._chunkSize),i=e%this._chunkSize;return this._storage[t][n][i]},Zp.getValues=function(t,e){var n=[];R(t)||(e=t,t=this.dimensions);for(var i=0,o=t.length;i<o;i++)n.push(this.get(t[i],e));return n},Zp.hasValue=function(t){for(var e=this._dimensionsSummary.dataDimsOnCoord,n=0,i=e.length;n<i;n++)if(isNaN(this.get(e[n],t)))return!1;return!0},Zp.getDataExtent=function(t){t=this.getDimension(t);var e=this._storage[t],n=eg();if(!e)return n;var i,o=this.count();if(!this._indices)return this._rawExtent[t].slice();if(i=this._extent[t])return i.slice();for(var a=(i=n)[0],r=i[1],s=0;s<o;s++){var l=this._getFast(t,this.getRawIndex(s));l<a&&(a=l),r<l&&(r=l)}return i=[a,r],this._extent[t]=i},Zp.getApproximateExtent=function(t){return t=this.getDimension(t),this._approximateExtent[t]||this.getDataExtent(t)},Zp.setApproximateExtent=function(t,e){e=this.getDimension(e),this._approximateExtent[e]=t.slice()},Zp.getCalculationInfo=function(t){return this._calculationInfo[t]},Zp.setCalculationInfo=function(t,e){Np(t)?k(this._calculationInfo,t):this._calculationInfo[t]=e},Zp.getSum=function(t){var e=0;if(this._storage[t])for(var n=0,i=this.count();n<i;n++){var o=this.get(t,n);isNaN(o)||(e+=o)}return e},Zp.getMedian=function(t){var n=[];this.each(t,function(t,e){isNaN(t)||n.push(t)});var e=[].concat(n).sort(function(t,e){return t-e}),i=this.count();return 0===i?0:i%2==1?e[(i-1)/2]:(e[i/2]+e[i/2-1])/2},Zp.rawIndexOf=function(t,e){var n=t&&this._invertedIndicesMap[t];if(D&&!n)throw new Error("Do not supported yet");var i=n[e];return null==i||isNaN(i)?-1:i},Zp.indexOfName=function(t){for(var e=0,n=this.count();e<n;e++)if(this.getName(e)===t)return e;return-1},Zp.indexOfRawIndex=function(t){if(t>=this._rawCount||t<0)return-1;if(!this._indices)return t;var e=this._indices,n=e[t];if(null!=n&&n<this._count&&n===t)return t;for(var i=0,o=this._count-1;i<=o;){var a=(i+o)/2|0;if(e[a]<t)i=1+a;else{if(!(e[a]>t))return a;o=a-1}}return-1},Zp.indicesOfNearest=function(t,e,n){var i=[];if(!this._storage[t])return i;null==n&&(n=1/0);for(var o=1/0,a=-1,r=0,s=0,l=this.count();s<l;s++){var h=e-this.get(t,s),u=Math.abs(h);u<=n&&((u<o||u===o&&0<=h&&a<0)&&(o=u,a=h,r=0),h===a&&(i[r++]=s))}return i.length=r,i},Zp.getRawIndex=jp,Zp.getRawDataItem=function(t){if(this._rawData.persistent)return this._rawData.getItem(this.getRawIndex(t));for(var e=[],n=0;n<this.dimensions.length;n++){var i=this.dimensions[n];e.push(this.get(i,t))}return e},Zp.getName=function(t){var e=this.getRawIndex(t);return this._nameList[e]||Yp(this,this._nameDimIdx,e)||""},Zp.getId=function(t){return Kp(this,this.getRawIndex(t))},Zp.each=function(t,e,n,i){if(this._count){"function"==typeof t&&(i=n,n=e,e=t,t=[]),n=n||i||this,t=N($p(t),this.getDimension,this),D&&Jp(this,t);for(var o=t.length,a=0;a<this.count();a++)switch(o){case 0:e.call(n,a);break;case 1:e.call(n,this.get(t[0],a),a);break;case 2:e.call(n,this.get(t[0],a),this.get(t[1],a),a);break;default:for(var r=0,s=[];r<o;r++)s[r]=this.get(t[r],a);s[r]=a,e.apply(n,s)}}},Zp.filterSelf=function(t,e,n,i){if(this._count){"function"==typeof t&&(i=n,n=e,e=t,t=[]),n=n||i||this,t=N($p(t),this.getDimension,this),D&&Jp(this,t);for(var o=this.count(),a=new(Vp(this))(o),r=[],s=t.length,l=0,h=t[0],u=0;u<o;u++){var c=this.getRawIndex(u);if(0===s)p=e.call(n,u);else if(1===s)var d=this._getFast(h,c),p=e.call(n,d,u);else{for(var g=0;g<s;g++)r[g]=this._getFast(h,c);r[g]=u,p=e.apply(n,r)}p&&(a[l++]=c)}return l<o&&(this._indices=a),this._count=l,this._extent={},this.getRawIndex=this._indices?qp:jp,this}},Zp.selectRange=function(t){if(this._count){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(n);D&&Jp(this,e);var i=e.length;if(i){var o=this.count(),a=new(Vp(this))(o),r=0,s=e[0],l=t[s][0],h=t[s][1],u=!1;if(!this._indices){var c=0;if(1===i){for(var d=this._storage[e[0]],p=0;p<this._chunkCount;p++)for(var g=d[p],f=Math.min(this._count-p*this._chunkSize,this._chunkSize),m=0;m<f;m++){(l<=(w=g[m])&&w<=h||isNaN(w))&&(a[r++]=c),c++}u=!0}else if(2===i){for(var d=this._storage[s],v=this._storage[e[1]],y=t[e[1]][0],x=t[e[1]][1],p=0;p<this._chunkCount;p++)for(var g=d[p],_=v[p],f=Math.min(this._count-p*this._chunkSize,this._chunkSize),m=0;m<f;m++){var w=g[m],b=_[m];(l<=w&&w<=h||isNaN(w))&&(y<=b&&b<=x||isNaN(b))&&(a[r++]=c),c++}u=!0}}if(!u)if(1===i)for(m=0;m<o;m++){var S=this.getRawIndex(m);(l<=(w=this._getFast(s,S))&&w<=h||isNaN(w))&&(a[r++]=S)}else for(m=0;m<o;m++){for(var M=!0,S=this.getRawIndex(m),p=0;p<i;p++){var I=e[p];((w=this._getFast(n,S))<t[I][0]||w>t[I][1])&&(M=!1)}M&&(a[r++]=this.getRawIndex(m))}return r<o&&(this._indices=a),this._count=r,this._extent={},this.getRawIndex=this._indices?qp:jp,this}}},Zp.mapArray=function(t,e,n,i){"function"==typeof t&&(i=n,n=e,e=t,t=[]),n=n||i||this;var o=[];return this.each(t,function(){o.push(e&&e.apply(this,arguments))},n),o},Zp.map=function(t,e,n,i){n=n||i||this,t=N($p(t),this.getDimension,this),D&&Jp(this,t);var o=Qp(this,t);o._indices=this._indices,o.getRawIndex=o._indices?qp:jp;for(var a=o._storage,r=[],s=this._chunkSize,l=t.length,h=this.count(),u=[],c=o._rawExtent,d=0;d<h;d++){for(var p=0;p<l;p++)u[p]=this.get(t[p],d);u[l]=d;var g=e&&e.apply(n,u);if(null!=g){"object"!=typeof g&&(r[0]=g,g=r);for(var f=this.getRawIndex(d),m=Math.floor(f/s),v=f%s,y=0;y<g.length;y++){var x=t[y],_=g[y],w=c[x],b=a[x];b&&(b[m][v]=_),_<w[0]&&(w[0]=_),_>w[1]&&(w[1]=_)}}}return o},Zp.downSample=function(t,e,n,i){for(var o=Qp(this,[t]),a=o._storage,r=[],s=Math.floor(1/e),l=a[t],h=this.count(),u=this._chunkSize,c=o._rawExtent[t],d=new(Vp(this))(h),p=0,g=0;g<h;g+=s){h-g<s&&(s=h-g,r.length=s);for(var f=0;f<s;f++){var m=this.getRawIndex(g+f),v=Math.floor(m/u),y=m%u;r[f]=l[v][y]}var x=n(r),_=this.getRawIndex(Math.min(g+i(r,x)||0,h-1)),w=_%u;(l[Math.floor(_/u)][w]=x)<c[0]&&(c[0]=x),x>c[1]&&(c[1]=x),d[p++]=_}return o._count=p,o._indices=d,o.getRawIndex=qp,o},Zp.getItemModel=function(t){var e=this.hostModel;return new Sl(this.getRawDataItem(t),e,e&&e.ecModel)},Zp.diff=function(e){var n=this;return new Tp(e?e.getIndices():[],this.getIndices(),function(t){return Kp(e,t)},function(t){return Kp(n,t)})},Zp.getVisual=function(t){var e=this._visual;return e&&e[t]},Zp.setVisual=function(t,e){if(Np(t))for(var n in t)t.hasOwnProperty(n)&&this.setVisual(n,t[n]);else this._visual=this._visual||{},this._visual[t]=e},Zp.setLayout=function(t,e){if(Np(t))for(var n in t)t.hasOwnProperty(n)&&this.setLayout(n,t[n]);else this._layout[t]=e},Zp.getLayout=function(t){return this._layout[t]},Zp.getItemLayout=function(t){return this._itemLayouts[t]},Zp.setItemLayout=function(t,e,n){this._itemLayouts[t]=n?k(this._itemLayouts[t]||{},e):e},Zp.clearItemLayouts=function(){this._itemLayouts.length=0},Zp.getItemVisual=function(t,e,n){var i=this._itemVisuals[t],o=i&&i[e];return null!=o||n?o:this.getVisual(e)},Zp.setItemVisual=function(t,e,n){var i=this._itemVisuals[t]||{},o=this.hasItemVisual;if(this._itemVisuals[t]=i,Np(e))for(var a in e)e.hasOwnProperty(a)&&(i[a]=e[a],o[a]=!0);else i[e]=n,o[e]=!0},Zp.clearAllVisual=function(){this._visual={},this._itemVisuals=[],this.hasItemVisual={}};function ng(t){t.seriesIndex=this.seriesIndex,t.dataIndex=this.dataIndex,t.dataType=this.dataType}function ig(t,e,n){Bh.isInstance(e)||(e=Bh.seriesDataToSource(e)),n=n||{},t=(t||[]).slice();for(var i,o,a,r,s,l=(n.dimsDef||[]).slice(),h=et(),u=et(),c=[],d=(i=e,o=t,a=l,r=n.dimCount,s=Math.max(i.dimensionsDetectCount||1,o.length,a.length,r||0),P(o,function(t){var e=t.dimsDef;e&&(s=Math.max(s,e.length))}),s),p=0;p<d;p++){var g=l[p]=k({},V(l[p])?l[p]:{name:l[p]}),f=g.name,m=c[p]=new Pp;null!=f&&null==h.get(f)&&(m.name=m.displayName=f,h.set(f,p)),null!=g.type&&(m.type=g.type),null!=g.displayName&&(m.displayName=g.displayName)}var v=n.encodeDef;!v&&n.encodeDefaulter&&(v=n.encodeDefaulter(e,d)),(v=et(v)).each(function(t,n){var i;1===(t=Oo(t).slice()).length&&!B(t[0])&&t[0]<0?v.set(n,!1):(i=v.set(n,[]),P(t,function(t,e){B(t)&&(t=h.get(t)),null!=t&&t<d&&(i[e]=t,x(c[t],n,e))}))});var y=0;function x(t,e,n){null!=Dp.get(e)?t.otherDims[e]=n:(t.coordDim=e,t.coordDimIndex=n,u.set(e,!0))}P(t,function(o,t){var a,r,s,e;B(o)?(a=o,o={}):(a=o.name,e=o.ordinalMeta,o.ordinalMeta=null,(o=C(o)).ordinalMeta=e,r=o.dimsDef,s=o.otherDims,o.name=o.coordDim=o.coordDimIndex=o.dimsDef=o.otherDims=null);var n=v.get(a);if(!1!==n){if(!(n=Oo(n)).length)for(var i=0;i<(r&&r.length||1);i++){for(;y<c.length&&null!=c[y].coordDim;)y++;y<c.length&&n.push(y++)}P(n,function(t,e){var n,i=c[t];x(L(i,o),a,e),null==i.name&&r&&(V(n=r[e])||(n={name:n}),i.name=i.displayName=n.name,i.defaultTooltip=n.defaultTooltip),s&&L(i.otherDims,s)})}});for(var _,w,b=n.generateCoord,S=null!=(M=n.generateCoordCount),M=b?M||1:0,I=b||"value",T=0;T<d;T++){null==(m=c[T]=c[T]||new Pp).coordDim&&(m.coordDim=og(I,u,S),m.coordDimIndex=0,(!b||M<=0)&&(m.isExtraCoord=!0),M--),null==m.name&&(m.name=og(m.coordDim,h)),null==m.type&&(_=e,w=T,m.name,Yh(_.data,_.sourceFormat,_.seriesLayoutBy,_.dimensionsDefine,_.startIndex,w)===Vh.Must||m.isExtraCoord&&(null!=m.otherDims.itemName||null!=m.otherDims.seriesName))&&(m.type="ordinal")}return c}function og(t,e,n){if(n||null!=e.get(t)){for(var i=0;null!=e.get(t+i);)i++;t+=i}return e.set(t,!0),t}Zp.setItemGraphicEl=function(t,e){var n=this.hostModel;e&&(e.dataIndex=t,e.dataType=this.dataType,e.seriesIndex=n&&n.seriesIndex,"group"===e.type&&e.traverse(ng,e)),this._graphicEls[t]=e},Zp.getItemGraphicEl=function(t){return this._graphicEls[t]},Zp.eachItemGraphicEl=function(n,i){P(this._graphicEls,function(t,e){t&&n&&n.call(i,t,e)})},Zp.cloneShallow=function(t){var e,n;return t||(e=N(this.dimensions,this.getDimensionInfo,this),t=new Hp(e,this.hostModel)),t._storage=this._storage,Wp(t,this),this._indices?(n=this._indices.constructor,t._indices=new n(this._indices)):t._indices=null,t.getRawIndex=t._indices?qp:jp,t},Zp.wrapMethod=function(t,e){var n=this[t];"function"==typeof n&&(this.__wrappedMethods=this.__wrappedMethods||[],this.__wrappedMethods.push(t),this[t]=function(){var t=n.apply(this,arguments);return e.apply(this,[t].concat(Y(arguments)))})},Zp.TRANSFERABLE_METHODS=["cloneShallow","downSample","map"],Zp.CHANGABLE_METHODS=["filterSelf","selectRange"];var ag=function(t,e){return ig((e=e||{}).coordDimensions||[],t,{dimsDef:e.dimensionsDefine||t.dimensionsDefine,encodeDef:e.encodeDefine||t.encodeDefine,dimCount:e.dimensionsCount,encodeDefaulter:e.encodeDefaulter,generateCoord:e.generateCoord,generateCoordCount:e.generateCoordCount})};function rg(t){this.coordSysName=t,this.coordSysDims=[],this.axisMap=et(),this.categoryAxisMap=et(),this.firstCategoryDimIndex=null}var sg={cartesian2d:function(t,e,n,i){var o=t.getReferringComponents("xAxis")[0],a=t.getReferringComponents("yAxis")[0];if(D){if(!o)throw new Error('xAxis "'+Z(t.get("xAxisIndex"),t.get("xAxisId"),0)+'" not found');if(!a)throw new Error('yAxis "'+Z(t.get("xAxisIndex"),t.get("yAxisId"),0)+'" not found')}e.coordSysDims=["x","y"],n.set("x",o),n.set("y",a),lg(o)&&(i.set("x",o),e.firstCategoryDimIndex=0),lg(a)&&(i.set("y",a),e.firstCategoryDimIndex,e.firstCategoryDimIndex=1)},singleAxis:function(t,e,n,i){var o=t.getReferringComponents("singleAxis")[0];if(D&&!o)throw new Error("singleAxis should be specified.");e.coordSysDims=["single"],n.set("single",o),lg(o)&&(i.set("single",o),e.firstCategoryDimIndex=0)},polar:function(t,e,n,i){var o=t.getReferringComponents("polar")[0],a=o.findAxisModel("radiusAxis"),r=o.findAxisModel("angleAxis");if(D){if(!r)throw new Error("angleAxis option not found");if(!a)throw new Error("radiusAxis option not found")}e.coordSysDims=["radius","angle"],n.set("radius",a),n.set("angle",r),lg(a)&&(i.set("radius",a),e.firstCategoryDimIndex=0),lg(r)&&(i.set("angle",r),null==e.firstCategoryDimIndex&&(e.firstCategoryDimIndex=1))},geo:function(t,e,n,i){e.coordSysDims=["lng","lat"]},parallel:function(t,o,a,r){var s=t.ecModel,e=s.getComponent("parallel",t.get("parallelIndex")),l=o.coordSysDims=e.dimensions.slice();P(e.parallelAxisIndex,function(t,e){var n=s.getComponent("parallelAxis",t),i=l[e];a.set(i,n),lg(n)&&null==o.firstCategoryDimIndex&&(r.set(i,n),o.firstCategoryDimIndex=e)})}};function lg(t){return"category"===t.get("type")}function hg(t,n,e){var i,o,a,r,s,l,h,u=(e=e||{}).byIndex,c=e.stackedCoordDimension,d=!(!t||!t.get("stack"));return P(n,function(t,e){B(t)&&(n[e]=t={name:t}),d&&!t.isExtraCoord&&(u||i||!t.ordinalMeta||(i=t),o||"ordinal"===t.type||"time"===t.type||c&&c!==t.coordDim||(o=t))}),!o||u||i||(u=!0),o&&(a="__\0ecstackresult",r="__\0ecstackedover",i&&(i.createInvertedIndices=!0),s=o.coordDim,l=o.type,h=0,P(n,function(t){t.coordDim===s&&h++}),n.push({name:a,coordDim:s,coordDimIndex:h,type:l,isExtraCoord:!0,isCalculationCoord:!0}),h++,n.push({name:r,coordDim:r,coordDimIndex:h,type:l,isExtraCoord:!0,isCalculationCoord:!0})),{stackedDimension:o&&o.name,stackedByDimension:i&&i.name,isStackedByIndex:u,stackedOverDimension:r,stackResultDimension:a}}function ug(t,e){return!!e&&e===t.getCalculationInfo("stackedDimension")}function cg(t,e){return ug(t,e)?t.getCalculationInfo("stackResultDimension"):e}function dg(t,e,n){n=n||{},Bh.isInstance(t)||(t=Bh.seriesDataToSource(t));var i,o=e.get("coordinateSystem"),a=nu.get(o),r=function(t){var e=t.get("coordinateSystem"),n=new rg(e),i=sg[e];if(i)return i(t,n,n.axisMap,n.categoryAxisMap),n}(e);r&&(i=N(r.coordSysDims,function(t){var e,n={name:t},i=r.axisMap.get(t);return i&&(e=i.get("type"),n.type=kp(e)),n})),i=i||(a&&(a.getDimensionsInfo?a.getDimensionsInfo():a.dimensions.slice())||["x","y"]);var s,l,h=ag(t,{coordDimensions:i,generateCoord:n.generateCoord,encodeDefaulter:n.useEncodeDefaulter?z(Zh,i,e):null});r&&P(h,function(t,e){var n=t.coordDim,i=r.categoryAxisMap.get(n);i&&(null==s&&(s=e),t.ordinalMeta=i.getOrdinalMeta()),null!=t.otherDims.itemName&&(l=!0)}),l||null==s||(h[s].otherDims.itemName=0);var u=hg(e,h),c=new Hp(h,e);c.setCalculationInfo(u);var d=null!=s&&function(t){if(t.sourceFormat===Lh){var e=function(t){var e=0;for(;e<t.length&&null==t[e];)e++;return t[e]}(t.data||[]);return null!=e&&!R(Ro(e))}}(t)?function(t,e,n,i){return i===s?n:this.defaultDimValueGetter(t,e,n,i)}:null;return c.hasItemOption=!1,c.initData(t,null,d),c}function pg(t){this._setting=t||{},this._extent=[1/0,-1/0],this._interval=0,this.init&&this.init.apply(this,arguments)}function gg(t){this.categories=t.categories||[],this._needCollect=t.needCollect,this._deduplication=t.deduplication,this._map}pg.prototype.parse=function(t){return t},pg.prototype.getSetting=function(t){return this._setting[t]},pg.prototype.contain=function(t){var e=this._extent;return t>=e[0]&&t<=e[1]},pg.prototype.normalize=function(t){var e=this._extent;return e[1]===e[0]?.5:(t-e[0])/(e[1]-e[0])},pg.prototype.scale=function(t){var e=this._extent;return t*(e[1]-e[0])+e[0]},pg.prototype.unionExtent=function(t){var e=this._extent;t[0]<e[0]&&(e[0]=t[0]),t[1]>e[1]&&(e[1]=t[1])},pg.prototype.unionExtentFromData=function(t,e){this.unionExtent(t.getApproximateExtent(e))},pg.prototype.getExtent=function(){return this._extent.slice()},pg.prototype.setExtent=function(t,e){var n=this._extent;isNaN(t)||(n[0]=t),isNaN(e)||(n[1]=e)},pg.prototype.isBlank=function(){return this._isBlank},pg.prototype.setBlank=function(t){this._isBlank=t},pg.prototype.getLabel=null,Qo(pg),oa(pg,{registerWhenExtend:!0}),gg.createByAxisModel=function(t){var e=t.option,n=e.data,i=n&&N(n,vg);return new gg({categories:i,needCollect:!i,deduplication:!1!==e.dedplication})};var fg=gg.prototype;function mg(t){return t._map||(t._map=et(t.categories))}function vg(t){return V(t)&&null!=t.value?t.value:t+""}fg.getOrdinal=function(t){return mg(this).get(t)},fg.parseAndCollect=function(t){var e=this._needCollect;if("string"!=typeof t&&!e)return t;if(e&&!this._deduplication)return n=this.categories.length,this.categories[n]=t,n;var n,i=mg(this);return null==(n=i.get(t))&&(e?(n=this.categories.length,this.categories[n]=t,i.set(t,n)):n=NaN),n};var yg=pg.prototype,xg=pg.extend({type:"ordinal",init:function(t,e){t&&!R(t)||(t=new gg({categories:t})),this._ordinalMeta=t,this._extent=e||[0,t.categories.length-1]},parse:function(t){return"string"==typeof t?this._ordinalMeta.getOrdinal(t):Math.round(t)},contain:function(t){return t=this.parse(t),yg.contain.call(this,t)&&null!=this._ordinalMeta.categories[t]},normalize:function(t){return yg.normalize.call(this,this.parse(t))},scale:function(t){return Math.round(yg.scale.call(this,t))},getTicks:function(){for(var t=[],e=this._extent,n=e[0];n<=e[1];)t.push(n),n++;return t},getLabel:function(t){if(!this.isBlank())return this._ordinalMeta.categories[t]},count:function(){return this._extent[1]-this._extent[0]+1},unionExtentFromData:function(t,e){this.unionExtent(t.getApproximateExtent(e))},getOrdinalMeta:function(){return this._ordinalMeta},niceTicks:it,niceExtent:it});xg.create=function(){return new xg};var _g=kl;function wg(t){return Ol(t)+2}function bg(t,e,n){t[e]=Math.max(Math.min(t[e],n[1]),n[0])}function Sg(t,e){isFinite(t[0])||(t[0]=e[0]),isFinite(t[1])||(t[1]=e[1]),bg(t,0,e),bg(t,1,e),t[0]>t[1]&&(t[0]=t[1])}var Mg=kl,Ig=pg.extend({type:"interval",_interval:0,_intervalPrecision:2,setExtent:function(t,e){var n=this._extent;isNaN(t)||(n[0]=parseFloat(t)),isNaN(e)||(n[1]=parseFloat(e))},unionExtent:function(t){var e=this._extent;t[0]<e[0]&&(e[0]=t[0]),t[1]>e[1]&&(e[1]=t[1]),Ig.prototype.setExtent.call(this,e[0],e[1])},getInterval:function(){return this._interval},setInterval:function(t){this._interval=t,this._niceExtent=this._extent.slice(),this._intervalPrecision=wg(t)},getTicks:function(t){var e=this._interval,n=this._extent,i=this._niceExtent,o=this._intervalPrecision,a=[];if(!e)return a;n[0]<i[0]&&(t?a.push(Mg(i[0]-e)):a.push(n[0]));for(var r=i[0];r<=i[1]&&(a.push(r),(r=Mg(r+e,o))!==a[a.length-1]);)if(1e4<a.length)return[];var s=a.length?a[a.length-1]:i[1];return n[1]>s&&(t?a.push(s+e):a.push(n[1])),a},getMinorTicks:function(t){for(var e=this.getTicks(!0),n=[],i=this.getExtent(),o=1;o<e.length;o++){for(var a=e[o],r=e[o-1],s=0,l=[],h=(a-r)/t;s<t-1;){var u=kl(r+(s+1)*h);u>i[0]&&u<i[1]&&l.push(u),s++}n.push(l)}return n},getLabel:function(t,e){if(null==t)return"";var n=e&&e.precision;return null==n?n=Ol(t)||0:"auto"===n&&(n=this._intervalPrecision),jl(t=Mg(t,n,!0))},niceTicks:function(t,e,n){t=t||5;var i,o=this._extent,a=o[1]-o[0];isFinite(a)&&(a<0&&(a=-a,o.reverse()),i=function(t,e,n,i){var o={},a=t[1]-t[0],r=o.interval=Zl(a/e,!0);null!=n&&r<n&&(r=o.interval=n),null!=i&&i<r&&(r=o.interval=i);var s=o.intervalPrecision=wg(r);return Sg(o.niceTickExtent=[_g(Math.ceil(t[0]/r)*r,s),_g(Math.floor(t[1]/r)*r,s)],t),o}(o,t,e,n),this._intervalPrecision=i.intervalPrecision,this._interval=i.interval,this._niceExtent=i.niceTickExtent)},niceExtent:function(t){var e,n=this._extent;n[0]===n[1]&&(0!==n[0]?(e=n[0],t.fixMax||(n[1]+=e/2),n[0]-=e/2):n[1]=1);var i=n[1]-n[0];isFinite(i)||(n[0]=0,n[1]=1),this.niceTicks(t.splitNumber,t.minInterval,t.maxInterval);var o=this._interval;t.fixMin||(n[0]=Mg(Math.floor(n[0]/o)*o)),t.fixMax||(n[1]=Mg(Math.ceil(n[1]/o)*o))}});Ig.create=function(){return new Ig};var Tg="__ec_stack_",Ag="undefined"!=typeof Float32Array?Float32Array:Array;function Dg(t){return t.get("stack")||Tg+t.seriesIndex}function Cg(t){return t.dim+t.index}function Lg(t,e){var n=[];return e.eachSeriesByType(t,function(t){zg(t)&&!Rg(t)&&n.push(t)}),n}function kg(t){var f=function(t){var l={};P(t,function(t){var e=t.coordinateSystem.getBaseAxis();if("time"===e.type||"value"===e.type)for(var n=t.getData(),i=e.dim+"_"+e.index,o=n.mapDimension(e.dim),a=0,r=n.count();a<r;++a){var s=n.get(o,a);l[i]?l[i].push(s):l[i]=[s]}});var e=[];for(var n in l)if(l.hasOwnProperty(n)){var i=l[n];if(i){i.sort(function(t,e){return t-e});for(var o=null,a=1;a<i.length;++a){var r=i[a]-i[a-1];0<r&&(o=null===o?r:Math.min(o,r))}e[n]=o}}return e}(t),m=[];return P(t,function(t){var e,n,i,o,a,r,s,l=t.coordinateSystem.getBaseAxis(),h=l.getExtent();r="category"===l.type?l.getBandWidth():"value"===l.type||"time"===l.type?(e=l.dim+"_"+l.index,n=f[e],i=Math.abs(h[1]-h[0]),o=l.scale.getExtent(),a=Math.abs(o[1]-o[0]),n?i/a*n:i):(s=t.getData(),Math.abs(h[1]-h[0])/s.count());var u=Ll(t.get("barWidth"),r),c=Ll(t.get("barMaxWidth"),r),d=Ll(t.get("barMinWidth")||1,r),p=t.get("barGap"),g=t.get("barCategoryGap");m.push({bandWidth:r,barWidth:u,barMaxWidth:c,barMinWidth:d,barGap:p,barCategoryGap:g,axisKey:Cg(l),stackId:Dg(t)})}),Pg(m)}function Pg(t){var d={};P(t,function(t,e){var n=t.axisKey,i=t.bandWidth,o=d[n]||{bandWidth:i,remainedWidth:i,autoWidthCount:0,categoryGap:"20%",gap:"30%",stacks:{}},a=o.stacks;d[n]=o;var r=t.stackId;a[r]||o.autoWidthCount++,a[r]=a[r]||{width:0,maxWidth:0};var s=t.barWidth;s&&!a[r].width&&(a[r].width=s,s=Math.min(o.remainedWidth,s),o.remainedWidth-=s);var l=t.barMaxWidth;l&&(a[r].maxWidth=l);var h=t.barMinWidth;h&&(a[r].minWidth=h);var u=t.barGap;null!=u&&(o.gap=u);var c=t.barCategoryGap;null!=c&&(o.categoryGap=c)});var p={};return P(d,function(t,n){p[n]={};var e=t.stacks,i=t.bandWidth,o=Ll(t.categoryGap,i),a=Ll(t.gap,1),r=t.remainedWidth,s=t.autoWidthCount,l=(r-o)/(s+(s-1)*a),l=Math.max(l,0);P(e,function(t){var e,n=t.maxWidth,i=t.minWidth;t.width?(e=t.width,n&&(e=Math.min(e,n)),i&&(e=Math.max(e,i)),t.width=e,r-=e+a*e,s--):(e=l,n&&n<e&&(e=Math.min(n,r)),i&&e<i&&(e=i),e!==l&&(t.width=e,r-=e+a*e,s--))}),l=(r-o)/(s+(s-1)*a),l=Math.max(l,0);var h,u=0;P(e,function(t,e){t.width||(t.width=l),u+=(h=t).width*(1+a)}),h&&(u-=h.width*a);var c=-u/2;P(e,function(t,e){p[n][e]=p[n][e]||{bandWidth:i,offset:c,width:t.width},c+=t.width*(1+a)})}),p}function Ng(t,e,n){if(t&&e){var i=t[Cg(e)];return null!=i&&null!=n&&(i=i[Dg(n)]),i}}function Og(t,e){var n=Lg(t,e),T=kg(n),A={};P(n,function(t){var e=t.getData(),n=t.coordinateSystem,i=n.getBaseAxis(),o=Dg(t),a=T[Cg(i)][o],r=a.offset,s=a.width,l=n.getOtherAxis(i),h=t.get("barMinHeight")||0;A[o]=A[o]||[],e.setLayout({bandWidth:a.bandWidth,offset:r,size:s});for(var u=e.mapDimension(l.dim),c=e.mapDimension(i.dim),d=ug(e,u),p=l.isHorizontal(),g=Bg(0,l),f=0,m=e.count();f<m;f++){var v,y,x,_,w,b,S,M=e.get(u,f),I=e.get(c,f);isNaN(M)||isNaN(I)||(v=0<=M?"p":"n",y=g,d&&(A[o][I]||(A[o][I]={p:g,n:g}),y=A[o][I][v]),p?(x=y,_=(S=n.dataToPoint([M,I]))[1]+r,w=S[0]-g,b=s,Math.abs(w)<h&&(w=(w<0?-1:1)*h),d&&(A[o][I][v]+=w)):(x=(S=n.dataToPoint([I,M]))[0]+r,_=y,w=s,b=S[1]-g,Math.abs(b)<h&&(b=(b<=0?-1:1)*h),d&&(A[o][I][v]+=b)),e.setItemLayout(f,{x:x,y:_,width:w,height:b}))}},this)}var Eg={seriesType:"bar",plan:cc(),reset:function(t){if(zg(t)&&Rg(t)){var e=t.getData(),u=t.coordinateSystem,n=u.getBaseAxis(),c=u.getOtherAxis(n),d=e.mapDimension(c.dim),p=e.mapDimension(n.dim),g=c.isHorizontal(),f=g?0:1,m=Ng(kg([t]),n,t).width;return.5<m||(m=.5),{progress:function(t,e){var n,i=t.count,o=new Ag(2*i),a=new Ag(i),r=[],s=[],l=0,h=0;for(;null!=(n=t.next());)s[f]=e.get(d,n),s[1-f]=e.get(p,n),r=u.dataToPoint(s,null,r),o[l++]=r[0],o[l++]=r[1],a[h++]=n;e.setLayout({largePoints:o,largeDataIndices:a,barWidth:m,valueAxisStart:Bg(0,c),valueAxisHorizontal:g})}}}}};function zg(t){return t.coordinateSystem&&"cartesian2d"===t.coordinateSystem.type}function Rg(t){return t.pipelineContext&&t.pipelineContext.large}function Bg(t,e){return e.toGlobalCoord(e.dataToCoord("log"===e.type?1:0))}var Vg=Ig.prototype,Gg=Math.ceil,Fg=Math.floor,Wg=36e5,Hg=864e5,Zg=Ig.extend({type:"time",getLabel:function(t){var e=this._stepLvl,n=new Date(t);return rh(e[0],n,this.getSetting("useUTC"))},niceExtent:function(t){var e,n=this._extent;n[0]===n[1]&&(n[0]-=Hg,n[1]+=Hg),n[1]===-1/0&&n[0]===1/0&&(e=new Date,n[1]=+new Date(e.getFullYear(),e.getMonth(),e.getDate()),n[0]=n[1]-Hg),this.niceTicks(t.splitNumber,t.minInterval,t.maxInterval);var i=this._interval;t.fixMin||(n[0]=kl(Fg(n[0]/i)*i)),t.fixMax||(n[1]=kl(Gg(n[1]/i)*i))},niceTicks:function(t,e,n){t=t||10;var i=this._extent,o=i[1]-i[0],a=o/t;null!=e&&a<e&&(a=e),null!=n&&n<a&&(a=n);var r=Ug.length,s=function(t,e,n,i){for(;n<i;){var o=n+i>>>1;t[o][1]<e?n=1+o:i=o}return n}(Ug,a,0,r),l=Ug[Math.min(s,r-1)],h=l[1];"year"===l[0]&&(h*=Zl(o/h/t,!0));var u=this.getSetting("useUTC")?0:60*new Date(+i[0]||+i[1]).getTimezoneOffset()*1e3,c=[Math.round(Gg((i[0]-u)/h)*h+u),Math.round(Fg((i[1]-u)/h)*h+u)];Sg(c,i),this._stepLvl=l,this._interval=h,this._niceExtent=c},parse:function(t){return+Fl(t)}});P(["contain","normalize"],function(e){Zg.prototype[e]=function(t){return Vg[e].call(this,this.parse(t))}});var Ug=[["hh:mm:ss",1e3],["hh:mm:ss",5e3],["hh:mm:ss",1e4],["hh:mm:ss",15e3],["hh:mm:ss",3e4],["hh:mm\nMM-dd",6e4],["hh:mm\nMM-dd",3e5],["hh:mm\nMM-dd",6e5],["hh:mm\nMM-dd",9e5],["hh:mm\nMM-dd",18e5],["hh:mm\nMM-dd",Wg],["hh:mm\nMM-dd",72e5],["hh:mm\nMM-dd",6*Wg],["hh:mm\nMM-dd",432e5],["MM-dd\nyyyy",Hg],["MM-dd\nyyyy",2*Hg],["MM-dd\nyyyy",3*Hg],["MM-dd\nyyyy",4*Hg],["MM-dd\nyyyy",5*Hg],["MM-dd\nyyyy",6*Hg],["week",7*Hg],["MM-dd\nyyyy",864e6],["week",14*Hg],["week",21*Hg],["month",31*Hg],["week",42*Hg],["month",62*Hg],["week",70*Hg],["quarter",95*Hg],["month",31*Hg*4],["month",13392e6],["half-year",16416e6],["month",31*Hg*8],["month",26784e6],["year",380*Hg]];Zg.create=function(t){return new Zg({useUTC:t.ecModel.get("useUTC")})};var Xg=pg.prototype,Yg=Ig.prototype,jg=Ol,qg=kl,Kg=Math.floor,$g=Math.ceil,Jg=Math.pow,Qg=Math.log,tf=pg.extend({type:"log",base:10,$constructor:function(){pg.apply(this,arguments),this._originalScale=new Ig},getTicks:function(t){var n=this._originalScale,i=this._extent,o=n.getExtent();return N(Yg.getTicks.call(this,t),function(t){var e=kl(Jg(this.base,t)),e=t===i[0]&&n.__fixMin?ef(e,o[0]):e;return e=t===i[1]&&n.__fixMax?ef(e,o[1]):e},this)},getMinorTicks:Yg.getMinorTicks,getLabel:Yg.getLabel,scale:function(t){return t=Xg.scale.call(this,t),Jg(this.base,t)},setExtent:function(t,e){var n=this.base;t=Qg(t)/Qg(n),e=Qg(e)/Qg(n),Yg.setExtent.call(this,t,e)},getExtent:function(){var t=this.base,e=Xg.getExtent.call(this);e[0]=Jg(t,e[0]),e[1]=Jg(t,e[1]);var n=this._originalScale,i=n.getExtent();return n.__fixMin&&(e[0]=ef(e[0],i[0])),n.__fixMax&&(e[1]=ef(e[1],i[1])),e},unionExtent:function(t){this._originalScale.unionExtent(t);var e=this.base;t[0]=Qg(t[0])/Qg(e),t[1]=Qg(t[1])/Qg(e),Xg.unionExtent.call(this,t)},unionExtentFromData:function(t,e){this.unionExtent(t.getApproximateExtent(e))},niceTicks:function(t){t=t||10;var e=this._extent,n=e[1]-e[0];if(!(n==1/0||n<=0)){var i=Wl(n);for(t/n*i<=.5&&(i*=10);!isNaN(i)&&Math.abs(i)<1&&0<Math.abs(i);)i*=10;var o=[kl($g(e[0]/i)*i),kl(Kg(e[1]/i)*i)];this._interval=i,this._niceExtent=o}},niceExtent:function(t){Yg.niceExtent.call(this,t);var e=this._originalScale;e.__fixMin=t.fixMin,e.__fixMax=t.fixMax}});function ef(t,e){return qg(t,jg(e))}function nf(t,e){var n,i,o,a=t.type,r=e.getMin(),s=e.getMax(),l=null!=r,h=null!=s,u=t.getExtent();"ordinal"===a?n=e.getCategories().length:(R(i=e.get("boundaryGap"))||(i=[i||0,i||0]),"boolean"==typeof i[0]&&(D&&console.warn('Boolean type for boundaryGap is only allowed for ordinal axis. Please use string in percentage instead, e.g., "20%". Currently, boundaryGap is set to be 0.'),i=[0,0]),i[0]=Ll(i[0],1),i[1]=Ll(i[1],1),o=u[1]-u[0]||Math.abs(u[0])),null==r&&(r="ordinal"===a?n?0:NaN:u[0]-i[0]*o),null==s&&(s="ordinal"===a?n?n-1:NaN:u[1]+i[1]*o),"dataMin"===r?r=u[0]:"function"==typeof r&&(r=r({min:u[0],max:u[1]})),"dataMax"===s?s=u[1]:"function"==typeof s&&(s=s({min:u[0],max:u[1]})),null!=r&&isFinite(r)||(r=NaN),null!=s&&isFinite(s)||(s=NaN),t.setBlank(H(r)||H(s)||"ordinal"===a&&!t.getOrdinalMeta().categories.length),e.getNeedCrossZero()&&(0<r&&0<s&&!l&&(r=0),r<0&&s<0&&!h&&(s=0));var c,d,p,g,f=e.ecModel;return f&&"time"===a&&(P(c=Lg("bar",f),function(t){d|=t.getBaseAxis()===e.axis}),d&&(p=kg(c),r=(g=function(t,e,n,i){var o=n.axis.getExtent(),a=o[1]-o[0],r=Ng(i,n.axis);if(void 0===r)return{min:t,max:e};var s=1/0;P(r,function(t){s=Math.min(t.offset,s)});var l=-1/0;P(r,function(t){l=Math.max(t.offset+t.width,l)}),s=Math.abs(s),l=Math.abs(l);var h=s+l,u=e-t,c=u/(1-(s+l)/a)-u;return{min:t-=s/h*c,max:e+=l/h*c}}(r,s,e,p)).min,s=g.max)),[r,s]}function of(t,e){var n=nf(t,e),i=null!=e.getMin(),o=null!=e.getMax(),a=e.get("splitNumber");"log"===t.type&&(t.base=e.get("logBase"));var r=t.type;t.setExtent(n[0],n[1]),t.niceExtent({splitNumber:a,fixMin:i,fixMax:o,minInterval:"interval"===r||"time"===r?e.get("minInterval"):null,maxInterval:"interval"===r||"time"===r?e.get("maxInterval"):null});var s=e.get("interval");null!=s&&t.setInterval&&t.setInterval(s)}function af(t,e){if(e=e||t.get("type"))switch(e){case"category":return new xg(t.getOrdinalMeta?t.getOrdinalMeta():t.getCategories(),[1/0,-1/0]);case"value":return new Ig;default:return(pg.getClass(e)||Ig).create(t)}}function rf(n){var e,i=n.getLabelModel().get("formatter"),o="category"===n.type?n.scale.getExtent()[0]:null;return"string"==typeof i?(e=i,i=function(t){return t=n.scale.getLabel(t),e.replace("{value}",null!=t?t:"")}):"function"==typeof i?function(t,e){return null!=o&&(e=t-o),i(sf(n,t),e)}:function(t){return n.scale.getLabel(t)}}function sf(t,e){return"category"===t.type?t.scale.getLabel(e):e}function lf(t){var e=t.get("interval");return null==e?"auto":e}function hf(t){return"category"===t.type&&0===lf(t.getLabelModel())}P(["contain","normalize"],function(e){tf.prototype[e]=function(t){return t=Qg(t)/Qg(this.base),Xg[e].call(this,t)}}),tf.create=function(){return new tf};var uf={getMin:function(t){var e=this.option,n=t||null==e.rangeStart?e.min:e.rangeStart;return this.axis&&null!=n&&"dataMin"!==n&&"function"!=typeof n&&!H(n)&&(n=this.axis.scale.parse(n)),n},getMax:function(t){var e=this.option,n=t||null==e.rangeEnd?e.max:e.rangeEnd;return this.axis&&null!=n&&"dataMax"!==n&&"function"!=typeof n&&!H(n)&&(n=this.axis.scale.parse(n)),n},getNeedCrossZero:function(){var t=this.option;return null==t.rangeStart&&null==t.rangeEnd&&!t.scale},getCoordSysModel:it,setRange:function(t,e){this.option.rangeStart=t,this.option.rangeEnd=e},resetRange:function(){this.option.rangeStart=this.option.rangeEnd=null}},cf=Ms({type:"triangle",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(t,e){var n=e.cx,i=e.cy,o=e.width/2,a=e.height/2;t.moveTo(n,i-a),t.lineTo(n+o,i+a),t.lineTo(n-o,i+a),t.closePath()}}),df=Ms({type:"diamond",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(t,e){var n=e.cx,i=e.cy,o=e.width/2,a=e.height/2;t.moveTo(n,i-a),t.lineTo(n+o,i),t.lineTo(n,i+a),t.lineTo(n-o,i),t.closePath()}}),pf=Ms({type:"pin",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var n=e.x,i=e.y,o=e.width/5*3,a=Math.max(o,e.height),r=o/2,s=r*r/(a-r),l=i-a+r+s,h=Math.asin(s/r),u=Math.cos(h)*r,c=Math.sin(h),d=Math.cos(h),p=.6*r,g=.7*r;t.moveTo(n-u,l+s),t.arc(n,l,r,Math.PI-h,2*Math.PI+h),t.bezierCurveTo(n+u-c*p,l+s+d*p,n,i-g,n,i),t.bezierCurveTo(n,i-g,n-u+c*p,l+s+d*p,n-u,l+s),t.closePath()}}),gf=Ms({type:"arrow",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var n=e.height,i=e.width,o=e.x,a=e.y,r=i/3*2;t.moveTo(o,a),t.lineTo(o+r,a+n),t.lineTo(o,a+n/4*3),t.lineTo(o-r,a+n),t.lineTo(o,a),t.closePath()}}),ff={line:function(t,e,n,i,o){o.x1=t,o.y1=e+i/2,o.x2=t+n,o.y2=e+i/2},rect:function(t,e,n,i,o){o.x=t,o.y=e,o.width=n,o.height=i},roundRect:function(t,e,n,i,o){o.x=t,o.y=e,o.width=n,o.height=i,o.r=Math.min(n,i)/4},square:function(t,e,n,i,o){var a=Math.min(n,i);o.x=t,o.y=e,o.width=a,o.height=a},circle:function(t,e,n,i,o){o.cx=t+n/2,o.cy=e+i/2,o.r=Math.min(n,i)/2},diamond:function(t,e,n,i,o){o.cx=t+n/2,o.cy=e+i/2,o.width=n,o.height=i},pin:function(t,e,n,i,o){o.x=t+n/2,o.y=e+i/2,o.width=n,o.height=i},arrow:function(t,e,n,i,o){o.x=t+n/2,o.y=e+i/2,o.width=n,o.height=i},triangle:function(t,e,n,i,o){o.cx=t+n/2,o.cy=e+i/2,o.width=n,o.height=i}},mf={};P({line:is,rect:es,roundRect:es,square:es,circle:Wr,diamond:df,pin:pf,arrow:gf,triangle:cf},function(t,e){mf[e]=new t});var vf=Ms({type:"symbol",shape:{symbolType:"",x:0,y:0,width:0,height:0},calculateTextPosition:function(t,e,n){var i=di(t,e,n),o=this.shape;return o&&"pin"===o.symbolType&&"inside"===e.textPosition&&(i.y=n.y+.4*n.height),i},buildPath:function(t,e,n){var i,o=e.symbolType;"none"!==o&&(i=(i=mf[o])||mf[o="rect"],ff[o](e.x,e.y,e.width,e.height,i.shape),i.buildPath(t,i.shape,n))}});function yf(t,e){var n,i;"image"!==this.type&&(n=this.style,(i=this.shape)&&"line"===i.symbolType?n.stroke=t:this.__isEmptyBrush?(n.stroke=t,n.fill=e||"#fff"):(n.fill&&(n.fill=t),n.stroke&&(n.stroke=t)),this.dirty(!1))}function xf(t,e,n,i,o,a,r){var s,l=0===t.indexOf("empty");return l&&(t=t.substr(5,1).toLowerCase()+t.substr(6)),(s=0===t.indexOf("image://")?Ds(t.slice(8),new Sn(e,n,i,o),r?"center":"cover"):0===t.indexOf("path://")?As(t.slice(7),{},new Sn(e,n,i,o),r?"center":"cover"):new vf({shape:{symbolType:t,x:e,y:n,width:i,height:o}})).__isEmptyBrush=l,s.setColor=yf,s.setColor(a),s}var _f={isDimensionStacked:ug,enableDataStack:hg,getStackedDimension:cg};var wf=(Object.freeze||Object)({createList:function(t){return dg(t.getSource(),t)},getLayoutRect:fh,dataStack:_f,createScale:function(t,e){var n=e;Sl.isInstance(e)||b(n=new Sl(e),uf);var i=af(n);return i.setExtent(t[0],t[1]),of(i,n),i},mixinAxisModelCommonMethods:function(t){b(t,uf)},completeDimensions:ig,createDimensions:ag,createSymbol:xf}),bf=1e-8;function Sf(t,e){return Math.abs(t-e)<bf}function Mf(t,e,n){var i=0,o=t[0];if(!o)return!1;for(var a=1;a<t.length;a++){var r=t[a];i+=hr(o[0],o[1],r[0],r[1],e,n),o=r}var s=t[0];return Sf(o[0],s[0])&&Sf(o[1],s[1])||(i+=hr(o[0],o[1],s[0],s[1],e,n)),0!==i}function If(t,e,n){var i;this.name=t,this.geometries=e,n=n?[n[0],n[1]]:[(i=this.getBoundingRect()).x+i.width/2,i.y+i.height/2],this.center=n}function Tf(t,e,n){for(var i=[],o=e[0],a=e[1],r=0;r<t.length;r+=2){var s=(s=t.charCodeAt(r)-64)>>1^-(1&s),l=(l=t.charCodeAt(r+1)-64)>>1^-(1&l),o=s+=o,a=l+=a;i.push([s/n,l/n])}return i}If.prototype={constructor:If,properties:null,getBoundingRect:function(){var t=this._rect;if(t)return t;for(var e=Number.MAX_VALUE,n=[e,e],i=[-e,-e],o=[],a=[],r=this.geometries,s=0;s<r.length;s++){"polygon"===r[s].type&&(Ra(r[s].exterior,o,a),St(n,n,o),Mt(i,i,a))}return 0===s&&(n[0]=n[1]=i[0]=i[1]=0),this._rect=new Sn(n[0],n[1],i[0]-n[0],i[1]-n[1])},contain:function(t){var e=this.getBoundingRect(),n=this.geometries;if(!e.contain(t[0],t[1]))return!1;t:for(var i=0,o=n.length;i<o;i++)if("polygon"===n[i].type){var a=n[i].exterior,r=n[i].interiors;if(Mf(a,t[0],t[1])){for(var s=0;s<(r?r.length:0);s++)if(Mf(r[s]))continue t;return!0}}return!1},transformTo:function(t,e,n,i){var o=this.getBoundingRect(),a=o.width/o.height;n?i=i||n/a:n=a*i;for(var r=new Sn(t,e,n,i),s=o.calculateTransform(r),l=this.geometries,h=0;h<l.length;h++)if("polygon"===l[h].type){for(var u=l[h].exterior,c=l[h].interiors,d=0;d<u.length;d++)bt(u[d],u[d],s);for(var p=0;p<(c?c.length:0);p++)for(d=0;d<c[p].length;d++)bt(c[p][d],c[p][d],s)}(o=this._rect).copy(r),this.center=[o.x+o.width/2,o.y+o.height/2]},cloneShallow:function(t){null==t&&(t=this.name);var e=new If(t,this.geometries,this.center);return e._rect=this._rect,e.transformTo=null,e}};function Af(t){return function(t){if(!t.UTF8Encoding)return;var e=t.UTF8Scale;null==e&&(e=1024);for(var n=t.features,i=0;i<n.length;i++)for(var o=n[i].geometry,a=o.coordinates,r=o.encodeOffsets,s=0;s<a.length;s++){var l=a[s];if("Polygon"===o.type)a[s]=Tf(l,r[s],e);else if("MultiPolygon"===o.type)for(var h=0;h<l.length;h++){var u=l[h];l[h]=Tf(u,r[s][h],e)}}t.UTF8Encoding=!1}(t),N(I(t.features,function(t){return t.geometry&&t.properties&&0<t.geometry.coordinates.length}),function(t){var e=t.properties,n=t.geometry,i=n.coordinates,o=[];"Polygon"===n.type&&o.push({type:"polygon",exterior:i[0],interiors:i.slice(1)}),"MultiPolygon"===n.type&&P(i,function(t){t[0]&&o.push({type:"polygon",exterior:t[0],interiors:t.slice(1)})});var a=new If(e.name,o,e.cp);return a.properties=e,a})}var Df=Ho();function Cf(t){return"category"===t.type?(a=(o=t).getLabelModel(),r=kf(o,a),!a.get("show")||o.scale.isBlank()?{labels:[],labelCategoryInterval:r.labelCategoryInterval}:r):(e=(n=t).scale.getTicks(),i=rf(n),{labels:N(e,function(t,e){return{formattedLabel:i(t,e),rawLabel:n.scale.getLabel(t),tickValue:t}})});var n,e,i,o,a,r}function Lf(t,e){return"category"===t.type?function(t,e){var n,i,o=Pf(t,"ticks"),a=lf(e),r=Nf(o,a);if(r)return r;e.get("show")&&!t.scale.isBlank()||(n=[]);{var s;n=A(a)?zf(t,a,!0):"auto"===a?(s=kf(t,t.getLabelModel()),i=s.labelCategoryInterval,N(s.labels,function(t){return t.tickValue})):Ef(t,i=a,!0)}return Of(o,a,{ticks:n,tickCategoryInterval:i})}(t,e):{ticks:t.scale.getTicks()}}function kf(t,e){var n,i,o,a=Pf(t,"labels"),r=lf(e),s=Nf(a,r);return s||Of(a,r,{labels:A(r)?zf(t,r):Ef(t,n="auto"===r?null!=(o=Df(i=t).autoInterval)?o:Df(i).autoInterval=i.calculateCategoryInterval():r),labelCategoryInterval:n})}function Pf(t,e){return Df(t)[e]||(Df(t)[e]=[])}function Nf(t,e){for(var n=0;n<t.length;n++)if(t[n].key===e)return t[n].value}function Of(t,e,n){return t.push({key:e,value:n}),n}function Ef(t,e,n){var i=rf(t),o=t.scale,a=o.getExtent(),r=t.getLabelModel(),s=[],l=Math.max((e||0)+1,1),h=a[0],u=o.count();0!==h&&1<l&&2<u/l&&(h=Math.round(Math.ceil(h/l)*l));var c=hf(t),d=r.get("showMinLabel")||c,p=r.get("showMaxLabel")||c;d&&h!==a[0]&&f(a[0]);for(var g=h;g<=a[1];g+=l)f(g);function f(t){s.push(n?t:{formattedLabel:i(t),rawLabel:o.getLabel(t),tickValue:t})}return p&&g-l!==a[1]&&f(a[1]),s}function zf(t,n,i){var o=t.scale,a=rf(t),r=[];return P(o.getTicks(),function(t){var e=o.getLabel(t);n(t,e)&&r.push(i?t:{formattedLabel:a(t),rawLabel:e,tickValue:t})}),r}var Rf=[0,1],Bf=function(t,e,n){this.dim=t,this.scale=e,this._extent=n||[0,0],this.inverse=!1,this.onBand=!1};function Vf(t,e){var n=(t[1]-t[0])/e/2;t[0]+=n,t[1]-=n}Bf.prototype={constructor:Bf,contain:function(t){var e=this._extent,n=Math.min(e[0],e[1]),i=Math.max(e[0],e[1]);return n<=t&&t<=i},containData:function(t){return this.scale.contain(t)},getExtent:function(){return this._extent.slice()},getPixelPrecision:function(t){return El(t||this.scale.getExtent(),this._extent)},setExtent:function(t,e){var n=this._extent;n[0]=t,n[1]=e},dataToCoord:function(t,e){var n=this._extent,i=this.scale;return t=i.normalize(t),this.onBand&&"ordinal"===i.type&&Vf(n=n.slice(),i.count()),Cl(t,Rf,n,e)},coordToData:function(t,e){var n=this._extent,i=this.scale;this.onBand&&"ordinal"===i.type&&Vf(n=n.slice(),i.count());var o=Cl(t,n,Rf,e);return this.scale.scale(o)},pointToData:function(t,e){},getTicksCoords:function(t){var e=(t=t||{}).tickModel||this.getTickModel(),n=N(Lf(this,e).ticks,function(t){return{coord:this.dataToCoord(t),tickValue:t}},this);return function(t,e,n,i){var o=e.length;if(!t.onBand||n||!o)return;var a,r,s=t.getExtent();{var l,h,u;1===o?(e[0].coord=s[0],a=e[1]={coord:s[0]}):(l=e[o-1].tickValue-e[0].tickValue,h=(e[o-1].coord-e[0].coord)/l,P(e,function(t){t.coord-=h/2}),u=t.scale.getExtent(),r=1+u[1]-e[o-1].tickValue,a={coord:e[o-1].coord+h*r},e.push(a))}var c=s[0]>s[1];d(e[0].coord,s[0])&&(i?e[0].coord=s[0]:e.shift());i&&d(s[0],e[0].coord)&&e.unshift({coord:s[0]});d(s[1],a.coord)&&(i?a.coord=s[1]:e.pop());i&&d(a.coord,s[1])&&e.push({coord:s[1]});function d(t,e){return t=kl(t),e=kl(e),c?e<t:t<e}}(this,n,e.get("alignWithLabel"),t.clamp),n},getMinorTicksCoords:function(){if("ordinal"===this.scale.type)return[];var t=this.model.getModel("minorTick").get("splitNumber");return 0<t&&t<100||(t=5),N(this.scale.getMinorTicks(t),function(t){return N(t,function(t){return{coord:this.dataToCoord(t),tickValue:t}},this)},this)},getViewLabels:function(){return Cf(this).labels},getLabelModel:function(){return this.model.getModel("axisLabel")},getTickModel:function(){return this.model.getModel("axisTick")},getBandWidth:function(){var t=this._extent,e=this.scale.getExtent(),n=e[1]-e[0]+(this.onBand?1:0);0===n&&(n=1);var i=Math.abs(t[1]-t[0]);return Math.abs(i)/n},isHorizontal:null,getRotate:null,calculateCategoryInterval:function(){return function(t){var e,n,i=(n=(e=t).getLabelModel(),{axisRotate:e.getRotate?e.getRotate():e.isHorizontal&&!e.isHorizontal()?90:0,labelRotate:n.get("rotate")||0,font:n.getFont()}),o=rf(t),a=(i.axisRotate-i.labelRotate)/180*Math.PI,r=t.scale,s=r.getExtent(),l=r.count();if(s[1]-s[0]<1)return 0;var h=1;40<l&&(h=Math.max(1,Math.floor(l/40)));for(var u=s[0],c=t.dataToCoord(u+1)-t.dataToCoord(u),d=Math.abs(c*Math.cos(a)),p=Math.abs(c*Math.sin(a)),g=0,f=0;u<=s[1];u+=h)var m=hi(o(u),i.font,"center","top"),v=1.3*m.width,y=1.3*m.height,g=Math.max(g,v,7),f=Math.max(f,y,7);var x=g/d,_=f/p;isNaN(x)&&(x=1/0),isNaN(_)&&(_=1/0);var w=Math.max(0,Math.floor(Math.min(x,_))),b=Df(t.model),S=t.getExtent(),M=b.lastAutoInterval,I=b.lastTickCount;return null!=M&&null!=I&&Math.abs(M-w)<=1&&Math.abs(I-l)<=1&&w<M&&b.axisExtend0===S[0]&&b.axisExtend1===S[1]?w=M:(b.lastTickCount=l,b.lastAutoInterval=w,b.axisExtend0=S[0],b.axisExtend1=S[1]),w}(this)}};var Gf=Af,Ff={};P(["map","each","filter","indexOf","inherits","reduce","filter","bind","curry","isArray","isString","isObject","isFunction","extend","defaults","clone","merge"],function(t){Ff[t]=ot[t]});var Wf={};function Hf(t,e){var n=t.mapDimension("defaultedLabel",!0),i=n.length;if(1===i)return Ru(t,e,n[0]);if(i){for(var o=[],a=0;a<n.length;a++){var r=Ru(t,e,n[a]);o.push(r)}return o.join(" ")}}function Zf(t,e,n){Mn.call(this),this.updateData(t,e,n)}P(["extendShape","extendPath","makePath","makeImage","mergePath","resizePath","createIcon","setHoverStyle","setLabelStyle","setTextStyle","setText","getFont","updateProps","initProps","getTransform","clipPointsByRect","clipRectByRect","registerShape","getShapeClass","Group","Image","Text","Circle","Sector","Ring","Polygon","Polyline","Rect","Line","BezierCurve","Arc","IncrementalDisplayable","CompoundPath","LinearGradient","RadialGradient","BoundingRect"],function(t){Wf[t]=ml[t]}),ec.extend({type:"series.line",dependencies:["grid","polar"],getInitialData:function(t,e){if(D){var n=t.coordinateSystem;if("polar"!==n&&"cartesian2d"!==n)throw new Error("Line not support coordinateSystem besides cartesian and polar")}return dg(this.getSource(),this,{useEncodeDefaulter:!0})},defaultOption:{zlevel:0,z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,hoverAnimation:!0,clip:!0,label:{position:"top"},lineStyle:{width:2,type:"solid"},step:!1,smooth:!1,smoothMonotone:null,symbol:"emptyCircle",symbolSize:4,symbolRotate:null,showSymbol:!0,showAllSymbol:"auto",connectNulls:!1,sampling:"none",animationEasing:"linear",progressive:0,hoverLayerThreshold:1/0}});var Uf=Zf.prototype,Xf=Zf.getSymbolSize=function(t,e){var n=t.getItemVisual(e,"symbolSize");return n instanceof Array?n.slice():[+n,+n]};function Yf(t){return[t[0]/2,t[1]/2]}function jf(t,e){this.parent.drift(t,e)}Uf._createSymbol=function(t,e,n,i,o){this.removeAll();var a=xf(t,-1,-1,2,2,e.getItemVisual(n,"color"),o);a.attr({z2:100,culling:!0,scale:Yf(i)}),a.drift=jf,this._symbolType=t,this.add(a)},Uf.stopSymbolAnimation=function(t){this.childAt(0).stopAnimation(t)},Uf.getSymbolPath=function(){return this.childAt(0)},Uf.getScale=function(){return this.childAt(0).scale},Uf.highlight=function(){this.childAt(0).trigger("emphasis")},Uf.downplay=function(){this.childAt(0).trigger("normal")},Uf.setZ=function(t,e){var n=this.childAt(0);n.zlevel=t,n.z=e},Uf.setDraggable=function(t){var e=this.childAt(0);e.draggable=t,e.cursor=t?"move":e.cursor},Uf.updateData=function(t,e,n){this.silent=!1;var i,o,a,r,s=t.getItemVisual(e,"symbol")||"circle",l=t.hostModel,h=Xf(t,e),u=s!==this._symbolType;u?(i=t.getItemVisual(e,"symbolKeepAspect"),this._createSymbol(s,t,e,h,i)):((o=this.childAt(0)).silent=!1,rl(o,{scale:Yf(h)},l,e)),this._updateCommon(t,e,h,n),u&&(o=this.childAt(0),a=n&&n.fadeIn,r={scale:o.scale.slice()},a&&(r.style={opacity:o.style.opacity}),o.scale=[0,0],a&&(o.style.opacity=0),sl(o,r,l,e)),this._seriesModel=l};var qf=["itemStyle"],Kf=["emphasis","itemStyle"],$f=["label"],Jf=["emphasis","label"];function Qf(t,e){var n,i,o;this.incremental||this.useHoverLayer||("emphasis"===e?(i=(n=this.__symbolOriginalScale)[1]/n[0],o={scale:[Math.max(1.1*n[0],n[0]+3),Math.max(1.1*n[1],n[1]+3*i)]},this.animateTo(o,400,"elasticOut")):"normal"===e&&this.animateTo({scale:this.__symbolOriginalScale},400,"elasticOut"))}function tm(t){this.group=new Mn,this._symbolCtor=t||Zf}Uf._updateCommon=function(n,t,e,i){var o=this.childAt(0),a=n.hostModel,r=n.getItemVisual(t,"color");"image"!==o.type?o.useStyle({strokeNoScale:!0}):o.setStyle({opacity:null,shadowBlur:null,shadowOffsetX:null,shadowOffsetY:null,shadowColor:null});var s,l=i&&i.itemStyle,h=i&&i.hoverItemStyle,u=i&&i.symbolRotate,c=i&&i.symbolOffset,d=i&&i.labelModel,p=i&&i.hoverLabelModel,g=i&&i.hoverAnimation,f=i&&i.cursorStyle;!i||n.hasItemOption?(l=(s=i&&i.itemModel?i.itemModel:n.getItemModel(t)).getModel(qf).getItemStyle(["color"]),h=s.getModel(Kf).getItemStyle(),u=s.getShallow("symbolRotate"),c=s.getShallow("symbolOffset"),d=s.getModel($f),p=s.getModel(Jf),g=s.getShallow("hoverAnimation"),f=s.getShallow("cursor")):h=k({},h);var m=o.style;o.attr("rotation",(u||0)*Math.PI/180||0),c&&o.attr("position",[Ll(c[0],e[0]),Ll(c[1],e[1])]),f&&o.attr("cursor",f),o.setColor(r,i&&i.symbolInnerColor),o.setStyle(l);var v=n.getItemVisual(t,"opacity");null!=v&&(m.opacity=v);var y=n.getItemVisual(t,"liftZ"),x=o.__z2Origin;null!=y?null==x&&(o.__z2Origin=o.z2,o.z2+=y):null!=x&&(o.z2=x,o.__z2Origin=null);var _=i&&i.useNameLabel;Ks(m,h,d,p,{labelFetcher:a,labelDataIndex:t,defaultText:function(t,e){return _?n.getName(t):Hf(n,t)},isRectText:!0,autoColor:r}),o.__symbolOriginalScale=Yf(e),o.hoverStyle=h,o.highDownOnUpdate=g&&a.isAnimationEnabled()?Qf:null,Xs(o)},Uf.fadeOut=function(t,e){var n=this.childAt(0);this.silent=n.silent=!0,e&&e.keepLabel||(n.style.text=null),rl(n,{style:{opacity:0},scale:[0,0]},this._seriesModel,this.dataIndex,t)},w(Zf,Mn);var em=tm.prototype;function nm(t,e,n,i){return e&&!isNaN(e[0])&&!isNaN(e[1])&&(!i.isIgnore||!i.isIgnore(n))&&(!i.clipShape||i.clipShape.contain(e[0],e[1]))&&"none"!==t.getItemVisual(n,"symbol")}function im(t){return null==t||V(t)||(t={isIgnore:t}),t||{}}function om(t){var e=t.hostModel;return{itemStyle:e.getModel("itemStyle").getItemStyle(["color"]),hoverItemStyle:e.getModel("emphasis.itemStyle").getItemStyle(),symbolRotate:e.get("symbolRotate"),symbolOffset:e.get("symbolOffset"),hoverAnimation:e.get("hoverAnimation"),labelModel:e.getModel("label"),hoverLabelModel:e.getModel("emphasis.label"),cursorStyle:e.get("cursor")}}function am(t,e,n){var i,o=t.getBaseAxis(),a=t.getOtherAxis(o),r=function(t,e){var n=0,i=t.scale.getExtent();"start"===e?n=i[0]:"end"===e?n=i[1]:0<i[0]?n=i[0]:i[1]<0&&(n=i[1]);return n}(a,n),s=o.dim,l=a.dim,h=e.mapDimension(l),u=e.mapDimension(s),c="x"===l||"radius"===l?1:0,d=N(t.dimensions,function(t){return e.mapDimension(t)}),p=e.getCalculationInfo("stackResultDimension");return(i|=ug(e,d[0]))&&(d[0]=p),(i|=ug(e,d[1]))&&(d[1]=p),{dataDimsForPoint:d,valueStart:r,valueAxisDim:l,baseAxisDim:s,stacked:!!i,valueDim:h,baseDim:u,baseDataOffset:c,stackedOverDimension:e.getCalculationInfo("stackedOverDimension")}}function rm(t,e,n,i){var o=NaN;t.stacked&&(o=n.get(n.getCalculationInfo("stackedOverDimension"),i)),isNaN(o)&&(o=t.valueStart);var a=t.baseDataOffset,r=[];return r[a]=n.get(t.baseDim,i),r[1-a]=o,e.dataToPoint(r)}em.updateData=function(o,a){a=im(a);var r=this.group,s=o.hostModel,l=this._data,h=this._symbolCtor,u=om(o);l||r.removeAll(),o.diff(l).add(function(t){var e,n=o.getItemLayout(t);nm(o,n,t,a)&&((e=new h(o,t,u)).attr("position",n),o.setItemGraphicEl(t,e),r.add(e))}).update(function(t,e){var n=l.getItemGraphicEl(e),i=o.getItemLayout(t);nm(o,i,t,a)?(n?(n.updateData(o,t,u),rl(n,{position:i},s)):(n=new h(o,t)).attr("position",i),r.add(n),o.setItemGraphicEl(t,n)):r.remove(n)}).remove(function(t){var e=l.getItemGraphicEl(t);e&&e.fadeOut(function(){r.remove(e)})}).execute(),this._data=o},em.isPersistent=function(){return!0},em.updateLayout=function(){var i=this._data;i&&i.eachItemGraphicEl(function(t,e){var n=i.getItemLayout(e);t.attr("position",n)})},em.incrementalPrepareUpdate=function(t){this._seriesScope=om(t),this._data=null,this.group.removeAll()},em.incrementalUpdate=function(t,e,n){function i(t){t.isGroup||(t.incremental=t.useHoverLayer=!0)}n=im(n);for(var o=t.start;o<t.end;o++){var a,r=e.getItemLayout(o);nm(e,r,o,n)&&((a=new this._symbolCtor(e,o,this._seriesScope)).traverse(i),a.attr("position",r),this.group.add(a),e.setItemGraphicEl(o,a))}},em.remove=function(t){var e=this.group,n=this._data;n&&t?n.eachItemGraphicEl(function(t){t.fadeOut(function(){e.remove(t)})}):e.removeAll()};function sm(t,e,n,i,o,a,r,s){for(var l,h,u=(l=t,h=[],e.diff(l).add(function(t){h.push({cmd:"+",idx:t})}).update(function(t,e){h.push({cmd:"=",idx:e,idx1:t})}).remove(function(t){h.push({cmd:"-",idx:t})}).execute(),h),c=[],d=[],p=[],g=[],f=[],m=[],v=[],y=am(o,e,r),x=am(a,t,s),_=0;_<u.length;_++){var w=u[_],b=!0;switch(w.cmd){case"=":var S=t.getItemLayout(w.idx),M=e.getItemLayout(w.idx1);(isNaN(S[0])||isNaN(S[1]))&&(S=M.slice()),c.push(S),d.push(M),p.push(n[w.idx]),g.push(i[w.idx1]),v.push(e.getRawIndex(w.idx1));break;case"+":var I=w.idx;c.push(o.dataToPoint([e.get(y.dataDimsForPoint[0],I),e.get(y.dataDimsForPoint[1],I)])),d.push(e.getItemLayout(I).slice()),p.push(rm(y,o,e,I)),g.push(i[I]),v.push(e.getRawIndex(I));break;case"-":var I=w.idx,T=t.getRawIndex(I);T!==I?(c.push(t.getItemLayout(I)),d.push(a.dataToPoint([t.get(x.dataDimsForPoint[0],I),t.get(x.dataDimsForPoint[1],I)])),p.push(n[I]),g.push(rm(x,a,t,I)),v.push(T)):b=!1}b&&(f.push(w),m.push(m.length))}m.sort(function(t,e){return v[t]-v[e]});for(var A=[],D=[],C=[],L=[],k=[],_=0;_<m.length;_++){I=m[_];A[_]=c[I],D[_]=d[I],C[_]=p[I],L[_]=g[I],k[_]=f[I]}return{current:A,next:D,stackedOnCurrent:C,stackedOnNext:L,status:k}}var lm=St,hm=Mt,um=ct,cm=st,dm=[],pm=[],gm=[];function fm(t){return isNaN(t[0])||isNaN(t[1])}function mm(t,e,n,i,o,a,r,s,l,h){return"none"!==h&&h?function(t,e,n,i,o,a,r,s,l,h,u){for(var c=0,d=n,p=0;p<i;p++){var g,f,m,v=e[d];if(o<=d||d<0)break;if(fm(v)){if(u){d+=a;continue}break}d===n?t[0<a?"moveTo":"lineTo"](v[0],v[1]):0<l?(g=e[c],m=(v[f="y"===h?1:0]-g[f])*l,cm(pm,g),pm[f]=g[f]+m,cm(gm,v),gm[f]=v[f]-m,t.bezierCurveTo(pm[0],pm[1],gm[0],gm[1],v[0],v[1])):t.lineTo(v[0],v[1]),c=d,d+=a}return p}.apply(this,arguments):function(t,e,n,i,o,a,r,s,l,h,u){for(var c,d,p=0,g=n,f=0;f<i;f++){var m=e[g];if(o<=g||g<0)break;if(fm(m)){if(u){g+=a;continue}break}if(g===n)t[0<a?"moveTo":"lineTo"](m[0],m[1]),cm(pm,m);else if(0<l){var v=g+a,y=e[v];if(u)for(;y&&fm(e[v]);)y=e[v+=a];var x,_=.5,w=e[p];!(y=e[v])||fm(y)?cm(gm,m):(fm(y)&&!u&&(y=m),dt(dm,y,w),d="x"===h||"y"===h?(x="x"===h?0:1,c=Math.abs(m[x]-w[x]),Math.abs(m[x]-y[x])):(c=yt(m,w),yt(m,y)),um(gm,m,dm,-l*(1-(_=d/(d+c))))),lm(pm,pm,s),hm(pm,pm,r),lm(gm,gm,s),hm(gm,gm,r),t.bezierCurveTo(pm[0],pm[1],gm[0],gm[1],m[0],m[1]),um(pm,m,dm,l*_)}else t.lineTo(m[0],m[1]);p=g,g+=a}return f}.apply(this,arguments)}function vm(t,e){var n=[1/0,1/0],i=[-1/0,-1/0];if(e)for(var o=0;o<t.length;o++){var a=t[o];a[0]<n[0]&&(n[0]=a[0]),a[1]<n[1]&&(n[1]=a[1]),a[0]>i[0]&&(i[0]=a[0]),a[1]>i[1]&&(i[1]=a[1])}return{min:e?n:i,max:e?i:n}}var ym=br.extend({type:"ec-polyline",shape:{points:[],smooth:0,smoothConstraint:!0,smoothMonotone:null,connectNulls:!1},style:{fill:null,stroke:"#000"},brush:Fr(br.prototype.brush),buildPath:function(t,e){var n=e.points,i=0,o=n.length,a=vm(n,e.smoothConstraint);if(e.connectNulls){for(;0<o&&fm(n[o-1]);o--);for(;i<o&&fm(n[i]);i++);}for(;i<o;)i+=mm(t,n,i,o,o,1,a.min,a.max,e.smooth,e.smoothMonotone,e.connectNulls)+1}}),xm=br.extend({type:"ec-polygon",shape:{points:[],stackedOnPoints:[],smooth:0,stackedOnSmooth:0,smoothConstraint:!0,smoothMonotone:null,connectNulls:!1},brush:Fr(br.prototype.brush),buildPath:function(t,e){var n=e.points,i=e.stackedOnPoints,o=0,a=n.length,r=e.smoothMonotone,s=vm(n,e.smoothConstraint),l=vm(i,e.smoothConstraint);if(e.connectNulls){for(;0<a&&fm(n[a-1]);a--);for(;o<a&&fm(n[o]);o++);}for(;o<a;){var h=mm(t,n,o,a,a,1,s.min,s.max,e.smooth,r,e.connectNulls);mm(t,i,o+h-1,h,a,-1,l.min,l.max,e.stackedOnSmooth,r,e.connectNulls),o+=h+1,t.closePath()}}});function _m(t,e,n){var i=t.getArea(),o=t.getBaseAxis().isHorizontal(),a=i.x,r=i.y,s=i.width,l=i.height,h=n.get("lineStyle.width")||2,u=new es({shape:{x:a-=h/2,y:r-=h/2,width:s+=h,height:l+=h}});return e&&(u.shape[o?"width":"height"]=0,sl(u,{shape:{width:s,height:l}},n)),u}function wm(t,e,n){var i=t.getArea(),o=new Zr({shape:{cx:kl(t.cx,1),cy:kl(t.cy,1),r0:kl(i.r0,1),r:kl(i.r,1),startAngle:i.startAngle,endAngle:i.endAngle,clockwise:i.clockwise}});return e&&(o.shape.endAngle=i.startAngle,sl(o,{shape:{endAngle:i.endAngle}},n)),o}function bm(t,e,n){return t?"polar"===t.type?wm(t,e,n):"cartesian2d"===t.type?_m(t,e,n):null:null}function Sm(t,e){if(t.length===e.length){for(var n=0;n<t.length;n++){var i=t[n],o=e[n];if(i[0]!==o[0]||i[1]!==o[1])return}return 1}}function Mm(t){return"number"==typeof t?t:t?.5:0}function Im(t,e,n){for(var i=e.getBaseAxis(),o="x"===i.dim||"radius"===i.dim?0:1,a=[],r=0;r<t.length-1;r++){var s=t[r+1],l=t[r];a.push(l);var h=[];switch(n){case"end":h[o]=s[o],h[1-o]=l[1-o],a.push(h);break;case"middle":var u=(l[o]+s[o])/2,c=[];h[o]=c[o]=u,h[1-o]=l[1-o],c[1-o]=s[1-o],a.push(h),a.push(c);break;default:h[o]=l[o],h[1-o]=s[1-o],a.push(h)}}return t[r]&&a.push(t[r]),a}function Tm(t,e,n){var i=t.get("showAllSymbol"),o="auto"===i;if(!i||o){var a=n.getAxesByScale("ordinal")[0];if(a&&(!o||!function(t,e){var n=t.getExtent(),i=Math.abs(n[1]-n[0])/t.scale.count();isNaN(i)&&(i=0);for(var o=e.count(),a=Math.max(1,Math.round(o/5)),r=0;r<o;r+=a)if(1.5*Zf.getSymbolSize(e,r)[t.isHorizontal()?1:0]>i)return;return 1}(a,e))){var r=e.mapDimension(a.dim),s={};return P(a.getViewLabels(),function(t){s[t.tickValue]=1}),function(t){return!s.hasOwnProperty(e.get(r,t))}}}}function Am(t,e,n){if("cartesian2d"!==t.type)return wm(t,e,n);var i,o,a=t.getBaseAxis().isHorizontal(),r=_m(t,e,n);return n.get("clip",!0)||(i=r.shape,o=Math.max(i.width,i.height),a?(i.y-=o,i.height+=2*o):(i.x-=o,i.width+=2*o)),r}gc.extend({type:"line",init:function(){var t=new Mn,e=new tm;this.group.add(e.group),this._symbolDraw=e,this._lineGroup=t},render:function(t,e,n){var i=t.coordinateSystem,o=this.group,a=t.getData(),r=t.getModel("lineStyle"),s=t.getModel("areaStyle"),l=a.mapArray(a.getItemLayout),h="polar"===i.type,u=this._coordSys,c=this._symbolDraw,d=this._polyline,p=this._polygon,g=this._lineGroup,f=t.get("animation"),m=!s.isEmpty(),v=s.get("origin"),y=function(t,e,n){if(!n.valueDim)return[];for(var i=[],o=0,a=e.count();o<a;o++)i.push(rm(n,t,e,o));return i}(i,a,am(i,a,v)),x=t.get("showSymbol"),_=x&&!h&&Tm(t,a,i),w=this._data;w&&w.eachItemGraphicEl(function(t,e){t.__temp&&(o.remove(t),w.setItemGraphicEl(e,null))}),x||c.remove(),o.add(g);var b,S=!h&&t.get("step");i&&i.getArea&&t.get("clip",!0)&&(null!=(b=i.getArea()).width?(b.x-=.1,b.y-=.1,b.width+=.2,b.height+=.2):b.r0&&(b.r0-=.5,b.r1+=.5)),this._clipShapeForSymbol=b,d&&u.type===i.type&&S===this._step?(m&&!p?p=this._newPolygon(l,y,i,f):p&&!m&&(g.remove(p),p=this._polygon=null),g.setClipPath(Am(i,!1,t)),x&&c.updateData(a,{isIgnore:_,clipShape:b}),a.eachItemGraphicEl(function(t){t.stopAnimation(!0)}),Sm(this._stackedOnPoints,y)&&Sm(this._points,l)||(f?this._updateAnimation(a,y,i,n,S,v):(S&&(l=Im(l,i,S),y=Im(y,i,S)),d.setShape({points:l}),p&&p.setShape({points:l,stackedOnPoints:y})))):(x&&c.updateData(a,{isIgnore:_,clipShape:b}),S&&(l=Im(l,i,S),y=Im(y,i,S)),d=this._newPolyline(l,i,f),m&&(p=this._newPolygon(l,y,i,f)),g.setClipPath(Am(i,!0,t)));var M=function(t,e){var n=t.getVisual("visualMeta");if(n&&n.length&&t.count())if("cartesian2d"===e.type){for(var i,o=n.length-1;0<=o;o--){var a,r=n[o].dimension,s=t.dimensions[r],l=t.getDimensionInfo(s);if("x"===(a=l&&l.coordDim)||"y"===a){i=n[o];break}}if(i){var h=e.getAxis(a),u=N(i.stops,function(t){return{coord:h.toGlobalCoord(h.dataToCoord(t.value)),color:t.color}}),c=u.length,d=i.outerColors.slice();c&&u[0].coord>u[c-1].coord&&(u.reverse(),d.reverse());var p=u[0].coord-10,g=u[c-1].coord+10,f=g-p;if(f<.001)return"transparent";P(u,function(t){t.offset=(t.coord-p)/f}),u.push({offset:c?u[c-1].offset:.5,color:d[1]||"transparent"}),u.unshift({offset:c?u[0].offset:.5,color:d[0]||"transparent"});var m=new us(0,0,0,0,u,!0);return m[a]=p,m[a+"2"]=g,m}D&&console.warn("Visual map on line style only support x or y dimension.")}else D&&console.warn("Visual map on line style is only supported on cartesian2d.")}(a,i)||a.getVisual("color");d.useStyle(L(r.getLineStyle(),{fill:"none",stroke:M,lineJoin:"bevel"}));var I,T,A=t.get("smooth"),A=Mm(t.get("smooth"));d.setShape({smooth:A,smoothMonotone:t.get("smoothMonotone"),connectNulls:t.get("connectNulls")}),p&&(I=a.getCalculationInfo("stackedOnSeries"),T=0,p.useStyle(L(s.getAreaStyle(),{fill:M,opacity:.7,lineJoin:"bevel"})),I&&(T=Mm(I.get("smooth"))),p.setShape({smooth:A,stackedOnSmooth:T,smoothMonotone:t.get("smoothMonotone"),connectNulls:t.get("connectNulls")})),this._data=a,this._coordSys=i,this._stackedOnPoints=y,this._points=l,this._step=S,this._valueOrigin=v},dispose:function(){},highlight:function(t,e,n,i){var o=t.getData(),a=Wo(o,i);if(!(a instanceof Array)&&null!=a&&0<=a){var r=o.getItemGraphicEl(a);if(!r){var s=o.getItemLayout(a);if(!s)return;if(this._clipShapeForSymbol&&!this._clipShapeForSymbol.contain(s[0],s[1]))return;(r=new Zf(o,a)).position=s,r.setZ(t.get("zlevel"),t.get("z")),r.ignore=isNaN(s[0])||isNaN(s[1]),r.__temp=!0,o.setItemGraphicEl(a,r),r.stopSymbolAnimation(!0),this.group.add(r)}r.highlight()}else gc.prototype.highlight.call(this,t,e,n,i)},downplay:function(t,e,n,i){var o,a=t.getData(),r=Wo(a,i);null!=r&&0<=r?(o=a.getItemGraphicEl(r))&&(o.__temp?(a.setItemGraphicEl(r,null),this.group.remove(o)):o.downplay()):gc.prototype.downplay.call(this,t,e,n,i)},_newPolyline:function(t){var e=this._polyline;return e&&this._lineGroup.remove(e),e=new ym({shape:{points:t},silent:!0,z2:10}),this._lineGroup.add(e),this._polyline=e},_newPolygon:function(t,e){var n=this._polygon;return n&&this._lineGroup.remove(n),n=new xm({shape:{points:t,stackedOnPoints:e},silent:!0}),this._lineGroup.add(n),this._polygon=n},_updateAnimation:function(t,e,n,i,o,a){var r=this._polyline,s=this._polygon,l=t.hostModel,h=sm(this._data,t,this._stackedOnPoints,e,this._coordSys,n,this._valueOrigin,a),u=h.current,c=h.stackedOnCurrent,d=h.next,p=h.stackedOnNext;o&&(u=Im(h.current,n,o),c=Im(h.stackedOnCurrent,n,o),d=Im(h.next,n,o),p=Im(h.stackedOnNext,n,o)),r.shape.__points=h.current,r.shape.points=u,rl(r,{shape:{points:d}},l),s&&(s.setShape({points:u,stackedOnPoints:c}),rl(s,{shape:{points:d,stackedOnPoints:p}},l));for(var g,f=[],m=h.status,v=0;v<m.length;v++){"="!==m[v].cmd||(g=t.getItemGraphicEl(m[v].idx1))&&f.push({el:g,ptIdx:v})}r.animators&&r.animators.length&&r.animators[0].during(function(){for(var t=0;t<f.length;t++){f[t].el.attr("position",r.shape.__points[f[t].ptIdx])}})},remove:function(t){var n=this.group,i=this._data;this._lineGroup.removeAll(),this._symbolDraw.remove(!0),i&&i.eachItemGraphicEl(function(t,e){t.__temp&&(n.remove(t),i.setItemGraphicEl(e,null))}),this._polyline=this._polygon=this._coordSys=this._points=this._stackedOnPoints=this._data=null}});function Dm(t,r,s){return{seriesType:t,performRawSeries:!0,reset:function(l,t,e){var n=l.getData(),h=l.get("symbol"),u=l.get("symbolSize"),i=l.get("symbolKeepAspect"),c=A(h),d=A(u),p=c||d,o=!c&&h?h:r,a=d?null:u;if(n.setVisual({legendSymbol:s||o,symbol:o,symbolSize:a,symbolKeepAspect:i}),!t.isSeriesFiltered(l))return{dataEach:n.hasItemOption||p?function(t,e){var n,i,o,a,r,s;p&&(n=l.getRawValue(e),i=l.getDataParams(e),c&&t.setItemVisual(e,"symbol",h(n,i)),d&&t.setItemVisual(e,"symbolSize",u(n,i))),t.hasItemOption&&(a=(o=t.getItemModel(e)).getShallow("symbol",!0),r=o.getShallow("symbolSize",!0),s=o.getShallow("symbolKeepAspect",!0),null!=a&&t.setItemVisual(e,"symbol",a),null!=r&&t.setItemVisual(e,"symbolSize",r),null!=s&&t.setItemVisual(e,"symbolKeepAspect",s))}:null}}}}function Cm(t){return{seriesType:t,plan:cc(),reset:function(t){var e=t.getData(),c=t.coordinateSystem,d=t.pipelineContext.large;if(c){var p=N(c.dimensions,function(t){return e.mapDimension(t)}).slice(0,2),g=p.length,n=e.getCalculationInfo("stackResultDimension");return ug(e,p[0])&&(p[0]=n),ug(e,p[1])&&(p[1]=n),g&&{progress:function(t,e){for(var n,i,o,a=t.end-t.start,r=d&&new Float32Array(a*g),s=t.start,l=0,h=[],u=[];s<t.end;s++){n=1===g?(i=e.get(p[0],s),!isNaN(i)&&c.dataToPoint(i,null,u)):(i=h[0]=e.get(p[0],s),o=h[1]=e.get(p[1],s),!isNaN(i)&&!isNaN(o)&&c.dataToPoint(h,null,u)),d?(r[l++]=n?n[0]:NaN,r[l++]=n?n[1]:NaN):e.setItemLayout(s,n&&n.slice()||[NaN,NaN])}d&&e.setLayout("symbolPoints",r)}}}}}}function Lm(t,e){return Math.round(t.length/2)}var km={average:function(t){for(var e=0,n=0,i=0;i<t.length;i++)isNaN(t[i])||(e+=t[i],n++);return 0===n?NaN:e/n},sum:function(t){for(var e=0,n=0;n<t.length;n++)e+=t[n]||0;return e},max:function(t){for(var e=-1/0,n=0;n<t.length;n++)t[n]>e&&(e=t[n]);return isFinite(e)?e:NaN},min:function(t){for(var e=1/0,n=0;n<t.length;n++)t[n]<e&&(e=t[n]);return isFinite(e)?e:NaN},nearest:function(t){return t[0]}};function Pm(t){return this._axes[t]}function Nm(t){this._axes={},this._dimList=[],this.name=t||""}function Om(t){Nm.call(this,t)}Nm.prototype={constructor:Nm,type:"cartesian",getAxis:function(t){return this._axes[t]},getAxes:function(){return N(this._dimList,Pm,this)},getAxesByScale:function(e){return e=e.toLowerCase(),I(this.getAxes(),function(t){return t.scale.type===e})},addAxis:function(t){var e=t.dim;this._axes[e]=t,this._dimList.push(e)},dataToCoord:function(t){return this._dataCoordConvert(t,"dataToCoord")},coordToData:function(t){return this._dataCoordConvert(t,"coordToData")},_dataCoordConvert:function(t,e){for(var n=this._dimList,i=t instanceof Array?[]:{},o=0;o<n.length;o++){var a=n[o],r=this._axes[a];i[a]=r[e](t[a])}return i}},Om.prototype={constructor:Om,type:"cartesian2d",dimensions:["x","y"],getBaseAxis:function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAxis("x")},containPoint:function(t){var e=this.getAxis("x"),n=this.getAxis("y");return e.contain(e.toLocalCoord(t[0]))&&n.contain(n.toLocalCoord(t[1]))},containData:function(t){return this.getAxis("x").containData(t[0])&&this.getAxis("y").containData(t[1])},dataToPoint:function(t,e,n){var i=this.getAxis("x"),o=this.getAxis("y");return(n=n||[])[0]=i.toGlobalCoord(i.dataToCoord(t[0])),n[1]=o.toGlobalCoord(o.dataToCoord(t[1])),n},clampData:function(t,e){var n=this.getAxis("x").scale,i=this.getAxis("y").scale,o=n.getExtent(),a=i.getExtent(),r=n.parse(t[0]),s=i.parse(t[1]);return(e=e||[])[0]=Math.min(Math.max(Math.min(o[0],o[1]),r),Math.max(o[0],o[1])),e[1]=Math.min(Math.max(Math.min(a[0],a[1]),s),Math.max(a[0],a[1])),e},pointToData:function(t,e){var n=this.getAxis("x"),i=this.getAxis("y");return(e=e||[])[0]=n.coordToData(n.toLocalCoord(t[0])),e[1]=i.coordToData(i.toLocalCoord(t[1])),e},getOtherAxis:function(t){return this.getAxis("x"===t.dim?"y":"x")},getArea:function(){var t=this.getAxis("x").getGlobalExtent(),e=this.getAxis("y").getGlobalExtent(),n=Math.min(t[0],t[1]),i=Math.min(e[0],e[1]);return new Sn(n,i,Math.max(t[0],t[1])-n,Math.max(e[0],e[1])-i)}},w(Om,Nm);function Em(t,e,n,i,o){Bf.call(this,t,e,n),this.type=i||"value",this.position=o||"bottom"}Em.prototype={constructor:Em,index:0,getAxesOnZeroOf:null,model:null,isHorizontal:function(){var t=this.position;return"top"===t||"bottom"===t},getGlobalExtent:function(t){var e=this.getExtent();return e[0]=this.toGlobalCoord(e[0]),e[1]=this.toGlobalCoord(e[1]),t&&e[0]>e[1]&&e.reverse(),e},getOtherAxis:function(){this.grid.getOtherAxis()},pointToData:function(t,e){return this.coordToData(this.toLocalCoord(t["x"===this.dim?0:1]),e)},toLocalCoord:null,toGlobalCoord:null},w(Em,Bf);var zm={show:!0,zlevel:0,z:0,inverse:!1,name:"",nameLocation:"end",nameRotate:null,nameTruncate:{maxWidth:null,ellipsis:"...",placeholder:"."},nameTextStyle:{},nameGap:15,silent:!1,triggerEvent:!1,tooltip:{show:!1},axisPointer:{},axisLine:{show:!0,onZero:!0,onZeroAxisIndex:null,lineStyle:{color:"#333",width:1,type:"solid"},symbol:["none","none"],symbolSize:[10,15]},axisTick:{show:!0,inside:!1,length:5,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,showMinLabel:null,showMaxLabel:null,margin:8,fontSize:12},splitLine:{show:!0,lineStyle:{color:["#ccc"],width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},Rm={};Rm.categoryAxis=m({boundaryGap:!0,deduplication:null,splitLine:{show:!1},axisTick:{alignWithLabel:!1,interval:"auto"},axisLabel:{interval:"auto"}},zm),Rm.valueAxis=m({boundaryGap:[0,0],splitNumber:5,minorTick:{show:!1,splitNumber:5,length:3,lineStyle:{}},minorSplitLine:{show:!1,lineStyle:{color:"#eee",width:1}}},zm),Rm.timeAxis=L({scale:!0,min:"dataMin",max:"dataMax"},Rm.valueAxis),Rm.logAxis=L({scale:!0,logBase:10},Rm.valueAxis);function Bm(a,t,r,e){P(Vm,function(o){t.extend({type:a+"Axis."+o,mergeDefaultAndTheme:function(t,e){var n=this.layoutMode,i=n?yh(t):{};m(t,e.getTheme().get(o+"Axis")),m(t,this.getDefaultOption()),t.type=r(a,t),n&&vh(t,i,n)},optionUpdated:function(){"category"===this.option.type&&(this.__ordinalMeta=gg.createByAxisModel(this))},getCategories:function(t){var e=this.option;if("category"===e.type)return t?e.data:this.__ordinalMeta.categories},getOrdinalMeta:function(){return this.__ordinalMeta},defaultOption:f([{},Rm[o+"Axis"],e],!0)})}),Mh.registerSubTypeDefaulter(a+"Axis",z(r,a))}var Vm=["value","category","time","log"],Gm=Mh.extend({type:"cartesian2dAxis",axis:null,init:function(){Gm.superApply(this,"init",arguments),this.resetRange()},mergeOption:function(){Gm.superApply(this,"mergeOption",arguments),this.resetRange()},restoreData:function(){Gm.superApply(this,"restoreData",arguments),this.resetRange()},getCoordSysModel:function(){return this.ecModel.queryComponents({mainType:"grid",index:this.option.gridIndex,id:this.option.gridId})[0]}});function Fm(t,e){return e.type||(e.data?"category":"value")}m(Gm.prototype,uf);var Wm={offset:0};function Hm(t,e){return t.getCoordSysModel()===e}function Zm(t,e,n){this._coordsMap={},this._coordsList=[],this._axesMap={},this._axesList=[],this._initCartesian(t,e,n),this.model=t}Bm("x",Gm,Fm,Wm),Bm("y",Gm,Fm,Wm),Mh.extend({type:"grid",dependencies:["xAxis","yAxis"],layoutMode:"box",coordinateSystem:null,defaultOption:{show:!1,zlevel:0,z:0,left:"10%",top:60,right:"10%",bottom:60,containLabel:!1,backgroundColor:"rgba(0,0,0,0)",borderWidth:1,borderColor:"#ccc"}});var Um=Zm.prototype;function Xm(t,e,n,i){n.getAxesOnZeroOf=function(){return o?[o]:[]};var o,a=t[e],r=n.model,s=r.get("axisLine.onZero"),l=r.get("axisLine.onZeroAxisIndex");if(s){if(null!=l)Ym(a[l])&&(o=a[l]);else for(var h in a)if(a.hasOwnProperty(h)&&Ym(a[h])&&!i[u(a[h])]){o=a[h];break}o&&(i[u(o)]=!0)}function u(t){return t.dim+"_"+t.index}}function Ym(t){return t&&"category"!==t.type&&"time"!==t.type&&(e=t.scale.getExtent(),n=e[0],i=e[1],!(0<n&&0<i||n<0&&i<0));var e,n,i}Um.type="grid",Um.axisPointerEnabled=!0,Um.getRect=function(){return this._rect},Um.update=function(t,e){var n=this._axesMap;this._updateScale(t,this.model),P(n.x,function(t){of(t.scale,t.model)}),P(n.y,function(t){of(t.scale,t.model)});var i={};P(n.x,function(t){Xm(n,"y",t,i)}),P(n.y,function(t){Xm(n,"x",t,i)}),this.resize(this.model,e)},Um.resize=function(t,e,n){var l=fh(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()});this._rect=l;var i=this._axesList;function o(){P(i,function(t){var e,n,i,o,a=t.isHorizontal(),r=a?[0,l.width]:[0,l.height],s=t.inverse?1:0;t.setExtent(r[s],r[1-s]),e=t,n=a?l.x:l.y,i=e.getExtent(),o=i[0]+i[1],e.toGlobalCoord="x"===e.dim?function(t){return t+n}:function(t){return o-t+n},e.toLocalCoord="x"===e.dim?function(t){return t-n}:function(t){return o-t+n}})}o(),!n&&t.get("containLabel")&&(P(i,function(t){var e,n,i;t.model.get("axisLabel.inside")||(e=function(t){var e=t.model,n=t.scale;if(e.get("axisLabel.show")&&!n.isBlank()){var i,o,a="category"===t.type,r=n.getExtent(),s=a?n.count():(i=n.getTicks()).length,l=t.getLabelModel(),h=rf(t),u=1;40<s&&(u=Math.ceil(s/40));for(var c,d,p,g,f,m,v,y,x=0;x<s;x+=u){var _=h(i?i[x]:r[0]+x),w=l.getTextRect(_),b=(c=w,d=l.get("rotate")||0,0,p=d*Math.PI/180,g=c.plain(),f=g.width,m=g.height,v=f*Math.cos(p)+m*Math.sin(p),y=f*Math.sin(p)+m*Math.cos(p),new Sn(g.x,g.y,v,y));o?o.union(b):o=b}return o}}(t))&&(n=t.isHorizontal()?"height":"width",i=t.model.get("axisLabel.margin"),l[n]-=e[n]+i,"top"===t.position?l.y+=e.height+i:"left"===t.position&&(l.x+=e.width+i))}),o())},Um.getAxis=function(t,e){var n=this._axesMap[t];if(null!=n){if(null==e)for(var i in n)if(n.hasOwnProperty(i))return n[i];return n[e]}},Um.getAxes=function(){return this._axesList.slice()},Um.getCartesian=function(t,e){if(null!=t&&null!=e){var n="x"+t+"y"+e;return this._coordsMap[n]}V(t)&&(e=t.yAxisIndex,t=t.xAxisIndex);for(var i=0,o=this._coordsList;i<o.length;i++)if(o[i].getAxis("x").index===t||o[i].getAxis("y").index===e)return o[i]},Um.getCartesians=function(){return this._coordsList.slice()},Um.convertToPixel=function(t,e,n){var i=this._findConvertTarget(t,e);return i.cartesian?i.cartesian.dataToPoint(n):i.axis?i.axis.toGlobalCoord(i.axis.dataToCoord(n)):null},Um.convertFromPixel=function(t,e,n){var i=this._findConvertTarget(t,e);return i.cartesian?i.cartesian.pointToData(n):i.axis?i.axis.coordToData(i.axis.toLocalCoord(n)):null},Um._findConvertTarget=function(t,e){var n,i,o=e.seriesModel,a=e.xAxisModel||o&&o.getReferringComponents("xAxis")[0],r=e.yAxisModel||o&&o.getReferringComponents("yAxis")[0],s=e.gridModel,l=this._coordsList;return o?M(l,n=o.coordinateSystem)<0&&(n=null):a&&r?n=this.getCartesian(a.componentIndex,r.componentIndex):a?i=this.getAxis("x",a.componentIndex):r?i=this.getAxis("y",r.componentIndex):s&&s.coordinateSystem===this&&(n=this._coordsList[0]),{cartesian:n,axis:i}},Um.containPoint=function(t){var e=this._coordsList[0];if(e)return e.containPoint(t)},Um._initCartesian=function(r,t,e){var s={left:!1,right:!1,top:!1,bottom:!1},l={x:{},y:{}},h={x:0,y:0};if(t.eachComponent("xAxis",n("x"),this),t.eachComponent("yAxis",n("y"),this),!h.x||!h.y)return this._axesMap={},void(this._axesList=[]);function n(a){return function(t,e){var n,i,o;Hm(t,r)&&(n=t.get("position"),"x"===a?"top"!==n&&"bottom"!==n&&(n=s.bottom?"top":"bottom"):"left"!==n&&"right"!==n&&(n=s.left?"right":"left"),s[n]=!0,o="category"===(i=new Em(a,af(t),[0,0],t.get("type"),n)).type,i.onBand=o&&t.get("boundaryGap"),i.inverse=t.get("inverse"),(t.axis=i).model=t,i.grid=this,i.index=e,this._axesList.push(i),l[a][e]=i,h[a]++)}}P((this._axesMap=l).x,function(o,a){P(l.y,function(t,e){var n="x"+a+"y"+e,i=new Om(n);i.grid=this,i.model=r,this._coordsMap[n]=i,this._coordsList.push(i),i.addAxis(o),i.addAxis(t)},this)},this)},Um._updateScale=function(t,l){function h(e,n){P(e.mapDimension(n.dim,!0),function(t){n.scale.unionExtentFromData(e,cg(e,t))})}P(this._axesList,function(t){t.scale.setExtent(1/0,-1/0)}),t.eachSeries(function(t){if(Km(t)){var e=qm(t),n=e[0],i=e[1];if(!Hm(n,l)||!Hm(i,l))return;var o=this.getCartesian(n.componentIndex,i.componentIndex),a=t.getData(),r=o.getAxis("x"),s=o.getAxis("y");"list"===a.type&&(h(a,r),h(a,s))}},this)},Um.getTooltipAxes=function(i){var o=[],a=[];return P(this.getCartesians(),function(t){var e=null!=i&&"auto"!==i?t.getAxis(i):t.getBaseAxis(),n=t.getOtherAxis(e);M(o,e)<0&&o.push(e),M(a,n)<0&&a.push(n)}),{baseAxes:o,otherAxes:a}};var jm=["xAxis","yAxis"];function qm(n){return N(jm,function(t){var e=n.getReferringComponents(t)[0];if(D&&!e)throw new Error(t+' "'+Z(n.get(t+"Index"),n.get(t+"Id"),0)+'" not found');return e})}function Km(t){return"cartesian2d"===t.get("coordinateSystem")}Zm.create=function(i,o){var a=[];return i.eachComponent("grid",function(t,e){var n=new Zm(t,i,o);n.name="grid_"+e,n.resize(t,o,!0),t.coordinateSystem=n,a.push(n)}),i.eachSeries(function(t){if(Km(t)){var e=qm(t),n=e[0],i=e[1],o=n.getCoordSysModel();if(D){if(!o)throw new Error('Grid "'+Z(n.get("gridIndex"),n.get("gridId"),0)+'" not found');if(n.getCoordSysModel()!==i.getCoordSysModel())throw new Error("xAxis and yAxis must use the same grid")}var a=o.coordinateSystem;t.coordinateSystem=a.getCartesian(n.componentIndex,i.componentIndex)}}),a},Zm.dimensions=Zm.prototype.dimensions=Om.prototype.dimensions,nu.register("cartesian2d",Zm);function $m(t,e){this.opt=e,this.axisModel=t,L(e,{labelOffset:0,nameDirection:1,tickDirection:1,labelDirection:1,silent:!0}),this.group=new Mn;var n=new Mn({position:e.position.slice(),rotation:e.rotation});n.updateTransform(),this._transform=n.transform,this._dumbGroup=n}var Jm=Math.PI;$m.prototype={constructor:$m,hasBuilder:function(t){return!!Qm[t]},add:function(t){Qm[t].call(this)},getGroup:function(){return this.group}};var Qm={axisLine:function(){var t,e,a,n,r,s,i,o,l,h,u=this.opt,c=this.axisModel;c.get("axisLine.show")&&(t=this.axisModel.axis.getExtent(),e=this._transform,a=[t[0],0],n=[t[1],0],e&&(bt(a,a,e),bt(n,n,e)),r=k({lineCap:"round"},c.getModel("axisLine.lineStyle").getLineStyle()),this.group.add(new is({anid:"line",subPixelOptimize:!0,shape:{x1:a[0],y1:a[1],x2:n[0],y2:n[1]},style:r,strokeContainThreshold:u.strokeContainThreshold||5,silent:!0,z2:1})),s=c.get("axisLine.symbol"),i=c.get("axisLine.symbolSize"),"number"==typeof(o=c.get("axisLine.symbolOffset")||0)&&(o=[o,o]),null!=s&&("string"==typeof s&&(s=[s,s]),"string"!=typeof i&&"number"!=typeof i||(i=[i,i]),l=i[0],h=i[1],P([{rotate:u.rotation+Math.PI/2,offset:o[0],r:0},{rotate:u.rotation-Math.PI/2,offset:o[1],r:Math.sqrt((a[0]-n[0])*(a[0]-n[0])+(a[1]-n[1])*(a[1]-n[1]))}],function(t,e){var n,i,o;"none"!==s[e]&&null!=s[e]&&(n=xf(s[e],-l/2,-h/2,l,h,r.stroke,!0),i=t.r+t.offset,o=[a[0]+i*Math.cos(u.rotation),a[1]-i*Math.sin(u.rotation)],n.attr({rotation:t.rotate,position:o,silent:!0,z2:11}),this.group.add(n))},this)))},axisTickLabel:function(){var t=this.axisModel,e=this.opt,n=function(t,e,n){var i=e.axis,o=e.getModel("axisTick");if(!o.get("show")||i.scale.isBlank())return;for(var a=o.getModel("lineStyle"),r=n.tickDirection*o.get("length"),s=rv(i.getTicksCoords(),t._transform,r,L(a.getLineStyle(),{stroke:e.get("axisLine.lineStyle.color")}),"ticks"),l=0;l<s.length;l++)t.group.add(s[l]);return s}(this,t,e);!function(t,e,n){if(hf(t.axis))return;var i=t.get("axisLabel.showMinLabel"),o=t.get("axisLabel.showMaxLabel");n=n||[];var a=(e=e||[])[0],r=e[1],s=e[e.length-1],l=e[e.length-2],h=n[0],u=n[1],c=n[n.length-1],d=n[n.length-2];!1===i?(iv(a),iv(h)):ov(a,r)&&(i?(iv(r),iv(u)):(iv(a),iv(h)));!1===o?(iv(s),iv(c)):ov(l,s)&&(o?(iv(l),iv(d)):(iv(s),iv(c)))}(t,function(h,u,c){var d=u.axis;if(!Z(c.axisLabelShow,u.get("axisLabel.show"))||d.scale.isBlank())return;var p=u.getModel("axisLabel"),g=p.get("margin"),t=d.getViewLabels(),e=(Z(c.labelRotate,p.get("rotate"))||0)*Jm/180,f=ev(c.rotation,e,c.labelDirection),m=u.getCategories&&u.getCategories(!0),v=[],y=nv(u),x=u.get("triggerEvent");return P(t,function(t,e){var n=t.tickValue,i=t.formattedLabel,o=t.rawLabel,a=p;m&&m[n]&&m[n].textStyle&&(a=new Sl(m[n].textStyle,p,u.ecModel));var r=a.getTextColor()||u.get("axisLine.lineStyle.color"),s=[d.dataToCoord(n),c.labelOffset+c.labelDirection*g],l=new Gr({anid:"label_"+n,position:s,rotation:f.rotation,silent:y,z2:10});Js(l.style,a,{text:i,textAlign:a.getShallow("align",!0)||f.textAlign,textVerticalAlign:a.getShallow("verticalAlign",!0)||a.getShallow("baseline",!0)||f.textVerticalAlign,textFill:"function"==typeof r?r("category"===d.type?o:"value"===d.type?n+"":n,e):r}),x&&(l.eventData=tv(u),l.eventData.targetType="axisLabel",l.eventData.value=o),h._dumbGroup.add(l),l.updateTransform(),v.push(l),h.group.add(l),l.decomposeTransform()}),v}(this,t,e),n),function(t,e,n){var i=e.axis,o=e.getModel("minorTick");if(!o.get("show")||i.scale.isBlank())return;var a=i.getMinorTicksCoords();if(!a.length)return;for(var r=o.getModel("lineStyle"),s=n.tickDirection*o.get("length"),l=L(r.getLineStyle(),L(e.getModel("axisTick").getLineStyle(),{stroke:e.get("axisLine.lineStyle.color")})),h=0;h<a.length;h++)for(var u=rv(a[h],t._transform,s,l,"minorticks_"+h),c=0;c<u.length;c++)t.group.add(u[c])}(this,t,e)},axisName:function(){var t,e,n,i,o,a,r,s,l,h,u,c,d,p,g,f,m,v,y,x=this.opt,_=this.axisModel,w=Z(x.axisName,_.get("name"));w&&(t=_.get("nameLocation"),e=x.nameDirection,n=_.getModel("nameTextStyle"),i=_.get("nameGap")||0,a=(o=this.axisModel.axis.getExtent())[0]>o[1]?-1:1,r=["start"===t?o[0]-a*i:"end"===t?o[1]+a*i:(o[0]+o[1])/2,av(t)?x.labelOffset+e*i:0],null!=(l=_.get("nameRotate"))&&(l=l*Jm/180),av(t)?s=ev(x.rotation,null!=l?l:x.rotation,e):(s=function(t,e,n,i){var o,a,r=Bl(n-t.rotation),s=i[0]>i[1],l="start"===e&&!s||"start"!==e&&s;o=Vl(r-Jm/2)?(a=l?"bottom":"top","center"):Vl(r-1.5*Jm)?(a=l?"top":"bottom","center"):(a="middle",r<1.5*Jm&&Jm/2<r?l?"left":"right":l?"right":"left");return{rotation:r,textAlign:o,textVerticalAlign:a}}(x,t,l||0,o),null!=(h=x.axisNameAvailableWidth)&&(h=Math.abs(h/Math.sin(s.rotation)),isFinite(h)||(h=null))),u=n.getFont(),d=(c=_.get("nameTruncate",!0)||{}).ellipsis,p=Z(x.nameTruncateMaxWidth,c.maxWidth,h),g=null!=d&&null!=p?lh(w,p,u,d,{minChar:2,placeholder:c.placeholder}):w,f=_.get("tooltip",!0),(v={componentType:m=_.mainType,name:w,$vars:["name"]})[m+"Index"]=_.componentIndex,Js((y=new Gr({anid:"name",__fullText:w,__truncatedText:g,position:r,rotation:s.rotation,silent:nv(_),z2:1,tooltip:f&&f.show?k({content:w,formatter:function(){return w},formatterParams:v},f):null})).style,n,{text:g,textFont:u,textFill:n.getTextColor()||_.get("axisLine.lineStyle.color"),textAlign:n.get("align")||s.textAlign,textVerticalAlign:n.get("verticalAlign")||s.textVerticalAlign}),_.get("triggerEvent")&&(y.eventData=tv(_),y.eventData.targetType="axisName",y.eventData.name=w),this._dumbGroup.add(y),y.updateTransform(),this.group.add(y),y.decomposeTransform())}},tv=$m.makeAxisEventDataBase=function(t){var e={componentType:t.mainType,componentIndex:t.componentIndex};return e[t.mainType+"Index"]=t.componentIndex,e},ev=$m.innerTextLayout=function(t,e,n){var i,o=Bl(e-t),a=Vl(o)?(i=0<n?"top":"bottom","center"):Vl(o-Jm)?(i=0<n?"bottom":"top","center"):(i="middle",0<o&&o<Jm?0<n?"right":"left":0<n?"left":"right");return{rotation:o,textAlign:a,textVerticalAlign:i}};var nv=$m.isLabelSilent=function(t){var e=t.get("tooltip");return t.get("silent")||!(t.get("triggerEvent")||e&&e.show)};function iv(t){t&&(t.ignore=!0)}function ov(t,e){var n=t&&t.getBoundingRect().clone(),i=e&&e.getBoundingRect().clone();if(n&&i){var o=ne([]);return re(o,o,-t.rotation),n.applyTransform(oe([],o,t.getLocalTransform())),i.applyTransform(oe([],o,e.getLocalTransform())),n.intersect(i)}}function av(t){return"middle"===t||"center"===t}function rv(t,e,n,i,o){for(var a=[],r=[],s=[],l=0;l<t.length;l++){var h=t[l].coord;r[0]=h,s[r[1]=0]=h,s[1]=n,e&&(bt(r,r,e),bt(s,s,e));var u=new is({anid:o+"_"+t[l].tickValue,subPixelOptimize:!0,shape:{x1:r[0],y1:r[1],x2:s[0],y2:s[1]},style:i,z2:2,silent:!0});a.push(u)}return a}var sv=P,lv=z;function hv(t,e){var g,f,n,a,m,v,y,i={axesInfo:{},seriesInvolved:!1,coordSysAxesInfo:{},coordSysMap:{}};return g=i,n=e,a=(f=t).getComponent("tooltip"),m=f.getComponent("axisPointer"),v=m.get("link",!0)||[],y=[],sv(n.getCoordinateSystems(),function(c){var t,d,p,e,n,i;function o(t,e,n){var i,o,a,r,s,l,h=n.model.getModel("axisPointer",m),u=h.get("show");u&&("auto"!==u||t||dv(h))&&(null==e&&(e=h.get("triggerTooltip")),i=(h=t?function(t,e,n,i,o,a){var r=e.getModel("axisPointer"),s={};sv(["type","snap","lineStyle","shadowStyle","label","animation","animationDurationUpdate","animationEasingUpdate","z"],function(t){s[t]=C(r.get(t))}),s.snap="category"!==t.type&&!!a,"cross"===r.get("type")&&(s.type="line");var l=s.label||(s.label={});{var h,u;null==l.show&&(l.show=!1),"cross"===o&&(h=r.get("label.show"),l.show=null==h||h,a||(u=s.lineStyle=r.get("crossStyle"))&&L(l,u.textStyle))}return t.model.getModel("axisPointer",new Sl(s,n,i))}(n,p,m,f,t,e):h).get("snap"),o=pv(n.model),a=e||i||"category"===n.type,r=g.axesInfo[o]={key:o,axis:n,coordSys:c,axisPointerModel:h,triggerTooltip:e,involveSeries:a,snap:i,useHandle:dv(h),seriesModels:[]},d[o]=r,g.seriesInvolved|=a,null!=(s=function(t,e){for(var n=e.model,i=e.dim,o=0;o<t.length;o++){var a=t[o]||{};if(uv(a[i+"AxisId"],n.id)||uv(a[i+"AxisIndex"],n.componentIndex)||uv(a[i+"AxisName"],n.name))return o}}(v,n))&&((l=y[s]||(y[s]={axesInfo:{}})).axesInfo[o]=r,l.mapper=v[s].mapper,r.linkGroup=l))}c.axisPointerEnabled&&(t=pv(c.model),d=g.coordSysAxesInfo[t]={},p=(g.coordSysMap[t]=c).model.getModel("tooltip",a),sv(c.getAxes(),lv(o,!1,null)),c.getTooltipAxes&&a&&p.get("show")&&(e="axis"===p.get("trigger"),n="cross"===p.get("axisPointer.type"),i=c.getTooltipAxes(p.get("axisPointer.axis")),(e||n)&&sv(i.baseAxes,lv(o,!n||"cross",e)),n&&sv(i.otherAxes,lv(o,"cross",!1))))}),i.seriesInvolved&&function(o,t){t.eachSeries(function(n){var i=n.coordinateSystem,t=n.get("tooltip.trigger",!0),e=n.get("tooltip.show",!0);i&&"none"!==t&&!1!==t&&"item"!==t&&!1!==e&&!1!==n.get("axisPointer.show",!0)&&sv(o.coordSysAxesInfo[pv(i.model)],function(t){var e=t.axis;i.getAxis(e.dim)===e&&(t.seriesModels.push(n),null==t.seriesDataCount&&(t.seriesDataCount=0),t.seriesDataCount+=n.getData().count())})},this)}(i,t),i}function uv(t,e){return"all"===t||R(t)&&0<=M(t,e)||t===e}function cv(t){var e=(t.ecModel.getComponent("axisPointer")||{}).coordSysAxesInfo;return e&&e.axesInfo[pv(t)]}function dv(t){return!!t.get("handle.show")}function pv(t){return t.type+"||"+t.id}var gv=bp({type:"axis",_axisPointer:null,axisPointerClass:null,render:function(t,e,n,i){var o,a,r,s,l,h,u,c;!this.axisPointerClass||(c=cv(t))&&(o=c.axisPointerModel,a=c.axis.scale,r=o.option,s=o.get("status"),null!=(l=o.get("value"))&&(l=a.parse(l)),h=dv(o),null==s&&(r.status=h?"show":"hide"),(u=a.getExtent().slice())[0]>u[1]&&u.reverse(),(null==l||l>u[1])&&(l=u[1]),l<u[0]&&(l=u[0]),r.value=l,h&&(r.status=c.axis.scale.isBlank()?"hide":"show")),gv.superApply(this,"render",arguments),fv(this,t,0,n,0,!0)},updateAxisPointer:function(t,e,n,i,o){fv(this,t,0,n,0,!1)},remove:function(t,e){var n=this._axisPointer;n&&n.remove(e),gv.superApply(this,"remove",arguments)},dispose:function(t,e){mv(this,e),gv.superApply(this,"dispose",arguments)}});function fv(t,e,n,i,o,a){var r,s,l=gv.getAxisPointerClass(t.axisPointerClass);l&&((r=(s=cv(e))&&s.axisPointerModel)?(t._axisPointer||(t._axisPointer=new l)).render(e,r,i,a):mv(t,i))}function mv(t,e,n){var i=t._axisPointer;i&&i.dispose(e,n),t._axisPointer=null}var vv=[];function yv(t,e,n){n=n||{};var i,o=t.coordinateSystem,a=e.axis,r={},s=a.getAxesOnZeroOf()[0],l=a.position,h=s?"onZero":l,u=a.dim,c=o.getRect(),d=[c.x,c.x+c.width,c.y,c.y+c.height],p={left:0,right:1,top:0,bottom:1,onZero:2},g=e.get("offset")||0,f="x"===u?[d[2]-g,d[3]+g]:[d[0]-g,d[1]+g];s&&(i=s.toGlobalCoord(s.dataToCoord(0)),f[p.onZero]=Math.max(Math.min(i,f[1]),f[0])),r.position=["y"===u?f[p[h]]:d[0],"x"===u?f[p[h]]:d[3]],r.rotation=Math.PI/2*("x"===u?0:1);r.labelDirection=r.tickDirection=r.nameDirection={top:-1,bottom:1,left:-1,right:1}[l],r.labelOffset=s?f[p[l]]-f[p.onZero]:0,e.get("axisTick.inside")&&(r.tickDirection=-r.tickDirection),Z(n.labelInside,e.get("axisLabel.inside"))&&(r.labelDirection=-r.labelDirection);var m=e.get("axisLabel.rotate");return r.labelRotate="top"===h?-m:m,r.z2=1,r}gv.registerAxisPointerClass=function(t,e){if(D&&vv[t])throw new Error("axisPointer "+t+" exists");vv[t]=e},gv.getAxisPointerClass=function(t){return t&&vv[t]};var xv=["axisLine","axisTickLabel","axisName"],_v=["splitArea","splitLine","minorSplitLine"],wv=gv.extend({type:"cartesianAxis",axisPointerClass:"CartesianAxisPointer",render:function(e,t,n,i){this.group.removeAll();var o,a,r,s=this._axisGroup;this._axisGroup=new Mn,this.group.add(this._axisGroup),e.get("show")&&(a=yv(o=e.getCoordSysModel(),e),r=new $m(e,a),P(xv,r.add,r),this._axisGroup.add(r.getGroup()),P(_v,function(t){e.get(t+".show")&&this["_"+t](e,o)},this),cl(s,this._axisGroup,e),wv.superCall(this,"render",e,t,n,i))},remove:function(){this._splitAreaColors=null},_splitLine:function(t,e){var n=t.axis;if(!n.scale.isBlank())for(var i=t.getModel("splitLine"),o=i.getModel("lineStyle"),a=R(a=o.get("color"))?a:[a],r=e.coordinateSystem.getRect(),s=n.isHorizontal(),l=0,h=n.getTicksCoords({tickModel:i}),u=[],c=[],d=o.getLineStyle(),p=0;p<h.length;p++){var g=n.toGlobalCoord(h[p].coord);s?(u[0]=g,u[1]=r.y,c[0]=g,c[1]=r.y+r.height):(u[0]=r.x,u[1]=g,c[0]=r.x+r.width,c[1]=g);var f=l++%a.length,m=h[p].tickValue;this._axisGroup.add(new is({anid:null!=m?"line_"+h[p].tickValue:null,subPixelOptimize:!0,shape:{x1:u[0],y1:u[1],x2:c[0],y2:c[1]},style:L({stroke:a[f]},d),silent:!0}))}},_minorSplitLine:function(t,e){var n=t.axis,i=t.getModel("minorSplitLine").getModel("lineStyle"),o=e.coordinateSystem.getRect(),a=n.isHorizontal(),r=n.getMinorTicksCoords();if(r.length)for(var s=[],l=[],h=i.getLineStyle(),u=0;u<r.length;u++)for(var c=0;c<r[u].length;c++){var d=n.toGlobalCoord(r[u][c].coord);a?(s[0]=d,s[1]=o.y,l[0]=d,l[1]=o.y+o.height):(s[0]=o.x,s[1]=d,l[0]=o.x+o.width,l[1]=d),this._axisGroup.add(new is({anid:"minor_line_"+r[u][c].tickValue,subPixelOptimize:!0,shape:{x1:s[0],y1:s[1],x2:l[0],y2:l[1]},style:h,silent:!0}))}},_splitArea:function(t,e){var n=t.axis;if(!n.scale.isBlank()){var i=t.getModel("splitArea"),o=i.getModel("areaStyle"),a=o.get("color"),r=e.coordinateSystem.getRect(),s=n.getTicksCoords({tickModel:i,clamp:!0});if(s.length){var l=a.length,h=this._splitAreaColors,u=et(),c=0;if(h)for(var d=0;d<s.length;d++){var p=h.get(s[d].tickValue);if(null!=p){c=(p+(l-1)*d)%l;break}}for(var g=n.toGlobalCoord(s[0].coord),f=o.getAreaStyle(),a=R(a)?a:[a],d=1;d<s.length;d++){var m,v,y,x,_=n.toGlobalCoord(s[d].coord),g=n.isHorizontal()?(m=g,v=r.y,y=_-m,x=r.height,m+y):(m=r.x,v=g,y=r.width,v+(x=_-v)),w=s[d-1].tickValue;null!=w&&u.set(w,c),this._axisGroup.add(new es({anid:null!=w?"area_"+w:null,shape:{x:m,y:v,width:y,height:x},style:L({fill:a[c]},f),silent:!0})),c=(c+1)%l}this._splitAreaColors=u}}}});wv.extend({type:"xAxis"}),wv.extend({type:"yAxis"}),bp({type:"grid",render:function(t,e){this.group.removeAll(),t.get("show")&&this.group.add(new es({shape:t.coordinateSystem.getRect(),style:L({fill:t.get("backgroundColor")},t.getItemStyle()),silent:!0,z2:-1}))}}),pp(function(t){t.xAxis&&t.yAxis&&!t.grid&&(t.grid={})}),yp(Dm("line","circle","line")),vp(Cm("line")),gp(Id.PROCESSOR.STATISTIC,{seriesType:"line",modifyOutputEnd:!0,reset:function(t,e,n){var i,o,a,r,s,l,h=t.getData(),u=t.get("sampling"),c=t.coordinateSystem;"cartesian2d"===c.type&&u&&(i=c.getBaseAxis(),o=c.getOtherAxis(i),r=(a=i.getExtent())[1]-a[0],1<(s=Math.round(h.count()/r))&&("string"==typeof u?l=km[u]:"function"==typeof u&&(l=u),l&&t.setData(h.downSample(h.mapDimension(o.dim),1/s,l,Lm))))}});var bv=ec.extend({type:"series.__base_bar__",getInitialData:function(t,e){return dg(this.getSource(),this,{useEncodeDefaulter:!0})},getMarkerPosition:function(t){var e=this.coordinateSystem;if(e){var n=e.dataToPoint(e.clampData(t)),i=this.getData(),o=i.getLayout("offset"),a=i.getLayout("size");return n[e.getBaseAxis().isHorizontal()?0:1]+=o+a/2,n}return[NaN,NaN]},defaultOption:{zlevel:0,z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,barMinHeight:0,barMinAngle:0,large:!1,largeThreshold:400,progressive:3e3,progressiveChunkMode:"mod",itemStyle:{},emphasis:{}}});function Sv(t,e,n,i,o,a){Ks(t,e,n.getModel("label"),n.getModel("emphasis.label"),{labelFetcher:o,labelDataIndex:a,defaultText:Hf(o.getData(),a),isRectText:!0,autoColor:i}),Mv(t),Mv(e)}function Mv(t,e){"outside"===t.textPosition&&(t.textPosition=e)}bv.extend({type:"series.bar",dependencies:["grid","polar"],brushSelector:"rect",getProgressive:function(){return!!this.get("large")&&this.get("progressive")},getProgressiveThreshold:function(){var t=this.get("progressiveThreshold"),e=this.get("largeThreshold");return t<e&&(t=e),t},defaultOption:{clip:!0,roundCap:!1}});var Iv=aa([["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["stroke","barBorderColor"],["lineWidth","barBorderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"]]),Tv={getBarItemStyle:function(t){var e,n=Iv(this,t);return!this.getBorderLineDash||(e=this.getBorderLineDash())&&(n.lineDash=e),n}},Av=Ms({type:"sausage",shape:{cx:0,cy:0,r0:0,r:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0},buildPath:function(t,e){var n=e.cx,i=e.cy,o=Math.max(e.r0||0,0),a=Math.max(e.r,0),r=.5*(a-o),s=o+r,l=e.startAngle,h=e.endAngle,u=e.clockwise,c=Math.cos(l),d=Math.sin(l),p=Math.cos(h),g=Math.sin(h);(u?h-l<2*Math.PI:l-h<2*Math.PI)&&(t.moveTo(c*o+n,d*o+i),t.arc(c*s+n,d*s+i,r,-Math.PI+l,l,!u)),t.arc(n,i,a,l,h,!u),t.moveTo(p*a+n,g*a+i),t.arc(p*s+n,g*s+i,r,h-2*Math.PI,h-Math.PI,!u),0!==o&&(t.arc(n,i,o,h,l,u),t.moveTo(c*o+n,g*o+i)),t.closePath()}}),Dv=["itemStyle","barBorderWidth"],Cv=[0,0];k(Sl.prototype,Tv),Mp({type:"bar",render:function(t,e,n){this._updateDrawMode(t);var i=t.get("coordinateSystem");return"cartesian2d"===i||"polar"===i?this._isLargeDraw?this._renderLarge(t,e,n):this._renderNormal(t,e,n):D&&console.warn("Only cartesian2d and polar supported for bar."),this.group},incrementalPrepareRender:function(t,e,n){this._clear(),this._updateDrawMode(t)},incrementalRender:function(t,e,n,i){this._incrementalRenderLarge(t,e)},_updateDrawMode:function(t){var e=t.pipelineContext.large;(null==this._isLargeDraw||e^this._isLargeDraw)&&(this._isLargeDraw=e,this._clear())},_renderNormal:function(a,t,e){var r,s=this.group,l=a.getData(),h=this._data,u=a.coordinateSystem,n=u.getBaseAxis();"cartesian2d"===u.type?r=n.isHorizontal():"polar"===u.type&&(r="angle"===n.dim);var i,o,c,d,p,g=a.isAnimationEnabled()?a:null,f=a.get("clip",!0),m=(o=l,p=(i=u).getArea&&i.getArea(),"cartesian2d"===i.type&&("category"===(c=i.getBaseAxis()).type&&c.onBand||(d=o.getLayout("bandWidth"),c.isHorizontal()?(p.x-=d,p.width+=2*d):(p.y-=d,p.height+=2*d))),p);s.removeClipPath();var v=a.get("roundCap",!0);l.diff(h).add(function(t){if(l.hasValue(t)){var e=l.getItemModel(t),n=zv[u.type](l,t,e);if(f)if(Pv[u.type](m,n))return void s.remove(i);var i=Nv[u.type](t,n,r,g,!1,v);l.setItemGraphicEl(t,i),s.add(i),Bv(i,l,t,e,n,a,r,"polar"===u.type)}}).update(function(t,e){var n=h.getItemGraphicEl(e);if(l.hasValue(t)){var i=l.getItemModel(t),o=zv[u.type](l,t,i);if(f)if(Pv[u.type](m,o))return void s.remove(n);n?rl(n,{shape:o},g,t):n=Nv[u.type](t,o,r,g,!0,v),l.setItemGraphicEl(t,n),s.add(n),Bv(n,l,t,i,o,a,r,"polar"===u.type)}else s.remove(n)}).remove(function(t){var e=h.getItemGraphicEl(t);"cartesian2d"===u.type?e&&Ov(t,g,e):e&&Ev(t,g,e)}).execute(),this._data=l},_renderLarge:function(t,e,n){this._clear(),Gv(t,this.group);var i=t.get("clip",!0)?bm(t.coordinateSystem,!1,t):null;i?this.group.setClipPath(i):this.group.removeClipPath()},_incrementalRenderLarge:function(t,e){Gv(e,this.group,!0)},dispose:it,remove:function(t){this._clear(t)},_clear:function(e){var t=this.group,n=this._data;e&&e.get("animation")&&n&&!this._isLargeDraw?n.eachItemGraphicEl(function(t){("sector"===t.type?Ev:Ov)(t.dataIndex,e,t)}):t.removeAll(),this._data=null}});var Lv=Math.max,kv=Math.min,Pv={cartesian2d:function(t,e){var n=e.width<0?-1:1,i=e.height<0?-1:1;n<0&&(e.x+=e.width,e.width=-e.width),i<0&&(e.y+=e.height,e.height=-e.height);var o=Lv(e.x,t.x),a=kv(e.x+e.width,t.x+t.width),r=Lv(e.y,t.y),s=kv(e.y+e.height,t.y+t.height);e.x=o,e.y=r,e.width=a-o,e.height=s-r;var l=e.width<0||e.height<0;return n<0&&(e.x+=e.width,e.width=-e.width),i<0&&(e.y+=e.height,e.height=-e.height),l},polar:function(t){return!1}},Nv={cartesian2d:function(t,e,n,i,o){var a,r,s=new es({shape:k({},e)});return i&&(a=n?"height":"width",r={},s.shape[a]=0,r[a]=e[a],ml[o?"updateProps":"initProps"](s,{shape:r},i,t)),s},polar:function(t,e,n,i,o,a){var r,s,l=e.startAngle<e.endAngle,h=new(!n&&a?Av:Zr)({shape:L({clockwise:l},e)});return i&&(r=n?"r":"endAngle",s={},h.shape[r]=n?0:e.startAngle,s[r]=e[r],ml[o?"updateProps":"initProps"](h,{shape:s},i,t)),h}};function Ov(t,e,n){n.style.text=null,rl(n,{shape:{width:0}},e,t,function(){n.parent&&n.parent.remove(n)})}function Ev(t,e,n){n.style.text=null,rl(n,{shape:{r:n.shape.r0}},e,t,function(){n.parent&&n.parent.remove(n)})}var zv={cartesian2d:function(t,e,n){var i,o,a=t.getItemLayout(e),r=(i=a,o=n.get(Dv)||0,Math.min(o,Math.abs(i.width),Math.abs(i.height))),s=0<a.width?1:-1,l=0<a.height?1:-1;return{x:a.x+s*r/2,y:a.y+l*r/2,width:a.width-s*r,height:a.height-l*r}},polar:function(t,e,n){var i=t.getItemLayout(e);return{cx:i.cx,cy:i.cy,r0:i.r0,r:i.r,startAngle:i.startAngle,endAngle:i.endAngle}}};function Rv(t){return null!=t.startAngle&&null!=t.endAngle&&t.startAngle===t.endAngle}function Bv(t,e,n,i,o,a,r,s){var l=e.getItemVisual(n,"color"),h=e.getItemVisual(n,"opacity"),u=e.getVisual("borderColor"),c=i.getModel("itemStyle"),d=i.getModel("emphasis.itemStyle").getBarItemStyle();s||t.setShape("r",c.get("barBorderRadius")||0),t.useStyle(L({stroke:Rv(o)?"none":u,fill:Rv(o)?"none":l,opacity:h},c.getBarItemStyle()));var p=i.getShallow("cursor");p&&t.attr("cursor",p);r?o.height:o.width;s||Sv(t.style,d,i,l,a,n),Rv(o)&&(d.fill=d.stroke="none"),Xs(t,d)}var Vv=br.extend({type:"largeBar",shape:{points:[]},buildPath:function(t,e){for(var n=e.points,i=this.__startPoint,o=this.__baseDimIdx,a=0;a<n.length;a+=2)i[o]=n[a+o],t.moveTo(i[0],i[1]),t.lineTo(n[a],n[a+1])}});function Gv(t,e,n){var i=t.getData(),o=[],a=i.getLayout("valueAxisHorizontal")?1:0;o[1-a]=i.getLayout("valueAxisStart");var r,s,l,h,u,c=new Vv({shape:{points:i.getLayout("largePoints")},incremental:!!n,__startPoint:o,__baseDimIdx:a,__largeDataIndices:i.getLayout("largeDataIndices"),__barWidth:i.getLayout("barWidth")});e.add(c),r=c,s=t,h=(l=i).getVisual("borderColor")||l.getVisual("color"),u=s.getModel("itemStyle").getItemStyle(["color","borderColor"]),r.useStyle(u),r.style.fill=null,r.style.stroke=h,r.style.lineWidth=l.getLayout("barWidth"),c.seriesIndex=t.seriesIndex,t.get("silent")||(c.on("mousedown",Fv),c.on("mousemove",Fv))}var Fv=Mc(function(t){var e=function(t,e,n){var i=t.__baseDimIdx,o=1-i,a=t.shape.points,r=t.__largeDataIndices,s=Math.abs(t.__barWidth/2),l=t.__startPoint[o];Cv[0]=e,Cv[1]=n;for(var h=Cv[i],u=Cv[1-i],c=h-s,d=h+s,p=0,g=a.length/2;p<g;p++){var f=2*p,m=a[f+i],v=a[f+o];if(c<=m&&m<=d&&(l<=v?l<=u&&u<=v:v<=u&&u<=l))return r[p]}return-1}(this,t.offsetX,t.offsetY);this.dataIndex=0<=e?e:null},30,!1);vp(Id.VISUAL.LAYOUT,z(Og,"bar")),vp(Id.VISUAL.PROGRESSIVE_LAYOUT,Eg),yp({seriesType:"bar",reset:function(t){t.getData().setVisual("legendSymbol","roundRect")}});function Wv(t,e,n){e=R(e)?{coordDimensions:e}:k({},e);var i=t.getSource(),o=ag(i,e),a=new Hp(o,t);return a.initData(i,n),a}var Hv={updateSelectedMap:function(t){this._targetList=R(t)?t.slice():[],this._selectTargetMap=S(t||[],function(t,e){return t.set(e.name,e),t},et())},select:function(t,e){var n=null!=e?this._targetList[e]:this._selectTargetMap.get(t);"single"===this.get("selectedMode")&&this._selectTargetMap.each(function(t){t.selected=!1}),n&&(n.selected=!0)},unSelect:function(t,e){var n=null!=e?this._targetList[e]:this._selectTargetMap.get(t);n&&(n.selected=!1)},toggleSelected:function(t,e){var n=null!=e?this._targetList[e]:this._selectTargetMap.get(t);if(null!=n)return this[n.selected?"unSelect":"select"](t,e),n.selected},isSelected:function(t,e){var n=null!=e?this._targetList[e]:this._selectTargetMap.get(t);return n&&n.selected}};function Zv(n,e){this.getAllNames=function(){var t=e();return t.mapArray(t.getName)},this.containName=function(t){return 0<=e().indexOfName(t)},this.indexOfName=function(t){return n().indexOfName(t)},this.getItemVisual=function(t,e){return n().getItemVisual(t,e)}}var Uv=Sp({type:"series.pie",init:function(t){Uv.superApply(this,"init",arguments),this.legendVisualProvider=new Zv(E(this.getData,this),E(this.getRawData,this)),this.updateSelectedMap(this._createSelectableList()),this._defaultLabelLine(t)},mergeOption:function(t){Uv.superCall(this,"mergeOption",t),this.updateSelectedMap(this._createSelectableList())},getInitialData:function(t,e){return Wv(this,{coordDimensions:["value"],encodeDefaulter:z(Uh,this)})},_createSelectableList:function(){for(var t=this.getRawData(),e=t.mapDimension("value"),n=[],i=0,o=t.count();i<o;i++)n.push({name:t.getName(i),value:t.get(e,i),selected:Bu(t,i,"selected")});return n},getDataParams:function(t){var e=this.getData(),n=Uv.superCall(this,"getDataParams",t),i=[];return e.each(e.mapDimension("value"),function(t){i.push(t)}),n.percent=zl(i,t,e.hostModel.get("percentPrecision")),n.$vars.push("percent"),n},_defaultLabelLine:function(t){Eo(t,"labelLine",["show"]);var e=t.labelLine,n=t.emphasis.labelLine;e.show=e.show&&t.label.show,n.show=n.show&&t.emphasis.label.show},defaultOption:{zlevel:0,z:2,legendHoverLink:!0,hoverAnimation:!0,center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,minAngle:0,minShowLabelAngle:0,selectedOffset:10,hoverOffset:10,avoidLabelOverlap:!0,percentPrecision:2,stillShowZeroSum:!0,left:0,top:0,right:0,bottom:0,width:null,height:null,label:{rotate:!1,show:!0,position:"outer",alignTo:"none",margin:"25%",bleedMargin:10,distanceToLabelLine:5},labelLine:{show:!0,length:15,length2:15,smooth:!1,lineStyle:{width:1,type:"solid"}},itemStyle:{borderWidth:1},animationType:"expansion",animationTypeUpdate:"transition",animationEasing:"cubicOut"}});function Xv(t,e,n,i){var o=e.getData(),a=this.dataIndex,r=o.getName(a),s=e.get("selectedOffset");i.dispatchAction({type:"pieToggleSelect",from:t,name:r,seriesId:e.id}),o.each(function(t){Yv(o.getItemGraphicEl(t),o.getItemLayout(t),e.isSelected(o.getName(t)),s,n)})}function Yv(t,e,n,i,o){var a=(e.startAngle+e.endAngle)/2,r=n?i:0,s=[Math.cos(a)*r,Math.sin(a)*r];o?t.animate().when(200,{position:s}).start("bounceOut"):t.attr("position",s)}function jv(t,e){Mn.call(this);var n=new Zr({z2:2}),i=new qr,o=new Gr;this.add(n),this.add(i),this.add(o),this.updateData(t,e,!0)}b(Uv,Hv);var qv=jv.prototype;qv.updateData=function(t,e,n){var i=this.childAt(0),o=this.childAt(1),a=this.childAt(2),r=t.hostModel,s=t.getItemModel(e),l=t.getItemLayout(e),h=k({},l);h.label=null;var u=r.getShallow("animationTypeUpdate");n?(i.setShape(h),"scale"===r.getShallow("animationType")?(i.shape.r=l.r0,sl(i,{shape:{r:l.r}},r,e)):(i.shape.endAngle=l.startAngle,rl(i,{shape:{endAngle:l.endAngle}},r,e))):"expansion"===u?i.setShape(h):rl(i,{shape:h},r,e);var c=t.getItemVisual(e,"color");i.useStyle(L({lineJoin:"bevel",fill:c},s.getModel("itemStyle").getItemStyle())),i.hoverStyle=s.getModel("emphasis.itemStyle").getItemStyle();var d=s.getShallow("cursor");d&&i.attr("cursor",d),Yv(this,t.getItemLayout(e),r.isSelected(null,e),r.get("selectedOffset"),r.get("animation"));var p=!n&&"transition"===u;this._updateLabel(t,e,p),this.highDownOnUpdate=s.get("hoverAnimation")&&r.isAnimationEnabled()?function(t,e){"emphasis"===e?(o.ignore=o.hoverIgnore,a.ignore=a.hoverIgnore,i.stopAnimation(!0),i.animateTo({shape:{r:l.r+r.get("hoverOffset")}},300,"elasticOut")):(o.ignore=o.normalIgnore,a.ignore=a.normalIgnore,i.stopAnimation(!0),i.animateTo({shape:{r:l.r}},300,"elasticOut"))}:null,Xs(this)},qv._updateLabel=function(t,e,n){var i,o,a,r,s,l,h,u=this.childAt(1),c=this.childAt(2),d=t.hostModel,p=t.getItemModel(e),g=t.getItemLayout(e).label,f=t.getItemVisual(e,"color");!g||isNaN(g.x)||isNaN(g.y)?c.ignore=c.normalIgnore=c.hoverIgnore=u.ignore=u.normalIgnore=u.hoverIgnore=!0:(i={points:g.linePoints||[[g.x,g.y],[g.x,g.y],[g.x,g.y]]},o={x:g.x,y:g.y},n?(rl(u,{shape:i},d,e),rl(c,{style:o},d,e)):(u.attr({shape:i}),c.attr({style:o})),c.attr({rotation:g.rotation,origin:[g.x,g.y],z2:10}),a=p.getModel("label"),r=p.getModel("emphasis.label"),s=p.getModel("labelLine"),l=p.getModel("emphasis.labelLine"),f=t.getItemVisual(e,"color"),Ks(c.style,c.hoverStyle={},a,r,{labelFetcher:t.hostModel,labelDataIndex:e,defaultText:g.text,autoColor:f,useInsideStyle:!!g.inside},{textAlign:g.textAlign,textVerticalAlign:g.verticalAlign,opacity:t.getItemVisual(e,"opacity")}),c.ignore=c.normalIgnore=!a.get("show"),c.hoverIgnore=!r.get("show"),u.ignore=u.normalIgnore=!s.get("show"),u.hoverIgnore=!l.get("show"),u.setStyle({stroke:f,opacity:t.getItemVisual(e,"opacity")}),u.setStyle(s.getModel("lineStyle").getLineStyle()),u.hoverStyle=l.getModel("lineStyle").getLineStyle(),(h=s.get("smooth"))&&!0===h&&(h=.4),u.setShape({smooth:h}))},w(jv,Mn);function Kv(n,t){P(t,function(a){a.update="updateView",fp(a,function(t,e){var o={};return e.eachComponent({mainType:"series",subType:n,query:t},function(n){n[a.method]&&n[a.method](t.name,t.dataIndex);var i=n.getData();i.each(function(t){var e=i.getName(t);o[e]=n.isSelected(e)||!1})}),{name:t.name,selected:o,seriesId:t.seriesId}})})}function $v(i){return{getTargetSeries:function(t){var e={},n=et();return t.eachSeriesByType(i,function(t){t.__paletteScope=e,n.set(t.uid,t)}),n},reset:function(s,t){var l=s.getRawData(),h={},u=s.getData();u.each(function(t){var e=u.getRawIndex(t);h[e]=t}),l.each(function(t){var e,n,i,o=h[t],a=null!=o&&u.getItemVisual(o,"color",!0),r=null!=o&&u.getItemVisual(o,"borderColor",!0);a&&r||(e=l.getItemModel(t)),a||(n=e.get("itemStyle.color")||s.getColorFromPalette(l.getName(t)||t+"",s.__paletteScope,l.count()),null!=o&&u.setItemVisual(o,"color",n)),r||(i=e.get("itemStyle.borderColor"),null!=o&&u.setItemVisual(o,"borderColor",i))})}}}gc.extend({type:"pie",init:function(){var t=new Mn;this._sectorGroup=t},render:function(t,e,n,i){if(!i||i.from!==this.uid){var o=t.getData(),a=this._data,r=this.group,s=e.get("animation"),l=!a,h=t.get("animationType"),u=t.get("animationTypeUpdate"),c=z(Xv,this.uid,t,s,n),d=t.get("selectedMode");if(o.diff(a).add(function(t){var e=new jv(o,t);l&&"scale"!==h&&e.eachChild(function(t){t.stopAnimation(!0)}),d&&e.on("click",c),o.setItemGraphicEl(t,e),r.add(e)}).update(function(t,e){var n=a.getItemGraphicEl(e);l||"transition"===u||n.eachChild(function(t){t.stopAnimation(!0)}),n.updateData(o,t),n.off("click"),d&&n.on("click",c),r.add(n),o.setItemGraphicEl(t,n)}).remove(function(t){var e=a.getItemGraphicEl(t);r.remove(e)}).execute(),s&&0<o.count()&&(l?"scale"!==h:"transition"!==u)){for(var p=o.getItemLayout(0),g=1;isNaN(p.startAngle)&&g<o.count();++g)p=o.getItemLayout(g);var f=Math.max(n.getWidth(),n.getHeight())/2,m=E(r.removeClipPath,r);r.setClipPath(this._createClipPath(p.cx,p.cy,f,p.startAngle,p.clockwise,m,t,l))}else r.removeClipPath();this._data=o}},dispose:function(){},_createClipPath:function(t,e,n,i,o,a,r,s){var l=new Zr({shape:{cx:t,cy:e,r0:0,r:n,startAngle:i,endAngle:i,clockwise:o}});return(s?sl:rl)(l,{shape:{endAngle:i+(o?1:-1)*Math.PI*2}},r,a),l},containPoint:function(t,e){var n=e.getData().getItemLayout(0);if(n){var i=t[0]-n.cx,o=t[1]-n.cy,a=Math.sqrt(i*i+o*o);return a<=n.r&&a>=n.r0}}});var Jv=Math.PI/180;function Qv(o,t,e,n,i,a,r,s,l,h){function u(t,e,n){for(var i=t;i<e&&!(o[i].y+n>l+r);i++)if(o[i].y+=n,t<i&&i+1<e&&o[i+1].y>o[i].y+o[i].height)return void c(i,n/2);c(e-1,n/2)}function c(t,e){for(var n=t;0<=n&&!(o[n].y-e<l)&&(o[n].y-=e,!(0<n&&o[n].y>o[n-1].y+o[n-1].height));n--);}function d(t,e,n,i,o,a){for(var r,s,l,h,u=e?Number.MAX_VALUE:0,c=0,d=t.length;c<d;c++){"none"===t[c].labelAlignTo&&(r=Math.abs(t[c].y-i),s=t[c].len,l=t[c].len2,h=r<o+s?Math.sqrt((o+s+l)*(o+s+l)-r*r):Math.abs(t[c].x-n),e&&u<=h&&(h=u-10),!e&&h<=u&&(h=u+10),t[c].x=n+h*a,u=h)}}o.sort(function(t,e){return t.y-e.y});for(var p,g,f=0,m=o.length,v=[],y=[],x=0;x<m;x++){"outer"===o[x].position&&"labelLine"===o[x].labelAlignTo&&(g=o[x].x-h,o[x].linePoints[1][0]+=g,o[x].x=h),(p=o[x].y-f)<0&&u(x,m,-p),f=o[x].y+o[x].height}r-f<0&&c(m-1,f-r);for(x=0;x<m;x++)o[x].y>=e?y.push(o[x]):v.push(o[x]);d(v,!1,t,e,n,i),d(y,!0,t,e,n,i)}function ty(t){return"center"===t.position}function ey(L,k,P,t,N,e){var O,E,z=L.getData(),R=[],B=!1,V=(L.get("minShowLabelAngle")||0)*Jv;z.each(function(t){var e,n,i,o,a,r,s,l,h,u,c,d,p,g,f,m,v,y=z.getItemLayout(t),x=z.getItemModel(t),_=x.getModel("label"),w=_.get("position")||x.get("emphasis.label.position"),b=_.get("distanceToLabelLine"),S=_.get("alignTo"),M=Ll(_.get("margin"),P),I=_.get("bleedMargin"),T=_.getFont(),A=x.getModel("labelLine"),D=Ll(D=A.get("length"),P),C=Ll(C=A.get("length2"),P);y.angle<V||(e=(y.startAngle+y.endAngle)/2,n=Math.cos(e),i=Math.sin(e),O=y.cx,E=y.cy,a=hi(o=L.getFormattedLabel(t,"normal")||z.getName(t),T,f,"top"),r="inside"===w||"inner"===w,f="center"===w?(d=y.cx,p=y.cy,"center"):(d=(s=(r?(y.r+y.r0)/2*n:y.r*n)+O)+3*n,p=(l=(r?(y.r+y.r0)/2*i:y.r*i)+E)+3*i,r||(h=s+n*(D+k-y.r),u=l+i*(D+k-y.r),c=h+(n<0?-1:1)*C,d="edge"===S?n<0?N+M:N+P-M:c+(n<0?-b:b),g=[[s,l],[h,p=u],[c,u]]),r?"center":"edge"===S?0<n?"right":"left":0<n?"left":"right"),v="number"==typeof(m=_.get("rotate"))?m*(Math.PI/180):m?n<0?-e+Math.PI:-e:0,B=!!v,y.label={x:d,y:p,position:w,height:a.height,len:D,len2:C,linePoints:g,textAlign:f,verticalAlign:"middle",rotation:v,inside:r,labelDistance:b,labelAlignTo:S,labelMargin:M,bleedMargin:I,textRect:a,text:o,font:T},r||R.push(y.label))}),!B&&L.get("avoidLabelOverlap")&&function(t,e,n,i,o,a,r,s){for(var l=[],h=[],u=Number.MAX_VALUE,c=-Number.MAX_VALUE,d=0;d<t.length;d++)ty(t[d])||(t[d].x<e?(u=Math.min(u,t[d].x),l.push(t[d])):(c=Math.max(c,t[d].x),h.push(t[d])));for(Qv(h,e,n,i,1,0,a,0,s,c),Qv(l,e,n,i,-1,0,a,0,s,u),d=0;d<t.length;d++){var p,g,f,m,v,y=t[d];ty(y)||(p=y.linePoints)&&(g="edge"===y.labelAlignTo,f=y.textRect.width,(m=g?y.x<e?p[2][0]-y.labelDistance-r-y.labelMargin:r+o-y.labelMargin-p[2][0]-y.labelDistance:y.x<e?y.x-r-y.bleedMargin:r+o-y.x-y.bleedMargin)<y.textRect.width&&(y.text=pi(y.text,m,y.font),"edge"===y.labelAlignTo&&(f=li(y.text,y.font))),v=p[1][0]-p[2][0],g?y.x<e?p[2][0]=r+y.labelMargin+f+y.labelDistance:p[2][0]=r+o-y.labelMargin-f-y.labelDistance:(y.x<e?p[2][0]=y.x+y.labelDistance:p[2][0]=y.x-y.labelDistance,p[1][0]=p[2][0]+v),p[1][1]=p[2][1]=y.y)}}(R,O,E,k,P,t,N,e)}var ny=2*Math.PI,iy=Math.PI/180;function oy(t){return{seriesType:t,reset:function(t,e){var i,o=e.findComponents({mainType:"legend"});o&&o.length&&(i=t.getData()).filterSelf(function(t){for(var e=i.getName(t),n=0;n<o.length;n++)if(!o[n].isSelected(e))return!1;return!0})}}}Kv("pie",[{type:"pieToggleSelect",event:"pieselectchanged",method:"toggleSelected"},{type:"pieSelect",event:"pieselected",method:"select"},{type:"pieUnSelect",event:"pieunselected",method:"unSelect"}]),yp($v("pie")),vp(z(function(t,e,D,n){e.eachSeriesByType(t,function(t){var e,o=t.getData(),n=o.mapDimension("value"),a=(e=D,fh(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()})),i=t.get("center"),r=t.get("radius");R(r)||(r=[0,r]),R(i)||(i=[i,i]);var s=Ll(a.width,D.getWidth()),l=Ll(a.height,D.getHeight()),h=Math.min(s,l),u=Ll(i[0],s)+a.x,c=Ll(i[1],l)+a.y,d=Ll(r[0],h/2),p=Ll(r[1],h/2),g=-t.get("startAngle")*iy,f=t.get("minAngle")*iy,m=0;o.each(n,function(t){isNaN(t)||m++});var v=o.getSum(n),y=Math.PI/(v||m)*2,x=t.get("clockwise"),_=t.get("roseType"),w=t.get("stillShowZeroSum"),b=o.getDataExtent(n);b[0]=0;var S,M=ny,I=0,T=g,A=x?1:-1;o.each(n,function(t,e){var n,i;isNaN(t)?o.setItemLayout(e,{angle:NaN,startAngle:NaN,endAngle:NaN,clockwise:x,cx:u,cy:c,r0:d,r:_?NaN:p,viewRect:a}):((n="area"!==_?0===v&&w?y:t*y:ny/m)<f?M-=n=f:I+=t,i=T+A*n,o.setItemLayout(e,{angle:n,startAngle:T,endAngle:i,clockwise:x,cx:u,cy:c,r0:d,r:_?Cl(t,b,[d,p]):p,viewRect:a}),T=i)}),M<ny&&m&&(M<=.001?(S=ny/m,o.each(n,function(t,e){var n;isNaN(t)||((n=o.getItemLayout(e)).angle=S,n.startAngle=g+A*e*S,n.endAngle=g+A*(e+1)*S)})):(y=M/I,T=g,o.each(n,function(t,e){var n,i;isNaN(t)||(i=(n=o.getItemLayout(e)).angle===f?f:t*y,n.startAngle=T,n.endAngle=T+A*i,T+=A*i)}))),ey(t,p,a.width,a.height,a.x,a.y)})},"pie")),gp(oy("pie")),ec.extend({type:"series.scatter",dependencies:["grid","polar","geo","singleAxis","calendar"],getInitialData:function(t,e){return dg(this.getSource(),this,{useEncodeDefaulter:!0})},brushSelector:"point",getProgressive:function(){var t=this.option.progressive;return null==t?this.option.large?5e3:this.get("progressive"):t},getProgressiveThreshold:function(){var t=this.option.progressiveThreshold;return null==t?this.option.large?1e4:this.get("progressiveThreshold"):t},defaultOption:{coordinateSystem:"cartesian2d",zlevel:0,z:2,legendHoverLink:!0,hoverAnimation:!0,symbolSize:10,large:!1,largeThreshold:2e3,itemStyle:{opacity:.8},clip:!0}});var ay=Ms({shape:{points:null},symbolProxy:null,softClipShape:null,buildPath:function(t,e){var n=e.points,i=e.size,o=this.symbolProxy,a=o.shape;if(!((t.getContext?t.getContext():t)&&i[0]<4))for(var r=0;r<n.length;){var s=n[r++],l=n[r++];isNaN(s)||isNaN(l)||this.softClipShape&&!this.softClipShape.contain(s,l)||(a.x=s-i[0]/2,a.y=l-i[1]/2,a.width=i[0],a.height=i[1],o.buildPath(t,a,!0))}},afterBrush:function(t){var e=this.shape,n=e.points,i=e.size;if(i[0]<4){this.setTransform(t);for(var o=0;o<n.length;){var a=n[o++],r=n[o++];isNaN(a)||isNaN(r)||this.softClipShape&&!this.softClipShape.contain(a,r)||t.fillRect(a-i[0]/2,r-i[1]/2,i[0],i[1])}this.restoreTransform(t)}},findDataIndex:function(t,e){for(var n=this.shape,i=n.points,o=n.size,a=Math.max(o[0],4),r=Math.max(o[1],4),s=i.length/2-1;0<=s;s--){var l=2*s,h=i[l]-a/2,u=i[1+l]-r/2;if(h<=t&&u<=e&&t<=h+a&&e<=u+r)return s}return-1}});function ry(){this.group=new Mn}var sy=ry.prototype;function ly(t,e,n){Bf.call(this,t,e,n),this.type="value",this.angle=0,this.name="",this.model}function hy(t,e,n){this._model=t,this.dimensions=[],this._indicatorAxes=N(t.getIndicatorModels(),function(t,e){var n="indicator_"+e,i=new ly(n,new("log"===t.get("axisType")?tf:Ig));return i.name=t.get("name"),(i.model=t).axis=i,this.dimensions.push(n),i},this),this.resize(t,n),this.cx,this.cy,this.r,this.r0,this.startAngle}sy.isPersistent=function(){return!this._incremental},sy.updateData=function(t,e){this.group.removeAll();var n=new ay({rectHover:!0,cursor:"default"});n.setShape({points:t.getLayout("symbolPoints")}),this._setCommon(n,t,!1,e),this.group.add(n),this._incremental=null},sy.updateLayout=function(t){var i;this._incremental||(i=t.getLayout("symbolPoints"),this.group.eachChild(function(t){var e,n;null!=t.startIndex&&(e=2*(t.endIndex-t.startIndex),n=4*t.startIndex*2,i=new Float32Array(i.buffer,n,e)),t.setShape("points",i)}))},sy.incrementalPrepareUpdate=function(t){this.group.removeAll(),this._clearIncremental(),2e6<t.count()?(this._incremental||(this._incremental=new ds({silent:!0})),this.group.add(this._incremental)):this._incremental=null},sy.incrementalUpdate=function(t,e,n){var i;this._incremental?(i=new ay,this._incremental.addDisplayable(i,!0)):((i=new ay({rectHover:!0,cursor:"default",startIndex:t.start,endIndex:t.end})).incremental=!0,this.group.add(i)),i.setShape({points:e.getLayout("symbolPoints")}),this._setCommon(i,e,!!this._incremental,n)},sy._setCommon=function(n,t,e,i){var o=t.hostModel;i=i||{};var a=t.getVisual("symbolSize");n.setShape("size",a instanceof Array?a:[a,a]),n.softClipShape=i.clipShape||null,n.symbolProxy=xf(t.getVisual("symbol"),0,0,0,0),n.setColor=n.symbolProxy.setColor;var r=n.shape.size[0]<4;n.useStyle(o.getModel("itemStyle").getItemStyle(r?["color","shadowBlur","shadowColor"]:["color"]));var s=t.getVisual("color");s&&n.setColor(s),e||(n.seriesIndex=o.seriesIndex,n.on("mousemove",function(t){n.dataIndex=null;var e=n.findDataIndex(t.offsetX,t.offsetY);0<=e&&(n.dataIndex=e+(n.startIndex||0))}))},sy.remove=function(){this._clearIncremental(),this._incremental=null,this.group.removeAll()},sy._clearIncremental=function(){var t=this._incremental;t&&t.clearDisplaybles()},Mp({type:"scatter",render:function(t,e,n){var i=t.getData();this._updateSymbolDraw(i,t).updateData(i,{clipShape:this._getClipShape(t)}),this._finished=!0},incrementalPrepareRender:function(t,e,n){var i=t.getData();this._updateSymbolDraw(i,t).incrementalPrepareUpdate(i),this._finished=!1},incrementalRender:function(t,e,n){this._symbolDraw.incrementalUpdate(t,e.getData(),{clipShape:this._getClipShape(e)}),this._finished=t.end===e.getData().count()},updateTransform:function(t,e,n){var i=t.getData();if(this.group.dirty(),!this._finished||1e4<i.count()||!this._symbolDraw.isPersistent())return{update:!0};var o=Cm().reset(t);o.progress&&o.progress({start:0,end:i.count()},i),this._symbolDraw.updateLayout(i)},_getClipShape:function(t){var e=t.coordinateSystem,n=e&&e.getArea&&e.getArea();return t.get("clip",!0)?n:null},_updateSymbolDraw:function(t,e){var n=this._symbolDraw,i=e.pipelineContext.large;return n&&i===this._isLargeDraw||(n&&n.remove(),n=this._symbolDraw=new(i?ry:tm),this._isLargeDraw=i,this.group.removeAll()),this.group.add(n.group),n},remove:function(t,e){this._symbolDraw&&this._symbolDraw.remove(!0),this._symbolDraw=null},dispose:function(){}}),yp(Dm("scatter","circle")),vp(Cm("scatter")),w(ly,Bf),hy.prototype.getIndicatorAxes=function(){return this._indicatorAxes},hy.prototype.dataToPoint=function(t,e){var n=this._indicatorAxes[e];return this.coordToPoint(n.dataToCoord(t),e)},hy.prototype.coordToPoint=function(t,e){var n=this._indicatorAxes[e].angle;return[this.cx+t*Math.cos(n),this.cy-t*Math.sin(n)]},hy.prototype.pointToData=function(t){var e=t[0]-this.cx,n=t[1]-this.cy,i=Math.sqrt(e*e+n*n);e/=i,n/=i;for(var o,a=Math.atan2(-n,e),r=1/0,s=-1,l=0;l<this._indicatorAxes.length;l++){var h=this._indicatorAxes[l],u=Math.abs(a-h.angle);u<r&&(o=h,s=l,r=u)}return[s,+(o&&o.coordToData(i))]},hy.prototype.resize=function(t,e){var n=t.get("center"),i=e.getWidth(),o=e.getHeight(),a=Math.min(i,o)/2;this.cx=Ll(n[0],i),this.cy=Ll(n[1],o),this.startAngle=t.get("startAngle")*Math.PI/180;var r=t.get("radius");"string"!=typeof r&&"number"!=typeof r||(r=[0,r]),this.r0=Ll(r[0],a),this.r=Ll(r[1],a),P(this._indicatorAxes,function(t,e){t.setExtent(this.r0,this.r);var n=this.startAngle+e*Math.PI*2/this._indicatorAxes.length,n=Math.atan2(Math.sin(n),Math.cos(n));t.angle=n},this)},hy.prototype.update=function(i,t){var o=this._indicatorAxes,a=this._model;P(o,function(t){t.scale.setExtent(1/0,-1/0)}),i.eachSeriesByType("radar",function(t,e){var n;"radar"===t.get("coordinateSystem")&&i.getComponent("radar",t.get("radarIndex"))===a&&(n=t.getData(),P(o,function(t){t.scale.unionExtentFromData(n,n.mapDimension(t.dim))}))},this);var p=a.get("splitNumber");function g(t){var e=Math.pow(10,Math.floor(Math.log(t)/Math.LN10)),n=t/e;return 2===n?n=5:n*=2,n*e}P(o,function(t,e){var n=nf(t.scale,t.model);of(t.scale,t.model);var i,o,a=t.model,r=t.scale,s=a.getMin(),l=a.getMax(),h=r.getInterval();if(null!=s&&null!=l)r.setExtent(+s,+l),r.setInterval((l-s)/p);else if(null!=s)for(;i=s+h*p,r.setExtent(+s,i),r.setInterval(h),h=g(h),i<n[1]&&isFinite(i)&&isFinite(n[1]););else if(null!=l)for(;o=l-h*p,r.setExtent(o,+l),r.setInterval(h),h=g(h),o>n[0]&&isFinite(o)&&isFinite(n[0]););else{var u=r.getTicks().length-1;p<u&&(h=g(h));var c=Math.round((n[0]+n[1])/2/h)*h,d=Math.round(p/2);r.setExtent(kl(c-d*h),kl(c+(p-d)*h)),r.setInterval(h)}})},hy.dimensions=[],hy.create=function(t,n){var i=[];return t.eachComponent("radar",function(t){var e=new hy(t,0,n);i.push(e),t.coordinateSystem=e}),t.eachSeriesByType("radar",function(t){"radar"===t.get("coordinateSystem")&&(t.coordinateSystem=i[t.get("radarIndex")||0])}),i},nu.register("radar",hy);var uy=Rm.valueAxis;function cy(t,e){return L({show:e},t)}wp({type:"radar",optionUpdated:function(){var o=this.get("boundaryGap"),a=this.get("splitNumber"),r=this.get("scale"),s=this.get("axisLine"),l=this.get("axisTick"),h=this.get("axisType"),u=this.get("axisLabel"),c=this.get("name"),d=this.get("name.show"),p=this.get("name.formatter"),g=this.get("nameGap"),f=this.get("triggerEvent"),t=N(this.get("indicator")||[],function(t){null!=t.max&&0<t.max&&!t.min?t.min=0:null!=t.min&&t.min<0&&!t.max&&(t.max=0);var e,n=c;null!=t.color&&(n=L({color:t.color},c)),t=m(C(t),{boundaryGap:o,splitNumber:a,scale:r,axisLine:s,axisTick:l,axisType:h,axisLabel:u,name:t.text,nameLocation:"end",nameGap:g,nameTextStyle:n,triggerEvent:f},!1),d||(t.name=""),"string"==typeof p?(e=t.name,t.name=p.replace("{value}",null!=e?e:"")):"function"==typeof p&&(t.name=p(t.name,t));var i=k(new Sl(t,null,this.ecModel),uf);return i.mainType="radar",i.componentIndex=this.componentIndex,i},this);this.getIndicatorModels=function(){return t}},defaultOption:{zlevel:0,z:0,center:["50%","50%"],radius:"75%",startAngle:90,name:{show:!0},boundaryGap:[0,0],splitNumber:5,nameGap:15,scale:!1,shape:"polygon",axisLine:m({lineStyle:{color:"#bbb"}},uy.axisLine),axisLabel:cy(uy.axisLabel,!1),axisTick:cy(uy.axisTick,!1),axisType:"interval",splitLine:cy(uy.splitLine,!0),splitArea:cy(uy.splitArea,!0),indicator:[]}});var dy=["axisLine","axisTickLabel","axisName"];bp({type:"radar",render:function(t,e,n){this.group.removeAll(),this._buildAxes(t),this._buildSplitLineAndArea(t)},_buildAxes:function(t){var e=t.coordinateSystem;P(N(e.getIndicatorAxes(),function(t){return new $m(t.model,{position:[e.cx,e.cy],rotation:t.angle,labelDirection:-1,tickDirection:-1,nameDirection:1})}),function(t){P(dy,t.add,t),this.group.add(t.getGroup())},this)},_buildSplitLineAndArea:function(t){var i=t.coordinateSystem,e=i.getIndicatorAxes();if(e.length){var n=t.get("shape"),o=t.getModel("splitLine"),a=t.getModel("splitArea"),r=o.getModel("lineStyle"),s=a.getModel("areaStyle"),l=o.get("show"),h=a.get("show"),u=r.get("color"),c=s.get("color"),u=R(u)?u:[u],c=R(c)?c:[c],d=[],p=[];if("circle"===n)for(var g=e[0].getTicksCoords(),f=i.cx,m=i.cy,v=0;v<g.length;v++){l&&d[I(d,u,v)].push(new Wr({shape:{cx:f,cy:m,r:g[v].coord}})),h&&v<g.length-1&&p[I(p,c,v)].push(new Ur({shape:{cx:f,cy:m,r0:g[v].coord,r:g[v+1].coord}}))}else for(var y,x=N(e,function(t,e){var n=t.getTicksCoords();return y=null==y?n.length-1:Math.min(n.length-1,y),N(n,function(t){return i.coordToPoint(t.coord,e)})}),_=[],v=0;v<=y;v++){for(var w=[],b=0;b<e.length;b++)w.push(x[b][v]);w[0]?w.push(w[0].slice()):D&&console.error("Can't draw value axis "+v),l&&d[I(d,u,v)].push(new qr({shape:{points:w}})),h&&_&&p[I(p,c,v-1)].push(new jr({shape:{points:w.concat(_)}})),_=w.slice().reverse()}var S=r.getLineStyle(),M=s.getAreaStyle();P(p,function(t,e){this.group.add(Ls(t,{style:L({stroke:"none",fill:c[e%c.length]},M),silent:!0}))},this),P(d,function(t,e){this.group.add(Ls(t,{style:L({fill:"none",stroke:u[e%u.length]},S),silent:!0}))},this)}function I(t,e,n){var i=n%e.length;return t[i]=t[i]||[],i}}});var py=ec.extend({type:"series.radar",dependencies:["radar"],init:function(t){py.superApply(this,"init",arguments),this.legendVisualProvider=new Zv(E(this.getData,this),E(this.getRawData,this))},getInitialData:function(t,e){return Wv(this,{generateCoord:"indicator_",generateCoordCount:1/0})},formatTooltip:function(i){var o=this.getData(),t=this.coordinateSystem.getIndicatorAxes(),e=this.getData().getName(i);return Ql(""===e?this.name:e)+"<br/>"+N(t,function(t,e){var n=o.get(o.mapDimension(t.dim),i);return Ql(t.name+" : "+n)}).join("<br />")},defaultOption:{zlevel:0,z:2,coordinateSystem:"radar",legendHoverLink:!0,radarIndex:0,lineStyle:{width:2,type:"solid"},label:{position:"top"},symbol:"emptyCircle",symbolSize:4}});Mp({type:"radar",render:function(l,t,e){var n=l.coordinateSystem,f=this.group,m=l.getData(),s=this._data;function h(t,e){var n=t.getItemVisual(e,"symbol")||"circle",i=t.getItemVisual(e,"color");if("none"!==n){var o,a=(R(o=t.getItemVisual(e,"symbolSize"))||(o=[+o,+o]),o),r=xf(n,-1,-1,2,2,i);return r.attr({style:{strokeNoScale:!0},z2:100,scale:[a[0]/2,a[1]/2]}),r}}function u(t,e,n,i,o,a){n.removeAll();for(var r=0;r<e.length-1;r++){var s=h(i,o);s&&(t[s.__dimIdx=r]?(s.attr("position",t[r]),ml[a?"initProps":"updateProps"](s,{position:e[r]},l,o)):s.attr("position",e[r]),n.add(s))}}function c(t){return N(t,function(t){return[n.cx,n.cy]})}m.diff(s).add(function(t){var e,n,i,o,a,r=m.getItemLayout(t);r&&(e=new jr,n=new qr,i={shape:{points:r}},e.shape.points=c(r),n.shape.points=c(r),sl(e,i,l,t),sl(n,i,l,t),o=new Mn,a=new Mn,o.add(n),o.add(e),o.add(a),u(n.shape.points,r,a,m,t,!0),m.setItemGraphicEl(t,o))}).update(function(t,e){var n=s.getItemGraphicEl(e),i=n.childAt(0),o=n.childAt(1),a=n.childAt(2),r={shape:{points:m.getItemLayout(t)}};r.shape.points&&(u(i.shape.points,r.shape.points,a,m,t,!1),rl(i,r,l),rl(o,r,l),m.setItemGraphicEl(t,n))}).remove(function(t){f.remove(s.getItemGraphicEl(t))}).execute(),m.eachItemGraphicEl(function(t,n){var e=m.getItemModel(n),i=t.childAt(0),o=t.childAt(1),a=t.childAt(2),r=m.getItemVisual(n,"color");f.add(t),i.useStyle(L(e.getModel("lineStyle").getLineStyle(),{fill:"none",stroke:r})),i.hoverStyle=e.getModel("emphasis.lineStyle").getLineStyle();var s=e.getModel("areaStyle"),l=e.getModel("emphasis.areaStyle"),h=s.isEmpty()&&s.parentModel.isEmpty(),u=(u=l.isEmpty()&&l.parentModel.isEmpty())&&h;o.ignore=h,o.useStyle(L(s.getAreaStyle(),{fill:r,opacity:.7})),o.hoverStyle=l.getAreaStyle();var c=e.getModel("itemStyle").getItemStyle(["color"]),d=e.getModel("emphasis.itemStyle").getItemStyle(),p=e.getModel("label"),g=e.getModel("emphasis.label");a.eachChild(function(t){t.setStyle(c),t.hoverStyle=C(d);var e=m.get(m.dimensions[t.__dimIdx],n);null!=e&&!isNaN(e)||(e=""),Ks(t.style,t.hoverStyle,p,g,{labelFetcher:m.hostModel,labelDataIndex:n,labelDimIndex:t.__dimIdx,defaultText:e,autoColor:r,isRectText:!0})}),t.highDownOnUpdate=function(t,e){o.attr("ignore","emphasis"===e?u:h)},Xs(t)}),this._data=m},remove:function(){this.group.removeAll(),this._data=null},dispose:function(){}});function gy(t){return!isNaN(t[0])&&!isNaN(t[1])}function fy(t){return[t.cx,t.cy]}yp($v("radar")),yp(Dm("radar","circle")),vp(function(t){t.eachSeriesByType("radar",function(t){var e,n=t.getData(),o=[],a=t.coordinateSystem;a&&(P(e=a.getIndicatorAxes(),function(t,i){n.each(n.mapDimension(e[i].dim),function(t,e){o[e]=o[e]||[];var n=a.dataToPoint(t,i);o[e][i]=gy(n)?n:fy(a)})}),n.each(function(t){var e=T(o[t],gy)||fy(a);o[t].push(e.slice()),n.setItemLayout(t,o[t])}))})}),gp(oy("radar")),pp(function(n){var i,t=n.polar;t&&(R(t)||(t=[t]),i=[],P(t,function(t,e){t.indicator?(t.type&&!t.shape&&(t.shape=t.type),n.radar=n.radar||[],R(n.radar)||(n.radar=[n.radar]),n.radar.push(t)):i.push(t)}),n.polar=i),P(n.series,function(t){t&&"radar"===t.type&&t.polarIndex&&(t.radarIndex=t.polarIndex)})});for(var my=[126,25],vy=[[[0,3.5],[7,11.2],[15,11.9],[30,7],[42,.7],[52,.7],[56,7.7],[59,.7],[64,.7],[64,0],[5,0],[0,3.5]],[[13,16.1],[19,14.7],[16,21.7],[11,23.1],[13,16.1]],[[12,32.2],[14,38.5],[15,38.5],[13,32.2],[12,32.2]],[[16,47.6],[12,53.2],[13,53.2],[18,47.6],[16,47.6]],[[6,64.4],[8,70],[9,70],[8,64.4],[6,64.4]],[[23,82.6],[29,79.8],[30,79.8],[25,82.6],[23,82.6]],[[37,70.7],[43,62.3],[44,62.3],[39,70.7],[37,70.7]],[[48,51.1],[51,45.5],[53,45.5],[50,51.1],[48,51.1]],[[51,35],[51,28.7],[53,28.7],[53,35],[51,35]],[[52,22.4],[55,17.5],[56,17.5],[53,22.4],[52,22.4]],[[58,12.6],[62,7],[63,7],[60,12.6],[58,12.6]],[[0,3.5],[0,93.1],[64,93.1],[64,0],[63,0],[63,92.4],[1,92.4],[1,3.5],[0,3.5]]],yy=0;yy<vy.length;yy++)for(var xy=0;xy<vy[yy].length;xy++)vy[yy][xy][0]/=10.5,vy[yy][xy][1]/=-14,vy[yy][xy][0]+=my[0],vy[yy][xy][1]+=my[1];var _y={"南海诸岛":[32,80],"广东":[0,-10],"香港":[10,5],"澳门":[-10,10],"天津":[5,5]},wy={Russia:[100,60],"United States":[-99,38],"United States of America":[-99,38]},by=[[[123.45165252685547,25.73527164402261],[123.49731445312499,25.73527164402261],[123.49731445312499,25.750734064600884],[123.45165252685547,25.750734064600884],[123.45165252685547,25.73527164402261]]],Sy=Ho(),My={load:function(u,t){var e=Sy(t).parsed;if(e)return e;var n,i,c=t.specialAreas||{},o=t.geoJSON;try{n=o?Af(o):[]}catch(t){throw new Error("Invalid geoJson format\n"+t.message)}return i=n,"china"===u&&i.push(new If("南海诸岛",N(vy,function(t){return{type:"polygon",exterior:t}}),my)),P(n,function(t){var e,n,i,o,a,r,s,l=t.name;e=t,"china"!==u||(n=_y[e.name])&&((i=e.center)[0]+=n[0]/10.5,i[1]+=-n[1]/14),o=t,"world"!==u||(a=wy[o.name])&&((r=o.center)[0]=a[0],r[1]=a[1]),s=t,"china"===u&&"台湾"===s.name&&s.geometries.push({type:"polygon",exterior:by[0]});var h=c[l];h&&t.transformTo(h.left,h.top,h.width,h.height)}),Sy(t).parsed={regions:n,boundingRect:function(t){for(var e,n=0;n<t.length;n++){var i=t[n].getBoundingRect();(e=e||i.clone()).union(i)}return e}(n)}}};var Iy=Ho();function Ty(t,e){var n,i,o,a=t.svgXML;try{q(null!=(l=(n=a&&(i=a,o={ignoreViewBox:!0,ignoreRootClip:!0},(new od).parse(i,o))||{}).root))}catch(t){throw new Error("Invalid svg format\n"+t.message)}var r,s,l,h=n.width,u=n.height,c=n.viewBoxRect;return e||(e=null==h||null==u?l.getBoundingRect():new Sn(0,0,0,0),null!=h&&(e.width=h),null!=u&&(e.height=u)),c&&(r=fd(c,e.width,e.height),s=l,(l=new Mn).add(s),s.scale=r.scale,s.position=r.position),l.setClipPath(new es({shape:e.plain()})),{root:l,boundingRect:e}}var Ay={geoJSON:My,svg:{load:function(t,e){var n=Iy(e).originRoot;if(n)return{root:n,boundingRect:Iy(e).boundingRect};var i=Ty(e);return Iy(e).originRoot=i.root,Iy(e).boundingRect=i.boundingRect,i},makeGraphic:function(t,e,n){var i=Iy(e),o=i.rootMap||(i.rootMap=et());if(s=o.get(n))return s;var a=i.originRoot,r=i.boundingRect,s=i.originRootHostKey?Ty(e,r).root:(i.originRootHostKey=n,a);return o.set(n,s)},removeGraphic:function(t,e,n){var i=Iy(e),o=i.rootMap;o&&o.removeKey(n),n===i.originRootHostKey&&(i.originRootHostKey=null)}}},Dy={load:function(i,o){var a,r=[],s=et(),l=et();return P(Ly(i),function(t){var e=Ay[t.type].load(i,t);P(e.regions,function(t){var e=t.name;o&&o.hasOwnProperty(e)&&(t=t.cloneShallow(e=o[e])),r.push(t),s.set(e,t),l.set(e,t.center)});var n=e.boundingRect;n&&(a?a.union(n):a=n.clone())}),{regions:r,regionsMap:s,nameCoordMap:l,boundingRect:a||new Sn(0,0,0,0)}},makeGraphic:Cy("makeGraphic"),removeGraphic:Cy("removeGraphic")};function Cy(a){return function(n,i){var t=Ly(n),o=[];return P(t,function(t){var e=Ay[t.type][a];e&&o.push(e(n,t,i))}),o}}function Ly(t){var e,n=vd.retrieveMap(t)||[];return D&&(n.length||(e=t,D&&console.error("Map "+e+" not exists. The GeoJSON of the map must be provided."))),n}b(ec.extend({type:"series.map",dependencies:["geo"],layoutMode:"box",needsDrawMap:!1,seriesGroup:[],getInitialData:function(t){for(var e=Wv(this,{coordDimensions:["value"],encodeDefaulter:z(Uh,this)}),n=e.mapDimension("value"),i=et(),o=[],a=[],r=0,s=e.count();r<s;r++){var l=e.getName(r);i.set(l,!0),o.push({name:l,value:e.get(n,r),selected:Bu(e,r,"selected")})}return P(Dy.load(this.getMapType(),this.option.nameMap).regions,function(t){var e=t.name;i.get(e)||(o.push({name:e}),a.push(e))}),this.updateSelectedMap(o),e.appendValues([],a),e},getHostGeoModel:function(){var t=this.option.geoIndex;return null!=t?this.dependentModels.geo[t]:null},getMapType:function(){return(this.getHostGeoModel()||this).option.map},getRawValue:function(t){var e=this.getData();return e.get(e.mapDimension("value"),t)},getRegionModel:function(t){var e=this.getData();return e.getItemModel(e.indexOfName(t))},formatTooltip:function(t){for(var e=this.getData(),n=jl(this.getRawValue(t)),i=e.getName(t),o=this.seriesGroup,a=[],r=0;r<o.length;r++){var s=o[r].originalData.indexOfName(i),l=e.mapDimension("value");isNaN(o[r].originalData.get(l,s))||a.push(Ql(o[r].name))}return a.join(", ")+"<br />"+Ql(i+" : "+n)},getTooltipPosition:function(t){if(null!=t){var e=this.getData().getName(t),n=this.coordinateSystem,i=n.getRegion(e);return i&&n.dataToPoint(i.center)}},setZoom:function(t){this.option.zoom=t},setCenter:function(t){this.option.center=t},defaultOption:{zlevel:0,z:2,coordinateSystem:"geo",map:"",left:"center",top:"center",aspectScale:.75,showLegendSymbol:!0,dataRangeHoverLink:!0,boundingCoords:null,center:null,zoom:1,scaleLimit:null,label:{show:!1,color:"#000"},itemStyle:{borderWidth:.5,borderColor:"#444",areaColor:"#eee"},emphasis:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{areaColor:"rgba(255,215,0,0.8)"}}}}),Hv);var ky="\0_ec_interaction_mutex";function Py(t,e){return Ny(t)[e]}function Ny(t){return t[ky]||(t[ky]={})}function Oy(n){this.pointerChecker,this._zr=n,this._opt={};var t=E,i=t(Ey,this),o=t(zy,this),a=t(Ry,this),r=t(By,this),s=t(Vy,this);Ct.call(this),this.setPointerChecker=function(t){this.pointerChecker=t},this.enable=function(t,e){this.disable(),this._opt=L(C(e)||{},{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}),null==t&&(t=!0),!0!==t&&"move"!==t&&"pan"!==t||(n.on("mousedown",i),n.on("mousemove",o),n.on("mouseup",a)),!0!==t&&"scale"!==t&&"zoom"!==t||(n.on("mousewheel",r),n.on("pinch",s))},this.disable=function(){n.off("mousedown",i),n.off("mousemove",o),n.off("mouseup",a),n.off("mousewheel",r),n.off("pinch",s)},this.dispose=this.disable,this.isDragging=function(){return this._dragging},this.isPinching=function(){return this._pinching}}function Ey(t){var e,n;Ht(t)||t.target&&t.target.draggable||(e=t.offsetX,n=t.offsetY,this.pointerChecker&&this.pointerChecker(t,e,n)&&(this._x=e,this._y=n,this._dragging=!0))}function zy(t){var e,n,i,o,a,r;this._dragging&&Wy("moveOnMouseMove",t,this._opt)&&"pinch"!==t.gestureEvent&&!Py(this._zr,"globalPan")&&(e=t.offsetX,n=t.offsetY,a=e-(i=this._x),r=n-(o=this._y),this._x=e,this._y=n,this._opt.preventDefaultMouseMove&&Wt(t.event),Fy(this,"pan","moveOnMouseMove",t,{dx:a,dy:r,oldX:i,oldY:o,newX:e,newY:n}))}function Ry(t){Ht(t)||(this._dragging=!1)}function By(t){var e,n,i=Wy("zoomOnMouseWheel",t,this._opt),o=Wy("moveOnMouseWheel",t,this._opt),a=t.wheelDelta,r=Math.abs(a),s=t.offsetX,l=t.offsetY;0!==a&&(i||o)&&(i&&(e=3<r?1.4:1<r?1.2:1.1,Gy(this,"zoom","zoomOnMouseWheel",t,{scale:0<a?e:1/e,originX:s,originY:l})),o&&Gy(this,"scrollMove","moveOnMouseWheel",t,{scrollDelta:(0<a?1:-1)*(3<(n=Math.abs(a))?.4:1<n?.15:.05),originX:s,originY:l}))}function Vy(t){Py(this._zr,"globalPan")||Gy(this,"zoom",null,t,{scale:1<t.pinchScale?1.1:1/1.1,originX:t.pinchX,originY:t.pinchY})}function Gy(t,e,n,i,o){t.pointerChecker&&t.pointerChecker(i,o.originX,o.originY)&&(Wt(i.event),Fy(t,e,n,i,o))}function Fy(t,e,n,i,o){o.isAvailableBehavior=E(Wy,null,n,i),t.trigger(e,o)}function Wy(t,e,n){var i=n[t];return!t||i&&(!B(i)||e.event[i+"Key"])}function Hy(t,e,n){var i=t.target,o=i.position;o[0]+=e,o[1]+=n,i.dirty()}function Zy(t,e,n,i){var o,a,r=t.target,s=t.zoomLimit,l=r.position,h=r.scale,u=t.zoom=t.zoom||1;u*=e,s&&(o=s.min||0,a=s.max||1/0,u=Math.max(Math.min(a,u),o));var c=u/t.zoom;t.zoom=u,l[0]-=(n-l[0])*(c-1),l[1]-=(i-l[1])*(c-1),h[0]*=c,h[1]*=c,r.dirty()}fp({type:"takeGlobalCursor",event:"globalCursorTaken",update:"update"},function(){}),b(Oy,Ct);var Uy={axisPointer:1,tooltip:1,brush:1};function Xy(t,e,n){var i=e.getComponentByElement(t.topTarget),o=i&&i.coordinateSystem;return i&&i!==n&&!Uy[i.mainType]&&o&&o.model!==n}function Yy(t){var e=t.getItemStyle(),n=t.get("areaColor");return null!=n&&(e.fill=n),e}function jy(n,t){t.eachChild(function(e){P(e.__regions,function(t){e.trigger(n.isSelected(t.name)?"emphasis":"normal")})})}function qy(t,e){var n=new Mn;this.uid=Al("ec_map_draw"),this._controller=new Oy(t.getZr()),this._controllerHost={target:e?n:null},this.group=n,this._updateGroup=e,this._mouseDownFlag,this._mapName,this._initialized,n.add(this._regionsGroup=new Mn),n.add(this._backgroundGroup=new Mn)}qy.prototype={constructor:qy,draw:function(_,t,e,n,i){var w="geo"===_.mainType,b=_.getData&&_.getData();w&&t.eachComponent({mainType:"series",subType:"map"},function(t){b||t.getHostGeoModel()!==_||(b=t.getData())});var o=_.coordinateSystem;this._updateBackground(o);var S=this._regionsGroup,M=this.group;o._roamTransformable.transform&&(M.transform=o._roamTransformable.transform.slice(),M.decomposeTransform());var I=o._rawTransformable.scale,T=o._rawTransformable.position;S.removeAll();var a,r,s,l,h,A=["itemStyle"],D=["emphasis","itemStyle"],C=["label"],L=["emphasis","label"],k=et();P(o.regions,function(t){var e=k.get(t.name)||k.set(t.name,new Mn),a=new hs({segmentIgnoreThreshold:1,shape:{paths:[]}});e.add(a);var n,i,o=_.getRegionModel(t.name)||_,r=o.getModel(A),s=o.getModel(D),l=Yy(r),h=Yy(s),u=o.getModel(C),c=o.getModel(L);b&&(n=b.indexOfName(t.name),(i=b.getItemVisual(n,"color",!0))&&(l.fill=i));function d(t){return[t[0]*I[0]+T[0],t[1]*I[1]+T[1]]}P(t.geometries,function(t){if("polygon"===t.type){for(var e=[],n=0;n<t.exterior.length;++n)e.push(d(t.exterior[n]));a.shape.paths.push(new jr({segmentIgnoreThreshold:1,shape:{points:e}}));for(n=0;n<(t.interiors?t.interiors.length:0);++n){for(var i=t.interiors[n],e=[],o=0;o<i.length;++o)e.push(d(i[o]));a.shape.paths.push(new jr({segmentIgnoreThreshold:1,shape:{points:e}}))}}}),a.setStyle(l),a.style.strokeNoScale=!0,a.culling=!0;var p,g,f,m=u.get("show"),v=c.get("show"),y=b&&isNaN(b.get(b.mapDimension("value"),n)),x=b&&b.getItemLayout(n);(w||y&&(m||v)||x&&x.showLabel)&&(p=w?t.name:n,(!b||0<=n)&&(g=_),Ks((f=new Gr({position:d(t.center.slice()),scale:[1/M.scale[0],1/M.scale[1]],z2:10,silent:!0})).style,f.hoverStyle={},u,c,{labelFetcher:g,labelDataIndex:p,defaultText:t.name,useInsideStyle:!1},{textAlign:"center",textVerticalAlign:"middle"}),e.add(f)),b?b.setItemGraphicEl(n,e):(o=_.getRegionModel(t.name),a.eventData={componentType:"geo",componentIndex:_.componentIndex,geoIndex:_.componentIndex,name:t.name,region:o&&o.option||{}}),(e.__regions||(e.__regions=[])).push(t),e.highDownSilentOnTouch=!!_.get("selectedMode"),Xs(e,h),S.add(e)}),this._updateController(_,t,e),a=this,r=_,l=e,h=n,(s=S).off("click"),s.off("mousedown"),r.get("selectedMode")&&(s.on("mousedown",function(){a._mouseDownFlag=!0}),s.on("click",function(t){if(a._mouseDownFlag){a._mouseDownFlag=!1;for(var e,n=t.target;!n.__regions;)n=n.parent;n&&((e={type:("geo"===r.mainType?"geo":"map")+"ToggleSelect",batch:N(n.__regions,function(t){return{name:t.name,from:h.uid}})})[r.mainType+"Id"]=r.id,l.dispatchAction(e),jy(r,s))}})),jy(_,S)},remove:function(){this._regionsGroup.removeAll(),this._backgroundGroup.removeAll(),this._controller.dispose(),this._mapName&&Dy.removeGraphic(this._mapName,this.uid),this._mapName=null,this._controllerHost={}},_updateBackground:function(t){var e=t.map;this._mapName!==e&&P(Dy.makeGraphic(e,this.uid),function(t){this._backgroundGroup.add(t)},this),this._mapName=e},_updateController:function(i,t,o){var a=i.coordinateSystem,e=this._controller,n=this._controllerHost;n.zoomLimit=i.get("scaleLimit"),n.zoom=a.getZoom(),e.enable(i.get("roam")||!1);var r=i.mainType;function s(){var t={type:"geoRoam",componentType:r};return t[r+"Id"]=i.id,t}e.off("pan").on("pan",function(t){this._mouseDownFlag=!1,Hy(n,t.dx,t.dy),o.dispatchAction(k(s(),{dx:t.dx,dy:t.dy}))},this),e.off("zoom").on("zoom",function(t){var e;this._mouseDownFlag=!1,Zy(n,t.scale,t.originX,t.originY),o.dispatchAction(k(s(),{zoom:t.scale,originX:t.originX,originY:t.originY})),this._updateGroup&&(e=this.group.scale,this._regionsGroup.traverse(function(t){"text"===t.type&&t.attr("scale",[1/e[0],1/e[1]])}))},this),e.setPointerChecker(function(t,e,n){return a.getViewRectAfterRoam().contain(e,n)&&!Xy(t,o,i)})}};var Ky="__seriesMapHighDown",$y="__seriesMapCallKey";function Jy(t){var e=this[Ky];e&&e.recordVersion===this[$y]&&Qy(e,t)}function Qy(t,e){var n=t.circle,i=t.labelModel,o=t.hoverLabelModel,a=t.emphasisText,r=t.normalText;e?(n.style.extendFrom(Js({},o,{text:o.get("show")?a:null},{isRectText:!0,useInsideStyle:!1},!0)),n.__mapOriginalZ2=n.z2,n.z2+=vs):(Js(n.style,i,{text:i.get("show")?r:null,textPosition:i.getShallow("position")||"bottom"},{isRectText:!0,useInsideStyle:!1}),n.dirty(!1),null!=n.__mapOriginalZ2&&(n.z2=n.__mapOriginalZ2,n.__mapOriginalZ2=null))}function tx(t,e,n){var i,o,a,r,s,l=t.getZoom(),h=t.getCenter(),u=e.zoom,c=t.dataToPoint(h);return null!=e.dx&&null!=e.dy&&(c[0]-=e.dx,c[1]-=e.dy,h=t.pointToData(c),t.setCenter(h)),null!=u&&(n&&(i=n.min||0,o=n.max||1/0,u=Math.max(Math.min(l*u,o),i)/l),t.scale[0]*=u,t.scale[1]*=u,a=t.position,r=(e.originX-a[0])*(u-1),s=(e.originY-a[1])*(u-1),a[0]-=r,a[1]-=s,t.updateTransform(),h=t.pointToData(c),t.setCenter(h),t.setZoom(u*l)),{center:t.getCenter(),zoom:t.getZoom()}}Mp({type:"map",render:function(t,e,n,i){var o,a;i&&"mapToggleSelect"===i.type&&i.from===this.uid||((o=this.group).removeAll(),t.getHostGeoModel()||(i&&"geoRoam"===i.type&&"series"===i.componentType&&i.seriesId===t.id?(a=this._mapDraw)&&o.add(a.group):t.needsDrawMap?(a=this._mapDraw||new qy(n,!0),o.add(a.group),a.draw(t,e,n,this,i),this._mapDraw=a):(this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null),t.get("showLegendSymbol")&&e.getComponent("legend")&&this._renderSymbols(t,e,n)))},remove:function(){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null,this.group.removeAll()},dispose:function(){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null},_renderSymbols:function(x,t,e){var _=x.originalData,w=this.group;_.each(_.mapDimension("value"),function(t,e){var n,i,o,a,r,s,l,h,u,c,d,p,g,f,m,v,y;isNaN(t)||(n=_.getItemLayout(e))&&n.point&&(i=n.point,o=n.offset,a=new Wr({style:{fill:x.getData().getVisual("color")},shape:{cx:i[0]+9*o,cy:i[1],r:3},silent:!0,z2:8+(o?0:vs+1)}),o||(r=x.mainSeries.getData(),s=_.getName(e),l=r.indexOfName(s),u=(h=_.getItemModel(e)).getModel("label"),c=h.getModel("emphasis.label"),d=r.getItemGraphicEl(l),p=U(x.getFormattedLabel(l,"normal"),s),g=U(x.getFormattedLabel(l,"emphasis"),p),f=d[Ky],m=Math.random(),f||(f=d[Ky]={},v=z(Jy,!0),y=z(Jy,!1),d.on("mouseover",v).on("mouseout",y).on("emphasis",v).on("normal",y)),k(f,{recordVersion:d[$y]=m,circle:a,labelModel:u,hoverLabelModel:c,emphasisText:g,normalText:p}),Qy(f,!1)),w.add(a))})}}),fp({type:"geoRoam",event:"geoRoam",update:"updateTransform"},function(i,t){var o=i.componentType||"series";t.eachComponent({mainType:o,query:i},function(t){var e,n=t.coordinateSystem;"geo"===n.type&&(e=tx(n,i,t.get("scaleLimit")),t.setCenter&&t.setCenter(e.center),t.setZoom&&t.setZoom(e.zoom),"series"===o&&P(t.seriesGroup,function(t){t.setCenter(e.center),t.setZoom(e.zoom)}))})});var ex=bt;function nx(){pe.call(this)}function ix(t){this.name=t,this.zoomLimit,pe.call(this),this._roamTransformable=new nx,this._rawTransformable=new nx,this._center,this._zoom}function ox(t,e,n,i){var o=n.seriesModel,a=o?o.coordinateSystem:null;return a===this?a[t](i):null}function ax(t,e,n,i){ix.call(this,t),this.map=e;var o=Dy.load(e,n);this._nameCoordMap=o.nameCoordMap,this._regionsMap=o.regionsMap,this._invertLongitute=null==i||i,this.regions=o.regions,this._rect=o.boundingRect}function rx(t,e,n,i){var o=n.geoModel,a=n.seriesModel,r=o?o.coordinateSystem:a?a.coordinateSystem||(a.getReferringComponents("geo")[0]||{}).coordinateSystem:null;return r===this?r[t](i):null}function sx(t,e){var n,i,o=t.get("boundingCoords");null!=o&&(n=o[0],i=o[1],isNaN(n[0])||isNaN(n[1])||isNaN(i[0])||isNaN(i[1])?D&&console.error("Invalid boundingCoords"):this.setBoundingRect(n[0],n[1],i[0]-n[0],i[1]-n[1]));var a,r,s=this.getBoundingRect(),l=t.get("layoutCenter"),h=t.get("layoutSize"),u=e.getWidth(),c=e.getHeight(),d=s.width/s.height*this.aspectScale,p=!1;l&&h&&(l=[Ll(l[0],u),Ll(l[1],c)],h=Ll(h,Math.min(u,c)),isNaN(l[0])||isNaN(l[1])||isNaN(h)?D&&console.warn("Given layoutCenter or layoutSize data are invalid. Use left/top/width/height instead."):p=!0),p?(r={},1<d?(r.width=h,r.height=h/d):(r.height=h,r.width=h*d),r.y=l[1]-r.height/2,r.x=l[0]-r.width/2):((a=t.getBoxLayoutParams()).aspect=d,r=fh(a,{width:u,height:c})),this.setViewRect(r.x,r.y,r.width,r.height),this.setCenter(t.get("center")),this.setZoom(t.get("zoom"))}function lx(n,t){P(t.get("geoCoord"),function(t,e){n.addGeoCoord(e,t)})}b(nx,pe),ix.prototype={constructor:ix,type:"view",dimensions:["x","y"],setBoundingRect:function(t,e,n,i){return this._rect=new Sn(t,e,n,i),this._rect},getBoundingRect:function(){return this._rect},setViewRect:function(t,e,n,i){this.transformTo(t,e,n,i),this._viewRect=new Sn(t,e,n,i)},transformTo:function(t,e,n,i){var o=this.getBoundingRect(),a=this._rawTransformable;a.transform=o.calculateTransform(new Sn(t,e,n,i)),a.decomposeTransform(),this._updateTransform()},setCenter:function(t){t&&(this._center=t,this._updateCenterAndZoom())},setZoom:function(t){t=t||1;var e=this.zoomLimit;e&&(null!=e.max&&(t=Math.min(e.max,t)),null!=e.min&&(t=Math.max(e.min,t))),this._zoom=t,this._updateCenterAndZoom()},getDefaultCenter:function(){var t=this.getBoundingRect();return[t.x+t.width/2,t.y+t.height/2]},getCenter:function(){return this._center||this.getDefaultCenter()},getZoom:function(){return this._zoom||1},getRoamTransform:function(){return this._roamTransformable.getLocalTransform()},_updateCenterAndZoom:function(){var t=this._rawTransformable.getLocalTransform(),e=this._roamTransformable,n=this.getDefaultCenter(),i=this.getCenter(),o=this.getZoom(),i=bt([],i,t),n=bt([],n,t);e.origin=i,e.position=[n[0]-i[0],n[1]-i[1]],e.scale=[o,o],this._updateTransform()},_updateTransform:function(){var t=this._roamTransformable,e=this._rawTransformable;(e.parent=t).updateTransform(),e.updateTransform(),ie(this.transform||(this.transform=[]),e.transform||ee()),this._rawTransform=e.getLocalTransform(),this.invTransform=this.invTransform||[],le(this.invTransform,this.transform),this.decomposeTransform()},getViewRect:function(){return this._viewRect},getViewRectAfterRoam:function(){var t=this.getBoundingRect().clone();return t.applyTransform(this.transform),t},dataToPoint:function(t,e,n){var i=e?this._rawTransform:this.transform;return n=n||[],i?ex(n,t,i):st(n,t)},pointToData:function(t){var e=this.invTransform;return e?ex([],t,e):[t[0],t[1]]},convertToPixel:z(ox,"dataToPoint"),convertFromPixel:z(ox,"pointToData"),containPoint:function(t){return this.getViewRectAfterRoam().contain(t[0],t[1])}},b(ix,pe),ax.prototype={constructor:ax,type:"geo",dimensions:["lng","lat"],containCoord:function(t){for(var e=this.regions,n=0;n<e.length;n++)if(e[n].contain(t))return!0;return!1},transformTo:function(t,e,n,i){var o=this.getBoundingRect(),a=this._invertLongitute,o=o.clone();a&&(o.y=-o.y-o.height);var r,s=this._rawTransformable;s.transform=o.calculateTransform(new Sn(t,e,n,i)),s.decomposeTransform(),a&&((r=s.scale)[1]=-r[1]),s.updateTransform(),this._updateTransform()},getRegion:function(t){return this._regionsMap.get(t)},getRegionByCoord:function(t){for(var e=this.regions,n=0;n<e.length;n++)if(e[n].contain(t))return e[n]},addGeoCoord:function(t,e){this._nameCoordMap.set(t,e)},getGeoCoord:function(t){return this._nameCoordMap.get(t)},getBoundingRect:function(){return this._rect},dataToPoint:function(t,e,n){if("string"==typeof t&&(t=this.getGeoCoord(t)),t)return ix.prototype.dataToPoint.call(this,t,e,n)},convertToPixel:z(rx,"dataToPoint"),convertFromPixel:z(rx,"pointToData")},b(ax,ix);var hx={dimensions:ax.prototype.dimensions,create:function(t,s){var l=[];t.eachComponent("geo",function(t,e){var n=t.get("map"),i=t.get("aspectScale"),o=!0,a=vd.retrieveMap(n);a&&a[0]&&"svg"===a[0].type?(null==i&&(i=1),o=!1):null==i&&(i=.75);var r=new ax(n+e,n,t.get("nameMap"),o);r.aspectScale=i,r.zoomLimit=t.get("scaleLimit"),l.push(r),lx(r,t),(t.coordinateSystem=r).model=t,r.resize=sx,r.resize(t,s)}),t.eachSeries(function(t){var e;"geo"===t.get("coordinateSystem")&&(e=t.get("geoIndex")||0,t.coordinateSystem=l[e])});var n={};return t.eachSeriesByType("map",function(t){var e;t.getHostGeoModel()||(e=t.getMapType(),n[e]=n[e]||[],n[e].push(t))}),P(n,function(t,e){var n=new ax(e,e,f(N(t,function(t){return t.get("nameMap")})));n.zoomLimit=Z.apply(null,N(t,function(t){return t.get("scaleLimit")})),l.push(n),n.resize=sx,n.aspectScale=t[0].get("aspectScale"),n.resize(t[0],s),P(t,function(t){lx(t.coordinateSystem=n,t)})}),l},getFilledRegions:function(t,e,n){for(var i=(t||[]).slice(),o=et(),a=0;a<i.length;a++)o.set(i[a].name,i[a]);return P(Dy.load(e,n).regions,function(t){var e=t.name;o.get(e)||i.push({name:e})}),i}};mp("geo",hx);vp(function(n){var o={};n.eachSeriesByType("map",function(t){var l,i,e=t.getMapType();t.getHostGeoModel()||o[e]||(l={},P(t.seriesGroup,function(t){var r=t.coordinateSystem,s=t.originalData;t.get("showLegendSymbol")&&n.getComponent("legend")&&s.each(s.mapDimension("value"),function(t,e){var n,i,o=s.getName(e),a=r.getRegion(o);a&&!isNaN(t)&&(n=l[o]||0,i=r.dataToPoint(a.center),l[o]=n+1,s.setItemLayout(e,{point:i,offset:n}))})}),(i=t.getData()).each(function(t){var e=i.getName(t),n=i.getItemLayout(t)||{};n.showLabel=!l[e],i.setItemLayout(t,n)}),o[e]=!0)})}),yp(function(t){t.eachSeriesByType("map",function(t){var e=t.get("color"),n=t.getModel("itemStyle"),i=n.get("areaColor"),o=n.get("color")||e[t.seriesIndex%e.length];t.getData().setVisual({areaColor:i,color:o})})}),gp(Id.PROCESSOR.STATISTIC,function(t){var i={};t.eachSeriesByType("map",function(t){var e=t.getHostGeoModel(),n=e?"o"+e.id:"i"+t.getMapType();(i[n]=i[n]||[]).push(t)}),P(i,function(t,e){for(var h,u,c,n=(h=N(t,function(t){return t.getData()}),u=t[0].get("mapValueCalculation"),c={},P(h,function(i){i.each(i.mapDimension("value"),function(t,e){var n="ec-"+i.getName(e);c[n]=c[n]||[],isNaN(t)||c[n].push(t)})}),h[0].map(h[0].mapDimension("value"),function(t,e){for(var n,i="ec-"+h[0].getName(e),o=0,a=1/0,r=-1/0,s=c[i].length,l=0;l<s;l++)a=Math.min(a,c[i][l]),r=Math.max(r,c[i][l]),o+=c[i][l];return n="min"===u?a:"max"===u?r:"average"===u?o/s:o,0===s?NaN:n})),i=0;i<t.length;i++)t[i].originalData=t[i].getData();for(i=0;i<t.length;i++)(t[i].seriesGroup=t)[i].needsDrawMap=0===i&&!t[i].getHostGeoModel(),t[i].setData(n.cloneShallow()),t[i].mainSeries=t[0]})}),pp(function(t){var e=[];P(t.series,function(t){t&&"map"===t.type&&(e.push(t),t.map=t.map||t.mapType,L(t,t.mapLocation))})}),Kv("map",[{type:"mapToggleSelect",event:"mapselectchanged",method:"toggleSelected"},{type:"mapSelect",event:"mapselected",method:"select"},{type:"mapUnSelect",event:"mapunselected",method:"unSelect"}]);var ux=P,cx="\0__link_datas",dx="\0__link_mainData";function px(n){var i=n.mainData,t=n.datas;t||(t={main:i},n.datasAttr={main:"data"}),n.datas=n.mainData=null,yx(i,t,n),ux(t,function(e){ux(i.TRANSFERABLE_METHODS,function(t){e.wrapMethod(t,z(gx,n))})}),i.wrapMethod("cloneShallow",z(mx,n)),ux(i.CHANGABLE_METHODS,function(t){i.wrapMethod(t,z(fx,n))}),q(t[i.dataType]===i)}function gx(t,e){var n,i;return(i=this)[dx]===i?yx((n=k({},this[cx]))[this.dataType]=e,n,t):xx(e,this.dataType,this[dx],t),e}function fx(t,e){return t.struct&&t.struct.update(this),e}function mx(n,i){return ux(i[cx],function(t,e){t!==i&&xx(t.cloneShallow(),e,i,n)}),i}function vx(t){var e=this[dx];return null==t||null==e?e:e[cx][t]}function yx(n,t,i){n[cx]={},ux(t,function(t,e){xx(t,e,n,i)})}function xx(t,e,n,i){(n[cx][e]=t)[dx]=n,t.dataType=e,i.struct&&(t[i.structAttr]=i.struct,i.struct[i.datasAttr[e]]=t),t.getLinkedData=vx}function _x(t,e){this.name=t||"",this.depth=0,this.height=0,this.parentNode=null,this.dataIndex=-1,this.children=[],this.viewChildren=[],this.hostTree=e}function bx(e,t,n){this.root,this.data,this._nodes=[],this.hostModel=e,this.levelModels=N(t||[],function(t){return new Sl(t,e,e.ecModel)}),this.leavesModel=new Sl(n||{},e,e.ecModel)}function Sx(t,e){var n=e.children;t.parentNode!==e&&(n.push(t),t.parentNode=e)}function Mx(t,e){var n,i=t.isExpand?t.children:[],o=t.parentNode.children,a=t.hierNode.i?o[t.hierNode.i-1]:null;i.length?(function(t){var e=t.children,n=e.length,i=0,o=0;for(;0<=--n;){var a=e[n];a.hierNode.prelim+=i,a.hierNode.modifier+=i,o+=a.hierNode.change,i+=a.hierNode.shift+o}}(t),n=(i[0].hierNode.prelim+i[i.length-1].hierNode.prelim)/2,a?(t.hierNode.prelim=a.hierNode.prelim+e(t,a),t.hierNode.modifier=t.hierNode.prelim-n):t.hierNode.prelim=n):a&&(t.hierNode.prelim=a.hierNode.prelim+e(t,a)),t.parentNode.hierNode.defaultAncestor=function(t,e,n,i){if(e){for(var o=t,a=t,r=a.parentNode.children[0],s=e,l=o.hierNode.modifier,h=a.hierNode.modifier,u=r.hierNode.modifier,c=s.hierNode.modifier;s=Dx(s),a=Cx(a),s&&a;){o=Dx(o),r=Cx(r),o.hierNode.ancestor=t;var d=s.hierNode.prelim+c-a.hierNode.prelim-h+i(s,a);0<d&&(Lx((g=t,f=n,(p=s).hierNode.ancestor.parentNode===g.parentNode?p.hierNode.ancestor:f),t,d),h+=d,l+=d),c+=s.hierNode.modifier,h+=a.hierNode.modifier,l+=o.hierNode.modifier,u+=r.hierNode.modifier}s&&!Dx(o)&&(o.hierNode.thread=s,o.hierNode.modifier+=c-l),a&&!Cx(r)&&(r.hierNode.thread=a,r.hierNode.modifier+=h-u,n=t)}var p,g,f;return n}(t,a,t.parentNode.hierNode.defaultAncestor||o[0],e)}function Ix(t){var e=t.hierNode.prelim+t.parentNode.hierNode.modifier;t.setLayout({x:e},!0),t.hierNode.modifier+=t.parentNode.hierNode.modifier}function Tx(t){return arguments.length?t:kx}function Ax(t,e){var n={};return t-=Math.PI/2,n.x=e*Math.cos(t),n.y=e*Math.sin(t),n}function Dx(t){var e=t.children;return e.length&&t.isExpand?e[e.length-1]:t.hierNode.thread}function Cx(t){var e=t.children;return e.length&&t.isExpand?e[0]:t.hierNode.thread}function Lx(t,e,n){var i=n/(e.hierNode.i-t.hierNode.i);e.hierNode.change-=i,e.hierNode.shift+=n,e.hierNode.modifier+=n,e.hierNode.prelim+=n,t.hierNode.change+=i}function kx(t,e){return t.parentNode===e.parentNode?1:2}function Px(t,e){var n=t.getItemLayout(e);return n&&!isNaN(n.x)&&!isNaN(n.y)&&"none"!==t.getItemVisual(e,"symbol")}function Nx(t,e,n){return n.itemModel=e,n.itemStyle=e.getModel("itemStyle").getItemStyle(),n.hoverItemStyle=e.getModel("emphasis.itemStyle").getItemStyle(),n.lineStyle=e.getModel("lineStyle").getLineStyle(),n.labelModel=e.getModel("label"),n.hoverLabelModel=e.getModel("emphasis.label"),!1===t.isExpand&&0!==t.children.length?n.symbolInnerColor=n.itemStyle.fill:n.symbolInnerColor="#fff",n}function Ox(t,e,n,i,o,a){var r=!n,s=t.tree.getNodeByDataIndex(e),l=s.getModel(),a=Nx(s,l,a),h=t.tree.root,u=s.parentNode!==h&&s.parentNode||s,c=t.getItemGraphicEl(u.dataIndex),d=u.getLayout(),p=c?{x:c.position[0],y:c.position[1],rawX:c.__radialOldRawX,rawY:c.__radialOldRawY}:d,g=s.getLayout();r?(n=new Zf(t,e,a)).attr("position",[p.x,p.y]):n.updateData(t,e,a),n.__radialOldRawX=n.__radialRawX,n.__radialOldRawY=n.__radialRawY,n.__radialRawX=g.rawX,n.__radialRawY=g.rawY,i.add(n),t.setItemGraphicEl(e,n),rl(n,{position:[g.x,g.y]},o);var f,m,v,y,x,_,w,b,S,M,I=n.getSymbolPath();"radial"===a.layout&&(m=(f=h.children[0]).getLayout(),v=f.children.length,g.x===m.x&&!0===s.isExpand?((_={}).x=(f.children[0].getLayout().x+f.children[v-1].getLayout().x)/2,_.y=(f.children[0].getLayout().y+f.children[v-1].getLayout().y)/2,(y=Math.atan2(_.y-m.y,_.x-m.x))<0&&(y=2*Math.PI+y),(x=_.x<m.x)&&(y-=Math.PI)):((y=Math.atan2(g.y-m.y,g.x-m.x))<0&&(y=2*Math.PI+y),0===s.children.length||0!==s.children.length&&!1===s.isExpand?(x=g.x<m.x)&&(y-=Math.PI):(x=g.x>m.x)||(y-=Math.PI)),w=x?"left":"right",S=(b=a.labelModel.get("rotate"))*(Math.PI/180),I.setStyle({textPosition:a.labelModel.get("position")||w,textRotation:null==b?-y:S,textOrigin:"center",verticalAlign:"middle"})),s.parentNode&&s.parentNode!==h&&(rl(M=(M=n.__edge)||(n.__edge=new ss({shape:zx(a,p,p),style:L({opacity:0,strokeNoScale:!0},a.lineStyle)})),{shape:zx(a,d,g),style:{opacity:1}},o),i.add(M))}function Ex(t,e,n,i,o,a){for(var r,s=t.tree.getNodeByDataIndex(e),l=t.tree.root,h=s.getModel(),a=Nx(s,h,a),u=s.parentNode!==l&&s.parentNode||s;null==(r=u.getLayout());)u=u.parentNode!==l&&u.parentNode||u;rl(n,{position:[r.x+1,r.y+1]},o,function(){i.remove(n),t.setItemGraphicEl(e,null)}),n.fadeOut(null,{keepLabel:!0});var c=n.__edge;c&&rl(c,{shape:zx(a,r,r),style:{opacity:0}},o,function(){i.remove(c)})}function zx(t,e,n){var i,o,a,r,s,l,h,u,c=t.orient;if("radial"!==t.layout)return s=e.x,h=e.y,l=n.x,u=n.y,"LR"!==c&&"RL"!==c||(i=s+(l-s)*t.curvature,o=h,a=l+(s-l)*t.curvature,r=u),"TB"!==c&&"BT"!==c||(i=s,o=h+(u-h)*t.curvature,a=l,r=u+(h-u)*t.curvature),{x1:s,y1:h,x2:l,y2:u,cpx1:i,cpy1:o,cpx2:a,cpy2:r};s=e.rawX,h=e.rawY,l=n.rawX,u=n.rawY;var d=Ax(s,h),p=Ax(s,h+(u-h)*t.curvature),g=Ax(l,u+(h-u)*t.curvature),f=Ax(l,u);return{x1:d.x,y1:d.y,x2:f.x,y2:f.y,cpx1:p.x,cpy1:p.y,cpx2:g.x,cpy2:g.y}}function Rx(t,e){for(var n,i=[t];n=i.pop();)if(e(n),n.isExpand){var o=n.children;if(o.length)for(var a=o.length-1;0<=a;a--)i.push(o[a])}}_x.prototype={constructor:_x,isRemoved:function(){return this.dataIndex<0},eachNode:function(t,e,n){"function"==typeof t&&(n=e,e=t,t=null),B(t=t||{})&&(t={order:t});var i,o=t.order||"preorder",a=this[t.attr||"children"];"preorder"===o&&(i=e.call(n,this));for(var r=0;!i&&r<a.length;r++)a[r].eachNode(t,e,n);"postorder"===o&&e.call(n,this)},updateDepthAndHeight:function(t){var e=0;this.depth=t;for(var n=0;n<this.children.length;n++){var i=this.children[n];i.updateDepthAndHeight(t+1),i.height>e&&(e=i.height)}this.height=e+1},getNodeById:function(t){if(this.getId()===t)return this;for(var e=0,n=this.children,i=n.length;e<i;e++){var o=n[e].getNodeById(t);if(o)return o}},contains:function(t){if(t===this)return!0;for(var e=0,n=this.children,i=n.length;e<i;e++){var o=n[e].contains(t);if(o)return o}},getAncestors:function(t){for(var e=[],n=t?this:this.parentNode;n;)e.push(n),n=n.parentNode;return e.reverse(),e},getValue:function(t){var e=this.hostTree.data;return e.get(e.getDimension(t||"value"),this.dataIndex)},setLayout:function(t,e){0<=this.dataIndex&&this.hostTree.data.setItemLayout(this.dataIndex,t,e)},getLayout:function(){return this.hostTree.data.getItemLayout(this.dataIndex)},getModel:function(t){if(!(this.dataIndex<0)){var e,n=this.hostTree,i=n.data.getItemModel(this.dataIndex),o=this.getLevelModel();return o||0!==this.children.length&&(0===this.children.length||!1!==this.isExpand)||(e=this.getLeavesModel()),i.getModel(t,(o||e||n.hostModel).getModel(t))}},getLevelModel:function(){return(this.hostTree.levelModels||[])[this.depth]},getLeavesModel:function(){return this.hostTree.leavesModel},setVisual:function(t,e){0<=this.dataIndex&&this.hostTree.data.setItemVisual(this.dataIndex,t,e)},getVisual:function(t,e){return this.hostTree.data.getItemVisual(this.dataIndex,t,e)},getRawIndex:function(){return this.hostTree.data.getRawIndex(this.dataIndex)},getId:function(){return this.hostTree.data.getId(this.dataIndex)},isAncestorOf:function(t){for(var e=t.parentNode;e;){if(e===this)return!0;e=e.parentNode}return!1},isDescendantOf:function(t){return t!==this&&t.isAncestorOf(this)}},bx.prototype={constructor:bx,type:"tree",eachNode:function(t,e,n){this.root.eachNode(t,e,n)},getNodeByDataIndex:function(t){var e=this.data.getRawIndex(t);return this._nodes[e]},getNodeByName:function(t){return this.root.getNodeByName(t)},update:function(){for(var t=this.data,e=this._nodes,n=0,i=e.length;n<i;n++)e[n].dataIndex=-1;for(n=0,i=t.count();n<i;n++)e[t.getRawIndex(n)].dataIndex=n},clearLayouts:function(){this.data.clearItemLayouts()}},bx.createTree=function(t,e,n,i){var s=new bx(e,n.levels,n.leaves),l=[],h=1;!function t(e,n){var i=e.value;h=Math.max(h,R(i)?i.length:1);l.push(e);var o=new _x(e.name,s);n?Sx(o,n):s.root=o;s._nodes.push(o);var a=e.children;if(a)for(var r=0;r<a.length;r++)t(a[r],o)}(t),s.root.updateDepthAndHeight(0);var o=ag(l,{coordDimensions:["value"],dimensionsCount:h}),a=new Hp(o,e);return a.initData(l),px({mainData:a,struct:s,structAttr:"tree"}),s.update(),i&&i(a),s},ec.extend({type:"series.tree",layoutInfo:null,layoutMode:"box",getInitialData:function(t){var e={name:t.name,children:t.data},n=t.leaves||{},i={};i.leaves=n;var o=bx.createTree(e,this,i,function(t){t.wrapMethod("getItemModel",function(t,e){var n=o.getNodeByDataIndex(e),i=n.getLeavesModel();return n.children.length&&n.isExpand||(t.parentModel=i),t})});var a=0;o.eachNode("preorder",function(t){t.depth>a&&(a=t.depth)});var r=t.expandAndCollapse&&0<=t.initialTreeDepth?t.initialTreeDepth:a;return o.root.eachNode("preorder",function(t){var e=t.hostTree.data.getRawDataItem(t.dataIndex);t.isExpand=e&&null!=e.collapsed?!e.collapsed:t.depth<=r}),o.data},getOrient:function(){var t=this.get("orient");return"horizontal"===t?t="LR":"vertical"===t&&(t="TB"),t},setZoom:function(t){this.option.zoom=t},setCenter:function(t){this.option.center=t},formatTooltip:function(t){for(var e=this.getData().tree,n=e.root.children[0],i=e.getNodeByDataIndex(t),o=i.getValue(),a=i.name;i&&i!==n;)a=i.parentNode.name+"."+a,i=i.parentNode;return Ql(a+(isNaN(o)||null==o?"":" : "+o))},defaultOption:{zlevel:0,z:2,coordinateSystem:"view",left:"12%",top:"12%",right:"12%",bottom:"12%",layout:"orthogonal",roam:!1,nodeScaleRatio:.4,center:null,zoom:1,orient:"LR",symbol:"emptyCircle",symbolSize:7,expandAndCollapse:!0,initialTreeDepth:2,lineStyle:{color:"#ccc",width:1.5,curveness:.5},itemStyle:{color:"lightsteelblue",borderColor:"#c23531",borderWidth:1.5},label:{show:!0,color:"#555"},leaves:{label:{show:!0}},animationEasing:"linear",animationDuration:700,animationDurationUpdate:1e3}}),Mp({type:"tree",init:function(t,e){this._oldTree,this._mainGroup=new Mn,this._controller=new Oy(e.getZr()),this._controllerHost={target:this.group},this.group.add(this._mainGroup)},render:function(i,t,n,e){var o=i.getData(),a=i.layoutInfo,r=this._mainGroup,s=i.get("layout");"radial"===s?r.attr("position",[a.x+a.width/2,a.y+a.height/2]):r.attr("position",[a.x,a.y]),this._updateViewCoordSys(i,a,s),this._updateController(i,t,n);var l=this._data,h={expandAndCollapse:i.get("expandAndCollapse"),layout:s,orient:i.getOrient(),curvature:i.get("lineStyle.curveness"),symbolRotate:i.get("symbolRotate"),symbolOffset:i.get("symbolOffset"),hoverAnimation:i.get("hoverAnimation"),useNameLabel:!0,fadeIn:!0};o.diff(l).add(function(t){Px(o,t)&&Ox(o,t,null,r,i,h)}).update(function(t,e){var n=l.getItemGraphicEl(e);Px(o,t)?Ox(o,t,n,r,i,h):n&&Ex(l,e,n,r,i,h)}).remove(function(t){var e=l.getItemGraphicEl(t);e&&Ex(l,t,e,r,i,h)}).execute(),this._nodeScaleRatio=i.get("nodeScaleRatio"),this._updateNodeAndLinkScale(i),!0===h.expandAndCollapse&&o.eachItemGraphicEl(function(t,e){t.off("click").on("click",function(){n.dispatchAction({type:"treeExpandAndCollapse",seriesId:i.id,dataIndex:e})})}),this._data=o},_updateViewCoordSys:function(t){var n=t.getData(),i=[];n.each(function(t){var e=n.getItemLayout(t);!e||isNaN(e.x)||isNaN(e.y)||i.push([+e.x,+e.y])});var e=[],o=[];Ra(i,e,o);var a=this._min,r=this._max;o[0]-e[0]==0&&(e[0]=a?a[0]:e[0]-1,o[0]=r?r[0]:o[0]+1),o[1]-e[1]==0&&(e[1]=a?a[1]:e[1]-1,o[1]=r?r[1]:o[1]+1);var s=t.coordinateSystem=new ix;s.zoomLimit=t.get("scaleLimit"),s.setBoundingRect(e[0],e[1],o[0]-e[0],o[1]-e[1]),s.setCenter(t.get("center")),s.setZoom(t.get("zoom")),this.group.attr({position:s.position,scale:s.scale}),this._viewCoordSys=s,this._min=e,this._max=o},_updateController:function(o,t,a){var e=this._controller,n=this._controllerHost,r=this.group;e.setPointerChecker(function(t,e,n){var i=r.getBoundingRect();return i.applyTransform(r.transform),i.contain(e,n)&&!Xy(t,a,o)}),e.enable(o.get("roam")),n.zoomLimit=o.get("scaleLimit"),n.zoom=o.coordinateSystem.getZoom(),e.off("pan").off("zoom").on("pan",function(t){Hy(n,t.dx,t.dy),a.dispatchAction({seriesId:o.id,type:"treeRoam",dx:t.dx,dy:t.dy})},this).on("zoom",function(t){Zy(n,t.scale,t.originX,t.originY),a.dispatchAction({seriesId:o.id,type:"treeRoam",zoom:t.scale,originX:t.originX,originY:t.originY}),this._updateNodeAndLinkScale(o)},this)},_updateNodeAndLinkScale:function(t){var e=t.getData(),n=this._getNodeGlobalScale(t),i=[n,n];e.eachItemGraphicEl(function(t,e){t.attr("scale",i)})},_getNodeGlobalScale:function(t){var e=t.coordinateSystem;if("view"!==e.type)return 1;var n=this._nodeScaleRatio,i=e.scale,o=i&&i[0]||1;return((e.getZoom()-1)*n+1)/o},dispose:function(){this._controller&&this._controller.dispose(),this._controllerHost={}},remove:function(){this._mainGroup.removeAll(),this._data=null}}),fp({type:"treeExpandAndCollapse",event:"treeExpandAndCollapse",update:"update"},function(i,t){t.eachComponent({mainType:"series",subType:"tree",query:i},function(t){var e=i.dataIndex,n=t.getData().tree.getNodeByDataIndex(e);n.isExpand=!n.isExpand})}),fp({type:"treeRoam",event:"treeRoam",update:"none"},function(n,t){t.eachComponent({mainType:"series",subType:"tree",query:n},function(t){var e=tx(t.coordinateSystem,n);t.setCenter&&t.setCenter(e.center),t.setZoom&&t.setZoom(e.zoom)})});function Bx(t,e,n){if(t&&0<=M(e,t.type)){var i=n.getData().tree.root,o=t.targetNode;if("string"==typeof o&&(o=i.getNodeById(o)),o&&i.contains(o))return{node:o};var a=t.targetNodeId;if(null!=a&&(o=i.getNodeById(a)))return{node:o}}}function Vx(t){for(var e=[];t;)(t=t.parentNode)&&e.push(t);return e.reverse()}function Gx(t,e){return 0<=M(Vx(t),e)}function Fx(t,e){for(var n=[];t;){var i=t.dataIndex;n.push({name:t.name,dataIndex:i,value:e.getRawValue(i)}),t=t.parentNode}return n.reverse(),n}yp(Dm("tree","circle")),vp(function(t,e){t.eachSeriesByType("tree",function(t){!function(t,e){var n=function(t,e){return fh(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()})}(t,e);t.layoutInfo=n;var i=t.get("layout"),o=0,a=0,r=null;r="radial"===i?(o=2*Math.PI,a=Math.min(n.height,n.width)/2,Tx(function(t,e){return(t.parentNode===e.parentNode?1:2)/t.depth})):(o=n.width,a=n.height,Tx());var s=t.getData().tree.root,l=s.children[0];{var h,u,c,d,p,g,f,m,v,y;l&&(function(t){t.hierNode={defaultAncestor:null,ancestor:t,prelim:0,modifier:0,change:0,shift:0,i:0,thread:null};for(var e,n,i=[t];e=i.pop();)if(n=e.children,e.isExpand&&n.length)for(var o=n.length-1;0<=o;o--){var a=n[o];a.hierNode={defaultAncestor:null,ancestor:a,prelim:0,modifier:0,change:0,shift:0,i:o,thread:null},i.push(a)}}(s),function(t,e,n){for(var i,o=[t],a=[];i=o.pop();)if(a.push(i),i.isExpand){var r=i.children;if(r.length)for(var s=0;s<r.length;s++)o.push(r[s])}for(;i=a.pop();)e(i,n)}(l,Mx,r),s.hierNode.modifier=-l.hierNode.prelim,Rx(l,Ix),Rx(c=u=h=l,function(t){var e=t.getLayout().x;e<h.getLayout().x&&(h=t),e>u.getLayout().x&&(u=t),t.depth>c.depth&&(c=t)}),d=h===u?1:r(h,u)/2,p=d-h.getLayout().x,v=m=f=g=0,"radial"===i?(g=o/(u.getLayout().x+d+p),f=a/(c.depth-1||1),Rx(l,function(t){m=(t.getLayout().x+p)*g,v=(t.depth-1)*f;var e=Ax(m,v);t.setLayout({x:e.x,y:e.y,rawX:m,rawY:v},!0)})):"RL"===(y=t.getOrient())||"LR"===y?(f=a/(u.getLayout().x+d+p),g=o/(c.depth-1||1),Rx(l,function(t){v=(t.getLayout().x+p)*f,m="LR"===y?(t.depth-1)*g:o-(t.depth-1)*g,t.setLayout({x:m,y:v},!0)})):"TB"!==y&&"BT"!==y||(g=o/(u.getLayout().x+d+p),f=a/(c.depth-1||1),Rx(l,function(t){m=(t.getLayout().x+p)*g,v="TB"===y?(t.depth-1)*f:a-(t.depth-1)*f,t.setLayout({x:m,y:v},!0)})))}}(t,e)})}),ec.extend({type:"series.treemap",layoutMode:"box",dependencies:["grid","polar"],preventUsingHoverLayer:!0,_viewRoot:null,defaultOption:{progressive:0,left:"center",top:"middle",right:null,bottom:null,width:"80%",height:"80%",sort:!0,clipWindow:"origin",squareRatio:.5*(1+Math.sqrt(5)),leafDepth:null,drillDownIcon:"▶",zoomToNodeRatio:.1024,roam:!0,nodeClick:"zoomToNode",animation:!0,animationDurationUpdate:900,animationEasing:"quinticInOut",breadcrumb:{show:!0,height:22,left:"center",top:"bottom",emptyItemWidth:25,itemStyle:{color:"rgba(0,0,0,0.7)",borderColor:"rgba(255,255,255,0.7)",borderWidth:1,shadowColor:"rgba(150,150,150,1)",shadowBlur:3,shadowOffsetX:0,shadowOffsetY:0,textStyle:{color:"#fff"}},emphasis:{textStyle:{}}},label:{show:!0,distance:0,padding:5,position:"inside",color:"#fff",ellipsis:!0},upperLabel:{show:!1,position:[0,"50%"],height:20,color:"#fff",ellipsis:!0,verticalAlign:"middle"},itemStyle:{color:null,colorAlpha:null,colorSaturation:null,borderWidth:0,gapWidth:0,borderColor:"#fff",borderColorSaturation:null},emphasis:{upperLabel:{show:!0,position:[0,"50%"],color:"#fff",ellipsis:!0,verticalAlign:"middle"}},visualDimension:0,visualMin:null,visualMax:null,color:[],colorAlpha:null,colorSaturation:null,colorMappingBy:"index",visibleMin:10,childrenVisibleMin:null,levels:[]},getInitialData:function(t,e){var n={name:t.name,children:t.data};!function n(t){var i=0;P(t.children,function(t){n(t);var e=t.value;R(e)&&(e=e[0]),i+=e});var e=t.value;R(e)&&(e=e[0]);null!=e&&!isNaN(e)||(e=i);e<0&&(e=0);R(t.value)?t.value[0]=e:t.value=e}(n);var i=t.levels||[],i=t.levels=function(t,e){var i,n=e.get("color");if(!n)return;{P(t=t||[],function(t){var e=new Sl(t),n=e.get("color");(e.get("itemStyle.color")||n&&"none"!==n)&&(i=!0)}),i||((t[0]||(t[0]={})).color=n.slice())}return t}(i,e),o={};return o.levels=i,bx.createTree(n,this,o).data},optionUpdated:function(){this.resetViewRoot()},formatTooltip:function(t){var e=this.getData(),n=this.getRawValue(t),i=R(n)?jl(n[0]):jl(n);return Ql(e.getName(t)+": "+i)},getDataParams:function(t){var e=ec.prototype.getDataParams.apply(this,arguments),n=this.getData().tree.getNodeByDataIndex(t);return e.treePathInfo=Fx(n,this),e},setLayoutInfo:function(t){this.layoutInfo=this.layoutInfo||{},k(this.layoutInfo,t)},mapIdToIndex:function(t){var e=this._idIndexMap;e||(e=this._idIndexMap=et(),this._idIndexMapCount=0);var n=e.get(t);return null==n&&e.set(t,n=this._idIndexMapCount++),n},getViewRoot:function(){return this._viewRoot},resetViewRoot:function(t){t?this._viewRoot=t:t=this._viewRoot;var e=this.getRawData().tree.root;t&&(t===e||e.contains(t))||(this._viewRoot=e)}});var Wx=5;function Hx(t){this.group=new Mn,t.add(this.group)}function Zx(t,e,n,i,o,a){var r=[[o?t:t-Wx,e],[t+n,e],[t+n,e+i],[o?t:t-Wx,e+i]];return a||r.splice(2,0,[t+n+Wx,e+i/2]),o||r.push([t,e+i/2]),r}Hx.prototype={constructor:Hx,render:function(t,e,n,i){var o,a,r,s=t.getModel("breadcrumb"),l=this.group;l.removeAll(),s.get("show")&&n&&(a=(o=s.getModel("itemStyle")).getModel("textStyle"),r={pos:{left:s.get("left"),right:s.get("right"),top:s.get("top"),bottom:s.get("bottom")},box:{width:e.getWidth(),height:e.getHeight()},emptyItemWidth:s.get("emptyItemWidth"),totalWidth:0,renderList:[]},this._prepare(n,r,a),this._renderContent(t,r,o,a,i),mh(l,r.pos,r.box))},_prepare:function(t,e,n){for(var i=t;i;i=i.parentNode){var o=i.getModel().get("name"),a=n.getTextRect(o),r=Math.max(a.width+16,e.emptyItemWidth);e.totalWidth+=r+8,e.renderList.push({node:i,text:o,width:r})}},_renderContent:function(t,e,n,i,o){for(var a,r,s,l,h,u,c,d,p,g,f,m=0,v=e.emptyItemWidth,y=t.get("breadcrumb.height"),x=(a=e.pos,r=e.box,l=r.width,h=r.height,u=Ll(a.x,l),c=Ll(a.y,h),d=Ll(a.x2,l),p=Ll(a.y2,h),(isNaN(u)||isNaN(parseFloat(a.x)))&&(u=0),(isNaN(d)||isNaN(parseFloat(a.x2)))&&(d=l),(isNaN(c)||isNaN(parseFloat(a.y)))&&(c=0),(isNaN(p)||isNaN(parseFloat(a.y2)))&&(p=h),s=Kl(s||0),{width:Math.max(d-u-s[1]-s[3],0),height:Math.max(p-c-s[0]-s[2],0)}),_=e.totalWidth,w=e.renderList,b=w.length-1;0<=b;b--){var S=w[b],M=S.node,I=S.width,T=S.text;x.width<_&&(_-=I-v,I=v,T=null);var A=new jr({shape:{points:Zx(m,0,I,y,b===w.length-1,0===b)},style:L(n.getItemStyle(),{lineJoin:"bevel",text:T,textFill:i.getTextColor(),textFont:i.getFont()}),z:10,onclick:z(o,M)});this.group.add(A),g=t,f=M,A.eventData={componentType:"series",componentSubType:"treemap",componentIndex:g.componentIndex,seriesIndex:g.componentIndex,seriesName:g.name,seriesType:"treemap",selfType:"breadcrumb",nodeData:{dataIndex:f&&f.dataIndex,name:f&&f.name},treePathInfo:f&&Fx(f,g)},m+=I+8}},remove:function(){this.group.removeAll()}};function Ux(t){var e=e_(t);return e.stroke=e.fill=e.lineWidth=null,e}var Xx=E,Yx=Mn,jx=es,qx=P,Kx=["label"],$x=["emphasis","label"],Jx=["upperLabel"],Qx=["emphasis","upperLabel"],t_=10,e_=aa([["fill","color"],["stroke","strokeColor"],["lineWidth","strokeWidth"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"]]);function n_(){return{nodeGroup:[],background:[],content:[]}}function i_(d,h,u,c,p,n,g,t,e,i){if(g){var f=g.getLayout();if(f&&f.isInView){var s=f.width,l=f.height,m=f.borderWidth,v=f.invisible,y=g.getRawIndex(),x=t&&t.getRawIndex(),o=g.viewChildren,_=f.upperHeight,a=o&&o.length,w=g.getModel("itemStyle"),b=g.getModel("emphasis.itemStyle"),r=A("nodeGroup",Yx);if(r){if(e.add(r),r.attr("position",[f.x||0,f.y||0]),r.__tmNodeWidth=s,r.__tmNodeHeight=l,f.isAboveViewRoot)return r;var S,M=A("background",jx,i,1);return M&&function(t,i,o){i.dataIndex=g.dataIndex,i.seriesIndex=d.seriesIndex,i.setShape({x:0,y:0,width:s,height:l});var a=g.getVisual("borderColor",!0),r=b.get("borderColor");I(i,function(){var t=Ux(w);t.fill=a;var e,n=e_(b);n.fill=r,o?T(t,n,a,e=s-2*m,_,{x:m,y:0,width:e,height:_}):t.text=n.text=null,i.setStyle(t),Xs(i,n)}),t.add(i)}(r,M,a&&f.upperHeight),a||(S=A("content",jx,i,2))&&function(t,n){n.dataIndex=g.dataIndex,n.seriesIndex=d.seriesIndex;var i=Math.max(s-2*m,0),o=Math.max(l-2*m,0);n.culling=!0,n.setShape({x:m,y:m,width:i,height:o});var a=g.getVisual("color",!0);I(n,function(){var t=Ux(w);t.fill=a;var e=e_(b);T(t,e,a,i,o),n.setStyle(t),Xs(n,e)}),t.add(n)}(r,S),r}}}function I(t,e){v?t.invisible||n.push(t):(e(),t.__tmWillVisible||(t.invisible=!1))}function T(t,e,n,i,o,a){var r,s=g.getModel(),l=Z(d.getFormattedLabel(g.dataIndex,"normal",null,null,a?"upperLabel":"label"),s.get("name"));!a&&f.isLeafRoot&&(l=(r=d.get("drillDownIcon",!0))?r+" "+l:l);var h=s.getModel(a?Jx:Kx),u=s.getModel(a?Qx:$x),c=h.getShallow("show");Ks(t,e,h,u,{defaultText:c?l:null,autoColor:n,isRectText:!0}),a&&(t.textRect=C(a)),t.truncate=c&&h.get("ellipsis")?{outerWidth:i,outerHeight:o,minChar:2}:null}function A(t,e,n,i){var o,a,r,s=null!=x&&u[t][x],l=p[t];return s?(u[t][x]=null,a=s,r=t,(l[y]={}).old="nodeGroup"===r?a.position.slice():k({},a.shape)):v||((s=new e({z:((o=n*t_+i)-1)/o})).__tmDepth=n,function(t,e){var n=t[y]={},i=g.parentNode;{var o,a,r;!i||c&&"drillDown"!==c.direction||(a=o=0,r=p.background[i.getRawIndex()],!c&&r&&r.old&&(o=r.old.width,a=r.old.height),n.old="nodeGroup"===e?[0,a]:{x:o,y:a,width:0,height:0})}n.fadein="nodeGroup"!==e}(l,s.__tmStorageName=t)),h[t][y]=s}}Mp({type:"treemap",init:function(t,e){this._containerGroup,this._storage=n_(),this._oldTree,this._breadcrumb,this._controller,this._state="ready"},render:function(t,e,n,i){var o,a,r,s,l,h,u,c;M(e.findComponents({mainType:"series",subType:"treemap",query:i}),t)<0||(this.seriesModel=t,this.api=n,this.ecModel=e,o=Bx(i,["treemapZoomToNode","treemapRootToNode"],t),a=i&&i.type,r=t.layoutInfo,s=!this._oldTree,l=this._storage,h="treemapRootToNode"===a&&o&&l?{rootNodeGroup:l.nodeGroup[o.node.getRawIndex()],direction:i.direction}:null,u=this._giveContainerGroup(r),c=this._doRender(u,t,h),s||a&&"treemapZoomToNode"!==a&&"treemapRootToNode"!==a?c.renderFinally():this._doAnimation(u,c,t,h),this._resetController(n),this._renderBreadcrumb(t,n,o))},_giveContainerGroup:function(t){var e=this._containerGroup;return e||(e=this._containerGroup=new Yx,this._initEvents(e),this.group.add(e)),e.attr("position",[t.x,t.y]),e},_doRender:function(t,e,n){var i=e.getData().tree,o=this._oldTree,a=n_(),r=n_(),s=this._storage,l=[],c=z(i_,e,r,s,n,a,l);!function a(r,s,l,h,u){h?qx(s=r,function(t,e){t.isRemoved()||n(e,e)}):new Tp(s,r,t,t).add(n).update(n).remove(z(n,null)).execute();function t(t){return t.getId()}function n(t,e){var n=null!=t?r[t]:null,i=null!=e?s[e]:null,o=c(n,i,l,u);o&&a(n&&n.viewChildren||[],i&&i.viewChildren||[],o,h,u+1)}}(i.root?[i.root]:[],o&&o.root?[o.root]:[],t,i===o||!o,0);var h,u,d=(u=n_(),(h=s)&&qx(h,function(t,e){var n=u[e];qx(t,function(t){t&&(n.push(t),t.__tmWillDelete=1)})}),u);return this._oldTree=i,this._storage=r,{lastsForAnimation:a,willDeleteEls:d,renderFinally:function(){qx(d,function(t){qx(t,function(t){t.parent&&t.parent.remove(t)})}),qx(l,function(t){t.invisible=!0,t.dirty()})}}},_doAnimation:function(t,a,e,s){var l,h,u,r,c,d;e.get("animation")&&(l=e.get("animationDurationUpdate"),h=e.get("animationEasing"),c=[],d={},u={add:function(t,e,n,i,o){return B(i)&&(o=i,i=0),!d[t.id]&&(d[t.id]=1,c.push({el:t,target:e,time:n,delay:i,easing:o}),!0)},done:function(t){return r=t,this},start:function(){for(var t=c.length,e=0,n=c.length;e<n;e++){var i=c[e];i.el.animateTo(i.target,i.time,i.delay,i.easing,o)}return this;function o(){--t||(c.length=0,d={},r&&r())}}},qx(a.willDeleteEls,function(t,r){qx(t,function(t,e){var n,i,o,a;t.invisible||(n=t.parent,(a=s&&"drillDown"===s.direction?n===s.rootNodeGroup?{shape:{x:0,y:0,width:n.__tmNodeWidth,height:n.__tmNodeHeight},style:{opacity:0}}:{style:{opacity:0}}:(o=i=0,n.__tmWillDelete||(i=n.__tmNodeWidth/2,o=n.__tmNodeHeight/2),"nodeGroup"===r?{position:[i,o],style:{opacity:0}}:{shape:{x:i,y:o,width:0,height:0},style:{opacity:0}}))&&u.add(t,a,l,h))})}),qx(this._storage,function(t,o){qx(t,function(t,e){var n=a.lastsForAnimation[o][e],i={};n&&("nodeGroup"===o?n.old&&(i.position=t.position.slice(),t.attr("position",n.old)):(n.old&&(i.shape=k({},t.shape),t.setShape(n.old)),n.fadein?(t.setStyle("opacity",0),i.style={opacity:1}):1!==t.style.opacity&&(i.style={opacity:1})),u.add(t,i,l,h))})},this),this._state="animating",u.done(Xx(function(){this._state="ready",a.renderFinally()},this)).start())},_resetController:function(t){var e=this._controller;e||((e=this._controller=new Oy(t.getZr())).enable(this.seriesModel.get("roam")),e.on("pan",Xx(this._onPan,this)),e.on("zoom",Xx(this._onZoom,this)));var i=new Sn(0,0,t.getWidth(),t.getHeight());e.setPointerChecker(function(t,e,n){return i.contain(e,n)})},_clearController:function(){var t=this._controller;t&&(t.dispose(),t=null)},_onPan:function(t){if("animating"!==this._state&&(3<Math.abs(t.dx)||3<Math.abs(t.dy))){var e=this.seriesModel.getData().tree.root;if(!e)return;var n=e.getLayout();if(!n)return;this.api.dispatchAction({type:"treemapMove",from:this.uid,seriesId:this.seriesModel.id,rootRect:{x:n.x+t.dx,y:n.y+t.dy,width:n.width,height:n.height}})}},_onZoom:function(t){var e=t.originX,n=t.originY;if("animating"!==this._state){var i=this.seriesModel.getData().tree.root;if(!i)return;var o=i.getLayout();if(!o)return;var a=new Sn(o.x,o.y,o.width,o.height),r=this.seriesModel.layoutInfo;e-=r.x,n-=r.y;var s=ee();ae(s,s,[-e,-n]),se(s,s,[t.scale,t.scale]),ae(s,s,[e,n]),a.applyTransform(s),this.api.dispatchAction({type:"treemapRender",from:this.uid,seriesId:this.seriesModel.id,rootRect:{x:a.x,y:a.y,width:a.width,height:a.height}})}},_initEvents:function(t){t.on("click",function(t){var e,n,i,o,a,r;"ready"===this._state&&(!(e=this.seriesModel.get("nodeClick",!0))||(n=this.findTarget(t.offsetX,t.offsetY))&&((i=n.node).getLayout().isLeafRoot?this._rootToNode(n):"zoomToNode"===e?this._zoomToNode(n):"link"===e&&(a=(o=i.hostTree.data.getItemModel(i.dataIndex)).get("link",!0),r=o.get("target",!0)||"blank",a&&window.open(a,r))))},this)},_renderBreadcrumb:function(e,t,n){n=n||((n=null!=e.get("leafDepth",!0)?{node:e.getViewRoot()}:this.findTarget(t.getWidth()/2,t.getHeight()/2))||{node:e.getData().tree.root}),(this._breadcrumb||(this._breadcrumb=new Hx(this.group))).render(e,t,n.node,Xx(function(t){"animating"!==this._state&&(Gx(e.getViewRoot(),t)?this._rootToNode({node:t}):this._zoomToNode({node:t}))},this))},remove:function(){this._clearController(),this._containerGroup&&this._containerGroup.removeAll(),this._storage=n_(),this._state="ready",this._breadcrumb&&this._breadcrumb.remove()},dispose:function(){this._clearController()},_zoomToNode:function(t){this.api.dispatchAction({type:"treemapZoomToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:t.node})},_rootToNode:function(t){this.api.dispatchAction({type:"treemapRootToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:t.node})},findTarget:function(o,a){var r;return this.seriesModel.getViewRoot().eachNode({attr:"viewChildren",order:"preorder"},function(t){var e=this._storage.background[t.getRawIndex()];if(e){var n=e.transformCoordToLocal(o,a),i=e.shape;if(!(i.x<=n[0]&&n[0]<=i.x+i.width&&i.y<=n[1]&&n[1]<=i.y+i.height))return!1;r={node:t,offsetX:n[0],offsetY:n[1]}}},this),r}});for(var o_=function(){},a_=["treemapZoomToNode","treemapRender","treemapMove"],r_=0;r_<a_.length;r_++)fp({type:a_[r_],update:"updateView"},o_);fp({type:"treemapRootToNode",update:"updateView"},function(o,t){t.eachComponent({mainType:"series",subType:"treemap",query:o},function(t,e){var n=Bx(o,["treemapZoomToNode","treemapRootToNode"],t);{var i;n&&((i=t.getViewRoot())&&(o.direction=Gx(i,n.node)?"rollUp":"drillDown"),t.resetViewRoot(n.node))}})});var s_=P,l_=V,h_=-1,u_=function(t){var e=t.mappingMethod,n=t.type,i=this.option=C(t);this.type=n,this.mappingMethod=e,this._normalizeData=w_[e];var o,a,r=c_[n];this.applyVisual=r.applyVisual,this.getColorMapper=r.getColorMapper,this._doMap=r._doMap[e],"piecewise"===e?(d_(i),a=(o=i).pieceList,o.hasSpecialVisual=!1,P(a,function(t,e){t.originIndex=e,null!=t.visual&&(o.hasSpecialVisual=!0)})):"category"===e?i.categories?function(t){var e=t.categories,n=t.visual,i=t.categoryMap={};{var o;s_(e,function(t,e){i[t]=e}),R(n)||(o=[],V(n)?s_(n,function(t,e){var n=i[e];o[null!=n?n:h_]=t}):o[h_]=n,n=__(t,o))}for(var a=e.length-1;0<=a;a--)null==n[a]&&(delete i[e[a]],e.pop())}(i):d_(i,!0):(q("linear"!==e||i.dataExtent),d_(i))};u_.prototype={constructor:u_,mapValueToVisual:function(t){var e=this._normalizeData(t);return this._doMap(e,t)},getNormalizer:function(){return E(this._normalizeData,this)}};var c_=u_.visualHandlers={color:{applyVisual:f_("color"),getColorMapper:function(){var o=this.option;return E("category"===o.mappingMethod?function(t,e){return e||(t=this._normalizeData(t)),m_.call(this,t)}:function(t,e,n){var i=!!n;return e||(t=this._normalizeData(t)),n=Fe(t,o.parsedVisual,n),i?n:Ue(n,"rgba")},this)},_doMap:{linear:function(t){return Ue(Fe(t,this.option.parsedVisual),"rgba")},category:m_,piecewise:function(t,e){var n=x_.call(this,e);return null==n&&(n=Ue(Fe(t,this.option.parsedVisual),"rgba")),n},fixed:v_}},colorHue:p_(function(t,e){return He(t,e)}),colorSaturation:p_(function(t,e){return He(t,null,e)}),colorLightness:p_(function(t,e){return He(t,null,null,e)}),colorAlpha:p_(Ze),opacity:{applyVisual:f_("opacity"),_doMap:y_([0,1])},liftZ:{applyVisual:f_("liftZ"),_doMap:{linear:v_,category:v_,piecewise:v_,fixed:v_}},symbol:{applyVisual:function(t,e,n){var i=this.mapValueToVisual(t);if(B(i))n("symbol",i);else if(l_(i))for(var o in i)i.hasOwnProperty(o)&&n(o,i[o])},_doMap:{linear:g_,category:m_,piecewise:function(t,e){var n=x_.call(this,e);return null==n&&(n=g_.call(this,t)),n},fixed:v_}},symbolSize:{applyVisual:f_("symbolSize"),_doMap:y_([0,1])}};function d_(t,e){var n=t.visual,i=[];V(n)?s_(n,function(t){i.push(t)}):null!=n&&i.push(n);e||1!==i.length||{color:1,symbol:1}.hasOwnProperty(t.type)||(i[1]=i[0]),__(t,i)}function p_(i){return{applyVisual:function(t,e,n){t=this.mapValueToVisual(t),n("color",i(e("color"),t))},_doMap:y_([0,1])}}function g_(t){var e=this.option.visual;return e[Math.round(Cl(t,[0,1],[0,e.length-1],!0))]||{}}function f_(i){return function(t,e,n){n(i,this.mapValueToVisual(t))}}function m_(t){var e=this.option.visual;return e[this.option.loop&&t!==h_?t%e.length:t]}function v_(){return this.option.visual[0]}function y_(i){return{linear:function(t){return Cl(t,i,this.option.visual,!0)},category:m_,piecewise:function(t,e){var n=x_.call(this,e);return null==n&&(n=Cl(t,i,this.option.visual,!0)),n},fixed:v_}}function x_(t){var e=this.option,n=e.pieceList;if(e.hasSpecialVisual){var i=n[u_.findPieceIndex(t,n)];if(i&&i.visual)return i.visual[this.type]}}function __(t,e){return t.visual=e,"color"===t.type&&(t.parsedVisual=N(e,function(t){return Re(t)})),e}var w_={linear:function(t){return Cl(t,this.option.dataExtent,[0,1],!0)},piecewise:function(t){var e=this.option.pieceList,n=u_.findPieceIndex(t,e,!0);if(null!=n)return Cl(n,[0,e.length-1],[0,1],!0)},category:function(t){var e=this.option.categories?this.option.categoryMap[t]:t;return null==e?h_:e},fixed:it};function b_(t,e,n){return t?e<=n:e<n}u_.listVisualTypes=function(){var n=[];return P(c_,function(t,e){n.push(e)}),n},u_.addVisualHandler=function(t,e){c_[t]=e},u_.isValidType=function(t){return c_.hasOwnProperty(t)},u_.eachVisual=function(t,e,n){V(t)?P(t,e,n):e.call(n,t)},u_.mapVisual=function(t,i,o){var a,r=R(t)?[]:V(t)?{}:(a=!0,null);return u_.eachVisual(t,function(t,e){var n=i.call(o,t,e);a?r=n:r[e]=n}),r},u_.retrieveVisuals=function(n){var i,o={};return n&&s_(c_,function(t,e){n.hasOwnProperty(e)&&(o[e]=n[e],i=!0)}),i?o:null},u_.prepareVisualTypes=function(t){if(l_(t)){var n=[];s_(t,function(t,e){n.push(e)}),t=n}else{if(!R(t))return[];t=t.slice()}return t.sort(function(t,e){return"color"===e&&"color"!==t&&0===t.indexOf("color")?1:-1}),t},u_.dependsOn=function(t,e){return"color"===e?!(!t||0!==t.indexOf(e)):t===e},u_.findPieceIndex=function(i,t,e){for(var o,a=1/0,n=0,r=t.length;n<r;n++){var s=t[n].value;if(null!=s){if(s===i||"string"==typeof s&&s===i+"")return n;e&&c(s,n)}}for(n=0,r=t.length;n<r;n++){var l=t[n],h=l.interval,u=l.close;if(h){if(h[0]===-1/0){if(b_(u[1],i,h[1]))return n}else if(h[1]===1/0){if(b_(u[0],h[0],i))return n}else if(b_(u[0],h[0],i)&&b_(u[1],i,h[1]))return n;e&&c(h[0],n),e&&c(h[1],n)}}if(e)return i===1/0?t.length-1:i===-1/0?0:o;function c(t,e){var n=Math.abs(t-i);n<a&&(a=n,o=e)}};var S_=R,M_="itemStyle",I_={seriesType:"treemap",reset:function(t,e,n,i){var o=t.getData().tree,a=o.root,r=t.getModel(M_);a.isRemoved()||!function i(t,e,o,a,r,s){var l=t.getModel();var n=t.getLayout();if(!n||n.invisible||!n.isInView)return;var h=t.getModel(M_);var u=o[t.depth];var c=T_(h,e,u,a);var d=h.get("borderColor");var p=h.get("borderColorSaturation");var g;null!=p&&(g=A_(c),f=p,d=null!=(m=g)?He(m,null,null,f):null);var f,m;t.setVisual("borderColor",d);var v=t.viewChildren;{var y;v&&v.length?(y=C_(0,l,n,0,c,v),P(v,function(t,e){var n;(t.depth>=r.length||t===r[t.depth])&&(n=k_(l,c,t,e,y,s),i(t,n,o,a,r,s))})):(g=A_(c),t.setVisual("color",g))}}(a,{},N(o.levelModels,function(t){return t?t.get(M_):null}),r,t.getViewRoot().getAncestors(),t)}};function T_(n,i,o,a){var r=k({},i);return P(["color","colorAlpha","colorSaturation"],function(t){var e=n.get(t,!0);null==e&&o&&(e=o[t]),null==e&&(e=i[t]),null==e&&(e=a.get(t)),null!=e&&(r[t]=e)}),r}function A_(t){var e=D_(t,"color");if(e){var n=D_(t,"colorAlpha"),i=D_(t,"colorSaturation");return i&&(e=He(e,null,null,i)),n&&(e=Ze(e,n)),e}}function D_(t,e){var n=t[e];if(null!=n&&"none"!==n)return n}function C_(t,e,n,i,o,a){if(a&&a.length){var r=L_(e,"color")||null!=o.color&&"none"!==o.color&&(L_(e,"colorAlpha")||L_(e,"colorSaturation"));if(r){var s=e.get("visualMin"),l=e.get("visualMax"),h=n.dataExtent.slice();null!=s&&s<h[0]&&(h[0]=s),null!=l&&l>h[1]&&(h[1]=l);var u=e.get("colorMappingBy"),c={type:r.name,dataExtent:h,visual:r.range};"color"!==c.type||"index"!==u&&"id"!==u?c.mappingMethod="linear":(c.mappingMethod="category",c.loop=!0);var d=new u_(c);return d.__drColorMappingBy=u,d}}}function L_(t,e){var n=t.get(e);return S_(n)&&n.length?{name:e,range:n}:null}function k_(t,e,n,i,o,a){var r,s,l,h=k({},e);return o&&(l="index"===(s="color"===(r=o.type)&&o.__drColorMappingBy)?i:"id"===s?a.mapIdToIndex(n.getId()):n.getValue(t.get("visualDimension")),h[r]=o.mapValueToVisual(l)),h}var P_=Math.max,N_=Math.min,O_=Z,E_=P,z_=["itemStyle","borderWidth"],R_=["itemStyle","gapWidth"],B_=["upperLabel","show"],V_=["upperLabel","height"],G_={seriesType:"treemap",reset:function(t,e,n,i){var o,a,r,s,l=n.getWidth(),h=n.getHeight(),u=t.option,c=fh(t.getBoxLayoutParams(),{width:n.getWidth(),height:n.getHeight()}),d=u.size||[],p=Ll(O_(c.width,d[0]),l),g=Ll(O_(c.height,d[1]),h),f=i&&i.type,m=Bx(i,["treemapZoomToNode","treemapRootToNode"],t),v="treemapRender"===f||"treemapMove"===f?i.rootRect:null,y=t.getViewRoot(),x=Vx(y);"treemapMove"!==f&&(o="treemapZoomToNode"===f?function(t,e,n,i,o){var a,r=(e||{}).node,s=[i,o];if(!r||r===n)return s;var l=i*o,h=l*t.option.zoomToNodeRatio;for(;a=r.parentNode;){for(var u=0,c=a.children,d=0,p=c.length;d<p;d++)u+=c[d].getValue();var g=r.getValue();if(0===g)return s;h*=u/g;var f=a.getModel(),m=f.get(z_),v=Math.max(m,Z_(f));h+=4*m*m+(3*m+v)*Math.pow(h,.5),Rl<h&&(h=Rl),r=a}h<l&&(h=l);var y=Math.pow(h/l,.5);return[i*y,o*y]}(t,m,y,p,g):v?[v.width,v.height]:[p,g],(a=u.sort)&&"asc"!==a&&"desc"!==a&&(a="desc"),r={squareRatio:u.squareRatio,sort:a,leafDepth:u.leafDepth},y.hostTree.clearLayouts(),s={x:0,y:0,width:o[0],height:o[1],area:o[0]*o[1]},y.setLayout(s),function t(e,n,i,o){var a;var r;if(e.isRemoved())return;var s=e.getLayout();a=s.width;r=s.height;var l=e.getModel();var h=l.get(z_);var u=l.get(R_)/2;var c=Z_(l);var d=Math.max(h,c);var p=h-u;var g=d-u;var l=e.getModel();e.setLayout({borderWidth:h,upperHeight:d,upperLabelHeight:c},!0);a=P_(a-2*p,0);r=P_(r-p-g,0);var f=a*r;var m=F_(e,l,f,n,i,o);if(!m.length)return;var v={x:p,y:g,width:a,height:r};var y=N_(a,r);var x=1/0;var _=[];_.area=0;for(var w=0,b=m.length;w<b;){var S=m[w];_.push(S),_.area+=S.getLayout().area;var M=W_(_,y,n.squareRatio);x=M<=x?(w++,M):(_.area-=_.pop().getLayout().area,H_(_,y,v,u,!1),y=N_(v.width,v.height),_.length=_.area=0,1/0)}_.length&&H_(_,y,v,u,!0);{var I;i||null!=(I=l.get("childrenVisibleMin"))&&f<I&&(i=!0)}for(var w=0,b=m.length;w<b;w++)t(m[w],n,i,o+1)}(y,r,!1,0),s=y.getLayout(),E_(x,function(t,e){var n=(x[e+1]||y).getValue();t.setLayout(k({dataExtent:[n,n],borderWidth:0,upperHeight:0},s))}));var _=t.getData().tree.root;_.setLayout(function(t,e,n){if(e)return{x:e.x,y:e.y};var i={x:0,y:0};if(!n)return i;var o=n.node,a=o.getLayout();if(!a)return i;var r=[a.width/2,a.height/2],s=o;for(;s;){var l=s.getLayout();r[0]+=l.x,r[1]+=l.y,s=s.parentNode}return{x:t.width/2-r[0],y:t.height/2-r[1]}}(c,v,m),!0),t.setLayoutInfo(c),function e(t,n,i,o,a){var r=t.getLayout();var s=i[a];var l=s&&s===t;if(s&&!l||a===i.length&&t!==o)return;t.setLayout({isInView:!0,invisible:!l&&!n.intersect(r),isAboveViewRoot:l},!0);var h=new Sn(n.x-r.x,n.y-r.y,n.width,n.height);E_(t.viewChildren||[],function(t){e(t,h,i,o,a+1)})}(_,new Sn(-c.x,-c.y,l,h),x,y,0)}};function F_(t,e,n,i,o,a){var r=t.children||[],s=i.sort;"asc"!==s&&"desc"!==s&&(s=null);var l,h,u=null!=i.leafDepth&&i.leafDepth<=a;if(o&&!u)return t.viewChildren=[];r=I(r,function(t){return!t.isRemoved()}),l=r,(h=s)&&l.sort(function(t,e){var n="asc"===h?t.getValue()-e.getValue():e.getValue()-t.getValue();return 0==n?"asc"===h?t.dataIndex-e.dataIndex:e.dataIndex-t.dataIndex:n});var c=function(t,e,n){for(var i=0,o=0,a=e.length;o<a;o++)i+=e[o].getValue();var r=t.get("visualDimension");{var s;e&&e.length?"value"===r&&n?(s=[e[e.length-1].getValue(),e[0].getValue()],"asc"===n&&s.reverse()):(s=[1/0,-1/0],E_(e,function(t){var e=t.getValue(r);e<s[0]&&(s[0]=e),e>s[1]&&(s[1]=e)})):s=[NaN,NaN]}return{sum:i,dataExtent:s}}(e,r,s);if(0===c.sum)return t.viewChildren=[];if(c.sum=function(t,e,n,i,o){if(!i)return n;for(var a=t.get("visibleMin"),r=o.length,s=r,l=r-1;0<=l;l--){var h=o["asc"===i?r-l-1:l].getValue();h/n*e<a&&(s=l,n-=h)}return"asc"===i?o.splice(0,r-s):o.splice(s,r-s),n}(e,n,c.sum,s,r),0===c.sum)return t.viewChildren=[];for(var d=0,p=r.length;d<p;d++){var g=r[d].getValue()/c.sum*n;r[d].setLayout({area:g})}return u&&(r.length&&t.setLayout({isLeafRoot:!0},!0),r.length=0),t.viewChildren=r,t.setLayout({dataExtent:c.dataExtent},!0),r}function W_(t,e,n){for(var i,o=0,a=1/0,r=0,s=t.length;r<s;r++)(i=t[r].getLayout().area)&&(i<a&&(a=i),o<i&&(o=i));var l=t.area*t.area,h=e*e*n;return l?P_(h*o/l,l/(h*a)):1/0}function H_(t,e,n,i,o){var a=e===n.width?0:1,r=1-a,s=["x","y"],l=["width","height"],h=n[s[a]],u=e?t.area/e:0;(o||u>n[l[r]])&&(u=n[l[r]]);for(var c=0,d=t.length;c<d;c++){var p=t[c],g={},f=u?p.getLayout().area/u:0,m=g[l[r]]=P_(u-2*i,0),v=n[s[a]]+n[l[a]]-h,y=c===d-1||v<f?v:f,x=g[l[a]]=P_(y-2*i,0);g[s[r]]=n[s[r]]+N_(i,m/2),g[s[a]]=h+N_(i,x/2),h+=y,p.setLayout(g,!0)}n[s[r]]+=u,n[l[r]]-=u}function Z_(t){return t.get(B_)?t.get(V_):0}function U_(t){return"_EC_"+t}yp(I_),vp(G_);function X_(t){this._directed=t||!1,this.nodes=[],this.edges=[],this._nodesMap={},this._edgesMap={},this.data,this.edgeData}var Y_=X_.prototype;function j_(t,e){this.id=null==t?"":t,this.inEdges=[],this.outEdges=[],this.edges=[],this.hostGraph,this.dataIndex=null==e?-1:e}function q_(t,e,n){this.node1=t,this.node2=e,this.dataIndex=null==n?-1:n}Y_.type="graph",Y_.isDirected=function(){return this._directed},Y_.addNode=function(t,e){t=null==t?""+e:""+t;var n=this._nodesMap;if(!n[U_(t)]){var i=new j_(t,e);return(i.hostGraph=this).nodes.push(i),n[U_(t)]=i}D&&console.error("Graph nodes have duplicate name or id")},Y_.getNodeByIndex=function(t){var e=this.data.getRawIndex(t);return this.nodes[e]},Y_.getNodeById=function(t){return this._nodesMap[U_(t)]},Y_.addEdge=function(t,e,n){var i=this._nodesMap,o=this._edgesMap;if("number"==typeof t&&(t=this.nodes[t]),"number"==typeof e&&(e=this.nodes[e]),j_.isInstance(t)||(t=i[U_(t)]),j_.isInstance(e)||(e=i[U_(e)]),t&&e){var a=t.id+"-"+e.id;if(!o[a]){var r=new q_(t,e,n);return(r.hostGraph=this)._directed&&(t.outEdges.push(r),e.inEdges.push(r)),t.edges.push(r),t!==e&&e.edges.push(r),this.edges.push(r),o[a]=r}}},Y_.getEdgeByIndex=function(t){var e=this.edgeData.getRawIndex(t);return this.edges[e]},Y_.getEdge=function(t,e){j_.isInstance(t)&&(t=t.id),j_.isInstance(e)&&(e=e.id);var n=this._edgesMap;return this._directed?n[t+"-"+e]:n[t+"-"+e]||n[e+"-"+t]},Y_.eachNode=function(t,e){for(var n=this.nodes,i=n.length,o=0;o<i;o++)0<=n[o].dataIndex&&t.call(e,n[o],o)},Y_.eachEdge=function(t,e){for(var n=this.edges,i=n.length,o=0;o<i;o++)0<=n[o].dataIndex&&0<=n[o].node1.dataIndex&&0<=n[o].node2.dataIndex&&t.call(e,n[o],o)},Y_.breadthFirstTraverse=function(t,e,n,i){if(j_.isInstance(e)||(e=this._nodesMap[U_(e)]),e){for(var o="out"===n?"outEdges":"in"===n?"inEdges":"edges",a=0;a<this.nodes.length;a++)this.nodes[a].__visited=!1;if(!t.call(i,e,null))for(var r=[e];r.length;)for(var s=r.shift(),l=s[o],a=0;a<l.length;a++){var h=l[a],u=h.node1===s?h.node2:h.node1;if(!u.__visited){if(t.call(i,u,s))return;r.push(u),u.__visited=!0}}}},Y_.update=function(){for(var t=this.data,n=this.edgeData,e=this.nodes,i=this.edges,o=0,a=e.length;o<a;o++)e[o].dataIndex=-1;for(o=0,a=t.count();o<a;o++)e[t.getRawIndex(o)].dataIndex=o;n.filterSelf(function(t){var e=i[n.getRawIndex(t)];return 0<=e.node1.dataIndex&&0<=e.node2.dataIndex});for(o=0,a=i.length;o<a;o++)i[o].dataIndex=-1;for(o=0,a=n.count();o<a;o++)i[n.getRawIndex(o)].dataIndex=o},Y_.clone=function(){for(var t=new X_(this._directed),e=this.nodes,n=this.edges,i=0;i<e.length;i++)t.addNode(e[i].id,e[i].dataIndex);for(i=0;i<n.length;i++){var o=n[i];t.addEdge(o.node1.id,o.node2.id,o.dataIndex)}return t},j_.prototype={constructor:j_,degree:function(){return this.edges.length},inDegree:function(){return this.inEdges.length},outDegree:function(){return this.outEdges.length},getModel:function(t){if(!(this.dataIndex<0))return this.hostGraph.data.getItemModel(this.dataIndex).getModel(t)}},q_.prototype.getModel=function(t){if(!(this.dataIndex<0))return this.hostGraph.edgeData.getItemModel(this.dataIndex).getModel(t)};function K_(n,i){return{getValue:function(t){var e=this[n][i];return e.get(e.getDimension(t||"value"),this.dataIndex)},setVisual:function(t,e){0<=this.dataIndex&&this[n][i].setItemVisual(this.dataIndex,t,e)},getVisual:function(t,e){return this[n][i].getItemVisual(this.dataIndex,t,e)},setLayout:function(t,e){0<=this.dataIndex&&this[n][i].setItemLayout(this.dataIndex,t,e)},getLayout:function(){return this[n][i].getItemLayout(this.dataIndex)},getGraphicEl:function(){return this[n][i].getItemGraphicEl(this.dataIndex)},getRawIndex:function(){return this[n][i].getRawIndex(this.dataIndex)}}}b(j_,K_("hostGraph","data")),b(q_,K_("hostGraph","edgeData")),X_.Node=j_,X_.Edge=q_,ea(j_),ea(q_);function $_(t,e,n,i,o){for(var a=new X_(i),r=0;r<t.length;r++)a.addNode(Z(t[r].id,t[r].name,r),r);for(var s=[],l=[],h=0,r=0;r<e.length;r++){var u=e[r],c=u.source,d=u.target;a.addEdge(c,d,h)&&(l.push(u),s.push(Z(u.id,c+" > "+d)),h++)}var p,g,f,m,v=n.get("coordinateSystem");"cartesian2d"===v||"polar"===v?m=dg(t,n):(M(g=(p=nu.get(v))&&"view"!==p.type&&p.dimensions||[],"value")<0&&g.concat(["value"]),f=ag(t,{coordDimensions:g}),(m=new Hp(f,n)).initData(t));var y=new Hp(["value"],n);return y.initData(l,s),o&&o(m,y),px({mainData:m,struct:a,structAttr:"graph",datas:{node:m,edge:y},datasAttr:{node:"data",edge:"edgeData"}}),a.update(),a}var J_=Sp({type:"series.graph",init:function(t){J_.superApply(this,"init",arguments);var e=this;function n(){return e._categoriesData}this.legendVisualProvider=new Zv(n,n),this.fillDataTextStyle(t.edges||t.links),this._updateCategoriesData()},mergeOption:function(t){J_.superApply(this,"mergeOption",arguments),this.fillDataTextStyle(t.edges||t.links),this._updateCategoriesData()},mergeDefaultAndTheme:function(t){J_.superApply(this,"mergeDefaultAndTheme",arguments),Eo(t,["edgeLabel"],["show"])},getInitialData:function(t,s){var e=t.edges||t.links||[],n=t.data||t.nodes||[],l=this;if(n&&e)return $_(n,e,this,!0,function(t,e){t.wrapMethod("getItemModel",function(t){var e=l._categoriesModels[t.getShallow("category")];return e&&(e.parentModel=t.parentModel,t.parentModel=e),t});var n=l.getModel("edgeLabel"),i=new Sl({label:n.option},n.parentModel,s),o=l.getModel("emphasis.edgeLabel"),a=new Sl({emphasis:{label:o.option}},o.parentModel,s);function r(t){return(t=this.parsePath(t))&&"label"===t[0]?i:t&&"emphasis"===t[0]&&"label"===t[1]?a:this.parentModel}e.wrapMethod("getItemModel",function(t){return t.customizeGetParent(r),t})}).data},getGraph:function(){return this.getData().graph},getEdgeData:function(){return this.getGraph().edgeData},getCategoriesData:function(){return this._categoriesData},formatTooltip:function(t,e,n){if("edge"!==n)return J_.superApply(this,"formatTooltip",arguments);var i=this.getData(),o=this.getDataParams(t,n),a=i.graph.getEdgeByIndex(t),r=i.getName(a.node1.dataIndex),s=i.getName(a.node2.dataIndex),l=[];return null!=r&&l.push(r),null!=s&&l.push(s),l=Ql(l.join(" > ")),o.value&&(l+=" : "+Ql(o.value)),l},_updateCategoriesData:function(){var t=N(this.option.categories||[],function(t){return null!=t.value?t:k({value:0},t)}),e=new Hp(["value"],this);e.initData(t),this._categoriesData=e,this._categoriesModels=e.mapArray(function(t){return e.getItemModel(t,!0)})},setZoom:function(t){this.option.zoom=t},setCenter:function(t){this.option.center=t},isAnimationEnabled:function(){return J_.superCall(this,"isAnimationEnabled")&&!("force"===this.get("layout")&&this.get("force.layoutAnimation"))},defaultOption:{zlevel:0,z:2,coordinateSystem:"view",legendHoverLink:!0,hoverAnimation:!0,layout:null,focusNodeAdjacency:!1,circular:{rotateLabel:!1},force:{initLayout:null,repulsion:[0,50],gravity:.1,friction:.6,edgeLength:30,layoutAnimation:!0},left:"center",top:"center",symbol:"circle",symbolSize:10,edgeSymbol:["none","none"],edgeSymbolSize:10,edgeLabel:{position:"middle"},draggable:!1,roam:!1,center:null,zoom:1,nodeScaleRatio:.6,label:{show:!1,formatter:"{b}"},itemStyle:{},lineStyle:{color:"#aaa",width:1,curveness:0,opacity:.5},emphasis:{label:{show:!0}}}}),Q_=is.prototype,tw=ss.prototype;function ew(t){return isNaN(+t.cpx1)||isNaN(+t.cpy1)}var nw=Ms({type:"ec-line",style:{stroke:"#000",fill:null},shape:{x1:0,y1:0,x2:0,y2:0,percent:1,cpx1:null,cpy1:null},buildPath:function(t,e){this[ew(e)?"_buildPathLine":"_buildPathCurve"](t,e)},_buildPathLine:Q_.buildPath,_buildPathCurve:tw.buildPath,pointAt:function(t){return this[ew(this.shape)?"_pointAtLine":"_pointAtCurve"](t)},_pointAtLine:Q_.pointAt,_pointAtCurve:tw.pointAt,tangentAt:function(t){var e=this.shape,n=ew(e)?[e.x2-e.x1,e.y2-e.y1]:this._tangentAtCurve(t);return mt(n,n)},_tangentAtCurve:tw.tangentAt}),iw=["fromSymbol","toSymbol"];function ow(t){return"_"+t+"Type"}function aw(t,e,n){var i=e.getItemVisual(n,"color"),o=e.getItemVisual(n,t),a=e.getItemVisual(n,t+"Size");if(o&&"none"!==o){R(a)||(a=[a,a]);var r=xf(o,-a[0]/2,-a[1]/2,a[0],a[1],i);return r.name=t,r}}function rw(t,e){t.x1=e[0][0],t.y1=e[0][1],t.x2=e[1][0],t.y2=e[1][1],t.percent=1;var n=e[2];n?(t.cpx1=n[0],t.cpy1=n[1]):(t.cpx1=NaN,t.cpy1=NaN)}function sw(t,e,n){Mn.call(this),this._createLine(t,e,n)}var lw=sw.prototype;function hw(t){this._ctor=t||sw,this.group=new Mn}lw.beforeUpdate=function(){var t=this.childOfName("fromSymbol"),e=this.childOfName("toSymbol"),n=this.childOfName("label");if(t||e||!n.ignore){for(var i=1,o=this.parent;o;)o.scale&&(i/=o.scale[0]),o=o.parent;var a,r,s,l,h,u,c,d,p,g,f,m,v,y=this.childOfName("line");(this.__dirty||y.__dirty)&&(a=y.shape.percent,r=y.pointAt(0),mt(l=dt([],s=y.pointAt(a),r),l),t&&(t.attr("position",r),g=y.tangentAt(0),t.attr("rotation",Math.PI/2-Math.atan2(g[1],g[0])),t.attr("scale",[i*a,i*a])),e&&(e.attr("position",s),g=y.tangentAt(1),e.attr("rotation",-Math.PI/2-Math.atan2(g[1],g[0])),e.attr("scale",[i*a,i*a])),n.ignore||(n.attr("position",s),d=5*i,"end"===n.__position?(h=[l[0]*d+s[0],l[1]*d+s[1]],u=.8<l[0]?"left":l[0]<-.8?"right":"center",c=.8<l[1]?"top":l[1]<-.8?"bottom":"middle"):"middle"===n.__position?(p=a/2,f=[(g=y.tangentAt(p))[1],-g[0]],m=y.pointAt(p),0<f[1]&&(f[0]=-f[0],f[1]=-f[1]),h=[m[0]+f[0]*d,m[1]+f[1]*d],u="center",c="bottom",v=-Math.atan2(g[1],g[0]),s[0]<r[0]&&(v=Math.PI+v),n.attr("rotation",v)):(h=[-l[0]*d+r[0],-l[1]*d+r[1]],u=.8<l[0]?"right":l[0]<-.8?"left":"center",c=.8<l[1]?"bottom":l[1]<-.8?"top":"middle"),n.attr({style:{textVerticalAlign:n.__verticalAlign||c,textAlign:n.__textAlign||u},position:h,scale:[i,i]})))}},lw._createLine=function(n,i,t){var e,o,a=n.hostModel,r=n.getItemLayout(i),s=(e=r,rw((o=new nw({name:"line",subPixelOptimize:!0})).shape,e),o);s.shape.percent=0,sl(s,{shape:{percent:1}},a,i),this.add(s);var l=new Gr({name:"label",lineLabelOriginalOpacity:1});this.add(l),P(iw,function(t){var e=aw(t,n,i);this.add(e),this[ow(t)]=n.getItemVisual(i,t)},this),this._updateCommonStl(n,i,t)},lw.updateData=function(o,a,t){var e=o.hostModel,n=this.childOfName("line"),i=o.getItemLayout(a),r={shape:{}};rw(r.shape,i),rl(n,r,e,a),P(iw,function(t){var e,n=o.getItemVisual(a,t),i=ow(t);this[i]!==n&&(this.remove(this.childOfName(t)),e=aw(t,o,a),this.add(e)),this[i]=n},this),this._updateCommonStl(o,a,t)},lw._updateCommonStl=function(t,e,n){var i,o=t.hostModel,a=this.childOfName("line"),r=n&&n.lineStyle,s=n&&n.hoverLineStyle,l=n&&n.labelModel,h=n&&n.hoverLabelModel;n&&!t.hasItemOption||(r=(i=t.getItemModel(e)).getModel("lineStyle").getLineStyle(),s=i.getModel("emphasis.lineStyle").getLineStyle(),l=i.getModel("label"),h=i.getModel("emphasis.label"));var u=t.getItemVisual(e,"color"),c=X(t.getItemVisual(e,"opacity"),r.opacity,1);a.useStyle(L({strokeNoScale:!0,fill:"none",stroke:u,opacity:c},r)),a.hoverStyle=s,P(iw,function(t){var e=this.childOfName(t);e&&(e.setColor(u),e.setStyle({opacity:c}))},this);var d,p,g,f=l.getShallow("show"),m=h.getShallow("show"),v=this.childOfName("label");(f||m)&&(g=u||"#000",null==(p=o.getFormattedLabel(e,"normal",t.dataType))&&(p=null==(d=o.getRawValue(e))?t.getName(e):isFinite(d)?kl(d):d));var y=f?p:null,x=m?U(o.getFormattedLabel(e,"emphasis",t.dataType),p):null,_=v.style;null==y&&null==x||(Js(v.style,l,{text:y},{autoColor:g}),v.__textAlign=_.textAlign,v.__verticalAlign=_.textVerticalAlign,v.__position=l.get("position")||"middle"),v.hoverStyle=null!=x?{text:x,textFill:h.getTextColor(!0),fontStyle:h.getShallow("fontStyle"),fontWeight:h.getShallow("fontWeight"),fontSize:h.getShallow("fontSize"),fontFamily:h.getShallow("fontFamily")}:{text:null},v.ignore=!f&&!m,Xs(this)},lw.highlight=function(){this.trigger("emphasis")},lw.downplay=function(){this.trigger("normal")},lw.updateLayout=function(t,e){this.setLinePoints(t.getItemLayout(e))},lw.setLinePoints=function(t){var e=this.childOfName("line");rw(e.shape,t),e.dirty()},w(sw,Mn);var uw=hw.prototype;function cw(t){var e=t.hostModel;return{lineStyle:e.getModel("lineStyle").getLineStyle(),hoverLineStyle:e.getModel("emphasis.lineStyle").getLineStyle(),labelModel:e.getModel("label"),hoverLabelModel:e.getModel("emphasis.label")}}function dw(t){return isNaN(t[0])||isNaN(t[1])}function pw(t){return!dw(t[0])&&!dw(t[1])}function gw(t){var e=t.coordinateSystem;if("view"!==e.type)return 1;var n=t.option.nodeScaleRatio,i=e.scale,o=i&&i[0]||1;return((e.getZoom()-1)*n+1)/o}function fw(t){var e=t.getVisual("symbolSize");return e instanceof Array&&(e=(e[0]+e[1])/2),+e}uw.isPersistent=function(){return!0},uw.updateData=function(n){var i=this,e=i.group,o=i._lineData;i._lineData=n,o||e.removeAll();var a=cw(n);n.diff(o).add(function(t){!function(t,e,n,i){if(!pw(e.getItemLayout(n)))return;var o=new t._ctor(e,n,i);e.setItemGraphicEl(n,o),t.group.add(o)}(i,n,t,a)}).update(function(t,e){!function(t,e,n,i,o,a){var r=e.getItemGraphicEl(i);if(!pw(n.getItemLayout(o)))return t.group.remove(r);r?r.updateData(n,o,a):r=new t._ctor(n,o,a);n.setItemGraphicEl(o,r),t.group.add(r)}(i,o,n,e,t,a)}).remove(function(t){e.remove(o.getItemGraphicEl(t))}).execute()},uw.updateLayout=function(){var n=this._lineData;n&&n.eachItemGraphicEl(function(t,e){t.updateLayout(n,e)},this)},uw.incrementalPrepareUpdate=function(t){this._seriesScope=cw(t),this._lineData=null,this.group.removeAll()},uw.incrementalUpdate=function(t,e){function n(t){t.isGroup||(t.incremental=t.useHoverLayer=!0)}for(var i,o=t.start;o<t.end;o++){pw(e.getItemLayout(o))&&((i=new this._ctor(e,o,this._seriesScope)).traverse(n),this.group.add(i),e.setItemGraphicEl(o,i))}},uw.remove=function(){this._clearIncremental(),this._incremental=null,this.group.removeAll()},uw._clearIncremental=function(){var t=this._incremental;t&&t.clearDisplaybles()};var mw=[],vw=[],yw=[],xw=Ia,_w=_t,ww=Math.abs;function bw(t,e,n){for(var i,o=t[0],a=t[1],r=t[2],s=1/0,l=n*n,h=.1,u=.1;u<=.9;u+=.1){mw[0]=xw(o[0],a[0],r[0],u),mw[1]=xw(o[1],a[1],r[1],u),(p=ww(_w(mw,e)-l))<s&&(s=p,i=u)}for(var c=0;c<32;c++){var d=i+h;vw[0]=xw(o[0],a[0],r[0],i),vw[1]=xw(o[1],a[1],r[1],i),yw[0]=xw(o[0],a[0],r[0],d),yw[1]=xw(o[1],a[1],r[1],d);var p=_w(vw,e)-l;if(ww(p)<.01)break;var g=_w(yw,e)-l;h/=2,p<0?0<=g?i+=h:i-=h:0<=g?i-=h:i+=h}return i}function Sw(t,l){var h=[],u=Da,c=[[],[],[]],d=[[],[]],p=[];l/=2,t.eachEdge(function(t,e){var n=t.getLayout(),i=t.getVisual("fromSymbol"),o=t.getVisual("toSymbol");n.__original||(n.__original=[lt(n[0]),lt(n[1])],n[2]&&n.__original.push(lt(n[2])));var a,r,s=n.__original;null!=n[2]?(st(c[0],s[0]),st(c[1],s[2]),st(c[2],s[1]),i&&"none"!==i&&(r=fw(t.node1),a=bw(c,s[0],r*l),u(c[0][0],c[1][0],c[2][0],a,h),c[0][0]=h[3],c[1][0]=h[4],u(c[0][1],c[1][1],c[2][1],a,h),c[0][1]=h[3],c[1][1]=h[4]),o&&"none"!==o&&(r=fw(t.node2),a=bw(c,s[1],r*l),u(c[0][0],c[1][0],c[2][0],a,h),c[1][0]=h[1],c[2][0]=h[2],u(c[0][1],c[1][1],c[2][1],a,h),c[1][1]=h[1],c[2][1]=h[2]),st(n[0],c[0]),st(n[1],c[2]),st(n[2],c[1])):(st(d[0],s[0]),st(d[1],s[1]),dt(p,d[1],d[0]),mt(p,p),i&&"none"!==i&&(r=fw(t.node1),ct(d[0],d[0],p,r*l)),o&&"none"!==o&&(r=fw(t.node2),ct(d[1],d[1],p,-r*l)),st(n[0],d[0]),st(n[1],d[1]))})}var Mw="__focusNodeAdjacency",Iw="__unfocusNodeAdjacency",Tw=["itemStyle","opacity"],Aw=["lineStyle","opacity"];function Dw(t,e){var n=t.getVisual("opacity");return null!=n?n:t.getModel().get(e)}function Cw(t,e,n){var i=t.getGraphicEl(),o=Dw(t,e);null!=n&&(null==o&&(o=1),o*=n),i.downplay&&i.downplay(),i.traverse(function(t){var e;t.isGroup||(null!=(e=t.lineLabelOriginalOpacity)&&null==n||(e=o),t.setStyle("opacity",e))})}function Lw(t,e){var n=Dw(t,e),i=t.getGraphicEl();i.traverse(function(t){t.isGroup||t.setStyle("opacity",n)}),i.highlight&&i.highlight()}Mp({type:"graph",init:function(t,e){var n=new tm,i=new hw,o=this.group;this._controller=new Oy(e.getZr()),this._controllerHost={target:o},o.add(n.group),o.add(i.group),this._symbolDraw=n,this._lineDraw=i,this._firstRender=!0},render:function(o,t,a){var r=this,e=o.coordinateSystem;this._model=o;var n,i=this._symbolDraw,s=this._lineDraw,l=this.group;"view"===e.type&&(n={position:e.position,scale:e.scale},this._firstRender?l.attr(n):rl(l,n,o)),Sw(o.getGraph(),gw(o));var h=o.getData();i.updateData(h);var u=o.getEdgeData();s.updateData(u),this._updateNodeAndLinkScale(),this._updateController(o,t,a),clearTimeout(this._layoutTimeout);var c=o.forceLayout,d=o.get("force.layoutAnimation");c&&this._startForceLayoutIteration(c,d),h.eachItemGraphicEl(function(t,e){var n=h.getItemModel(e);t.off("drag").off("dragend");var i=n.get("draggable");i&&t.on("drag",function(){c&&(c.warmUp(),this._layouting||this._startForceLayoutIteration(c,d),c.setFixed(e),h.setItemLayout(e,t.position))},this).on("dragend",function(){c&&c.setUnfixed(e)},this),t.setDraggable(i&&c),t[Mw]&&t.off("mouseover",t[Mw]),t[Iw]&&t.off("mouseout",t[Iw]),n.get("focusNodeAdjacency")&&(t.on("mouseover",t[Mw]=function(){r._clearTimer(),a.dispatchAction({type:"focusNodeAdjacency",seriesId:o.id,dataIndex:t.dataIndex})}),t.on("mouseout",t[Iw]=function(){r._dispatchUnfocus(a)}))},this),h.graph.eachEdge(function(t){var e=t.getGraphicEl();e[Mw]&&e.off("mouseover",e[Mw]),e[Iw]&&e.off("mouseout",e[Iw]),t.getModel().get("focusNodeAdjacency")&&(e.on("mouseover",e[Mw]=function(){r._clearTimer(),a.dispatchAction({type:"focusNodeAdjacency",seriesId:o.id,edgeDataIndex:t.dataIndex})}),e.on("mouseout",e[Iw]=function(){r._dispatchUnfocus(a)}))});var p="circular"===o.get("layout")&&o.get("circular.rotateLabel"),g=h.getLayout("cx"),f=h.getLayout("cy");h.eachItemGraphicEl(function(t,e){var n,i,o,a,r=h.getItemModel(e).get("label.rotate")||0,s=t.getSymbolPath();p?(n=h.getItemLayout(e),(i=Math.atan2(n[1]-f,n[0]-g))<0&&(i=2*Math.PI+i),(o=n[0]<g)&&(i-=Math.PI),$s(s,{textRotation:-i,textPosition:a=o?"left":"right",textOrigin:"center"},{textPosition:a})):$s(s,{textRotation:r*=Math.PI/180})}),this._firstRender=!1},dispose:function(){this._controller&&this._controller.dispose(),this._controllerHost={},this._clearTimer()},_dispatchUnfocus:function(t,e){var n=this;this._clearTimer(),this._unfocusDelayTimer=setTimeout(function(){n._unfocusDelayTimer=null,t.dispatchAction({type:"unfocusNodeAdjacency",seriesId:n._model.id})},500)},_clearTimer:function(){this._unfocusDelayTimer&&(clearTimeout(this._unfocusDelayTimer),this._unfocusDelayTimer=null)},focusNodeAdjacency:function(t,e,n,i){var o=this._model.getData().graph,a=i.dataIndex,r=i.edgeDataIndex,s=o.getNodeByIndex(a),l=o.getEdgeByIndex(r);(s||l)&&(o.eachNode(function(t){Cw(t,Tw,.1)}),o.eachEdge(function(t){Cw(t,Aw,.1)}),s&&(Lw(s,Tw),P(s.edges,function(t){t.dataIndex<0||(Lw(t,Aw),Lw(t.node1,Tw),Lw(t.node2,Tw))})),l&&(Lw(l,Aw),Lw(l.node1,Tw),Lw(l.node2,Tw)))},unfocusNodeAdjacency:function(t,e,n,i){var o=this._model.getData().graph;o.eachNode(function(t){Cw(t,Tw)}),o.eachEdge(function(t){Cw(t,Aw)})},_startForceLayoutIteration:function(t,n){var i=this;!function e(){t.step(function(t){i.updateLayout(i._model),(i._layouting=!t)&&(n?i._layoutTimeout=setTimeout(e,16):e())})}()},_updateController:function(o,t,a){var e=this._controller,n=this._controllerHost,r=this.group;e.setPointerChecker(function(t,e,n){var i=r.getBoundingRect();return i.applyTransform(r.transform),i.contain(e,n)&&!Xy(t,a,o)}),"view"===o.coordinateSystem.type?(e.enable(o.get("roam")),n.zoomLimit=o.get("scaleLimit"),n.zoom=o.coordinateSystem.getZoom(),e.off("pan").off("zoom").on("pan",function(t){Hy(n,t.dx,t.dy),a.dispatchAction({seriesId:o.id,type:"graphRoam",dx:t.dx,dy:t.dy})}).on("zoom",function(t){Zy(n,t.scale,t.originX,t.originY),a.dispatchAction({seriesId:o.id,type:"graphRoam",zoom:t.scale,originX:t.originX,originY:t.originY}),this._updateNodeAndLinkScale(),Sw(o.getGraph(),gw(o)),this._lineDraw.updateLayout()},this)):e.disable()},_updateNodeAndLinkScale:function(){var t=this._model,e=t.getData(),n=gw(t),i=[n,n];e.eachItemGraphicEl(function(t,e){t.attr("scale",i)})},updateLayout:function(t){Sw(t.getGraph(),gw(t)),this._symbolDraw.updateLayout(),this._lineDraw.updateLayout()},remove:function(t,e){this._symbolDraw&&this._symbolDraw.remove(),this._lineDraw&&this._lineDraw.remove()}}),fp({type:"focusNodeAdjacency",event:"focusNodeAdjacency",update:"series:focusNodeAdjacency"},function(){}),fp({type:"unfocusNodeAdjacency",event:"unfocusNodeAdjacency",update:"series:unfocusNodeAdjacency"},function(){});fp({type:"graphRoam",event:"graphRoam",update:"none"},function(n,t){t.eachComponent({mainType:"series",query:n},function(t){var e=tx(t.coordinateSystem,n);t.setCenter&&t.setCenter(e.center),t.setZoom&&t.setZoom(e.zoom)})});function kw(t){return t instanceof Array||(t=[t,t]),t}function Pw(t){var e,n=t.coordinateSystem;n&&"view"!==n.type||((e=t.getGraph()).eachNode(function(t){var e=t.getModel();t.setLayout([+e.get("x"),+e.get("y")])}),Nw(e))}function Nw(t){t.eachEdge(function(t){var e=t.getModel().get("lineStyle.curveness")||0,n=lt(t.node1.getLayout()),i=lt(t.node2.getLayout()),o=[n,i];+e&&o.push([(n[0]+i[0])/2-(n[1]-i[1])*e,(n[1]+i[1])/2-(i[0]-n[0])*e]),t.setLayout(o)})}var Ow=Math.PI,Ew=[];function zw(t,e){var n,i,o,s,l,a,r,h=t.coordinateSystem;h&&"view"!==h.type||(n=h.getBoundingRect(),o=(i=t.getData()).graph,s=n.width/2+n.x,l=n.height/2+n.y,a=Math.min(n.width,n.height)/2,r=i.count(),i.setLayout({cx:s,cy:l}),r&&(Rw[e](t,h,o,i,a,s,l,r),o.eachEdge(function(t){var e,n=t.getModel().get("lineStyle.curveness")||0,i=lt(t.node1.getLayout()),o=lt(t.node2.getLayout()),a=(i[0]+o[0])/2,r=(i[1]+o[1])/2;+n&&(e=[s*(n*=3)+a*(1-n),l*n+r*(1-n)]),t.setLayout([i,o,e])})))}var Rw={value:function(t,e,n,i,o,a,r,s){var l=0,h=i.getSum("value"),u=2*Math.PI/(h||s);n.eachNode(function(t){var e=t.getValue("value"),n=u*(h?e:1)/2;l+=n,t.setLayout([o*Math.cos(l)+a,o*Math.sin(l)+r]),l+=n})},symbolSize:function(t,e,n,i,o,a,r,s){var l=0;Ew.length=s;var h=gw(t);n.eachNode(function(t){var e=fw(t);isNaN(e)&&(e=2),e<0&&(e=0),e*=h;var n=Math.asin(e/2/o);isNaN(n)&&(n=Ow/2),Ew[t.dataIndex]=n,l+=2*n});var u=(2*Ow-l)/s/2,c=0;n.eachNode(function(t){var e=u+Ew[t.dataIndex];c+=e,t.setLayout([o*Math.cos(c)+a,o*Math.sin(c)+r]),c+=e})}},Bw=ct;gp(function(t){var a=t.findComponents({mainType:"legend"});a&&a.length&&t.eachSeriesByType("graph",function(t){var e=t.getCategoriesData(),i=t.getGraph().data,o=e.mapArray(e.getName);i.filterSelf(function(t){var e=i.getItemModel(t).getShallow("category");if(null!=e){"number"==typeof e&&(e=o[e]);for(var n=0;n<a.length;n++)if(!a[n].isSelected(e))return!1}return!0})},this)}),yp(Dm("graph","circle",null)),yp(function(t){var u={};t.eachSeriesByType("graph",function(s){var l=s.getCategoriesData(),o=s.getData(),h={};l.each(function(t){var e=l.getName(t);h["ec-"+e]=t;var n=l.getItemModel(t),i=n.get("itemStyle.color")||s.getColorFromPalette(e,u);l.setItemVisual(t,"color",i);for(var o=["opacity","symbol","symbolSize","symbolKeepAspect"],a=0;a<o.length;a++){var r=n.getShallow(o[a],!0);null!=r&&l.setItemVisual(t,o[a],r)}}),l.count()&&o.each(function(t){var e=o.getItemModel(t).getShallow("category");if(null!=e){"string"==typeof e&&(e=h["ec-"+e]);for(var n=["color","opacity","symbol","symbolSize","symbolKeepAspect"],i=0;i<n.length;i++)null==o.getItemVisual(t,n[i],!0)&&o.setItemVisual(t,n[i],l.getItemVisual(e,n[i]))}})})}),yp(function(t){t.eachSeriesByType("graph",function(t){var s=t.getGraph(),l=t.getEdgeData(),e=kw(t.get("edgeSymbol")),n=kw(t.get("edgeSymbolSize")),h="lineStyle.color".split("."),u="lineStyle.opacity".split(".");l.setVisual("fromSymbol",e&&e[0]),l.setVisual("toSymbol",e&&e[1]),l.setVisual("fromSymbolSize",n&&n[0]),l.setVisual("toSymbolSize",n&&n[1]),l.setVisual("color",t.get(h)),l.setVisual("opacity",t.get(u)),l.each(function(t){var e=l.getItemModel(t),n=s.getEdgeByIndex(t),i=kw(e.getShallow("symbol",!0)),o=kw(e.getShallow("symbolSize",!0)),a=e.get(h),r=e.get(u);switch(a){case"source":a=n.node1.getVisual("color");break;case"target":a=n.node2.getVisual("color")}i[0]&&n.setVisual("fromSymbol",i[0]),i[1]&&n.setVisual("toSymbol",i[1]),o[0]&&n.setVisual("fromSymbolSize",o[0]),o[1]&&n.setVisual("toSymbolSize",o[1]),n.setVisual("color",a),n.setVisual("opacity",r)})})}),vp(function(t,e){t.eachSeriesByType("graph",function(t){var e=t.get("layout"),n=t.coordinateSystem;if(n&&"view"!==n.type){var i=t.getData(),o=[];P(n.dimensions,function(t){o=o.concat(i.mapDimension(t,!0))});for(var a=0;a<i.count();a++){for(var r=[],s=!1,l=0;l<o.length;l++){var h=i.get(o[l],a);isNaN(h)||(s=!0),r.push(h)}s?i.setItemLayout(a,n.dataToPoint(r)):i.setItemLayout(a,[NaN,NaN])}Nw(i.graph)}else e&&"none"!==e||Pw(t)})}),vp(Id.VISUAL.POST_CHART_LAYOUT,function(t){t.eachSeriesByType("graph",function(t){"circular"===t.get("layout")&&zw(t,"symbolSize")})}),vp(function(t){t.eachSeriesByType("graph",function(t){var c,d,p,e,n,i,o,a,r,s,l,h,u,g,f,m=t.coordinateSystem;m&&"view"!==m.type||("force"===t.get("layout")?(c=t.preservedPoints||{},d=t.getGraph(),p=d.data,e=d.edgeData,i=(n=t.getModel("force")).get("initLayout"),t.preservedPoints?p.each(function(t){var e=p.getId(t);p.setItemLayout(t,c[e]||[NaN,NaN])}):i&&"none"!==i?"circular"===i&&zw(t,"value"):Pw(t),o=p.getDataExtent("value"),a=e.getDataExtent("value"),r=n.get("repulsion"),s=n.get("edgeLength"),R(r)||(r=[r,r]),R(s)||(s=[s,s]),s=[s[1],s[0]],l=p.mapArray("value",function(t,e){var n=p.getItemLayout(e),i=Cl(t,o,r);return isNaN(i)&&(i=(r[0]+r[1])/2),{w:i,rep:i,fixed:p.getItemModel(e).get("fixed"),p:!n||isNaN(n[0])||isNaN(n[1])?null:n}}),h=e.mapArray("value",function(t,e){var n=d.getEdgeByIndex(e),i=Cl(t,a,s);isNaN(i)&&(i=(s[0]+s[1])/2);var o=n.getModel();return{n1:l[n.node1.dataIndex],n2:l[n.node2.dataIndex],d:i,curveness:o.get("lineStyle.curveness")||0,ignoreForceLayout:o.get("ignoreForceLayout")}}),u=(m=t.coordinateSystem).getBoundingRect(),g=function(p,g,t){for(var e=t.rect,n=e.width,i=e.height,f=[e.x+n/2,e.y+i/2],m=null==t.gravity?.1:t.gravity,o=0;o<p.length;o++){var a=p[o];a.p||(a.p=rt(n*(Math.random()-.5)+f[0],i*(Math.random()-.5)+f[1])),a.pp=lt(a.p),a.edges=null}var r=null==t.friction?.6:t.friction,v=r;return{warmUp:function(){v=.8*r},setFixed:function(t){p[t].fixed=!0},setUnfixed:function(t){p[t].fixed=!1},step:function(t){for(var e=[],n=p.length,i=0;i<g.length;i++){var o,a=g[i];a.ignoreForceLayout||(l=a.n1,dt(e,(r=a.n2).p,l.p),s=pt(e)-a.d,o=r.w/(l.w+r.w),isNaN(o)&&(o=0),mt(e,e),l.fixed||Bw(l.p,l.p,e,o*s*v),r.fixed||Bw(r.p,r.p,e,-(1-o)*s*v))}for(i=0;i<n;i++){(c=p[i]).fixed||(dt(e,f,c.p),Bw(c.p,c.p,e,m*v))}for(i=0;i<n;i++)for(var r,s,l=p[i],h=i+1;h<n;h++){dt(e,(r=p[h]).p,l.p),0===(s=pt(e))&&(ht(e,Math.random()-.5,Math.random()-.5),s=1);var u=(l.rep+r.rep)/s/s;l.fixed||Bw(l.pp,l.pp,e,u),r.fixed||Bw(r.pp,r.pp,e,-u)}for(var c,d=[],i=0;i<n;i++){(c=p[i]).fixed||(dt(d,c.p,c.pp),Bw(c.p,c.p,d,v),st(c.pp,c.p))}v*=.992,t&&t(p,g,v<.01)}}}(l,h,{rect:u,gravity:n.get("gravity"),friction:n.get("friction")}),f=g.step,g.step=function(u){for(var t=0,e=l.length;t<e;t++)l[t].fixed&&st(l[t].p,d.getNodeByIndex(t).getLayout());f(function(t,e,n){for(var i=0,o=t.length;i<o;i++)t[i].fixed||d.getNodeByIndex(i).setLayout(t[i].p),c[p.getId(i)]=t[i].p;for(i=0,o=e.length;i<o;i++){var a=e[i],r=d.getEdgeByIndex(i),s=a.n1.p,l=a.n2.p,h=r.getLayout();(h=h?h.slice():[])[0]=h[0]||[],h[1]=h[1]||[],st(h[0],s),st(h[1],l),+a.curveness&&(h[2]=[(s[0]+l[0])/2-(s[1]-l[1])*a.curveness,(s[1]+l[1])/2-(l[0]-s[0])*a.curveness]),r.setLayout(h)}u&&u(n)})},t.forceLayout=g,t.preservedPoints=c,g.step()):t.forceLayout=null)})}),mp("graphView",{create:function(t,f){var m=[];return t.eachSeriesByType("graph",function(t){var n,e,i,o,a,r,s,l,h,u,c,d,p,g=t.get("coordinateSystem");g&&"view"!==g||(e=[],i=[],Ra((n=t.getData()).mapArray(function(t){var e=n.getItemModel(t);return[+e.get("x"),+e.get("y")]}),e,i),i[0]-e[0]==0&&(i[0]+=1,--e[0]),i[1]-e[1]==0&&(i[1]+=1,--e[1]),o=(i[0]-e[0])/(i[1]-e[1]),c=f,d=o,(p=t.getBoxLayoutParams()).aspect=d,a=fh(p,{width:c.getWidth(),height:c.getHeight()}),isNaN(o)&&(e=[a.x,a.y],i=[a.x+a.width,a.y+a.height]),r=i[0]-e[0],s=i[1]-e[1],l=a.width,h=a.height,(u=t.coordinateSystem=new ix).zoomLimit=t.get("scaleLimit"),u.setBoundingRect(e[0],e[1],r,s),u.setViewRect(a.x,a.y,l,h),u.setCenter(t.get("center")),u.setZoom(t.get("zoom")),m.push(u))}),m}});ec.extend({type:"series.gauge",getInitialData:function(t,e){return Wv(this,["value"])},defaultOption:{zlevel:0,z:2,center:["50%","50%"],legendHoverLink:!0,radius:"75%",startAngle:225,endAngle:-45,clockwise:!0,min:0,max:100,splitNumber:10,axisLine:{show:!0,lineStyle:{color:[[.2,"#91c7ae"],[.8,"#63869e"],[1,"#c23531"]],width:30}},splitLine:{show:!0,length:30,lineStyle:{color:"#eee",width:2,type:"solid"}},axisTick:{show:!0,splitNumber:5,length:8,lineStyle:{color:"#eee",width:1,type:"solid"}},axisLabel:{show:!0,distance:5,color:"auto"},pointer:{show:!0,length:"80%",width:8},itemStyle:{color:"auto"},title:{show:!0,offsetCenter:[0,"-40%"],color:"#333",fontSize:15},detail:{show:!0,backgroundColor:"rgba(0,0,0,0)",borderWidth:0,borderColor:"#ccc",width:100,height:null,padding:[5,10],offsetCenter:[0,"40%"],color:"auto",fontSize:30}}});var Vw=br.extend({type:"echartsGaugePointer",shape:{angle:0,width:10,r:10,x:0,y:0},buildPath:function(t,e){var n=Math.cos,i=Math.sin,o=e.r,a=e.width,r=e.angle,s=e.x-n(r)*a*(o/3<=a?1:2),l=e.y-i(r)*a*(o/3<=a?1:2),r=e.angle-Math.PI/2;t.moveTo(s,l),t.lineTo(e.x+n(r)*a,e.y+i(r)*a),t.lineTo(e.x+n(e.angle)*o,e.y+i(e.angle)*o),t.lineTo(e.x-n(r)*a,e.y-i(r)*a),t.lineTo(s,l)}});function Gw(t,e){return e&&("string"==typeof e?t=e.replace("{value}",null!=t?t:""):"function"==typeof e&&(t=e(t))),t}var Fw=2*Math.PI,Ww=(gc.extend({type:"gauge",render:function(t,e,n){this.group.removeAll();var i,o,a,r,s,l,h=t.get("axisLine.lineStyle.color"),u=(o=n,a=(i=t).get("center"),r=o.getWidth(),s=o.getHeight(),l=Math.min(r,s),{cx:Ll(a[0],o.getWidth()),cy:Ll(a[1],o.getHeight()),r:Ll(i.get("radius"),l/2)});this._renderMain(t,e,n,h,u)},dispose:function(){},_renderMain:function(t,e,n,i,o){for(var a=this.group,r=t.getModel("axisLine"),s=r.getModel("lineStyle"),l=t.get("clockwise"),h=-t.get("startAngle")/180*Math.PI,u=((f=-t.get("endAngle")/180*Math.PI)-h)%Fw,c=h,d=s.get("width"),p=r.get("show"),g=0;p&&g<i.length;g++){var f,m=Math.min(Math.max(i[g][0],0),1),v=new Zr({shape:{startAngle:c,endAngle:f=h+u*m,cx:o.cx,cy:o.cy,clockwise:l,r0:o.r-d,r:o.r},silent:!0});v.setStyle({fill:i[g][1]}),v.setStyle(s.getLineStyle(["color","borderWidth","borderColor"])),a.add(v),c=f}function y(t){if(t<=0)return i[0][1];for(var e=0;e<i.length;e++)if(i[e][0]>=t&&(0===e?0:i[e-1][0])<t)return i[e][1];return i[e-1][1]}var x;l||(x=h,h=f,f=x),this._renderTicks(t,e,n,y,o,h,f,l),this._renderPointer(t,e,n,y,o,h,f,l),this._renderTitle(t,e,n,y,o),this._renderDetail(t,e,n,y,o)},_renderTicks:function(t,e,n,i,o,a,r,s){for(var l=this.group,h=o.cx,u=o.cy,c=o.r,d=+t.get("min"),p=+t.get("max"),g=t.getModel("splitLine"),f=t.getModel("axisTick"),m=t.getModel("axisLabel"),v=t.get("splitNumber"),y=f.get("splitNumber"),x=Ll(g.get("length"),c),_=Ll(f.get("length"),c),w=a,b=(r-a)/v,S=b/y,M=g.getModel("lineStyle").getLineStyle(),I=f.getModel("lineStyle").getLineStyle(),T=0;T<=v;T++){var A,D,C,L,k=Math.cos(w),P=Math.sin(w);if(g.get("show")&&(A=new is({shape:{x1:k*c+h,y1:P*c+u,x2:k*(c-x)+h,y2:P*(c-x)+u},style:M,silent:!0}),"auto"===M.stroke&&A.setStyle({stroke:i(T/v)}),l.add(A)),m.get("show")&&(D=Gw(kl(T/v*(p-d)+d),m.get("formatter")),C=m.get("distance"),L=i(T/v),l.add(new Gr({style:Js({},m,{text:D,x:k*(c-x-C)+h,y:P*(c-x-C)+u,textVerticalAlign:P<-.4?"top":.4<P?"bottom":"middle",textAlign:k<-.4?"left":.4<k?"right":"center"},{autoColor:L}),silent:!0}))),f.get("show")&&T!==v){for(var N=0;N<=y;N++){var k=Math.cos(w),P=Math.sin(w),O=new is({shape:{x1:k*c+h,y1:P*c+u,x2:k*(c-_)+h,y2:P*(c-_)+u},silent:!0,style:I});"auto"===I.stroke&&O.setStyle({stroke:i((T+N/y)/v)}),l.add(O),w+=S}w-=S}else w+=b}},_renderPointer:function(i,t,e,o,a,n,r,s){var l,h,u,c,d=this.group,p=this._data;i.get("pointer.show")?(l=[+i.get("min"),+i.get("max")],h=[n,r],u=i.getData(),c=u.mapDimension("value"),u.diff(p).add(function(t){var e=new Vw({shape:{angle:n}});sl(e,{shape:{angle:Cl(u.get(c,t),l,h,!0)}},i),d.add(e),u.setItemGraphicEl(t,e)}).update(function(t,e){var n=p.getItemGraphicEl(e);rl(n,{shape:{angle:Cl(u.get(c,t),l,h,!0)}},i),d.add(n),u.setItemGraphicEl(t,n)}).remove(function(t){var e=p.getItemGraphicEl(t);d.remove(e)}).execute(),u.eachItemGraphicEl(function(t,e){var n=u.getItemModel(e),i=n.getModel("pointer");t.setShape({x:a.cx,y:a.cy,width:Ll(i.get("width"),a.r),r:Ll(i.get("length"),a.r)}),t.useStyle(n.getModel("itemStyle").getItemStyle()),"auto"===t.style.fill&&t.setStyle("fill",o(Cl(u.get(c,e),l,[0,1],!0))),Xs(t,n.getModel("emphasis.itemStyle").getItemStyle())}),this._data=u):p&&p.eachItemGraphicEl(function(t){d.remove(t)})},_renderTitle:function(t,e,n,i,o){var a,r,s,l,h,u,c=t.getData(),d=c.mapDimension("value"),p=t.getModel("title");p.get("show")&&(a=p.get("offsetCenter"),r=o.cx+Ll(a[0],o.r),s=o.cy+Ll(a[1],o.r),l=+t.get("min"),h=+t.get("max"),u=i(Cl(t.getData().get(d,0),[l,h],[0,1],!0)),this.group.add(new Gr({silent:!0,style:Js({},p,{x:r,y:s,text:c.getName(0),textAlign:"center",textVerticalAlign:"middle"},{autoColor:u,forceRich:!0})})))},_renderDetail:function(t,e,n,i,o){var a,r,s,l,h,u,c,d,p=t.getModel("detail"),g=+t.get("min"),f=+t.get("max");p.get("show")&&(a=p.get("offsetCenter"),r=o.cx+Ll(a[0],o.r),s=o.cy+Ll(a[1],o.r),l=Ll(p.get("width"),o.r),h=Ll(p.get("height"),o.r),d=i(Cl(c=(u=t.getData()).get(u.mapDimension("value"),0),[g,f],[0,1],!0)),this.group.add(new Gr({silent:!0,style:Js({},p,{x:r,y:s,text:Gw(c,p.get("formatter")),textWidth:isNaN(l)?null:l,textHeight:isNaN(h)?null:h,textAlign:"center",textVerticalAlign:"middle"},{autoColor:d,forceRich:!0})})))}}),Sp({type:"series.funnel",init:function(t){Ww.superApply(this,"init",arguments),this.legendVisualProvider=new Zv(E(this.getData,this),E(this.getRawData,this)),this._defaultLabelLine(t)},getInitialData:function(t,e){return Wv(this,{coordDimensions:["value"],encodeDefaulter:z(Uh,this)})},_defaultLabelLine:function(t){Eo(t,"labelLine",["show"]);var e=t.labelLine,n=t.emphasis.labelLine;e.show=e.show&&t.label.show,n.show=n.show&&t.emphasis.label.show},getDataParams:function(t){var e=this.getData(),n=Ww.superCall(this,"getDataParams",t),i=e.mapDimension("value"),o=e.getSum(i);return n.percent=o?+(e.get(i,t)/o*100).toFixed(2):0,n.$vars.push("percent"),n},defaultOption:{zlevel:0,z:2,legendHoverLink:!0,left:80,top:60,right:80,bottom:60,minSize:"0%",maxSize:"100%",sort:"descending",gap:0,funnelAlign:"center",label:{show:!0,position:"outer"},labelLine:{show:!0,length:20,lineStyle:{width:1,type:"solid"}},itemStyle:{borderColor:"#fff",borderWidth:1},emphasis:{label:{show:!0}}}}));function Hw(t,e){Mn.call(this);var n=new jr,i=new qr,o=new Gr;this.add(n),this.add(i),this.add(o),this.highDownOnUpdate=function(t,e){"emphasis"===e?(i.ignore=i.hoverIgnore,o.ignore=o.hoverIgnore):(i.ignore=i.normalIgnore,o.ignore=o.normalIgnore)},this.updateData(t,e,!0)}var Zw=Hw.prototype,Uw=["itemStyle","opacity"];Zw.updateData=function(t,e,n){var i=this.childAt(0),o=t.hostModel,a=t.getItemModel(e),r=t.getItemLayout(e),s=null==(s=t.getItemModel(e).get(Uw))?1:s;i.useStyle({}),n?(i.setShape({points:r.points}),i.setStyle({opacity:0}),sl(i,{style:{opacity:s}},o,e)):rl(i,{style:{opacity:s},shape:{points:r.points}},o,e);var l=a.getModel("itemStyle"),h=t.getItemVisual(e,"color");i.setStyle(L({lineJoin:"round",fill:h},l.getItemStyle(["opacity"]))),i.hoverStyle=l.getModel("emphasis").getItemStyle(),this._updateLabel(t,e),Xs(this)},Zw._updateLabel=function(t,e){var n=this.childAt(1),i=this.childAt(2),o=t.hostModel,a=t.getItemModel(e),r=t.getItemLayout(e).label,s=t.getItemVisual(e,"color");rl(n,{shape:{points:r.linePoints||r.linePoints}},o,e),rl(i,{style:{x:r.x,y:r.y}},o,e),i.attr({rotation:r.rotation,origin:[r.x,r.y],z2:10});var l=a.getModel("label"),h=a.getModel("emphasis.label"),u=a.getModel("labelLine"),c=a.getModel("emphasis.labelLine"),s=t.getItemVisual(e,"color");Ks(i.style,i.hoverStyle={},l,h,{labelFetcher:t.hostModel,labelDataIndex:e,defaultText:t.getName(e),autoColor:s,useInsideStyle:!!r.inside},{textAlign:r.textAlign,textVerticalAlign:r.verticalAlign}),i.ignore=i.normalIgnore=!l.get("show"),i.hoverIgnore=!h.get("show"),n.ignore=n.normalIgnore=!u.get("show"),n.hoverIgnore=!c.get("show"),n.setStyle({stroke:s}),n.setStyle(u.getModel("lineStyle").getLineStyle()),n.hoverStyle=c.getModel("lineStyle").getLineStyle()},w(Hw,Mn);gc.extend({type:"funnel",render:function(t,e,n){var i=t.getData(),o=this._data,a=this.group;i.diff(o).add(function(t){var e=new Hw(i,t);i.setItemGraphicEl(t,e),a.add(e)}).update(function(t,e){var n=o.getItemGraphicEl(e);n.updateData(i,t),a.add(n),i.setItemGraphicEl(t,n)}).remove(function(t){var e=o.getItemGraphicEl(t);a.remove(e)}).execute(),this._data=i},remove:function(){this.group.removeAll(),this._data=null},dispose:function(){}});yp($v("funnel")),vp(function(t,S,e){t.eachSeriesByType("funnel",function(t){var e,o=t.getData(),a=o.mapDimension("value"),n=t.get("sort"),r=(e=S,fh(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()})),i=function(t,e){for(var n=t.mapDimension("value"),i=t.mapArray(n,function(t){return t}),o=[],a="ascending"===e,r=0,s=t.count();r<s;r++)o[r]=r;return"function"==typeof e?o.sort(e):"none"!==e&&o.sort(function(t,e){return a?i[t]-i[e]:i[e]-i[t]}),o}(o,n),s=[Ll(t.get("minSize"),r.width),Ll(t.get("maxSize"),r.width)],l=o.getDataExtent(a),h=t.get("min"),u=t.get("max");null==h&&(h=Math.min(l[0],0)),null==u&&(u=l[1]);function c(t,e){var n,i=Cl(o.get(a,t)||0,[h,u],s,!0);switch(d){case"left":n=r.x;break;case"center":n=r.x+(r.width-i)/2;break;case"right":n=r.x+r.width-i}return[[n,e],[n+i,e]]}var d=t.get("funnelAlign"),p=t.get("gap"),g=(r.height-p*(o.count()-1))/o.count(),f=r.y;"ascending"===n&&(g=-g,p=-p,f+=r.height,i=i.reverse());for(var m,v=0;v<i.length;v++){var y=i[v],x=i[v+1],_=o.getItemModel(y).get("itemStyle.height");null==_?_=g:(_=Ll(_,r.height),"ascending"===n&&(_=-_));var w=c(y,f),b=c(x,f+_);f+=_+p,o.setItemLayout(y,{points:w.concat(b.slice().reverse())})}(m=o).each(function(t){var e,n,i,o,a,r,s,l,h=m.getItemModel(t),u=h.getModel("label").get("position"),c=h.getModel("labelLine"),d=m.getItemLayout(t),p=d.points,g="inner"===u||"inside"===u||"center"===u||"insideLeft"===u||"insideRight"===u;g?(r="insideLeft"===u?(e=(p[0][0]+p[3][0])/2+5,l=(p[0][1]+p[3][1])/2,"left"):"insideRight"===u?(e=(p[1][0]+p[2][0])/2-5,l=(p[1][1]+p[2][1])/2,"right"):(e=(p[0][0]+p[1][0]+p[2][0]+p[3][0])/4,l=(p[0][1]+p[1][1]+p[2][1]+p[3][1])/4,"center"),s=[[e,l],[e,l]]):(a=c.get("length"),r="left"===u?(n=(p[3][0]+p[0][0])/2,i=(p[3][1]+p[0][1])/2,e=(o=n-a)-5,"right"):"right"===u?(n=(p[1][0]+p[2][0])/2,i=(p[1][1]+p[2][1])/2,e=(o=n+a)+5,"left"):"rightTop"===u?(n=p[1][0],i=p[1][1],e=(o=n+a)+5,"top"):"rightBottom"===u?(n=p[2][0],i=p[2][1],e=(o=n+a)+5,"bottom"):"leftTop"===u?(n=p[0][0],i=p[1][1],e=(o=n-a)-5,"right"):"leftBottom"===u?(n=p[3][0],i=p[2][1],e=(o=n-a)-5,"right"):(n=(p[1][0]+p[2][0])/2,i=(p[1][1]+p[2][1])/2,e=(o=n+a)+5,"left"),s=[[n,i],[o,i]],l=i),d.label={linePoints:s,x:e,y:l,verticalAlign:"middle",textAlign:r,inside:g}})})}),gp(oy("funnel"));function Xw(t,e,n,i,o){Bf.call(this,t,e,n),this.type=i||"value",this.axisIndex=o}Xw.prototype={constructor:Xw,model:null,isHorizontal:function(){return"horizontal"!==this.coordinateSystem.getModel().get("layout")}},w(Xw,Bf);function Yw(t,e,n,i,o,a){t=t||0;var r,s=n[1]-n[0];null!=o&&(o=qw(o,[0,s])),null!=a&&(a=Math.max(a,null!=o?o:0)),"all"===i&&(r=qw(r=Math.abs(e[1]-e[0]),[0,s]),o=a=qw(r,[o,a]),i=0),e[0]=qw(e[0],n),e[1]=qw(e[1],n);var l=jw(e,i);e[i]+=t;var h=o||0,u=n.slice();l.sign<0?u[0]+=h:u[1]-=h,e[i]=qw(e[i],u);var c=jw(e,i);return null!=o&&(c.sign!==l.sign||c.span<o)&&(e[1-i]=e[i]+l.sign*o),c=jw(e,i),null!=a&&c.span>a&&(e[1-i]=e[i]+c.sign*a),e}function jw(t,e){var n=t[e]-t[1-e];return{span:Math.abs(n),sign:0<n||!(n<0)&&e?-1:1}}function qw(t,e){return Math.min(null!=e[1]?e[1]:1/0,Math.max(null!=e[0]?e[0]:-1/0,t))}var Kw=P,$w=Math.min,Jw=Math.max,Qw=Math.floor,tb=Math.ceil,eb=kl,nb=Math.PI;function ib(t,e,n){this._axesMap=et(),this._axesLayout={},this.dimensions=t.dimensions,this._rect,this._model=t,this._init(t,e,n)}function ob(t,e){return $w(Jw(t,e[0]),e[1])}ib.prototype={type:"parallel",constructor:ib,_init:function(t,r,e){var n=t.dimensions,s=t.parallelAxisIndex;Kw(n,function(t,e){var n=s[e],i=r.getComponent("parallelAxis",n),o=this._axesMap.set(t,new Xw(t,af(i),[0,0],i.get("type"),n)),a="category"===o.type;o.onBand=a&&i.get("boundaryGap"),o.inverse=i.get("inverse"),(i.axis=o).model=i,o.coordinateSystem=i.coordinateSystem=this},this)},update:function(t,e){this._updateAxesFromSeries(this._model,t)},containPoint:function(t){var e=this._makeLayoutInfo(),n=e.axisBase,i=e.layoutBase,o=e.pixelDimIndex,a=t[1-o],r=t[o];return n<=a&&a<=n+e.axisLength&&i<=r&&r<=i+e.layoutLength},getModel:function(){return this._model},_updateAxesFromSeries:function(e,i){i.eachSeries(function(t){var n;e.contains(t,i)&&(n=t.getData(),Kw(this.dimensions,function(t){var e=this._axesMap.get(t);e.scale.unionExtentFromData(n,n.mapDimension(t)),of(e.scale,e.model)},this))},this)},resize:function(t,e){this._rect=fh(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()}),this._layoutAxes()},getRect:function(){return this._rect},_makeLayoutInfo:function(){var t,e=this._model,n=this._rect,i=["x","y"],o=["width","height"],a=e.get("layout"),r="horizontal"===a?0:1,s=n[o[r]],l=[0,s],h=this.dimensions.length,u=ob(e.get("axisExpandWidth"),l),c=ob(e.get("axisExpandCount")||0,[0,h]),d=e.get("axisExpandable")&&3<h&&c<h&&1<c&&0<u&&0<s,p=e.get("axisExpandWindow");p?(t=ob(p[1]-p[0],l),p[1]=p[0]+t):(t=ob(u*(c-1),l),(p=[u*(e.get("axisExpandCenter")||Qw(h/2))-t/2])[1]=p[0]+t);var g=(s-t)/(h-c);g<3&&(g=0);var f=[Qw(eb(p[0]/u,1))+1,tb(eb(p[1]/u,1))-1],m=g/u*p[0];return{layout:a,pixelDimIndex:r,layoutBase:n[i[r]],layoutLength:s,axisBase:n[i[1-r]],axisLength:n[o[1-r]],axisExpandable:d,axisExpandWidth:u,axisCollapseWidth:g,axisExpandWindow:p,axisCount:h,winInnerIndices:f,axisExpandWindow0Pos:m}},_layoutAxes:function(){var l=this._rect,t=this._axesMap,e=this.dimensions,h=this._makeLayoutInfo(),u=h.layout;t.each(function(t){var e=[0,h.axisLength],n=t.inverse?1:0;t.setExtent(e[n],e[1-n])}),Kw(e,function(t,e){var n=(h.axisExpandable?function(t,e){var n,i,o=e.layoutLength,a=e.axisExpandWidth,r=e.axisCount,s=e.axisCollapseWidth,l=e.winInnerIndices,h=s,u=!1;t<l[0]?(n=t*s,i=s):t<=l[1]?(n=e.axisExpandWindow0Pos+t*a-e.axisExpandWindow[0],h=a,u=!0):(n=o-(r-1-t)*s,i=s);return{position:n,axisNameAvailableWidth:h,axisLabelShow:u,nameTruncateMaxWidth:i}}:function(t,e){var n=e.layoutLength/(e.axisCount-1);return{position:n*t,axisNameAvailableWidth:n,axisLabelShow:!0}})(e,h),i={horizontal:{x:n.position,y:h.axisLength},vertical:{x:0,y:n.position}},o={horizontal:nb/2,vertical:0},a=[i[u].x+l.x,i[u].y+l.y],r=o[u],s=ee();re(s,s,r),ae(s,s,a),this._axesLayout[t]={position:a,rotation:r,transform:s,axisNameAvailableWidth:n.axisNameAvailableWidth,axisLabelShow:n.axisLabelShow,nameTruncateMaxWidth:n.nameTruncateMaxWidth,tickDirection:1,labelDirection:1}},this)},getAxis:function(t){return this._axesMap.get(t)},dataToPoint:function(t,e){return this.axisCoordToPoint(this._axesMap.get(e).dataToCoord(t),e)},eachActiveState:function(e,t,n,i){null==n&&(n=0),null==i&&(i=e.count());var o=this._axesMap,a=this.dimensions,r=[],s=[];P(a,function(t){r.push(e.mapDimension(t)),s.push(o.get(t).model)});for(var l,h=this.hasAxisBrushed(),u=n;u<i;u++){if(h){l="active";for(var c=e.getValues(r,u),d=0,p=a.length;d<p;d++){if("inactive"===s[d].getActiveState(c[d])){l="inactive";break}}}else l="normal";t(l,u)}},hasAxisBrushed:function(){for(var t=this.dimensions,e=this._axesMap,n=!1,i=0,o=t.length;i<o;i++)"normal"!==e.get(t[i]).model.getActiveState()&&(n=!0);return n},axisCoordToPoint:function(t,e){return hl([t,0],this._axesLayout[e].transform)},getAxisLayout:function(t){return C(this._axesLayout[t])},getSlidedAxisExpandWindow:function(t){var e=this._makeLayoutInfo(),n=e.pixelDimIndex,i=e.axisExpandWindow.slice(),o=i[1]-i[0],a=[0,e.axisExpandWidth*(e.axisCount-1)];if(!this.containPoint(t))return{behavior:"none",axisExpandWindow:i};var r,s=t[n]-e.layoutBase-e.axisExpandWindow0Pos,l="slide",h=e.axisCollapseWidth,u=this._model.get("axisExpandSlideTriggerArea"),c=null!=u[0];return h?(c&&h&&s<o*u[0]?(l="jump",r=s-o*u[2]):c&&h&&s>o*(1-u[0])?(l="jump",r=s-o*(1-u[2])):0<=(r=s-o*u[1])&&(r=s-o*(1-u[1]))<=0&&(r=0),(r*=e.axisExpandWidth/h)?Yw(r,i,a,"all"):l="none"):(o=i[1]-i[0],(i=[Jw(0,a[1]*s/o-o/2)])[1]=$w(a[1],i[0]+o),i[0]=i[1]-o),{axisExpandWindow:i,behavior:l}}},nu.register("parallel",{create:function(i,o){var a=[];return i.eachComponent("parallel",function(t,e){var n=new ib(t,i,o);n.name="parallel_"+e,n.resize(t,o),(t.coordinateSystem=n).model=t,a.push(n)}),i.eachSeries(function(t){var e;"parallel"===t.get("coordinateSystem")&&(e=i.queryComponents({mainType:"parallel",index:t.get("parallelIndex"),id:t.get("parallelId")})[0],t.coordinateSystem=e.coordinateSystem)}),a}});var ab=Mh.extend({type:"baseParallelAxis",axis:null,activeIntervals:[],getAreaSelectStyle:function(){return aa([["fill","color"],["lineWidth","borderWidth"],["stroke","borderColor"],["width","width"],["opacity","opacity"]])(this.getModel("areaSelectStyle"))},setActiveIntervals:function(t){var e=this.activeIntervals=C(t);if(e)for(var n=e.length-1;0<=n;n--)Pl(e[n])},getActiveState:function(t){var e=this.activeIntervals;if(!e.length)return"normal";if(null==t||isNaN(t))return"inactive";if(1===e.length){var n=e[0];if(n[0]<=t&&t<=n[1])return"active"}else for(var i=0,o=e.length;i<o;i++)if(e[i][0]<=t&&t<=e[i][1])return"active";return"inactive"}});m(ab.prototype,uf),Bm("parallel",ab,function(t,e){return e.type||(e.data?"category":"value")},{type:"value",dim:null,areaSelectStyle:{width:20,borderWidth:1,borderColor:"rgba(160,197,232)",color:"rgba(160,197,232)",opacity:.3},realtime:!0,z:10}),Mh.extend({type:"parallel",dependencies:["parallelAxis"],coordinateSystem:null,dimensions:null,parallelAxisIndex:null,layoutMode:"box",defaultOption:{zlevel:0,z:0,left:80,top:60,right:80,bottom:60,layout:"horizontal",axisExpandable:!1,axisExpandCenter:null,axisExpandCount:0,axisExpandWidth:50,axisExpandRate:17,axisExpandDebounce:50,axisExpandSlideTriggerArea:[-.15,.05,.4],axisExpandTriggerOn:"click",parallelAxisDefault:null},init:function(){Mh.prototype.init.apply(this,arguments),this.mergeOption({})},mergeOption:function(t){var e=this.option;t&&m(e,t,!0),this._initDimensions()},contains:function(t,e){var n=t.get("parallelIndex");return null!=n&&e.getComponent("parallel",n)===this},setAxisExpand:function(e){P(["axisExpandable","axisExpandCenter","axisExpandCount","axisExpandWidth","axisExpandWindow"],function(t){e.hasOwnProperty(t)&&(this.option[t]=e[t])},this)},_initDimensions:function(){var e=this.dimensions=[],n=this.parallelAxisIndex=[];P(I(this.dependentModels.parallelAxis,function(t){return(t.get("parallelIndex")||0)===this.componentIndex},this),function(t){e.push("dim"+t.get("dim")),n.push(t.componentIndex)})}});fp({type:"axisAreaSelect",event:"axisAreaSelected"},function(e,t){t.eachComponent({mainType:"parallelAxis",query:e},function(t){t.axis.model.setActiveIntervals(e.intervals)})}),fp("parallelAxisExpand",function(e,t){t.eachComponent({mainType:"parallel",query:e},function(t){t.setAxisExpand(e)})});var rb=z,sb=P,lb=N,hb=Math.min,ub=Math.max,cb=Math.pow,db=1e4,pb=6,gb=6,fb="globalPan",mb={w:[0,0],e:[0,1],n:[1,0],s:[1,1]},vb={w:"ew",e:"ew",n:"ns",s:"ns",ne:"nesw",sw:"nesw",nw:"nwse",se:"nwse"},yb={brushStyle:{lineWidth:2,stroke:"rgba(0,0,0,0.3)",fill:"rgba(0,0,0,0.1)"},transformable:!0,brushMode:"single",removeOnClick:!1},xb=0;function _b(t){D&&q(t),Ct.call(this),this._zr=t,this.group=new Mn,this._brushType,this._brushOption,this._panels,this._track=[],this._dragging,this._covers=[],this._creatingCover,this._creatingPanel,this._enableGlobalPan,D&&this._mounted,this._uid="brushController_"+xb++,this._handlers={},sb(Xb,function(t,e){this._handlers[e]=E(t,this)},this)}function wb(t,e){var n=jb[e.brushType].createCover(t,e);return n.__brushOption=e,Mb(n,e),t.group.add(n),n}function bb(t,e){var n=Tb(e);return n.endCreating&&(n.endCreating(t,e),Mb(e,e.__brushOption)),e}function Sb(t,e){var n=e.__brushOption;Tb(e).updateCoverShape(t,e,n.range,n)}function Mb(t,e){var n=e.z;null==n&&(n=db),t.traverse(function(t){t.z=n,t.z2=n})}function Ib(t,e){Tb(e).updateCommon(t,e),Sb(t,e)}function Tb(t){return jb[t.__brushOption.brushType]}function Ab(t,e,n){var i,o=t._panels;if(!o)return!0;var a=t._transform;return sb(o,function(t){t.isTargetByCursor(e,n,a)&&(i=t)}),i}function Db(t,e){var n=t._panels;if(!n)return!0;var i=e.__brushOption.panelId;return null==i||n[i]}function Cb(e){var t=e._covers,n=t.length;return sb(t,function(t){e.group.remove(t)},e),t.length=0,n}function Lb(t,e){var n=lb(t._covers,function(t){var e=t.__brushOption,n=C(e.range);return{brushType:e.brushType,panelId:e.panelId,range:n}});t.trigger("brush",n,{isEnd:!!e.isEnd,removeOnClick:!!e.removeOnClick})}function kb(t){var e=t.length-1;return e<0&&(e=0),[t[0],t[e]]}function Pb(e,n,t,i){var o=new Mn;return o.add(new es({name:"main",style:zb(t),silent:!0,draggable:!0,cursor:"move",drift:rb(e,n,o,"nswe"),ondragend:rb(Lb,n,{isEnd:!0})})),sb(i,function(t){o.add(new es({name:t,style:{opacity:0},draggable:!0,silent:!0,invisible:!0,drift:rb(e,n,o,t),ondragend:rb(Lb,n,{isEnd:!0})}))}),o}function Nb(t,e,n,i){var o=i.brushStyle.lineWidth||0,a=ub(o,gb),r=n[0][0],s=n[1][0],l=r-o/2,h=s-o/2,u=n[0][1],c=n[1][1],d=u-a+o/2,p=c-a+o/2,g=u-r,f=c-s,m=g+o,v=f+o;Eb(t,e,"main",r,s,g,f),i.transformable&&(Eb(t,e,"w",l,h,a,v),Eb(t,e,"e",d,h,a,v),Eb(t,e,"n",l,h,m,a),Eb(t,e,"s",l,p,m,a),Eb(t,e,"nw",l,h,a,a),Eb(t,e,"ne",d,h,a,a),Eb(t,e,"sw",l,p,a,a),Eb(t,e,"se",d,p,a,a))}function Ob(i,o){var t=o.__brushOption,a=t.transformable,e=o.childAt(0);e.useStyle(zb(t)),e.attr({silent:!a,cursor:a?"move":"default"}),sb(["w","e","n","s","se","sw","ne","nw"],function(t){var e=o.childOfName(t),n=function t(e,n){{if(1<n.length){n=n.split("");var i=[t(e,n[0]),t(e,n[1])];return"e"!==i[0]&&"w"!==i[0]||i.reverse(),i.join("")}var o={w:"left",e:"right",n:"top",s:"bottom"},a={left:"w",right:"e",top:"n",bottom:"s"},i=ul(o[n],ll(e.group));return a[i]}}(i,t);e&&e.attr({silent:!a,invisible:!a,cursor:a?vb[n]+"-resize":null})})}function Eb(t,e,n,i,o,a,r){var s,l,h,u,c,d=e.childOfName(n);d&&d.setShape((s=Fb(t,e,[[i,o],[i+a,o+r]]),l=hb(s[0][0],s[1][0]),h=hb(s[0][1],s[1][1]),u=ub(s[0][0],s[1][0]),c=ub(s[0][1],s[1][1]),{x:l,y:h,width:u-l,height:c-h}))}function zb(t){return L({strokeNoScale:!0},t.brushStyle)}function Rb(t,e,n,i){var o=[hb(t,n),hb(e,i)],a=[ub(t,n),ub(e,i)];return[[o[0],a[0]],[o[1],a[1]]]}function Bb(t,e,n,i,o,a,r,s){var l=i.__brushOption,h=t(l.range),u=Gb(n,a,r);sb(o.split(""),function(t){var e=mb[t];h[e[0]][e[1]]+=u[e[0]]}),l.range=e(Rb(h[0][0],h[1][0],h[0][1],h[1][1])),Ib(n,i),Lb(n,{isEnd:!1})}function Vb(t,e,n,i,o){var a=e.__brushOption.range,r=Gb(t,n,i);sb(a,function(t){t[0]+=r[0],t[1]+=r[1]}),Ib(t,e),Lb(t,{isEnd:!1})}function Gb(t,e,n){var i=t.group,o=i.transformCoordToLocal(e,n),a=i.transformCoordToLocal(0,0);return[o[0]-a[0],o[1]-a[1]]}function Fb(t,e,n){var i=Db(t,e);return i&&!0!==i?i.clipPath(n,t._transform):C(n)}function Wb(t){var e=t.event;e.preventDefault&&e.preventDefault()}function Hb(t,e,n){return t.childOfName("main").contain(e,n)}function Zb(t,e,n,i){var o,a,r,s=t._creatingCover,l=t._creatingPanel,h=t._brushOption;return t._track.push(n.slice()),function(t){var e=t._track;if(e.length){var n=e[e.length-1],i=e[0],o=n[0]-i[0],a=n[1]-i[1],r=cb(o*o+a*a,.5);return pb<r}}(t)||s?(l&&!s&&("single"===h.brushMode&&Cb(t),(a=C(h)).brushType=Ub(a.brushType,l),a.panelId=!0===l?null:l.panelId,s=t._creatingCover=wb(t,a),t._covers.push(s)),s&&(r=jb[Ub(t._brushType,l)],s.__brushOption.range=r.getCreatingRange(Fb(t,s,t._track)),i&&(bb(t,s),r.updateCommon(t,s)),Sb(t,s),o={isEnd:i})):i&&"single"===h.brushMode&&h.removeOnClick&&Ab(t,e,n)&&Cb(t)&&(o={isEnd:i,removeOnClick:!0}),o}function Ub(t,e){return"auto"===t?(D&&q(e&&e.defaultBrushType,'MUST have defaultBrushType when brushType is "atuo"'),e.defaultBrushType):t}_b.prototype={constructor:_b,enableBrush:function(t){var e,n;return D&&q(this._mounted),this._brushType&&(function(t,e,n){var i=Ny(t);i[e]===n&&(i[e]=null)}(n=(e=this)._zr,fb,e._uid),function(n,t){sb(t,function(t,e){n.off(e,t)})}(n,e._handlers),e._brushType=e._brushOption=null),t.brushType&&function(t,e){var n=t._zr;t._enableGlobalPan||function(t,e,n){Ny(t)[e]=n}(n,fb,t._uid);(function(n,t){sb(t,function(t,e){n.on(e,t)})})(n,t._handlers),t._brushType=e.brushType,t._brushOption=m(C(yb),e,!0)}(this,t),this},setPanels:function(t){var e;return t&&t.length?(e=this._panels={},P(t,function(t){e[t.panelId]=C(t)})):this._panels=null,this},mount:function(t){t=t||{},D&&(this._mounted=!0),this._enableGlobalPan=t.enableGlobalPan;var e=this.group;return this._zr.add(e),e.attr({position:t.position||[0,0],rotation:t.rotation||0,scale:t.scale||[1,1]}),this._transform=e.getLocalTransform(),this},eachCover:function(t,e){sb(this._covers,t,e)},updateCovers:function(o){D&&q(this._mounted),o=N(o,function(t){return m(C(yb),t,!0)});var n="\0-brush-index-",a=this._covers,r=this._covers=[],s=this,l=this._creatingCover;return new Tp(a,o,function(t,e){return i(t.__brushOption,e)},i).add(t).update(t).remove(function(t){a[t]!==l&&s.group.remove(a[t])}).execute(),this;function i(t,e){return(null!=t.id?t.id:n+e)+"-"+t.brushType}function t(t,e){var n,i=o[t];null!=e&&a[e]===l?r[t]=a[e]:(n=r[t]=null!=e?(a[e].__brushOption=i,a[e]):bb(s,wb(s,i)),Ib(s,n))}},unmount:function(){if(!D||this._mounted)return this.enableBrush(!1),Cb(this),this._zr.remove(this.group),D&&(this._mounted=!1),this},dispose:function(){this.unmount(),this.off()}},b(_b,Ct);var Xb={mousedown:function(t){var e;this._dragging?Yb(this,t):t.target&&t.target.draggable||(Wb(t),e=this.group.transformCoordToLocal(t.offsetX,t.offsetY),this._creatingCover=null,(this._creatingPanel=Ab(this,t,e))&&(this._dragging=!0,this._track=[e.slice()]))},mousemove:function(t){var e,n=t.offsetX,i=t.offsetY,o=this.group.transformCoordToLocal(n,i);!function(t,e,n){if(t._brushType&&(i=e,a=t._zr,!(i<0||i>a.getWidth()||o<0||o>a.getHeight()))){var i,o,a,r=t._zr,s=t._covers,l=Ab(t,e,n);if(!t._dragging)for(var h=0;h<s.length;h++){var u=s[h].__brushOption;if(l&&(!0===l||u.panelId===l.panelId)&&jb[u.brushType].contain(s[h],n[0],n[1]))return}l&&r.setCursorStyle("crosshair")}}(this,t,o),this._dragging&&(Wb(t),(e=Zb(this,t,o,!1))&&Lb(this,e))},mouseup:function(t){Yb(this,t)}};function Yb(t,e){var n,i,o,a;t._dragging&&(Wb(e),n=e.offsetX,i=e.offsetY,o=t.group.transformCoordToLocal(n,i),a=Zb(t,e,o,!0),t._dragging=!1,t._track=[],t._creatingCover=null,a&&Lb(t,a))}var jb={lineX:qb(0),lineY:qb(1),rect:{createCover:function(t,e){return Pb(rb(Bb,function(t){return t},function(t){return t}),t,e,["w","e","n","s","se","sw","ne","nw"])},getCreatingRange:function(t){var e=kb(t);return Rb(e[1][0],e[1][1],e[0][0],e[0][1])},updateCoverShape:function(t,e,n,i){Nb(t,e,n,i)},updateCommon:Ob,contain:Hb},polygon:{createCover:function(t,e){var n=new Mn;return n.add(new qr({name:"main",style:zb(e),silent:!0})),n},getCreatingRange:function(t){return t},endCreating:function(t,e){e.remove(e.childAt(0)),e.add(new jr({name:"main",draggable:!0,drift:rb(Vb,t,e),ondragend:rb(Lb,t,{isEnd:!0})}))},updateCoverShape:function(t,e,n,i){e.childAt(0).setShape({points:Fb(t,e,n)})},updateCommon:Ob,contain:Hb}};function qb(s){return{createCover:function(t,e){return Pb(rb(Bb,function(t){var e=[t,[0,100]];return s&&e.reverse(),e},function(t){return t[s]}),t,e,[["w","e"],["n","s"]][s])},getCreatingRange:function(t){var e=kb(t);return[hb(e[0][s],e[1][s]),ub(e[0][s],e[1][s])]},updateCoverShape:function(t,e,n,i){var o,a=Db(t,e),r=[n,!0!==a&&a.getLinearBrushOtherExtent?a.getLinearBrushOtherExtent(s,t._transform):[0,[(o=t._zr).getWidth(),o.getHeight()][1-s]]];s&&r.reverse(),Nb(t,e,r,i)},updateCommon:Ob,contain:Hb}}function Kb(n){return n=Qb(n),function(t,e){return dl(t,n)}}function $b(o,a){return o=Qb(o),function(t){var e=null!=a?a:t,n=e?o.width:o.height,i=e?o.x:o.y;return[i,i+(n||0)]}}function Jb(i,o,a){return i=Qb(i),function(t,e,n){return i.contain(e[0],e[1])&&!Xy(t,o,a)}}function Qb(t){return Sn.create(t)}var tS=["axisLine","axisTickLabel","axisName"],eS=bp({type:"parallelAxis",init:function(t,e){eS.superApply(this,"init",arguments),(this._brushController=new _b(e.getZr())).on("brush",E(this._onBrush,this))},render:function(t,e,n,i){var o,a,r,s,l,h,u,c,d,p,g,f,m;o=t,a=e,(r=i)&&"axisAreaSelect"===r.type&&a.findComponents({mainType:"parallelAxis",query:r})[0]===o||(this.axisModel=t,this.api=n,this.group.removeAll(),s=this._axisGroup,this._axisGroup=new Mn,this.group.add(this._axisGroup),t.get("show")&&(h=t,u=(l=e.getComponent("parallel",h.get("parallelIndex"))).coordinateSystem,d=(c=t.getAreaSelectStyle()).width,p=t.axis.dim,g=k({strokeContainThreshold:d},u.getAxisLayout(p)),f=new $m(t,g),P(tS,f.add,f),this._axisGroup.add(f.getGroup()),this._refreshBrushController(g,c,t,l,d,n),m=i&&!1===i.animation?null:t,cl(s,this._axisGroup,m)))},_refreshBrushController:function(t,e,n,i,o,a){var r,s,l=n.axis.getExtent(),h=l[1]-l[0],u=Math.min(30,.1*Math.abs(h)),c=Sn.create({x:l[0],y:-o/2,width:h,height:o});c.x-=u,c.width+=2*u,this._brushController.mount({enableGlobalPan:!0,rotation:t.rotation,position:t.position}).setPanels([{panelId:"pl",clipPath:Kb(c),isTargetByCursor:Jb(c,a,i),getLinearBrushOtherExtent:$b(c,0)}]).enableBrush({brushType:"lineX",brushStyle:e,removeOnClick:!0}).updateCovers((s=(r=n).axis,N(r.activeIntervals,function(t){return{brushType:"lineX",panelId:"pl",range:[s.dataToCoord(t[0],!0),s.dataToCoord(t[1],!0)]}})))},_onBrush:function(t,e){var n=this.axisModel,i=n.axis,o=N(t,function(t){return[i.coordToData(t.range[0],!0),i.coordToData(t.range[1],!0)]});!n.option.realtime!==e.isEnd&&!e.removeOnClick||this.api.dispatchAction({type:"axisAreaSelect",parallelAxisId:n.id,intervals:o})},dispose:function(){this._brushController.dispose()}});bp({type:"parallel",render:function(t,e,n){this._model=t,this._api=n,this._handlers||(this._handlers={},P(nS,function(t,e){n.getZr().on(e,this._handlers[e]=E(t,this))},this)),Ic(this,"_throttledDispatchExpand",t.get("axisExpandRate"),"fixRate")},dispose:function(t,n){P(this._handlers,function(t,e){n.getZr().off(e,t)}),this._handlers=null},_throttledDispatchExpand:function(t){this._dispatchExpand(t)},_dispatchExpand:function(t){t&&this._api.dispatchAction(k({type:"parallelAxisExpand"},t))}});var nS={mousedown:function(t){iS(this,"click")&&(this._mouseDownPoint=[t.offsetX,t.offsetY])},mouseup:function(t){var e=this._mouseDownPoint;if(iS(this,"click")&&e){var n=[t.offsetX,t.offsetY];if(5<Math.pow(e[0]-n[0],2)+Math.pow(e[1]-n[1],2))return;var i=this._model.coordinateSystem.getSlidedAxisExpandWindow([t.offsetX,t.offsetY]);"none"!==i.behavior&&this._dispatchExpand({axisExpandWindow:i.axisExpandWindow})}this._mouseDownPoint=null},mousemove:function(t){var e,n,i;!this._mouseDownPoint&&iS(this,"mousemove")&&("jump"===(i=(n=(e=this._model).coordinateSystem.getSlidedAxisExpandWindow([t.offsetX,t.offsetY])).behavior)&&this._throttledDispatchExpand.debounceNextCall(e.get("axisExpandDebounce")),this._throttledDispatchExpand("none"===i?null:{axisExpandWindow:n.axisExpandWindow,animation:"jump"===i&&null}))}};function iS(t,e){var n=t._model;return n.get("axisExpandable")&&n.get("axisExpandTriggerOn")===e}pp(function(t){var i;!function(t){if(t.parallel)return;var e=!1;P(t.series,function(t){t&&"parallel"===t.type&&(e=!0)}),e&&(t.parallel=[{}])}(t),P(Oo((i=t).parallelAxis),function(t){var e,n;V(t)&&(e=t.parallelIndex||0,(n=Oo(i.parallel)[e])&&n.parallelAxisDefault&&m(t,n.parallelAxisDefault,!1))})}),ec.extend({type:"series.parallel",dependencies:["parallel"],visualColorAccessPath:"lineStyle.color",getInitialData:function(t,e){var n=this.getSource();return function(t,e){if(t.encodeDefine)return;var n=e.ecModel.getComponent("parallel",e.get("parallelIndex"));if(!n)return;var i=t.encodeDefine=et();P(n.dimensions,function(t){var e=+t.replace("dim","");i.set(t,e)})}(n,this),dg(n,this)},getRawIndicesByActiveState:function(n){var t=this.coordinateSystem,i=this.getData(),o=[];return t.eachActiveState(i,function(t,e){n===t&&o.push(i.getRawIndex(e))}),o},defaultOption:{zlevel:0,z:2,coordinateSystem:"parallel",parallelIndex:0,label:{show:!1},inactiveOpacity:.05,activeOpacity:1,lineStyle:{width:1,opacity:.45,type:"solid"},emphasis:{label:{show:!1}},progressive:500,smooth:!1,animationEasing:"linear"}});gc.extend({type:"parallel",init:function(){this._dataGroup=new Mn,this.group.add(this._dataGroup),this._data,this._initialized},render:function(a,t,e,r){var n,i,o,s,l,h,u,c,d=this._dataGroup,p=a.getData(),g=this._data,f=a.coordinateSystem,m=f.dimensions,v=rS(a);p.diff(g).add(function(t){sS(aS(p,d,t,m,f),p,t,v)}).update(function(t,e){var n=g.getItemGraphicEl(e),i=oS(p,t,m,f);p.setItemGraphicEl(t,n);var o=r&&!1===r.animation?null:a;rl(n,{shape:{points:i}},o,t),sS(n,p,t,v)}).remove(function(t){var e=g.getItemGraphicEl(t);d.remove(e)}).execute(),this._initialized||(this._initialized=!0,o=a,s=function(){setTimeout(function(){d.removeClipPath()})},l=(i=f).model,h=i.getRect(),u=new es({shape:{x:h.x,y:h.y,width:h.width,height:h.height}}),c="horizontal"===l.get("layout")?"width":"height",u.setShape(c,0),sl(u,{shape:{width:h.width,height:h.height}},o,s),n=u,d.setClipPath(n)),this._data=p},incrementalPrepareRender:function(t,e,n){this._initialized=!0,this._data=null,this._dataGroup.removeAll()},incrementalRender:function(t,e,n){for(var i=e.getData(),o=e.coordinateSystem,a=o.dimensions,r=rS(e),s=t.start;s<t.end;s++){var l=aS(i,this._dataGroup,s,a,o);l.incremental=!0,sS(l,i,s,r)}},dispose:function(){},remove:function(){this._dataGroup&&this._dataGroup.removeAll(),this._data=null}});function oS(t,e,n,i){for(var o,a=[],r=0;r<n.length;r++){var s=n[r],l=t.get(t.mapDimension(s),e);o=l,("category"===i.getAxis(s).type?null==o:null==o||isNaN(o))||a.push(i.dataToPoint(l,s))}return a}function aS(t,e,n,i,o){var a=oS(t,n,i,o),r=new qr({shape:{points:a},silent:!0,z2:10});return e.add(r),t.setItemGraphicEl(n,r),r}function rS(t){var e=t.get("smooth",!0);return!0===e&&(e=.3),{lineStyle:t.getModel("lineStyle").getLineStyle(),smooth:null!=e?e:.3}}function sS(t,e,n,i){var o=i.lineStyle;e.hasItemOption&&(o=e.getItemModel(n).getModel("lineStyle").getLineStyle()),t.useStyle(o);var a=t.style;a.fill=null,a.stroke=e.getItemVisual(n,"color"),a.opacity=e.getItemVisual(n,"opacity"),i.smooth&&(t.shape.smooth=i.smooth)}var lS=["lineStyle","normal","opacity"];yp({seriesType:"parallel",reset:function(t,e,n){var i=t.getModel("itemStyle"),o=t.getModel("lineStyle"),a=e.get("color"),r=o.get("color")||i.get("color")||a[t.seriesIndex%a.length],s=t.get("inactiveOpacity"),l=t.get("activeOpacity"),h=t.getModel("lineStyle").getLineStyle(),u=t.coordinateSystem,c=t.getData(),d={normal:h.opacity,active:l,inactive:s};return c.setVisual("color",r),{progress:function(t,o){u.eachActiveState(o,function(t,e){var n,i=d[t];"normal"!==t||!o.hasItemOption||null!=(n=o.getItemModel(e).get(lS,!0))&&(i=n),o.setItemVisual(e,"opacity",i)},t.start,t.end)}}}});var hS=ec.extend({type:"series.sankey",layoutInfo:null,levelModels:null,getInitialData:function(t,e){for(var n=t.edges||t.links,i=t.data||t.nodes,o=t.levels,a=this.levelModels={},r=0;r<o.length;r++)if(null!=o[r].depth&&0<=o[r].depth)a[o[r].depth]=new Sl(o[r],this,e);else if(D)throw new Error("levels[i].depth is mandatory and should be natural number");if(i&&n)return $_(i,n,this,!0,function(t,e){t.wrapMethod("getItemModel",function(t,i){return t.customizeGetParent(function(t){var e=this.parentModel,n=e.getData().getItemLayout(i).depth;return e.levelModels[n]||this.parentModel}),t}),e.wrapMethod("getItemModel",function(t,i){return t.customizeGetParent(function(t){var e=this.parentModel,n=e.getGraph().getEdgeByIndex(i).node1.getLayout().depth;return e.levelModels[n]||this.parentModel}),t})}).data},setNodePosition:function(t,e){var n=this.option.data[t];n.localX=e[0],n.localY=e[1]},getGraph:function(){return this.getData().graph},getEdgeData:function(){return this.getGraph().edgeData},formatTooltip:function(t,e,n){if("edge"===n){var i=this.getDataParams(t,n),o=i.data,a=o.source+" -- "+o.target;return i.value&&(a+=" : "+i.value),Ql(a)}if("node"!==n)return hS.superCall(this,"formatTooltip",t,e);var r=this.getGraph().getNodeByIndex(t).getLayout().value,s=this.getDataParams(t,n).data.name;return r&&(a=s+" : "+r),Ql(a)},optionUpdated:function(){var t=this.option;!0===t.focusNodeAdjacency&&(t.focusNodeAdjacency="allEdges")},defaultOption:{zlevel:0,z:2,coordinateSystem:"view",layout:null,left:"5%",top:"5%",right:"20%",bottom:"5%",orient:"horizontal",nodeWidth:20,nodeGap:8,draggable:!0,focusNodeAdjacency:!1,layoutIterations:32,label:{show:!0,position:"right",color:"#000",fontSize:12},levels:[],nodeAlign:"justify",itemStyle:{borderWidth:1,borderColor:"#333"},lineStyle:{color:"#314656",opacity:.2,curveness:.5},emphasis:{label:{show:!0},lineStyle:{opacity:.6}},animationEasing:"linear",animationDuration:1e3}}),uS=["itemStyle","opacity"],cS=["lineStyle","opacity"];function dS(t,e){return t.getVisual("opacity")||t.getModel().get(e)}function pS(t,e,n){var i=t.getGraphicEl(),o=dS(t,e);null!=n&&(null==o&&(o=1),o*=n),i.downplay&&i.downplay(),i.traverse(function(t){"group"!==t.type&&t.setStyle("opacity",o)})}function gS(t,e){var n=dS(t,e),i=t.getGraphicEl();i.highlight&&i.highlight(),i.traverse(function(t){"group"!==t.type&&t.setStyle("opacity",n)})}var fS=Ms({shape:{x1:0,y1:0,x2:0,y2:0,cpx1:0,cpy1:0,cpx2:0,cpy2:0,extent:0,orient:""},buildPath:function(t,e){var n=e.extent;t.moveTo(e.x1,e.y1),t.bezierCurveTo(e.cpx1,e.cpy1,e.cpx2,e.cpy2,e.x2,e.y2),"vertical"===e.orient?(t.lineTo(e.x2+n,e.y2),t.bezierCurveTo(e.cpx2+n,e.cpy2,e.cpx1+n,e.cpy1,e.x1+n,e.y1)):(t.lineTo(e.x2,e.y2+n),t.bezierCurveTo(e.cpx2,e.cpy2+n,e.cpx1,e.cpy1+n,e.x1,e.y1+n)),t.closePath()}});Mp({type:"sankey",_model:null,_focusAdjacencyDisabled:!1,render:function(w,t,i){var e,n,o,a,r=this,s=w.getGraph(),b=this.group,l=w.layoutInfo,S=l.width,M=l.height,h=w.getData(),I=w.getData("edge"),T=w.get("orient");this._model=w,b.removeAll(),b.attr("position",[l.x,l.y]),s.eachEdge(function(t){var e=new fS;e.dataIndex=t.dataIndex,e.seriesIndex=w.seriesIndex,e.dataType="edge";var n,i,o,a,r,s,l,h,u=t.getModel("lineStyle"),c=u.get("curveness"),d=t.node1.getLayout(),p=t.node1.getModel(),g=p.get("localX"),f=p.get("localY"),m=t.node2.getLayout(),v=t.node2.getModel(),y=v.get("localX"),x=v.get("localY"),_=t.getLayout();switch(e.shape.extent=Math.max(1,_.dy),h="vertical"===(e.shape.orient=T)?(n=(null!=g?g*S:d.x)+_.sy,i=(null!=f?f*M:d.y)+d.dy,o=(null!=y?y*S:m.x)+_.ty,r=n,s=i*(1-c)+(a=null!=x?x*M:m.y)*c,l=o,i*c+a*(1-c)):(n=(null!=g?g*S:d.x)+d.dx,i=(null!=f?f*M:d.y)+_.sy,r=n*(1-c)+(o=null!=y?y*S:m.x)*c,s=i,l=n*c+o*(1-c),a=(null!=x?x*M:m.y)+_.ty),e.setShape({x1:n,y1:i,x2:o,y2:a,cpx1:r,cpy1:s,cpx2:l,cpy2:h}),e.setStyle(u.getItemStyle()),e.style.fill){case"source":e.style.fill=t.node1.getVisual("color");break;case"target":e.style.fill=t.node2.getVisual("color")}Xs(e,t.getModel("emphasis.lineStyle").getItemStyle()),b.add(e),I.setItemGraphicEl(t.dataIndex,e)}),s.eachNode(function(t){var e=t.getLayout(),n=t.getModel(),i=n.get("localX"),o=n.get("localY"),a=n.getModel("label"),r=n.getModel("emphasis.label"),s=new es({shape:{x:null!=i?i*S:e.x,y:null!=o?o*M:e.y,width:e.dx,height:e.dy},style:n.getModel("itemStyle").getItemStyle()}),l=t.getModel("emphasis.itemStyle").getItemStyle();Ks(s.style,l,a,r,{labelFetcher:w,labelDataIndex:t.dataIndex,defaultText:t.id,isRectText:!0}),s.setStyle("fill",t.getVisual("color")),Xs(s,l),b.add(s),h.setItemGraphicEl(t.dataIndex,s),s.dataType="node"}),h.eachItemGraphicEl(function(t,n){var e=h.getItemModel(n);e.get("draggable")&&(t.drift=function(t,e){r._focusAdjacencyDisabled=!0,this.shape.x+=t,this.shape.y+=e,this.dirty(),i.dispatchAction({type:"dragNode",seriesId:w.id,dataIndex:h.getRawIndex(n),localX:this.shape.x/S,localY:this.shape.y/M})},t.ondragend=function(){r._focusAdjacencyDisabled=!1},t.draggable=!0,t.cursor="move"),e.get("focusNodeAdjacency")&&(t.off("mouseover").on("mouseover",function(){r._focusAdjacencyDisabled||(r._clearTimer(),i.dispatchAction({type:"focusNodeAdjacency",seriesId:w.id,dataIndex:t.dataIndex}))}),t.off("mouseout").on("mouseout",function(){r._focusAdjacencyDisabled||r._dispatchUnfocus(i)}))}),I.eachItemGraphicEl(function(t,e){I.getItemModel(e).get("focusNodeAdjacency")&&(t.off("mouseover").on("mouseover",function(){r._focusAdjacencyDisabled||(r._clearTimer(),i.dispatchAction({type:"focusNodeAdjacency",seriesId:w.id,edgeDataIndex:t.dataIndex}))}),t.off("mouseout").on("mouseout",function(){r._focusAdjacencyDisabled||r._dispatchUnfocus(i)}))}),!this._data&&w.get("animation")&&b.setClipPath((e=b.getBoundingRect(),n=w,o=function(){b.removeClipPath()},sl(a=new es({shape:{x:e.x-10,y:e.y-10,width:0,height:e.height+20}}),{shape:{width:e.width+20,height:e.height+20}},n,o),a)),this._data=w.getData()},dispose:function(){this._clearTimer()},_dispatchUnfocus:function(t){var e=this;this._clearTimer(),this._unfocusDelayTimer=setTimeout(function(){e._unfocusDelayTimer=null,t.dispatchAction({type:"unfocusNodeAdjacency",seriesId:e._model.id})},500)},_clearTimer:function(){this._unfocusDelayTimer&&(clearTimeout(this._unfocusDelayTimer),this._unfocusDelayTimer=null)},focusNodeAdjacency:function(t,e,n,i){var o,a,r,s=this._model.getData(),l=s.graph,h=i.dataIndex,u=s.getItemModel(h),c=i.edgeDataIndex;null==h&&null==c||(o=l.getNodeByIndex(h),a=l.getEdgeByIndex(c),l.eachNode(function(t){pS(t,uS,.1)}),l.eachEdge(function(t){pS(t,cS,.1)}),o&&(gS(o,uS),"outEdges"===(r=u.get("focusNodeAdjacency"))?P(o.outEdges,function(t){t.dataIndex<0||(gS(t,cS),gS(t.node2,uS))}):"inEdges"===r?P(o.inEdges,function(t){t.dataIndex<0||(gS(t,cS),gS(t.node1,uS))}):"allEdges"===r&&P(o.edges,function(t){t.dataIndex<0||(gS(t,cS),gS(t.node1,uS),gS(t.node2,uS))})),a&&(gS(a,cS),gS(a.node1,uS),gS(a.node2,uS)))},unfocusNodeAdjacency:function(t,e,n,i){var o=this._model.getGraph();o.eachNode(function(t){pS(t,uS)}),o.eachEdge(function(t){pS(t,cS)})}}),fp({type:"dragNode",event:"dragnode",update:"update"},function(e,t){t.eachComponent({mainType:"series",subType:"sankey",query:e},function(t){t.setNodePosition(e.dataIndex,[e.localX,e.localY])})});function mS(t){var e=t.hostGraph.data.getRawDataItem(t.dataIndex);return null!=e.depth&&0<=e.depth}function vS(t,l,h,u,c){var d="vertical"===c?"x":"y";P(t,function(t){var e,n;t.sort(function(t,e){return t.getLayout()[d]-e.getLayout()[d]});for(var i,o=0,a=t.length,r="vertical"===c?"dx":"dy",s=0;s<a;s++)0<(i=o-(n=t[s]).getLayout()[d])&&(e=n.getLayout()[d]+i,"vertical"===c?n.setLayout({x:e},!0):n.setLayout({y:e},!0)),o=n.getLayout()[d]+n.getLayout()[r]+l;if(0<(i=o-l-("vertical"===c?u:h)))for(e=n.getLayout()[d]-i,"vertical"===c?n.setLayout({x:e},!0):n.setLayout({y:e},!0),o=e,s=a-2;0<=s;--s)0<(i=(n=t[s]).getLayout()[d]+n.getLayout()[r]+l-o)&&(e=n.getLayout()[d]-i,"vertical"===c?n.setLayout({x:e},!0):n.setLayout({y:e},!0)),o=n.getLayout()[d]})}function yS(t,o,a){P(t.slice().reverse(),function(t){P(t,function(t){var e,n,i;t.outEdges.length&&(e=SS(t.outEdges,xS,a)/SS(t.outEdges,bS,a),"vertical"===a?(n=t.getLayout().x+(e-wS(t,a))*o,t.setLayout({x:n},!0)):(i=t.getLayout().y+(e-wS(t,a))*o,t.setLayout({y:i},!0)))})})}function xS(t,e){return wS(t.node2,e)*t.getValue()}function _S(t,e){return wS(t.node1,e)*t.getValue()}function wS(t,e){return"vertical"===e?t.getLayout().x+t.getLayout().dx/2:t.getLayout().y+t.getLayout().dy/2}function bS(t){return t.getValue()}function SS(t,e,n){for(var i=0,o=t.length,a=-1;++a<o;){var r=+e.call(t,t[a],n);isNaN(r)||(i+=r)}return i}function MS(t,o,a){P(t,function(t){P(t,function(t){var e,n,i;t.inEdges.length&&(e=SS(t.inEdges,_S,a)/SS(t.inEdges,bS,a),"vertical"===a?(n=t.getLayout().x+(e-wS(t,a))*o,t.setLayout({x:n},!0)):(i=t.getLayout().y+(e-wS(t,a))*o,t.setLayout({y:i},!0)))})})}vp(function(t,_,e){t.eachSeriesByType("sankey",function(t){var e,n=t.get("nodeWidth"),i=t.get("nodeGap"),o=(e=_,fh(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()})),a=(t.layoutInfo=o).width,r=o.height,s=t.getGraph(),l=s.nodes,h=s.edges;P(l,function(t){var e=SS(t.outEdges,bS),n=SS(t.inEdges,bS),i=Math.max(e,n);t.setLayout({value:i},!0)});var u,c,d,p,g,f,m,v=0!==I(l,function(t){return 0===t.getLayout().value}).length?0:t.get("layoutIterations"),y=t.get("orient"),x=t.get("nodeAlign");d=i,f=v,function(t,e,n,i,o,a,r){for(var s=[],l=[],h=[],u=[],c=0,d=0;d<e.length;d++)s[d]=1;for(d=0;d<t.length;d++)l[d]=t[d].inEdges.length,0===l[d]&&h.push(t[d]);var p=-1;for(;h.length;){for(var g=0;g<h.length;g++){var f=h[g],m=f.hostGraph.data.getRawDataItem(f.dataIndex),v=null!=m.depth&&0<=m.depth;v&&m.depth>p&&(p=m.depth),f.setLayout({depth:v?m.depth:c},!0),"vertical"===a?f.setLayout({dy:n},!0):f.setLayout({dx:n},!0);for(var y=0;y<f.outEdges.length;y++){var x=f.outEdges[y],_=e.indexOf(x);s[_]=0;var w=x.node2,b=t.indexOf(w);0==--l[b]&&u.indexOf(w)<0&&u.push(w)}}++c,h=u,u=[]}for(d=0;d<s.length;d++)if(1===s[d])throw new Error("Sankey is a DAG, the original data has cycle!");var S=c-1<p?p:c-1;r&&"left"!==r&&function(t,e,n){if("right"===e){for(var i=[],o=t,a=0;o.length;){for(var r=0;r<o.length;r++){var s=o[r];s.setLayout({skNodeHeight:a},!0);for(var l=0;l<s.inEdges.length;l++){var h=s.inEdges[l];i.indexOf(h.node1)<0&&i.push(h.node1)}}o=i,i=[],++a}P(t,function(t){mS(t)||t.setLayout({depth:Math.max(0,n-t.getLayout().skNodeHeight)},!0)})}else"justify"===e&&function(t,e){P(t,function(t){mS(t)||t.outEdges.length||t.setLayout({depth:e},!0)})}(t,n)}(t,r,S);!function(t,n,i){P(t,function(t){var e=t.getLayout().depth*n;"vertical"===i?t.setLayout({y:e},!0):t.setLayout({x:e},!0)})}(t,"vertical"===a?(o-n)/S:(i-n)/S,a)}(u=l,c=h,n,p=a,g=r,m=y,x),function(t,e,n,i,o,a,r){var s=function(t,e){var n=[],i="vertical"===e?"y":"x",o=qo(t,function(t){return t.getLayout()[i]});return o.keys.sort(function(t,e){return t-e}),P(o.keys,function(t){n.push(o.buckets.get(t))}),n}(t,r);(function(t,e,o,a,r,s){var l=1/0;P(t,function(t){var e=t.length,n=0;P(t,function(t){n+=t.getLayout().value});var i="vertical"===s?(a-(e-1)*r)/n:(o-(e-1)*r)/n;i<l&&(l=i)}),P(t,function(t){P(t,function(t,e){var n=t.getLayout().value*l;"vertical"===s?(t.setLayout({x:e},!0),t.setLayout({dx:n},!0)):(t.setLayout({y:e},!0),t.setLayout({dy:n},!0))})}),P(e,function(t){var e=t.getValue()*l;t.setLayout({dy:e},!0)})})(s,e,n,i,o,r),vS(s,o,n,i,r);for(var l=1;0<a;a--)yS(s,l*=.99,r),vS(s,o,n,i,r),MS(s,l,r),vS(s,o,n,i,r)}(u,c,g,p,d,f,m),function(t,e){var n="vertical"===e?"x":"y";P(t,function(t){t.outEdges.sort(function(t,e){return t.node2.getLayout()[n]-e.node2.getLayout()[n]}),t.inEdges.sort(function(t,e){return t.node1.getLayout()[n]-e.node1.getLayout()[n]})}),P(t,function(t){var e=0,n=0;P(t.outEdges,function(t){t.setLayout({sy:e},!0),e+=t.getLayout().dy}),P(t.inEdges,function(t){t.setLayout({ty:n},!0),n+=t.getLayout().dy})})}(u,m)})}),yp(function(t,e){t.eachSeriesByType("sankey",function(i){var o,a,t=i.getGraph().nodes;t.length&&(o=1/0,a=-1/0,P(t,function(t){var e=t.getLayout().value;e<o&&(o=e),a<e&&(a=e)}),P(t,function(t){var e=new u_({type:"color",mappingMethod:"linear",dataExtent:[o,a],visual:i.get("color")}).mapValueToVisual(t.getLayout().value),n=t.getModel().get("itemStyle.color");null!=n?t.setVisual("color",n):t.setVisual("color",e)}))})});var IS={_baseAxisDim:null,getInitialData:function(t,e){var n,i,o=e.getComponent("xAxis",this.get("xAxisIndex")),a=e.getComponent("yAxis",this.get("yAxisIndex")),r=o.get("type"),s=a.get("type");"category"===r?(t.layout="horizontal",n=o.getOrdinalMeta(),i=!0):"category"===s?(t.layout="vertical",n=a.getOrdinalMeta(),i=!0):t.layout=t.layout||"horizontal";var l,h=["x","y"],u="horizontal"===t.layout?0:1,c=this._baseAxisDim=h[u],d=h[1-u],p=[o,a],g=p[u].get("type"),f=p[1-u].get("type"),m=t.data;m&&i&&(l=[],P(m,function(t,e){var n;t.value&&R(t.value)?(n=t.value.slice(),t.value.unshift(e)):R(t)?(n=t.slice(),t.unshift(e)):n=t,l.push(n)}),t.data=l);var v=this.defaultValueDimensions,y=[{name:c,type:kp(g),ordinalMeta:n,otherDims:{tooltip:!1,itemName:0},dimsDef:["base"]},{name:d,type:kp(f),dimsDef:v.slice()}];return Wv(this,{coordDimensions:y,dimensionsCount:v.length+1,encodeDefaulter:z(Zh,y,this)})},getBaseAxis:function(){var t=this._baseAxisDim;return this.ecModel.getComponent(t+"Axis",this.get(t+"AxisIndex")).axis}};b(ec.extend({type:"series.boxplot",dependencies:["xAxis","yAxis","grid"],defaultValueDimensions:[{name:"min",defaultTooltip:!0},{name:"Q1",defaultTooltip:!0},{name:"median",defaultTooltip:!0},{name:"Q3",defaultTooltip:!0},{name:"max",defaultTooltip:!0}],dimensions:null,defaultOption:{zlevel:0,z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,hoverAnimation:!0,layout:null,boxWidth:[7,50],itemStyle:{color:"#fff",borderWidth:1},emphasis:{itemStyle:{borderWidth:2,shadowBlur:5,shadowOffsetX:2,shadowOffsetY:2,shadowColor:"rgba(0,0,0,0.4)"}},animationEasing:"elasticOut",animationDuration:800}}),IS,!0);var TS=["itemStyle"],AS=["emphasis","itemStyle"],DS=(gc.extend({type:"boxplot",render:function(t,e,n){var o=t.getData(),a=this.group,r=this._data;this._data||a.removeAll();var s="horizontal"===t.get("layout")?1:0;o.diff(r).add(function(t){var e;o.hasValue(t)&&(e=CS(o.getItemLayout(t),o,t,s,!0),o.setItemGraphicEl(t,e),a.add(e))}).update(function(t,e){var n,i=r.getItemGraphicEl(e);o.hasValue(t)?(n=o.getItemLayout(t),i?LS(n,i,o,t):i=CS(n,o,t,s),a.add(i),o.setItemGraphicEl(t,i)):a.remove(i)}).remove(function(t){var e=r.getItemGraphicEl(t);e&&a.remove(e)}).execute(),this._data=o},remove:function(t){var e=this.group,n=this._data;this._data=null,n&&n.eachItemGraphicEl(function(t){t&&e.remove(t)})},dispose:it}),br.extend({type:"boxplotBoxPath",shape:{},buildPath:function(t,e){var n=e.points,i=0;for(t.moveTo(n[i][0],n[i][1]),i++;i<4;i++)t.lineTo(n[i][0],n[i][1]);for(t.closePath();i<n.length;i++)t.moveTo(n[i][0],n[i][1]),i++,t.lineTo(n[i][0],n[i][1])}}));function CS(t,e,n,i,o){var a,r,s=t.ends,l=new DS({shape:{points:o?(a=i,r=t,N(s,function(t){return(t=t.slice())[a]=r.initBaseline,t})):s}});return LS(t,l,e,n,o),l}function LS(t,e,n,i,o){var a=n.hostModel;(0,ml[o?"initProps":"updateProps"])(e,{shape:{points:t.ends}},a,i);var r=n.getItemModel(i),s=r.getModel(TS),l=n.getItemVisual(i,"color"),h=s.getItemStyle(["borderColor"]);h.stroke=l,h.strokeNoScale=!0,e.useStyle(h),e.z2=100,Xs(e,r.getModel(AS).getItemStyle())}var kS=["itemStyle","borderColor"],PS=P;yp(function(i,t){var o=i.get("color");i.eachRawSeriesByType("boxplot",function(t){var e=o[t.seriesIndex%o.length],n=t.getData();n.setVisual({legendSymbol:"roundRect",color:t.get(kS)||e}),i.isSeriesFiltered(t)||n.each(function(t){var e=n.getItemModel(t);n.setItemVisual(t,{color:e.get(kS,!0)})})})}),vp(function(t){var i,o,e=(i=[],o=[],t.eachSeriesByType("boxplot",function(t){var e=t.getBaseAxis(),n=M(o,e);n<0&&(n=o.length,o[n]=e,i[n]={axis:e,seriesModels:[]}),i[n].seriesModels.push(t)}),i);PS(e,function(n){var t=n.seriesModels;t.length&&(function(t){var e,n,i=t.axis,o=t.seriesModels,a=o.length,r=t.boxWidthList=[],s=t.boxOffsetList=[],l=[];{var h;"category"===i.type?n=i.getBandWidth():(h=0,PS(o,function(t){h=Math.max(h,t.getData().count())}),e=i.getExtent(),Math.abs(e[1]-e[0]))}PS(o,function(t){var e=t.get("boxWidth");R(e)||(e=[e,e]),l.push([Ll(e[0],n)||0,Ll(e[1],n)||0])});var u=.8*n-2,c=u/a*.3,d=(u-c*(a-1))/a,p=d/2-u/2;PS(o,function(t,e){s.push(p),p+=c+d,r.push(Math.min(Math.max(d,l[e][0]),l[e][1]))})}(n),PS(t,function(t,e){!function(t,r,e){var s=t.coordinateSystem,l=t.getData(),a=e/2,h="horizontal"===t.get("layout")?0:1,u=1-h,n=["x","y"],i=l.mapDimension(n[h]),o=l.mapDimension(n[u],!0);if(null==i||o.length<5)return;for(var c=0;c<l.count();c++){var d=l.get(i,c),p=x(d,o[2],c),g=x(d,o[0],c),f=x(d,o[1],c),m=x(d,o[3],c),v=x(d,o[4],c),y=[];_(y,f,0),_(y,m,1),y.push(g,f,v,m),w(y,g),w(y,v),w(y,p),l.setItemLayout(c,{initBaseline:p[u],ends:y})}function x(t,e,n){var i,o=l.get(e,n),a=[];return a[h]=t,a[u]=o,isNaN(t)||isNaN(o)?i=[NaN,NaN]:(i=s.dataToPoint(a))[h]+=r,i}function _(t,e,n){var i=e.slice(),o=e.slice();i[h]+=a,o[h]-=a,n?t.push(i,o):t.push(o,i)}function w(t,e){var n=e.slice(),i=e.slice();n[h]-=a,i[h]+=a,t.push(n,i)}}(t,n.boxOffsetList[e],n.boxWidthList[e])}))})}),b(ec.extend({type:"series.candlestick",dependencies:["xAxis","yAxis","grid"],defaultValueDimensions:[{name:"open",defaultTooltip:!0},{name:"close",defaultTooltip:!0},{name:"lowest",defaultTooltip:!0},{name:"highest",defaultTooltip:!0}],dimensions:null,defaultOption:{zlevel:0,z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,hoverAnimation:!0,layout:null,clip:!0,itemStyle:{color:"#c23531",color0:"#314656",borderWidth:1,borderColor:"#c23531",borderColor0:"#314656"},emphasis:{itemStyle:{borderWidth:2}},barMaxWidth:null,barMinWidth:null,barWidth:null,large:!0,largeThreshold:600,progressive:3e3,progressiveThreshold:1e4,progressiveChunkMode:"mod",animationUpdate:!1,animationEasing:"linear",animationDuration:300},getShadowDim:function(){return"open"},brushSelector:function(t,e,n){var i=e.getItemLayout(t);return i&&n.rect(i.brushRect)}}),IS,!0);var NS=["itemStyle"],OS=["emphasis","itemStyle"],ES=["color","color0","borderColor","borderColor0"],zS=(gc.extend({type:"candlestick",render:function(t,e,n){this.group.removeClipPath(),this._updateDrawMode(t),this._isLargeDraw?this._renderLarge(t):this._renderNormal(t)},incrementalPrepareRender:function(t,e,n){this._clear(),this._updateDrawMode(t)},incrementalRender:function(t,e,n,i){this._isLargeDraw?this._incrementalRenderLarge(t,e):this._incrementalRenderNormal(t,e)},_updateDrawMode:function(t){var e=t.pipelineContext.large;(null==this._isLargeDraw||e^this._isLargeDraw)&&(this._isLargeDraw=e,this._clear())},_renderNormal:function(o){var a=o.getData(),r=this._data,s=this.group,l=a.getLayout("isSimpleBox"),h=o.get("clip",!0),t=o.coordinateSystem,u=t.getArea&&t.getArea();this._data||s.removeAll(),a.diff(r).add(function(t){if(a.hasValue(t)){var e,n=a.getItemLayout(t);if(h&&BS(u,n))return;sl(e=RS(n,0,!0),{shape:{points:n.ends}},o,t),VS(e,a,t,l),s.add(e),a.setItemGraphicEl(t,e)}}).update(function(t,e){var n,i=r.getItemGraphicEl(e);a.hasValue(t)?(n=a.getItemLayout(t),h&&BS(u,n)?s.remove(i):(i?rl(i,{shape:{points:n.ends}},o,t):i=RS(n),VS(i,a,t,l),s.add(i),a.setItemGraphicEl(t,i))):s.remove(i)}).remove(function(t){var e=r.getItemGraphicEl(t);e&&s.remove(e)}).execute(),this._data=a},_renderLarge:function(t){this._clear(),FS(t,this.group);var e=t.get("clip",!0)?bm(t.coordinateSystem,!1,t):null;e?this.group.setClipPath(e):this.group.removeClipPath()},_incrementalRenderNormal:function(t,e){for(var n,i=e.getData(),o=i.getLayout("isSimpleBox");null!=(n=t.next());){var a=RS(i.getItemLayout(n));VS(a,i,n,o),a.incremental=!0,this.group.add(a)}},_incrementalRenderLarge:function(t,e){FS(e,this.group,!0)},remove:function(t){this._clear()},_clear:function(){this.group.removeAll(),this._data=null},dispose:it}),br.extend({type:"normalCandlestickBox",shape:{},buildPath:function(t,e){var n=e.points;this.__simpleBox?(t.moveTo(n[4][0],n[4][1]),t.lineTo(n[6][0],n[6][1])):(t.moveTo(n[0][0],n[0][1]),t.lineTo(n[1][0],n[1][1]),t.lineTo(n[2][0],n[2][1]),t.lineTo(n[3][0],n[3][1]),t.closePath(),t.moveTo(n[4][0],n[4][1]),t.lineTo(n[5][0],n[5][1]),t.moveTo(n[6][0],n[6][1]),t.lineTo(n[7][0],n[7][1]))}}));function RS(t,e,n){var i,o=t.ends;return new zS({shape:{points:n?(i=t,N(o,function(t){return(t=t.slice())[1]=i.initBaseline,t})):o},z2:100})}function BS(t,e){for(var n=!0,i=0;i<e.ends.length;i++)if(t.contain(e.ends[i][0],e.ends[i][1])){n=!1;break}return n}function VS(t,e,n,i){var o=e.getItemModel(n),a=o.getModel(NS),r=e.getItemVisual(n,"color"),s=e.getItemVisual(n,"borderColor")||r,l=a.getItemStyle(ES);t.useStyle(l),t.style.strokeNoScale=!0,t.style.fill=r,t.style.stroke=s,t.__simpleBox=i,Xs(t,o.getModel(OS).getItemStyle())}var GS=br.extend({type:"largeCandlestickBox",shape:{},buildPath:function(t,e){for(var n,i=e.points,o=0;o<i.length;){this.__sign===i[o++]?(n=i[o++],t.moveTo(n,i[o++]),t.lineTo(n,i[o++])):o+=3}}});function FS(t,e,n){var i=t.getData(),o=i.getLayout("largePoints"),a=new GS({shape:{points:o},__sign:1});e.add(a);var r=new GS({shape:{points:o},__sign:-1});e.add(r),WS(1,a,t,i),WS(-1,r,t,i),n&&(a.incremental=!0,r.incremental=!0)}function WS(t,e,n,i){var o=0<t?"P":"N",a=i.getVisual("borderColor"+o)||i.getVisual("color"+o),r=n.getModel(NS).getItemStyle(ES);e.useStyle(r),e.style.fill=null,e.style.stroke=a}var HS=["itemStyle","borderColor"],ZS=["itemStyle","borderColor0"],US=["itemStyle","color"],XS=["itemStyle","color0"],YS={seriesType:"candlestick",plan:cc(),performRawSeries:!0,reset:function(t,e){var n=t.getData(),i=t.pipelineContext.large;if(n.setVisual({legendSymbol:"roundRect",colorP:a(1,t),colorN:a(-1,t),borderColorP:r(1,t),borderColorN:r(-1,t)}),!e.isSeriesFiltered(t))return!i&&{progress:function(t,e){var n;for(;null!=(n=t.next());){var i=e.getItemModel(n),o=e.getItemLayout(n).sign;e.setItemVisual(n,{color:a(o,i),borderColor:r(o,i)})}}};function a(t,e){return e.get(0<t?US:XS)}function r(t,e){return e.get(0<t?HS:ZS)}}},jS="undefined"!=typeof Float32Array?Float32Array:Array,qS={seriesType:"candlestick",plan:cc(),reset:function(t){var e,n,i,o,a,r,s,l,x=t.coordinateSystem,h=t.getData(),_=(n=h,o=(e=t).getBaseAxis(),a="category"===o.type?o.getBandWidth():(i=o.getExtent(),Math.abs(i[1]-i[0])/n.count()),r=Ll(U(e.get("barMaxWidth"),a),a),s=Ll(U(e.get("barMinWidth"),1),a),null!=(l=e.get("barWidth"))?Ll(l,a):Math.max(Math.min(a/2,r),s)),u=["x","y"],w=h.mapDimension(u[0]),c=h.mapDimension(u[1],!0),b=c[0],S=c[1],M=c[2],I=c[3];if(h.setLayout({candleWidth:_,isSimpleBox:_<=1.3}),!(null==w||c.length<4))return{progress:t.pipelineContext.large?function(t,e){var n,i,o=new jS(4*t.count),a=0,r=[],s=[];for(;null!=(i=t.next());){var l=e.get(w,i),h=e.get(b,i),u=e.get(S,i),c=e.get(M,i),d=e.get(I,i);isNaN(l)||isNaN(c)||isNaN(d)?(o[a++]=NaN,a+=3):(o[a++]=KS(e,i,h,u,S),r[0]=l,r[1]=c,n=x.dataToPoint(r,null,s),o[a++]=n?n[0]:NaN,o[a++]=n?n[1]:NaN,r[1]=d,n=x.dataToPoint(r,null,s),o[a++]=n?n[1]:NaN)}e.setLayout("largePoints",o)}:function(t,e){var n;for(;null!=(n=t.next());){var i=e.get(w,n),o=e.get(b,n),a=e.get(S,n),r=e.get(M,n),s=e.get(I,n),l=Math.min(o,a),h=Math.max(o,a),u=f(l,i),c=f(h,i),d=f(r,i),p=f(s,i),g=[];m(g,c,0),m(g,u,1),g.push(y(p),y(c),y(d),y(u)),e.setItemLayout(n,{sign:KS(e,n,o,a,S),initBaseline:a<o?c[1]:u[1],ends:g,brushRect:v(r,s,i)})}function f(t,e){var n=[];return n[0]=e,n[1]=t,isNaN(e)||isNaN(t)?[NaN,NaN]:x.dataToPoint(n)}function m(t,e,n){var i=e.slice(),o=e.slice();i[0]=Ps(i[0]+_/2,1,!1),o[0]=Ps(o[0]-_/2,1,!0),n?t.push(i,o):t.push(o,i)}function v(t,e,n){var i=f(t,n),o=f(e,n);return i[0]-=_/2,o[0]-=_/2,{x:i[0],y:i[1],width:_,height:o[1]-i[1]}}function y(t){return t[0]=Ps(t[0],1),t}}}}};function KS(t,e,n,i,o){var a=!(i<n)&&(n<i||!(0<e)||t.get(o,e-1)<=i)?1:-1;return a}pp(function(t){t&&R(t.series)&&P(t.series,function(t){V(t)&&"k"===t.type&&(t.type="candlestick")})}),yp(YS),vp(qS),ec.extend({type:"series.effectScatter",dependencies:["grid","polar"],getInitialData:function(t,e){return dg(this.getSource(),this,{useEncodeDefaulter:!0})},brushSelector:"point",defaultOption:{coordinateSystem:"cartesian2d",zlevel:0,z:2,legendHoverLink:!0,effectType:"ripple",progressive:0,showEffectOn:"render",rippleEffect:{period:4,scale:2.5,brushType:"fill"},symbolSize:10}});function $S(t,e){var n=e.rippleEffectColor||e.color;t.eachChild(function(t){t.attr({z:e.z,zlevel:e.zlevel,style:{stroke:"stroke"===e.brushType?n:null,fill:"fill"===e.brushType?n:null}})})}function JS(t,e){Mn.call(this);var n=new Zf(t,e),i=new Mn;this.add(n),this.add(i),i.beforeUpdate=function(){this.attr(n.getScale())},this.updateData(t,e)}var QS=JS.prototype;QS.stopEffectAnimation=function(){this.childAt(1).removeAll()},QS.startEffectAnimation=function(t){for(var e=t.symbolType,n=t.color,i=this.childAt(1),o=0;o<3;o++){var a=xf(e,-1,-1,2,2,n);a.attr({style:{strokeNoScale:!0},z2:99,silent:!0,scale:[.5,.5]});var r=-o/3*t.period+t.effectOffset;a.animate("",!0).when(t.period,{scale:[t.rippleScale/2,t.rippleScale/2]}).delay(r).start(),a.animateStyle(!0).when(t.period,{opacity:0}).delay(r).start(),i.add(a)}$S(i,t)},QS.updateEffectAnimation=function(t){for(var e=this._effectCfg,n=this.childAt(1),i=["symbolType","period","rippleScale"],o=0;o<i.length;o++){var a=i[o];if(e[a]!==t[a])return this.stopEffectAnimation(),void this.startEffectAnimation(t)}$S(n,t)},QS.highlight=function(){this.trigger("emphasis")},QS.downplay=function(){this.trigger("normal")},QS.updateData=function(t,e){var n=t.hostModel;this.childAt(0).updateData(t,e);var i,o=this.childAt(1),a=t.getItemModel(e),r=t.getItemVisual(e,"symbol"),s=(R(i=t.getItemVisual(e,"symbolSize"))||(i=[+i,+i]),i),l=t.getItemVisual(e,"color");o.attr("scale",s),o.traverse(function(t){t.attr({fill:l})});var h,u=a.getShallow("symbolOffset");u&&((h=o.position)[0]=Ll(u[0],s[0]),h[1]=Ll(u[1],s[1])),o.rotation=(a.getShallow("symbolRotate")||0)*Math.PI/180||0;var c,d,p,g={};g.showEffectOn=n.get("showEffectOn"),g.rippleScale=a.get("rippleEffect.scale"),g.brushType=a.get("rippleEffect.brushType"),g.period=1e3*a.get("rippleEffect.period"),g.effectOffset=e/t.count(),g.z=a.getShallow("z")||0,g.zlevel=a.getShallow("zlevel")||0,g.symbolType=r,g.color=l,g.rippleEffectColor=a.get("rippleEffect.color"),this.off("mouseover").off("mouseout").off("emphasis").off("normal"),"render"===g.showEffectOn?(this._effectCfg?this.updateEffectAnimation(g):this.startEffectAnimation(g),this._effectCfg=g):(this._effectCfg=null,this.stopEffectAnimation(),c=this.childAt(0),d=function(){c.highlight(),"render"!==g.showEffectOn&&this.startEffectAnimation(g)},p=function(){c.downplay(),"render"!==g.showEffectOn&&this.stopEffectAnimation()},this.on("mouseover",d,this).on("mouseout",p,this).on("emphasis",d,this).on("normal",p,this)),this._effectCfg=g},QS.fadeOut=function(t){this.off("mouseover").off("mouseout").off("emphasis").off("normal"),t&&t()},w(JS,Mn),Mp({type:"effectScatter",init:function(){this._symbolDraw=new tm(JS)},render:function(t,e,n){var i=t.getData(),o=this._symbolDraw;o.updateData(i),this.group.add(o.group)},updateTransform:function(t,e,n){var i=t.getData();this.group.dirty();var o=Cm().reset(t);o.progress&&o.progress({start:0,end:i.count()},i),this._symbolDraw.updateLayout(i)},_updateGroupTransform:function(t){var e=t.coordinateSystem;e&&e.getRoamTransform&&(this.group.transform=he(e.getRoamTransform()),this.group.decomposeTransform())},remove:function(t,e){this._symbolDraw&&this._symbolDraw.remove(e)},dispose:function(){}}),yp(Dm("effectScatter","circle")),vp(Cm("effectScatter"));var tM="undefined"==typeof Uint32Array?Array:Uint32Array,eM="undefined"==typeof Float64Array?Array:Float64Array;function nM(t){var e=t.data;e&&e[0]&&e[0][0]&&e[0][0].coord&&(D&&console.warn("Lines data configuration has been changed to { coords:[[1,2],[2,3]] }"),t.data=N(e,function(t){var e={coords:[t[0].coord,t[1].coord]};return t[0].name&&(e.fromName=t[0].name),t[1].name&&(e.toName=t[1].name),f([e,t[0],t[1]])}))}var iM=ec.extend({type:"series.lines",dependencies:["grid","polar"],visualColorAccessPath:"lineStyle.color",init:function(t){t.data=t.data||[],nM(t);var e=this._processFlatCoordsArray(t.data);this._flatCoords=e.flatCoords,this._flatCoordsOffset=e.flatCoordsOffset,e.flatCoords&&(t.data=new Float32Array(e.count)),iM.superApply(this,"init",arguments)},mergeOption:function(t){var e;t.data=t.data||[],nM(t),t.data&&(e=this._processFlatCoordsArray(t.data),this._flatCoords=e.flatCoords,this._flatCoordsOffset=e.flatCoordsOffset,e.flatCoords&&(t.data=new Float32Array(e.count))),iM.superApply(this,"mergeOption",arguments)},appendData:function(t){var e=this._processFlatCoordsArray(t.data);e.flatCoords&&(this._flatCoords?(this._flatCoords=nt(this._flatCoords,e.flatCoords),this._flatCoordsOffset=nt(this._flatCoordsOffset,e.flatCoordsOffset)):(this._flatCoords=e.flatCoords,this._flatCoordsOffset=e.flatCoordsOffset),t.data=new Float32Array(e.count)),this.getRawData().appendData(t.data)},_getCoordsFromItemModel:function(t){var e=this.getData().getItemModel(t),n=e.option instanceof Array?e.option:e.getShallow("coords");if(D&&!(n instanceof Array&&0<n.length&&n[0]instanceof Array))throw new Error("Invalid coords "+JSON.stringify(n)+". Lines must have 2d coords array in data item.");return n},getLineCoordsCount:function(t){return this._flatCoordsOffset?this._flatCoordsOffset[2*t+1]:this._getCoordsFromItemModel(t).length},getLineCoords:function(t,e){if(this._flatCoordsOffset){for(var n=this._flatCoordsOffset[2*t],i=this._flatCoordsOffset[2*t+1],o=0;o<i;o++)e[o]=e[o]||[],e[o][0]=this._flatCoords[n+2*o],e[o][1]=this._flatCoords[n+2*o+1];return i}for(var a=this._getCoordsFromItemModel(t),o=0;o<a.length;o++)e[o]=e[o]||[],e[o][0]=a[o][0],e[o][1]=a[o][1];return a.length},_processFlatCoordsArray:function(t){var e=0;if(this._flatCoords&&(e=this._flatCoords.length),"number"!=typeof t[0])return{flatCoordsOffset:null,flatCoords:null,count:t.length};for(var n=t.length,i=new tM(n),o=new eM(n),a=0,r=0,s=0,l=0;l<n;){s++;var h=t[l++];i[r++]=a+e,i[r++]=h;for(var u=0;u<h;u++){var c=t[l++],d=t[l++];if(o[a++]=c,o[a++]=d,n<l&&D)throw new Error("Invalid data format.")}}return{flatCoordsOffset:new Uint32Array(i.buffer,0,r),flatCoords:o,count:s}},getInitialData:function(t,e){if(D&&!nu.get(t.coordinateSystem))throw new Error("Unkown coordinate system "+t.coordinateSystem);var a=new Hp(["value"],this);return a.hasItemOption=!1,a.initData(t.data,[],function(t,e,n,i){if(t instanceof Array)return NaN;a.hasItemOption=!0;var o=t.value;return null!=o?o instanceof Array?o[i]:o:void 0}),a},formatTooltip:function(t){var e=this.getData().getItemModel(t),n=e.get("name");if(n)return n;var i=e.get("fromName"),o=e.get("toName"),a=[];return null!=i&&a.push(i),null!=o&&a.push(o),Ql(a.join(" > "))},preventIncremental:function(){return!!this.get("effect.show")},getProgressive:function(){var t=this.option.progressive;return null==t?this.option.large?1e4:this.get("progressive"):t},getProgressiveThreshold:function(){var t=this.option.progressiveThreshold;return null==t?this.option.large?2e4:this.get("progressiveThreshold"):t},defaultOption:{coordinateSystem:"geo",zlevel:0,z:2,legendHoverLink:!0,hoverAnimation:!0,xAxisIndex:0,yAxisIndex:0,symbol:["none","none"],symbolSize:[10,10],geoIndex:0,effect:{show:!1,period:4,constantSpeed:0,symbol:"circle",symbolSize:3,loop:!0,trailLength:.2},large:!1,largeThreshold:2e3,polyline:!1,clip:!0,label:{show:!1,position:"end"},lineStyle:{opacity:.5}}});function oM(t,e,n){Mn.call(this),this.add(this.createLine(t,e,n)),this._updateEffectSymbol(t,e)}var aM=oM.prototype;function rM(t,e,n){Mn.call(this),this._createPolyline(t,e,n)}aM.createLine=function(t,e,n){return new sw(t,e,n)},aM._updateEffectSymbol=function(t,e){var n=t.getItemModel(e).getModel("effect"),i=n.get("symbolSize"),o=n.get("symbol");R(i)||(i=[i,i]);var a=n.get("color")||t.getItemVisual(e,"color"),r=this.childAt(1);this._symbolType!==o&&(this.remove(r),(r=xf(o,-.5,-.5,1,1,a)).z2=100,r.culling=!0,this.add(r)),r&&(r.setStyle("shadowColor",a),r.setStyle(n.getItemStyle(["color"])),r.attr("scale",i),r.setColor(a),r.attr("scale",i),this._symbolType=o,this._updateEffectAnimation(t,n,e))},aM._updateEffectAnimation=function(e,t,n){var i,o,a,r,s,l,h,u,c,d=this.childAt(1);d&&(i=this,o=e.getItemLayout(n),a=1e3*t.get("period"),r=t.get("loop"),s=t.get("constantSpeed"),h="function"==typeof(l=Z(t.get("delay"),function(t){return t/e.count()*a/3})),d.ignore=!0,this.updateAnimationPoints(d,o),0<s&&(a=this.getLineLength(d)/s*1e3),a===this._period&&r===this._loop||(d.stopAnimation(),u=l,h&&(u=l(n)),0<d.__t&&(u=-a*d.__t),d.__t=0,c=d.animate("",r).when(a,{__t:1}).delay(u).during(function(){i.updateSymbolPosition(d)}),r||c.done(function(){i.remove(d)}),c.start()),this._period=a,this._loop=r)},aM.getLineLength=function(t){return yt(t.__p1,t.__cp1)+yt(t.__cp1,t.__p2)},aM.updateAnimationPoints=function(t,e){t.__p1=e[0],t.__p2=e[1],t.__cp1=e[2]||[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2]},aM.updateData=function(t,e,n){this.childAt(0).updateData(t,e,n),this._updateEffectSymbol(t,e)},aM.updateSymbolPosition=function(t){var e=t.__p1,n=t.__p2,i=t.__cp1,o=t.__t,a=t.position,r=Ia,s=Ta;a[0]=r(e[0],i[0],n[0],o),a[1]=r(e[1],i[1],n[1],o);var l=s(e[0],i[0],n[0],o),h=s(e[1],i[1],n[1],o);t.rotation=-Math.atan2(h,l)-Math.PI/2,t.ignore=!1},aM.updateLayout=function(t,e){this.childAt(0).updateLayout(t,e);var n=t.getItemModel(e).getModel("effect");this._updateEffectAnimation(t,n,e)},w(oM,Mn);var sM=rM.prototype;function lM(t,e,n){oM.call(this,t,e,n),this._lastFrame=0,this._lastFramePercent=0}sM._createPolyline=function(t,e,n){var i=t.getItemLayout(e),o=new qr({shape:{points:i}});this.add(o),this._updateCommonStl(t,e,n)},sM.updateData=function(t,e,n){var i=t.hostModel;rl(this.childAt(0),{shape:{points:t.getItemLayout(e)}},i,e),this._updateCommonStl(t,e,n)},sM._updateCommonStl=function(t,e,n){var i=this.childAt(0),o=t.getItemModel(e),a=t.getItemVisual(e,"color"),r=n&&n.lineStyle,s=n&&n.hoverLineStyle;n&&!t.hasItemOption||(r=o.getModel("lineStyle").getLineStyle(),s=o.getModel("emphasis.lineStyle").getLineStyle()),i.useStyle(L({strokeNoScale:!0,fill:"none",stroke:a},r)),i.hoverStyle=s,Xs(this)},sM.updateLayout=function(t,e){this.childAt(0).setShape("points",t.getItemLayout(e))},w(rM,Mn);var hM=lM.prototype;hM.createLine=function(t,e,n){return new rM(t,e,n)},hM.updateAnimationPoints=function(t,e){this._points=e;for(var n=[0],i=0,o=1;o<e.length;o++){var a=e[o-1],r=e[o];i+=yt(a,r),n.push(i)}if(0!==i){for(o=0;o<n.length;o++)n[o]/=i;this._offsets=n,this._length=i}},hM.getLineLength=function(t){return this._length},hM.updateSymbolPosition=function(t){var e=t.__t,n=this._points,i=this._offsets,o=n.length;if(i){var a=this._lastFrame;if(e<this._lastFramePercent){for(r=Math.min(a+1,o-1);0<=r&&!(i[r]<=e);r--);r=Math.min(r,o-2)}else{for(var r=a;r<o&&!(i[r]>e);r++);r=Math.min(r-1,o-2)}wt(t.position,n[r],n[r+1],(e-i[r])/(i[r+1]-i[r]));var s=n[r+1][0]-n[r][0],l=n[r+1][1]-n[r][1];t.rotation=-Math.atan2(l,s)-Math.PI/2,this._lastFrame=r,this._lastFramePercent=e,t.ignore=!1}},w(lM,oM);var uM=Ms({shape:{polyline:!1,curveness:0,segs:[]},buildPath:function(t,e){var n=e.segs,i=e.curveness;if(e.polyline)for(var o=0;o<n.length;){var a=n[o++];if(0<a){t.moveTo(n[o++],n[o++]);for(var r=1;r<a;r++)t.lineTo(n[o++],n[o++])}}else for(o=0;o<n.length;){var s,l,h=n[o++],u=n[o++],c=n[o++],d=n[o++];t.moveTo(h,u),0<i?(s=(h+c)/2-(u-d)*i,l=(u+d)/2-(c-h)*i,t.quadraticCurveTo(s,l,c,d)):t.lineTo(c,d)}},findDataIndex:function(t,e){var n=this.shape,i=n.segs,o=n.curveness;if(n.polyline)for(var a=0,r=0;r<i.length;){var s=i[r++];if(0<s)for(var l=i[r++],h=i[r++],u=1;u<s;u++){if(nr(l,h,c=i[r++],d=i[r++]))return a}a++}else for(a=0,r=0;r<i.length;){var l=i[r++],h=i[r++],c=i[r++],d=i[r++];if(0<o){if(or(l,h,(l+c)/2-(h-d)*o,(h+d)/2-(c-l)*o,c,d))return a}else if(nr(l,h,c,d))return a;a++}return-1}});function cM(){this.group=new Mn}var dM=cM.prototype;dM.isPersistent=function(){return!this._incremental},dM.updateData=function(t){this.group.removeAll();var e=new uM({rectHover:!0,cursor:"default"});e.setShape({segs:t.getLayout("linesPoints")}),this._setCommon(e,t),this.group.add(e),this._incremental=null},dM.incrementalPrepareUpdate=function(t){this.group.removeAll(),this._clearIncremental(),5e5<t.count()?(this._incremental||(this._incremental=new ds({silent:!0})),this.group.add(this._incremental)):this._incremental=null},dM.incrementalUpdate=function(t,e){var n=new uM;n.setShape({segs:e.getLayout("linesPoints")}),this._setCommon(n,e,!!this._incremental),this._incremental?this._incremental.addDisplayable(n,!0):(n.rectHover=!0,n.cursor="default",n.__startIndex=t.start,this.group.add(n))},dM.remove=function(){this._clearIncremental(),this._incremental=null,this.group.removeAll()},dM._setCommon=function(n,t,e){var i=t.hostModel;n.setShape({polyline:i.get("polyline"),curveness:i.get("lineStyle.curveness")}),n.useStyle(i.getModel("lineStyle").getLineStyle()),n.style.strokeNoScale=!0;var o=t.getVisual("color");o&&n.setStyle("stroke",o),n.setStyle("fill"),e||(n.seriesIndex=i.seriesIndex,n.on("mousemove",function(t){n.dataIndex=null;var e=n.findDataIndex(t.offsetX,t.offsetY);0<e&&(n.dataIndex=e+n.__startIndex)}))},dM._clearIncremental=function(){var t=this._incremental;t&&t.clearDisplaybles()};var pM={seriesType:"lines",plan:cc(),reset:function(f){var m=f.coordinateSystem,v=f.get("polyline"),y=f.pipelineContext.large;return{progress:function(t,e){var n=[];if(y){var i,o=t.end-t.start;if(v){for(var a=0,r=t.start;r<t.end;r++)a+=f.getLineCoordsCount(r);i=new Float32Array(o+2*a)}else i=new Float32Array(4*o);for(var s=0,l=[],r=t.start;r<t.end;r++){var h=f.getLineCoords(r,n);v&&(i[s++]=h);for(var u=0;u<h;u++)l=m.dataToPoint(n[u],!1,l),i[s++]=l[0],i[s++]=l[1]}e.setLayout("linesPoints",i)}else for(r=t.start;r<t.end;r++){var c=e.getItemModel(r),h=f.getLineCoords(r,n),d=[];if(v)for(var p=0;p<h;p++)d.push(m.dataToPoint(n[p]));else{d[0]=m.dataToPoint(n[0]),d[1]=m.dataToPoint(n[1]);var g=c.get("lineStyle.curveness");+g&&(d[2]=[(d[0][0]+d[1][0])/2-(d[0][1]-d[1][1])*g,(d[0][1]+d[1][1])/2-(d[1][0]-d[0][0])*g])}e.setItemLayout(r,d)}}}}};function gM(t){return t instanceof Array||(t=[t,t]),t}Mp({type:"lines",init:function(){},render:function(e,t,n){var i,o=e.getData(),a=this._updateLineDraw(o,e),r=e.get("zlevel"),s=e.get("effect.trailLength"),l=n.getZr(),h="svg"===l.painter.getType();h||l.painter.getLayer(r).clear(!0),null==this._lastZlevel||h||l.configLayer(this._lastZlevel,{motionBlur:!1}),this._showEffect(e)&&s&&(D&&(i=!1,t.eachSeries(function(t){t!==e&&t.get("zlevel")===r&&(i=!0)}),i&&console.warn("Lines with trail effect should have an individual zlevel")),h||l.configLayer(r,{motionBlur:!0,lastFrameAlpha:Math.max(Math.min(s/10+.9,1),0)})),a.updateData(o);var u=e.get("clip",!0)&&bm(e.coordinateSystem,!1,e);u?this.group.setClipPath(u):this.group.removeClipPath(),this._lastZlevel=r,this._finished=!0},incrementalPrepareRender:function(t,e,n){var i=t.getData();this._updateLineDraw(i,t).incrementalPrepareUpdate(i),this._clearLayer(n),this._finished=!1},incrementalRender:function(t,e,n){this._lineDraw.incrementalUpdate(t,e.getData()),this._finished=t.end===e.getData().count()},updateTransform:function(t,e,n){var i=t.getData(),o=t.pipelineContext;if(!this._finished||o.large||o.progressiveRender)return{update:!0};var a=pM.reset(t);a.progress&&a.progress({start:0,end:i.count()},i),this._lineDraw.updateLayout(),this._clearLayer(n)},_updateLineDraw:function(t,e){var n=this._lineDraw,i=this._showEffect(e),o=!!e.get("polyline"),a=e.pipelineContext.large;return D&&i&&a&&console.warn("Large lines not support effect"),n&&i===this._hasEffet&&o===this._isPolyline&&a===this._isLargeDraw||(n&&n.remove(),n=this._lineDraw=a?new cM:new hw(o?i?lM:rM:i?oM:sw),this._hasEffet=i,this._isPolyline=o,this._isLargeDraw=a,this.group.removeAll()),this.group.add(n.group),n},_showEffect:function(t){return!!t.get("effect.show")},_clearLayer:function(t){var e=t.getZr();"svg"===e.painter.getType()||null==this._lastZlevel||e.painter.getLayer(this._lastZlevel).clear(!0)},remove:function(t,e){this._lineDraw&&this._lineDraw.remove(),this._lineDraw=null,this._clearLayer(e)},dispose:function(){}});var fM="lineStyle.opacity".split("."),mM={seriesType:"lines",reset:function(t,e,n){var i=gM(t.get("symbol")),o=gM(t.get("symbolSize")),a=t.getData();return a.setVisual("fromSymbol",i&&i[0]),a.setVisual("toSymbol",i&&i[1]),a.setVisual("fromSymbolSize",o&&o[0]),a.setVisual("toSymbolSize",o&&o[1]),a.setVisual("opacity",t.get(fM)),{dataEach:a.hasItemOption?function(t,e){var n=t.getItemModel(e),i=gM(n.getShallow("symbol",!0)),o=gM(n.getShallow("symbolSize",!0)),a=n.get(fM);i[0]&&t.setItemVisual(e,"fromSymbol",i[0]),i[1]&&t.setItemVisual(e,"toSymbol",i[1]),o[0]&&t.setItemVisual(e,"fromSymbolSize",o[0]),o[1]&&t.setItemVisual(e,"toSymbolSize",o[1]),t.setItemVisual(e,"opacity",a)}:null}}};vp(pM),yp(mM),ec.extend({type:"series.heatmap",getInitialData:function(t,e){return dg(this.getSource(),this,{generateCoord:"value"})},preventIncremental:function(){var t=nu.get(this.get("coordinateSystem"));if(t&&t.dimensions)return"lng"===t.dimensions[0]&&"lat"===t.dimensions[1]},defaultOption:{coordinateSystem:"cartesian2d",zlevel:0,z:2,geoIndex:0,blurSize:30,pointSize:20,maxOpacity:1,minOpacity:0}});function vM(){var t=y();this.canvas=t,this.blurSize=30,this.pointSize=20,this.maxOpacity=1,this.minOpacity=0,this._gradientPixels={}}vM.prototype={update:function(t,e,n,i,o,a){var r=this._getBrush(),s=this._getGradient(t,o,"inRange"),l=this._getGradient(t,o,"outOfRange"),h=this.pointSize+this.blurSize,u=this.canvas,c=u.getContext("2d"),d=t.length;u.width=e,u.height=n;for(var p=0;p<d;++p){var g=t[p],f=g[0],m=g[1],v=i(g[2]);c.globalAlpha=v,c.drawImage(r,f-h,m-h)}if(!u.width||!u.height)return u;for(var y=c.getImageData(0,0,u.width,u.height),x=y.data,_=0,w=x.length,b=this.minOpacity,S=this.maxOpacity-b;_<w;){var M,v=x[_+3]/256,I=4*Math.floor(255*v);0<v?(M=a(v)?s:l,0<v&&(v=v*S+b),x[_++]=M[I],x[_++]=M[1+I],x[_++]=M[2+I],x[_++]=M[3+I]*v*256):_+=4}return c.putImageData(y,0,0),u},_getBrush:function(){var t=this._brushCanvas||(this._brushCanvas=y()),e=this.pointSize+this.blurSize,n=2*e;t.width=n,t.height=n;var i=t.getContext("2d");return i.clearRect(0,0,n,n),i.shadowOffsetX=n,i.shadowBlur=this.blurSize,i.shadowColor="#000",i.beginPath(),i.arc(-e,e,this.pointSize,0,2*Math.PI,!0),i.closePath(),i.fill(),t},_getGradient:function(t,e,n){for(var i=this._gradientPixels,o=i[n]||(i[n]=new Uint8ClampedArray(1024)),a=[0,0,0,0],r=0,s=0;s<256;s++)e[n](s/255,!0,a),o[r++]=a[0],o[r++]=a[1],o[r++]=a[2],o[r++]=a[3];return o}},Mp({type:"heatmap",render:function(n,t,e){var i;if(t.eachComponent("visualMap",function(e){e.eachTargetSeries(function(t){t===n&&(i=e)})}),D&&!i)throw new Error("Heatmap must use with visualMap");this.group.removeAll(),this._incrementalDisplayable=null;var o,a=n.coordinateSystem;"cartesian2d"===a.type||"calendar"===a.type?this._renderOnCartesianAndCalendar(n,e,0,n.getData().count()):"lng"===(o=a.dimensions)[0]&&"lat"===o[1]&&this._renderOnGeo(a,n,i,e)},incrementalPrepareRender:function(t,e,n){this.group.removeAll()},incrementalRender:function(t,e,n,i){e.coordinateSystem&&this._renderOnCartesianAndCalendar(e,i,t.start,t.end,!0)},_renderOnCartesianAndCalendar:function(t,e,n,i,o){var a,r,s=t.coordinateSystem;if("cartesian2d"===s.type){var l=s.getAxis("x"),h=s.getAxis("y");if(D){if("category"!==l.type||"category"!==h.type)throw new Error("Heatmap on cartesian must have two category axes");if(!l.onBand||!h.onBand)throw new Error("Heatmap on cartesian must have two axes with boundaryGap true")}a=l.getBandWidth(),r=h.getBandWidth()}for(var u=this.group,c=t.getData(),d="emphasis.itemStyle",p="emphasis.label",g=t.getModel("itemStyle").getItemStyle(["color"]),f=t.getModel(d).getItemStyle(),m=t.getModel("label"),v=t.getModel(p),y=s.type,x="cartesian2d"===y?[c.mapDimension("x"),c.mapDimension("y"),c.mapDimension("value")]:[c.mapDimension("time"),c.mapDimension("value")],_=n;_<i;_++){if("cartesian2d"===y){if(isNaN(c.get(x[2],_)))continue;var w=s.dataToPoint([c.get(x[0],_),c.get(x[1],_)]),b=new es({shape:{x:Math.floor(w[0]-a/2),y:Math.floor(w[1]-r/2),width:Math.ceil(a),height:Math.ceil(r)},style:{fill:c.getItemVisual(_,"color"),opacity:c.getItemVisual(_,"opacity")}})}else{if(isNaN(c.get(x[1],_)))continue;b=new es({z2:1,shape:s.dataToRect([c.get(x[0],_)]).contentShape,style:{fill:c.getItemVisual(_,"color"),opacity:c.getItemVisual(_,"opacity")}})}var S=c.getItemModel(_);c.hasItemOption&&(g=S.getModel("itemStyle").getItemStyle(["color"]),f=S.getModel(d).getItemStyle(),m=S.getModel("label"),v=S.getModel(p));var M=t.getRawValue(_),I="-";M&&null!=M[2]&&(I=M[2]),Ks(g,f,m,v,{labelFetcher:t,labelDataIndex:_,defaultText:I,isRectText:!0}),b.setStyle(g),Xs(b,c.hasItemOption?f:k({},f)),(b.incremental=o)&&(b.useHoverLayer=!0),u.add(b),c.setItemGraphicEl(_,b)}},_renderOnGeo:function(o,t,e,n){var i=e.targetVisuals.inRange,a=e.targetVisuals.outOfRange,r=t.getData(),s=this._hmLayer||this._hmLayer||new vM;s.blurSize=t.get("blurSize"),s.pointSize=t.get("pointSize"),s.minOpacity=t.get("minOpacity"),s.maxOpacity=t.get("maxOpacity");var l=o.getViewRect().clone(),h=o.getRoamTransform();l.applyTransform(h);var u,c,d,p,g,f,m,v,y,x=Math.max(l.x,0),_=Math.max(l.y,0),w=Math.min(l.width+l.x,n.getWidth()),b=Math.min(l.height+l.y,n.getHeight()),S=w-x,M=b-_,I=[r.mapDimension("lng"),r.mapDimension("lat"),r.mapDimension("value")],T=r.mapArray(I,function(t,e,n){var i=o.dataToPoint([t,e]);return i[0]-=x,i[1]-=_,i.push(n),i}),A=e.getExtent(),D="visualMap.continuous"===e.type?(m=A,v=e.option.range,y=m[1]-m[0],v=[(v[0]-m[0])/y,(v[1]-m[0])/y],function(t){return t>=v[0]&&t<=v[1]}):(u=A,c=e.getPieceList(),d=e.option.selected,p=u[1]-u[0],g=(c=N(c,function(t){return{interval:[(t.interval[0]-u[0])/p,(t.interval[1]-u[0])/p]}})).length,f=0,function(t){for(var e=f;e<g;e++)if((n=c[e].interval)[0]<=t&&t<=n[1]){f=e;break}if(e===g)for(var n,e=f-1;0<=e;e--)if((n=c[e].interval)[0]<=t&&t<=n[1]){f=e;break}return 0<=e&&e<g&&d[e]});s.update(T,S,M,i.color.getNormalizer(),{inRange:i.color.getColorMapper(),outOfRange:a.color.getColorMapper()},D);var C=new Yi({style:{width:S,height:M,x:x,y:_,image:s.canvas},silent:!0});this.group.add(C)},dispose:function(){}});var yM=bv.extend({type:"series.pictorialBar",dependencies:["grid"],defaultOption:{symbol:"circle",symbolSize:null,symbolRotate:null,symbolPosition:null,symbolOffset:null,symbolMargin:null,symbolRepeat:!1,symbolRepeatDirection:"end",symbolClip:!1,symbolBoundingData:null,symbolPatternSize:400,barGap:"-100%",progressive:0,hoverAnimation:!1},getInitialData:function(t){return t.stack=null,yM.superApply(this,"getInitialData",arguments)}}),xM=["itemStyle","borderWidth"],_M=[{xy:"x",wh:"width",index:0,posDesc:["left","right"]},{xy:"y",wh:"height",index:1,posDesc:["top","bottom"]}],wM=new Wr;Mp({type:"pictorialBar",render:function(t,e,n){var r=this.group,s=t.getData(),l=this._data,i=t.coordinateSystem,o=!!i.getBaseAxis().isHorizontal(),a=i.grid.getRect(),h={ecSize:{width:n.getWidth(),height:n.getHeight()},seriesModel:t,coordSys:i,coordSysExtent:[[a.x,a.x+a.width],[a.y,a.y+a.height]],isHorizontal:o,valueDim:_M[+o],categoryDim:_M[1-o]};return s.diff(l).add(function(t){var e,n,i;s.hasValue(t)&&(e=CM(s,t),n=bM(s,t,e,h),i=NM(s,h,n),s.setItemGraphicEl(t,i),r.add(i),BM(i,h,n))}).update(function(t,e){var n,i,o,a=l.getItemGraphicEl(e);s.hasValue(t)?(n=CM(s,t),i=bM(s,t,n,h),o=EM(s,i),a&&o!==a.__pictorialShapeStr&&(r.remove(a),s.setItemGraphicEl(t,null),a=null),a?function(t,e,n){var i=n.animationModel,o=n.dataIndex;rl(t.__pictorialBundle,{position:n.bundlePosition.slice()},i,o),(n.symbolRepeat?IM:TM)(t,e,n,!0);AM(t,n,!0),DM(t,e,n,!0)}(a,h,i):a=NM(s,h,i,!0),s.setItemGraphicEl(t,a),a.__pictorialSymbolMeta=i,r.add(a),BM(a,h,i)):r.remove(a)}).remove(function(t){var e=l.getItemGraphicEl(t);e&&OM(l,t,e.__pictorialSymbolMeta.animationModel,e)}).execute(),this._data=s,this.group},dispose:it,remove:function(e,t){var n=this.group,i=this._data;e.get("animation")?i&&i.eachItemGraphicEl(function(t){OM(i,t.dataIndex,e,t)}):n.removeAll()}});function bM(t,e,n,i){var o=t.getItemLayout(e),a=n.get("symbolRepeat"),r=n.get("symbolClip"),s=n.get("symbolPosition")||"start",l=(n.get("symbolRotate")||0)*Math.PI/180||0,h=n.get("symbolPatternSize")||2,u=n.isAnimationEnabled(),c={dataIndex:e,layout:o,itemModel:n,symbolType:t.getItemVisual(e,"symbol")||"circle",color:t.getItemVisual(e,"color"),symbolClip:r,symbolRepeat:a,symbolRepeatDirection:n.get("symbolRepeatDirection"),symbolPatternSize:h,rotation:l,animationModel:u?n:null,hoverAnimation:u&&n.get("hoverAnimation"),z2:n.getShallow("z",!0)||0};!function(t,e,n,i,o){var a,r=i.valueDim,s=t.get("symbolBoundingData"),l=i.coordSys.getOtherAxis(i.coordSys.getBaseAxis()),h=l.toGlobalCoord(l.dataToCoord(0)),u=1-(n[r.wh]<=0);{var c;a=R(s)?((c=[SM(l,s[0])-h,SM(l,s[1])-h])[1]<c[0]&&c.reverse(),c[u]):null!=s?SM(l,s)-h:e?i.coordSysExtent[r.index][u]-h:n[r.wh]}o.boundingLength=a,e&&(o.repeatCutLength=n[r.wh]);o.pxSign=0<a?1:a<0?-1:0}(n,a,o,i,c),function(t,e,n,i,o,a,r,s,l){var h=s.valueDim,u=s.categoryDim,c=Math.abs(n[u.wh]),d=t.getItemVisual(e,"symbolSize");d=R(d)?d.slice():(null==d&&(d="100%"),[d,d]);d[u.index]=Ll(d[u.index],c),d[h.index]=Ll(d[h.index],i?c:Math.abs(o)),l.symbolSize=d,(l.symbolScale=[d[0]/r,d[1]/r])[h.index]*=(s.isHorizontal?-1:1)*a}(t,e,o,a,c.boundingLength,c.pxSign,h,i,c),function(t,e,n,i,o){var a=t.get(xM)||0;a&&(wM.attr({scale:e.slice(),rotation:n}),wM.updateTransform(),a/=wM.getLineScale(),a*=e[i.valueDim.index]);o.valueLineWidth=a}(n,c.symbolScale,l,i,c);var d=c.symbolSize,p=n.get("symbolOffset");return R(p)&&(p=[Ll(p[0],d[0]),Ll(p[1],d[1])]),function(t,e,n,i,o,a,r,s,l,h,u){var c=h.categoryDim,d=h.valueDim,p=u.pxSign,g=Math.max(e[d.index]+r,0),f=g;{var m,v,y,x,_,w,b;i&&(m=Math.abs(s),v=Z(t.get("symbolMargin"),"15%")+"",y=!1,v.lastIndexOf("!")===v.length-1&&(y=!0,v=v.slice(0,v.length-1)),v=Ll(v,e[d.index]),x=Math.max(g+2*v,0),_=y?0:2*v,w=Xl(i),b=w?i:VM((m+_)/x),x=g+2*(v=(m-b*g)/2/(y?b:b-1)),_=y?0:2*v,w||"fixed"===i||(b=l?VM((Math.abs(l)+_)/x):0),f=b*x-_,u.repeatTimes=b,u.symbolMargin=v)}var S=p*(f/2),M=u.pathPosition=[];M[c.index]=n[c.wh]/2,M[d.index]="start"===a?S:"end"===a?s-S:s/2,o&&(M[0]+=o[0],M[1]+=o[1]);var I=u.bundlePosition=[];I[c.index]=n[c.xy],I[d.index]=n[d.xy];var T=u.barRectShape=k({},n);T[d.wh]=p*Math.max(Math.abs(n[d.wh]),Math.abs(M[d.index]+S)),T[c.wh]=n[c.wh];var A=u.clipShape={};A[c.xy]=-n[c.xy],A[c.wh]=h.ecSize[c.wh],A[d.xy]=0,A[d.wh]=n[d.wh]}(n,d,o,a,p,s,c.valueLineWidth,c.boundingLength,c.repeatCutLength,i,c),c}function SM(t,e){return t.toGlobalCoord(t.dataToCoord(t.scale.parse(e)))}function MM(t){var e=t.symbolPatternSize,n=xf(t.symbolType,-e/2,-e/2,e,e,t.color);return n.attr({culling:!0}),"image"!==n.type&&n.setStyle({strokeNoScale:!0}),n}function IM(t,e,o,n){var i=t.__pictorialBundle,a=o.symbolSize,r=o.valueLineWidth,s=o.pathPosition,l=e.valueDim,h=o.repeatTimes||0,u=0,c=a[e.valueDim.index]+r+2*o.symbolMargin;for(zM(t,function(t){t.__pictorialAnimationIndex=u,t.__pictorialRepeatTimes=h,u<h?RM(t,null,g(u),o,n):RM(t,null,{scale:[0,0]},o,n,function(){i.remove(t)}),PM(t,o),u++});u<h;u++){var d=MM(o);d.__pictorialAnimationIndex=u,d.__pictorialRepeatTimes=h,i.add(d);var p=g(u);RM(d,{position:p.position,scale:[0,0]},{scale:p.scale,rotation:p.rotation},o,n),d.on("mouseover",f).on("mouseout",m),PM(d,o)}function g(t){var e=s.slice(),n=o.pxSign,i=t;return("start"===o.symbolRepeatDirection?0<n:n<0)&&(i=h-1-t),e[l.index]=c*(i-h/2+.5)+s[l.index],{position:e,scale:o.symbolScale.slice(),rotation:o.rotation}}function f(){zM(t,function(t){t.trigger("emphasis")})}function m(){zM(t,function(t){t.trigger("normal")})}}function TM(t,e,n,i){var o=t.__pictorialBundle,a=t.__pictorialMainPath;a?RM(a,null,{position:n.pathPosition.slice(),scale:n.symbolScale.slice(),rotation:n.rotation},n,i):(a=t.__pictorialMainPath=MM(n),o.add(a),RM(a,{position:n.pathPosition.slice(),scale:[0,0],rotation:n.rotation},{scale:n.symbolScale.slice()},n,i),a.on("mouseover",function(){this.trigger("emphasis")}).on("mouseout",function(){this.trigger("normal")})),PM(a,n)}function AM(t,e,n){var i=k({},e.barRectShape),o=t.__pictorialBarRect;o?RM(o,null,{shape:i},e,n):(o=t.__pictorialBarRect=new es({z2:2,shape:i,silent:!0,style:{stroke:"transparent",fill:"transparent",lineWidth:0}}),t.add(o))}function DM(t,e,n,i){var o,a,r,s,l,h;n.symbolClip&&(o=t.__pictorialClipPath,a=k({},n.clipShape),r=e.valueDim,s=n.animationModel,l=n.dataIndex,o?rl(o,{shape:a},s,l):(a[r.wh]=0,o=new es({shape:a}),t.__pictorialBundle.setClipPath(o),t.__pictorialClipPath=o,(h={})[r.wh]=n.clipShape[r.wh],ml[i?"updateProps":"initProps"](o,{shape:h},s,l)))}function CM(t,e){var n=t.getItemModel(e);return n.getAnimationDelayParams=LM,n.isAnimationEnabled=kM,n}function LM(t){return{index:t.__pictorialAnimationIndex,count:t.__pictorialRepeatTimes}}function kM(){return this.parentModel.isAnimationEnabled()&&!!this.getShallow("animation")}function PM(t,e){t.off("emphasis").off("normal");var n=e.symbolScale.slice();e.hoverAnimation&&t.on("emphasis",function(){this.animateTo({scale:[1.1*n[0],1.1*n[1]]},400,"elasticOut")}).on("normal",function(){this.animateTo({scale:n.slice()},400,"elasticOut")})}function NM(t,e,n,i){var o=new Mn,a=new Mn;return o.add(a),(o.__pictorialBundle=a).attr("position",n.bundlePosition.slice()),n.symbolRepeat?IM(o,e,n):TM(o,0,n),AM(o,n,i),DM(o,e,n,i),o.__pictorialShapeStr=EM(t,n),o.__pictorialSymbolMeta=n,o}function OM(t,e,n,i){var o=i.__pictorialBarRect;o&&(o.style.text=null);var a=[];zM(i,function(t){a.push(t)}),i.__pictorialMainPath&&a.push(i.__pictorialMainPath),i.__pictorialClipPath&&(n=null),P(a,function(t){rl(t,{scale:[0,0]},n,e,function(){i.parent&&i.parent.remove(i)})}),t.setItemGraphicEl(e,null)}function EM(t,e){return[t.getItemVisual(e.dataIndex,"symbol")||"none",!!e.symbolRepeat,!!e.symbolClip].join(":")}function zM(e,n,i){P(e.__pictorialBundle.children(),function(t){t!==e.__pictorialBarRect&&n.call(i,t)})}function RM(t,e,n,i,o,a){e&&t.attr(e),i.symbolClip&&!o?n&&t.attr(n):n&&ml[o?"updateProps":"initProps"](t,n,i.animationModel,i.dataIndex,a)}function BM(t,e,n){var i=n.color,o=n.dataIndex,a=n.itemModel,r=a.getModel("itemStyle").getItemStyle(["color"]),s=a.getModel("emphasis.itemStyle").getItemStyle(),l=a.getShallow("cursor");zM(t,function(t){t.setColor(i),t.setStyle(L({fill:i,opacity:n.opacity},r)),Xs(t,s),l&&(t.cursor=l),t.z2=n.z2});var h={},u=(e.valueDim.posDesc[+(0<n.boundingLength)],t.__pictorialBarRect);Sv(u.style,h,a,i,e.seriesModel,o),Xs(u,h)}function VM(t){var e=Math.round(t);return Math.abs(t-e)<1e-4?e:Math.ceil(t)}vp(z(Og,"pictorialBar")),yp(Dm("pictorialBar","roundRect"));function GM(t,e,n,i,o){Bf.call(this,t,e,n),this.type=i||"value",this.position=o||"bottom",this.orient=null}function FM(t,e,n){this.dimension="single",this.dimensions=["single"],this._axis=null,this._rect,this._init(t,e,n),this.model=t}function WM(t,e){e=e||{};var n=t.coordinateSystem,i=t.axis,o={},a=i.position,r=i.orient,s=n.getRect(),l=[s.x,s.x+s.width,s.y,s.y+s.height],h={horizontal:{top:l[2],bottom:l[3]},vertical:{left:l[0],right:l[1]}};o.position=["vertical"===r?h.vertical[a]:l[0],"horizontal"===r?h.horizontal[a]:l[3]];o.rotation=Math.PI/2*{horizontal:0,vertical:1}[r];o.labelDirection=o.tickDirection=o.nameDirection={top:-1,bottom:1,right:1,left:-1}[a],t.get("axisTick.inside")&&(o.tickDirection=-o.tickDirection),Z(e.labelInside,t.get("axisLabel.inside"))&&(o.labelDirection=-o.labelDirection);var u=e.rotate;return null==u&&(u=t.get("axisLabel.rotate")),o.labelRotation="top"===a?-u:u,o.z2=1,o}GM.prototype={constructor:GM,model:null,isHorizontal:function(){var t=this.position;return"top"===t||"bottom"===t},pointToData:function(t,e){return this.coordinateSystem.pointToData(t,e)[0]},toGlobalCoord:null,toLocalCoord:null},w(GM,Bf),nu.register("single",{create:function(i,o){var a=[];return i.eachComponent("singleAxis",function(t,e){var n=new FM(t,i,o);n.name="single_"+e,n.resize(t,o),t.coordinateSystem=n,a.push(n)}),i.eachSeries(function(t){var e;"singleAxis"===t.get("coordinateSystem")&&(e=i.queryComponents({mainType:"singleAxis",index:t.get("singleAxisIndex"),id:t.get("singleAxisId")})[0],t.coordinateSystem=e&&e.coordinateSystem)}),a},dimensions:(FM.prototype={type:"singleAxis",axisPointerEnabled:!0,constructor:FM,_init:function(t,e,n){var i=this.dimension,o=new GM(i,af(t),[0,0],t.get("type"),t.get("position")),a="category"===o.type;o.onBand=a&&t.get("boundaryGap"),o.inverse=t.get("inverse"),o.orient=t.get("orient"),(t.axis=o).model=t,(o.coordinateSystem=this)._axis=o},update:function(t,e){t.eachSeries(function(t){var e;t.coordinateSystem===this&&(P((e=t.getData()).mapDimension(this.dimension,!0),function(t){this._axis.scale.unionExtentFromData(e,t)},this),of(this._axis.scale,this._axis.model))},this)},resize:function(t,e){this._rect=fh({left:t.get("left"),top:t.get("top"),right:t.get("right"),bottom:t.get("bottom"),width:t.get("width"),height:t.get("height")},{width:e.getWidth(),height:e.getHeight()}),this._adjustAxis()},getRect:function(){return this._rect},_adjustAxis:function(){var t=this._rect,e=this._axis,n=e.isHorizontal(),i=n?[0,t.width]:[0,t.height],o=e.reverse?1:0;e.setExtent(i[o],i[1-o]),this._updateAxisTransform(e,n?t.x:t.y)},_updateAxisTransform:function(t,e){var n=t.getExtent(),i=n[0]+n[1],o=t.isHorizontal();t.toGlobalCoord=o?function(t){return t+e}:function(t){return i-t+e},t.toLocalCoord=o?function(t){return t-e}:function(t){return i-t+e}},getAxis:function(){return this._axis},getBaseAxis:function(){return this._axis},getAxes:function(){return[this._axis]},getTooltipAxes:function(){return{baseAxes:[this.getAxis()]}},containPoint:function(t){var e=this.getRect(),n=this.getAxis();return"horizontal"===n.orient?n.contain(n.toLocalCoord(t[0]))&&t[1]>=e.y&&t[1]<=e.y+e.height:n.contain(n.toLocalCoord(t[1]))&&t[0]>=e.y&&t[0]<=e.y+e.height},pointToData:function(t){var e=this.getAxis();return[e.coordToData(e.toLocalCoord(t["horizontal"===e.orient?0:1]))]},dataToPoint:function(t){var e=this.getAxis(),n=this.getRect(),i=[],o="horizontal"===e.orient?0:1;return t instanceof Array&&(t=t[0]),i[o]=e.toGlobalCoord(e.dataToCoord(+t)),i[1-o]=0==o?n.y+n.height/2:n.x+n.width/2,i}}).dimensions});var HM=["axisLine","axisTickLabel","axisName"],ZM="splitLine",UM=gv.extend({type:"singleAxis",axisPointerClass:"SingleAxisPointer",render:function(t,e,n,i){var o=this.group;o.removeAll();var a=WM(t),r=new $m(t,a);P(HM,r.add,r),o.add(r.getGroup()),t.get(ZM+".show")&&this["_"+ZM](t),UM.superCall(this,"render",t,e,n,i)},_splitLine:function(t){var e=t.axis;if(!e.scale.isBlank()){for(var n=t.getModel("splitLine"),i=n.getModel("lineStyle"),o=i.get("width"),a=(a=i.get("color"))instanceof Array?a:[a],r=t.coordinateSystem.getRect(),s=e.isHorizontal(),l=[],h=0,u=e.getTicksCoords({tickModel:n}),c=[],d=[],p=0;p<u.length;++p){var g=e.toGlobalCoord(u[p].coord);s?(c[0]=g,c[1]=r.y,d[0]=g,d[1]=r.y+r.height):(c[0]=r.x,c[1]=g,d[0]=r.x+r.width,d[1]=g);var f=h++%a.length;l[f]=l[f]||[],l[f].push(new is({subPixelOptimize:!0,shape:{x1:c[0],y1:c[1],x2:d[0],y2:d[1]},style:{lineWidth:o},silent:!0}))}for(p=0;p<l.length;++p)this.group.add(Ls(l[p],{style:{stroke:a[p%a.length],lineDash:i.getLineDash(o),lineWidth:o},silent:!0}))}}}),XM=Mh.extend({type:"singleAxis",layoutMode:"box",axis:null,coordinateSystem:null,getCoordSysModel:function(){return this}});m(XM.prototype,uf),Bm("single",XM,function(t,e){return e.type||(e.data?"category":"value")},{left:"5%",top:"5%",right:"5%",bottom:"5%",type:"value",position:"bottom",orient:"horizontal",axisLine:{show:!0,lineStyle:{width:1,type:"solid"}},tooltip:{show:!0},axisTick:{show:!0,length:6,lineStyle:{width:1}},axisLabel:{show:!0,interval:"auto"},splitLine:{show:!0,lineStyle:{type:"dashed",opacity:.2}}});function YM(t,e){var n,i=[],o=t.seriesIndex;if(null==o||!(n=e.getSeriesByIndex(o)))return{point:[]};var a=n.getData(),r=Wo(a,t);if(null==r||r<0||R(r))return{point:[]};var s,l=a.getItemGraphicEl(r),h=n.coordinateSystem;return n.getTooltipPosition?i=n.getTooltipPosition(r)||[]:h&&h.dataToPoint?i=h.dataToPoint(a.getValues(N(h.dimensions,function(t){return a.mapDimension(t)}),r,!0))||[]:l&&((s=l.getBoundingRect().clone()).applyTransform(l.transform),i=[s.x+s.width/2,s.y+s.height/2]),{point:i,el:l}}var jM=P,qM=z,KM=Ho();function $M(t,e,n,i,o){var a,l,r,h,u,c,d,p,g,s,f,m=t.axis;!m.scale.isBlank()&&m.containData(e)&&(t.involveSeries?(f=(a=(l=e,h=(r=t).axis,u=h.dim,c=l,d=[],p=Number.MAX_VALUE,g=-1,jM(r.seriesModels,function(e,t){var n,i,o=e.getData().mapDimension(u,!0);if(e.getAxisTooltipData)var a=e.getAxisTooltipData(o,l,h),r=a.dataIndices,s=a.nestestValue;else{if(!(r=e.getData().indicesOfNearest(o[0],l,"category"===h.type?.5:null)).length)return;s=e.getData().get(o[0],r[0])}null!=s&&isFinite(s)&&(n=l-s,(i=Math.abs(n))<=p&&((i<p||0<=n&&g<0)&&(p=i,g=n,c=s,d.length=0),jM(r,function(t){d.push({seriesIndex:e.seriesIndex,dataIndexInside:t,dataIndex:e.getData().getRawIndex(t)})})))}),{payloadBatch:d,snapToValue:c})).snapToValue,(s=a.payloadBatch)[0]&&null==o.seriesIndex&&k(o,s[0]),!i&&t.snap&&m.containData(f)&&null!=f&&(e=f),n.showPointer(t,e,s,o),n.showTooltip(t,a,f)):n.showPointer(t,e))}function JM(t,e,n,i){t[e.key]={value:n,payloadBatch:i}}function QM(t,e,n,i){var o,a,r,s=n.payloadBatch,l=e.axis,h=l.model,u=e.axisPointerModel;e.triggerTooltip&&s.length&&(a=pv(o=e.coordSys.model),(r=t.map[a])||(r=t.map[a]={coordSysId:o.id,coordSysIndex:o.componentIndex,coordSysType:o.type,coordSysMainType:o.mainType,dataByAxis:[]},t.list.push(r)),r.dataByAxis.push({axisDim:l.dim,axisIndex:h.componentIndex,axisType:h.type,axisId:h.id,value:i,valueLabelOpt:{precision:u.get("label.precision"),formatter:u.get("label.formatter")},seriesDataIndices:s.slice()}))}function tI(t){var e=t.axis.model,n={},i=n.axisDim=t.axis.dim;return n.axisIndex=n[i+"AxisIndex"]=e.componentIndex,n.axisName=n[i+"AxisName"]=e.name,n.axisId=n[i+"AxisId"]=e.id,n}function eI(t){return!t||null==t[0]||isNaN(t[0])||null==t[1]||isNaN(t[1])}wp({type:"axisPointer",coordSysAxesInfo:null,defaultOption:{show:"auto",triggerOn:null,zlevel:0,z:50,type:"line",snap:!1,triggerTooltip:!0,value:null,status:null,link:[],animation:null,animationDurationUpdate:200,lineStyle:{color:"#aaa",width:1,type:"solid"},shadowStyle:{color:"rgba(150,150,150,0.3)"},label:{show:!0,formatter:null,precision:"auto",margin:3,color:"#fff",padding:[5,7,5,7],backgroundColor:"auto",borderColor:null,borderWidth:0,shadowBlur:3,shadowColor:"#aaa"},handle:{show:!1,icon:"M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7v-1.2h6.6z M13.3,22H6.7v-1.2h6.6z M13.3,19.6H6.7v-1.2h6.6z",size:45,margin:50,color:"#333",shadowBlur:3,shadowColor:"#aaa",shadowOffsetX:0,shadowOffsetY:2,throttle:40}}});var nI=Ho(),iI=P;function oI(t,e,n){var i;v.node||(i=e.getZr(),nI(i).records||(nI(i).records={}),function(s,l){if(nI(s).initialized)return;function t(t,r){s.on(t,function(e){var n,i,o,a=(n=l,{dispatchAction:o=function(t){var e=i[t.type];e?e.push(t):(t.dispatchAction=o,n.dispatchAction(t))},pendings:i={showTip:[],hideTip:[]}});iI(nI(s).records,function(t){t&&r(t,e,a.dispatchAction)}),function(t,e){var n,i=t.showTip.length,o=t.hideTip.length;i?n=t.showTip[i-1]:o&&(n=t.hideTip[o-1]);n&&(n.dispatchAction=null,e.dispatchAction(n))}(a.pendings,l)})}nI(s).initialized=!0,t("click",z(rI,"click")),t("mousemove",z(rI,"mousemove")),t("globalout",aI)}(i,e),(nI(i).records[t]||(nI(i).records[t]={})).handler=n)}function aI(t,e,n){t.handler("leave",null,n)}function rI(t,e,n,i){e.handler(t,n,i)}function sI(t,e){var n;v.node||(n=e.getZr(),(nI(n).records||{})[t]&&(nI(n).records[t]=null))}var lI=bp({type:"axisPointer",render:function(t,e,n){var i=e.getComponent("tooltip"),o=t.get("triggerOn")||i&&i.get("triggerOn")||"mousemove|click";oI("axisPointer",n,function(t,e,n){"none"!==o&&("leave"===t||0<=o.indexOf(t))&&n({type:"updateAxisPointer",currTrigger:t,x:e&&e.offsetX,y:e&&e.offsetY})})},remove:function(t,e){sI(e.getZr(),"axisPointer"),lI.superApply(this._model,"remove",arguments)},dispose:function(t,e){sI("axisPointer",e),lI.superApply(this._model,"dispose",arguments)}}),hI=Ho(),uI=C,cI=E;function dI(){}function pI(t,e,n,i){!function n(i,t){{if(V(i)&&V(t)){var o=!0;return P(t,function(t,e){o=o&&n(i[e],t)}),!!o}return i===t}}(hI(n).lastProp,i)&&(hI(n).lastProp=i,e?rl(n,i,t):(n.stopAnimation(),n.attr(i)))}function gI(t,e){t[e.get("label.show")?"show":"hide"]()}function fI(t){return{position:t.position.slice(),rotation:t.rotation||0}}function mI(t,e,n){var i=e.get("z"),o=e.get("zlevel");t&&t.traverse(function(t){"group"!==t.type&&(null!=i&&(t.z=i),null!=o&&(t.zlevel=o),t.silent=n)})}function vI(t){var e,n=t.get("type"),i=t.getModel(n+"Style");return"line"===n?(e=i.getLineStyle()).fill=null:"shadow"===n&&((e=i.getAreaStyle()).stroke=null),e}function yI(t,e,n,i,o){var a=xI(n.get("value"),e.axis,e.ecModel,n.get("seriesDataIndices"),{precision:n.get("label.precision"),formatter:n.get("label.formatter")}),r=n.getModel("label"),s=Kl(r.get("padding")||0),l=r.getFont(),h=hi(a,l),u=o.position,c=h.width+s[1]+s[3],d=h.height+s[0]+s[2],p=o.align;"right"===p&&(u[0]-=c),"center"===p&&(u[0]-=c/2);var g,f,m,v,y,x,_=o.verticalAlign;"bottom"===_&&(u[1]-=d),"middle"===_&&(u[1]-=d/2),g=u,f=c,m=d,y=(v=i).getWidth(),x=v.getHeight(),g[0]=Math.min(g[0]+f,y)-f,g[1]=Math.min(g[1]+m,x)-m,g[0]=Math.max(g[0],0),g[1]=Math.max(g[1],0);var w=r.get("backgroundColor");w&&"auto"!==w||(w=e.get("axisLine.lineStyle.color")),t.label={shape:{x:0,y:0,width:c,height:d,r:r.get("borderRadius")},position:u.slice(),style:{text:a,textFont:l,textFill:r.getTextColor(),textPosition:"inside",textPadding:s,fill:w,stroke:r.get("borderColor")||"transparent",lineWidth:r.get("borderWidth")||0,shadowBlur:r.get("shadowBlur"),shadowColor:r.get("shadowColor"),shadowOffsetX:r.get("shadowOffsetX"),shadowOffsetY:r.get("shadowOffsetY")},z2:10}}function xI(t,e,o,n,i){t=e.scale.parse(t);var a,r=e.scale.getLabel(t,{precision:i.precision}),s=i.formatter;return s&&(a={value:sf(e,t),axisDimension:e.dim,axisIndex:e.index,seriesData:[]},P(n,function(t){var e=o.getSeriesByIndex(t.seriesIndex),n=t.dataIndexInside,i=e&&e.getDataParams(n);i&&a.seriesData.push(i)}),B(s)?r=s.replace("{value}",r):A(s)&&(r=s(a))),r}function _I(t,e,n){var i=ee();return re(i,i,n.rotation),ae(i,i,n.position),hl([t.dataToCoord(e),(n.labelOffset||0)+(n.labelDirection||1)*(n.labelMargin||0)],i)}function wI(t,e,n,i,o,a){var r=$m.innerTextLayout(n.rotation,0,n.labelDirection);n.labelMargin=o.get("label.margin"),yI(e,i,o,a,{position:_I(i.axis,t,n),align:r.textAlign,verticalAlign:r.textVerticalAlign})}function bI(t,e,n){return{x1:t[n=n||0],y1:t[1-n],x2:e[n],y2:e[1-n]}}function SI(t,e,n){return{x:t[n=n||0],y:t[1-n],width:e[n],height:e[1-n]}}function MI(t,e,n,i,o,a){return{cx:t,cy:e,r0:n,r:i,startAngle:o,endAngle:a,clockwise:!0}}Qo((dI.prototype={_group:null,_lastGraphicKey:null,_handle:null,_dragging:!1,_lastValue:null,_lastStatus:null,_payloadInfo:null,animationThreshold:15,render:function(t,e,n,i){var o=e.get("value"),a=e.get("status");if(this._axisModel=t,this._axisPointerModel=e,this._api=n,i||this._lastValue!==o||this._lastStatus!==a){this._lastValue=o,this._lastStatus=a;var r=this._group,s=this._handle;if(!a||"hide"===a)return r&&r.hide(),void(s&&s.hide());r&&r.show(),s&&s.show();var l={};this.makeElOption(l,o,t,e,n);var h=l.graphicKey;h!==this._lastGraphicKey&&this.clear(n),this._lastGraphicKey=h;var u,c=this._moveAnimation=this.determineAnimation(t,e);r?(u=z(pI,e,c),this.updatePointerEl(r,l,u,e),this.updateLabelEl(r,l,u,e)):(r=this._group=new Mn,this.createPointerEl(r,l,t,e),this.createLabelEl(r,l,t,e),n.getZr().add(r)),mI(r,e,!0),this._renderHandle(o)}},remove:function(t){this.clear(t)},dispose:function(t){this.clear(t)},determineAnimation:function(t,e){var n=e.get("animation"),i=t.axis,o="category"===i.type,a=e.get("snap");if(!a&&!o)return!1;if("auto"!==n&&null!=n)return!0===n;var r=this.animationThreshold;if(o&&i.getBandWidth()>r)return!0;if(a){var s=cv(t).seriesDataCount,l=i.getExtent();return Math.abs(l[0]-l[1])/s>r}return!1},makeElOption:function(t,e,n,i,o){},createPointerEl:function(t,e,n,i){var o,a=e.pointer;a&&(o=hI(t).pointerEl=new ml[a.type](uI(e.pointer)),t.add(o))},createLabelEl:function(t,e,n,i){var o;e.label&&(o=hI(t).labelEl=new es(uI(e.label)),t.add(o),gI(o,i))},updatePointerEl:function(t,e,n){var i=hI(t).pointerEl;i&&e.pointer&&(i.setStyle(e.pointer.style),n(i,{shape:e.pointer.shape}))},updateLabelEl:function(t,e,n,i){var o=hI(t).labelEl;o&&(o.setStyle(e.label.style),n(o,{shape:e.label.shape,position:e.label.position}),gI(o,i))},_renderHandle:function(t){if(!this._dragging&&this.updateHandleTransform){var e,n=this._axisPointerModel,i=this._api.getZr(),o=this._handle,a=n.getModel("handle"),r=n.get("status");if(!a.get("show")||!r||"hide"===r)return o&&i.remove(o),void(this._handle=null);this._handle||(e=!0,o=this._handle=pl(a.get("icon"),{cursor:"move",draggable:!0,onmousemove:function(t){Wt(t.event)},onmousedown:cI(this._onHandleDragMove,this,0,0),drift:cI(this._onHandleDragMove,this),ondragend:cI(this._onHandleDragEnd,this)}),i.add(o)),mI(o,n,!1);o.setStyle(a.getItemStyle(null,["color","borderColor","borderWidth","opacity","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"]));var s=a.get("size");R(s)||(s=[s,s]),o.attr("scale",[s[0]/2,s[1]/2]),Ic(this,"_doDispatchAxisPointer",a.get("throttle")||0,"fixRate"),this._moveHandleToValue(t,e)}},_moveHandleToValue:function(t,e){pI(this._axisPointerModel,!e&&this._moveAnimation,this._handle,fI(this.getHandleTransform(t,this._axisModel,this._axisPointerModel)))},_onHandleDragMove:function(t,e){var n,i=this._handle;i&&(this._dragging=!0,n=this.updateHandleTransform(fI(i),[t,e],this._axisModel,this._axisPointerModel),this._payloadInfo=n,i.stopAnimation(),i.attr(fI(n)),hI(i).lastProp=null,this._doDispatchAxisPointer())},_doDispatchAxisPointer:function(){var t,e;this._handle&&(t=this._payloadInfo,e=this._axisModel,this._api.dispatchAction({type:"updateAxisPointer",x:t.cursorPoint[0],y:t.cursorPoint[1],tooltipOption:t.tooltipOption,axesInfo:[{axisDim:e.axis.dim,axisIndex:e.componentIndex}]}))},_onHandleDragEnd:function(t){var e;this._dragging=!1,this._handle&&(e=this._axisPointerModel.get("value"),this._moveHandleToValue(e),this._api.dispatchAction({type:"hideTip"}))},getHandleTransform:null,updateHandleTransform:null,clear:function(t){this._lastValue=null,this._lastStatus=null;var e=t.getZr(),n=this._group,i=this._handle;e&&n&&(this._lastGraphicKey=null,n&&e.remove(n),i&&e.remove(i),this._group=null,this._handle=null,this._payloadInfo=null)},doClear:function(){},buildLabel:function(t,e,n){return{x:t[n=n||0],y:t[1-n],width:e[n],height:e[1-n]}}}).constructor=dI);var II=dI.extend({makeElOption:function(t,e,n,i,o){var a,r,s=n.axis,l=s.grid,h=i.get("type"),u=TI(l,s).getOtherAxis(s).getGlobalExtent(),c=s.toGlobalCoord(s.dataToCoord(e,!0));h&&"none"!==h&&(a=vI(i),(r=AI[h](s,c,u)).style=a,t.graphicKey=r.type,t.pointer=r),wI(e,t,yv(l.model,n),n,i,o)},getHandleTransform:function(t,e,n){var i=yv(e.axis.grid.model,e,{labelInside:!1});return i.labelMargin=n.get("handle.margin"),{position:_I(e.axis,t,i),rotation:i.rotation+(i.labelDirection<0?Math.PI:0)}},updateHandleTransform:function(t,e,n,i){var o=n.axis,a=o.grid,r=o.getGlobalExtent(!0),s=TI(a,o).getOtherAxis(o).getGlobalExtent(),l="x"===o.dim?0:1,h=t.position;h[l]+=e[l],h[l]=Math.min(r[1],h[l]),h[l]=Math.max(r[0],h[l]);var u=(s[1]+s[0])/2,c=[u,u];c[l]=h[l];return{position:h,rotation:t.rotation,cursorPoint:c,tooltipOption:[{verticalAlign:"middle"},{align:"center"}][l]}}});function TI(t,e){var n={};return n[e.dim+"AxisIndex"]=e.index,t.getCartesian(n)}var AI={line:function(t,e,n){return{type:"Line",subPixelOptimize:!0,shape:bI([e,n[0]],[e,n[1]],DI(t))}},shadow:function(t,e,n){var i=Math.max(1,t.getBandWidth()),o=n[1]-n[0];return{type:"Rect",shape:SI([e-i/2,n[0]],[i,o],DI(t))}}};function DI(t){return"x"===t.dim?0:1}gv.registerAxisPointerClass("CartesianAxisPointer",II),pp(function(t){var e;t&&(t.axisPointer&&0!==t.axisPointer.length||(t.axisPointer={}),(e=t.axisPointer.link)&&!R(e)&&(t.axisPointer.link=[e]))}),gp(Id.PROCESSOR.STATISTIC,function(t,e){t.getComponent("axisPointer").coordSysAxesInfo=hv(t,e)}),fp({type:"updateAxisPointer",event:"updateAxisPointer",update:":updateAxisPointer"},function(t,e,n){var i=t.currTrigger,r=[t.x,t.y],o=t,a=t.dispatchAction||E(n.dispatchAction,n),s=e.getComponent("axisPointer").coordSysAxesInfo;if(s){eI(r)&&(r=YM({seriesIndex:o.seriesIndex,dataIndex:o.dataIndex},e).point);var l=eI(r),h=o.axesInfo,u=s.axesInfo,c="leave"===i||eI(r),d={},p={},g={list:[],map:{}},f={showPointer:qM(JM,p),showTooltip:qM(QM,g)};jM(s.coordSysMap,function(t,e){var a=l||t.containPoint(r);jM(s.coordSysAxesInfo[e],function(t,e){var n,i=t.axis,o=function(t,e){for(var n=0;n<(t||[]).length;n++){var i=t[n];if(e.axis.dim===i.axisDim&&e.axis.model.componentIndex===i.axisIndex)return i}}(h,t);c||!a||h&&!o||(null!=(n=o&&o.value)||l||(n=i.pointToData(r)),null!=n&&$M(t,n,f,!1,d))})});var m,v,y,x={};return jM(u,function(o,t){var a=o.linkGroup;a&&!p[t]&&jM(a.axesInfo,function(t,e){var n,i=p[e];t!==o&&i&&(n=i.value,a.mapper&&(n=o.axis.scale.parse(a.mapper(n,tI(t),tI(o)))),x[o.key]=n)})}),jM(x,function(t,e){$M(u[e],t,f,!0,d)}),m=p,v=u,y=d.axesInfo=[],jM(v,function(t,e){var n=t.axisPointerModel.option,i=m[e];i?(t.useHandle||(n.status="show"),n.value=i.value,n.seriesDataIndices=(i.payloadBatch||[]).slice()):t.useHandle||(n.status="hide"),"show"===n.status&&y.push({axisDim:t.axis.dim,axisIndex:t.axis.model.componentIndex,value:n.value})}),function(t,e,n,i){if(eI(e)||!t.list.length)return i({type:"hideTip"});var o=((t.list[0].dataByAxis[0]||{}).seriesDataIndices||[])[0]||{};i({type:"showTip",escapeConnect:!0,x:e[0],y:e[1],tooltipOption:n.tooltipOption,position:n.position,dataIndexInside:o.dataIndexInside,dataIndex:o.dataIndex,seriesIndex:o.seriesIndex,dataByCoordSys:t.list})}(g,r,t,a),function(t,e){var n=e.getZr(),i="axisPointerLastHighlights",o=KM(n)[i]||{},a=KM(n)[i]={};jM(t,function(t,e){var n=t.axisPointerModel.option;"show"===n.status&&jM(n.seriesDataIndices,function(t){var e=t.seriesIndex+" | "+t.dataIndex;a[e]=t})});var r=[],s=[];P(o,function(t,e){a[e]||s.push(t)}),P(a,function(t,e){o[e]||r.push(t)}),s.length&&e.dispatchAction({type:"downplay",escapeConnect:!0,batch:s}),r.length&&e.dispatchAction({type:"highlight",escapeConnect:!0,batch:r})}(u,n),d}});var CI=["x","y"],LI=["width","height"],kI=dI.extend({makeElOption:function(t,e,n,i,o){var a,r,s=n.axis,l=s.coordinateSystem,h=OI(l,1-NI(s)),u=l.dataToPoint(e)[0],c=i.get("type");c&&"none"!==c&&(a=vI(i),(r=PI[c](s,u,h)).style=a,t.graphicKey=r.type,t.pointer=r),wI(e,t,WM(n),n,i,o)},getHandleTransform:function(t,e,n){var i=WM(e,{labelInside:!1});return i.labelMargin=n.get("handle.margin"),{position:_I(e.axis,t,i),rotation:i.rotation+(i.labelDirection<0?Math.PI:0)}},updateHandleTransform:function(t,e,n,i){var o=n.axis,a=o.coordinateSystem,r=NI(o),s=OI(a,r),l=t.position;l[r]+=e[r],l[r]=Math.min(s[1],l[r]),l[r]=Math.max(s[0],l[r]);var h=OI(a,1-r),u=(h[1]+h[0])/2,c=[u,u];return c[r]=l[r],{position:l,rotation:t.rotation,cursorPoint:c,tooltipOption:{verticalAlign:"middle"}}}}),PI={line:function(t,e,n){return{type:"Line",subPixelOptimize:!0,shape:bI([e,n[0]],[e,n[1]],NI(t))}},shadow:function(t,e,n){var i=t.getBandWidth(),o=n[1]-n[0];return{type:"Rect",shape:SI([e-i/2,n[0]],[i,o],NI(t))}}};function NI(t){return t.isHorizontal()?0:1}function OI(t,e){var n=t.getRect();return[n[CI[e]],n[CI[e]]+n[LI[e]]]}gv.registerAxisPointerClass("SingleAxisPointer",kI),bp({type:"single"});var EI=ec.extend({type:"series.themeRiver",dependencies:["singleAxis"],nameMap:null,init:function(t){EI.superApply(this,"init",arguments),this.legendVisualProvider=new Zv(E(this.getData,this),E(this.getRawData,this))},fixData:function(t){var e=t.length,n=qo(t,function(t){return t[2]}),i=[];n.buckets.each(function(t,e){i.push({name:e,dataList:t})});for(var o=i.length,a=-1,r=-1,s=0;s<o;++s){var l=i[s].dataList.length;a<l&&(a=l,r=s)}for(var h=0;h<o;++h)if(h!==r)for(var u=i[h].name,c=0;c<a;++c){for(var d=i[r].dataList[c][0],p=i[h].dataList.length,g=-1,f=0;f<p;++f){if(i[h].dataList[f][0]===d){g=f;break}}-1===g&&(t[e]=[],t[e][0]=d,t[e][1]=0,t[e][2]=u,e++)}return t},getInitialData:function(t,e){for(var n=e.queryComponents({mainType:"singleAxis",index:this.get("singleAxisIndex"),id:this.get("singleAxisId")})[0].get("type"),i=I(t.data,function(t){return void 0!==t[2]}),o=this.fixData(i||[]),a=[],r=this.nameMap=et(),s=0,l=0;l<o.length;++l)a.push(o[l][2]),r.get(o[l][2])||(r.set(o[l][2],s),s++);var h=ag(o,{coordDimensions:["single"],dimensionsDefine:[{name:"time",type:kp(n)},{name:"value",type:"float"},{name:"name",type:"ordinal"}],encodeDefine:{single:0,value:1,itemName:2}}),u=new Hp(h,this);return u.initData(o),u},getLayerSeries:function(){for(var n=this.getData(),t=n.count(),e=[],i=0;i<t;++i)e[i]=i;var o=n.mapDimension("single"),a=qo(e,function(t){return n.get("name",t)}),r=[];return a.buckets.each(function(t,e){t.sort(function(t,e){return n.get(o,t)-n.get(o,e)}),r.push({name:e,indices:t})}),r},getAxisTooltipData:function(t,e,n){R(t)||(t=t?[t]:[]);for(var i,o=this.getData(),a=this.getLayerSeries(),r=[],s=a.length,l=0;l<s;++l){for(var h=Number.MAX_VALUE,u=-1,c=a[l].indices.length,d=0;d<c;++d){var p=o.get(t[0],a[l].indices[d]),g=Math.abs(p-e);g<=h&&(i=p,h=g,u=a[l].indices[d])}r.push(u)}return{dataIndices:r,nestestValue:i}},formatTooltip:function(t){var e=this.getData(),n=e.getName(t),i=e.get(e.mapDimension("value"),t);return!isNaN(i)&&null!=i||(i="-"),Ql(n+" : "+i)},defaultOption:{zlevel:0,z:2,coordinateSystem:"singleAxis",boundaryGap:["10%","10%"],singleAxisIndex:0,animationEasing:"linear",label:{margin:4,show:!0,position:"left",color:"#000",fontSize:11},emphasis:{label:{show:!0}}}});Mp({type:"themeRiver",init:function(){this._layers=[]},render:function(T,t,e){var A=T.getData(),D=this.group,C=T.getLayerSeries(),n=A.getLayout("layoutInfo"),i=n.rect,o=n.boundaryGap;function a(t){return t.name}D.attr("position",[0,i.y+o[0]]);var r=new Tp(this._layersSeries||[],C,a,a),L={};function s(t,e,n){var i=this._layers;if("remove"!==t){for(var o,a=[],r=[],s=C[e].indices,l=0;l<s.length;l++){var h=A.getItemLayout(s[l]),u=h.x,c=h.y0,d=h.y;a.push([u,c]),r.push([u,c+d]),o=A.getItemVisual(s[l],"color")}var p,g,f,m,v,y,x,_=A.getItemLayout(s[0]),w=A.getItemModel(s[l-1]),b=w.getModel("label"),S=b.get("margin");"add"===t?(f=L[e]=new Mn,p=new xm({shape:{points:a,stackedOnPoints:r,smooth:.4,stackedOnSmooth:.4,smoothConstraint:!1},z2:0}),g=new Gr({style:{x:_.x-S,y:_.y0+_.y/2}}),f.add(p),f.add(g),D.add(f),p.setClipPath((m=p.getBoundingRect(),v=T,y=function(){p.removeClipPath()},sl(x=new es({shape:{x:m.x-10,y:m.y-10,width:0,height:m.height+20}}),{shape:{width:m.width+20,height:m.height+20}},v,y),x))):(f=i[n],p=f.childAt(0),g=f.childAt(1),D.add(f),L[e]=f,rl(p,{shape:{points:a,stackedOnPoints:r}},T),rl(g,{style:{x:_.x-S,y:_.y0+_.y/2}},T));var M=w.getModel("emphasis.itemStyle"),I=w.getModel("itemStyle");Js(g.style,b,{text:b.get("show")?T.getFormattedLabel(s[l-1],"normal")||A.getName(s[l-1]):null,textVerticalAlign:"middle"}),p.setStyle(k({fill:o},I.getItemStyle(["color"]))),Xs(p,M.getItemStyle())}else D.remove(i[e])}r.add(E(s,this,"add")).update(E(s,this,"update")).remove(E(s,this,"remove")).execute(),this._layersSeries=C,this._layers=L},dispose:function(){}});function zI(n,t,e){if(n.count())for(var i,o=t.coordinateSystem,a=t.getLayerSeries(),r=n.mapDimension("single"),s=n.mapDimension("value"),l=N(a,function(t){return N(t.indices,function(t){var e=o.dataToPoint(n.get(r,t));return e[1]=n.get(s,t),e})}),h=function(t){for(var e=t.length,n=t[0].length,i=[],o=[],a=0,r={},s=0;s<n;++s){for(var l=0,h=0;l<e;++l)h+=t[l][s][1];a<h&&(a=h),i.push(h)}for(var u=0;u<n;++u)o[u]=(a-i[u])/2;for(var c=a=0;c<n;++c){var d=i[c]+o[c];a<d&&(a=d)}return r.y0=o,r.max=a,r}(l),u=h.y0,c=e/h.max,d=a.length,p=a[0].indices.length,g=0;g<p;++g){i=u[g]*c,n.setItemLayout(a[0].indices[g],{layerIndex:0,x:l[0][g][0],y0:i,y:l[0][g][1]*c});for(var f=1;f<d;++f)i+=l[f-1][g][1]*c,n.setItemLayout(a[f].indices[g],{layerIndex:f,x:l[f][g][0],y0:i,y:l[f][g][1]*c})}}vp(function(t,e){t.eachSeriesByType("themeRiver",function(t){var e=t.getData(),n=t.coordinateSystem,i={},o=n.getRect();i.rect=o;var a=t.get("boundaryGap"),r=n.getAxis();i.boundaryGap=a,"horizontal"===r.orient?(a[0]=Ll(a[0],o.height),a[1]=Ll(a[1],o.height),zI(e,t,o.height-a[0]-a[1])):(a[0]=Ll(a[0],o.width),a[1]=Ll(a[1],o.width),zI(e,t,o.width-a[0]-a[1])),e.setLayout("layoutInfo",i)})}),yp(function(t){t.eachSeriesByType("themeRiver",function(o){var a=o.getData(),r=o.getRawData(),s=o.get("color"),l=et();a.each(function(t){l.set(a.getRawIndex(t),t)}),r.each(function(t){var e=r.getName(t),n=s[(o.nameMap.get(e)-1)%s.length];r.setItemVisual(t,"color",n);var i=l.get(t);null!=i&&a.setItemVisual(i,"color",n)})})}),gp(oy("themeRiver")),ec.extend({type:"series.sunburst",_viewRoot:null,getInitialData:function(t,e){var n={name:t.name,children:t.data};!function n(t){var i=0;P(t.children,function(t){n(t);var e=t.value;R(e)&&(e=e[0]),i+=e});var e=t.value;R(e)&&(e=e[0]);null!=e&&!isNaN(e)||(e=i);e<0&&(e=0);R(t.value)?t.value[0]=e:t.value=e}(n);var i=t.levels||[],o={};return o.levels=i,bx.createTree(n,this,o).data},optionUpdated:function(){this.resetViewRoot()},getDataParams:function(t){var e=ec.prototype.getDataParams.apply(this,arguments),n=this.getData().tree.getNodeByDataIndex(t);return e.treePathInfo=Fx(n,this),e},defaultOption:{zlevel:0,z:2,center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,minAngle:0,percentPrecision:2,stillShowZeroSum:!0,highlightPolicy:"descendant",nodeClick:"rootToNode",renderLabelForZeroData:!1,label:{rotate:"radial",show:!0,opacity:1,align:"center",position:"inside",distance:5,silent:!0,emphasis:{}},itemStyle:{borderWidth:1,borderColor:"white",borderType:"solid",shadowBlur:0,shadowColor:"rgba(0, 0, 0, 0.2)",shadowOffsetX:0,shadowOffsetY:0,opacity:1,emphasis:{},highlight:{opacity:1},downplay:{opacity:.9}},animationType:"expansion",animationDuration:1e3,animationDurationUpdate:500,animationEasing:"cubicOut",data:[],levels:[],sort:"desc"},getViewRoot:function(){return this._viewRoot},resetViewRoot:function(t){t?this._viewRoot=t:t=this._viewRoot;var e=this.getRawData().tree.root;t&&(t===e||e.contains(t))||(this._viewRoot=e)}});var RI="none",BI="ancestor",VI="self",GI=2,FI=4;function WI(t,e,n){Mn.call(this);var i=new Zr({z2:GI});i.seriesIndex=e.seriesIndex;var o=new Gr({z2:FI,silent:t.getModel("label").get("silent")});function a(){o.ignore=o.hoverIgnore}function r(){o.ignore=o.normalIgnore}this.add(i),this.add(o),this.updateData(!0,t,"normal",e,n),this.on("emphasis",a).on("normal",r).on("mouseover",a).on("mouseout",r)}var HI=WI.prototype;HI.updateData=function(t,e,n,i,o){(this.node=e).piece=this,i=i||this._seriesModel,o=o||this._ecModel;var a=this.childAt(0);a.dataIndex=e.dataIndex;var r=e.getModel(),s=e.getLayout(),l=k({},s);l.label=null;var h,u,c=function(t,e){var n=t.getVisual("color"),i=t.getVisual("visualMeta");i&&0!==i.length||(n=null);var o=t.getModel("itemStyle").get("color");{if(o)return o;if(n)return n;if(0===t.depth)return e.option.color[0];var a=e.option.color.length;o=e.option.color[function(t){var e=t;for(;1<e.depth;)e=e.parentNode;return M(t.getAncestors()[0].children,e)}(t)%a]}return o}(e,o);h=e,u=c,i.getData().setItemVisual(h.dataIndex,"color",u);var d,p=r.getModel("itemStyle").getItemStyle();d=L({lineJoin:"bevel",fill:(d="normal"===n?p:m(r.getModel(n+".itemStyle").getItemStyle(),p)).fill||c},d),t?(a.setShape(l),a.shape.r=s.r0,rl(a,{shape:{r:s.r}},i,e.dataIndex),a.useStyle(d)):"object"==typeof d.fill&&d.fill.type||"object"==typeof a.style.fill&&a.style.fill.type?(rl(a,{shape:l},i),a.useStyle(d)):rl(a,{shape:l,style:d},i),this._updateLabel(i,c,n);var g,f=r.getShallow("cursor");f&&a.attr("cursor",f),t&&(g=i.getShallow("highlightPolicy"),this._initEvents(a,e,i,g)),this._seriesModel=i||this._seriesModel,this._ecModel=o||this._ecModel},HI.onEmphasis=function(o){var a=this;this.node.hostTree.root.eachNode(function(t){var e,n,i;t.piece&&(a.node===t?t.piece.updateData(!1,t,"emphasis"):(e=t,n=a.node,(i=o)!==RI&&(i===VI?e===n:i===BI?e===n||e.isAncestorOf(n):e===n||e.isDescendantOf(n))?t.piece.childAt(0).trigger("highlight"):o!==RI&&t.piece.childAt(0).trigger("downplay")))})},HI.onNormal=function(){this.node.hostTree.root.eachNode(function(t){t.piece&&t.piece.updateData(!1,t,"normal")})},HI.onHighlight=function(){this.updateData(!1,this.node,"highlight")},HI.onDownplay=function(){this.updateData(!1,this.node,"downplay")},HI._updateLabel=function(t,e,n){var i=this.node.getModel(),o=i.getModel("label"),a="normal"===n||"emphasis"===n?o:i.getModel(n+".label"),r=i.getModel("emphasis.label"),s=Z(t.getFormattedLabel(this.node.dataIndex,n,null,null,"label"),this.node.name);!1===S("show")&&(s="");var l=this.node.getLayout(),h=a.get("minAngle");null==h&&(h=o.get("minAngle")),h=h/180*Math.PI;var u=l.endAngle-l.startAngle;null!=h&&Math.abs(u)<h&&(s="");var c=this.childAt(1);Ks(c.style,c.hoverStyle||{},o,r,{defaultText:a.getShallow("show")?s:null,autoColor:e,useInsideStyle:!0});var d,p=(l.startAngle+l.endAngle)/2,g=Math.cos(p),f=Math.sin(p),m=S("position"),v=S("distance")||0,y=S("align");"outside"===m?(d=l.r+v,y=p>Math.PI/2?"right":"left"):y&&"center"!==y?"left"===y?(d=l.r0+v,p>Math.PI/2&&(y="right")):"right"===y&&(d=l.r-v,p>Math.PI/2&&(y="left")):(d=(l.r+l.r0)/2,y="center"),c.attr("style",{text:s,textAlign:y,textVerticalAlign:S("verticalAlign")||"middle",opacity:S("opacity")});var x=d*g+l.cx,_=d*f+l.cy;c.attr("position",[x,_]);var w=S("rotate"),b=0;function S(t){var e=a.get(t);return null==e?o.get(t):e}"radial"===w?(b=-p)<-Math.PI/2&&(b+=Math.PI):"tangential"===w?(b=Math.PI/2-p)>Math.PI/2?b-=Math.PI:b<-Math.PI/2&&(b+=Math.PI):"number"==typeof w&&(b=w*Math.PI/180),c.attr("rotation",b)},HI._initEvents=function(t,e,n,i){t.off("mouseover").off("mouseout").off("emphasis").off("normal");function o(){r.onEmphasis(i)}function a(){r.onNormal()}var r=this;n.isAnimationEnabled()&&t.on("mouseover",o).on("mouseout",a).on("emphasis",o).on("normal",a).on("downplay",function(){r.onDownplay()}).on("highlight",function(){r.onHighlight()})},w(WI,Mn);gc.extend({type:"sunburst",init:function(){},render:function(o,a,t,e){var i=this;this.seriesModel=o,this.api=t,this.ecModel=a;var r=o.getData(),s=r.tree.root,n=o.getViewRoot(),l=this.group,h=o.get("renderLabelForZeroData"),u=[];n.eachNode(function(t){u.push(t)});var c,d,p=this._oldChildren||[];!function(n,i){if(0===n.length&&0===i.length)return;function t(t){return t.getId()}function e(t,e){!function(t,e){h||!t||t.getValue()||(t=null);{var n;t!==s&&e!==s&&(e&&e.piece?t?(e.piece.updateData(!1,t,"normal",o,a),r.setItemGraphicEl(t.dataIndex,e.piece)):function(t){if(!t)return;t.piece&&(l.remove(t.piece),t.piece=null)}(e):t&&(n=new WI(t,o,a),l.add(n),r.setItemGraphicEl(t.dataIndex,n)))}}(null==t?null:n[t],null==e?null:i[e])}new Tp(i,n,t,t).add(e).update(e).remove(z(e,null)).execute()}(u,p),function(t,e){{var n;0<e.depth?(i.virtualPiece?i.virtualPiece.updateData(!1,t,"normal",o,a):(i.virtualPiece=new WI(t,o,a),l.add(i.virtualPiece)),e.piece._onclickEvent&&e.piece.off("click",e.piece._onclickEvent),n=function(t){i._rootToNode(e.parentNode)},e.piece._onclickEvent=n,i.virtualPiece.on("click",n)):i.virtualPiece&&(l.remove(i.virtualPiece),i.virtualPiece=null)}}(s,n),e&&e.highlight&&e.highlight.piece?(c=o.getShallow("highlightPolicy"),e.highlight.piece.onEmphasis(c)):e&&e.unhighlight&&(!(d=this.virtualPiece)&&s.children.length&&(d=s.children[0].piece),d&&d.onNormal()),this._initEvents(),this._oldChildren=u},dispose:function(){},_initEvents:function(){function t(a){var r=!1;s.seriesModel.getViewRoot().eachNode(function(t){var e,n,i,o;!r&&t.piece&&t.piece.childAt(0)===a.target&&("rootToNode"===(e=t.getModel().get("nodeClick"))?s._rootToNode(t):"link"!==e||(i=(n=t.getModel()).get("link"))&&(o=n.get("target",!0)||"_blank",window.open(i,o)),r=!0)})}var s=this;this.group._onclickEvent&&this.group.off("click",this.group._onclickEvent),this.group.on("click",t),this.group._onclickEvent=t},_rootToNode:function(t){t!==this.seriesModel.getViewRoot()&&this.api.dispatchAction({type:"sunburstRootToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:t})},containPoint:function(t,e){var n=e.getData().getItemLayout(0);if(n){var i=t[0]-n.cx,o=t[1]-n.cy,a=Math.sqrt(i*i+o*o);return a<=n.r&&a>=n.r0}}});var ZI="sunburstRootToNode";fp({type:ZI,update:"updateView"},function(o,t){t.eachComponent({mainType:"series",subType:"sunburst",query:o},function(t,e){var n=Bx(o,[ZI],t);{var i;n&&((i=t.getViewRoot())&&(o.direction=Gx(i,n.node)?"rollUp":"drillDown"),t.resetViewRoot(n.node))}})});var UI="sunburstHighlight";fp({type:UI,update:"updateView"},function(i,t){t.eachComponent({mainType:"series",subType:"sunburst",query:i},function(t,e){var n=Bx(i,[UI],t);n&&(i.highlight=n.node)})});fp({type:"sunburstUnhighlight",update:"updateView"},function(n,t){t.eachComponent({mainType:"series",subType:"sunburst",query:n},function(t,e){n.unhighlight=!0})});var XI=Math.PI/180;function YI(t,e){if("function"==typeof e)return t.sort(e);var i="asc"===e;return t.sort(function(t,e){var n=(t.getValue()-e.getValue())*(i?1:-1);return 0==n?(t.dataIndex-e.dataIndex)*(i?-1:1):n})}function jI(a,r){return r=r||[0,0],N(["x","y"],function(t,e){var n=this.getAxis(t),i=r[e],o=a[e]/2;return"category"===n.type?n.getBandWidth():Math.abs(n.dataToCoord(i-o)-n.dataToCoord(i+o))},this)}yp(z($v,"sunburst")),vp(z(function(t,e,D,n){e.eachSeriesByType(t,function(t){var e=t.get("center"),n=t.get("radius");R(n)||(n=[0,n]),R(e)||(e=[e,e]);var i=D.getWidth(),o=D.getHeight(),u=Math.min(i,o),c=Ll(e[0],i),d=Ll(e[1],o),p=Ll(n[0],u/2),a=Ll(n[1],u/2),r=-t.get("startAngle")*XI,g=t.get("minAngle")*XI,f=t.getData().tree.root,s=t.getViewRoot(),m=s.depth,l=t.get("sort");null!=l&&!function e(t,n){var i=t.children||[];t.children=YI(i,n);i.length&&P(t.children,function(t){e(t,n)})}(s,l);var h=0;P(s.children,function(t){isNaN(t.getValue())||h++});var v,y,x=s.getValue(),_=Math.PI/(x||h)*2,w=0<s.depth,b=s.height-(w?-1:1),S=(a-p)/(b||1),M=t.get("clockwise"),I=t.get("stillShowZeroSum"),T=M?1:-1,A=function(t,e){if(t){var n,i,o,a,r,s,l,h=e;return t!==f&&(n=t.getValue(),(i=0===x&&I?_:n*_)<g&&(i=g),h=e+T*i,o=t.depth-m-(w?-1:1),a=p+S*o,r=p+S*(1+o),null!=(s=t.getModel()).get("r0")&&(a=Ll(s.get("r0"),u/2)),null!=s.get("r")&&(r=Ll(s.get("r"),u/2)),t.setLayout({angle:i,startAngle:e,endAngle:h,clockwise:M,cx:c,cy:d,r0:a,r:r})),t.children&&t.children.length&&(l=0,P(t.children,function(t){l+=A(t,e+l)})),h-e}};w&&(v=p+S,y=2*Math.PI,f.setLayout({angle:y,startAngle:r,endAngle:r+y,clockwise:M,cx:c,cy:d,r0:p,r:v})),A(s,r)})},"sunburst")),gp(z(oy,"sunburst"));function qI(a,r){return r=r||[0,0],N([0,1],function(t){var e=r[t],n=a[t]/2,i=[],o=[];return i[t]=e-n,o[t]=e+n,i[1-t]=o[1-t]=r[1-t],Math.abs(this.dataToPoint(i)[t]-this.dataToPoint(o)[t])},this)}function KI(t,e){var n=this.getAxis(),i=e instanceof Array?e[0]:e,o=(t instanceof Array?t[0]:t)/2;return"category"===n.type?n.getBandWidth():Math.abs(n.dataToCoord(i-o)-n.dataToCoord(i+o))}function $I(s,l){return N(["Radius","Angle"],function(t,e){var n=this["get"+t+"Axis"](),i=l[e],o=s[e]/2,a="dataTo"+t,r="category"===n.type?n.getBandWidth():Math.abs(n[a](i-o)-n[a](i+o));return"Angle"===t&&(r=r*Math.PI/180),r},this)}var JI=ys,QI=["itemStyle"],tT=["emphasis","itemStyle"],eT=["label"],nT=["emphasis","label"],iT="e\0\0",oT={cartesian2d:function(e){var t=e.grid.getRect();return{coordSys:{type:"cartesian2d",x:t.x,y:t.y,width:t.width,height:t.height},api:{coord:function(t){return e.dataToPoint(t)},size:E(jI,e)}}},geo:function(e){var t=e.getBoundingRect();return{coordSys:{type:"geo",x:t.x,y:t.y,width:t.width,height:t.height,zoom:e.getZoom()},api:{coord:function(t){return e.dataToPoint(t)},size:E(qI,e)}}},singleAxis:function(e){var t=e.getRect();return{coordSys:{type:"singleAxis",x:t.x,y:t.y,width:t.width,height:t.height},api:{coord:function(t){return e.dataToPoint(t)},size:E(KI,e)}}},polar:function(o){var a=o.getRadiusAxis(),r=o.getAngleAxis(),t=a.getExtent();return t[0]>t[1]&&t.reverse(),{coordSys:{type:"polar",cx:o.cx,cy:o.cy,r:t[1],r0:t[0]},api:{coord:E(function(t){var e=a.dataToRadius(t[0]),n=r.dataToAngle(t[1]),i=o.coordToPoint([e,n]);return i.push(e,n*Math.PI/180),i}),size:E($I,o)}}},calendar:function(n){var t=n.getRect(),e=n.getRangeInfo();return{coordSys:{type:"calendar",x:t.x,y:t.y,width:t.width,height:t.height,cellWidth:n.getCellWidth(),cellHeight:n.getCellHeight(),rangeInfo:{start:e.start,end:e.end,weeks:e.weeks,dayCount:e.allDay}},api:{coord:function(t,e){return n.dataToPoint(t,e)}}}}};function aT(t,e,n,i,o){null==n[t]||o||(e[t]=n[t],n[t]=i[t])}function rT(a,r,e,t){var n=a.get("renderItem"),i=a.coordinateSystem,o={};i&&(D&&(q(n,"series.render is required."),q(i.prepareCustoms||oT[i.type],"This coordSys does not support custom series.")),o=i.prepareCustoms?i.prepareCustoms():oT[i.type](i));var s,l,h,u,c,d,p,g=L({getWidth:t.getWidth,getHeight:t.getHeight,getZr:t.getZr,getDevicePixelRatio:t.getDevicePixelRatio,value:function(t,e){return null==e&&(e=h),r.get(r.getDimension(t||0),e)},style:function(t,e){null==e&&(e=h),v(e);var n=u.getModel(QI).getItemStyle();null!=p&&(n.fill=p);var i=r.getItemVisual(e,"opacity");null!=i&&(n.opacity=i);var o=t?cT(t,c):c;return Js(n,o,null,{autoColor:p,isRectText:!0}),n.text=o.getShallow("show")?U(a.getFormattedLabel(e,"normal"),Hf(r,e)):null,t&&dT(n,t),n},styleEmphasis:function(t,e){null==e&&(e=h),v(e);var n=u.getModel(tT).getItemStyle(),i=t?cT(t,d):d;return Js(n,i,null,{isRectText:!0},!0),n.text=i.getShallow("show")?X(a.getFormattedLabel(e,"emphasis"),a.getFormattedLabel(e,"normal"),Hf(r,e)):null,t&&dT(n,t),n},visual:function(t,e){return null==e&&(e=h),r.getItemVisual(e,t)},barLayout:function(t){if(i.getBaseAxis){return function(t){var e=[],n=t.axis;if("category"===n.type){for(var i=n.getBandWidth(),o=0;o<t.count;o++)e.push(L({bandWidth:i,axisKey:"axis0",stackId:Tg+o},t));for(var a=Pg(e),r=[],o=0;o<t.count;o++){var s=a.axis0[Tg+o];s.offsetCenter=s.offset+s.width/2,r.push(s)}return r}}(L({axis:i.getBaseAxis()},t))}},currentSeriesIndices:function(){return e.getCurrentSeriesIndices()},font:function(t){return ol(t,e)}},o.api||{}),f={context:{},seriesId:a.id,seriesName:a.name,seriesIndex:a.seriesIndex,coordSys:o.coordSys,dataInsideLength:r.count(),encode:(s=a.getData(),l={},P(s.dimensions,function(t,e){var n,i=s.getDimensionInfo(t);i.isExtraCoord||(n=i.coordDim,(l[n]=l[n]||[])[i.coordDimIndex]=e)}),l)},m=!0;return function(t,e){return h=t,m=!0,n&&n(L({dataIndexInside:t,dataIndex:r.getRawIndex(t),actionType:e?e.type:null},f),g)};function v(t){null==t&&(t=h),m&&(u=r.getItemModel(t),c=u.getModel(eT),d=u.getModel(nT),p=r.getItemVisual(t,"color"),m=!1)}}function sT(t,e,n,i,o,a){return(t=lT(t,e,n,i,o,a,!0))&&a.setItemGraphicEl(e,t),t}function lT(t,e,n,i,o,a,r){var s,l=!n,h=(n=n||{}).type,u=n.shape,c=n.style;if(t&&(l||null!=h&&h!==t.__customGraphicType||"path"===h&&((s=u)&&(s.hasOwnProperty("pathData")||s.hasOwnProperty("d")))&&gT(u)!==t.__customPathData||"image"===h&&fT(c,"image")&&c.image!==t.__customImagePath||"text"===h&&fT(u,"text")&&c.text!==t.__customText)&&(o.remove(t),t=null),!l){var d=!t;return function(e,t,n,i,o,a){var r,s,l={},h=n.style||{};n.shape&&(l.shape=C(n.shape)),n.position&&(l.position=n.position.slice()),n.scale&&(l.scale=n.scale.slice()),n.origin&&(l.origin=n.origin.slice()),n.rotation&&(l.rotation=n.rotation),"image"===e.type&&n.style&&(r=l.style={},P(["x","y","width","height"],function(t){aT(t,r,h,e.style,o)})),"text"===e.type&&n.style&&(r=l.style={},P(["x","y"],function(t){aT(t,r,h,e.style,o)}),!h.hasOwnProperty("textFill")&&h.fill&&(h.textFill=h.fill),!h.hasOwnProperty("textStroke")&&h.stroke&&(h.textStroke=h.stroke)),"group"!==e.type&&(e.useStyle(h),o&&(e.style.opacity=0,null==(s=h.opacity)&&(s=1),sl(e,{style:{opacity:s}},i,t))),o?e.attr(l):rl(e,l,i,t),n.hasOwnProperty("z2")&&e.attr("z2",n.z2||0),n.hasOwnProperty("silent")&&e.attr("silent",n.silent),n.hasOwnProperty("invisible")&&e.attr("invisible",n.invisible),n.hasOwnProperty("ignore")&&e.attr("ignore",n.ignore),n.hasOwnProperty("info")&&e.attr("info",n.info);var u=n.styleEmphasis;Gs(e,u),a&&Ys(e,!1!==u)}(t=t||function(t){var e=t.type;if("path"===e){var n,i=t.shape,o=null!=i.width&&null!=i.height?{x:i.x||0,y:i.y||0,width:i.width,height:i.height}:null,a=gT(i);(n=As(a,null,o,i.layout||"center")).__customPathData=a}else if("image"===e)(n=new Yi({})).__customImagePath=t.style.image;else if("text"===e)(n=new Gr({})).__customText=t.style.text;else if("group"===e)n=new Mn;else{if("compoundPath"===e)throw new Error('"compoundPath" is not supported yet.');var r=Ts(e);D&&q(r,'graphic type "'+e+'" can not be found.'),n=new r}return n.__customGraphicType=e,n.name=t.name,n}(n),e,n,i,d,r),"group"===h&&function(t,e,n,i,o){var a=n.children,r=a?a.length:0,s=n.$mergeChildren,l="byName"===s||n.diffChildrenByName,h=!1===s;if(!r&&!l&&!h)return;if(l)return function(t){new Tp(t.oldChildren,t.newChildren,hT,hT,t).add(uT).update(uT).remove(pT).execute()}({oldChildren:t.children()||[],newChildren:a||[],dataIndex:e,animatableModel:i,group:t,data:o});h&&t.removeAll();for(var u=0;u<r;u++)a[u]&&lT(t.childAt(u),e,a[u],i,t,o);D&&q(!h||t.childCount()===u,"MUST NOT contain empty item in children array when `group.$mergeChildren` is `false`.")}(t,e,n,i,a),o.add(t),t}}function hT(t,e){var n=t&&t.name;return null!=n?n:iT+e}function uT(t,e){var n=this.context,i=null!=t?n.newChildren[t]:null;lT(null!=e?n.oldChildren[e]:null,n.dataIndex,i,n.animatableModel,n.group,n.data)}function cT(n,t){var i=new Sl({},t);return P(JI,function(t,e){n.hasOwnProperty(t)&&(i.option[e]=n[t])}),i}function dT(t,e){for(var n in e)!e.hasOwnProperty(n)&&JI.hasOwnProperty(n)||(t[n]=e[n])}function pT(t){var e=this.context,n=e.oldChildren[t];n&&e.group.remove(n)}function gT(t){return t&&(t.pathData||t.d)}function fT(t,e){return t&&t.hasOwnProperty(e)}function mT(t){return t.get("stack")||"__ec_stack_"+t.seriesIndex}function vT(t,e){return e.dim+t.model.componentIndex}function yT(t,e){Bf.call(this,"radius",t,e),this.type="category"}ec.extend({type:"series.custom",dependencies:["grid","polar","geo","singleAxis","calendar"],defaultOption:{coordinateSystem:"cartesian2d",zlevel:0,z:2,legendHoverLink:!0,useTransform:!0,clip:!1},getInitialData:function(t,e){return dg(this.getSource(),this)},getDataParams:function(t,e,n){var i=ec.prototype.getDataParams.apply(this,arguments);return n&&(i.info=n.info),i}}),gc.extend({type:"custom",_data:null,render:function(n,t,e,i){var o=this._data,a=n.getData(),r=this.group,s=rT(n,a,t,e);a.diff(o).add(function(t){sT(null,t,s(t,i),n,r,a)}).update(function(t,e){sT(o.getItemGraphicEl(e),t,s(t,i),n,r,a)}).remove(function(t){var e=o.getItemGraphicEl(t);e&&r.remove(e)}).execute();var l=n.get("clip",!0)?bm(n.coordinateSystem,!1,n):null;l?r.setClipPath(l):r.removeClipPath(),this._data=a},incrementalPrepareRender:function(t,e,n){this.group.removeAll(),this._data=null},incrementalRender:function(t,e,n,i,o){var a=e.getData(),r=rT(e,a,n,i);function s(t){t.isGroup||(t.incremental=!0,t.useHoverLayer=!0)}for(var l=t.start;l<t.end;l++){sT(null,l,r(l,o),e,this.group,a).traverse(s)}},dispose:it,filterForExposedEvent:function(t,e,n,i){var o=e.element;if(null==o||n.name===o)return!0;for(;(n=n.parent)&&n!==this.group;)if(n.name===o)return!0;return!1}}),yT.prototype={constructor:yT,pointToData:function(t,e){return this.polar.pointToData(t,e)["radius"===this.dim?0:1]},dataToRadius:Bf.prototype.dataToCoord,radiusToData:Bf.prototype.coordToData},w(yT,Bf);var xT=Ho();function _T(t,e){e=e||[0,360],Bf.call(this,"angle",t,e),this.type="category"}_T.prototype={constructor:_T,pointToData:function(t,e){return this.polar.pointToData(t,e)["radius"===this.dim?0:1]},dataToAngle:Bf.prototype.dataToCoord,angleToData:Bf.prototype.coordToData,calculateCategoryInterval:function(){var t=this.getLabelModel(),e=this.scale,n=e.getExtent(),i=e.count();if(n[1]-n[0]<1)return 0;var o=n[0],a=this.dataToCoord(o+1)-this.dataToCoord(o),r=Math.abs(a),s=hi(o,t.getFont(),"center","top"),l=Math.max(s.height,7)/r;isNaN(l)&&(l=1/0);var h=Math.max(0,Math.floor(l)),u=xT(this.model),c=u.lastAutoInterval,d=u.lastTickCount;return null!=c&&null!=d&&Math.abs(c-h)<=1&&Math.abs(d-i)<=1&&h<c?h=c:(u.lastTickCount=i,u.lastAutoInterval=h),h}},w(_T,Bf);function wT(t){this.name=t||"",this.cx=0,this.cy=0,this._radiusAxis=new yT,this._angleAxis=new _T,this._radiusAxis.polar=this._angleAxis.polar=this}wT.prototype={type:"polar",axisPointerEnabled:!0,constructor:wT,dimensions:["radius","angle"],model:null,containPoint:function(t){var e=this.pointToCoord(t);return this._radiusAxis.contain(e[0])&&this._angleAxis.contain(e[1])},containData:function(t){return this._radiusAxis.containData(t[0])&&this._angleAxis.containData(t[1])},getAxis:function(t){return this["_"+t+"Axis"]},getAxes:function(){return[this._radiusAxis,this._angleAxis]},getAxesByScale:function(t){var e=[],n=this._angleAxis,i=this._radiusAxis;return n.scale.type===t&&e.push(n),i.scale.type===t&&e.push(i),e},getAngleAxis:function(){return this._angleAxis},getRadiusAxis:function(){return this._radiusAxis},getOtherAxis:function(t){var e=this._angleAxis;return t===e?this._radiusAxis:e},getBaseAxis:function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAngleAxis()},getTooltipAxes:function(t){var e=null!=t&&"auto"!==t?this.getAxis(t):this.getBaseAxis();return{baseAxes:[e],otherAxes:[this.getOtherAxis(e)]}},dataToPoint:function(t,e){return this.coordToPoint([this._radiusAxis.dataToRadius(t[0],e),this._angleAxis.dataToAngle(t[1],e)])},pointToData:function(t,e){var n=this.pointToCoord(t);return[this._radiusAxis.radiusToData(n[0],e),this._angleAxis.angleToData(n[1],e)]},pointToCoord:function(t){var e=t[0]-this.cx,n=t[1]-this.cy,i=this.getAngleAxis(),o=i.getExtent(),a=Math.min(o[0],o[1]),r=Math.max(o[0],o[1]);i.inverse?a=r-360:r=a+360;var s=Math.sqrt(e*e+n*n);e/=s,n/=s;for(var l=Math.atan2(-n,e)/Math.PI*180,h=l<a?1:-1;l<a||r<l;)l+=360*h;return[s,l]},coordToPoint:function(t){var e=t[0],n=t[1]/180*Math.PI;return[Math.cos(n)*e+this.cx,-Math.sin(n)*e+this.cy]},getArea:function(){var t=this.getAngleAxis(),e=this.getRadiusAxis().getExtent().slice();e[0]>e[1]&&e.reverse();var n=t.getExtent(),i=Math.PI/180;return{cx:this.cx,cy:this.cy,r0:e[0],r:e[1],startAngle:-n[0]*i,endAngle:-n[1]*i,clockwise:t.inverse,contain:function(t,e){var n=t-this.cx,i=e-this.cy,o=n*n+i*i,a=this.r,r=this.r0;return o<=a*a&&r*r<=o}}}};var bT=Mh.extend({type:"polarAxis",axis:null,getCoordSysModel:function(){return this.ecModel.queryComponents({mainType:"polar",index:this.option.polarIndex,id:this.option.polarId})[0]}});m(bT.prototype,uf);var ST={splitNumber:5};function MT(t,e){return e.type||(e.data?"category":"value")}function IT(t,e){var n,i,o=this,a=o.getAngleAxis(),r=o.getRadiusAxis();a.scale.setExtent(1/0,-1/0),r.scale.setExtent(1/0,-1/0),t.eachSeries(function(t){var e;t.coordinateSystem===o&&(P((e=t.getData()).mapDimension("radius",!0),function(t){r.scale.unionExtentFromData(e,cg(e,t))}),P(e.mapDimension("angle",!0),function(t){a.scale.unionExtentFromData(e,cg(e,t))}))}),of(a.scale,a.model),of(r.scale,r.model),"category"!==a.type||a.onBand||(n=a.getExtent(),i=360/a.scale.count(),a.inverse?n[1]+=i:n[1]-=i,a.setExtent(n[0],n[1]))}function TT(t,e){var n;t.type=e.get("type"),t.scale=af(e),t.onBand=e.get("boundaryGap")&&"category"===t.type,t.inverse=e.get("inverse"),"angleAxis"===e.mainType&&(t.inverse^=e.get("clockwise"),n=e.get("startAngle"),t.setExtent(n,n+(t.inverse?-360:360))),(e.axis=t).model=e}Bm("angle",bT,MT,{startAngle:90,clockwise:!0,splitNumber:12,axisLabel:{rotate:!1}}),Bm("radius",bT,MT,ST),wp({type:"polar",dependencies:["polarAxis","angleAxis"],coordinateSystem:null,findAxisModel:function(t){var e;return this.ecModel.eachComponent(t,function(t){t.getCoordSysModel()===this&&(e=t)},this),e},defaultOption:{zlevel:0,z:0,center:["50%","50%"],radius:"80%"}}),nu.register("polar",{dimensions:wT.prototype.dimensions,create:function(n,s){var l=[];return n.eachComponent("polar",function(t,e){var n=new wT(e);n.update=IT;var i=n.getRadiusAxis(),o=n.getAngleAxis(),a=t.findAxisModel("radiusAxis"),r=t.findAxisModel("angleAxis");TT(i,a),TT(o,r),function(t,e,n){var i=e.get("center"),o=n.getWidth(),a=n.getHeight();t.cx=Ll(i[0],o),t.cy=Ll(i[1],a);var r=t.getRadiusAxis(),s=Math.min(o,a)/2,l=e.get("radius");null==l?l=[0,"100%"]:R(l)||(l=[0,l]),l=[Ll(l[0],s),Ll(l[1],s)],r.inverse?r.setExtent(l[1],l[0]):r.setExtent(l[0],l[1])}(n,t,s),l.push(n),(t.coordinateSystem=n).model=t}),n.eachSeries(function(t){if("polar"===t.get("coordinateSystem")){var e=n.queryComponents({mainType:"polar",index:t.get("polarIndex"),id:t.get("polarId")})[0];if(D&&!e)throw new Error('Polar "'+Z(t.get("polarIndex"),t.get("polarId"),0)+'" not found');t.coordinateSystem=e.coordinateSystem}}),l}});var AT=["axisLine","axisLabel","axisTick","minorTick","splitLine","minorSplitLine","splitArea"];function DT(t,e,n){e[1]>e[0]&&(e=e.slice().reverse());var i=t.coordToPoint([e[0],n]),o=t.coordToPoint([e[1],n]);return{x1:i[0],y1:i[1],x2:o[0],y2:o[1]}}function CT(t){return t.getRadiusAxis().inverse?0:1}function LT(t){var e=t[0],n=t[t.length-1];e&&n&&Math.abs(Math.abs(e.coord-n.coord)-360)<1e-4&&t.pop()}gv.extend({type:"angleAxis",axisPointerClass:"PolarAxisPointer",render:function(e,t){var n,i,o,a,r,s;this.group.removeAll(),e.get("show")&&(n=e.axis,i=n.polar,o=i.getRadiusAxis().getExtent(),a=n.getTicksCoords(),r=n.getMinorTicksCoords(),LT(s=N(n.getViewLabels(),function(t){return(t=C(t)).coord=n.dataToCoord(t.tickValue),t})),LT(a),P(AT,function(t){!e.get(t+".show")||n.scale.isBlank()&&"axisLine"!==t||this["_"+t](e,i,a,r,o,s)},this))},_axisLine:function(t,e,n,i,o){var a=t.getModel("axisLine.lineStyle"),r=CT(e),s=r?0:1,l=0===o[s]?new Wr({shape:{cx:e.cx,cy:e.cy,r:o[r]},style:a.getLineStyle(),z2:1,silent:!0}):new Ur({shape:{cx:e.cx,cy:e.cy,r:o[r],r0:o[s]},style:a.getLineStyle(),z2:1,silent:!0});l.style.fill=null,this.group.add(l)},_axisTick:function(t,e,n,i,o){var a=t.getModel("axisTick"),r=(a.get("inside")?-1:1)*a.get("length"),s=o[CT(e)],l=N(n,function(t){return new is({shape:DT(e,[s,s+r],t.coord)})});this.group.add(Ls(l,{style:L(a.getModel("lineStyle").getLineStyle(),{stroke:t.get("axisLine.lineStyle.color")})}))},_minorTick:function(t,e,n,i,o){if(i.length){for(var a=t.getModel("axisTick"),r=t.getModel("minorTick"),s=(a.get("inside")?-1:1)*r.get("length"),l=o[CT(e)],h=[],u=0;u<i.length;u++)for(var c=0;c<i[u].length;c++)h.push(new is({shape:DT(e,[l,l+s],i[u][c].coord)}));this.group.add(Ls(h,{style:L(r.getModel("lineStyle").getLineStyle(),L(a.getLineStyle(),{stroke:t.get("axisLine.lineStyle.color")}))}))}},_axisLabel:function(c,d,t,e,p,n){var g=c.getCategories(!0),f=c.getModel("axisLabel"),m=f.get("margin"),v=c.get("triggerEvent");P(n,function(t,e){var n=f,i=t.tickValue,o=p[CT(d)],a=d.coordToPoint([o+m,t.coord]),r=d.cx,s=d.cy,l=Math.abs(a[0]-r)/o<.3?"center":a[0]>r?"left":"right",h=Math.abs(a[1]-s)/o<.3?"middle":a[1]>s?"top":"bottom";g&&g[i]&&g[i].textStyle&&(n=new Sl(g[i].textStyle,f,f.ecModel));var u=new Gr({silent:$m.isLabelSilent(c)});this.group.add(u),Js(u.style,n,{x:a[0],y:a[1],textFill:n.getTextColor()||c.get("axisLine.lineStyle.color"),text:t.formattedLabel,textAlign:l,textVerticalAlign:h}),v&&(u.eventData=$m.makeAxisEventDataBase(c),u.eventData.targetType="axisLabel",u.eventData.value=t.rawLabel)},this)},_splitLine:function(t,e,n,i,o){for(var a=t.getModel("splitLine").getModel("lineStyle"),r=0,s=(s=a.get("color"))instanceof Array?s:[s],l=[],h=0;h<n.length;h++){var u=r++%s.length;l[u]=l[u]||[],l[u].push(new is({shape:DT(e,o,n[h].coord)}))}for(h=0;h<l.length;h++)this.group.add(Ls(l[h],{style:L({stroke:s[h%s.length]},a.getLineStyle()),silent:!0,z:t.get("z")}))},_minorSplitLine:function(t,e,n,i,o){if(i.length){for(var a=t.getModel("minorSplitLine").getModel("lineStyle"),r=[],s=0;s<i.length;s++)for(var l=0;l<i[s].length;l++)r.push(new is({shape:DT(e,o,i[s][l].coord)}));this.group.add(Ls(r,{style:a.getLineStyle(),silent:!0,z:t.get("z")}))}},_splitArea:function(t,e,n,i,o){if(n.length){for(var a=t.getModel("splitArea").getModel("areaStyle"),r=0,s=(s=a.get("color"))instanceof Array?s:[s],l=[],h=Math.PI/180,u=-n[0].coord*h,c=Math.min(o[0],o[1]),d=Math.max(o[0],o[1]),p=t.get("clockwise"),g=1;g<n.length;g++){var f=r++%s.length;l[f]=l[f]||[],l[f].push(new Zr({shape:{cx:e.cx,cy:e.cy,r0:c,r:d,startAngle:u,endAngle:-n[g].coord*h,clockwise:p},silent:!0})),u=-n[g].coord*h}for(g=0;g<l.length;g++)this.group.add(Ls(l[g],{style:L({fill:s[g%s.length]},a.getAreaStyle()),silent:!0}))}}});var kT=["axisLine","axisTickLabel","axisName"],PT=["splitLine","splitArea","minorSplitLine"];gv.extend({type:"radiusAxis",axisPointerClass:"PolarAxisPointer",render:function(e,t){var n,i,o,a,r,s,l,h,u,c,d,p;this.group.removeAll(),e.get("show")&&(n=e.axis,o=(i=n.polar).getAngleAxis(),a=n.getTicksCoords(),r=n.getMinorTicksCoords(),s=o.getExtent()[0],l=n.getExtent(),c=e,d=s,h={position:[(u=i).cx,u.cy],rotation:d/180*Math.PI,labelDirection:-1,tickDirection:-1,nameDirection:1,labelRotate:c.getModel("axisLabel").get("rotate"),z2:1},p=new $m(e,h),P(kT,p.add,p),this.group.add(p.getGroup()),P(PT,function(t){e.get(t+".show")&&!n.scale.isBlank()&&this["_"+t](e,i,s,l,a,r)},this))},_splitLine:function(t,e,n,i,o){for(var a=t.getModel("splitLine").getModel("lineStyle"),r=0,s=(s=a.get("color"))instanceof Array?s:[s],l=[],h=0;h<o.length;h++){var u=r++%s.length;l[u]=l[u]||[],l[u].push(new Wr({shape:{cx:e.cx,cy:e.cy,r:o[h].coord}}))}for(h=0;h<l.length;h++)this.group.add(Ls(l[h],{style:L({stroke:s[h%s.length],fill:null},a.getLineStyle()),silent:!0}))},_minorSplitLine:function(t,e,n,i,o,a){if(a.length){for(var r=t.getModel("minorSplitLine").getModel("lineStyle"),s=[],l=0;l<a.length;l++)for(var h=0;h<a[l].length;h++)s.push(new Wr({shape:{cx:e.cx,cy:e.cy,r:a[l][h].coord}}));this.group.add(Ls(s,{style:L({fill:null},r.getLineStyle()),silent:!0}))}},_splitArea:function(t,e,n,i,o){if(o.length){for(var a=t.getModel("splitArea").getModel("areaStyle"),r=0,s=(s=a.get("color"))instanceof Array?s:[s],l=[],h=o[0].coord,u=1;u<o.length;u++){var c=r++%s.length;l[c]=l[c]||[],l[c].push(new Zr({shape:{cx:e.cx,cy:e.cy,r0:h,r:o[u].coord,startAngle:0,endAngle:2*Math.PI},silent:!0})),h=o[u].coord}for(u=0;u<l.length;u++)this.group.add(Ls(l[u],{style:L({fill:s[u%s.length]},a.getAreaStyle()),silent:!0}))}}});var NT=dI.extend({makeElOption:function(t,e,n,i,o){var a=n.axis;"angle"===a.dim&&(this.animationThreshold=Math.PI/18);var r,s,l=a.polar,h=l.getOtherAxis(a).getExtent(),u=a["dataTo"+sh(a.dim)](e),c=i.get("type");c&&"none"!==c&&(r=vI(i),(s=OT[c](a,l,u,h,r)).style=r,t.graphicKey=s.type,t.pointer=s);var d=i.get("label.margin");yI(t,n,i,o,function(t,e,n,i){var o=e.axis,a=o.dataToCoord(t),r=n.getAngleAxis().getExtent()[0];r=r/180*Math.PI;var s,l,h,u=n.getRadiusAxis().getExtent();{var c,d,p,g,f,m;h="radius"===o.dim?(re(c=ee(),c,r),ae(c,c,[n.cx,n.cy]),s=hl([a,-i],c),d=e.getModel("axisLabel").get("rotate")||0,p=$m.innerTextLayout(r,d*Math.PI/180,-1),l=p.textAlign,p.textVerticalAlign):(g=u[1],s=n.coordToPoint([g+i,a]),f=n.cx,m=n.cy,l=Math.abs(s[0]-f)/g<.3?"center":s[0]>f?"left":"right",Math.abs(s[1]-m)/g<.3?"middle":s[1]>m?"top":"bottom")}return{position:s,align:l,verticalAlign:h}}(e,n,l,d))}});var OT={line:function(t,e,n,i,o){return"angle"===t.dim?{type:"Line",shape:bI(e.coordToPoint([i[0],n]),e.coordToPoint([i[1],n]))}:{type:"Circle",shape:{cx:e.cx,cy:e.cy,r:n}}},shadow:function(t,e,n,i,o){var a=Math.max(1,t.getBandWidth()),r=Math.PI/180;return"angle"===t.dim?{type:"Sector",shape:MI(e.cx,e.cy,i[0],i[1],(-n-a/2)*r,(a/2-n)*r)}:{type:"Sector",shape:MI(e.cx,e.cy,n-a/2,n+a/2,0,2*Math.PI)}}};function ET(i,t){t.update="updateView",fp(t,function(t,e){var n={};return e.eachComponent({mainType:"geo",query:t},function(e){e[i](t.name),P(e.coordinateSystem.regions,function(t){n[t.name]=e.isSelected(t.name)||!1})}),{selected:n,name:t.name}})}gv.registerAxisPointerClass("PolarAxisPointer",NT),vp(z(function(t,e,n){var N={},O=function(t){var f={};P(t,function(t,e){var n=t.getData(),i=t.coordinateSystem,o=i.getBaseAxis(),a=vT(i,o),r=o.getExtent(),s="category"===o.type?o.getBandWidth():Math.abs(r[1]-r[0])/n.count(),l=f[a]||{bandWidth:s,remainedWidth:s,autoWidthCount:0,categoryGap:"20%",gap:"30%",stacks:{}},h=l.stacks;f[a]=l;var u=mT(t);h[u]||l.autoWidthCount++,h[u]=h[u]||{width:0,maxWidth:0};var c=Ll(t.get("barWidth"),s),d=Ll(t.get("barMaxWidth"),s),p=t.get("barGap"),g=t.get("barCategoryGap");c&&!h[u].width&&(c=Math.min(l.remainedWidth,c),h[u].width=c,l.remainedWidth-=c),d&&(h[u].maxWidth=d),null!=p&&(l.gap=p),null!=g&&(l.categoryGap=g)});var d={};return P(f,function(t,n){d[n]={};var e=t.stacks,i=t.bandWidth,o=Ll(t.categoryGap,i),a=Ll(t.gap,1),r=t.remainedWidth,s=t.autoWidthCount,l=(r-o)/(s+(s-1)*a),l=Math.max(l,0);P(e,function(t,e){var n=t.maxWidth;n&&n<l&&(n=Math.min(n,r),t.width&&(n=Math.min(n,t.width)),r-=n,t.width=n,s--)}),l=(r-o)/(s+(s-1)*a),l=Math.max(l,0);var h,u=0;P(e,function(t,e){t.width||(t.width=l),u+=(h=t).width*(1+a)}),h&&(u-=h.width*a);var c=-u/2;P(e,function(t,e){d[n][e]=d[n][e]||{offset:c,width:t.width},c+=t.width*(1+a)})}),d}(I(e.getSeriesByType(t),function(t){return!e.isSeriesFiltered(t)&&t.coordinateSystem&&"polar"===t.coordinateSystem.type}));e.eachSeriesByType(t,function(t){if("polar"===t.coordinateSystem.type){var e=t.getData(),n=t.coordinateSystem,i=n.getBaseAxis(),o=vT(n,i),a=mT(t),r=O[o][a],s=r.offset,l=r.width,h=n.getOtherAxis(i),u=t.coordinateSystem.cx,c=t.coordinateSystem.cy,d=t.get("barMinHeight")||0,p=t.get("barMinAngle")||0;N[a]=N[a]||[];for(var g=e.mapDimension(h.dim),f=e.mapDimension(i.dim),m=ug(e,g),v="radius"!==i.dim||!t.get("roundCap",!0),y=h.getExtent()[0],x=0,_=e.count();x<_;x++){var w,b,S,M,I,T,A,D,C,L,k=e.get(g,x),P=e.get(f,x);isNaN(k)||(w=0<=k?"p":"n",b=y,m&&(N[a][P]||(N[a][P]={p:y,n:y}),b=N[a][P][w]),"radius"===h.dim?(A=h.dataToRadius(k)-y,D=i.dataToAngle(P),Math.abs(A)<d&&(A=(A<0?-1:1)*d),M=(S=b)+A,T=(I=D-s)-l,m&&(N[a][P][w]=M)):(C=h.dataToAngle(k,v)-y,L=i.dataToRadius(P),Math.abs(C)<p&&(C=(C<0?-1:1)*p),M=(S=L+s)+l,T=(I=b)+C,m&&(N[a][P][w]=T)),e.setItemLayout(x,{cx:u,cy:c,r0:S,r:M,startAngle:-I*Math.PI/180,endAngle:-T*Math.PI/180}))}}},this)},"bar")),bp({type:"polar"}),b(Mh.extend({type:"geo",coordinateSystem:null,layoutMode:"box",init:function(t){Mh.prototype.init.apply(this,arguments),Eo(t,"label",["show"])},optionUpdated:function(){var t=this.option,n=this;t.regions=hx.getFilledRegions(t.regions,t.map,t.nameMap),this._optionModelMap=S(t.regions||[],function(t,e){return e.name&&t.set(e.name,new Sl(e,n)),t},et()),this.updateSelectedMap(t.regions)},defaultOption:{zlevel:0,z:0,show:!0,left:"center",top:"center",aspectScale:null,silent:!1,map:"",boundingCoords:null,center:null,zoom:1,scaleLimit:null,label:{show:!1,color:"#000"},itemStyle:{borderWidth:.5,borderColor:"#444",color:"#eee"},emphasis:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{color:"rgba(255,215,0,0.8)"}},regions:[]},getRegionModel:function(t){return this._optionModelMap.get(t)||new Sl(null,this,this.ecModel)},getFormattedLabel:function(t,e){var n=this.getRegionModel(t).get("label"+("normal"===e?".":e+".")+"formatter"),i={name:t};return"function"==typeof n?(i.status=e,n(i)):"string"==typeof n?n.replace("{a}",null!=t?t:""):void 0},setZoom:function(t){this.option.zoom=t},setCenter:function(t){this.option.center=t}}),Hv),bp({type:"geo",init:function(t,e){var n=new qy(e,!0);this._mapDraw=n,this.group.add(n.group)},render:function(t,e,n,i){var o;i&&"geoToggleSelect"===i.type&&i.from===this.uid||(o=this._mapDraw,t.get("show")?o.draw(t,e,n,this,i):this._mapDraw.group.removeAll(),this.group.silent=t.get("silent"))},dispose:function(){this._mapDraw&&this._mapDraw.remove()}}),ET("toggleSelected",{type:"geoToggleSelect",event:"geoselectchanged"}),ET("select",{type:"geoSelect",event:"geoselected"}),ET("unSelect",{type:"geoUnSelect",event:"geounselected"});function zT(t,e,n){this._model=t}function RT(t,e,n,i){var o=n.calendarModel,a=n.seriesModel,r=o?o.coordinateSystem:a?a.coordinateSystem:null;return r===this?r[t](i):null}zT.prototype={constructor:zT,type:"calendar",dimensions:["time","value"],getDimensionsInfo:function(){return[{name:"time",type:"time"},"value"]},getRangeInfo:function(){return this._rangeInfo},getModel:function(){return this._model},getRect:function(){return this._rect},getCellWidth:function(){return this._sw},getCellHeight:function(){return this._sh},getOrient:function(){return this._orient},getFirstDayOfWeek:function(){return this._firstDayOfWeek},getDateInfo:function(t){var e=(t=Fl(t)).getFullYear(),n=(n=t.getMonth()+1)<10?"0"+n:n,i=(i=t.getDate())<10?"0"+i:i,o=t.getDay();return{y:e,m:n,d:i,day:o=Math.abs((o+7-this.getFirstDayOfWeek())%7),time:t.getTime(),formatedDate:e+"-"+n+"-"+i,date:t}},getNextNDay:function(t,e){return 0===(e=e||0)||(t=new Date(this.getDateInfo(t).time)).setDate(t.getDate()+e),this.getDateInfo(t)},update:function(t,e){this._firstDayOfWeek=+this._model.getModel("dayLabel").get("firstDay"),this._orient=this._model.get("orient"),this._lineWidth=this._model.getModel("itemStyle").getItemStyle().lineWidth||0,this._rangeInfo=this._getRangeInfo(this._initRangeOption());var n=this._rangeInfo.weeks||1,i=["width","height"],o=this._model.get("cellSize").slice(),a=this._model.getBoxLayoutParams(),r="horizontal"===this._orient?[n,7]:[7,n];P([0,1],function(t){h(o,t)&&(a[i[t]]=o[t]*r[t])});var s={width:e.getWidth(),height:e.getHeight()},l=this._rect=fh(a,s);function h(t,e){return null!=t[e]&&"auto"!==t[e]}P([0,1],function(t){h(o,t)||(o[t]=l[i[t]]/r[t])}),this._sw=o[0],this._sh=o[1]},dataToPoint:function(t,e){R(t)&&(t=t[0]),null==e&&(e=!0);var n=this.getDateInfo(t),i=this._rangeInfo,o=n.formatedDate;if(e&&!(n.time>=i.start.time&&n.time<i.end.time+864e5))return[NaN,NaN];var a=n.day,r=this._getRangeInfo([i.start.time,o]).nthWeek;return"vertical"===this._orient?[this._rect.x+a*this._sw+this._sw/2,this._rect.y+r*this._sh+this._sh/2]:[this._rect.x+r*this._sw+this._sw/2,this._rect.y+a*this._sh+this._sh/2]},pointToData:function(t){var e=this.pointToDate(t);return e&&e.time},dataToRect:function(t,e){var n=this.dataToPoint(t,e);return{contentShape:{x:n[0]-(this._sw-this._lineWidth)/2,y:n[1]-(this._sh-this._lineWidth)/2,width:this._sw-this._lineWidth,height:this._sh-this._lineWidth},center:n,tl:[n[0]-this._sw/2,n[1]-this._sh/2],tr:[n[0]+this._sw/2,n[1]-this._sh/2],br:[n[0]+this._sw/2,n[1]+this._sh/2],bl:[n[0]-this._sw/2,n[1]+this._sh/2]}},pointToDate:function(t){var e=Math.floor((t[0]-this._rect.x)/this._sw)+1,n=Math.floor((t[1]-this._rect.y)/this._sh)+1,i=this._rangeInfo.range;return"vertical"===this._orient?this._getDateByWeeksAndDay(n,e-1,i):this._getDateByWeeksAndDay(e,n-1,i)},convertToPixel:z(RT,"dataToPoint"),convertFromPixel:z(RT,"pointToData"),_initRangeOption:function(){var t,e,n,i=this._model.get("range"),o=i;R(o)&&1===o.length&&(o=o[0]),/^\d{4}$/.test(o)&&(i=[o+"-01-01",o+"-12-31"]),/^\d{4}[\/|-]\d{1,2}$/.test(o)&&((e=(t=this.getDateInfo(o)).date).setMonth(e.getMonth()+1),n=this.getNextNDay(e,-1),i=[t.formatedDate,n.formatedDate]),/^\d{4}[\/|-]\d{1,2}[\/|-]\d{1,2}$/.test(o)&&(i=[o,o]);var a=this._getRangeInfo(i);return a.start.time>a.end.time&&i.reverse(),i},_getRangeInfo:function(t){var e;(t=[this.getDateInfo(t[0]),this.getDateInfo(t[1])])[0].time>t[1].time&&(e=!0,t.reverse());var n=Math.floor(t[1].time/864e5)-Math.floor(t[0].time/864e5)+1,i=new Date(t[0].time),o=i.getDate(),a=t[1].date.getDate();if(i.setDate(o+n-1),i.getDate()!==a)for(var r=0<i.getTime()-t[1].time?1:-1;i.getDate()!==a&&0<(i.getTime()-t[1].time)*r;)n-=r,i.setDate(o+n-1);var s=Math.floor((n+t[0].day+6)/7),l=e?1-s:s-1;return e&&t.reverse(),{range:[t[0].formatedDate,t[1].formatedDate],start:t[0],end:t[1],allDay:n,weeks:s,nthWeek:l,fweek:t[0].day,lweek:t[1].day}},_getDateByWeeksAndDay:function(t,e,n){var i=this._getRangeInfo(n);if(t>i.weeks||0===t&&e<i.fweek||t===i.weeks&&e>i.lweek)return!1;var o=7*(t-1)-i.fweek+e,a=new Date(i.start.time);return a.setDate(i.start.d+o),this.getDateInfo(a)}},zT.dimensions=zT.prototype.dimensions,zT.getDimensionsInfo=zT.prototype.getDimensionsInfo,zT.create=function(t,e){var n=[];return t.eachComponent("calendar",function(t){var e=new zT(t);n.push(e),t.coordinateSystem=e}),t.eachSeries(function(t){"calendar"===t.get("coordinateSystem")&&(t.coordinateSystem=n[t.get("calendarIndex")||0])}),n},nu.register("calendar",zT);var BT=Mh.extend({type:"calendar",coordinateSystem:null,defaultOption:{zlevel:0,z:2,left:80,top:60,cellSize:20,orient:"horizontal",splitLine:{show:!0,lineStyle:{color:"#000",width:1,type:"solid"}},itemStyle:{color:"#fff",borderWidth:1,borderColor:"#ccc"},dayLabel:{show:!0,firstDay:0,position:"start",margin:"50%",nameMap:"en",color:"#000"},monthLabel:{show:!0,position:"start",margin:5,align:"center",nameMap:"en",formatter:null,color:"#000"},yearLabel:{show:!0,position:null,margin:30,formatter:null,color:"#ccc",fontFamily:"sans-serif",fontWeight:"bolder",fontSize:20}},init:function(t,e,n,i){var o=yh(t);BT.superApply(this,"init",arguments),VT(t,o)},mergeOption:function(t,e){BT.superApply(this,"mergeOption",arguments),VT(this.option,t)}});function VT(t,i){var o=t.cellSize;R(o)?1===o.length&&(o[1]=o[0]):o=t.cellSize=[o,o];var e=N([0,1],function(t){var e,n;return(null!=(e=i)[dh[n=t][0]]||null!=e[dh[n][1]]&&null!=e[dh[n][2]])&&(o[t]="auto"),null!=o[t]&&"auto"!==o[t]});vh(t,i,{type:"box",ignoreSize:e})}var GT={EN:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],CN:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},FT={EN:["S","M","T","W","T","F","S"],CN:["日","一","二","三","四","五","六"]};bp({type:"calendar",_tlpoints:null,_blpoints:null,_firstDayOfMonth:null,_firstDayPoints:null,render:function(t,e,n){var i=this.group;i.removeAll();var o=t.coordinateSystem,a=o.getRangeInfo(),r=o.getOrient();this._renderDayRect(t,a,i),this._renderLines(t,a,r,i),this._renderYearText(t,a,r,i),this._renderMonthText(t,r,i),this._renderWeekText(t,a,r,i)},_renderDayRect:function(t,e,n){for(var i=t.coordinateSystem,o=t.getModel("itemStyle").getItemStyle(),a=i.getCellWidth(),r=i.getCellHeight(),s=e.start.time;s<=e.end.time;s=i.getNextNDay(s,1).time){var l=i.dataToRect([s],!1).tl,h=new es({shape:{x:l[0],y:l[1],width:a,height:r},cursor:"default",style:o});n.add(h)}},_renderLines:function(n,t,i,o){var a=this,r=n.coordinateSystem,s=n.getModel("splitLine.lineStyle").getLineStyle(),l=n.get("splitLine.show"),e=s.lineWidth;this._tlpoints=[],this._blpoints=[],this._firstDayOfMonth=[],this._firstDayPoints=[];for(var h=t.start,u=0;h.time<=t.end.time;u++){d(h.formatedDate),0===u&&(h=r.getDateInfo(t.start.y+"-"+t.start.m));var c=h.date;c.setMonth(c.getMonth()+1),h=r.getDateInfo(c)}function d(t){a._firstDayOfMonth.push(r.getDateInfo(t)),a._firstDayPoints.push(r.dataToRect([t],!1).tl);var e=a._getLinePointsOfOneWeek(n,t,i);a._tlpoints.push(e[0]),a._blpoints.push(e[e.length-1]),l&&a._drawSplitline(e,s,o)}d(r.getNextNDay(t.end.time,1).formatedDate),l&&this._drawSplitline(a._getEdgesPoints(a._tlpoints,e,i),s,o),l&&this._drawSplitline(a._getEdgesPoints(a._blpoints,e,i),s,o)},_getEdgesPoints:function(t,e,n){var i=[t[0].slice(),t[t.length-1].slice()],o="horizontal"===n?0:1;return i[0][o]=i[0][o]-e/2,i[1][o]=i[1][o]+e/2,i},_drawSplitline:function(t,e,n){var i=new qr({z2:20,shape:{points:t},style:e});n.add(i)},_getLinePointsOfOneWeek:function(t,e,n){var i=t.coordinateSystem;e=i.getDateInfo(e);for(var o=[],a=0;a<7;a++){var r=i.getNextNDay(e.time,a),s=i.dataToRect([r.time],!1);o[2*r.day]=s.tl,o[2*r.day+1]=s["horizontal"===n?"bl":"tr"]}return o},_formatterLabel:function(t,e){return"string"==typeof t&&t?ih(t,e):"function"==typeof t?t(e):e.nameMap},_yearTextPositionControl:function(t,e,n,i,o){e=e.slice();var a=["center","bottom"];"bottom"===i?(e[1]+=o,a=["center","top"]):"left"===i?e[0]-=o:"right"===i?(e[0]+=o,a=["center","top"]):e[1]-=o;var r=0;return"left"!==i&&"right"!==i||(r=Math.PI/2),{rotation:r,position:e,style:{textAlign:a[0],textVerticalAlign:a[1]}}},_renderYearText:function(t,e,n,i){var o,a,r,s,l,h,u,c,d,p,g,f,m=t.getModel("yearLabel");m.get("show")&&(o=m.get("margin"),a=(a=m.get("position"))||("horizontal"!==n?"top":"left"),s=((r=[this._tlpoints[this._tlpoints.length-1],this._blpoints[0]])[0][0]+r[1][0])/2,l=(r[0][1]+r[1][1])/2,u={top:[s,r[h="horizontal"===n?0:1][1]],bottom:[s,r[1-h][1]],left:[r[1-h][0],l],right:[r[h][0],l]},c=e.start.y,+e.end.y>+e.start.y&&(c=c+"-"+e.end.y),d=m.get("formatter"),p={start:e.start.y,end:e.end.y,nameMap:c},g=this._formatterLabel(d,p),Js((f=new Gr({z2:30})).style,m,{text:g}),f.attr(this._yearTextPositionControl(f,u[a],n,a,o)),i.add(f))},_monthTextPositionControl:function(t,e,n,i,o){var a="left",r="top",s=t[0],l=t[1];return"horizontal"===n?(l+=o,e&&(a="center"),"start"===i&&(r="bottom")):(s+=o,e&&(r="middle"),"start"===i&&(a="right")),{x:s,y:l,textAlign:a,textVerticalAlign:r}},_renderMonthText:function(t,e,n){var i=t.getModel("monthLabel");if(i.get("show")){var o=i.get("nameMap"),a=i.get("margin"),r=i.get("position"),s=i.get("align"),l=[this._tlpoints,this._blpoints];B(o)&&(o=GT[o.toUpperCase()]||[]);for(var h="start"===r?0:1,u="horizontal"===e?0:1,a="start"===r?-a:a,c="center"===s,d=0;d<l[h].length-1;d++){var p,g=l[h][d].slice(),f=this._firstDayOfMonth[d];c&&(p=this._firstDayPoints[d],g[u]=(p[u]+l[0][d+1][u])/2);var m=i.get("formatter"),v=o[f.m-1],y={yyyy:f.y,yy:(f.y+"").slice(2),MM:f.m,M:+f.m,nameMap:v},x=this._formatterLabel(m,y),_=new Gr({z2:30});k(Js(_.style,i,{text:x}),this._monthTextPositionControl(g,c,e,r,a)),n.add(_)}}},_weekTextPositionControl:function(t,e,n,i,o){var a="center",r="middle",s=t[0],l=t[1],h="start"===n;return"horizontal"===e?(s=s+i+(h?1:-1)*o[0]/2,a=h?"right":"left"):(l=l+i+(h?1:-1)*o[1]/2,r=h?"bottom":"top"),{x:s,y:l,textAlign:a,textVerticalAlign:r}},_renderWeekText:function(t,e,n,i){var o=t.getModel("dayLabel");if(o.get("show")){var a=t.coordinateSystem,r=o.get("position"),s=o.get("nameMap"),l=o.get("margin"),h=a.getFirstDayOfWeek();B(s)&&(s=FT[s.toUpperCase()]||[]);var u=a.getNextNDay(e.end.time,7-e.lweek).time,c=[a.getCellWidth(),a.getCellHeight()],l=Ll(l,c["horizontal"===n?0:1]);"start"===r&&(u=a.getNextNDay(e.start.time,-(7+e.fweek)).time,l=-l);for(var d=0;d<7;d++){var p=a.getNextNDay(u,d),g=a.dataToRect([p.time],!1).center,f=Math.abs((d+h)%7),m=new Gr({z2:30});k(Js(m.style,o,{text:s[f]}),this._weekTextPositionControl(g,n,r,l,c)),i.add(m)}}}});var WT={path:null,compoundPath:null,group:Mn,image:Yi,text:Gr};pp(function(t){var e=t.graphic;R(e)?e[0]&&e[0].elements?t.graphic=[t.graphic[0]]:t.graphic=[{elements:e}]:e&&!e.elements&&(t.graphic=[{elements:[e]}])});var HT=wp({type:"graphic",defaultOption:{elements:[],parentId:null},_elOptionsToUpdate:null,mergeOption:function(t){var e=this.option.elements;this.option.elements=null,HT.superApply(this,"mergeOption",arguments),this.option.elements=e},optionUpdated:function(t,e){var n=this.option,i=(e?n:t).elements,o=n.elements=e?[]:n.elements,a=[];this._flatten(i,a);var r=Bo(o,a);Vo(r);var s=this._elOptionsToUpdate=[];P(r,function(t,e){var n=t.option;D&&q(V(n)||t.exist,"Empty graphic option definition"),n&&(s.push(n),function(t,e){var n=t.exist;{var i;e.id=t.keyInfo.id,!e.type&&n&&(e.type=n.type),null==e.parentId&&((i=e.parentOption)?e.parentId=i.id:n&&(e.parentId=n.parentId))}e.parentOption=null}(t,n),function(t,e,n){var i=k({},n),o=t[e],a=n.$action||"merge";{var r;"merge"===a?o?(D&&q(!(r=n.type)||o.type===r,'Please set $action: "replace" to change `type`'),m(o,i,!0),vh(o,i,{ignoreSize:!0}),xh(n,o)):t[e]=i:"replace"===a?t[e]=i:"remove"===a&&o&&(t[e]=null)}}(o,e,n),function(t,e){if(!t)return;t.hv=e.hv=[XT(e,["left","right"]),XT(e,["top","bottom"])],"group"===t.type&&(null==t.width&&(t.width=e.width=0),null==t.height&&(t.height=e.height=0))}(o[e],n))},this);for(var l=o.length-1;0<=l;l--)null==o[l]?o.splice(l,1):delete o[l].$action},_flatten:function(t,n,i){P(t,function(t){var e;t&&(i&&(t.parentOption=i),n.push(t),e=t.children,"group"===t.type&&e&&this._flatten(e,n,t),delete t.children)},this)},useElOptionsToUpdate:function(){var t=this._elOptionsToUpdate;return this._elOptionsToUpdate=null,t}});function ZT(t,e,n,i){var o=n.type;D&&q(o,"graphic type MUST be set");var a=WT.hasOwnProperty(o)?WT[o]:Ts(o);D&&q(a,"graphic type can not be found");var r=new a(n);e.add(r),i.set(t,r),r.__ecGraphicId=t}function UT(t,e){var n=t&&t.parent;n&&("group"===t.type&&t.traverse(function(t){UT(t,e)}),e.removeKey(t.__ecGraphicId),n.remove(t))}function XT(e,t){var n;return P(t,function(t){null!=e[t]&&"auto"!==e[t]&&(n=!0)}),n}bp({type:"graphic",init:function(t,e){this._elMap=et(),this._lastGraphicModel},render:function(t,e,n){t!==this._lastGraphicModel&&this._clear(),this._lastGraphicModel=t,this._updateElements(t),this._relocate(t,n)},_updateElements:function(u){var c,d,t=u.useElOptionsToUpdate();t&&(c=this._elMap,d=this.group,P(t,function(t){var e=t.$action,n=t.id,i=c.get(n),o=t.parentId,a=null!=o?c.get(o):d,r=t.style;"text"===t.type&&r&&(t.hv&&t.hv[1]&&(r.textVerticalAlign=r.textBaseline=null),!r.hasOwnProperty("textFill")&&r.fill&&(r.textFill=r.fill),!r.hasOwnProperty("textStroke")&&r.stroke&&(r.textStroke=r.stroke));var s,l=(s=k({},s=t),P(["id","parentId","$action","hv","bounding"].concat(ch),function(t){delete s[t]}),s);D&&i&&q(a===i.parent,"Changing parent is not supported."),e&&"merge"!==e?"replace"===e?(UT(i,c),ZT(n,a,l,c)):"remove"===e&&UT(i,c):i?i.attr(l):ZT(n,a,l,c);var h=c.get(n);h&&(h.__ecGraphicWidthOption=t.width,h.__ecGraphicHeightOption=t.height,function(t,e){var n=t.eventData;t.silent||t.ignore||n||(n=t.eventData={componentType:"graphic",componentIndex:e.componentIndex,name:t.name});n&&(n.info=t.info)}(h,u))}))},_relocate:function(t,e){for(var n=t.option.elements,i=this.group,o=this._elMap,a=e.getWidth(),r=e.getHeight(),s=0;s<n.length;s++){var l,h=n[s];(u=o.get(h.id))&&u.isGroup&&(l=(c=u.parent)===i,u.__ecGraphicWidth=Ll(u.__ecGraphicWidthOption,l?a:c.__ecGraphicWidth)||0,u.__ecGraphicHeight=Ll(u.__ecGraphicHeightOption,l?r:c.__ecGraphicHeight)||0)}for(s=n.length-1;0<=s;s--){var u,c,h=n[s];(u=o.get(h.id))&&mh(u,h,(c=u.parent)===i?{width:a,height:r}:{width:c.__ecGraphicWidth,height:c.__ecGraphicHeight},null,{hv:h.hv,boundingMode:h.bounding})}},_clear:function(){var e=this._elMap;e.each(function(t){UT(t,e)}),this._elMap=et()},dispose:function(){this._clear()}});var YT={};function jT(t,e){YT[t]=e}function qT(t){return YT[t]}var KT=wp({type:"toolbox",layoutMode:{type:"box",ignoreSize:!0},optionUpdated:function(){KT.superApply(this,"optionUpdated",arguments),P(this.option.feature,function(t,e){var n=qT(e);n&&m(t,n.defaultOption)})},defaultOption:{show:!0,z:6,zlevel:0,orient:"horizontal",left:"right",top:"top",backgroundColor:"transparent",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemSize:15,itemGap:8,showTitle:!0,iconStyle:{borderColor:"#666",color:"none"},emphasis:{iconStyle:{borderColor:"#3E98C5"}},tooltip:{show:!1}}});function $T(t,e){var n=Kl(e.get("padding")),i=e.getItemStyle(["color","opacity"]);return i.fill=e.get("backgroundColor"),t=new es({shape:{x:t.x-n[3],y:t.y-n[0],width:t.width+n[1]+n[3],height:t.height+n[0]+n[2],r:e.get("borderRadius")},style:i,silent:!0,z2:-1})}bp({type:"toolbox",render:function(u,c,d,l){var p,h,g,f,t,e,n,i,o,a,r,m=this.group;function s(t,e){var n,i=f[t],o=f[e],a=h[i],r=new Sl(a,u,u.ecModel);if(l&&null!=l.newTitle&&(a.title=l.newTitle),i&&!o){if(0===i.indexOf("my"))n={model:r,onclick:r.option.onclick,featureName:i};else{var s=qT(i);if(!s)return;n=new s(r,c,d)}g[i]=n}else{if(!(n=g[o]))return;n.model=r,n.ecModel=c,n.api=d}i||!o?r.get("show")&&!n.unusable?(function(o,a,t){var r=o.getModel("iconStyle"),s=o.getModel("emphasis.iconStyle"),e=a.getIcons?a.getIcons():o.get("icon"),l=o.get("title")||{};{var n,i;"string"==typeof e&&(n=e,i=l,l={},(e={})[t]=n,l[t]=i)}var h=o.iconPaths={};P(e,function(t,e){var n=pl(t,{},{x:-p/2,y:-p/2,width:p,height:p});n.setStyle(r.getItemStyle()),n.hoverStyle=s.getItemStyle(),n.setStyle({text:l[e],textAlign:s.get("textAlign"),textBorderRadius:s.get("textBorderRadius"),textPadding:s.get("textPadding"),textFill:null});var i=u.getModel("tooltip");i&&i.get("show")&&n.attr("tooltip",k({content:l[e],formatter:i.get("formatter",!0)||function(){return l[e]},formatterParams:{componentType:"toolbox",name:e,title:l[e],$vars:["name","title"]},position:i.get("position",!0)||"bottom"},i.option)),Xs(n),u.get("showTitle")&&(n.__title=l[e],n.on("mouseover",function(){var t=s.getItemStyle(),e="vertical"===u.get("orient")?null==u.get("right")?"right":"left":null==u.get("bottom")?"bottom":"top";n.setStyle({textFill:s.get("textFill")||t.fill||t.stroke||"#000",textBackgroundColor:s.get("textBackgroundColor"),textPosition:s.get("textPosition")||e})}).on("mouseout",function(){n.setStyle({textFill:null,textBackgroundColor:null})})),n.trigger(o.get("iconStatus."+e)||"normal"),m.add(n),n.on("click",E(a.onclick,a,c,d,e)),h[e]=n})}(r,n,i),r.setIconStatus=function(t,e){var n=this.option,i=this.iconPaths;n.iconStatus=n.iconStatus||{},n.iconStatus[t]=e,i[t]&&i[t].trigger(e)},n.render&&n.render(r,c,d,l)):n.remove&&n.remove(c,d):n.dispose&&n.dispose(c,d)}m.removeAll(),u.get("show")&&(p=+u.get("itemSize"),h=u.get("feature")||{},g=this._features||(this._features={}),f=[],P(h,function(t,e){f.push(e)}),new Tp(this._featureNames||[],f).add(s).update(s).remove(z(s,null)).execute(),this._featureNames=f,t=m,n=d,i=(e=u).getBoxLayoutParams(),o=e.get("padding"),a={width:n.getWidth(),height:n.getHeight()},r=fh(i,a,o),gh(e.get("orient"),t,e.get("itemGap"),r.width,r.height),mh(t,i,a,o),m.add($T(m.getBoundingRect(),u)),m.eachChild(function(t){var e,n,i,o,a=t.__title,r=t.hoverStyle;r&&a&&(e=hi(a,wi(r)),n=t.position[0]+m.position[0],i=!1,t.position[1]+m.position[1]+p+e.height>d.getHeight()&&(r.textPosition="top",i=!0),o=i?-5-e.height:p+8,n+e.width/2>d.getWidth()?(r.textPosition=["100%",o],r.textAlign="right"):n-e.width/2<0&&(r.textPosition=[0,o],r.textAlign="left"))}))},updateView:function(t,e,n,i){P(this._features,function(t){t.updateView&&t.updateView(t.model,e,n,i)})},remove:function(e,n){P(this._features,function(t){t.remove&&t.remove(e,n)}),this.group.removeAll()},dispose:function(e,n){P(this._features,function(t){t.dispose&&t.dispose(e,n)})}});var JT=Dc.toolbox.saveAsImage;function QT(t){this.model=t}QT.defaultOption={show:!0,icon:"M4.7,22.9L29.3,45.5L54.7,23.4M4.6,43.6L4.6,58L53.8,58L53.8,43.6M29.2,45.1L29.2,0",title:JT.title,type:"png",connectedBackgroundColor:"#fff",name:"",excludeComponents:["toolbox"],pixelRatio:1,lang:JT.lang.slice()},QT.prototype.unusable=!v.canvasSupported,QT.prototype.onclick=function(t,e){var n=this.model,i=n.get("name")||t.get("title.0.text")||"echarts",o=n.get("type",!0)||"png",a=e.getConnectedDataURL({type:o,backgroundColor:n.get("backgroundColor",!0)||t.get("backgroundColor")||"#fff",connectedBackgroundColor:n.get("connectedBackgroundColor"),excludeComponents:n.get("excludeComponents"),pixelRatio:n.get("pixelRatio")});if("function"!=typeof MouseEvent||v.browser.ie||v.browser.edge)if(window.navigator.msSaveOrOpenBlob){for(var r=atob(a.split(",")[1]),s=r.length,l=new Uint8Array(s);s--;)l[s]=r.charCodeAt(s);var h=new Blob([l]);window.navigator.msSaveOrOpenBlob(h,i+"."+o)}else{var u=n.get("lang"),c='<body style="margin:0;"><img src="'+a+'" style="max-width:100%;" title="'+(u&&u[0]||"")+'" /></body>';window.open().document.write(c)}else{var d=document.createElement("a");d.download=i+"."+o,d.target="_blank",d.href=a;var p=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1});d.dispatchEvent(p)}},jT("saveAsImage",QT);var tA=Dc.toolbox.magicType,eA="__ec_magicType_stack__";function nA(t){this.model=t}nA.defaultOption={show:!0,type:[],icon:{line:"M4.1,28.9h7.1l9.3-22l7.4,38l9.7-19.7l3,12.8h14.9M4.1,58h51.4",bar:"M6.7,22.9h10V48h-10V22.9zM24.9,13h10v35h-10V13zM43.2,2h10v46h-10V2zM3.1,58h53.7",stack:"M8.2,38.4l-8.4,4.1l30.6,15.3L60,42.5l-8.1-4.1l-21.5,11L8.2,38.4z M51.9,30l-8.1,4.2l-13.4,6.9l-13.9-6.9L8.2,30l-8.4,4.2l8.4,4.2l22.2,11l21.5-11l8.1-4.2L51.9,30z M51.9,21.7l-8.1,4.2L35.7,30l-5.3,2.8L24.9,30l-8.4-4.1l-8.3-4.2l-8.4,4.2L8.2,30l8.3,4.2l13.9,6.9l13.4-6.9l8.1-4.2l8.1-4.1L51.9,21.7zM30.4,2.2L-0.2,17.5l8.4,4.1l8.3,4.2l8.4,4.2l5.5,2.7l5.3-2.7l8.1-4.2l8.1-4.2l8.1-4.1L30.4,2.2z"},title:C(tA.title),option:{},seriesIndex:{}};var iA=nA.prototype;iA.getIcons=function(){var t=this.model,e=t.get("icon"),n={};return P(t.get("type"),function(t){e[t]&&(n[t]=e[t])}),n};var oA={line:function(t,e,n,i){if("bar"===t)return m({id:e,type:"line",data:n.get("data"),stack:n.get("stack"),markPoint:n.get("markPoint"),markLine:n.get("markLine")},i.get("option.line")||{},!0)},bar:function(t,e,n,i){if("line"===t)return m({id:e,type:"bar",data:n.get("data"),stack:n.get("stack"),markPoint:n.get("markPoint"),markLine:n.get("markLine")},i.get("option.bar")||{},!0)},stack:function(t,e,n,i){var o=n.get("stack")===eA;if("line"===t||"bar"===t)return i.setIconStatus("stack",o?"normal":"emphasis"),m({id:e,stack:o?"":eA},i.get("option.stack")||{},!0)}},aA=[["line","bar"],["stack"]];iA.onclick=function(h,t,u){var c,e,d=this.model,n=d.get("seriesIndex."+u);oA[u]&&(c={series:[]},P(aA,function(t){0<=M(t,u)&&P(t,function(t){d.setIconStatus(t,"normal")})}),d.setIconStatus(u,"emphasis"),h.eachComponent({mainType:"series",query:null==n?null:{seriesIndex:n}},function(t){var e=t.subType,n=t.id,i=oA[u](e,n,t,d);i&&(L(i,t.option),c.series.push(i));var o=t.coordinateSystem;if(o&&"cartesian2d"===o.type&&("line"===u||"bar"===u)){var a=o.getAxesByScale("ordinal")[0];if(a){var r=a.dim+"Axis",s=h.queryComponents({mainType:r,index:t.get(name+"Index"),id:t.get(name+"Id")})[0].componentIndex;c[r]=c[r]||[];for(var l=0;l<=s;l++)c[r][s]=c[r][s]||{};c[r][s].boundaryGap="bar"===u}}}),"stack"===u&&(e=c.series&&c.series[0]&&c.series[0].stack===eA?m({stack:tA.title.tiled},tA.title):C(tA.title)),t.dispatchAction({type:"changeMagicType",currentType:u,newOption:c,newTitle:e}))},fp({type:"changeMagicType",event:"magicTypeChanged",update:"prepareAndUpdate"},function(t,e){e.mergeOption(t.newOption)}),jT("magicType",nA);var rA=Dc.toolbox.dataView,sA=new Array(60).join("-"),lA="\t";function hA(t){var o,a,r,u,e=(o={},a=[],r=[],t.eachRawSeries(function(t){var e,n,i=t.coordinateSystem;!i||"cartesian2d"!==i.type&&"polar"!==i.type||"category"!==(e=i.getBaseAxis()).type?a.push(t):(n=e.dim+"_"+e.index,o[n]||(o[n]={categoryAxis:e,valueAxis:i.getOtherAxis(e),series:[]},r.push({axisDim:e.dim,axisIndex:e.index})),o[n].series.push(t))}),{seriesGroupByCategoryAxis:o,other:a,meta:r});return{value:I([(u=[],P(e.seriesGroupByCategoryAxis,function(t,e){var n=t.categoryAxis,i=t.valueAxis.dim,o=[" "].concat(N(t.series,function(t){return t.name})),a=[n.model.getCategories()];P(t.series,function(t){a.push(t.getRawData().mapArray(i,function(t){return t}))});for(var r=[o.join(lA)],s=0;s<a[0].length;s++){for(var l=[],h=0;h<a.length;h++)l.push(a[h][s]);r.push(l.join(lA))}u.push(r.join("\n"))}),u.join("\n\n"+sA+"\n\n")),N(e.other,function(t){var o=t.getRawData(),a=[t.name],r=[];return o.each(o.dimensions,function(){for(var t=arguments.length,e=arguments[t-1],n=o.getName(e),i=0;i<t-1;i++)r[i]=arguments[i];a.push((n?n+lA:"")+r.join(lA))}),a.join("\n")}).join("\n\n"+sA+"\n\n")],function(t){return t.replace(/[\n\t\s]/g,"")}).join("\n\n"+sA+"\n\n"),meta:e.meta}}function uA(t){return t.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}var cA=new RegExp("["+lA+"]+","g");function dA(t,r){var e=t.split(new RegExp("\n*"+sA+"\n*","g")),s={series:[]};return P(e,function(t,e){var n,i,o,a;0<=(a=t).slice(0,a.indexOf("\n")).indexOf(lA)?(o=function(t){for(var e=t.split(/\n+/g),n=[],i=N(uA(e.shift()).split(cA),function(t){return{name:t,data:[]}}),o=0;o<e.length;o++){var a=uA(e[o]).split(cA);n.push(a.shift());for(var r=0;r<a.length;r++)i[r]&&(i[r].data[o]=a[r])}return{series:i,categories:n}}(t),i=(n=r[e]).axisDim+"Axis",n&&(s[i]=s[i]||[],s[i][n.axisIndex]={data:o.categories},s.series=s.series.concat(o.series))):(o=function(t){for(var e=t.split(/\n+/g),n=uA(e.shift()),i=[],o=0;o<e.length;o++){for(var a=uA(e[o]).split(cA),r="",s=!1,l=isNaN(a[0])?(s=!0,r=a[0],a=a.slice(1),i[o]={name:r,value:[]},i[o].value):i[o]=[],h=0;h<a.length;h++)l.push(+a[h]);1===l.length&&(s?i[o].value=l[0]:i[o]=l[0])}return{name:n,data:i}}(t),s.series.push(o))}),s}function pA(t){this._dom=null,this.model=t}pA.defaultOption={show:!0,readOnly:!1,optionToContent:null,contentToOption:null,icon:"M17.5,17.3H33 M17.5,17.3H33 M45.4,29.5h-28 M11.5,2v56H51V14.8L38.4,2H11.5z M38.4,2.2v12.7H51 M45.4,41.7h-28",title:C(rA.title),lang:C(rA.lang),backgroundColor:"#fff",textColor:"#000",textareaColor:"#fff",textareaBorderColor:"#333",buttonColor:"#c23531",buttonTextColor:"#fff"},pA.prototype.onclick=function(t,e){var n=e.getDom(),i=this.model;this._dom&&n.removeChild(this._dom);var o=document.createElement("div");o.style.cssText="position:absolute;left:5px;top:5px;bottom:5px;right:5px;",o.style.backgroundColor=i.get("backgroundColor")||"#fff";var a=document.createElement("h4"),r=i.get("lang")||[];a.innerHTML=r[0]||i.get("title"),a.style.cssText="margin: 10px 20px;",a.style.color=i.get("textColor");var s=document.createElement("div"),l=document.createElement("textarea");s.style.cssText="display:block;width:100%;overflow:auto;";var h,u=i.get("optionToContent"),c=i.get("contentToOption"),d=hA(t);"function"==typeof u?"string"==typeof(h=u(e.getOption()))?s.innerHTML=h:W(h)&&s.appendChild(h):(s.appendChild(l),l.readOnly=i.get("readOnly"),l.style.cssText="width:100%;height:100%;font-family:monospace;font-size:14px;line-height:1.6rem;",l.style.color=i.get("textColor"),l.style.borderColor=i.get("textareaBorderColor"),l.style.backgroundColor=i.get("textareaColor"),l.value=d.value);var p=d.meta,g=document.createElement("div");g.style.cssText="position:absolute;bottom:0;left:0;right:0;";var f="float:right;margin-right:20px;border:none;cursor:pointer;padding:2px 5px;font-size:12px;border-radius:3px",m=document.createElement("div"),v=document.createElement("div");f+=";background-color:"+i.get("buttonColor"),f+=";color:"+i.get("buttonTextColor");var y=this;function x(){n.removeChild(o),y._dom=null}Ft(m,"click",x),Ft(v,"click",function(){var t;try{t="function"==typeof c?c(s,e.getOption()):dA(l.value,p)}catch(t){throw x(),new Error("Data view format error "+t)}t&&e.dispatchAction({type:"changeDataView",newOption:t}),x()}),m.innerHTML=r[1],v.innerHTML=r[2],v.style.cssText=f,m.style.cssText=f,i.get("readOnly")||g.appendChild(v),g.appendChild(m),o.appendChild(a),o.appendChild(s),o.appendChild(g),s.style.height=n.clientHeight-80+"px",n.appendChild(o),this._dom=o},pA.prototype.remove=function(t,e){this._dom&&e.getDom().removeChild(this._dom)},pA.prototype.dispose=function(t,e){this.remove(t,e)},jT("dataView",pA),fp({type:"changeDataView",event:"dataViewChanged",update:"prepareAndUpdate"},function(t,a){var r=[];P(t.newOption.series,function(t){var e,n,i,o=a.getSeriesByName(t.name)[0];o?(e=o.get("data"),r.push({name:t.name,data:(n=t.data,i=e,N(n,function(t,e){var n=i&&i[e];return V(n)&&!R(n)?(V(t)&&!R(t)&&(t=t.value),L({value:t},n)):t}))})):r.push(k({type:"scatter"},t))}),a.mergeOption(L({series:r},t.newOption))});var gA=P,fA=M,mA=z,vA=["dataToPoint","pointToData"],yA=["grid","xAxis","yAxis","geo","graph","polar","radiusAxis","angleAxis","bmap"];function xA(t,e,n){var i=this._targetInfoList=[],o={},a=bA(e,t);gA(SA,function(t,e){n&&n.include&&!(0<=fA(n.include,e))||t(a,i,o)})}var _A=xA.prototype;function wA(t){return t[0]>t[1]&&t.reverse(),t}function bA(t,e){return Uo(t,e,{includeMainTypes:yA})}_A.setOutputRanges=function(t,e){this.matchOutputRanges(t,e,function(t,e,n){var i;(t.coordRanges||(t.coordRanges=[])).push(e),t.coordRange||(t.coordRange=e,i=TA[t.brushType](0,n,e),t.__rangeOffset={offset:DA[t.brushType](i.values,t.range,[1,1]),xyMinMax:i.xyMinMax})})},_A.matchOutputRanges=function(t,i,o){gA(t,function(n){var t=this.findTargetInfo(n,i);t&&!0!==t&&P(t.coordSyses,function(t){var e=TA[n.brushType](1,t,n.range);o(n,e.values,t,i)})},this)},_A.setInputRanges=function(t,h){gA(t,function(t){var e,n,i,o,a,r,s,l=this.findTargetInfo(t,h);D&&(q(!l||!0===l||t.coordRange,"coordRange must be specified when coord index specified."),q(!l||!0!==l||t.range,"range must be specified in global brush.")),t.range=t.range||[],l&&!0!==l&&(t.panelId=l.panelId,e=TA[t.brushType](0,l.coordSys,t.coordRange),n=t.__rangeOffset,t.range=n?DA[t.brushType](e.values,n.offset,(i=e.xyMinMax,o=n.xyMinMax,a=LA(i),r=LA(o),s=[a[0]/r[0],a[1]/r[1]],isNaN(s[0])&&(s[0]=1),isNaN(s[1])&&(s[1]=1),s)):e.values)},this)},_A.makePanelOpts=function(n,i){return N(this._targetInfoList,function(t){var e=t.getPanelRect();return{panelId:t.panelId,defaultBrushType:i&&i(t),clipPath:Kb(e),isTargetByCursor:Jb(e,n,t.coordSysModel),getLinearBrushOtherExtent:$b(e)}})},_A.controlSeries=function(t,e,n){var i=this.findTargetInfo(t,n);return!0===i||i&&0<=fA(i.coordSyses,e.coordinateSystem)},_A.findTargetInfo=function(t,e){for(var n=this._targetInfoList,i=bA(e,t),o=0;o<n.length;o++){var a=n[o],r=t.panelId;if(r){if(a.panelId===r)return a}else for(o=0;o<MA.length;o++)if(MA[o](i,a))return a}return!0};var SA={grid:function(t,i){var o=t.xAxisModels,a=t.yAxisModels,e=t.gridModels,n=et(),r={},s={};(o||a||e)&&(gA(o,function(t){var e=t.axis.grid.model;n.set(e.id,e),r[e.id]=!0}),gA(a,function(t){var e=t.axis.grid.model;n.set(e.id,e),s[e.id]=!0}),gA(e,function(t){n.set(t.id,t),r[t.id]=!0,s[t.id]=!0}),n.each(function(t){var e=t.coordinateSystem,n=[];gA(e.getCartesians(),function(t,e){(0<=fA(o,t.getAxis("x").model)||0<=fA(a,t.getAxis("y").model))&&n.push(t)}),i.push({panelId:"grid--"+t.id,gridModel:t,coordSysModel:t,coordSys:n[0],coordSyses:n,getPanelRect:IA.grid,xAxisDeclared:r[t.id],yAxisDeclared:s[t.id]})}))},geo:function(t,n){gA(t.geoModels,function(t){var e=t.coordinateSystem;n.push({panelId:"geo--"+t.id,geoModel:t,coordSysModel:t,coordSys:e,coordSyses:[e],getPanelRect:IA.geo})})}},MA=[function(t,e){var n=t.xAxisModel,i=t.yAxisModel,o=t.gridModel;return!o&&n&&(o=n.axis.grid.model),!o&&i&&(o=i.axis.grid.model),o&&o===e.gridModel},function(t,e){var n=t.geoModel;return n&&n===e.geoModel}],IA={grid:function(){return this.coordSys.grid.getRect().clone()},geo:function(){var t=this.coordSys,e=t.getBoundingRect().clone();return e.applyTransform(ll(t)),e}},TA={lineX:mA(AA,0),lineY:mA(AA,1),rect:function(t,e,n){var i=e[vA[t]]([n[0][0],n[1][0]]),o=e[vA[t]]([n[0][1],n[1][1]]),a=[wA([i[0],o[0]]),wA([i[1],o[1]])];return{values:a,xyMinMax:a}},polygon:function(n,i,t){var o=[[1/0,-1/0],[1/0,-1/0]];return{values:N(t,function(t){var e=i[vA[n]](t);return o[0][0]=Math.min(o[0][0],e[0]),o[1][0]=Math.min(o[1][0],e[1]),o[0][1]=Math.max(o[0][1],e[0]),o[1][1]=Math.max(o[1][1],e[1]),e}),xyMinMax:o}}};function AA(t,e,n,i){D&&q("cartesian2d"===n.type,"lineX/lineY brush is available only in cartesian2d.");var o=n.getAxis(["x","y"][t]),a=wA(N([0,1],function(t){return e?o.coordToData(o.toLocalCoord(i[t])):o.toGlobalCoord(o.dataToCoord(i[t]))})),r=[];return r[t]=a,r[1-t]=[NaN,NaN],{values:a,xyMinMax:r}}var DA={lineX:mA(CA,0),lineY:mA(CA,1),rect:function(t,e,n){return[[t[0][0]-n[0]*e[0][0],t[0][1]-n[0]*e[0][1]],[t[1][0]-n[1]*e[1][0],t[1][1]-n[1]*e[1][1]]]},polygon:function(t,n,i){return N(t,function(t,e){return[t[0]-i[0]*n[e][0],t[1]-i[1]*n[e][1]]})}};function CA(t,e,n,i){return[e[0]-i[t]*n[0],e[1]-i[t]*n[1]]}function LA(t){return t?[t[0][1]-t[0][0],t[1][1]-t[1][0]]:[NaN,NaN]}var kA=P,PA="\0_ec_hist_store";function NA(t){return t[PA]||(t[PA]=[{}])}Mh.registerSubTypeDefaulter("dataZoom",function(){return"slider"});var OA=["cartesian2d","polar","singleAxis"];var EA,zA,RA,BA,VA=(zA=["axisIndex","axis","index","id"],RA=N(EA=(EA=["x","y","z","radius","angle","single"]).slice(),sh),BA=N(zA=(zA||[]).slice(),sh),function(o,a){P(EA,function(t,e){for(var n={name:t,capital:RA[e]},i=0;i<zA.length;i++)n[zA[i]]=t+BA[i];o.call(a,n)})});function GA(n,s,l){return function(t){var a,r={nodes:[],records:{}};if(s(function(t){r.records[t.name]={}}),!t)return r;for(h(t,r);a=!1,n(e),a;);function e(t){var n,i,o,e;e=t,0<=M(r.nodes,e)||(n=t,i=r,o=!1,s(function(e){P(l(n,e)||[],function(t){i.records[e.name][t]&&(o=!0)})}),!o)||(h(t,r),a=!0)}return r};function h(t,n){n.nodes.push(t),s(function(e){P(l(t,e)||[],function(t){n.records[e.name][t]=!0})})}}function FA(t,e,n,i){this._dimName=t,this._axisIndex=e,this._valueWindow,this._percentWindow,this._dataExtent,this._minMaxSpan,this.ecModel=i,this._dataZoomModel=n}var WA=P,HA=Pl;function ZA(t,e){var n,i,o=t.getAxisModel(),a=t._percentWindow,r=t._valueWindow;a&&(n=El(r,[0,500]),n=Math.min(n,20),i=e||0===a[0]&&100===a[1],o.setRange(i?null:+r[0].toFixed(n),i?null:+r[1].toFixed(n)))}FA.prototype={constructor:FA,hostedBy:function(t){return this._dataZoomModel===t},getDataValueWindow:function(){return this._valueWindow.slice()},getDataPercentWindow:function(){return this._percentWindow.slice()},getTargetSeriesModels:function(){var o=[],a=this.ecModel;return a.eachSeries(function(t){var e,n,i;i=t.get("coordinateSystem"),0<=M(OA,i)&&(e=this._dimName,n=a.queryComponents({mainType:e+"Axis",index:t.get(e+"AxisIndex"),id:t.get(e+"AxisId")})[0],this._axisIndex===(n&&n.componentIndex)&&o.push(t))},this),o},getAxisModel:function(){return this.ecModel.getComponent(this._dimName+"Axis",this._axisIndex)},getOtherAxisModel:function(){var e,n,t=this._dimName,i=this.ecModel,o=this.getAxisModel(),a="x"===t||"y"===t?(e="gridIndex","x"===t?"y":"x"):(e="polarIndex","angle"===t?"radius":"angle");return i.eachComponent(a+"Axis",function(t){(t.get(e)||0)===(o.get(e)||0)&&(n=t)}),n},getMinMaxSpan:function(){return C(this._minMaxSpan)},calculateDataWindow:function(o){var a,r=this._dataExtent,s=this.getAxisModel().axis.scale,l=this._dataZoomModel.getRangePropMode(),h=[0,100],u=[],c=[];WA(["start","end"],function(t,e){var n=o[t],i=o[t+"Value"];"percent"===l[e]?(null==n&&(n=h[e]),i=s.parse(Cl(n,h,r))):(a=!0,n=Cl(i=null==i?r[e]:s.parse(i),r,h)),c[e]=i,u[e]=n}),HA(c),HA(u);var d=this._minMaxSpan;function t(t,e,n,i,o){var a=o?"Span":"ValueSpan";Yw(0,t,n,"all",d["min"+a],d["max"+a]);for(var r=0;r<2;r++)e[r]=Cl(t[r],n,i,!0),o&&(e[r]=s.parse(e[r]))}return a?t(c,u,r,h,!1):t(u,c,h,r,!0),{valueWindow:c,percentWindow:u}},reset:function(t){var e,i,o,a,r,n;t===this._dataZoomModel&&(e=this.getTargetSeriesModels(),this._dataExtent=function(t,e,n){var i=[1/0,-1/0];WA(n,function(t){var n=t.getData();n&&WA(n.mapDimension(e,!0),function(t){var e=n.getApproximateExtent(t);e[0]<i[0]&&(i[0]=e[0]),e[1]>i[1]&&(i[1]=e[1])})}),i[1]<i[0]&&(i=[NaN,NaN]);return function(t,e){var n=t.getAxisModel(),i=n.getMin(!0),o="category"===n.get("type"),a=o&&n.getCategories().length;null!=i&&"dataMin"!==i&&"function"!=typeof i?e[0]=i:o&&(e[0]=0<a?0:NaN);var r=n.getMax(!0);null!=r&&"dataMax"!==r&&"function"!=typeof r?e[1]=r:o&&(e[1]=0<a?a-1:NaN);n.get("scale",!0)||(0<e[0]&&(e[0]=0),e[1]<0&&(e[1]=0))}(t,i),i}(this,this._dimName,e),o=(i=this)._minMaxSpan={},a=i._dataZoomModel,r=i._dataExtent,WA(["min","max"],function(t){var e=a.get(t+"Span"),n=a.get(t+"ValueSpan");null!=n&&(n=i.getAxisModel().axis.scale.parse(n)),null!=n?e=Cl(r[0]+n,r,[0,100],!0):null!=e&&(n=Cl(e,[0,100],r,!0)-r[0]),o[t+"Span"]=e,o[t+"ValueSpan"]=n}),n=this.calculateDataWindow(t.settledOption),this._valueWindow=n.valueWindow,this._percentWindow=n.percentWindow,ZA(this))},restore:function(t){t===this._dataZoomModel&&(this._valueWindow=this._percentWindow=null,ZA(this,!0))},filterData:function(t,e){var i,n,o,c;t===this._dataZoomModel&&(i=this._dimName,n=this.getTargetSeriesModels(),o=t.get("filterMode"),c=this._valueWindow,"none"!==o&&WA(n,function(n){var h=n.getData(),u=h.mapDimension(i,!0);u.length&&("weakFilter"===o?h.filterSelf(function(t){for(var e,n,i,o=0;o<u.length;o++){var a=h.get(u[o],t),r=!isNaN(a),s=a<c[0],l=a>c[1];if(r&&!s&&!l)return!0;r&&(i=!0),s&&(e=!0),l&&(n=!0)}return i&&e&&n}):WA(u,function(t){var e;"empty"===o?n.setData(h=h.map(t,function(t){return(e=t)>=c[0]&&e<=c[1]?t:NaN;var e})):((e={})[t]=c,h.selectRange(e))}),WA(u,function(t){h.setApproximateExtent(c,t)}))}))}};var UA=P,XA=VA,YA=wp({type:"dataZoom",dependencies:["xAxis","yAxis","zAxis","radiusAxis","angleAxis","singleAxis","series"],defaultOption:{zlevel:0,z:4,orient:null,xAxisIndex:null,yAxisIndex:null,filterMode:"filter",throttle:null,start:0,end:100,startValue:null,endValue:null,minSpan:null,maxSpan:null,minValueSpan:null,maxValueSpan:null,rangeMode:null},init:function(t,e,n){this._dataIntervalByAxis={},this._dataInfo={},this._axisProxies={},this.textStyleModel,this._autoThrottle=!0,this._rangePropMode=["percent","percent"];var i=jA(t);this.settledOption=i,this.mergeDefaultAndTheme(t,n),this.doInit(i)},mergeOption:function(t){var e=jA(t);m(this.option,t,!0),m(this.settledOption,e,!0),this.doInit(e)},doInit:function(t){var n=this.option;v.canvasSupported||(n.realtime=!1),this._setDefaultThrottle(t),qA(this,t);var i=this.settledOption;UA([["start","startValue"],["end","endValue"]],function(t,e){"value"===this._rangePropMode[e]&&(n[t[0]]=i[t[0]]=null)},this),this.textStyleModel=this.getModel("textStyle"),this._resetTarget(),this._giveAxisProxies()},_giveAxisProxies:function(){var r=this._axisProxies;this.eachTargetAxis(function(t,e,n,i){var o=this.dependentModels[t.axis][e],a=o.__dzAxisProxy||(o.__dzAxisProxy=new FA(t.name,e,this,i));r[t.name+"_"+e]=a},this)},_resetTarget:function(){var n=this.option,t=this._judgeAutoMode();XA(function(t){var e=t.axisIndex;n[e]=Oo(n[e])},this),"axisIndex"===t?this._autoSetAxisIndex():"orient"===t&&this._autoSetOrient()},_judgeAutoMode:function(){var e=this.option,n=!1;XA(function(t){null!=e[t.axisIndex]&&(n=!0)},this);var t=e.orient;return null==t&&n?"orient":n?void 0:(null==t&&(e.orient="horizontal"),"axisIndex")},_autoSetAxisIndex:function(){var t,a=!0,e=this.get("orient",!0),r=this.option,n=this.dependentModels;a&&(n[(t="vertical"===e?"y":"x")+"Axis"].length?(r[t+"AxisIndex"]=[0],a=!1):UA(n.singleAxis,function(t){a&&t.get("orient",!0)===e&&(r.singleAxisIndex=[t.componentIndex],a=!1)})),a&&XA(function(t){if(a){var e=[],n=this.dependentModels[t.axis];if(n.length&&!e.length)for(var i=0,o=n.length;i<o;i++)"category"===n[i].get("type")&&e.push(i);(r[t.axisIndex]=e).length&&(a=!1)}},this),a&&this.ecModel.eachSeries(function(a){this._isSeriesHasAllAxesTypeOf(a,"value")&&XA(function(t){var e=r[t.axisIndex],n=a.get(t.axisIndex),i=a.get(t.axisId),o=a.ecModel.queryComponents({mainType:t.axis,index:n,id:i})[0];if(D&&!o)throw new Error(t.axis+' "'+Z(n,i,0)+'" not found');M(e,n=o.componentIndex)<0&&e.push(n)})},this)},_autoSetOrient:function(){var e;this.eachTargetAxis(function(t){e=e||t.name},this),this.option.orient="y"===e?"vertical":"horizontal"},_isSeriesHasAllAxesTypeOf:function(i,o){var a=!0;return XA(function(t){var e=i.get(t.axisIndex),n=this.dependentModels[t.axis][e];n&&n.get("type")===o||(a=!1)},this),a},_setDefaultThrottle:function(t){var e;t.hasOwnProperty("throttle")&&(this._autoThrottle=!1),this._autoThrottle&&(e=this.ecModel.option,this.option.throttle=e.animation&&0<e.animationDurationUpdate?100:20)},getFirstTargetAxisModel:function(){var n;return XA(function(t){var e;null!=n||(e=this.get(t.axisIndex)).length&&(n=this.dependentModels[t.axis][e[0]])},this),n},eachTargetAxis:function(n,i){var o=this.ecModel;XA(function(e){UA(this.get(e.axisIndex),function(t){n.call(i,e,t,this,o)},this)},this)},getAxisProxy:function(t,e){return this._axisProxies[t+"_"+e]},getAxisModel:function(t,e){var n=this.getAxisProxy(t,e);return n&&n.getAxisModel()},setRawRange:function(e){var n=this.option,i=this.settledOption;UA([["start","startValue"],["end","endValue"]],function(t){null==e[t[0]]&&null==e[t[1]]||(n[t[0]]=i[t[0]]=e[t[0]],n[t[1]]=i[t[1]]=e[t[1]])},this),qA(this,e)},setCalculatedRange:function(e){var n=this.option;UA(["start","startValue","end","endValue"],function(t){n[t]=e[t]})},getPercentRange:function(){var t=this.findRepresentativeAxisProxy();if(t)return t.getDataPercentWindow()},getValueRange:function(t,e){if(null!=t||null!=e)return this.getAxisProxy(t,e).getDataValueWindow();var n=this.findRepresentativeAxisProxy();return n?n.getDataValueWindow():void 0},findRepresentativeAxisProxy:function(t){if(t)return t.__dzAxisProxy;var e=this._axisProxies;for(var n in e)if(e.hasOwnProperty(n)&&e[n].hostedBy(this))return e[n];for(var n in e)if(e.hasOwnProperty(n)&&!e[n].hostedBy(this))return e[n]},getRangePropMode:function(){return this._rangePropMode.slice()}});function jA(e){var n={};return UA(["start","end","startValue","endValue","throttle"],function(t){e.hasOwnProperty(t)&&(n[t]=e[t])}),n}function qA(t,o){var a=t._rangePropMode,r=t.get("rangeMode");UA([["start","startValue"],["end","endValue"]],function(t,e){var n=null!=o[t[0]],i=null!=o[t[1]];n&&!i?a[e]="percent":!n&&i?a[e]="value":r?a[e]=r[e]:n&&(a[e]="percent")})}var KA=hc.extend({type:"dataZoom",render:function(t,e,n,i){this.dataZoomModel=t,this.ecModel=e,this.api=n},getTargetCoordInfo:function(){var t=this.dataZoomModel,o=this.ecModel,a={};return t.eachTargetAxis(function(t,e){var n,i=o.getComponent(t.axis,e);i&&(n=i.getCoordSysModel())&&function(t,e,n,i){for(var o,a=0;a<n.length;a++)if(n[a].model===t){o=n[a];break}o||n.push(o={model:t,axisModels:[],coordIndex:i});o.axisModels.push(e)}(n,i,a[n.mainType]||(a[n.mainType]=[]),n.componentIndex)},this),a}});YA.extend({type:"dataZoom.select"}),KA.extend({type:"dataZoom.select"}),gp({getTargetSeries:function(t){var i=et();return t.eachComponent("dataZoom",function(t){t.eachTargetAxis(function(t,e,n){P(n.getAxisProxy(t.name,e).getTargetSeriesModels(),function(t){i.set(t.uid,t)})})}),i},modifyOutputEnd:!0,overallReset:function(t,i){t.eachComponent("dataZoom",function(t){t.eachTargetAxis(function(t,e,n){n.getAxisProxy(t.name,e).reset(n,i)}),t.eachTargetAxis(function(t,e,n){n.getAxisProxy(t.name,e).filterData(n,i)})}),t.eachComponent("dataZoom",function(t){var e=t.findRepresentativeAxisProxy(),n=e.getDataPercentWindow(),i=e.getDataValueWindow();t.setCalculatedRange({start:n[0],end:n[1],startValue:i[0],endValue:i[1]})})}}),fp("dataZoom",function(n,t){var i=GA(E(t.eachComponent,t,"dataZoom"),VA,function(t,e){return t.get(e.axisIndex)}),o=[];t.eachComponent({mainType:"dataZoom",query:n},function(t,e){o.push.apply(o,i(t).nodes)}),P(o,function(t,e){t.setRawRange({start:n.start,end:n.end,startValue:n.startValue,endValue:n.endValue})})});var $A=Dc.toolbox.dataZoom,JA=P;function QA(t,e,n){(this._brushController=new _b(n.getZr())).on("brush",E(this._onBrush,this)).mount(),this._isZoomActive}QA.defaultOption={show:!0,filterMode:"filter",icon:{zoom:"M0,13.5h26.9 M13.5,26.9V0 M32.1,13.5H58V58H13.5 V32.1",back:"M22,1.4L9.9,13.5l12.3,12.3 M10.3,13.5H54.9v44.6 H10.3v-26"},title:C($A.title)};var tD=QA.prototype;tD.render=function(t,e,n,i){var o;this.model=t,this.ecModel=e,this.api=n,function(t,e,n,i,o){var a=n._isZoomActive;i&&"takeGlobalCursor"===i.type&&(a="dataZoomSelect"===i.key&&i.dataZoomSelectActive);n._isZoomActive=a,t.setIconStatus("zoom",a?"emphasis":"normal");var r=new xA(nD(t.option),e,{include:["grid"]});n._brushController.setPanels(r.makePanelOpts(o,function(t){return t.xAxisDeclared&&!t.yAxisDeclared?"lineX":!t.xAxisDeclared&&t.yAxisDeclared?"lineY":"rect"})).enableBrush(!!a&&{brushType:"auto",brushStyle:{lineWidth:0,fill:"rgba(0,0,0,0.2)"}})}(t,e,this,i,n),o=e,t.setIconStatus("back",1<function(t){return NA(t).length}(o)?"emphasis":"normal")},tD.onclick=function(t,e,n){eD[n].call(this)},tD.remove=function(t,e){this._brushController.unmount()},tD.dispose=function(t,e){this._brushController.dispose()};var eD={zoom:function(){var t=!this._isZoomActive;this.api.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:t})},back:function(){this._dispatchZoomAction(function(t){var i=NA(t),e=i[i.length-1];1<i.length&&i.pop();var o={};return kA(e,function(t,e){for(var n=i.length-1;0<=n;n--){if(t=i[n][e]){o[e]=t;break}}}),o}(this.ecModel))}};function nD(e){var n={};return P(["xAxisIndex","yAxisIndex"],function(t){n[t]=e[t],null==n[t]&&(n[t]="all"),!1!==n[t]&&"none"!==n[t]||(n[t]=[])}),n}tD._onBrush=function(t,e){var u,c,a,n,r;function o(t,e,n){var i,o,a,r=e.getAxis(t),s=r.model,l=(i=t,o=s,c.eachComponent({mainType:"dataZoom",subType:"select"},function(t){t.getAxisModel(i,o.componentIndex)&&(a=t)}),a),h=l.findRepresentativeAxisProxy(s).getMinMaxSpan();null==h.minValueSpan&&null==h.maxValueSpan||(n=Yw(0,n.slice(),r.scale.getExtent(),0,h.minValueSpan,h.maxValueSpan)),l&&(u[l.id]={dataZoomId:l.id,startValue:n[0],endValue:n[1]})}e.isEnd&&t.length&&(u={},c=this.ecModel,this._brushController.updateCovers([]),new xA(nD(this.model.option),c,{include:["grid"]}).matchOutputRanges(t,c,function(t,e,n){var i;"cartesian2d"===n.type&&("rect"===(i=t.brushType)?(o("x",n,e[0]),o("y",n,e[1])):o({lineX:"x",lineY:"y"}[i],n,e))}),n=u,r=NA(a=c),kA(n,function(t,e){for(var n,i,o=r.length-1;0<=o;o--){if(r[o][e])break}o<0&&((n=a.queryComponents({mainType:"dataZoom",subType:"select",id:e})[0])&&(i=n.getPercentRange(),r[0][e]={dataZoomId:e,start:i[0],end:i[1]}))}),r.push(n),this._dispatchZoomAction(u))},tD._dispatchZoomAction=function(t){var n=[];JA(t,function(t,e){n.push(C(t))}),n.length&&this.api.dispatchAction({type:"dataZoom",from:this.uid,batch:n})},jT("dataZoom",QA),pp(function(s){var l,t,e;function n(i,o){var a,r;o&&(null==(r=o[a=i+"Index"])||"all"===r||R(r)||(r=!1===r||"none"===r?[]:[r]),function(t,e){var n=s[t];R(n)||(n=n?[n]:[]);JA(n,e)}(i,function(t,e){var n;null!=r&&"all"!==r&&-1===M(r,e)||((n={type:"select",$fromToolbox:!0,filterMode:o.filterMode||"filter",id:"\0_ec_\0toolbox-dataZoom_"+i+e})[a]=e,l.push(n))}))}s&&(R(l=s.dataZoom||(s.dataZoom=[]))||(s.dataZoom=l=[l]),(t=s.toolbox)&&(R(t)&&(t=t[0]),t&&t.feature&&(n("xAxis",e=t.feature.dataZoom),n("yAxis",e))))});var iD=Dc.toolbox.restore;function oD(t){this.model=t}oD.defaultOption={show:!0,icon:"M3.8,33.4 M47,18.9h9.8V8.7 M56.3,20.1 C52.1,9,40.5,0.6,26.8,2.1C12.6,3.7,1.6,16.2,2.1,30.6 M13,41.1H3.1v10.2 M3.7,39.9c4.2,11.1,15.8,19.5,29.5,18 c14.2-1.6,25.2-14.1,24.7-28.5",title:iD.title},oD.prototype.onclick=function(t,e,n){t[PA]=null,e.dispatchAction({type:"restore",from:this.uid})},jT("restore",oD),fp({type:"restore",event:"restore",update:"prepareAndUpdate"},function(t,e){e.resetOption("recreate")}),wp({type:"tooltip",dependencies:["axisPointer"],defaultOption:{zlevel:0,z:60,show:!0,showContent:!0,trigger:"item",triggerOn:"mousemove|click",alwaysShowContent:!1,displayMode:"single",renderMode:"auto",confine:!1,showDelay:0,hideDelay:100,transitionDuration:.4,enterable:!1,backgroundColor:"rgba(50,50,50,0.7)",borderColor:"#333",borderRadius:4,borderWidth:0,padding:5,extraCssText:"",axisPointer:{type:"line",axis:"auto",animation:"auto",animationDurationUpdate:200,animationEasingUpdate:"exponentialOut",crossStyle:{color:"#999",width:1,type:"dashed",textStyle:{}}},textStyle:{color:"#fff",fontSize:14}}});var aD=P,rD=ql,sD=["","-webkit-","-moz-","-o-"];function lD(o){var t,e,n,i,a,r,s,l=[],h=o.get("transitionDuration"),u=o.get("backgroundColor"),c=o.getModel("textStyle"),d=o.get("padding");return h&&l.push((n="left "+(t=h)+"s "+(e="cubic-bezier(0.23, 1, 0.32, 1)")+",top "+t+"s "+e,N(sD,function(t){return t+"transition:"+n}).join(";"))),u&&(v.canvasSupported?l.push("background-Color:"+u):(l.push("background-Color:#"+Ge(u)),l.push("filter:alpha(opacity=70)"))),aD(["width","color","radius"],function(t){var e="border-"+t,n=rD(e),i=o.get(n);null!=i&&l.push(e+":"+i+("color"===t?"":"px"))}),l.push((a=[],r=(i=c).get("fontSize"),(s=i.getTextColor())&&a.push("color:"+s),a.push("font:"+i.getFont()),r&&a.push("line-height:"+Math.round(3*r/2)+"px"),aD(["decoration","align"],function(t){var e=i.get(t);e&&a.push("text-"+t+":"+e)}),a.join(";"))),null!=d&&l.push("padding:"+Kl(d).join("px ")+"px"),l.join(";")+";"}function hD(n,t){if(v.wxa)return null;var e=document.createElement("div"),i=this._zr=t.getZr();this.el=e,this._x=t.getWidth()/2,this._y=t.getHeight()/2,n.appendChild(e),this._container=n,this._show=!1,this._hideTimeout;var o=this;e.onmouseenter=function(){o._enterable&&(clearTimeout(o._hideTimeout),o._show=!0),o._inContent=!0},e.onmousemove=function(t){var e;t=t||window.event,o._enterable||(e=i.handler,Gt(n,t,!0),e.dispatch("mousemove",t))},e.onmouseleave=function(){o._enterable&&o._show&&o.hideLater(o._hideDelay),o._inContent=!1}}function uD(t){this._zr=t.getZr(),this._show=!1,this._hideTimeout}hD.prototype={constructor:hD,_enterable:!0,update:function(){var t=this._container,e=t.currentStyle||document.defaultView.getComputedStyle(t),n=t.style;"absolute"!==n.position&&"absolute"!==e.position&&(n.position="relative")},show:function(t){clearTimeout(this._hideTimeout);var e=this.el;e.style.cssText="position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;"+lD(t)+";left:"+this._x+"px;top:"+this._y+"px;"+(t.get("extraCssText")||""),e.style.display=e.innerHTML?"block":"none",e.style.pointerEvents=this._enterable?"auto":"none",this._show=!0},setContent:function(t){this.el.innerHTML=null==t?"":t},setEnterable:function(t){this._enterable=t},getSize:function(){var t=this.el;return[t.clientWidth,t.clientHeight]},moveTo:function(t,e){var n,i=this._zr;i&&i.painter&&(n=i.painter.getViewportRootOffset())&&(t+=n.offsetLeft,e+=n.offsetTop);var o=this.el.style;o.left=t+"px",o.top=e+"px",this._x=t,this._y=e},hide:function(){this.el.style.display="none",this._show=!1},hideLater:function(t){!this._show||this._inContent&&this._enterable||(t?(this._hideDelay=t,this._show=!1,this._hideTimeout=setTimeout(E(this.hide,this),t)):this.hide())},isShow:function(){return this._show},getOuterSize:function(){var t,e=this.el.clientWidth,n=this.el.clientHeight;return document.defaultView&&document.defaultView.getComputedStyle&&((t=document.defaultView.getComputedStyle(this.el))&&(e+=parseInt(t.borderLeftWidth,10)+parseInt(t.borderRightWidth,10),n+=parseInt(t.borderTopWidth,10)+parseInt(t.borderBottomWidth,10))),{width:e,height:n}}},uD.prototype={constructor:uD,_enterable:!0,update:function(){},show:function(t){this._hideTimeout&&clearTimeout(this._hideTimeout),this.el.attr("show",!0),this._show=!0},setContent:function(t,e,n){this.el&&this._zr.remove(this.el);for(var i={},o=t,a="{marker",r=o.indexOf(a);0<=r;){var s=o.indexOf("|}"),l=o.substr(r+a.length,s-r-a.length);-1<l.indexOf("sub")?i["marker"+l]={textWidth:4,textHeight:4,textBorderRadius:2,textBackgroundColor:e[l],textOffset:[3,0]}:i["marker"+l]={textWidth:10,textHeight:10,textBorderRadius:5,textBackgroundColor:e[l]},r=(o=o.substr(s+1)).indexOf("{marker")}this.el=new Gr({style:{rich:i,text:t,textLineHeight:20,textBackgroundColor:n.get("backgroundColor"),textBorderRadius:n.get("borderRadius"),textFill:n.get("textStyle.color"),textPadding:n.get("padding")},z:n.get("z")}),this._zr.add(this.el);var h=this;this.el.on("mouseover",function(){h._enterable&&(clearTimeout(h._hideTimeout),h._show=!0),h._inContent=!0}),this.el.on("mouseout",function(){h._enterable&&h._show&&h.hideLater(h._hideDelay),h._inContent=!1})},setEnterable:function(t){this._enterable=t},getSize:function(){var t=this.el.getBoundingRect();return[t.width,t.height]},moveTo:function(t,e){this.el&&this.el.attr("position",[t,e])},hide:function(){this.el&&this.el.hide(),this._show=!1},hideLater:function(t){!this._show||this._inContent&&this._enterable||(t?(this._hideDelay=t,this._show=!1,this._hideTimeout=setTimeout(E(this.hide,this),t)):this.hide())},isShow:function(){return this._show},getOuterSize:function(){var t=this.getSize();return{width:t[0],height:t[1]}}};var cD=E,dD=P,pD=Ll,gD=new es({shape:{x:-1,y:-1,width:2,height:2}});function fD(t){for(var e=t.pop();t.length;){var n=t.pop();n&&(Sl.isInstance(n)&&(n=n.get("tooltip",!0)),"string"==typeof n&&(n={formatter:n}),e=new Sl(n,e,e.ecModel))}return e}function mD(t,e){return t.dispatchAction||E(e.dispatchAction,e)}function vD(t){return"center"===t||"middle"===t}bp({type:"tooltip",init:function(t,e){var n,i;v.node||(n=t.getComponent("tooltip").get("renderMode"),this._renderMode=jo(n),"html"===this._renderMode?(i=new hD(e.getDom(),e),this._newLine="<br/>"):(i=new uD(e),this._newLine="\n"),this._tooltipContent=i)},render:function(t,e,n){var i;v.node||(this.group.removeAll(),this._tooltipModel=t,this._ecModel=e,this._api=n,this._lastDataByCoordSys=null,this._alwaysShowContent=t.get("alwaysShowContent"),(i=this._tooltipContent).update(),i.setEnterable(t.get("enterable")),this._initGlobalListener(),this._keepShow())},_initGlobalListener:function(){var i=this._tooltipModel.get("triggerOn");oI("itemTooltip",this._api,cD(function(t,e,n){"none"!==i&&(0<=i.indexOf(t)?this._tryShow(e,n):"leave"===t&&this._hide(n))},this))},_keepShow:function(){var t,e=this._tooltipModel,n=this._ecModel,i=this._api;null!=this._lastX&&null!=this._lastY&&"none"!==e.get("triggerOn")&&(t=this,clearTimeout(this._refreshUpdateTimeout),this._refreshUpdateTimeout=setTimeout(function(){i.isDisposed()||t.manuallyShowTip(e,n,i,{x:t._lastX,y:t._lastY})}))},manuallyShowTip:function(t,e,n,i){if(i.from!==this.uid&&!v.node){var o=mD(i,n);this._ticket="";var a=i.dataByCoordSys;if(i.tooltip&&null!=i.x&&null!=i.y){var r=gD;r.position=[i.x,i.y],r.update(),r.tooltip=i.tooltip,this._tryShow({offsetX:i.x,offsetY:i.y,target:r},o)}else if(a)this._tryShow({offsetX:i.x,offsetY:i.y,position:i.position,event:{},dataByCoordSys:i.dataByCoordSys,tooltipOption:i.tooltipOption},o);else if(null!=i.seriesIndex){if(this._manuallyAxisShowTip(t,e,n,i))return;var s=YM(i,e),l=s.point[0],h=s.point[1];null!=l&&null!=h&&this._tryShow({offsetX:l,offsetY:h,position:i.position,target:s.el,event:{}},o)}else null!=i.x&&null!=i.y&&(n.dispatchAction({type:"updateAxisPointer",x:i.x,y:i.y}),this._tryShow({offsetX:i.x,offsetY:i.y,position:i.position,target:n.getZr().findHover(i.x,i.y).target,event:{}},o))}},manuallyHideTip:function(t,e,n,i){var o=this._tooltipContent;!this._alwaysShowContent&&this._tooltipModel&&o.hideLater(this._tooltipModel.get("hideDelay")),this._lastX=this._lastY=null,i.from!==this.uid&&this._hide(mD(i,n))},_manuallyAxisShowTip:function(t,e,n,i){var o=i.seriesIndex,a=i.dataIndex,r=e.getComponent("axisPointer").coordSysAxesInfo;if(null!=o&&null!=a&&null!=r){var s=e.getSeriesByIndex(o);if(s)if("axis"===(t=fD([s.getData().getItemModel(a),s,(s.coordinateSystem||{}).model,t])).get("trigger"))return n.dispatchAction({type:"updateAxisPointer",seriesIndex:o,dataIndex:a,position:i.position}),!0}},_tryShow:function(t,e){var n,i=t.target;this._tooltipModel&&(this._lastX=t.offsetX,this._lastY=t.offsetY,(n=t.dataByCoordSys)&&n.length?this._showAxisTooltip(n,t):i&&null!=i.dataIndex?(this._lastDataByCoordSys=null,this._showSeriesItemTooltip(t,i,e)):i&&i.tooltip?(this._lastDataByCoordSys=null,this._showComponentItemTooltip(t,i,e)):(this._lastDataByCoordSys=null,this._hide(e)))},_showOrMove:function(t,e){var n=t.get("showDelay");e=E(e,this),clearTimeout(this._showTimout),0<n?this._showTimout=setTimeout(e,n):e()},_showAxisTooltip:function(t,e){var d=this._ecModel,n=this._tooltipModel,i=[e.offsetX,e.offsetY],o=[],p=[],a=fD([e.tooltipOption,n]),g=this._renderMode,r=this._newLine,f={};dD(t,function(t){dD(t.dataByAxis,function(s){var l,t,h=d.getComponent(s.axisDim+"Axis",s.axisIndex),u=s.value,c=[];h&&null!=u&&(l=xI(u,h.axis,d,s.seriesDataIndices,s.valueLabelOpt),P(s.seriesDataIndices,function(t){var e,n,i,o=d.getSeriesByIndex(t.seriesIndex),a=t.dataIndexInside,r=o&&o.getDataParams(a);r.axisDim=s.axisDim,r.axisIndex=s.axisIndex,r.axisType=s.axisType,r.axisId=s.axisId,r.axisValue=sf(h.axis,u),r.axisValueLabel=l,r&&(p.push(r),V(e=o.formatTooltip(a,!0,null,g))?(n=e.html,i=e.markers,m(f,i)):n=e,c.push(n))}),t=l,"html"!==g?o.push(c.join(r)):o.push((t?Ql(t)+r:"")+c.join(r)))})},this),o.reverse(),o=o.join(this._newLine+this._newLine);var s=e.position;this._showOrMove(a,function(){this._updateContentNotChangedOnAxis(t)?this._updatePosition(a,s,i[0],i[1],this._tooltipContent,p):this._showTooltipContent(a,o,p,Math.random(),i[0],i[1],s,void 0,f)})},_showSeriesItemTooltip:function(t,e,n){var i,o,a,r,s,l=this._ecModel,h=e.seriesIndex,u=l.getSeriesByIndex(h),c=e.dataModel||u,d=e.dataIndex,p=e.dataType,g=c.getData(),f=fD([g.getItemModel(d),c,u&&(u.coordinateSystem||{}).model,this._tooltipModel]),m=f.get("trigger");null!=m&&"item"!==m||(i=c.getDataParams(d,p),o=c.formatTooltip(d,!1,p,this._renderMode),r=V(o)?(a=o.html,o.markers):(a=o,null),s="item_"+c.name+"_"+d,this._showOrMove(f,function(){this._showTooltipContent(f,a,i,s,t.offsetX,t.offsetY,t.position,t.target,r)}),n({type:"showTip",dataIndexInside:d,dataIndex:g.getRawIndex(d),seriesIndex:h,from:this.uid}))},_showComponentItemTooltip:function(t,e,n){var i=e.tooltip;"string"==typeof i&&(i={content:i,formatter:i});var o=new Sl(i,this._tooltipModel,this._ecModel),a=o.get("content"),r=Math.random();this._showOrMove(o,function(){this._showTooltipContent(o,a,o.get("formatterParams")||{},r,t.offsetX,t.offsetY,t.position,e)}),n({type:"showTip",from:this.uid})},_showTooltipContent:function(n,t,i,e,o,a,r,s,l){var h,u,c,d;this._ticket="",n.get("showContent")&&n.get("show")&&(h=this._tooltipContent,u=n.get("formatter"),r=r||n.get("position"),c=t,u&&"string"==typeof u?c=nh(u,i,!0):"function"==typeof u&&(d=cD(function(t,e){t===this._ticket&&(h.setContent(e,l,n),this._updatePosition(n,r,o,a,h,i,s))},this),this._ticket=e,c=u(i,e,d)),h.setContent(c,l,n),h.show(n),this._updatePosition(n,r,o,a,h,i,s))},_updatePosition:function(t,e,n,i,o,a,r){var s=this._api.getWidth(),l=this._api.getHeight();e=e||t.get("position");var h,u,c,d,p,g,f,m,v,y=o.getSize(),x=t.get("align"),_=t.get("verticalAlign"),w=r&&r.getBoundingRect().clone();r&&w.applyTransform(r.transform),"function"==typeof e&&(e=e([n,i],a,o.el,w,{viewSize:[s,l],contentSize:y.slice()})),R(e)?(n=pD(e[0],s),i=pD(e[1],l)):V(e)?(e.width=y[0],e.height=y[1],n=(h=fh(e,{width:s,height:l})).x,i=h.y,_=x=null):i=(n="string"==typeof e&&r?(u=function(t,e,n){var i=n[0],o=n[1],a=0,r=0,s=e.width,l=e.height;switch(t){case"inside":a=e.x+s/2-i/2,r=e.y+l/2-o/2;break;case"top":a=e.x+s/2-i/2,r=e.y-o-5;break;case"bottom":a=e.x+s/2-i/2,r=e.y+l+5;break;case"left":a=e.x-i-5,r=e.y+l/2-o/2;break;case"right":a=e.x+s+5,r=e.y+l/2-o/2}return[a,r]}(e,w,y))[0]:(u=function(t,e,n,i,o,a,r){var s=n.getOuterSize(),l=s.width,h=s.height;null!=a&&(i<t+l+a?t-=l+a:t+=a);null!=r&&(o<e+h+r?e-=h+r:e+=r);return[t,e]}(n,i,o,s,l,x?null:20,_?null:20))[0],u[1]),x&&(n-=vD(x)?y[0]/2:"right"===x?y[0]:0),_&&(i-=vD(_)?y[1]/2:"bottom"===_?y[1]:0),t.get("confine")&&(n=(u=(c=n,d=i,p=s,g=l,f=o.getOuterSize(),m=f.width,v=f.height,c=Math.min(c+m,p)-m,d=Math.min(d+v,g)-v,c=Math.max(c,0),d=Math.max(d,0),[c,d]))[0],i=u[1]),o.moveTo(n,i)},_updateContentNotChangedOnAxis:function(i){var t=this._lastDataByCoordSys,r=!!t&&t.length===i.length;return r&&dD(t,function(t,e){var n=t.dataByAxis||{},a=(i[e]||{}).dataByAxis||[];(r&=n.length===a.length)&&dD(n,function(t,e){var n=a[e]||{},i=t.seriesDataIndices||[],o=n.seriesDataIndices||[];(r&=t.value===n.value&&t.axisType===n.axisType&&t.axisId===n.axisId&&i.length===o.length)&&dD(i,function(t,e){var n=o[e];r&=t.seriesIndex===n.seriesIndex&&t.dataIndex===n.dataIndex})})}),this._lastDataByCoordSys=i,!!r},_hide:function(t){this._lastDataByCoordSys=null,t({type:"hideTip",from:this.uid})},dispose:function(t,e){v.node||(this._tooltipContent.hide(),sI("itemTooltip",e))}}),fp({type:"showTip",event:"showTip",update:"tooltip:manuallyShowTip"},function(){}),fp({type:"hideTip",event:"hideTip",update:"tooltip:manuallyHideTip"},function(){});var yD=["rect","polygon","keep","clear"];var xD=P;function _D(t){if(t)for(var e in t)if(t.hasOwnProperty(e))return 1}function wD(e,t,a){var n={};return xD(t,function(i){var o=n[i]=(t.prototype.__hidden=t.prototype,new t);function t(){}xD(e[i],function(t,e){var n;u_.isValidType(e)&&(n={type:e,visual:t},a&&a(n,i),o[e]=new u_(n),"opacity"===e&&((n=C(n)).type="colorAlpha",o.__hidden.__alphaForOpacity=new u_(n)))})}),n}function bD(e,n,t){var i;P(t,function(t){n.hasOwnProperty(t)&&_D(n[t])&&(i=!0)}),i&&P(t,function(t){n.hasOwnProperty(t)&&_D(n[t])?e[t]=C(n[t]):delete e[t]})}function SD(t,p,g,f){var m={};return P(t,function(t){var e=u_.prepareVisualTypes(p[t]);m[t]=e}),{progress:function(t,n){function e(t){return n.getItemVisual(o,t)}function i(t,e){n.setItemVisual(o,t,e)}var o;for(null!=f&&(f=n.getDimension(f));null!=(o=t.next());){var a=n.getRawDataItem(o);if(!a||!1!==a.visualMap)for(var r=null!=f?n.get(f,o,!0):o,s=g(r),l=p[s],h=m[s],u=0,c=h.length;u<c;u++){var d=h[u];l[d]&&l[d].applyVisual(r,e,i)}}}}}var MD={lineX:ID(0),lineY:ID(1),rect:{point:function(t,e,n){return t&&n.boundingRect.contain(t[0],t[1])},rect:function(t,e,n){return t&&n.boundingRect.intersect(t)}},polygon:{point:function(t,e,n){return t&&n.boundingRect.contain(t[0],t[1])&&Mf(n.range,t[0],t[1])},rect:function(t,e,n){var i=n.range;if(!t||i.length<=1)return!1;var o=t.x,a=t.y,r=t.width,s=t.height,l=i[0];return!!(Mf(i,o,a)||Mf(i,o+r,a)||Mf(i,o,a+s)||Mf(i,o+r,a+s)||Sn.create(t).contain(l[0],l[1])||gl(o,a,o+r,a,i)||gl(o,a,o,a+s,i)||gl(o+r,a,o+r,a+s,i)||gl(o,a+s,o+r,a+s,i))||void 0}}};function ID(a){var r=["x","y"],s=["width","height"];return{point:function(t,e,n){if(t){var i=n.range;return TD(t[a],i)}},rect:function(t,e,n){if(t){var i=n.range,o=[t[r[a]],t[r[a]]+t[s[a]]];return o[1]<o[0]&&o.reverse(),TD(o[0],i)||TD(o[1],i)||TD(i[0],o)||TD(i[1],o)}}}}function TD(t,e){return e[0]<=t&&t<=e[1]}var AD=["inBrush","outOfBrush"],DD="__ecBrushSelect",CD="__ecInBrushSelectEvent",LD=Id.VISUAL.BRUSH;function kD(t,e){var n;t.isDisposed()||((n=t.getZr())[CD]=!0,t.dispatchAction({type:"brushSelect",batch:e}),n[CD]=!1)}function PD(t,e,n,i){for(var o=0,a=e.length;o<a;o++){var r=e[o];if(t[r.brushType](i,n,r.selectors,r))return 1}}function ND(t){var r=t.brushSelector;if(B(r)){var e=[];return P(MD,function(a,t){e[t]=function(t,e,n,i){var o=e.getItemLayout(t);return a[r](o,n,i)}}),e}if(A(r)){var n={};return P(MD,function(t,e){n[e]=r}),n}return r}vp(LD,function(e,t,n){e.eachComponent({mainType:"brush"},function(t){n&&"takeGlobalCursor"===n.type&&t.setBrushOption("brush"===n.key?n.brushOption:{brushType:!1}),(t.brushTargetManager=new xA(t.option,e)).setInputRanges(t.areas,e)})}),yp(LD,function(h,t,e){var o,a,u=[];h.eachComponent({mainType:"brush"},function(r,t){var l={brushId:r.id,brushIndex:t,brushName:r.name,areas:C(r.areas),selected:[]};u.push(l);var e=r.option,n=e.brushLink,i=[],y=[],x=[],_=0;t||(o=e.throttleType,a=e.throttleDelay);var s=N(r.areas,function(t){return n=L({boundingRect:OD[t.brushType](t)},t),i=n.selectors={},P(MD[n.brushType],function(e,t){i[t]=function(t){return e(t,i,n)}}),n;var n,i}),w=wD(r.option,AD,function(t){t.mappingMethod="fixed"});function b(t){return"all"===n||i[t]}function S(t){return!!t.length}R(n)&&P(n,function(t){i[t]=1}),h.eachSeries(function(t,e){var n,i,o,a=x[e]=[];"parallel"===t.subType?(i=e,o=(n=t).coordinateSystem,_|=o.hasAxisBrushed(),b(i)&&o.eachActiveState(n.getData(),function(t,e){"active"===t&&(y[e]=1)})):function(e,t,n){var i=ND(e);if(!i||function(t,e){var n=t.option.seriesIndex;return null!=n&&"all"!==n&&(R(n)?M(n,e)<0:e!==n)}(r,t))return;{var o;P(s,function(t){i[t.brushType]&&r.brushTargetManager.controlSeries(t,e,h)&&n.push(t),_|=S(n)}),b(t)&&S(n)&&(o=e.getData()).each(function(t){PD(i,n,o,t)&&(y[t]=1)})}}(t,e,a)}),h.eachSeries(function(t,e){var n={seriesId:t.id,seriesIndex:e,seriesName:t.name,dataIndex:[]};l.selected.push(n);var h,u,c,d,p,g,f,i=ND(t),o=x[e],a=t.getData(),r=b(e)?function(t){return y[t]?(n.dataIndex.push(a.getRawIndex(t)),"inBrush"):"outOfBrush"}:function(t){return PD(i,o,a,t)?(n.dataIndex.push(a.getRawIndex(t)),"inBrush"):"outOfBrush"};function m(t){return u.getItemVisual(g,t)}function v(t,e){u.setItemVisual(g,t,e)}function s(t,e){g=null==p?t:e;var n=u.getRawDataItem(g);if(!n||!1!==n.visualMap)for(var i=c.call(d,t),o=h[i],a=f[i],r=0,s=a.length;r<s;r++){var l=a[r];o[l]&&o[l].applyVisual(t,m,v)}}(b(e)?_:S(o))&&(h=w,u=a,c=r,f={},P(AD,function(t){var e=u_.prepareVisualTypes(h[t]);f[t]=e}),null==p?u.each(s):u.each([p],s))})}),function(t,e,n,i,o){if(!o)return;var a=t.getZr();if(a[CD])return;a[DD]||(a[DD]=kD);Ic(a,DD,n,e)(t,i)}(t,o,a,u,e)});var OD={lineX:it,lineY:it,rect:function(t){return ED(t.range)},polygon:function(t){for(var e,n=t.range,i=0,o=n.length;i<o;i++){e=e||[[1/0,-1/0],[1/0,-1/0]];var a=n[i];a[0]<e[0][0]&&(e[0][0]=a[0]),a[0]>e[0][1]&&(e[0][1]=a[0]),a[1]<e[1][0]&&(e[1][0]=a[1]),a[1]>e[1][1]&&(e[1][1]=a[1])}return e&&ED(e)}};function ED(t){return new Sn(t[0][0],t[1][0],t[0][1]-t[0][0],t[1][1]-t[1][0])}var zD=["#ddd"];wp({type:"brush",dependencies:["geo","grid","xAxis","yAxis","parallel","series"],defaultOption:{toolbox:null,brushLink:null,seriesIndex:"all",geoIndex:null,xAxisIndex:null,yAxisIndex:null,brushType:"rect",brushMode:"single",transformable:!0,brushStyle:{borderWidth:1,color:"rgba(120,140,180,0.3)",borderColor:"rgba(120,140,180,0.8)"},throttleType:"fixRate",throttleDelay:0,removeOnClick:!0,z:1e4},areas:[],brushType:null,brushOption:{},coordInfoList:[],optionUpdated:function(t,e){var n=this.option;e||bD(n,t,["inBrush","outOfBrush"]);var i=n.inBrush=n.inBrush||{};n.outOfBrush=n.outOfBrush||{color:zD},i.hasOwnProperty("liftZ")||(i.liftZ=5)},setAreas:function(t){D&&(q(R(t)),P(t,function(t){q(t.brushType,"Illegal areas")})),t&&(this.areas=N(t,function(t){return RD(this.option,t)},this))},setBrushOption:function(t){this.brushOption=RD(this.option,t),this.brushType=this.brushOption.brushType}});function RD(t,e){return m({brushType:t.brushType,brushMode:t.brushMode,transformable:t.transformable,brushStyle:new Sl(t.brushStyle).getItemStyle(),removeOnClick:t.removeOnClick,z:t.z},e,!0)}function BD(t,e,n,i){i&&i.$from===t.id||this._brushController.setPanels(t.brushTargetManager.makePanelOpts(n)).enableBrush(t.brushOption).updateCovers(t.areas.slice())}bp({type:"brush",init:function(t,e){this.ecModel=t,this.api=e,this.model,(this._brushController=new _b(e.getZr())).on("brush",E(this._onBrush,this)).mount()},render:function(t){return this.model=t,BD.apply(this,arguments)},updateTransform:BD,updateView:BD,dispose:function(){this._brushController.dispose()},_onBrush:function(t,e){var n=this.model.id;this.model.brushTargetManager.setOutputRanges(t,this.ecModel),e.isEnd&&!e.removeOnClick||this.api.dispatchAction({type:"brush",brushId:n,areas:C(t),$from:n}),e.isEnd&&this.api.dispatchAction({type:"brushEnd",brushId:n,areas:C(t),$from:n})}}),fp({type:"brush",event:"brush"},function(e,t){t.eachComponent({mainType:"brush",query:e},function(t){t.setAreas(e.areas)})}),fp({type:"brushSelect",event:"brushSelected",update:"none"},function(){}),fp({type:"brushEnd",event:"brushEnd",update:"none"},function(){});var VD=Dc.toolbox.brush;function GD(t,e,n){this.model=t,this.ecModel=e,this.api=n,this._brushType,this._brushMode}GD.defaultOption={show:!0,type:["rect","polygon","lineX","lineY","keep","clear"],icon:{rect:"M7.3,34.7 M0.4,10V-0.2h9.8 M89.6,10V-0.2h-9.8 M0.4,60v10.2h9.8 M89.6,60v10.2h-9.8 M12.3,22.4V10.5h13.1 M33.6,10.5h7.8 M49.1,10.5h7.8 M77.5,22.4V10.5h-13 M12.3,31.1v8.2 M77.7,31.1v8.2 M12.3,47.6v11.9h13.1 M33.6,59.5h7.6 M49.1,59.5 h7.7 M77.5,47.6v11.9h-13",polygon:"M55.2,34.9c1.7,0,3.1,1.4,3.1,3.1s-1.4,3.1-3.1,3.1 s-3.1-1.4-3.1-3.1S53.5,34.9,55.2,34.9z M50.4,51c1.7,0,3.1,1.4,3.1,3.1c0,1.7-1.4,3.1-3.1,3.1c-1.7,0-3.1-1.4-3.1-3.1 C47.3,52.4,48.7,51,50.4,51z M55.6,37.1l1.5-7.8 M60.1,13.5l1.6-8.7l-7.8,4 M59,19l-1,5.3 M24,16.1l6.4,4.9l6.4-3.3 M48.5,11.6 l-5.9,3.1 M19.1,12.8L9.7,5.1l1.1,7.7 M13.4,29.8l1,7.3l6.6,1.6 M11.6,18.4l1,6.1 M32.8,41.9 M26.6,40.4 M27.3,40.2l6.1,1.6 M49.9,52.1l-5.6-7.6l-4.9-1.2",lineX:"M15.2,30 M19.7,15.6V1.9H29 M34.8,1.9H40.4 M55.3,15.6V1.9H45.9 M19.7,44.4V58.1H29 M34.8,58.1H40.4 M55.3,44.4 V58.1H45.9 M12.5,20.3l-9.4,9.6l9.6,9.8 M3.1,29.9h16.5 M62.5,20.3l9.4,9.6L62.3,39.7 M71.9,29.9H55.4",lineY:"M38.8,7.7 M52.7,12h13.2v9 M65.9,26.6V32 M52.7,46.3h13.2v-9 M24.9,12H11.8v9 M11.8,26.6V32 M24.9,46.3H11.8v-9 M48.2,5.1l-9.3-9l-9.4,9.2 M38.9-3.9V12 M48.2,53.3l-9.3,9l-9.4-9.2 M38.9,62.3V46.4",keep:"M4,10.5V1h10.3 M20.7,1h6.1 M33,1h6.1 M55.4,10.5V1H45.2 M4,17.3v6.6 M55.6,17.3v6.6 M4,30.5V40h10.3 M20.7,40 h6.1 M33,40h6.1 M55.4,30.5V40H45.2 M21,18.9h62.9v48.6H21V18.9z",clear:"M22,14.7l30.9,31 M52.9,14.7L22,45.7 M4.7,16.8V4.2h13.1 M26,4.2h7.8 M41.6,4.2h7.8 M70.3,16.8V4.2H57.2 M4.7,25.9v8.6 M70.3,25.9v8.6 M4.7,43.2v12.6h13.1 M26,55.8h7.8 M41.6,55.8h7.8 M70.3,43.2v12.6H57.2"},title:C(VD.title)};var FD=GD.prototype;FD.render=FD.updateView=function(e,t,n){var i,o,a;t.eachComponent({mainType:"brush"},function(t){i=t.brushType,o=t.brushOption.brushMode||"single",a|=t.areas.length}),this._brushType=i,this._brushMode=o,P(e.get("type",!0),function(t){e.setIconStatus(t,("keep"===t?"multiple"===o:"clear"===t?a:t===i)?"emphasis":"normal")})},FD.getIcons=function(){var t=this.model,e=t.get("icon",!0),n={};return P(t.get("type",!0),function(t){e[t]&&(n[t]=e[t])}),n},FD.onclick=function(t,e,n){var i=this._brushType,o=this._brushMode;"clear"===n?(e.dispatchAction({type:"axisAreaSelect",intervals:[]}),e.dispatchAction({type:"brush",command:"clear",areas:[]})):e.dispatchAction({type:"takeGlobalCursor",key:"brush",brushOption:{brushType:"keep"===n?i:i!==n&&n,brushMode:"keep"===n?"multiple"===o?"single":"multiple":o}})},jT("brush",GD),pp(function(t,e){var n,i,o,a,r,s,l,h=t&&t.brush;R(h)||(h=h?[h]:[]),h.length&&(n=[],P(h,function(t){var e=t.hasOwnProperty("toolbox")?t.toolbox:[];e instanceof Array&&(n=n.concat(e))}),R(i=t&&t.toolbox)&&(i=i[0]),i||(i={feature:{}},t.toolbox=[i]),(r=(a=(o=i.feature||(i.feature={})).brush||(o.brush={})).type||(a.type=[])).push.apply(r,n),l={},P(s=r,function(t){l[t]=1}),s.length=0,P(l,function(t,e){s.push(e)}),e&&!r.length&&r.push.apply(r,yD))}),wp({type:"title",layoutMode:{type:"box",ignoreSize:!0},defaultOption:{zlevel:0,z:6,show:!0,text:"",target:"blank",subtext:"",subtarget:"blank",left:0,top:0,backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:5,itemGap:10,textStyle:{fontSize:18,fontWeight:"bolder",color:"#333"},subtextStyle:{color:"#aaa"}}}),bp({type:"title",render:function(t,e,n){var i,o,a,r,s,l,h,u,c,d,p,g,f,m,v,y,x,_,w;this.group.removeAll(),t.get("show")&&(i=this.group,o=t.getModel("textStyle"),a=t.getModel("subtextStyle"),r=t.get("textAlign"),s=U(t.get("textBaseline"),t.get("textVerticalAlign")),h=(l=new Gr({style:Js({},o,{text:t.get("text"),textFill:o.getTextColor()},{disableBox:!0}),z2:10})).getBoundingRect(),u=t.get("subtext"),c=new Gr({style:Js({},a,{text:u,textFill:a.getTextColor(),y:h.height+t.get("itemGap"),textVerticalAlign:"top"},{disableBox:!0}),z2:10}),d=t.get("link"),p=t.get("sublink"),g=t.get("triggerEvent",!0),l.silent=!d&&!g,c.silent=!p&&!g,d&&l.on("click",function(){window.open(d,"_"+t.get("target"))}),p&&c.on("click",function(){window.open(p,"_"+t.get("subtarget"))}),l.eventData=c.eventData=g?{componentType:"title",componentIndex:t.componentIndex}:null,i.add(l),u&&i.add(c),f=i.getBoundingRect(),(m=t.getBoxLayoutParams()).width=f.width,m.height=f.height,v=fh(m,{width:n.getWidth(),height:n.getHeight()},t.get("padding")),r||("middle"===(r=t.get("left")||t.get("right"))&&(r="center"),"right"===r?v.x+=v.width:"center"===r&&(v.x+=v.width/2)),s||("center"===(s=t.get("top")||t.get("bottom"))&&(s="middle"),"bottom"===s?v.y+=v.height:"middle"===s&&(v.y+=v.height/2),s=s||"top"),i.attr("position",[v.x,v.y]),y={textAlign:r,textVerticalAlign:s},l.setStyle(y),c.setStyle(y),f=i.getBoundingRect(),x=v.margin,(_=t.getItemStyle(["color","opacity"])).fill=t.get("backgroundColor"),w=new es({shape:{x:f.x-x[3],y:f.y-x[0],width:f.width+x[1]+x[3],height:f.height+x[0]+x[2],r:t.get("borderRadius")},style:_,subPixelOptimize:!0,silent:!0}),i.add(w))}});function WD(t){var e=t.itemStyle||(t.itemStyle={}),n=e.emphasis||(e.emphasis={}),i=t.label||t.label||{},o=i.normal||(i.normal={}),a={normal:1,emphasis:1};P(i,function(t,e){a[e]||HD(o,e)||(o[e]=t)}),n.label&&!HD(i,"emphasis")&&(i.emphasis=n.label,delete n.label)}function HD(t,e){return t.hasOwnProperty(e)}Mh.registerSubTypeDefaulter("timeline",function(){return"slider"}),fp({type:"timelineChange",event:"timelineChanged",update:"prepareAndUpdate"},function(t,e){var n=e.getComponent("timeline");return n&&null!=t.currentIndex&&(n.setCurrentIndex(t.currentIndex),!n.get("loop",!0)&&n.isIndexMax()&&n.setPlayState(!1)),e.resetOption("timeline"),L({currentIndex:n.option.currentIndex},t)}),fp({type:"timelinePlayChange",event:"timelinePlayChanged",update:"update"},function(t,e){var n=e.getComponent("timeline");n&&null!=t.playState&&n.setPlayState(t.playState)});var ZD=Mh.extend({type:"timeline",layoutMode:"box",defaultOption:{zlevel:0,z:4,show:!0,axisType:"time",realtime:!0,left:"20%",top:null,right:"20%",bottom:0,width:null,height:40,padding:5,controlPosition:"left",autoPlay:!1,rewind:!1,loop:!0,playInterval:2e3,currentIndex:0,itemStyle:{},label:{color:"#000"},data:[]},init:function(t,e,n){this._data,this._names,this.mergeDefaultAndTheme(t,n),this._initData()},mergeOption:function(t){ZD.superApply(this,"mergeOption",arguments),this._initData()},setCurrentIndex:function(t){null==t&&(t=this.option.currentIndex);var e=this._data.count();this.option.loop?t=(t%e+e)%e:(e<=t&&(t=e-1),t<0&&(t=0)),this.option.currentIndex=t},getCurrentIndex:function(){return this.option.currentIndex},isIndexMax:function(){return this.getCurrentIndex()>=this._data.count()-1},setPlayState:function(t){this.option.autoPlay=!!t},getPlayState:function(){return!!this.option.autoPlay},_initData:function(){var o,t=this.option,e=t.data||[],n=t.axisType,a=this._names=[];"category"===n&&(o=[],P(e,function(t,e){var n,i=Ro(t);V(t)?(n=C(t)).value=e:n=e,o.push(n),B(i)||null!=i&&!isNaN(i)||(i=""),a.push(i+"")}),e=o);var i={category:"ordinal",time:"time"}[n]||"number";(this._data=new Hp([{name:"value",type:i}],this)).initData(e,a)},getData:function(){return this._data},getCategories:function(){if("category"===this.get("axisType"))return this._names.slice()}});b(ZD.extend({type:"timeline.slider",defaultOption:{backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,orient:"horizontal",inverse:!1,tooltip:{trigger:"item"},symbol:"emptyCircle",symbolSize:10,lineStyle:{show:!0,width:2,color:"#304654"},label:{position:"auto",show:!0,interval:"auto",rotate:0,color:"#304654"},itemStyle:{color:"#304654",borderWidth:1},checkpointStyle:{symbol:"circle",symbolSize:13,color:"#c23531",borderWidth:5,borderColor:"rgba(194,53,49, 0.5)",animation:!0,animationDuration:300,animationEasing:"quinticInOut"},controlStyle:{show:!0,showPlayBtn:!0,showPrevBtn:!0,showNextBtn:!0,itemSize:22,itemGap:12,position:"left",playIcon:"path://M31.6,53C17.5,53,6,41.5,6,27.4S17.5,1.8,31.6,1.8C45.7,1.8,57.2,13.3,57.2,27.4S45.7,53,31.6,53z M31.6,3.3 C18.4,3.3,7.5,14.1,7.5,27.4c0,13.3,10.8,24.1,24.1,24.1C44.9,51.5,55.7,40.7,55.7,27.4C55.7,14.1,44.9,3.3,31.6,3.3z M24.9,21.3 c0-2.2,1.6-3.1,3.5-2l10.5,6.1c1.899,1.1,1.899,2.9,0,4l-10.5,6.1c-1.9,1.1-3.5,0.2-3.5-2V21.3z",stopIcon:"path://M30.9,53.2C16.8,53.2,5.3,41.7,5.3,27.6S16.8,2,30.9,2C45,2,56.4,13.5,56.4,27.6S45,53.2,30.9,53.2z M30.9,3.5C17.6,3.5,6.8,14.4,6.8,27.6c0,13.3,10.8,24.1,24.101,24.1C44.2,51.7,55,40.9,55,27.6C54.9,14.4,44.1,3.5,30.9,3.5z M36.9,35.8c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H36c0.5,0,0.9,0.4,0.9,1V35.8z M27.8,35.8 c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H27c0.5,0,0.9,0.4,0.9,1L27.8,35.8L27.8,35.8z",nextIcon:"path://M18.6,50.8l22.5-22.5c0.2-0.2,0.3-0.4,0.3-0.7c0-0.3-0.1-0.5-0.3-0.7L18.7,4.4c-0.1-0.1-0.2-0.3-0.2-0.5 c0-0.4,0.3-0.8,0.8-0.8c0.2,0,0.5,0.1,0.6,0.3l23.5,23.5l0,0c0.2,0.2,0.3,0.4,0.3,0.7c0,0.3-0.1,0.5-0.3,0.7l-0.1,0.1L19.7,52 c-0.1,0.1-0.3,0.2-0.5,0.2c-0.4,0-0.8-0.3-0.8-0.8C18.4,51.2,18.5,51,18.6,50.8z",prevIcon:"path://M43,52.8L20.4,30.3c-0.2-0.2-0.3-0.4-0.3-0.7c0-0.3,0.1-0.5,0.3-0.7L42.9,6.4c0.1-0.1,0.2-0.3,0.2-0.5 c0-0.4-0.3-0.8-0.8-0.8c-0.2,0-0.5,0.1-0.6,0.3L18.3,28.8l0,0c-0.2,0.2-0.3,0.4-0.3,0.7c0,0.3,0.1,0.5,0.3,0.7l0.1,0.1L41.9,54 c0.1,0.1,0.3,0.2,0.5,0.2c0.4,0,0.8-0.3,0.8-0.8C43.2,53.2,43.1,53,43,52.8z",color:"#304654",borderColor:"#304654",borderWidth:1},emphasis:{label:{show:!0,color:"#c23531"},itemStyle:{color:"#c23531"},controlStyle:{color:"#c23531",borderColor:"#c23531",borderWidth:2}},data:[]}}),Gu);function UD(t,e,n,i){Bf.call(this,t,e,n),this.type=i||"value",this.model=null}var XD=hc.extend({type:"timeline"});UD.prototype={constructor:UD,getLabelModel:function(){return this.model.getModel("label")},isHorizontal:function(){return"horizontal"===this.model.get("orient")}},w(UD,Bf);var YD=E,jD=P,qD=Math.PI;function KD(t,e,n,i,o,a){var r=e.get("color");o?(o.setColor(r),n.add(o),a&&a.onUpdate(o)):((o=xf(t.get("symbol"),-1,-1,2,2,r)).setStyle("strokeNoScale",!0),n.add(o),a&&a.onCreate(o));var s=e.getItemStyle(["color","symbol","symbolSize"]);o.setStyle(s),i=m({rectHover:!0,z2:100},i,!0);var l=t.get("symbolSize");(l=l instanceof Array?l.slice():[+l,+l])[0]/=2,l[1]/=2,i.scale=l;var h,u=t.get("symbolOffset");u&&((h=i.position=i.position||[0,0])[0]+=Ll(u[0],l[0]),h[1]+=Ll(u[1],l[1]));var c=t.get("symbolRotate");return i.rotation=(c||0)*Math.PI/180||0,o.attr(i),o.updateTransform(),o}function $D(t,e,n,i,o){var a,r;t.dragging||(a=i.getModel("checkpointStyle"),r=n.dataToCoord(i.getData().get(["value"],e)),o||!a.get("animation",!0)?t.attr({position:[r,0]}):(t.stopAnimation(!0),t.animateTo({position:[r,0]},a.get("animationDuration",!0),a.get("animationEasing",!0))))}XD.extend({type:"timeline.slider",init:function(t,e){this.api=e,this._axis,this._viewRect,this._timer,this._currentPointer,this._mainGroup,this._labelGroup},render:function(e,t,n,i){var o,a,r,s;this.model=e,this.api=n,this.ecModel=t,this.group.removeAll(),e.get("show",!0)&&(o=this._layout(e,n),a=this._createGroup("mainGroup"),r=this._createGroup("labelGroup"),s=this._axis=this._createAxis(o,e),e.formatTooltip=function(t){return Ql(s.scale.getLabel(t))},jD(["AxisLine","AxisTick","Control","CurrentPointer"],function(t){this["_render"+t](o,a,s,e)},this),this._renderAxisLabel(o,r,s,e),this._position(o,e)),this._doPlayStop()},remove:function(){this._clearTimer(),this.group.removeAll()},dispose:function(){this._clearTimer()},_layout:function(t,e){var n,i,o=t.get("label.position"),a=t.get("orient"),r=(i=e,fh((n=t).getBoxLayoutParams(),{width:i.getWidth(),height:i.getHeight()},n.get("padding")));null==o||"auto"===o?o="horizontal"===a?r.y+r.height/2<e.getHeight()/2?"-":"+":r.x+r.width/2<e.getWidth()/2?"+":"-":isNaN(o)&&(o={horizontal:{top:"-",bottom:"+"},vertical:{left:"-",right:"+"}}[a][o]);var s,l,h,u,c={horizontal:"center",vertical:0<=o||"+"===o?"left":"right"},d={horizontal:0<=o||"+"===o?"top":"bottom",vertical:"middle"},p={horizontal:0,vertical:qD/2},g="vertical"===a?r.height:r.width,f=t.getModel("controlStyle"),m=f.get("show",!0),v=m?f.get("itemSize"):0,y=m?f.get("itemGap"):0,x=v+y,_=(_=t.get("label.rotate")||0)*qD/180,w=f.get("position",!0),b=m&&f.get("showPlayBtn",!0),S=m&&f.get("showPrevBtn",!0),M=m&&f.get("showNextBtn",!0),I=0,T=g;return"left"===w||"bottom"===w?(b&&(s=[0,0],I+=x),S&&(l=[I,0],I+=x)):(b&&(s=[T-v,0],T-=x),S&&(l=[0,0],I+=x)),M&&(h=[T-v,0],T-=x),u=[I,T],t.get("inverse")&&u.reverse(),{viewRect:r,mainLength:g,orient:a,rotation:p[a],labelRotation:_,labelPosOpt:o,labelAlign:t.get("label.align")||c[a],labelBaseline:t.get("label.verticalAlign")||t.get("label.baseline")||d[a],playPosition:s,prevBtnPosition:l,nextBtnPosition:h,axisExtent:u,controlSize:v,controlGap:y}},_position:function(t,e){var n,i,o,a=this._mainGroup,r=this._labelGroup,s=t.viewRect;"vertical"===t.orient&&(ae(n=ee(),n,[-(i=s.x),-(o=s.y+s.height)]),re(n,n,-qD/2),ae(n,n,[i,o]),(s=s.clone()).applyTransform(n));var l=m(s),h=m(a.getBoundingRect()),u=m(r.getBoundingRect()),c=a.position,d=r.position;d[0]=c[0]=l[0][0];var p,g=t.labelPosOpt;function f(t){var e=t.position;t.origin=[l[0][0]-e[0],l[1][0]-e[1]]}function m(t){return[[t.x,t.x+t.width],[t.y,t.y+t.height]]}function v(t,e,n,i,o){t[i]+=n[i][o]-e[i][o]}isNaN(g)?(v(c,h,l,1,p="+"===g?0:1),v(d,u,l,1,1-p)):(v(c,h,l,1,p=0<=g?0:1),d[1]=c[1]+g),a.attr("position",c),r.attr("position",d),a.rotation=r.rotation=t.rotation,f(a),f(r)},_createAxis:function(t,e){var n=e.getData(),i=e.get("axisType"),o=af(e,i);o.getTicks=function(){return n.mapArray(["value"],function(t){return t})};var a=n.getDataExtent("value");o.setExtent(a[0],a[1]),o.niceTicks();var r=new UD("value",o,t.axisExtent,i);return r.model=e,r},_createGroup:function(t){var e=this["_"+t]=new Mn;return this.group.add(e),e},_renderAxisLine:function(t,e,n,i){var o=n.getExtent();i.get("lineStyle.show")&&e.add(new is({shape:{x1:o[0],y1:0,x2:o[1],y2:0},style:k({lineCap:"round"},i.getModel("lineStyle").getLineStyle()),silent:!0,z2:1}))},_renderAxisTick:function(t,s,l,h){var u=h.getData(),e=l.scale.getTicks();jD(e,function(t){var e=l.dataToCoord(t),n=u.getItemModel(t),i=n.getModel("itemStyle"),o=n.getModel("emphasis.itemStyle"),a={position:[e,0],onclick:YD(this._changeTimeline,this,t)},r=KD(n,i,s,a);Xs(r,o.getItemStyle()),n.get("tooltip")?(r.dataIndex=t,r.dataModel=h):r.dataIndex=r.dataModel=null},this)},_renderAxisLabel:function(s,l,h,t){var u,e;h.getLabelModel().get("show")&&(u=t.getData(),e=h.getViewLabels(),jD(e,function(t){var e=t.tickValue,n=u.getItemModel(e),i=n.getModel("label"),o=n.getModel("emphasis.label"),a=h.dataToCoord(t.tickValue),r=new Gr({position:[a,0],rotation:s.labelRotation-s.rotation,onclick:YD(this._changeTimeline,this,e),silent:!1});Js(r.style,i,{text:t.formattedLabel,textAlign:s.labelAlign,textVerticalAlign:s.labelBaseline}),l.add(r),Xs(r,Js({},o))},this))},_renderControl:function(t,l,e,h){var u=t.controlSize,c=t.rotation,d=h.getModel("controlStyle").getItemStyle(),p=h.getModel("emphasis.controlStyle").getItemStyle(),g=[0,-u/2,u,u],n=h.getPlayState(),i=h.get("inverse",!0);function o(t,e,n,i){var o,a,r,s;t&&(a=e,r=g,s={position:t,origin:[u/2,0],rotation:i?-c:0,rectHover:!0,style:d,onclick:n},o=As(h.get(a).replace(/^path:\/\//,""),C(s||{}),new Sn(r[0],r[1],r[2],r[3]),"center"),l.add(o),Xs(o,p))}o(t.nextBtnPosition,"controlStyle.nextIcon",YD(this._changeTimeline,this,i?"-":"+")),o(t.prevBtnPosition,"controlStyle.prevIcon",YD(this._changeTimeline,this,i?"+":"-")),o(t.playPosition,"controlStyle."+(n?"stopIcon":"playIcon"),YD(this._handlePlayClick,this,!n),!0)},_renderCurrentPointer:function(t,e,n,i){var o=i.getData(),a=i.getCurrentIndex(),r=o.getItemModel(a).getModel("checkpointStyle"),s=this,l={onCreate:function(t){t.draggable=!0,t.drift=YD(s._handlePointerDrag,s),t.ondragend=YD(s._handlePointerDragend,s),$D(t,a,n,i,!0)},onUpdate:function(t){$D(t,a,n,i)}};this._currentPointer=KD(r,r,this._mainGroup,{},this._currentPointer,l)},_handlePlayClick:function(t){this._clearTimer(),this.api.dispatchAction({type:"timelinePlayChange",playState:t,from:this.uid})},_handlePointerDrag:function(t,e,n){this._clearTimer(),this._pointerChangeTimeline([n.offsetX,n.offsetY])},_handlePointerDragend:function(t){this._pointerChangeTimeline([t.offsetX,t.offsetY],!0)},_pointerChangeTimeline:function(t,e){var n=this._toAxisCoord(t)[0],i=Pl(this._axis.getExtent().slice());n>i[1]&&(n=i[1]),n<i[0]&&(n=i[0]),this._currentPointer.position[0]=n,this._currentPointer.dirty();var o=this._findNearestTick(n),a=this.model;(e||o!==a.getCurrentIndex()&&a.get("realtime"))&&this._changeTimeline(o)},_doPlayStop:function(){this._clearTimer(),this.model.getPlayState()&&(this._timer=setTimeout(YD(function(){var t=this.model;this._changeTimeline(t.getCurrentIndex()+(t.get("rewind",!0)?-1:1))},this),this.model.get("playInterval")))},_toAxisCoord:function(t){return hl(t,this._mainGroup.getLocalTransform(),!0)},_findNearestTick:function(o){var a,t=this.model.getData(),r=1/0,s=this._axis;return t.each(["value"],function(t,e){var n=s.dataToCoord(t),i=Math.abs(n-o);i<r&&(r=i,a=e)}),a},_clearTimer:function(){this._timer&&(clearTimeout(this._timer),this._timer=null)},_changeTimeline:function(t){var e=this.model.getCurrentIndex();"+"===t?t=e+1:"-"===t&&(t=e-1),this.api.dispatchAction({type:"timelineChange",currentIndex:t,from:this.uid})}}),pp(function(t){var e=t&&t.timeline;R(e)||(e=e?[e]:[]),P(e,function(t){t&&function(t){var e=t.type,n={number:"value",time:"time"};n[e]&&(t.axisType=n[e],delete t.type);{var i;WD(t),HD(t,"controlPosition")&&(HD(i=t.controlStyle||(t.controlStyle={}),"position")||(i.position=t.controlPosition),"none"!==i.position||HD(i,"show")||(i.show=!1,delete i.position),delete t.controlPosition)}P(t.data||[],function(t){V(t)&&!R(t)&&(!HD(t,"value")&&HD(t,"name")&&(t.value=t.name),WD(t))})}(t)})});var JD=jl,QD=Ql;function tC(t){Eo(t,"label",["show"])}var eC=wp({type:"marker",dependencies:["series","grid","polar","geo"],init:function(t,e,n){if(D&&"marker"===this.type)throw new Error("Marker component is abstract component. Use markLine, markPoint, markArea instead.");this.mergeDefaultAndTheme(t,n),this._mergeOption(t,n,!1,!0)},isAnimationEnabled:function(){if(v.node)return!1;var t=this.__hostSeries;return this.getShallow("animation")&&t&&t.isAnimationEnabled()},mergeOption:function(t,e){this._mergeOption(t,e,!1,!1)},_mergeOption:function(t,i,e,o){var a=this.constructor,r=this.mainType+"Model";e||i.eachSeries(function(t){var e=t.get(this.mainType,!0),n=t[r];e&&e.data?(n?n._mergeOption(e,i,!0):(o&&tC(e),P(e.data,function(t){t instanceof Array?(tC(t[0]),tC(t[1])):tC(t)}),k(n=new a(e,this,i),{mainType:this.mainType,seriesIndex:t.seriesIndex,name:t.name,createdBySelf:!0}),n.__hostSeries=t),t[r]=n):t[r]=null},this)},formatTooltip:function(t){var e=this.getData(),n=this.getRawValue(t),i=R(n)?N(n,JD).join(", "):JD(n),o=e.getName(t),a=QD(this.name);return null==n&&!o||(a+="<br />"),o&&(a+=QD(o),null!=n&&(a+=" : ")),null!=n&&(a+=QD(i)),a},getData:function(){return this._data},setData:function(t){this._data=t}});b(eC,Gu),eC.extend({type:"markPoint",defaultOption:{zlevel:0,z:5,symbol:"pin",symbolSize:50,tooltip:{trigger:"item"},label:{show:!0,position:"inside"},itemStyle:{borderWidth:2},emphasis:{label:{show:!0}}}});var nC=M;function iC(t,e,n,i,o,a){var r=[],s=ug(e,i)?e.getCalculationInfo("stackResultDimension"):i,l=uC(e,s,t),h=e.indicesOfNearest(s,l)[0];r[o]=e.get(n,h),r[a]=e.get(i,h);var u=Nl(e.get(i,h));return 0<=(u=Math.min(u,20))&&(r[a]=+r[a].toFixed(u)),r}var oC=z,aC={min:oC(iC,"min"),max:oC(iC,"max"),average:oC(iC,"average")};function rC(t,e){var n,i=t.getData(),o=t.coordinateSystem;if(e&&(n=e,isNaN(parseFloat(n.x))||isNaN(parseFloat(n.y)))&&!R(e.coord)&&o){var a=o.dimensions,r=sC(e,i,o,t);if((e=C(e)).type&&aC[e.type]&&r.baseAxis&&r.valueAxis){var s=nC(a,r.baseAxis.dim),l=nC(a,r.valueAxis.dim);e.coord=aC[e.type](i,r.baseDataDim,r.valueDataDim,s,l),e.value=e.coord[l]}else{for(var h=[null!=e.xAxis?e.xAxis:e.radiusAxis,null!=e.yAxis?e.yAxis:e.angleAxis],u=0;u<2;u++)aC[h[u]]&&(h[u]=uC(i,i.mapDimension(a[u]),h[u]));e.coord=h}}return e}function sC(t,e,n,i){var o={};return null!=t.valueIndex||null!=t.valueDim?(o.valueDataDim=null!=t.valueIndex?e.getDimension(t.valueIndex):t.valueDim,o.valueAxis=n.getAxis(function(t,e){var n=t.getData(),i=n.dimensions;e=n.getDimension(e);for(var o=0;o<i.length;o++){var a=n.getDimensionInfo(i[o]);if(a.name===e)return a.coordDim}}(i,o.valueDataDim)),o.baseAxis=n.getOtherAxis(o.valueAxis),o.baseDataDim=e.mapDimension(o.baseAxis.dim)):(o.baseAxis=i.getBaseAxis(),o.valueAxis=n.getOtherAxis(o.baseAxis),o.baseDataDim=e.mapDimension(o.baseAxis.dim),o.valueDataDim=e.mapDimension(o.valueAxis.dim)),o}function lC(t,e){return!(t&&t.containData&&e.coord&&(n=e,isNaN(parseFloat(n.x))&&isNaN(parseFloat(n.y))))||t.containData(e.coord);var n}function hC(t,e,n,i){return i<2?t.coord&&t.coord[i]:t.value}function uC(t,e,n){if("average"!==n)return"median"===n?t.getMedian(e):t.getDataExtent(e,!0)["max"===n?1:0];var i=0,o=0;return t.each(e,function(t,e){isNaN(t)||(i+=t,o++)}),i/o}var cC=bp({type:"marker",init:function(){this.markerGroupMap=et()},render:function(t,n,i){var e=this.markerGroupMap;e.each(function(t){t.__keep=!1});var o=this.type+"Model";n.eachSeries(function(t){var e=t[o];e&&this.renderSeries(t,e,n,i)},this),e.each(function(t){t.__keep||this.group.remove(t.group)},this)},renderSeries:function(){}});function dC(s,l,h){var u=l.coordinateSystem;s.each(function(t){var e,n,i,o=s.getItemModel(t),a=Ll(o.get("x"),h.getWidth()),r=Ll(o.get("y"),h.getHeight());isNaN(a)||isNaN(r)?l.getMarkerPosition?i=l.getMarkerPosition(s.getValues(s.dimensions,t)):u&&(e=s.get(u.dimensions[0],t),n=s.get(u.dimensions[1],t),i=u.dataToPoint([e,n])):i=[a,r],isNaN(a)||(i[0]=a),isNaN(r)||(i[1]=r),s.setItemLayout(t,i)})}cC.extend({type:"markPoint",updateTransform:function(t,e,n){e.eachSeries(function(t){var e=t.markPointModel;e&&(dC(e.getData(),t,n),this.markerGroupMap.get(t.id).updateLayout(e))},this)},renderSeries:function(t,l,e,n){var i=t.coordinateSystem,o=t.id,h=t.getData(),a=this.markerGroupMap,r=a.get(o)||a.set(o,new tm),u=function(t,e,n){var i;i=t?N(t&&t.dimensions,function(t){return L({name:t},e.getData().getDimensionInfo(e.getData().mapDimension(t))||{})}):[{name:"value",type:"float"}];var o=new Hp(i,n),a=N(n.get("data"),z(rC,e));t&&(a=I(a,z(lC,t)));return o.initData(a,null,t?hC:function(t){return t.value}),o}(i,t,l);l.setData(u),dC(l.getData(),t,n),u.each(function(t){var e,n,i=u.getItemModel(t),o=i.getShallow("symbol"),a=i.getShallow("symbolSize"),r=A(o),s=A(a);(r||s)&&(e=l.getRawValue(t),n=l.getDataParams(t),r&&(o=o(e,n)),s&&(a=a(e,n))),u.setItemVisual(t,{symbol:o,symbolSize:a,color:i.get("itemStyle.color")||h.getVisual("color")})}),r.updateData(u),this.group.add(r.group),u.eachItemGraphicEl(function(t){t.traverse(function(t){t.dataModel=l})}),r.__keep=!0,r.group.silent=l.get("silent")||t.get("silent")}}),pp(function(t){t.markPoint=t.markPoint||{}}),eC.extend({type:"markLine",defaultOption:{zlevel:0,z:5,symbol:["circle","arrow"],symbolSize:[8,16],precision:2,tooltip:{trigger:"item"},label:{show:!0,position:"end"},lineStyle:{type:"dashed"},emphasis:{label:{show:!0},lineStyle:{width:3}},animationEasing:"linear"}});function pC(t,e,n,i){var o,a,r,s,l,h,u,c,d=t.getData(),p=i.type;return R(i)||"min"!==p&&"max"!==p&&"average"!==p&&"median"!==p&&null==i.xAxis&&null==i.yAxis||(r=null!=i.yAxis||null!=i.xAxis?(a=e.getAxis(null!=i.yAxis?"y":"x"),Z(i.yAxis,i.xAxis)):(a=(o=sC(i,d,e,t)).valueAxis,uC(d,cg(d,o.valueDataDim),p)),l=1-(s="x"===a.dim?0:1),u={},(h=C(i)).type=null,h.coord=[],u.coord=[],h.coord[l]=-1/0,u.coord[l]=1/0,0<=(c=n.get("precision"))&&"number"==typeof r&&(r=+r.toFixed(Math.min(c,20))),h.coord[s]=u.coord[s]=r,i=[h,u,{type:p,valueIndex:i.valueIndex,value:r}]),(i=[rC(t,i[0]),rC(t,i[1]),k({},i[2])])[2].type=i[2].type||"",m(i[2],i[0]),m(i[2],i[1]),i}function gC(t){return!isNaN(t)&&!isFinite(t)}function fC(t,e,n,i){var o=1-t,a=i.dimensions[t];return gC(e[o])&&gC(n[o])&&e[t]===n[t]&&i.getAxis(a).containData(e[t])}function mC(t,e){if("cartesian2d"===t.type){var n=e[0].coord,i=e[1].coord;if(n&&i&&(fC(1,n,i,t)||fC(0,n,i,t)))return!0}return lC(t,e[0])&&lC(t,e[1])}function vC(t,e,n,i,o){var a,r,s,l,h,u,c=i.coordinateSystem,d=t.getItemModel(e),p=Ll(d.get("x"),o.getWidth()),g=Ll(d.get("y"),o.getHeight());isNaN(p)||isNaN(g)?(s=i.getMarkerPosition?i.getMarkerPosition(t.getValues(t.dimensions,e)):(u=c.dimensions,a=t.get(u[0],e),r=t.get(u[1],e),c.dataToPoint([a,r])),"cartesian2d"===c.type&&(l=c.getAxis("x"),h=c.getAxis("y"),u=c.dimensions,gC(t.get(u[0],e))?s[0]=l.toGlobalCoord(l.getExtent()[n?0:1]):gC(t.get(u[1],e))&&(s[1]=h.toGlobalCoord(h.getExtent()[n?0:1]))),isNaN(p)||(s[0]=p),isNaN(g)||(s[1]=g)):s=[p,g],t.setItemLayout(e,s)}cC.extend({type:"markLine",updateTransform:function(t,e,a){e.eachSeries(function(e){var n,i,o,t=e.markLineModel;t&&(n=t.getData(),i=t.__from,o=t.__to,i.each(function(t){vC(i,t,!0,e,a),vC(o,t,!1,e,a)}),n.each(function(t){n.setItemLayout(t,[i.getItemLayout(t),o.getItemLayout(t)])}),this.markerGroupMap.get(e.id).updateLayout())},this)},renderSeries:function(o,n,t,a){var e=o.coordinateSystem,i=o.id,r=o.getData(),s=this.markerGroupMap,l=s.get(i)||s.set(i,new hw);this.group.add(l.group);var h=function(t,e,n){var i;i=t?N(t&&t.dimensions,function(t){return L({name:t},e.getData().getDimensionInfo(e.getData().mapDimension(t))||{})}):[{name:"value",type:"float"}];var o=new Hp(i,n),a=new Hp(i,n),r=new Hp([],n),s=N(n.get("data"),z(pC,e,t,n));t&&(s=I(s,z(mC,t)));var l=t?hC:function(t){return t.value};return o.initData(N(s,function(t){return t[0]}),null,l),a.initData(N(s,function(t){return t[1]}),null,l),r.initData(N(s,function(t){return t[2]})),r.hasItemOption=!0,{from:o,to:a,line:r}}(e,o,n),u=h.from,c=h.to,d=h.line;n.__from=u,n.__to=c,n.setData(d);var p=n.get("symbol"),g=n.get("symbolSize");function f(t,e,n){var i=t.getItemModel(e);vC(t,e,n,o,a),t.setItemVisual(e,{symbolSize:i.get("symbolSize")||g[n?0:1],symbol:i.get("symbol",!0)||p[n?0:1],color:i.get("itemStyle.color")||r.getVisual("color")})}R(p)||(p=[p,p]),"number"==typeof g&&(g=[g,g]),h.from.each(function(t){f(u,t,!0),f(c,t,!1)}),d.each(function(t){var e=d.getItemModel(t).get("lineStyle.color");d.setItemVisual(t,{color:e||u.getItemVisual(t,"color")}),d.setItemLayout(t,[u.getItemLayout(t),c.getItemLayout(t)]),d.setItemVisual(t,{fromSymbolSize:u.getItemVisual(t,"symbolSize"),fromSymbol:u.getItemVisual(t,"symbol"),toSymbolSize:c.getItemVisual(t,"symbolSize"),toSymbol:c.getItemVisual(t,"symbol")})}),l.updateData(d),h.line.eachItemGraphicEl(function(t,e){t.traverse(function(t){t.dataModel=n})}),l.__keep=!0,l.group.silent=n.get("silent")||o.get("silent")}}),pp(function(t){t.markLine=t.markLine||{}}),eC.extend({type:"markArea",defaultOption:{zlevel:0,z:1,tooltip:{trigger:"item"},animation:!1,label:{show:!0,position:"top"},itemStyle:{borderWidth:0},emphasis:{label:{show:!0,position:"top"}}}});function yC(t,e,n,i){var o=rC(t,i[0]),a=rC(t,i[1]),r=Z,s=o.coord,l=a.coord;s[0]=r(s[0],-1/0),s[1]=r(s[1],-1/0),l[0]=r(l[0],1/0),l[1]=r(l[1],1/0);var h=f([{},o,a]);return h.coord=[o.coord,a.coord],h.x0=o.x,h.y0=o.y,h.x1=a.x,h.y1=a.y,h}function xC(t){return!isNaN(t)&&!isFinite(t)}function _C(t,e,n){var i=1-t;return xC(e[i])&&xC(n[i])}function wC(t,e){var n=e.coord[0],i=e.coord[1];return!("cartesian2d"!==t.type||!n||!i||!_C(1,n,i)&&!_C(0,n,i))||(lC(t,{coord:n,x:e.x0,y:e.y0})||lC(t,{coord:i,x:e.x1,y:e.y1}))}function bC(t,e,n,i,o){var a,r,s,l,h,u,c=i.coordinateSystem,d=t.getItemModel(e),p=Ll(d.get(n[0]),o.getWidth()),g=Ll(d.get(n[1]),o.getHeight());return isNaN(p)||isNaN(g)?(u=i.getMarkerPosition?i.getMarkerPosition(t.getValues(n,e)):(a=[l=t.get(n[0],e),h=t.get(n[1],e)],c.clampData&&c.clampData(a,a),c.dataToPoint(a,!0)),"cartesian2d"===c.type&&(r=c.getAxis("x"),s=c.getAxis("y"),l=t.get(n[0],e),h=t.get(n[1],e),xC(l)?u[0]=r.toGlobalCoord(r.getExtent()["x0"===n[0]?0:1]):xC(h)&&(u[1]=s.toGlobalCoord(s.getExtent()["y0"===n[1]?0:1]))),isNaN(p)||(u[0]=p),isNaN(g)||(u[1]=g)):u=[p,g],u}var SC=[["x0","y0"],["x1","y0"],["x1","y1"],["x0","y1"]];cC.extend({type:"markArea",updateTransform:function(t,e,o){e.eachSeries(function(n){var i,t=n.markAreaModel;t&&(i=t.getData()).each(function(e){var t=N(SC,function(t){return bC(i,e,t,n,o)});i.setItemLayout(e,t),i.getItemGraphicEl(e).setShape("points",t)})},this)},renderSeries:function(n,r,t,i){var e=n.coordinateSystem,o=n.id,a=n.getData(),s=this.markerGroupMap,l=s.get(o)||s.set(o,{group:new Mn});this.group.add(l.group),l.__keep=!0;var h=function(t,n,e){var i,o;o=t?(i=N(t&&t.dimensions,function(t){var e=n.getData();return L({name:t},e.getDimensionInfo(e.mapDimension(t))||{})}),new Hp(N(["x0","y0","x1","y1"],function(t,e){return{name:t,type:i[e%2].type}}),e)):new Hp(i=[{name:"value",type:"float"}],e);var a=N(e.get("data"),z(yC,n,t,e));t&&(a=I(a,z(wC,t)));var r=t?function(t,e,n,i){return t.coord[Math.floor(i/2)][i%2]}:function(t){return t.value};return o.initData(a,null,r),o.hasItemOption=!0,o}(e,n,r);r.setData(h),h.each(function(e){h.setItemLayout(e,N(SC,function(t){return bC(h,e,t,n,i)})),h.setItemVisual(e,{color:a.getVisual("color")})}),h.diff(l.__data).add(function(t){var e=new jr({shape:{points:h.getItemLayout(t)}});h.setItemGraphicEl(t,e),l.group.add(e)}).update(function(t,e){var n=l.__data.getItemGraphicEl(e);rl(n,{shape:{points:h.getItemLayout(t)}},r,t),l.group.add(n),h.setItemGraphicEl(t,n)}).remove(function(t){var e=l.__data.getItemGraphicEl(t);l.group.remove(e)}).execute(),h.eachItemGraphicEl(function(t,e){var n=h.getItemModel(e),i=n.getModel("label"),o=n.getModel("emphasis.label"),a=h.getItemVisual(e,"color");t.useStyle(L(n.getModel("itemStyle").getItemStyle(),{fill:Ze(a,.4),stroke:a})),t.hoverStyle=n.getModel("emphasis.itemStyle").getItemStyle(),Ks(t.style,t.hoverStyle,i,o,{labelFetcher:r,labelDataIndex:e,defaultText:h.getName(e)||"",isRectText:!0,autoColor:a}),Xs(t,{}),t.dataModel=r}),l.__data=h,l.group.silent=r.get("silent")||n.get("silent")}}),pp(function(t){t.markArea=t.markArea||{}});var MC=Dc.legend.selector,IC={all:{type:"all",title:C(MC.all)},inverse:{type:"inverse",title:C(MC.inverse)}},TC=wp({type:"legend.plain",dependencies:["series"],layoutMode:{type:"box",ignoreSize:!0},init:function(t,e,n){this.mergeDefaultAndTheme(t,n),t.selected=t.selected||{},this._updateSelector(t)},mergeOption:function(t){TC.superCall(this,"mergeOption",t),this._updateSelector(t)},_updateSelector:function(t){var n=t.selector;!0===n&&(n=t.selector=["all","inverse"]),R(n)&&P(n,function(t,e){B(t)&&(t={type:t}),n[e]=m(t,IC[t.type])})},optionUpdated:function(){this._updateData(this.ecModel);var t=this._data;if(t[0]&&"single"===this.get("selectedMode")){for(var e=!1,n=0;n<t.length;n++){var i=t[n].get("name");if(this.isSelected(i)){this.select(i),e=!0;break}}e||this.select(t[0].get("name"))}},_updateData:function(o){var a=[],r=[];o.eachRawSeries(function(t){var e,n,i=t.name;r.push(i),t.legendVisualProvider?(n=t.legendVisualProvider.getAllNames(),o.isSeriesFiltered(t)||(r=r.concat(n)),n.length?a=a.concat(n):e=!0):e=!0,e&&Go(t)&&a.push(t.name)}),this._availableNames=r;var t=N(this.get("data")||a,function(t){return"string"!=typeof t&&"number"!=typeof t||(t={name:t}),new Sl(t,this,this.ecModel)},this);this._data=t},getData:function(){return this._data},select:function(t){var e=this.option.selected;"single"===this.get("selectedMode")&&P(this._data,function(t){e[t.get("name")]=!1}),e[t]=!0},unSelect:function(t){"single"!==this.get("selectedMode")&&(this.option.selected[t]=!1)},toggleSelected:function(t){var e=this.option.selected;e.hasOwnProperty(t)||(e[t]=!0),this[e[t]?"unSelect":"select"](t)},allSelect:function(){var t=this._data,e=this.option.selected;P(t,function(t){e[t.get("name",!0)]=!0})},inverseSelect:function(){var t=this._data,n=this.option.selected;P(t,function(t){var e=t.get("name",!0);n.hasOwnProperty(e)||(n[e]=!0),n[e]=!n[e]})},isSelected:function(t){var e=this.option.selected;return!(e.hasOwnProperty(t)&&!e[t])&&0<=M(this._availableNames,t)},getOrient:function(){return"vertical"===this.get("orient")?{index:1,name:"vertical"}:{index:0,name:"horizontal"}},defaultOption:{zlevel:0,z:4,show:!0,orient:"horizontal",left:"center",top:0,align:"auto",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemGap:10,itemWidth:25,itemHeight:14,inactiveColor:"#ccc",inactiveBorderColor:"#ccc",itemStyle:{borderWidth:0},textStyle:{color:"#333"},selectedMode:!0,selector:!1,selectorLabel:{show:!0,borderRadius:10,padding:[3,5,3,5],fontSize:12,fontFamily:" sans-serif",color:"#666",borderWidth:1,borderColor:"#666"},emphasis:{selectorLabel:{show:!0,color:"#eee",backgroundColor:"#666"}},selectorPosition:"auto",selectorItemGap:7,selectorButtonGap:10,tooltip:{show:!1}}});function AC(t,e,n){var o,a={},r="toggleSelected"===t;return n.eachComponent("legend",function(i){r&&null!=o?i[o?"select":"unSelect"](e.name):"allSelect"===t||"inverseSelect"===t?i[t]():(i[t](e.name),o=i.isSelected(e.name)),P(i.getData(),function(t){var e,n=t.get("name");"\n"!==n&&""!==n&&(e=i.isSelected(n),a.hasOwnProperty(n)?a[n]=a[n]&&e:a[n]=e)})}),"allSelect"===t||"inverseSelect"===t?{selected:a}:{name:e.name,selected:a}}fp("legendToggleSelect","legendselectchanged",z(AC,"toggleSelected")),fp("legendAllSelect","legendselectall",z(AC,"allSelect")),fp("legendInverseSelect","legendinverseselect",z(AC,"inverseSelect")),fp("legendSelect","legendselected",z(AC,"select")),fp("legendUnSelect","legendunselected",z(AC,"unSelect"));var DC=z,CC=P,LC=Mn,kC=bp({type:"legend.plain",newlineDisabled:!1,init:function(){this.group.add(this._contentGroup=new LC),this._backgroundEl,this.group.add(this._selectorGroup=new LC),this._isFirstRender=!0},getContentGroup:function(){return this._contentGroup},getSelectorGroup:function(){return this._selectorGroup},render:function(t,e,n){var i,o,a,r,s,l,h,u,c,d,p=this._isFirstRender;this._isFirstRender=!1,this.resetInner(),t.get("show",!0)&&(i=t.get("align"),o=t.get("orient"),i&&"auto"!==i||(i="right"===t.get("left")&&"vertical"===o?"right":"left"),a=t.get("selector",!0),r=t.get("selectorPosition",!0),!a||r&&"auto"!==r||(r="horizontal"===o?"end":"start"),this.renderInner(i,t,e,n,a,o,r),u=fh(s=t.getBoxLayoutParams(),l={width:n.getWidth(),height:n.getHeight()},h=t.get("padding")),d=fh(L({width:(c=this.layoutInner(t,i,u,p,a,r)).width,height:c.height},s),l,h),this.group.attr("position",[d.x-c.x,d.y-c.y]),this.group.add(this._backgroundEl=$T(c,t)))},resetInner:function(){this.getContentGroup().removeAll(),this._backgroundEl&&this.group.remove(this._backgroundEl),this.getSelectorGroup().removeAll()},renderInner:function(h,u,c,d,t,e,n){var p=this.getContentGroup(),g=et(),f=u.get("selectedMode"),m=[];c.eachRawSeries(function(t){t.get("legendHoverLink")||m.push(t.id)}),CC(u.getData(),function(a,r){var t,e,n,i,o,s,l=a.get("name");this.newlineDisabled||""!==l&&"\n"!==l?(t=c.getSeriesByName(l)[0],g.get(l)||(t?(n=(e=t.getData()).getVisual("color"),i=e.getVisual("borderColor"),"function"==typeof n&&(n=n(t.getDataParams(0))),"function"==typeof i&&(i=i(t.getDataParams(0))),o=e.getVisual("legendSymbol")||"roundRect",s=e.getVisual("symbol"),this._createItem(l,r,a,u,o,s,h,n,i,f).on("click",DC(NC,l,null,d,m)).on("mouseover",DC(OC,t.name,null,d,m)).on("mouseout",DC(EC,t.name,null,d,m)),g.set(l,!0)):c.eachRawSeries(function(t){if(!g.get(l)&&t.legendVisualProvider){var e=t.legendVisualProvider;if(!e.containName(l))return;var n=e.indexOfName(l),i=e.getItemVisual(n,"color"),o=e.getItemVisual(n,"borderColor");this._createItem(l,r,a,u,"roundRect",null,h,i,o,f).on("click",DC(NC,null,l,d,m)).on("mouseover",DC(OC,null,l,d,m)).on("mouseout",DC(EC,null,l,d,m)),g.set(l,!0)}},this),D&&(g.get(l)||console.warn(l+" series not exists. Legend data should be same with series name or data name.")))):p.add(new LC({newline:!0}))},this),t&&this._createSelector(t,u,d,e,n)},_createSelector:function(t,a,r,e,n){var s=this.getSelectorGroup();CC(t,function(t){!function(t){var e=t.type,n=new Gr({style:{x:0,y:0,align:"center",verticalAlign:"middle"},onclick:function(){r.dispatchAction({type:"all"===e?"legendAllSelect":"legendInverseSelect"})}});s.add(n);var i=a.getModel("selectorLabel"),o=a.getModel("emphasis.selectorLabel");Ks(n.style,n.hoverStyle={},i,o,{defaultText:t.title,isRectText:!1}),Xs(n)}(t)})},_createItem:function(t,e,n,i,o,a,r,s,l,h){var u,c,d=i.get("itemWidth"),p=i.get("itemHeight"),g=i.get("inactiveColor"),f=i.get("inactiveBorderColor"),m=i.get("symbolKeepAspect"),v=i.getModel("itemStyle"),y=i.isSelected(t),x=new LC,_=n.getModel("textStyle"),w=n.get("icon"),b=n.getModel("tooltip"),S=b.parentModel,M=xf(o=w||o,0,0,d,p,y?s:g,null==m||m);x.add(PC(M,o,v,l,f,y)),w||!a||a===o&&"none"!==a||("none"===a&&(a="circle"),c=xf(a,(d-(u=.8*p))/2,(p-u)/2,u,u,y?s:g,null==m||m),x.add(PC(c,a,v,l,f,y)));var I="left"===r?d+5:-5,T=r,A=i.get("formatter"),D=t;"string"==typeof A&&A?D=A.replace("{name}",null!=t?t:""):"function"==typeof A&&(D=A(t)),x.add(new Gr({style:Js({},_,{text:D,x:I,y:p/2,textFill:y?_.getTextColor():g,textAlign:T,textVerticalAlign:"middle"})}));var C=new es({shape:x.getBoundingRect(),invisible:!0,tooltip:b.get("show")?k({content:t,formatter:S.get("formatter",!0)||function(){return t},formatterParams:{componentType:"legend",legendIndex:i.componentIndex,name:t,$vars:["name"]}},b.option):null});return x.add(C),x.eachChild(function(t){t.silent=!0}),C.silent=!h,this.getContentGroup().add(x),Xs(x),x.__legendDataIndex=e,x},layoutInner:function(t,e,n,i,o,a){var r=this.getContentGroup(),s=this.getSelectorGroup();gh(t.get("orient"),r,t.get("itemGap"),n.width,n.height);var l=r.getBoundingRect(),h=[-l.x,-l.y];if(o){gh("horizontal",s,t.get("selectorItemGap",!0));var u=s.getBoundingRect(),c=[-u.x,-u.y],d=t.get("selectorButtonGap",!0),p=t.getOrient().index,g=0===p?"width":"height",f=0===p?"height":"width",m=0===p?"y":"x";"end"===a?c[p]+=l[g]+d:h[p]+=u[g]+d,c[1-p]+=l[f]/2-u[f]/2,s.attr("position",c),r.attr("position",h);var v={x:0,y:0};return v[g]=l[g]+d+u[g],v[f]=Math.max(l[f],u[f]),v[m]=Math.min(0,u[m]+c[1-p]),v}return r.attr("position",h),this.group.getBoundingRect()},remove:function(){this.getContentGroup().removeAll(),this._isFirstRender=!0}});function PC(t,e,n,i,o,a){var r;return"line"!==e&&e.indexOf("empty")<0?(r=n.getItemStyle(),t.style.stroke=i,a||(r.stroke=o)):r=n.getItemStyle(["borderWidth","borderColor"]),t.setStyle(r)}function NC(t,e,n,i){EC(t,e,n,i),n.dispatchAction({type:"legendToggleSelect",name:null!=t?t:e}),OC(t,e,n,i)}function OC(t,e,n,i){var o=n.getZr().storage.getDisplayList()[0];o&&o.useHoverLayer||n.dispatchAction({type:"highlight",seriesName:t,name:e,excludeSeriesId:i})}function EC(t,e,n,i){var o=n.getZr().storage.getDisplayList()[0];o&&o.useHoverLayer||n.dispatchAction({type:"downplay",seriesName:t,name:e,excludeSeriesId:i})}gp(Id.PROCESSOR.SERIES_FILTER,function(t){var n=t.findComponents({mainType:"legend"});n&&n.length&&t.filterSeries(function(t){for(var e=0;e<n.length;e++)if(!n[e].isSelected(t.name))return!1;return!0})}),Mh.registerSubTypeDefaulter("legend",function(){return"plain"});var zC=TC.extend({type:"legend.scroll",setScrollDataIndex:function(t){this.option.scrollDataIndex=t},defaultOption:{scrollDataIndex:0,pageButtonItemGap:5,pageButtonGap:null,pageButtonPosition:"end",pageFormatter:"{current}/{total}",pageIcons:{horizontal:["M0,0L12,-10L12,10z","M0,0L-12,-10L-12,10z"],vertical:["M0,0L20,0L10,-20z","M0,0L20,0L10,20z"]},pageIconColor:"#2f4554",pageIconInactiveColor:"#aaa",pageIconSize:15,pageTextStyle:{color:"#333"},animationDurationUpdate:800},init:function(t,e,n,i){var o=yh(t);zC.superCall(this,"init",t,e,n,i),RC(this,t,o)},mergeOption:function(t,e){zC.superCall(this,"mergeOption",t,e),RC(this,this.option,t)}});function RC(t,e,n){var i=[1,1];i[t.getOrient().index]=0,vh(e,n,{type:"box",ignoreSize:i})}var BC=Mn,VC=["width","height"],GC=["x","y"],FC=kC.extend({type:"legend.scroll",newlineDisabled:!0,init:function(){FC.superCall(this,"init"),this._currentIndex=0,this.group.add(this._containerGroup=new BC),this._containerGroup.add(this.getContentGroup()),this.group.add(this._controllerGroup=new BC),this._showController},resetInner:function(){FC.superCall(this,"resetInner"),this._controllerGroup.removeAll(),this._containerGroup.removeClipPath(),this._containerGroup.__rectSize=null},renderInner:function(t,o,e,a,n,i,r){var s=this;FC.superCall(this,"renderInner",t,o,e,a,n,i,r);var l=this._controllerGroup,h=o.get("pageIconSize",!0);R(h)||(h=[h,h]),c("pagePrev",0);var u=o.getModel("pageTextStyle");function c(t,e){var n=t+"DataIndex",i=pl(o.get("pageIcons",!0)[o.getOrient().name][e],{onclick:E(s._pageGo,s,n,o,a)},{x:-h[0]/2,y:-h[1]/2,width:h[0],height:h[1]});i.name=t,l.add(i)}l.add(new Gr({name:"pageText",style:{textFill:u.getTextColor(),font:u.getFont(),textVerticalAlign:"middle",textAlign:"center"},silent:!0})),c("pageNext",1)},layoutInner:function(t,e,n,i,o,a){var r=this.getSelectorGroup(),s=t.getOrient().index,l=VC[s],h=GC[s],u=VC[1-s],c=GC[1-s];o&&gh("horizontal",r,t.get("selectorItemGap",!0));var d=t.get("selectorButtonGap",!0),p=r.getBoundingRect(),g=[-p.x,-p.y],f=C(n);o&&(f[l]=n[l]-p[l]-d);var m,v=this._layoutContentAndController(t,i,f,s,l,u,c);return o&&("end"===a?g[s]+=v[l]+d:(m=p[l]+d,g[s]-=m,v[h]-=m),v[l]+=p[l]+d,g[1-s]+=v[c]+v[u]/2-p[u]/2,v[u]=Math.max(v[u],p[u]),v[c]=Math.min(v[c],p[c]+g[1-s]),r.attr("position",g)),v},_layoutContentAndController:function(t,e,n,i,o,a,r){var s=this.getContentGroup(),l=this._containerGroup,h=this._controllerGroup;gh(t.get("orient"),s,t.get("itemGap"),i?n.width:null,i?null:n.height),gh("horizontal",h,t.get("pageButtonItemGap",!0));var u=s.getBoundingRect(),c=h.getBoundingRect(),d=this._showController=u[o]>n[o],p=[-u.x,-u.y];e||(p[i]=s.position[i]);var g=[0,0],f=[-c.x,-c.y],m=U(t.get("pageButtonGap",!0),t.get("itemGap",!0));d&&("end"===t.get("pageButtonPosition",!0)?f[i]+=n[o]-c[o]:g[i]+=c[o]+m),f[1-i]+=u[a]/2-c[a]/2,s.attr("position",p),l.attr("position",g),h.attr("position",f);var v,y={x:0,y:0};y[o]=d?n[o]:u[o],y[a]=Math.max(u[a],c[a]),y[r]=Math.min(0,c[r]+f[1-i]),l.__rectSize=n[o],d?((v={x:0,y:0})[o]=Math.max(n[o]-c[o]-m,0),v[a]=y[a],l.setClipPath(new es({shape:v})),l.__rectSize=v[o]):h.eachChild(function(t){t.attr({invisible:!0,silent:!0})});var x=this._getPageInfo(t);return null!=x.pageIndex&&rl(s,{position:x.contentPosition},d&&t),this._updatePageInfoView(t,x),y},_pageGo:function(t,e,n){var i=this._getPageInfo(e)[t];null!=i&&n.dispatchAction({type:"legendScroll",scrollDataIndex:i,legendId:e.id})},_updatePageInfoView:function(i,o){var a=this._controllerGroup;P(["pagePrev","pageNext"],function(t){var e=null!=o[t+"DataIndex"],n=a.childOfName(t);n&&(n.setStyle("fill",e?i.get("pageIconColor",!0):i.get("pageIconInactiveColor",!0)),n.cursor=e?"pointer":"default")});var t=a.childOfName("pageText"),e=i.get("pageFormatter"),n=o.pageIndex,r=null!=n?n+1:0,s=o.pageCount;t&&e&&t.setStyle("text",B(e)?e.replace("{current}",r).replace("{total}",s):e({current:r,total:s}))},_getPageInfo:function(t){var e=t.get("scrollDataIndex",!0),n=this.getContentGroup(),i=this._containerGroup.__rectSize,o=t.getOrient().index,a=VC[o],r=GC[o],s=this._findTargetItemIndex(e),l=n.children(),h=l[s],u=l.length,c=u?1:0,d={contentPosition:n.position.slice(),pageCount:c,pageIndex:c-1,pagePrevDataIndex:null,pageNextDataIndex:null};if(!h)return d;var p=y(h);d.contentPosition[o]=-p.s;for(var g=s+1,f=p,m=p,v=null;g<=u;++g)(!(v=y(l[g]))&&m.e>f.s+i||v&&!x(v,f.s))&&(f=m.i>f.i?m:v)&&(null==d.pageNextDataIndex&&(d.pageNextDataIndex=f.i),++d.pageCount),m=v;for(g=s-1,f=p,m=p,v=null;-1<=g;--g)(v=y(l[g]))&&x(m,v.s)||!(f.i<m.i)||(m=f,null==d.pagePrevDataIndex&&(d.pagePrevDataIndex=f.i),++d.pageCount,++d.pageIndex),f=v;return d;function y(t){if(t){var e=t.getBoundingRect(),n=e[r]+t.position[o];return{s:n,e:n+e[a],i:t.__legendDataIndex}}}function x(t,e){return t.e>=e&&t.s<=e+i}},_findTargetItemIndex:function(i){var o,a,t=this.getContentGroup();return this._showController&&t.eachChild(function(t,e){var n=t.__legendDataIndex;null==a&&null!=n&&(a=e),n===i&&(o=e)}),null!=o?o:a}});fp("legendScroll","legendscroll",function(t,e){var n=t.scrollDataIndex;null!=n&&e.eachComponent({mainType:"legend",subType:"scroll",query:t},function(t){t.setScrollDataIndex(n)})});YA.extend({type:"dataZoom.slider",layoutMode:"box",defaultOption:{show:!0,right:"ph",top:"ph",width:"ph",height:"ph",left:null,bottom:null,backgroundColor:"rgba(47,69,84,0)",dataBackground:{lineStyle:{color:"#2f4554",width:.5,opacity:.3},areaStyle:{color:"rgba(47,69,84,0.3)",opacity:.3}},borderColor:"#ddd",fillerColor:"rgba(167,183,204,0.4)",handleIcon:"M8.2,13.6V3.9H6.3v9.7H3.1v14.9h3.3v9.7h1.8v-9.7h3.3V13.6H8.2z M9.7,24.4H4.8v-1.4h4.9V24.4z M9.7,19.1H4.8v-1.4h4.9V19.1z",handleSize:"100%",handleStyle:{color:"#a7b7cc"},labelPrecision:null,labelFormatter:null,showDetail:!0,showDataShadow:"auto",realtime:!0,zoomLock:!1,textStyle:{color:"#333"}}});var WC=es,HC=Cl,ZC=Pl,UC=E,XC=P,YC="horizontal",jC="vertical",qC=["line","bar","candlestick","scatter"],KC=KA.extend({type:"dataZoom.slider",init:function(t,e){this._displayables={},this._orient,this._range,this._handleEnds,this._size,this._handleWidth,this._handleHeight,this._location,this._dragging,this._dataShadowInfo,this.api=e},render:function(t,e,n,i){KC.superApply(this,"render",arguments),Ic(this,"_dispatchZoomAction",this.dataZoomModel.get("throttle"),"fixRate"),this._orient=t.get("orient"),!1!==this.dataZoomModel.get("show")?(i&&"dataZoom"===i.type&&i.from===this.uid||this._buildView(),this._updateView()):this.group.removeAll()},remove:function(){KC.superApply(this,"remove",arguments),Tc(this,"_dispatchZoomAction")},dispose:function(){KC.superApply(this,"dispose",arguments),Tc(this,"_dispatchZoomAction")},_buildView:function(){var t=this.group;t.removeAll(),this._resetLocation(),this._resetInterval();var e=this._displayables.barGroup=new Mn;this._renderBackground(),this._renderHandle(),this._renderDataShadow(),t.add(e),this._positionGroup()},_resetLocation:function(){var t=this.dataZoomModel,e=this.api,n=this._findCoordRect(),i={width:e.getWidth(),height:e.getHeight()},o=this._orient===YC?{right:i.width-n.x-n.width,top:i.height-30-7,width:n.width,height:30}:{right:7,top:n.y,width:30,height:n.height},a=yh(t.option);P(["right","top","width","height"],function(t){"ph"===a[t]&&(a[t]=o[t])});var r=fh(a,i,t.padding);this._location={x:r.x,y:r.y},this._size=[r.width,r.height],this._orient===jC&&this._size.reverse()},_positionGroup:function(){var t=this.group,e=this._location,n=this._orient,i=this.dataZoomModel.getFirstTargetAxisModel(),o=i&&i.get("inverse"),a=this._displayables.barGroup,r=(this._dataShadowInfo||{}).otherAxisInverse;a.attr(n!==YC||o?n===YC&&o?{scale:r?[-1,1]:[-1,-1]}:n!==jC||o?{scale:r?[-1,-1]:[-1,1],rotation:Math.PI/2}:{scale:r?[1,-1]:[1,1],rotation:Math.PI/2}:{scale:r?[1,1]:[1,-1]});var s=t.getBoundingRect([a]);t.attr("position",[e.x-s.x,e.y-s.y])},_getViewExtent:function(){return[0,this._size[0]]},_renderBackground:function(){var t=this.dataZoomModel,e=this._size,n=this._displayables.barGroup;n.add(new WC({silent:!0,shape:{x:0,y:0,width:e[0],height:e[1]},style:{fill:t.get("backgroundColor")},z2:-40})),n.add(new WC({shape:{x:0,y:0,width:e[0],height:e[1]},style:{fill:"transparent"},z2:0,onclick:E(this._onClickPanelClick,this)}))},_renderDataShadow:function(){var t,e,n,i,o,a,r,s,l,h,u,c,d,p,g,f=this._dataShadowInfo=this._prepareDataShadowInfo();f&&(t=this._size,n=(e=f.series).getRawData(),null!=(i=e.getShadowDim?e.getShadowDim():f.otherDim)&&(o=.3*((a=n.getDataExtent(i))[1]-a[0]),a=[a[0]-o,a[1]+o],r=[0,t[1]],s=[0,t[0]],l=[[t[0],0],[0,0]],h=[],u=s[1]/(n.count()-1),c=0,d=Math.round(n.count()/t[0]),n.each([i],function(t,e){var n,i;0<d&&e%d?c+=u:(i=(n=null==t||isNaN(t)||""===t)?0:HC(t,a,r,!0),n&&!p&&e?(l.push([l[l.length-1][0],0]),h.push([h[h.length-1][0],0])):!n&&p&&(l.push([c,0]),h.push([c,0])),l.push([c,i]),h.push([c,i]),c+=u,p=n)}),g=this.dataZoomModel,this._displayables.barGroup.add(new jr({shape:{points:l},style:L({fill:g.get("dataBackgroundColor")},g.getModel("dataBackground.areaStyle").getAreaStyle()),silent:!0,z2:-20})),this._displayables.barGroup.add(new qr({shape:{points:h},style:g.getModel("dataBackground.lineStyle").getLineStyle(),silent:!0,z2:-19}))))},_prepareDataShadowInfo:function(){var t=this.dataZoomModel,s=t.get("showDataShadow");if(!1!==s){var l,h=this.ecModel;return t.eachTargetAxis(function(a,r){P(t.getAxisProxy(a.name,r).getTargetSeriesModels(),function(t){var e,n,i,o;l||!0!==s&&M(qC,t.get("type"))<0||(e=h.getComponent(a.axis,r).axis,n={x:"y",y:"x",radius:"angle",angle:"radius"}[a.name],o=t.coordinateSystem,null!=n&&o.getOtherAxis&&(i=o.getOtherAxis(e).inverse),n=t.getData().mapDimension(n),l={thisAxis:e,series:t,thisDim:a.name,otherDim:n,otherAxisInverse:i})},this)},this),l}},_renderHandle:function(){var t=this._displayables,a=t.handles=[],r=t.handleLabels=[],s=this._displayables.barGroup,e=this._size,l=this.dataZoomModel;s.add(t.filler=new WC({draggable:!0,cursor:$C(this._orient),drift:UC(this._onDragMove,this,"all"),ondragstart:UC(this._showDataInfo,this,!0),ondragend:UC(this._onDragEnd,this),onmouseover:UC(this._showDataInfo,this,!0),onmouseout:UC(this._showDataInfo,this,!1),style:{fill:l.get("fillerColor"),textPosition:"inside"}})),s.add(new WC({silent:!0,subPixelOptimize:!0,shape:{x:0,y:0,width:e[0],height:e[1]},style:{stroke:l.get("dataBackgroundColor")||l.get("borderColor"),lineWidth:1,fill:"rgba(0,0,0,0)"}})),XC([0,1],function(t){var e=pl(l.get("handleIcon"),{cursor:$C(this._orient),draggable:!0,drift:UC(this._onDragMove,this,t),ondragend:UC(this._onDragEnd,this),onmouseover:UC(this._showDataInfo,this,!0),onmouseout:UC(this._showDataInfo,this,!1)},{x:-1,y:0,width:2,height:2}),n=e.getBoundingRect();this._handleHeight=Ll(l.get("handleSize"),this._size[1]),this._handleWidth=n.width/n.height*this._handleHeight,e.setStyle(l.getModel("handleStyle").getItemStyle());var i=l.get("handleColor");null!=i&&(e.style.fill=i),s.add(a[t]=e);var o=l.textStyleModel;this.group.add(r[t]=new Gr({silent:!0,invisible:!0,style:{x:0,y:0,text:"",textVerticalAlign:"middle",textAlign:"center",textFill:o.getTextColor(),textFont:o.getFont()},z2:10}))},this)},_resetInterval:function(){var t=this._range=this.dataZoomModel.getPercentRange(),e=this._getViewExtent();this._handleEnds=[HC(t[0],[0,100],e,!0),HC(t[1],[0,100],e,!0)]},_updateInterval:function(t,e){var n=this.dataZoomModel,i=this._handleEnds,o=this._getViewExtent(),a=n.findRepresentativeAxisProxy().getMinMaxSpan(),r=[0,100];Yw(e,i,o,n.get("zoomLock")?"all":t,null!=a.minSpan?HC(a.minSpan,r,o,!0):null,null!=a.maxSpan?HC(a.maxSpan,r,o,!0):null);var s=this._range,l=this._range=ZC([HC(i[0],o,r,!0),HC(i[1],o,r,!0)]);return!s||s[0]!==l[0]||s[1]!==l[1]},_updateView:function(t){var i=this._displayables,o=this._handleEnds,e=ZC(o.slice()),a=this._size;XC([0,1],function(t){var e=i.handles[t],n=this._handleHeight;e.attr({scale:[n/2,n/2],position:[o[t],a[1]/2-n/2]})},this),i.filler.setShape({x:e[0],y:0,width:e[1]-e[0],height:a[1]}),this._updateDataInfo(t)},_updateDataInfo:function(t){var e,n,i,o,a=this.dataZoomModel,r=this._displayables,s=r.handleLabels,l=this._orient,h=["",""];!a.get("showDetail")||(e=a.findRepresentativeAxisProxy())&&(n=e.getAxisModel().axis,i=this._range,o=t?e.calculateDataWindow({start:i[0],end:i[1]}).valueWindow:e.getDataValueWindow(),h=[this._formatLabel(o[0],n),this._formatLabel(o[1],n)]);var u=ZC(this._handleEnds.slice());function c(t){var e=ll(r.handles[t].parent,this.group),n=ul(0===t?"right":"left",e),i=this._handleWidth/2+5,o=hl([u[t]+(0===t?-i:i),this._size[1]/2],e);s[t].setStyle({x:o[0],y:o[1],textVerticalAlign:l===YC?"middle":n,textAlign:l===YC?n:"center",text:h[t]})}c.call(this,0),c.call(this,1)},_formatLabel:function(t,e){var n=this.dataZoomModel,i=n.get("labelFormatter"),o=n.get("labelPrecision");null!=o&&"auto"!==o||(o=e.getPixelPrecision());var a=null==t||isNaN(t)?"":"category"===e.type||"time"===e.type?e.scale.getLabel(Math.round(t)):t.toFixed(Math.min(o,20));return A(i)?i(t,a):B(i)?i.replace("{value}",a):a},_showDataInfo:function(t){t=this._dragging||t;var e=this._displayables.handleLabels;e[0].attr("invisible",!t),e[1].attr("invisible",!t)},_onDragMove:function(t,e,n,i){this._dragging=!0,Wt(i.event);var o=hl([e,n],this._displayables.barGroup.getLocalTransform(),!0),a=this._updateInterval(t,o[0]),r=this.dataZoomModel.get("realtime");this._updateView(!r),a&&r&&this._dispatchZoomAction()},_onDragEnd:function(){this._dragging=!1,this._showDataInfo(!1),this.dataZoomModel.get("realtime")||this._dispatchZoomAction()},_onClickPanelClick:function(t){var e,n,i,o=this._size,a=this._displayables.barGroup.transformCoordToLocal(t.offsetX,t.offsetY);a[0]<0||a[0]>o[0]||a[1]<0||a[1]>o[1]||(n=((e=this._handleEnds)[0]+e[1])/2,i=this._updateInterval("all",a[0]-n),this._updateView(),i&&this._dispatchZoomAction())},_dispatchZoomAction:function(){var t=this._range;this.api.dispatchAction({type:"dataZoom",from:this.uid,dataZoomId:this.dataZoomModel.id,start:t[0],end:t[1]})},_findCoordRect:function(){var t,e,n;return XC(this.getTargetCoordInfo(),function(t){var e;!n&&t.length&&(e=t[0].model.coordinateSystem,n=e.getRect&&e.getRect())}),n||(t=this.api.getWidth(),e=this.api.getHeight(),n={x:.2*t,y:.2*e,width:.6*t,height:.6*e}),n}});function $C(t){return"vertical"===t?"ns-resize":"ew-resize"}YA.extend({type:"dataZoom.inside",defaultOption:{disabled:!1,zoomLock:!1,zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}});var JC="\0_ec_dataZoom_roams";function QC(t,i){var e=eL(t),o=i.dataZoomId,a=i.coordId;P(e,function(t,e){var n=t.dataZoomInfos;n[o]&&M(i.allCoordIds,a)<0&&(delete n[o],t.count--)}),nL(e);var r,n,s=e[a];s||((s=e[a]={coordId:a,dataZoomInfos:{},count:0}).controller=(r=s,n=new Oy(t.getZr()),P(["pan","zoom","scrollMove"],function(a){n.on(a,function(i){var o=[];P(r.dataZoomInfos,function(t){var e,n;i.isAvailableBehavior(t.dataZoomModel.option)&&(n=(e=(t.getRange||{})[a])&&e(r.controller,i),!t.dataZoomModel.get("disabled",!0)&&n&&o.push({dataZoomId:t.dataZoomId,start:n[0],end:n[1]}))}),o.length&&r.dispatchAction(o)})}),n),s.dispatchAction=z(iL,t)),s.dataZoomInfos[o]||s.count++,s.dataZoomInfos[o]=i;var l,h,u,c,d=(l=s.dataZoomInfos,u={type_true:2,type_move:1,type_false:0,type_undefined:-1},c=!0,P(l,function(t){var e=t.dataZoomModel,n=!e.get("disabled",!0)&&(!e.get("zoomLock",!0)||"move");u["type_"+h]<u["type_"+n]&&(h=n),c&=e.get("preventDefaultMouseMove",!0)}),{controlType:h,opt:{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!0,preventDefaultMouseMove:!!c}});s.controller.enable(d.controlType,d.opt),s.controller.setPointerChecker(i.containsPoint),Ic(s,"dispatchAction",i.dataZoomModel.get("throttle",!0),"fixRate")}function tL(t){return t.type+"\0_"+t.id}function eL(t){var e=t.getZr();return e[JC]||(e[JC]={})}function nL(n){P(n,function(t,e){t.count||(t.controller.dispose(),delete n[e])})}function iL(t,e){t.dispatchAction({type:"dataZoom",batch:e})}var oL=E,aL=KA.extend({type:"dataZoom.inside",init:function(t,e){this._range},render:function(r,t,s,e){aL.superApply(this,"render",arguments),this._range=r.getPercentRange(),P(this.getTargetCoordInfo(),function(t,o){var a=N(t,function(t){return tL(t.model)});P(t,function(e){var i=e.model,n={};P(["pan","zoom","scrollMove"],function(t){n[t]=oL(rL[t],this,e,o)},this),QC(s,{coordId:tL(i),allCoordIds:a,containsPoint:function(t,e,n){return i.coordinateSystem.containPoint([e,n])},dataZoomId:r.id,dataZoomModel:r,getRange:n})},this)},this)},dispose:function(){var t,n,e;t=this.api,n=this.dataZoomModel.id,P(e=eL(t),function(t){t.controller.dispose();var e=t.dataZoomInfos;e[n]&&(delete e[n],t.count--)}),nL(e),aL.superApply(this,"dispose",arguments),this._range=null}}),rL={zoom:function(t,e,n,i){var o=this._range,a=o.slice(),r=t.axisModels[0];if(r){var s=hL[e](null,[i.originX,i.originY],r,n,t),l=(0<s.signal?s.pixelStart+s.pixelLength-s.pixel:s.pixel-s.pixelStart)/s.pixelLength*(a[1]-a[0])+a[0],h=Math.max(1/i.scale,0);a[0]=(a[0]-l)*h+l,a[1]=(a[1]-l)*h+l;var u=this.dataZoomModel.findRepresentativeAxisProxy().getMinMaxSpan();return Yw(0,a,[0,100],0,u.minSpan,u.maxSpan),this._range=a,o[0]!==a[0]||o[1]!==a[1]?a:void 0}},pan:sL(function(t,e,n,i,o,a){var r=hL[i]([a.oldX,a.oldY],[a.newX,a.newY],e,o,n);return r.signal*(t[1]-t[0])*r.pixel/r.pixelLength}),scrollMove:sL(function(t,e,n,i,o,a){return hL[i]([0,0],[a.scrollDelta,a.scrollDelta],e,o,n).signal*(t[1]-t[0])*a.scrollDelta})};function sL(l){return function(t,e,n,i){var o=this._range,a=o.slice(),r=t.axisModels[0];if(r){var s=l(a,r,t,e,n,i);return Yw(s,a,[0,100],"all"),this._range=a,o[0]!==a[0]||o[1]!==a[1]?a:void 0}}}function lL(t){var e=t&&t.visualMap;R(e)||(e=e?[e]:[]),uL(e,function(t){var e;t&&(cL(t,"splitList")&&!cL(t,"pieces")&&(t.pieces=t.splitList,delete t.splitList),(e=t.pieces)&&R(e)&&uL(e,function(t){V(t)&&(cL(t,"start")&&!cL(t,"min")&&(t.min=t.start),cL(t,"end")&&!cL(t,"max")&&(t.max=t.end))}))})}var hL={grid:function(t,e,n,i,o){var a=n.axis,r={},s=o.model.coordinateSystem.getRect();return t=t||[0,0],"x"===a.dim?(r.pixel=e[0]-t[0],r.pixelLength=s.width,r.pixelStart=s.x,r.signal=a.inverse?1:-1):(r.pixel=e[1]-t[1],r.pixelLength=s.height,r.pixelStart=s.y,r.signal=a.inverse?-1:1),r},polar:function(t,e,n,i,o){var a=n.axis,r={},s=o.model.coordinateSystem,l=s.getRadiusAxis().getExtent(),h=s.getAngleAxis().getExtent();return t=t?s.pointToCoord(t):[0,0],e=s.pointToCoord(e),"radiusAxis"===n.mainType?(r.pixel=e[0]-t[0],r.pixelLength=l[1]-l[0],r.pixelStart=l[0],r.signal=a.inverse?1:-1):(r.pixel=e[1]-t[1],r.pixelLength=h[1]-h[0],r.pixelStart=h[0],r.signal=a.inverse?-1:1),r},singleAxis:function(t,e,n,i,o){var a=n.axis,r=o.model.coordinateSystem.getRect(),s={};return t=t||[0,0],"horizontal"===a.orient?(s.pixel=e[0]-t[0],s.pixelLength=r.width,s.pixelStart=r.x,s.signal=a.inverse?1:-1):(s.pixel=e[1]-t[1],s.pixelLength=r.height,s.pixelStart=r.y,s.signal=a.inverse?-1:1),s}},uL=P;function cL(t,e){return t&&t.hasOwnProperty&&t.hasOwnProperty(e)}Mh.registerSubTypeDefaulter("visualMap",function(t){return t.categories||(t.pieces?0<t.pieces.length:0<t.splitNumber)&&!t.calculable?"piecewise":"continuous"});var dL=Id.VISUAL.COMPONENT;function pL(t,e,n,i){for(var o=e.targetVisuals[i],a=u_.prepareVisualTypes(o),r={color:t.getData().getVisual("color")},s=0,l=a.length;s<l;s++){var h=a[s],u=o["opacity"===h?"__alphaForOpacity":h];u&&u.applyVisual(n,c,d)}return r.color;function c(t){return r[t]}function d(t,e){r[t]=e}}yp(dL,{createOnAllSeries:!0,reset:function(n,t){var i=[];return t.eachComponent("visualMap",function(t){var e=n.pipelineContext;!t.isTargetSeries(n)||e&&e.large||i.push(SD(t.stateList,t.targetVisuals,E(t.getValueState,t),t.getDataDimension(n.getData())))}),i}}),yp(dL,{createOnAllSeries:!0,reset:function(o,t){var a=o.getData(),r=[];t.eachComponent("visualMap",function(t){var e,n,i;t.isTargetSeries(o)&&(e=t.getVisualMeta(E(pL,null,o,t))||{stops:[],outerColors:[]},n=t.getDataDimension(a),null!=(i=a.getDimensionInfo(n))&&(e.dimension=i.index,r.push(e)))}),o.getData().setVisual("visualMeta",r)}});var gL=function(t,e,n){var i=C((fL[t]||{})[e]);return n&&R(i)?i[i.length-1]:i},fL={color:{active:["#006edd","#e0ffff"],inactive:["rgba(0,0,0,0)"]},colorHue:{active:[0,360],inactive:[0,0]},colorSaturation:{active:[.3,1],inactive:[0,0]},colorLightness:{active:[.9,.5],inactive:[0,0]},colorAlpha:{active:[.3,1],inactive:[0,0]},opacity:{active:[.3,1],inactive:[0,0]},symbol:{active:["circle","roundRect","diamond"],inactive:["none"]},symbolSize:{active:[10,50],inactive:[0,0]}},mL=u_.mapVisual,vL=u_.eachVisual,yL=R,xL=P,_L=Pl,wL=Cl,bL=wp({type:"visualMap",dependencies:["series"],stateList:["inRange","outOfRange"],replacableOptionKeys:["inRange","outOfRange","target","controller","color"],dataBound:[-1/0,1/0],layoutMode:{type:"box",ignoreSize:!0},defaultOption:{show:!0,zlevel:0,z:4,seriesIndex:"all",min:0,max:200,dimension:null,inRange:null,outOfRange:null,left:0,right:null,top:null,bottom:0,itemWidth:null,itemHeight:null,inverse:!1,orient:"vertical",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",contentColor:"#5793f3",inactiveColor:"#aaa",borderWidth:0,padding:5,textGap:10,precision:0,color:null,formatter:null,text:null,textStyle:{color:"#333"}},init:function(t,e,n){this._dataExtent,this.targetVisuals={},this.controllerVisuals={},this.textStyleModel,this.itemSize,this.mergeDefaultAndTheme(t,n)},optionUpdated:function(t,e){var n=this.option;v.canvasSupported||(n.realtime=!1),e||bD(n,t,this.replacableOptionKeys),this.textStyleModel=this.getModel("textStyle"),this.resetItemSize(),this.completeVisualOption()},resetVisual:function(t){var e=this.stateList;t=E(t,this),this.controllerVisuals=wD(this.option.controller,e,t),this.targetVisuals=wD(this.option.target,e,t)},getTargetSeriesIndices:function(){var t=this.option.seriesIndex,n=[];return null==t||"all"===t?this.ecModel.eachSeries(function(t,e){n.push(e)}):n=Oo(t),n},eachTargetSeries:function(e,n){P(this.getTargetSeriesIndices(),function(t){e.call(n,this.ecModel.getSeriesByIndex(t))},this)},isTargetSeries:function(e){var n=!1;return this.eachTargetSeries(function(t){t===e&&(n=!0)}),n},formatValueText:function(t,e,n){var i,o,a=this.option,r=a.precision,s=this.dataBound,l=a.formatter;return n=n||["<",">"],R(t)&&(t=t.slice(),i=!0),o=e?t:i?[h(t[0]),h(t[1])]:h(t),B(l)?l.replace("{value}",i?o[0]:o).replace("{value2}",i?o[1]:o):A(l)?i?l(t[0],t[1]):l(t):i?t[0]===s[0]?n[0]+" "+o[1]:t[1]===s[1]?n[1]+" "+o[0]:o[0]+" - "+o[1]:o;function h(t){return t===s[0]?"min":t===s[1]?"max":(+t).toFixed(Math.min(r,20))}},resetExtent:function(){var t=this.option,e=_L([t.min,t.max]);this._dataExtent=e},getDataDimension:function(t){var e=this.option.dimension,n=t.dimensions;if(null!=e||n.length){if(null!=e)return t.getDimension(e);for(var i=t.dimensions,o=i.length-1;0<=o;o--){var a=i[o];if(!t.getDimensionInfo(a).isCalculationCoord)return a}}},getExtent:function(){return this._dataExtent.slice()},completeVisualOption:function(){var t=this.ecModel,e=this.option,n={inRange:e.inRange,outOfRange:e.outOfRange},i=e.target||(e.target={}),o=e.controller||(e.controller={});m(i,n),m(o,n);var h=this.isCategory();function a(i){yL(e.color)&&!i.inRange&&(i.inRange={color:e.color.slice().reverse()}),i.inRange=i.inRange||{color:t.get("gradientColor")},xL(this.stateList,function(t){var e,n=i[t];B(n)&&((e=gL(n,"active",h))?(i[t]={},i[t][n]=e):delete i[t])},this)}a.call(this,i),a.call(this,o),function(t,e,n){var i=t[e],o=t[n];i&&!o&&(o=t[n]={},xL(i,function(t,e){var n;!u_.isValidType(e)||null!=(n=gL(e,"inactive",h))&&(o[e]=n,"color"!==e||o.hasOwnProperty("opacity")||o.hasOwnProperty("colorAlpha")||(o.opacity=[0,0]))}))}.call(this,i,"inRange","outOfRange"),function(a){var r=(a.inRange||{}).symbol||(a.outOfRange||{}).symbol,s=(a.inRange||{}).symbolSize||(a.outOfRange||{}).symbolSize,l=this.get("inactiveColor");xL(this.stateList,function(t){var e=this.itemSize,n=a[t];null==(n=n||(a[t]={color:h?l:[l]})).symbol&&(n.symbol=r&&C(r)||(h?"roundRect":["roundRect"])),null==n.symbolSize&&(n.symbolSize=s&&C(s)||(h?e[0]:[e[0],e[0]])),n.symbol=mL(n.symbol,function(t){return"none"===t||"square"===t?"roundRect":t});var i,o=n.symbolSize;null!=o&&(i=-1/0,vL(o,function(t){i<t&&(i=t)}),n.symbolSize=mL(o,function(t){return wL(t,[0,i],[0,e[0]],!0)}))},this)}.call(this,o)},resetItemSize:function(){this.itemSize=[parseFloat(this.get("itemWidth")),parseFloat(this.get("itemHeight"))]},isCategory:function(){return!!this.option.categories},setSelected:it,getValueState:it,getVisualMeta:it}),SL=[20,140],ML=bL.extend({type:"visualMap.continuous",defaultOption:{align:"auto",calculable:!1,range:null,realtime:!0,itemHeight:null,itemWidth:null,hoverLink:!0,hoverLinkDataSize:null,hoverLinkOnHandle:null},optionUpdated:function(t,e){ML.superApply(this,"optionUpdated",arguments),this.resetExtent(),this.resetVisual(function(t){t.mappingMethod="linear",t.dataExtent=this.getExtent()}),this._resetRange()},resetItemSize:function(){ML.superApply(this,"resetItemSize",arguments);var t=this.itemSize;"horizontal"===this._orient&&t.reverse(),null!=t[0]&&!isNaN(t[0])||(t[0]=SL[0]),null!=t[1]&&!isNaN(t[1])||(t[1]=SL[1])},_resetRange:function(){var t=this.getExtent(),e=this.option.range;!e||e.auto?(t.auto=1,this.option.range=t):R(e)&&(e[0]>e[1]&&e.reverse(),e[0]=Math.max(e[0],t[0]),e[1]=Math.min(e[1],t[1]))},completeVisualOption:function(){bL.prototype.completeVisualOption.apply(this,arguments),P(this.stateList,function(t){var e=this.option.controller[t].symbolSize;e&&e[0]!==e[1]&&(e[0]=0)},this)},setSelected:function(t){this.option.range=t.slice(),this._resetRange()},getSelected:function(){var t=this.getExtent(),e=Pl((this.get("range")||[]).slice());return e[0]>t[1]&&(e[0]=t[1]),e[1]>t[1]&&(e[1]=t[1]),e[0]<t[0]&&(e[0]=t[0]),e[1]<t[0]&&(e[1]=t[0]),e},getValueState:function(t){var e=this.option.range,n=this.getExtent();return(e[0]<=n[0]||e[0]<=t)&&(e[1]>=n[1]||t<=e[1])?"inRange":"outOfRange"},findTargetDataIndices:function(i){var o=[];return this.eachTargetSeries(function(t){var n=[],e=t.getData();e.each(this.getDataDimension(e),function(t,e){i[0]<=t&&t<=i[1]&&n.push(e)},this),o.push({seriesId:t.id,dataIndex:n})},this),o},getVisualMeta:function(n){var t=IL(0,0,this.getExtent()),e=IL(0,0,this.option.range.slice()),i=[];function o(t,e){i.push({value:t,color:n(t,e)})}for(var a=0,r=0,s=e.length,l=t.length;r<l&&(!e.length||t[r]<=e[0]);r++)t[r]<e[a]&&o(t[r],"outOfRange");for(var h=1;a<s;a++,h=0)h&&i.length&&o(e[a],"outOfRange"),o(e[a],"inRange");for(h=1;r<l;r++)(!e.length||e[e.length-1]<t[r])&&(h&&(i.length&&o(i[i.length-1].value,"outOfRange"),h=0),o(t[r],"outOfRange"));var u=i.length;return{stops:i,outerColors:[u?i[0].color:"transparent",u?i[u-1].color:"transparent"]}}});function IL(t,e,n){if(n[0]===n[1])return n.slice();for(var i=(n[1]-n[0])/200,o=n[0],a=[],r=0;r<=200&&o<n[1];r++)a.push(o),o+=i;return a.push(n[1]),a}var TL=bp({type:"visualMap",autoPositionValues:{left:1,right:1,top:1,bottom:1},init:function(t,e){this.ecModel=t,this.api=e,this.visualMapModel},render:function(t,e,n,i){!1!==(this.visualMapModel=t).get("show")?this.doRender.apply(this,arguments):this.group.removeAll()},renderBackground:function(t){var e=this.visualMapModel,n=Kl(e.get("padding")||0),i=t.getBoundingRect();t.add(new es({z2:-1,silent:!0,shape:{x:i.x-n[3],y:i.y-n[0],width:i.width+n[3]+n[1],height:i.height+n[0]+n[2]},style:{fill:e.get("backgroundColor"),stroke:e.get("borderColor"),lineWidth:e.get("borderWidth")}}))},getControllerVisual:function(n,i,o){var t,e=(o=o||{}).forceState,a=this.visualMapModel,r={};function s(t){return r[t]}function l(t,e){r[t]=e}"symbol"===i&&(r.symbol=a.get("itemSymbol")),"color"===i&&(t=a.get("contentColor"),r.color=t);var h=a.controllerVisuals[e||a.getValueState(n)];return P(u_.prepareVisualTypes(h),function(t){var e=h[t];o.convertOpacityToAlpha&&"opacity"===t&&(t="colorAlpha",e=h.__alphaForOpacity),u_.dependsOn(t,i)&&e&&e.applyVisual(n,s,l)}),r[i]},positionGroup:function(t){var e=this.visualMapModel,n=this.api;mh(t,e.getBoxLayoutParams(),{width:n.getWidth(),height:n.getHeight()})},doRender:it});function AL(t,e,n){var i=t.option,o=i.align;if(null!=o&&"auto"!==o)return o;for(var a={width:e.getWidth(),height:e.getHeight()},r="horizontal"===i.orient?1:0,s=[["left","right","width"],["top","bottom","height"]],l=s[r],h=[0,null,10],u={},c=0;c<3;c++)u[s[1-r][c]]=h[c],u[l[c]]=2===c?n[0]:i[l[c]];var d=[["x","width",3],["y","height",0]][r],p=fh(u,a,i.padding);return l[(p.margin[d[2]]||0)+p[d[0]]+.5*p[d[1]]<.5*a[d[1]]?0:1]}function DL(t,e){return P(t||[],function(t){null!=t.dataIndex&&(t.dataIndexInside=t.dataIndex,t.dataIndex=null),t.highlightKey="visualMap"+(e?e.componentIndex:"")}),t}var CL=Cl,LL=P,kL=Math.min,PL=Math.max,NL=TL.extend({type:"visualMap.continuous",init:function(){NL.superApply(this,"init",arguments),this._shapes={},this._dataInterval=[],this._handleEnds=[],this._orient,this._useHandle,this._hoverLinkDataIndices=[],this._dragging,this._hovering},doRender:function(t,e,n,i){i&&"selectDataRange"===i.type&&i.from===this.uid||this._buildView()},_buildView:function(){this.group.removeAll();var t=this.visualMapModel,e=this.group;this._orient=t.get("orient"),this._useHandle=t.get("calculable"),this._resetInterval(),this._renderBar(e);var n=t.get("text");this._renderEndsText(e,n,0),this._renderEndsText(e,n,1),this._updateView(!0),this.renderBackground(e),this._updateView(),this._enableHoverLinkToSeries(),this._enableHoverLinkFromSeries(),this.positionGroup(e)},_renderEndsText:function(t,e,n){var i,o,a,r,s,l,h,u,c;e&&(i=null!=(i=e[1-n])?i+"":"",a=(o=this.visualMapModel).get("textGap"),r=o.itemSize,s=this._shapes.barGroup,l=this._applyTransform([r[0]/2,0===n?-a:r[1]+a],s),h=this._applyTransform(0===n?"bottom":"top",s),u=this._orient,c=this.visualMapModel.textStyleModel,this.group.add(new Gr({style:{x:l[0],y:l[1],textVerticalAlign:"horizontal"===u?"middle":h,textAlign:"horizontal"===u?h:"center",text:i,textFont:c.getFont(),textFill:c.getTextColor()}})))},_renderBar:function(t){var e=this.visualMapModel,n=this._shapes,i=e.itemSize,o=this._orient,a=this._useHandle,r=AL(e,this.api,i),s=n.barGroup=this._createBarGroup(r);s.add(n.outOfRange=OL()),s.add(n.inRange=OL(null,a?zL(this._orient):null,E(this._dragHandle,this,"all",!1),E(this._dragHandle,this,"all",!0)));var l=e.textStyleModel.getTextRect("国"),h=PL(l.width,l.height);a&&(n.handleThumbs=[],n.handleLabels=[],n.handleLabelPoints=[],this._createHandle(s,0,i,h,o,r),this._createHandle(s,1,i,h,o,r)),this._createIndicator(s,i,h,o),t.add(s)},_createHandle:function(t,e,n,i,o){var a,r=E(this._dragHandle,this,e,!1),s=E(this._dragHandle,this,e,!0),l=OL((a=i,0===e?[[0,0],[a,0],[a,-a]]:[[0,0],[a,0],[a,a]]),zL(this._orient),r,s);l.position[0]=n[0],t.add(l);var h=this.visualMapModel.textStyleModel,u=new Gr({draggable:!0,drift:r,onmousemove:function(t){Wt(t.event)},ondragend:s,style:{x:0,y:0,text:"",textFont:h.getFont(),textFill:h.getTextColor()}});this.group.add(u);var c=["horizontal"===o?i/2:1.5*i,"horizontal"===o?0===e?-1.5*i:1.5*i:0===e?-i/2:i/2],d=this._shapes;d.handleThumbs[e]=l,d.handleLabelPoints[e]=c,d.handleLabels[e]=u},_createIndicator:function(t,e,n,i){var o=OL([[0,0]],"move");o.position[0]=e[0],o.attr({invisible:!0,silent:!0}),t.add(o);var a=this.visualMapModel.textStyleModel,r=new Gr({silent:!0,invisible:!0,style:{x:0,y:0,text:"",textFont:a.getFont(),textFill:a.getTextColor()}});this.group.add(r);var s=["horizontal"===i?n/2:9,0],l=this._shapes;l.indicator=o,l.indicatorLabel=r,l.indicatorLabelPoint=s},_dragHandle:function(t,e,n,i){var o;this._useHandle&&(this._dragging=!e,e||(o=this._applyTransform([n,i],this._shapes.barGroup,!0),this._updateInterval(t,o[1]),this._updateView()),e===!this.visualMapModel.get("realtime")&&this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:this._dataInterval.slice()}),e?this._hovering||this._clearHoverLinkToSeries():EL(this.visualMapModel)&&this._doHoverLinkToSeries(this._handleEnds[t],!1))},_resetInterval:function(){var t=this.visualMapModel,e=this._dataInterval=t.getSelected(),n=t.getExtent(),i=[0,t.itemSize[1]];this._handleEnds=[CL(e[0],n,i,!0),CL(e[1],n,i,!0)]},_updateInterval:function(t,e){e=e||0;var n=this.visualMapModel,i=this._handleEnds,o=[0,n.itemSize[1]];Yw(e,i,o,t,0);var a=n.getExtent();this._dataInterval=[CL(i[0],o,a,!0),CL(i[1],o,a,!0)]},_updateView:function(t){var e=this.visualMapModel,n=e.getExtent(),i=this._shapes,o=[0,e.itemSize[1]],a=t?o:this._handleEnds,r=this._createBarVisual(this._dataInterval,n,a,"inRange"),s=this._createBarVisual(n,n,o,"outOfRange");i.inRange.setStyle({fill:r.barColor,opacity:r.opacity}).setShape("points",r.barPoints),i.outOfRange.setStyle({fill:s.barColor,opacity:s.opacity}).setShape("points",s.barPoints),this._updateHandle(a,r)},_createBarVisual:function(t,e,n,i){var o={forceState:i,convertOpacityToAlpha:!0},a=this._makeColorGradient(t,o),r=[this.getControllerVisual(t[0],"symbolSize",o),this.getControllerVisual(t[1],"symbolSize",o)],s=this._createBarPoints(n,r);return{barColor:new us(0,0,0,1,a),barPoints:s,handlesColor:[a[0].color,a[a.length-1].color]}},_makeColorGradient:function(t,e){var n=[],i=(t[1]-t[0])/100;n.push({color:this.getControllerVisual(t[0],"color",e),offset:0});for(var o=1;o<100;o++){var a=t[0]+i*o;if(a>t[1])break;n.push({color:this.getControllerVisual(a,"color",e),offset:o/100})}return n.push({color:this.getControllerVisual(t[1],"color",e),offset:1}),n},_createBarPoints:function(t,e){var n=this.visualMapModel.itemSize;return[[n[0]-e[0],t[0]],[n[0],t[0]],[n[0],t[1]],[n[0]-e[1],t[1]]]},_createBarGroup:function(t){var e=this._orient,n=this.visualMapModel.get("inverse");return new Mn("horizontal"!==e||n?"horizontal"===e&&n?{scale:"bottom"===t?[-1,1]:[1,1],rotation:-Math.PI/2}:"vertical"!==e||n?{scale:"left"===t?[1,1]:[-1,1]}:{scale:"left"===t?[1,-1]:[-1,-1]}:{scale:"bottom"===t?[1,1]:[-1,1],rotation:Math.PI/2})},_updateHandle:function(i,o){var a,r,s,l;this._useHandle&&(a=this._shapes,r=this.visualMapModel,s=a.handleThumbs,l=a.handleLabels,LL([0,1],function(t){var e=s[t];e.setStyle("fill",o.handlesColor[t]),e.position[1]=i[t];var n=hl(a.handleLabelPoints[t],ll(e,this.group));l[t].setStyle({x:n[0],y:n[1],text:r.formatValueText(this._dataInterval[t]),textVerticalAlign:"middle",textAlign:this._applyTransform("horizontal"===this._orient?0===t?"bottom":"top":"left",a.barGroup)})},this))},_showIndicator:function(t,e,n,i){var o,a,r,s,l,h,u,c,d,p=this.visualMapModel,g=p.getExtent(),f=p.itemSize,m=[0,f[1]],v=CL(t,g,m,!0),y=this._shapes,x=y.indicator;x&&(x.position[1]=v,x.attr("invisible",!1),x.setShape("points",(o=!!n,a=i,r=v,s=f[1],o?[[0,-kL(a,PL(r,0))],[6,0],[0,kL(a,PL(s-r,0))]]:[[0,0],[5,-5],[5,5]])),l=this.getControllerVisual(t,"color",{convertOpacityToAlpha:!0}),x.setStyle("fill",l),h=hl(y.indicatorLabelPoint,ll(x,this.group)),(u=y.indicatorLabel).attr("invisible",!1),c=this._applyTransform("left",y.barGroup),d=this._orient,u.setStyle({text:(n||"")+p.formatValueText(e),textVerticalAlign:"horizontal"===d?c:"middle",textAlign:"horizontal"===d?"center":c,x:h[0],y:h[1]}))},_enableHoverLinkToSeries:function(){var i=this;this._shapes.barGroup.on("mousemove",function(t){var e,n;i._hovering=!0,i._dragging||(e=i.visualMapModel.itemSize,(n=i._applyTransform([t.offsetX,t.offsetY],i._shapes.barGroup,!0,!0))[1]=kL(PL(0,n[1]),e[1]),i._doHoverLinkToSeries(n[1],0<=n[0]&&n[0]<=e[0]))}).on("mouseout",function(){i._hovering=!1,i._dragging||i._clearHoverLinkToSeries()})},_enableHoverLinkFromSeries:function(){var t=this.api.getZr();this.visualMapModel.option.hoverLink?(t.on("mouseover",this._hoverLinkFromSeriesMouseOver,this),t.on("mouseout",this._hideIndicator,this)):this._clearHoverLinkFromSeries()},_doHoverLinkToSeries:function(t,e){var n,i,o,a,r,s,l,h,u,c,d,p,g=this.visualMapModel,f=g.itemSize;function m(t,e,n){for(var i=0,o=t.length;i<o;i++)for(var a=t[i].seriesId,r=Oo(t[i].dataIndex),s=n&&n[a],l=0,h=r.length;l<h;l++){var u=r[l];s&&s[u]?s[u]=null:(e[a]||(e[a]={}))[u]=1}}function v(t,e){var n,i=[];for(var o in t){t.hasOwnProperty(o)&&null!=t[o]&&(e?i.push(+o):(n=v(t[o],!0)).length&&i.push({seriesId:o,dataIndex:n}))}return i}g.option.hoverLink&&(n=[0,f[1]],i=g.getExtent(),a=[(t=kL(PL(n[0],t),n[1]))-(o=function(t,e,n){var i=6,o=t.get("hoverLinkDataSize");o&&(i=CL(o,e,n,!0)/2);return i}(g,i,n)),t+o],r=CL(t,n,i,!0),s=[CL(a[0],n,i,!0),CL(a[1],n,i,!0)],a[0]<n[0]&&(s[0]=-1/0),n[1]<a[1]&&(s[1]=1/0),e&&(s[0]===-1/0?this._showIndicator(r,s[1],"< ",o):s[1]===1/0?this._showIndicator(r,s[0],"> ",o):this._showIndicator(r,r,"≈ ",o)),l=this._hoverLinkDataIndices,h=[],(e||EL(g))&&(h=this._hoverLinkDataIndices=g.findTargetDataIndices(s)),c=h,p={},m(l||[],d={}),m(c||[],p,d),u=[v(d),v(p)],this._dispatchHighDown("downplay",DL(u[0],g)),this._dispatchHighDown("highlight",DL(u[1],g)))},_hoverLinkFromSeriesMouseOver:function(t){var e,n,i,o=t.target,a=this.visualMapModel;o&&null!=o.dataIndex&&(e=this.ecModel.getSeriesByIndex(o.seriesIndex),a.isTargetSeries(e)&&(i=(n=e.getData(o.dataType)).get(a.getDataDimension(n),o.dataIndex,!0),isNaN(i)||this._showIndicator(i,i)))},_hideIndicator:function(){var t=this._shapes;t.indicator&&t.indicator.attr("invisible",!0),t.indicatorLabel&&t.indicatorLabel.attr("invisible",!0)},_clearHoverLinkToSeries:function(){this._hideIndicator();var t=this._hoverLinkDataIndices;this._dispatchHighDown("downplay",DL(t,this.visualMapModel)),t.length=0},_clearHoverLinkFromSeries:function(){this._hideIndicator();var t=this.api.getZr();t.off("mouseover",this._hoverLinkFromSeriesMouseOver),t.off("mouseout",this._hideIndicator)},_applyTransform:function(t,e,n,i){var o=ll(e,i?null:this.group);return ml[R(t)?"applyTransform":"transformDirection"](t,o,n)},_dispatchHighDown:function(t,e){e&&e.length&&this.api.dispatchAction({type:t,batch:e})},dispose:function(){this._clearHoverLinkFromSeries(),this._clearHoverLinkToSeries()},remove:function(){this._clearHoverLinkFromSeries(),this._clearHoverLinkToSeries()}});function OL(t,e,n,i){return new jr({shape:{points:t},draggable:!!n,cursor:e,drift:n,onmousemove:function(t){Wt(t.event)},ondragend:i})}function EL(t){var e=t.get("hoverLinkOnHandle");return null==e?t.get("realtime"):e}function zL(t){return"vertical"===t?"ns-resize":"ew-resize"}fp({type:"selectDataRange",event:"dataRangeSelected",update:"update"},function(e,t){t.eachComponent({mainType:"visualMap",query:e},function(t){t.setSelected(e.selected)})}),pp(lL);var RL=bL.extend({type:"visualMap.piecewise",defaultOption:{selected:null,minOpen:!1,maxOpen:!1,align:"auto",itemWidth:20,itemHeight:14,itemSymbol:"roundRect",pieceList:null,categories:null,splitNumber:5,selectedMode:"multiple",itemGap:10,hoverLink:!0,showLabel:null},optionUpdated:function(t,e){RL.superApply(this,"optionUpdated",arguments),this._pieceList=[],this.resetExtent();var n=this._mode=this._determineMode();BL[this._mode].call(this),this._resetSelected(t,e);var i=this.option.categories;this.resetVisual(function(t,e){"categories"===n?(t.mappingMethod="category",t.categories=C(i)):(t.dataExtent=this.getExtent(),t.mappingMethod="piecewise",t.pieceList=N(this._pieceList,function(t){t=C(t);return"inRange"!==e&&(t.visual=null),t}))})},completeVisualOption:function(){var i=this.option,n={},t=u_.listVisualTypes(),o=this.isCategory();function a(t,e,n){return t&&t[e]&&(V(t[e])?t[e].hasOwnProperty(n):t[e]===n)}P(i.pieces,function(e){P(t,function(t){e.hasOwnProperty(t)&&(n[t]=1)})}),P(n,function(t,e){var n=0;P(this.stateList,function(t){n|=a(i,t,e)||a(i.target,t,e)},this),n||P(this.stateList,function(t){(i[t]||(i[t]={}))[e]=gL(e,"inRange"===t?"active":"inactive",o)})},this),bL.prototype.completeVisualOption.apply(this,arguments)},_resetSelected:function(t,e){var i,n=this.option,o=this._pieceList,a=(e?n:t).selected||{};n.selected=a,P(o,function(t,e){var n=this.getSelectedMapKey(t);a.hasOwnProperty(n)||(a[n]=!0)},this),"single"===n.selectedMode&&(i=!1,P(o,function(t,e){var n=this.getSelectedMapKey(t);a[n]&&(i?a[n]=!1:i=!0)},this))},getSelectedMapKey:function(t){return"categories"===this._mode?t.value+"":t.index+""},getPieceList:function(){return this._pieceList},_determineMode:function(){var t=this.option;return t.pieces&&0<t.pieces.length?"pieces":this.option.categories?"categories":"splitNumber"},setSelected:function(t){this.option.selected=C(t)},getValueState:function(t){var e=u_.findPieceIndex(t,this._pieceList);return null!=e&&this.option.selected[this.getSelectedMapKey(this._pieceList[e])]?"inRange":"outOfRange"},findTargetDataIndices:function(i){var o=[];return this.eachTargetSeries(function(t){var n=[],e=t.getData();e.each(this.getDataDimension(e),function(t,e){u_.findPieceIndex(t,this._pieceList)===i&&n.push(e)},this),o.push({seriesId:t.id,dataIndex:n})},this),o},getRepresentValue:function(t){var e;return this.isCategory()||null!=t.value?t.value:(e=t.interval||[])[0]===-1/0&&e[1]===1/0?0:(e[0]+e[1])/2},getVisualMeta:function(o){if(!this.isCategory()){var t,a=[],r=[],s=this,e=this._pieceList.slice();e.length?((t=e[0].interval[0])!==-1/0&&e.unshift({interval:[-1/0,t]}),(t=e[e.length-1].interval[1])!==1/0&&e.push({interval:[t,1/0]})):e.push({interval:[-1/0,1/0]});var n=-1/0;return P(e,function(t){var e=t.interval;e&&(e[0]>n&&i([n,e[0]],"outOfRange"),i(e.slice()),n=e[1])},this),{stops:a,outerColors:r}}function i(t,e){var n=s.getRepresentValue({interval:t});e=e||s.getValueState(n);var i=o(n,e);t[0]===-1/0?r[0]=i:t[1]===1/0?r[1]=i:a.push({value:t[0],color:i},{value:t[1],color:i})}}}),BL={splitNumber:function(){var t=this.option,e=this._pieceList,n=Math.min(t.precision,20),i=this.getExtent(),o=t.splitNumber,o=Math.max(parseInt(o,10),1);t.splitNumber=o;for(var a=(i[1]-i[0])/o;+a.toFixed(n)!==a&&n<5;)n++;t.precision=n,a=+a.toFixed(n);var r=0;t.minOpen&&e.push({index:r++,interval:[-1/0,i[0]],close:[0,0]});for(var s=i[0],l=r+o;r<l;s+=a){var h=r===o-1?i[1]:s+a;e.push({index:r++,interval:[s,h],close:[1,1]})}t.maxOpen&&e.push({index:r++,interval:[i[1],1/0],close:[0,0]}),Ul(e),P(e,function(t){t.text=this.formatValueText(t.interval)},this)},categories:function(){var t=this.option;P(t.categories,function(t){this._pieceList.push({text:this.formatValueText(t,!0),value:t})},this),VL(t,this._pieceList)},pieces:function(){var t=this.option,d=this._pieceList;P(t.pieces,function(t,e){V(t)||(t={value:t});var n={text:"",index:e};if(null!=t.label&&(n.text=t.label),t.hasOwnProperty("value")){var i=n.value=t.value;n.interval=[i,i],n.close=[1,1]}else{for(var o=n.interval=[],a=n.close=[0,0],r=[1,0,1],s=[-1/0,1/0],l=[],h=0;h<2;h++){for(var u=[["gte","gt","min"],["lte","lt","max"]][h],c=0;c<3&&null==o[h];c++)o[h]=t[u[c]],a[h]=r[c],l[h]=2===c;null==o[h]&&(o[h]=s[h])}l[0]&&o[1]===1/0&&(a[0]=0),l[1]&&o[0]===-1/0&&(a[1]=0),D&&o[0]>o[1]&&console.warn("Piece "+e+"is illegal: "+o+" lower bound should not greater then uppper bound."),o[0]===o[1]&&a[0]&&a[1]&&(n.value=o[0])}n.visual=u_.retrieveVisuals(t),d.push(n)},this),VL(t,d),Ul(d),P(d,function(t){var e=t.close,n=[["<","≤"][e[1]],[">","≥"][e[0]]];t.text=t.text||this.formatValueText(null!=t.value?t.value:t.interval,!1,n)},this)}};function VL(t,e){var n=t.inverse;("vertical"===t.orient?!n:n)&&e.reverse()}TL.extend({type:"visualMap.piecewise",doRender:function(){var a=this.group;a.removeAll();var r=this.visualMapModel,s=r.get("textGap"),t=r.textStyleModel,l=t.getFont(),h=t.getTextColor(),u=this._getItemAlign(),c=r.itemSize,e=this._getViewData(),n=e.endsText,d=Z(r.get("showLabel",!0),!n);n&&this._renderEndsText(a,n[0],c,d,u),P(e.viewPieceList,function(t){var e=t.piece,n=new Mn;n.onclick=E(this._onItemClick,this,e),this._enableHoverLink(n,t.indexInModelPieceList);var i=r.getRepresentValue(e);{var o;this._createItemSymbol(n,i,[0,0,c[0],c[1]]),d&&(o=this.visualMapModel.getValueState(i),n.add(new Gr({style:{x:"right"===u?-s:c[0]+s,y:c[1]/2,text:e.text,textVerticalAlign:"middle",textAlign:u,textFont:l,textFill:h,opacity:"outOfRange"===o?.5:1}})))}a.add(n)},this),n&&this._renderEndsText(a,n[1],c,d,u),gh(r.get("orient"),a,r.get("itemGap")),this.renderBackground(a),this.positionGroup(a)},_enableHoverLink:function(t,n){function e(t){var e=this.visualMapModel;e.option.hoverLink&&this.api.dispatchAction({type:t,batch:DL(e.findTargetDataIndices(n),e)})}t.on("mouseover",E(e,this,"highlight")).on("mouseout",E(e,this,"downplay"))},_getItemAlign:function(){var t=this.visualMapModel,e=t.option;if("vertical"===e.orient)return AL(t,this.api,t.itemSize);var n=e.align;return n&&"auto"!==n||(n="left"),n},_renderEndsText:function(t,e,n,i,o){var a,r;e&&(a=new Mn,r=this.visualMapModel.textStyleModel,a.add(new Gr({style:{x:i?"right"===o?n[0]:0:n[0]/2,y:n[1]/2,textVerticalAlign:"middle",textAlign:i?o:"center",text:e,textFont:r.getFont(),textFill:r.getTextColor()}})),t.add(a))},_getViewData:function(){var t=this.visualMapModel,e=N(t.getPieceList(),function(t,e){return{piece:t,indexInModelPieceList:e}}),n=t.get("text"),i=t.get("orient"),o=t.get("inverse");return("horizontal"===i?o:!o)?e.reverse():n=n&&n.slice().reverse(),{viewPieceList:e,endsText:n}},_createItemSymbol:function(t,e,n){t.add(xf(this.getControllerVisual(e,"symbol"),n[0],n[1],n[2],n[3],this.getControllerVisual(e,"color")))},_onItemClick:function(t){var e=this.visualMapModel,n=e.option,i=C(n.selected),o=e.getSelectedMapKey(t);"single"===n.selectedMode?(i[o]=!0,P(i,function(t,e){i[e]=e===o})):i[o]=!i[o],this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:i})}});pp(lL);var GL,FL="urn:schemas-microsoft-com:vml",WL="undefined"==typeof window?null:window,HL=!1,ZL=WL&&WL.document;function UL(t){return GL(t)}if(ZL&&!v.canvasSupported)try{ZL.namespaces.zrvml||ZL.namespaces.add("zrvml",FL),GL=function(t){return ZL.createElement("<zrvml:"+t+' class="zrvml">')}}catch(t){GL=function(t){return ZL.createElement("<"+t+' xmlns="'+FL+'" class="zrvml">')}}var XL=er.CMD,YL=Math.round,jL=Math.sqrt,qL=Math.abs,KL=Math.cos,$L=Math.sin,JL=Math.max;if(!v.canvasSupported){var QL=",",tk="progid:DXImageTransform.Microsoft",ek=21600,nk=ek/2,ik=function(t){t.style.cssText="position:absolute;left:0;top:0;width:1px;height:1px;",t.coordsize=ek+","+ek,t.coordorigin="0,0"},ok=function(t,e,n){return"rgb("+[t,e,n].join(",")+")"},ak=function(t,e){e&&t&&e.parentNode!==t&&t.appendChild(e)},rk=function(t,e){e&&t&&e.parentNode===t&&t.removeChild(e)},sk=function(t,e,n){return 1e5*(parseFloat(t)||0)+1e3*(parseFloat(e)||0)+n},lk=Fi,hk=function(t,e,n){var i=Re(e);n=+n,isNaN(n)&&(n=1),i&&(t.color=ok(i[0],i[1],i[2]),t.opacity=n*i[3])},uk=function(t,e,n,i){var o,a,r="fill"===e,s=t.getElementsByTagName(e)[0];null!=n[e]&&"none"!==n[e]&&(r||!r&&n.lineWidth)?(t[r?"filled":"stroked"]="true",n[e]instanceof rs&&rk(t,s),s=s||UL(e),r?function(t,e,n){var i,o,a=e.fill;if(null!=a)if(a instanceof rs){var r,s,l,h,u,c,d,p,g,f,m=0,v=[0,0],y=0,x=1,_=n.getBoundingRect(),w=_.width,b=_.height;"linear"===a.type?(r="gradient",c=n.transform,u=[a.x*w,a.y*b],s=[a.x2*w,a.y2*b],c&&(bt(u,u,c),bt(s,s,c)),l=s[0]-u[0],h=s[1]-u[1],(m=180*Math.atan2(l,h)/Math.PI)<0&&(m+=360),m<1e-6&&(m=0)):(r="gradientradial",u=[a.x*w,a.y*b],c=n.transform,d=n.scale,p=w,g=b,v=[(u[0]-_.x)/p,(u[1]-_.y)/g],c&&bt(u,u,c),p/=d[0]*ek,g/=d[1]*ek,y=0/(f=JL(p,g)),x=2*a.r/f-y);var S=a.colorStops.slice();S.sort(function(t,e){return t.offset-e.offset});for(var M,I,T,A,D=S.length,C=[],L=[],k=0;k<D;k++){var P=S[k],N=(i=P.color,o=Re(i),[ok(o[0],o[1],o[2]),o[3]]);L.push(P.offset*x+y+" "+N[0]),0!==k&&k!==D-1||C.push(N)}2<=D&&(M=C[0][0],I=C[1][0],T=C[0][1]*e.opacity,A=C[1][1]*e.opacity,t.type=r,t.method="none",t.focus="100%",t.angle=m,t.color=M,t.color2=I,t.colors=L.join(","),t.opacity=A,t.opacity2=T),"radial"===r&&(t.focusposition=v.join(","))}else hk(t,a,e.opacity)}(s,n,i):(o=s,(a=n).lineDash&&(o.dashstyle=a.lineDash.join(" ")),null==a.stroke||a.stroke instanceof rs||hk(o,a.stroke,a.opacity)),ak(t,s)):(t[r?"filled":"stroked"]="false",rk(t,s))},ck=[[],[],[]];br.prototype.brushVML=function(t){var e=this.style,n=this._vmlEl;n||(n=UL("shape"),ik(n),this._vmlEl=n),uk(n,"fill",e,this),uk(n,"stroke",e,this);var i,o,a=this.transform,r=null!=a,s=n.getElementsByTagName("stroke")[0];s&&(i=e.lineWidth,r&&!e.strokeNoScale&&(o=a[0]*a[3]-a[1]*a[2],i*=jL(qL(o))),s.weight=i+"px");var l=this.path||(this.path=new er);this.__dirtyPath&&(l.beginPath(),l.subPixelOptimize=!1,this.buildPath(l,this.shape),l.toStatic(),this.__dirtyPath=!1),n.path=function(t,e){for(var n,i,o,a,r,s=XL.M,l=XL.C,h=XL.L,u=XL.A,c=XL.Q,d=[],p=t.data,g=t.len(),f=0;f<g;){switch(i="",n=0,o=p[f++]){case s:i=" m ",n=1,a=p[f++],r=p[f++],ck[0][0]=a,ck[0][1]=r;break;case h:i=" l ",n=1,a=p[f++],r=p[f++],ck[0][0]=a,ck[0][1]=r;break;case c:case l:i=" c ",n=3;var m,v,y=p[f++],x=p[f++],_=p[f++],w=p[f++];o===c?(_=((m=_)+2*y)/3,w=((v=w)+2*x)/3,y=(a+2*y)/3,x=(r+2*x)/3):(m=p[f++],v=p[f++]),ck[0][0]=y,ck[0][1]=x,ck[1][0]=_,ck[1][1]=w,a=ck[2][0]=m,r=ck[2][1]=v;break;case u:var b=0,S=0,M=1,I=1,T=0;e&&(b=e[4],S=e[5],M=jL(e[0]*e[0]+e[1]*e[1]),I=jL(e[2]*e[2]+e[3]*e[3]),T=Math.atan2(-e[1]/I,e[0]/M));var A=p[f++],D=p[f++],C=p[f++],L=p[f++],k=p[f++]+T,P=p[f++]+k+T;f++;var N=p[f++],O=A+KL(k)*C,E=D+$L(k)*L,y=A+KL(P)*C,x=D+$L(P)*L,z=N?" wa ":" at ";Math.abs(O-y)<1e-4&&(.01<Math.abs(P-k)?N&&(O+=.0125):Math.abs(E-D)<1e-4?N&&O<A||!N&&A<O?x-=.0125:x+=.0125:N&&E<D||!N&&D<E?y+=.0125:y-=.0125),d.push(z,YL(((A-C)*M+b)*ek-nk),QL,YL(((D-L)*I+S)*ek-nk),QL,YL(((A+C)*M+b)*ek-nk),QL,YL(((D+L)*I+S)*ek-nk),QL,YL((O*M+b)*ek-nk),QL,YL((E*I+S)*ek-nk),QL,YL((y*M+b)*ek-nk),QL,YL((x*I+S)*ek-nk)),a=y,r=x;break;case XL.R:var R=ck[0],B=ck[1];R[0]=p[f++],R[1]=p[f++],B[0]=R[0]+p[f++],B[1]=R[1]+p[f++],e&&(bt(R,R,e),bt(B,B,e)),R[0]=YL(R[0]*ek-nk),B[0]=YL(B[0]*ek-nk),R[1]=YL(R[1]*ek-nk),B[1]=YL(B[1]*ek-nk),d.push(" m ",R[0],QL,R[1]," l ",B[0],QL,R[1]," l ",B[0],QL,B[1]," l ",R[0],QL,B[1]);break;case XL.Z:d.push(" x ")}if(0<n){d.push(i);for(var V=0;V<n;V++){var G=ck[V];e&&bt(G,G,e),d.push(YL(G[0]*ek-nk),QL,YL(G[1]*ek-nk),V<n-1?QL:"")}}}return d.join("")}(l,this.transform),n.style.zIndex=sk(this.zlevel,this.z,this.z2),ak(t,n),null!=e.text?this.drawRectText(t,this.getBoundingRect()):this.removeRectText(t)},br.prototype.onRemove=function(t){rk(t,this._vmlEl),this.removeRectText(t)},br.prototype.onAdd=function(t){ak(t,this._vmlEl),this.appendRectText(t)};Yi.prototype.brushVML=function(t){var e,n,i,o,a,r,s,l,h,u,c,d,p,g,f,m,v,y,x,_,w,b,S,M,I,T,A,D,C,L,k,P,N,O,E,z,R,B=this.style,V=B.image;"object"==typeof(s=V)&&s.tagName&&"IMG"===s.tagName.toUpperCase()?((i=V.src)===this._imageSrc?(e=this._imageWidth,n=this._imageHeight):(a=(o=V.runtimeStyle).width,r=o.height,o.width="auto",o.height="auto",e=V.width,n=V.height,o.width=a,o.height=r,this._imageSrc=i,this._imageWidth=e,this._imageHeight=n),V=i):V===this._imageSrc&&(e=this._imageWidth,n=this._imageHeight),V&&(l=B.x||0,h=B.y||0,u=B.width,c=B.height,d=B.sWidth,p=B.sHeight,g=B.sx||0,f=B.sy||0,m=d&&p,(v=this._vmlEl)||(v=ZL.createElement("div"),ik(v),this._vmlEl=v),y=v.style,x=!1,b=w=1,this.transform&&(_=this.transform,w=jL(_[0]*_[0]+_[1]*_[1]),b=jL(_[2]*_[2]+_[3]*_[3]),x=_[1]||_[2]),x?(M=[l+u,h],I=[l,h+c],T=[l+u,h+c],bt(S=[l,h],S,_),bt(M,M,_),bt(I,I,_),bt(T,T,_),A=JL(S[0],M[0],I[0],T[0]),D=JL(S[1],M[1],I[1],T[1]),(C=[]).push("M11=",_[0]/w,QL,"M12=",_[2]/b,QL,"M21=",_[1]/w,QL,"M22=",_[3]/b,QL,"Dx=",YL(l*w+_[4]),QL,"Dy=",YL(h*b+_[5])),y.padding="0 "+YL(A)+"px "+YL(D)+"px 0",y.filter=tk+".Matrix("+C.join("")+", SizingMethod=clip)"):(_&&(l=l*w+_[4],h=h*b+_[5]),y.filter="",y.left=YL(l)+"px",y.top=YL(h)+"px"),L=this._imageEl,k=this._cropEl,L||(L=ZL.createElement("div"),this._imageEl=L),P=L.style,m?(e&&n?(P.width=YL(w*e*u/d)+"px",P.height=YL(b*n*c/p)+"px"):(N=new Image,O=this,N.onload=function(){N.onload=null,e=N.width,n=N.height,P.width=YL(w*e*u/d)+"px",P.height=YL(b*n*c/p)+"px",O._imageWidth=e,O._imageHeight=n,O._imageSrc=V},N.src=V),k||((k=ZL.createElement("div")).style.overflow="hidden",this._cropEl=k),(E=k.style).width=YL((u+g*u/d)*w),E.height=YL((c+f*c/p)*b),E.filter=tk+".Matrix(Dx="+-g*u/d*w+",Dy="+-f*c/p*b+")",k.parentNode||v.appendChild(k),L.parentNode!==k&&k.appendChild(L)):(P.width=YL(w*u)+"px",P.height=YL(b*c)+"px",v.appendChild(L),k&&k.parentNode&&(v.removeChild(k),this._cropEl=null)),z="",(R=B.opacity)<1&&(z+=".Alpha(opacity="+YL(100*R)+") "),z+=tk+".AlphaImageLoader(src="+V+", SizingMethod=scale)",P.filter=z,v.style.zIndex=sk(this.zlevel,this.z,this.z2),ak(t,v),null!=B.text&&this.drawRectText(t,this.getBoundingRect()))},Yi.prototype.onRemove=function(t){rk(t,this._vmlEl),this._vmlEl=null,this._cropEl=null,this._imageEl=null,this.removeRectText(t)},Yi.prototype.onAdd=function(t){ak(t,this._vmlEl),this.appendRectText(t)};var dk,pk="normal",gk={},fk=0,mk=document.createElement("div");si.measureText=function(t,e){var n=ZL;dk||((dk=n.createElement("div")).style.cssText="position:absolute;top:-20000px;left:0;padding:0;margin:0;border:none;white-space:pre;",ZL.body.appendChild(dk));try{dk.style.font=e}catch(t){}return dk.innerHTML="",dk.appendChild(n.createTextNode(t)),{width:dk.offsetWidth}};for(var vk=new Sn,yk=function(t,e,n,i){var o=this.style;if(this.__dirty&&Ci(o),null!=(r=o.text)&&(r+=""),r){if(o.rich){for(var a=xi(r,o),r=[],s=0;s<a.lines.length;s++){for(var l=a.lines[s].tokens,h=[],u=0;u<l.length;u++)h.push(l[u].text);r.push(h.join(""))}r=r.join("\n")}var c=o.textAlign,d=o.textVerticalAlign,p=function(t){var e=gk[t];if(!e){100<fk&&(fk=0,gk={});var n,i=mk.style;try{i.font=t,n=i.fontFamily.split(",")[0]}catch(t){}e={style:i.fontStyle||pk,variant:i.fontVariant||pk,weight:i.fontWeight||pk,size:0|parseFloat(i.fontSize||12),family:n||"Microsoft YaHei"},gk[t]=e,fk++}return e}(o.font),g=p.style+" "+p.variant+" "+p.weight+" "+p.size+'px "'+p.family+'"';n=n||hi(r,g,c,d,o.textPadding,o.textLineHeight);var f,m,v,y,x=this.transform;x&&!i&&(vk.copy(e),vk.applyTransform(x),e=vk),i?(v=e.x,y=e.y):(f=o.textPosition)instanceof Array?(v=e.x+lk(f[0],e.width),y=e.y+lk(f[1],e.height),c=c||"left"):(v=(m=this.calculateTextPosition?this.calculateTextPosition({},o,e):di({},o,e)).x,y=m.y,c=c||m.textAlign,d=d||m.textVerticalAlign),v=ui(v,n.width,c),y=ci(y,n.height,d),y+=n.height/2;var _,w,b,S=UL,M=this._textVmlEl;M?w=(_=(b=M.firstChild).nextSibling).nextSibling:(M=S("line"),_=S("path"),w=S("textpath"),b=S("skew"),w.style["v-text-align"]="left",ik(M),_.textpathok=!0,w.on=!0,M.from="0 0",M.to="1000 0.05",ak(M,b),ak(M,_),ak(M,w),this._textVmlEl=M);var I=[v,y],T=M.style;x&&i?(bt(I,I,x),b.on=!0,b.matrix=x[0].toFixed(3)+QL+x[2].toFixed(3)+QL+x[1].toFixed(3)+QL+x[3].toFixed(3)+",0,0",b.offset=(YL(I[0])||0)+","+(YL(I[1])||0),b.origin="0 0",T.left="0px",T.top="0px"):(b.on=!1,T.left=YL(v)+"px",T.top=YL(y)+"px"),w.string=String(r).replace(/&/g,"&amp;").replace(/"/g,"&quot;");try{w.style.font=g}catch(t){}uk(M,"fill",{fill:o.textFill,opacity:o.opacity},this),uk(M,"stroke",{stroke:o.textStroke,opacity:o.opacity,lineDash:o.lineDash||null},this),M.style.zIndex=sk(this.zlevel,this.z,this.z2),ak(t,M)}},xk=function(t){rk(t,this._textVmlEl),this._textVmlEl=null},_k=function(t){ak(t,this._textVmlEl)},wk=[Zi,Xi,Yi,br,Gr],bk=0;bk<wk.length;bk++){var Sk=wk[bk].prototype;Sk.drawRectText=yk,Sk.removeRectText=xk,Sk.appendRectText=_k}Gr.prototype.brushVML=function(t){var e=this.style;null!=e.text?this.drawRectText(t,{x:e.x||0,y:e.y||0,width:0,height:0},this.getBoundingRect(),!0):this.removeRectText(t)},Gr.prototype.onRemove=function(t){this.removeRectText(t)},Gr.prototype.onAdd=function(t){this.appendRectText(t)}}function Mk(t){return parseInt(t,10)}function Ik(t,e){var n;!HL&&ZL&&(HL=!0,(n=ZL.styleSheets).length<31?ZL.createStyleSheet().addRule(".zrvml","behavior:url(#default#VML)"):n[0].addRule(".zrvml","behavior:url(#default#VML)")),this.root=t,this.storage=e;var i=document.createElement("div"),o=document.createElement("div");i.style.cssText="display:inline-block;overflow:hidden;position:relative;width:300px;height:150px;",o.style.cssText="position:absolute;left:0;top:0;",t.appendChild(i),this._vmlRoot=o,this._vmlViewport=i,this.resize();var a=e.delFromStorage,r=e.addToStorage;e.delFromStorage=function(t){a.call(e,t),t&&t.onRemove&&t.onRemove(o)},e.addToStorage=function(t){t.onAdd&&t.onAdd(o),r.call(e,t)},this._firstPaint=!0}Ik.prototype={constructor:Ik,getType:function(){return"vml"},getViewportRoot:function(){return this._vmlViewport},getViewportRootOffset:function(){var t=this.getViewportRoot();if(t)return{offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0}},refresh:function(){var t=this.storage.getDisplayList(!0,!0);this._paintList(t)},_paintList:function(t){for(var e=this._vmlRoot,n=0;n<t.length;n++){var i=t[n];i.invisible||i.ignore?(i.__alreadyNotVisible||i.onRemove(e),i.__alreadyNotVisible=!0):(i.__alreadyNotVisible&&i.onAdd(e),i.__alreadyNotVisible=!1,i.__dirty&&(i.beforeBrush&&i.beforeBrush(),(i.brushVML||i.brush).call(i,e),i.afterBrush&&i.afterBrush())),i.__dirty=!1}this._firstPaint&&(this._vmlViewport.appendChild(e),this._firstPaint=!1)},resize:function(t,e){var n,t=null==t?this._getWidth():t,e=null==e?this._getHeight():e;this._width===t&&this._height===e||(this._width=t,this._height=e,(n=this._vmlViewport.style).width=t+"px",n.height=e+"px")},dispose:function(){this.root.innerHTML="",this._vmlRoot=this._vmlViewport=this.storage=null},getWidth:function(){return this._width},getHeight:function(){return this._height},clear:function(){this._vmlViewport&&this.root.removeChild(this._vmlViewport)},_getWidth:function(){var t=this.root,e=t.currentStyle;return(t.clientWidth||Mk(e.width))-Mk(e.paddingLeft)-Mk(e.paddingRight)|0},_getHeight:function(){var t=this.root,e=t.currentStyle;return(t.clientHeight||Mk(e.height))-Mk(e.paddingTop)-Mk(e.paddingBottom)|0}},P(["getLayer","insertLayer","eachLayer","eachBuiltinLayer","eachOtherLayer","getLayers","modLayer","delLayer","clearLayer","toDataURL","pathToImage"],function(t){var e;Ik.prototype[t]=(e=t,function(){dn('In IE8.0 VML mode painter not support method "'+e+'"')})}),Ao("vml",Ik);function Tk(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}var Ak=er.CMD,Dk=Array.prototype.join,Ck="none",Lk=Math.round,kk=Math.sin,Pk=Math.cos,Nk=Math.PI,Ok=2*Math.PI,Ek=180/Nk,zk=1e-4;function Rk(t){return Lk(1e4*t)/1e4}function Bk(t){return t<zk&&-zk<t}function Vk(t,e){e&&Gk(t,"transform","matrix("+Dk.call(e,",")+")")}function Gk(t,e,n){n&&("linear"===n.type||"radial"===n.type)||t.setAttribute(e,n)}function Fk(t,e,n,i){var o,a,r,s,l,h;a=e,null!=(r=n?a.textFill:a.fill)&&r!==Ck?(Gk(t,"fill",o="transparent"===(o=n?e.textFill:e.fill)?Ck:o),Gk(t,"fill-opacity",null!=e.fillOpacity?e.fillOpacity*e.opacity:e.opacity)):Gk(t,"fill",Ck),l=e,null!=(h=n?l.textStroke:l.stroke)&&h!==Ck?(Gk(t,"stroke",s="transparent"===(s=n?e.textStroke:e.stroke)?Ck:s),Gk(t,"stroke-width",(n?e.textStrokeWidth:e.lineWidth)/(!n&&e.strokeNoScale?i.getLineScale():1)),Gk(t,"paint-order",n?"stroke":"fill"),Gk(t,"stroke-opacity",null!=e.strokeOpacity?e.strokeOpacity:e.opacity),e.lineDash?(Gk(t,"stroke-dasharray",e.lineDash.join(",")),Gk(t,"stroke-dashoffset",Lk(e.lineDashOffset||0))):Gk(t,"stroke-dasharray",""),e.lineCap&&Gk(t,"stroke-linecap",e.lineCap),e.lineJoin&&Gk(t,"stroke-linejoin",e.lineJoin),e.miterLimit&&Gk(t,"stroke-miterlimit",e.miterLimit)):Gk(t,"stroke",Ck)}var Wk={};Wk.brush=function(t){var e=t.style,n=t.__svgEl;n||(n=Tk("path"),t.__svgEl=n),t.path||t.createPathProxy();var i,o=t.path;t.__dirtyPath&&(o.beginPath(),o.subPixelOptimize=!1,t.buildPath(o,t.shape),t.__dirtyPath=!1,(i=function(t){for(var e=[],n=t.data,i=t.len(),o=0;o<i;){var a="",r=0;switch(n[o++]){case Ak.M:a="M",r=2;break;case Ak.L:a="L",r=2;break;case Ak.Q:a="Q",r=4;break;case Ak.C:a="C",r=6;break;case Ak.A:var s=n[o++],l=n[o++],h=n[o++],u=n[o++],c=n[o++],d=n[o++],p=n[o++],g=n[o++],f=Math.abs(d),m=Bk(f-Ok)||(g?Ok<=d:Ok<=-d),v=!1,v=!!m||!Bk(f)&&Nk<=(0<d?d%Ok:d%Ok+Ok)==!!g,y=Rk(s+h*Pk(c)),x=Rk(l+u*kk(c));m&&(d=g?Ok-1e-4:1e-4-Ok,v=!0,9===o&&e.push("M",y,x));var _=Rk(s+h*Pk(c+d)),w=Rk(l+u*kk(c+d));e.push("A",Rk(h),Rk(u),Lk(p*Ek),+v,+g,_,w);break;case Ak.Z:a="Z";break;case Ak.R:var _=Rk(n[o++]),w=Rk(n[o++]),b=Rk(n[o++]),S=Rk(n[o++]);e.push("M",_,w,"L",_+b,w,"L",_+b,w+S,"L",_,w+S,"L",_,w)}a&&e.push(a);for(var M=0;M<r;M++)e.push(Rk(n[o++]))}return e.join(" ")}(o)).indexOf("NaN")<0&&Gk(n,"d",i)),Fk(n,e,!1,t),Vk(n,t.transform),null!=e.text?qk(t,t.getBoundingRect()):$k(t)};var Hk={brush:function(t){var e,n,i,o,a,r,s,l=t.style,h=l.image;h instanceof HTMLImageElement&&(h=h.src),h&&(e=l.x||0,n=l.y||0,i=l.width,o=l.height,(a=t.__svgEl)||(a=Tk("image"),t.__svgEl=a),h!==t.__imageSrc&&(r="href",s=h,a.setAttributeNS("http://www.w3.org/1999/xlink",r,s),t.__imageSrc=h),Gk(a,"width",i),Gk(a,"height",o),Gk(a,"x",e),Gk(a,"y",n),Vk(a,t.transform),null!=l.text?qk(t,t.getBoundingRect()):$k(t))}},Zk={},Uk=new Sn,Xk={},Yk=[],jk={left:"start",right:"end",center:"middle",middle:"middle"},qk=function(t,e){var n=t.style,i=t.transform,o=t instanceof Gr||n.transformText;t.__dirty&&Ci(n);var a=n.text;if(null!=a&&(a+=""),Hi(a,n)){null==a&&(a=""),!o&&i&&(Uk.copy(e),Uk.applyTransform(i),e=Uk);var r=t.__textSvgEl;r||(r=Tk("text"),t.__textSvgEl=r);var s=r.style,l=n.font||ri,h=r.__computedFont;l!==r.__styleFont&&(s.font=r.__styleFont=l,h=r.__computedFont=s.font);var u=n.textPadding,c=n.textLineHeight,d=t.__textCotentBlock;d&&!t.__dirtyText||(d=t.__textCotentBlock=yi(a,h,u,c,n.truncate));var p=d.outerHeight,g=d.lineHeight;Ri(Xk,t,n,e);var f=Xk.baseX,m=Xk.baseY,v=Xk.textAlign||"left",y=Xk.textVerticalAlign;!function(t,e,n,i,o,a,r){ne(Yk),e&&n&&ie(Yk,n);var s=i.textRotation;{var l;o&&s&&("center"===(l=i.textOrigin)?(a=o.width/2+o.x,r=o.height/2+o.y):l&&(a=l[0]+o.x,r=l[1]+o.y),Yk[4]-=a,Yk[5]-=r,re(Yk,Yk,s),Yk[4]+=a,Yk[5]+=r)}Vk(t,Yk)}(r,o,i,n,e,f,m);var x,_,w,b=f,S=ci(m,p,y);u&&(x=f,w=u,b="right"===(_=v)?x-w[1]:"center"===_?x+w[3]/2-w[1]/2:x+w[3],S+=u[0]),S+=g/2,Fk(r,n,!0,t);var M=d.canCacheByTextString,I=t.__tspanList||(t.__tspanList=[]),T=I.length;if(M&&t.__canCacheByTextString&&t.__text===a){if(t.__dirtyText&&T)for(var A=0;A<T;++A)Kk(I[A],v,b,S+A*g)}else{t.__text=a,t.__canCacheByTextString=M;for(var D=d.lines,C=D.length,A=0;A<C;A++){var L=I[A],k=D[A];L?L.__zrText!==k&&(L.innerHTML="",L.appendChild(document.createTextNode(k))):(L=I[A]=Tk("tspan"),r.appendChild(L),L.appendChild(document.createTextNode(k))),Kk(L,v,b,S+A*g)}if(C<T){for(;A<T;A++)r.removeChild(I[A]);I.length=C}}}};function Kk(t,e,n,i){Gk(t,"dominant-baseline","middle"),Gk(t,"text-anchor",jk[e]),Gk(t,"x",n),Gk(t,"y",i)}function $k(t){t&&t.__textSvgEl&&(t.__textSvgEl.parentNode&&t.__textSvgEl.parentNode.removeChild(t.__textSvgEl),t.__textSvgEl=null,t.__tspanList=[],t.__text=null)}function Jk(){}function Qk(t,e){for(var n=0,i=e.length,o=0,a=0;n<i;n++){var r=e[n];if(r.removed){for(s=[],l=a;l<a+r.count;l++)s.push(l);r.indices=s,a+=r.count}else{for(var s=[],l=o;l<o+r.count;l++)s.push(l);r.indices=s,o+=r.count,r.added||(a+=r.count)}}return e}Zk.drawRectText=qk,Zk.brush=function(t){null!=t.style.text?qk(t,!1):$k(t)},Jk.prototype={diff:function(l,h,t){t=t||function(t,e){return t===e},this.equals=t;var u=this;l=l.slice();var c=(h=h.slice()).length,d=l.length,p=1,e=c+d,g=[{newPos:-1,components:[]}],n=this.extractCommon(g[0],h,l,0);if(g[0].newPos+1>=c&&d<=n+1){for(var i=[],o=0;o<h.length;o++)i.push(o);return[{indices:i,count:h.length}]}function a(){for(var t,e=-1*p;e<=p;e+=2){var n,i=g[e-1],o=g[e+1],a=(o?o.newPos:0)-e;i&&(g[e-1]=void 0);var r=i&&i.newPos+1<c,s=o&&0<=a&&a<d;if(r||s){if(!r||s&&i.newPos<o.newPos?(n={newPos:(t=o).newPos,components:t.components.slice(0)},u.pushComponent(n.components,void 0,!0)):((n=i).newPos++,u.pushComponent(n.components,!0,void 0)),a=u.extractCommon(n,h,l,e),n.newPos+1>=c&&d<=a+1)return Qk(0,n.components);g[e]=n}else g[e]=void 0}p++}for(;p<=e;){var r=a();if(r)return r}},pushComponent:function(t,e,n){var i=t[t.length-1];i&&i.added===e&&i.removed===n?t[t.length-1]={count:i.count+1,added:e,removed:n}:t.push({count:1,added:e,removed:n})},extractCommon:function(t,e,n,i){for(var o=e.length,a=n.length,r=t.newPos,s=r-i,l=0;r+1<o&&s+1<a&&this.equals(e[r+1],n[s+1]);)r++,s++,l++;return l&&t.components.push({count:l}),t.newPos=r,s},tokenize:function(t){return t.slice()},join:function(t){return t.slice()}};var tP=new Jk;function eP(t,e,n,i,o){this._zrId=t,this._svgRoot=e,this._tagNames="string"==typeof n?[n]:n,this._markLabel=i,this._domName=o||"_dom",this.nextId=0}function nP(t,e){eP.call(this,t,e,["linearGradient","radialGradient"],"__gradient_in_use__")}function iP(t,e){eP.call(this,t,e,"clipPath","__clippath_in_use__")}function oP(t,e){eP.call(this,t,e,["filter"],"__filter_in_use__","_shadowDom")}function aP(t){return t&&(t.shadowBlur||t.shadowOffsetX||t.shadowOffsetY||t.textShadowBlur||t.textShadowOffsetX||t.textShadowOffsetY)}function rP(t){return parseInt(t,10)}function sP(t,e){return e&&t&&e.parentNode!==t}function lP(t,e,n){var i;sP(t,e)&&n&&((i=n.nextSibling)?t.insertBefore(e,i):t.appendChild(e))}function hP(t,e){var n;sP(t,e)&&((n=t.firstChild)?t.insertBefore(e,n):t.appendChild(e))}function uP(t,e){e&&t&&e.parentNode===t&&t.removeChild(e)}function cP(t){return t.__textSvgEl}function dP(t){return t.__svgEl}eP.prototype.createElement=Tk,eP.prototype.getDefs=function(t){var e=this._svgRoot,i=this._svgRoot.getElementsByTagName("defs");return 0===i.length?t?((i=e.insertBefore(this.createElement("defs"),e.firstChild)).contains||(i.contains=function(t){var e=i.children;if(!e)return!1;for(var n=e.length-1;0<=n;--n)if(e[n]===t)return!0;return!1}),i):null:i[0]},eP.prototype.update=function(t,e){var n,i;t&&(n=this.getDefs(!1),t[this._domName]&&n.contains(t[this._domName])?"function"==typeof e&&e(t):(i=this.add(t))&&(t[this._domName]=i))},eP.prototype.addDom=function(t){this.getDefs(!0).appendChild(t)},eP.prototype.removeDom=function(t){var e=this.getDefs(!1);e&&t[this._domName]&&(e.removeChild(t[this._domName]),t[this._domName]=null)},eP.prototype.getDoms=function(){var n=this.getDefs(!1);if(!n)return[];var i=[];return P(this._tagNames,function(t){var e=n.getElementsByTagName(t);i=i.concat([].slice.call(e))}),i},eP.prototype.markAllUnused=function(){var t=this.getDoms(),e=this;P(t,function(t){t[e._markLabel]="0"})},eP.prototype.markUsed=function(t){t&&(t[this._markLabel]="1")},eP.prototype.removeUnused=function(){var t,e,n=this.getDefs(!1);n&&(t=this.getDoms(),e=this,P(t,function(t){"1"!==t[e._markLabel]&&n.removeChild(t)}))},eP.prototype.getSvgProxy=function(t){return t instanceof br?Wk:t instanceof Yi?Hk:t instanceof Gr?Zk:Wk},eP.prototype.getTextSvgElement=function(t){return t.__textSvgEl},eP.prototype.getSvgElement=function(t){return t.__svgEl},w(nP,eP),nP.prototype.addWithoutUpdate=function(a,r){var s;r&&r.style&&(s=this,P(["fill","stroke"],function(t){var e,n,i,o;!r.style[t]||"linear"!==r.style[t].type&&"radial"!==r.style[t].type||(e=r.style[t],n=s.getDefs(!0),e._dom?(i=e._dom,n.contains(e._dom)||s.addDom(i)):i=s.add(e),s.markUsed(r),o=i.getAttribute("id"),a.setAttribute(t,"url(#"+o+")"))}))},nP.prototype.add=function(t){var e;if("linear"===t.type)e=this.createElement("linearGradient");else{if("radial"!==t.type)return dn("Illegal gradient type."),null;e=this.createElement("radialGradient")}return t.id=t.id||this.nextId++,e.setAttribute("id","zr"+this._zrId+"-gradient-"+t.id),this.updateDom(t,e),this.addDom(e),e},nP.prototype.update=function(n){var i=this;eP.prototype.update.call(this,n,function(){var t=n.type,e=n._dom.tagName;"linear"===t&&"linearGradient"===e||"radial"===t&&"radialGradient"===e?i.updateDom(n,n._dom):(i.removeDom(n),i.add(n))})},nP.prototype.updateDom=function(t,e){if("linear"===t.type)e.setAttribute("x1",t.x),e.setAttribute("y1",t.y),e.setAttribute("x2",t.x2),e.setAttribute("y2",t.y2);else{if("radial"!==t.type)return void dn("Illegal gradient type.");e.setAttribute("cx",t.x),e.setAttribute("cy",t.y),e.setAttribute("r",t.r)}t.global?e.setAttribute("gradientUnits","userSpaceOnUse"):e.setAttribute("gradientUnits","objectBoundingBox"),e.innerHTML="";for(var n=t.colorStops,i=0,o=n.length;i<o;++i){var a=this.createElement("stop");a.setAttribute("offset",100*n[i].offset+"%");var r,s,l=n[i].color;l.indexOf(!1)?(r=Re(l)[3],s=Ge(l),a.setAttribute("stop-color","#"+s),a.setAttribute("stop-opacity",r)):a.setAttribute("stop-color",n[i].color),e.appendChild(a)}t._dom=e},nP.prototype.markUsed=function(t){var e;t.style&&((e=t.style.fill)&&e._dom&&eP.prototype.markUsed.call(this,e._dom),(e=t.style.stroke)&&e._dom&&eP.prototype.markUsed.call(this,e._dom))},w(iP,eP),iP.prototype.update=function(t){var e=this.getSvgElement(t);e&&this.updateDom(e,t.__clipPaths,!1);var n=this.getTextSvgElement(t);n&&this.updateDom(n,t.__clipPaths,!0),this.markUsed(t)},iP.prototype.updateDom=function(t,e,n){var i,o,a,r,s,l,h,u;e&&0<e.length?(i=this.getDefs(!0),(o=e[0])[s=n?"_textDom":"_dom"]?(r=o[s].getAttribute("id"),a=o[s],i.contains(a)||i.appendChild(a)):(r="zr"+this._zrId+"-clip-"+this.nextId,++this.nextId,(a=this.createElement("clipPath")).setAttribute("id",r),i.appendChild(a),o[s]=a),l=this.getSvgProxy(o),o.transform&&o.parent.invTransform&&!n?(h=Array.prototype.slice.call(o.transform),oe(o.transform,o.parent.invTransform,o.transform),l.brush(o),o.transform=h):l.brush(o),u=this.getSvgElement(o),a.innerHTML="",a.appendChild(u.cloneNode()),t.setAttribute("clip-path","url(#"+r+")"),1<e.length&&this.updateDom(a,e.slice(1),n)):t&&t.setAttribute("clip-path","none")},iP.prototype.markUsed=function(t){var e=this;t.__clipPaths&&P(t.__clipPaths,function(t){t._dom&&eP.prototype.markUsed.call(e,t._dom),t._textDom&&eP.prototype.markUsed.call(e,t._textDom)})},w(oP,eP),oP.prototype.addWithoutUpdate=function(t,e){var n,i;e&&aP(e.style)&&(e._shadowDom?(n=e._shadowDom,this.getDefs(!0).contains(e._shadowDom)||this.addDom(n)):n=this.add(e),this.markUsed(e),i=n.getAttribute("id"),t.style.filter="url(#"+i+")")},oP.prototype.add=function(t){var e=this.createElement("filter");return t._shadowDomId=t._shadowDomId||this.nextId++,e.setAttribute("id","zr"+this._zrId+"-shadow-"+t._shadowDomId),this.updateDom(t,e),this.addDom(e),e},oP.prototype.update=function(t,e){var n;aP(e.style)?(n=this,eP.prototype.update.call(this,e,function(){n.updateDom(e,e._shadowDom)})):this.remove(t,e)},oP.prototype.remove=function(t,e){null!=e._shadowDomId&&(this.removeDom(t),t.style.filter="")},oP.prototype.updateDom=function(t,e){var n,i,o,a,r=0===(r=e.getElementsByTagName("feDropShadow")).length?this.createElement("feDropShadow"):r[0],s=t.style,l=t.scale&&t.scale[0]||1,h=t.scale&&t.scale[1]||1;if(s.shadowBlur||s.shadowOffsetX||s.shadowOffsetY)n=s.shadowOffsetX||0,i=s.shadowOffsetY||0,o=s.shadowBlur,a=s.shadowColor;else{if(!s.textShadowBlur)return void this.removeDom(e,s);n=s.textShadowOffsetX||0,i=s.textShadowOffsetY||0,o=s.textShadowBlur,a=s.textShadowColor}r.setAttribute("dx",n/l),r.setAttribute("dy",i/h),r.setAttribute("flood-color",a);var u=o/2/l+" "+o/2/h;r.setAttribute("stdDeviation",u),e.setAttribute("x","-100%"),e.setAttribute("y","-100%"),e.setAttribute("width",Math.ceil(o/2*200)+"%"),e.setAttribute("height",Math.ceil(o/2*200)+"%"),e.appendChild(r),t._shadowDom=e},oP.prototype.markUsed=function(t){t._shadowDom&&eP.prototype.markUsed.call(this,t._shadowDom)};function pP(t,e,n,i){this.root=t,this.storage=e,this._opts=n=k({},n||{});var o=Tk("svg");o.setAttribute("xmlns","http://www.w3.org/2000/svg"),o.setAttribute("version","1.1"),o.setAttribute("baseProfile","full"),o.style.cssText="user-select:none;position:absolute;left:0;top:0;",this.gradientManager=new nP(i,o),this.clipPathManager=new iP(i,o),this.shadowManager=new oP(i,o);var a=document.createElement("div");a.style.cssText="overflow:hidden;position:relative",this._svgRoot=o,this._viewport=a,t.appendChild(a),a.appendChild(o),this.resize(n.width,n.height),this._visibleList=[]}pP.prototype={constructor:pP,getType:function(){return"svg"},getViewportRoot:function(){return this._viewport},getViewportRootOffset:function(){var t=this.getViewportRoot();if(t)return{offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0}},refresh:function(){var t=this.storage.getDisplayList(!0);this._paintList(t)},setBackgroundColor:function(t){this._viewport.style.background=t},_paintList:function(t){this.gradientManager.markAllUnused(),this.clipPathManager.markAllUnused(),this.shadowManager.markAllUnused();for(var e,n=this._svgRoot,i=this._visibleList,o=t.length,a=[],r=0;r<o;r++){var s=t[r],l=(e=s)instanceof br?Wk:e instanceof Yi?Hk:e instanceof Gr?Zk:Wk,h=dP(s)||cP(s);s.invisible||(s.__dirty&&(l&&l.brush(s),this.clipPathManager.update(s),s.style&&(this.gradientManager.update(s.style.fill),this.gradientManager.update(s.style.stroke),this.shadowManager.update(h,s)),s.__dirty=!1),a.push(s))}var u,c,d,p,g,f=(u=i,c=a,tP.diff(u,c,d));for(r=0;r<f.length;r++){if((g=f[r]).removed)for(var m=0;m<g.count;m++){var h=dP(s=i[g.indices[m]]),v=cP(s);uP(n,h),uP(n,v)}}for(r=0;r<f.length;r++){if((g=f[r]).added)for(m=0;m<g.count;m++){h=dP(s=a[g.indices[m]]),v=cP(s);p?lP(n,h,p):hP(n,h),h?lP(n,v,h):p?lP(n,v,p):hP(n,v),lP(n,v,h),p=v||h||p,this.gradientManager.addWithoutUpdate(h||v,s),this.shadowManager.addWithoutUpdate(h||v,s),this.clipPathManager.markUsed(s)}else if(!g.removed)for(m=0;m<g.count;m++){h=dP(s=a[g.indices[m]]),v=cP(s),h=dP(s),v=cP(s);this.gradientManager.markUsed(s),this.gradientManager.addWithoutUpdate(h||v,s),this.shadowManager.markUsed(s),this.shadowManager.addWithoutUpdate(h||v,s),this.clipPathManager.markUsed(s),v&&lP(n,v,h),p=h||v||p}}this.gradientManager.removeUnused(),this.clipPathManager.removeUnused(),this.shadowManager.removeUnused(),this._visibleList=a},_getDefs:function(t){var e=this._svgRoot,i=this._svgRoot.getElementsByTagName("defs");return 0!==i.length?i[0]:t?((i=e.insertBefore(Tk("defs"),e.firstChild)).contains||(i.contains=function(t){var e=i.children;if(!e)return!1;for(var n=e.length-1;0<=n;--n)if(e[n]===t)return!0;return!1}),i):null},resize:function(t,e){var n=this._viewport;n.style.display="none";var i,o,a=this._opts;null!=t&&(a.width=t),null!=e&&(a.height=e),t=this._getSize(0),e=this._getSize(1),n.style.display="",this._width===t&&this._height===e||(this._width=t,this._height=e,(i=n.style).width=t+"px",i.height=e+"px",(o=this._svgRoot).setAttribute("width",t),o.setAttribute("height",e))},getWidth:function(){return this._width},getHeight:function(){return this._height},_getSize:function(t){var e=this._opts,n=["width","height"][t],i=["clientWidth","clientHeight"][t],o=["paddingLeft","paddingTop"][t],a=["paddingRight","paddingBottom"][t];if(null!=e[n]&&"auto"!==e[n])return parseFloat(e[n]);var r=this.root,s=document.defaultView.getComputedStyle(r);return(r[i]||rP(s[n])||rP(r.style[n]))-(rP(s[o])||0)-(rP(s[a])||0)|0},dispose:function(){this.root.innerHTML="",this._svgRoot=this._viewport=this.storage=null},clear:function(){this._viewport&&this.root.removeChild(this._viewport)},pathToDataUrl:function(){return this.refresh(),"data:image/svg+xml;charset=UTF-8,"+this._svgRoot.outerHTML}},P(["getLayer","insertLayer","eachLayer","eachBuiltinLayer","eachOtherLayer","getLayers","modLayer","delLayer","clearLayer","toDataURL","pathToImage"],function(t){var e;pP.prototype[t]=(e=t,function(){dn('In SVG mode painter not support method "'+e+'"')})}),Ao("svg",pP),t.version="4.6.0",t.dependencies=Md,t.PRIORITY=Id,t.init=function(t,e,n){if(D){if(+Io.replace(".","")<+Md.zrender.replace(".",""))throw new Error("zrender/src 4.2.0 is too old for ECharts 4.6.0. Current version need ZRender "+Md.zrender+"+");if(!t)throw new Error("Initialize failed: invalid dom.")}var i=cp(t);if(i)return D&&console.warn("There is a chart instance already initialized on the dom."),i;D&&(!W(t)||"CANVAS"===t.nodeName.toUpperCase()||(t.clientWidth||n&&null!=n.width)&&(t.clientHeight||n&&null!=n.height)||console.warn("Can't get DOM width or height. Please check dom.clientWidth and dom.clientHeight. They should not be 0.For example, you may need to call this in the callback of window.onload."));var o,a,r=new kd(t,e,n);function s(t,e){for(var n=0;n<t.length;n++){t[n][a]=e}}return r.id="ec_"+rp++,op[r.id]=r,Yo(t,lp,r.id),o=r,a="__connectUpdateStatus",_d($d,function(t,e){o._messageCenter.on(e,function(t){if(ap[o.group]&&0!==o[a]){if(t&&t.escapeConnect)return;var e=o.makeActionFromEvent(t),n=[];_d(op,function(t){t!==o&&t.group===o.group&&n.push(t)}),s(n,0),_d(n,function(t){1!==t[a]&&t.dispatchAction(e)}),s(n,2)}})}),r},t.connect=function(e){var t;return R(e)&&(t=e,e=null,_d(t,function(t){null!=t.group&&(e=t.group)}),e=e||"g_"+sp++,_d(t,function(t){t.group=e})),ap[e]=!0,e},t.disConnect=hp,t.disconnect=up,t.dispose=function(t){"string"==typeof t?t=op[t]:t instanceof kd||(t=cp(t)),t instanceof kd&&!t.isDisposed()&&t.dispose()},t.getInstanceByDom=cp,t.getInstanceById=function(t){return op[t]},t.registerTheme=dp,t.registerPreprocessor=pp,t.registerProcessor=gp,t.registerPostUpdate=function(t){tp.push(t)},t.registerAction=fp,t.registerCoordinateSystem=mp,t.getCoordinateSystemDimensions=function(t){var e=nu.get(t);if(e)return e.getDimensionsInfo?e.getDimensionsInfo():e.dimensions.slice()},t.registerLayout=vp,t.registerVisual=yp,t.registerLoading=_p,t.extendComponentModel=wp,t.extendComponentView=bp,t.extendSeriesModel=Sp,t.extendChartView=Mp,t.setCanvasCreator=function(t){g("createCanvas",t)},t.registerMap=function(t,e,n){vd.registerMap(t,e,n)},t.getMap=function(t){var e=vd.retrieveMap(t);return e&&e[0]&&{geoJson:e[0].geoJSON,specialAreas:e[0].specialAreas}},t.dataTool={},t.zrender=Co,t.number=Yl,t.format=hh,t.throttle=Mc,t.helper=wf,t.matrix=ue,t.vector=It,t.color=Xe,t.parseGeoJSON=Af,t.parseGeoJson=Gf,t.util=Ff,t.graphic=Wf,t.List=Hp,t.Model=Sl,t.Axis=Bf,t.env=v});